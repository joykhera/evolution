{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2442174724924067, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.485885090132554, "policy_loss": -0.016986390001450975, "vf_loss": 6.498989968498548, "vf_explained_var": 0.0010580141097307205, "kl": 0.01940758090527127, "entropy": 1.5903472006320953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.304953996029993, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.488380792240302, "policy_loss": -0.015205437947103443, "vf_loss": 6.50036584486564, "vf_explained_var": 3.2675328354040783e-05, "kl": 0.01610184934355857, "entropy": 1.593548595905304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -14.715572109997902, "predator_policy": -33.79534627234691}, "policy_reward_max": {"prey_policy": 33.79534627234691, "predator_policy": 14.715572109997902}, "policy_reward_mean": {"prey_policy": 3.401503944234182, "predator_policy": -3.401503944234182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.4460927636084335, 4.752830978674545, 33.79534627234691, 11.551067217469232, -4.749172689755824, -6.990988872021987, -14.715572109997902, -2.4433272989406944, 3.967259236724921], "policy_predator_policy_reward": [-5.4460927636084335, -4.752830978674545, -33.79534627234691, -11.551067217469232, 4.749172689755824, 6.990988872021987, 14.715572109997902, 2.4433272989406944, -3.967259236724921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34322933375387943, "mean_inference_ms": 1.1950177580905186, "mean_action_processing_ms": 0.15727390119674844, "mean_env_wait_ms": 0.08867580417363478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004745854271782769, "StateBufferConnector_ms": 0.002984205881754557, "ViewRequirementAgentConnector_ms": 0.05155801773071289}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.6477969481756, "num_env_steps_trained_throughput_per_sec": 683.6477969481756, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 5850.974, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5850.934, "sample_time_ms": 835.496, "learn_time_ms": 5004.805, "learn_throughput": 799.232, "synch_weights_time_ms": 10.285}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "abfb9_00000", "date": "2024-08-11_11-30-58", "timestamp": 1723390258, "time_this_iter_s": 5.8563761711120605, "time_total_s": 5.8563761711120605, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b12d7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5.8563761711120605, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.18888888888889, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1935566576818624, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.656282518307368, "policy_loss": -0.020730874673608922, "vf_loss": 6.673260665933291, "vf_explained_var": -0.03959592146178086, "kl": 0.018763667378909023, "entropy": 1.5582327624162038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.315848275087774, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.669997803866863, "policy_loss": -0.012301096173177938, "vf_loss": 6.679093454778195, "vf_explained_var": -0.04150441704938809, "kl": 0.01602709241528088, "entropy": 1.5569666977971792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 378.8421052631579, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7198, "policy_reward_min": {"prey_policy": -24.180360594747, "predator_policy": -33.79534627234691}, "policy_reward_max": {"prey_policy": 33.79534627234691, "predator_policy": 24.180360594747}, "policy_reward_mean": {"prey_policy": 0.04628177476034084, "predator_policy": -0.04628177476034084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 390, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.4460927636084335, 4.752830978674545, 33.79534627234691, 11.551067217469232, -4.749172689755824, -6.990988872021987, -14.715572109997902, -2.4433272989406944, 3.967259236724921, -2.835000641501132, -6.460854575999717, 31.46768509681354, -1.84064397799445, -24.180360594747, 1.0640071810418181, -22.119099387639842, -11.032516844679346, 7.312033925829253, -1.1094319587842847], "policy_predator_policy_reward": [-5.4460927636084335, -4.752830978674545, -33.79534627234691, -11.551067217469232, 4.749172689755824, 6.990988872021987, 14.715572109997902, 2.4433272989406944, -3.967259236724921, 2.835000641501132, 6.460854575999717, -31.46768509681354, 1.84064397799445, 24.180360594747, -1.0640071810418181, 22.119099387639842, 11.032516844679346, -7.312033925829253, 1.1094319587842847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32390565104146823, "mean_inference_ms": 1.1228903537811454, "mean_action_processing_ms": 0.14840133320957574, "mean_env_wait_ms": 0.08336997114944948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004159149370695415, "StateBufferConnector_ms": 0.0025943705910130553, "ViewRequirementAgentConnector_ms": 0.046506053523013464}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 741.2790156938195, "num_env_steps_trained_throughput_per_sec": 741.2790156938195, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 5623.531, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5623.493, "sample_time_ms": 756.488, "learn_time_ms": 4855.822, "learn_throughput": 823.753, "synch_weights_time_ms": 10.852}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-05", "timestamp": 1723390265, "time_this_iter_s": 5.399050951004028, "time_total_s": 11.255427122116089, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.255427122116089, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.669999999999998, "ram_util_percent": 83.28999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.296291458979249, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5746950343251225, "policy_loss": -0.011752759143079553, "vf_loss": 6.584068392713864, "vf_explained_var": -0.2684463114167253, "kl": 0.011897098484302815, "entropy": 1.5269945168246826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3045266384258865, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.562875614563624, "policy_loss": -0.004588631664713224, "vf_loss": 6.566087913513184, "vf_explained_var": -0.25198526854316394, "kl": 0.006881641147004518, "entropy": 1.545299591869116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 345.61290322580646, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 10714, "policy_reward_min": {"prey_policy": -51.619793918085946, "predator_policy": -33.79534627234691}, "policy_reward_max": {"prey_policy": 33.79534627234691, "predator_policy": 51.619793918085946}, "policy_reward_mean": {"prey_policy": -6.893498704798373, "predator_policy": 6.893498704798373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 390, 400, 400, 400, 400, 400, 400, 400, 399, 3, 400, 400, 380, 286, 327, 254, 224, 43], "policy_prey_policy_reward": [5.4460927636084335, 4.752830978674545, 33.79534627234691, 11.551067217469232, -4.749172689755824, -6.990988872021987, -14.715572109997902, -2.4433272989406944, 3.967259236724921, -2.835000641501132, -6.460854575999717, 31.46768509681354, -1.84064397799445, -24.180360594747, 1.0640071810418181, -22.119099387639842, -11.032516844679346, 7.312033925829253, -1.1094319587842847, 6.976999742825752, -14.000048484968893, -34.510693800874826, -1.6764787908246288, 1.5937613734579141, -51.619793918085946, -16.89791451861472, -31.8696089265111, -19.697621535341753, -25.296084822105286, -26.455407396191944, -1.124922491960612], "policy_predator_policy_reward": [-5.4460927636084335, -4.752830978674545, -33.79534627234691, -11.551067217469232, 4.749172689755824, 6.990988872021987, 14.715572109997902, 2.4433272989406944, -3.967259236724921, 2.835000641501132, 6.460854575999717, -31.46768509681354, 1.84064397799445, 24.180360594747, -1.0640071810418181, 22.119099387639842, 11.032516844679346, -7.312033925829253, 1.1094319587842847, -6.976999742825752, 14.000048484968893, 34.510693800874826, 1.6764787908246288, -1.5937613734579141, 51.619793918085946, 16.89791451861472, 31.8696089265111, 19.697621535341753, 25.296084822105286, 26.455407396191944, 1.124922491960612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31398756986633697, "mean_inference_ms": 1.0832431147228776, "mean_action_processing_ms": 0.1426455807255475, "mean_env_wait_ms": 0.08012081379159489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038469991376323086, "StateBufferConnector_ms": 0.002456480456936744, "ViewRequirementAgentConnector_ms": 0.046994224671394594}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 714.0495755211448, "num_env_steps_trained_throughput_per_sec": 714.0495755211448, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 5616.307, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5616.268, "sample_time_ms": 731.698, "learn_time_ms": 4872.969, "learn_throughput": 820.855, "synch_weights_time_ms": 11.224}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-11", "timestamp": 1723390271, "time_this_iter_s": 5.604737997055054, "time_total_s": 16.860165119171143, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b130bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16.860165119171143, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.137500000000003, "ram_util_percent": 82.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5810990809462964, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.351650870839754, "policy_loss": -0.006855101153632859, "vf_loss": 7.356425716976324, "vf_explained_var": -0.41164673094948134, "kl": 0.010401451520798476, "entropy": 1.4802263944099348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.57375150565058, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.356557327508926, "policy_loss": -0.009260110515606356, "vf_loss": 7.3640172700087225, "vf_explained_var": -0.4035574928546945, "kl": 0.009000969171982337, "entropy": 1.5004276048392058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 330.8837209302326, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 14228, "policy_reward_min": {"prey_policy": -51.619793918085946, "predator_policy": -33.79534627234691}, "policy_reward_max": {"prey_policy": 33.79534627234691, "predator_policy": 51.619793918085946}, "policy_reward_mean": {"prey_policy": -10.44163960349841, "predator_policy": 10.44163960349841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 390, 400, 400, 400, 400, 400, 400, 400, 399, 3, 400, 400, 380, 286, 327, 254, 224, 43, 374, 400, 265, 269, 259, 180, 281, 169, 331, 400, 400, 186], "policy_prey_policy_reward": [5.4460927636084335, 4.752830978674545, 33.79534627234691, 11.551067217469232, -4.749172689755824, -6.990988872021987, -14.715572109997902, -2.4433272989406944, 3.967259236724921, -2.835000641501132, -6.460854575999717, 31.46768509681354, -1.84064397799445, -24.180360594747, 1.0640071810418181, -22.119099387639842, -11.032516844679346, 7.312033925829253, -1.1094319587842847, 6.976999742825752, -14.000048484968893, -34.510693800874826, -1.6764787908246288, 1.5937613734579141, -51.619793918085946, -16.89791451861472, -31.8696089265111, -19.697621535341753, -25.296084822105286, -26.455407396191944, -1.124922491960612, -7.207418055669791, -24.954578742862793, -42.45216616868751, -38.59284890610563, 0.01668499783020394, -14.079610389547671, -25.183401028931417, -38.53816536622347, -12.617594586960818, -21.030397842097422, 13.60205386101454, -24.25460087344026], "policy_predator_policy_reward": [-5.4460927636084335, -4.752830978674545, -33.79534627234691, -11.551067217469232, 4.749172689755824, 6.990988872021987, 14.715572109997902, 2.4433272989406944, -3.967259236724921, 2.835000641501132, 6.460854575999717, -31.46768509681354, 1.84064397799445, 24.180360594747, -1.0640071810418181, 22.119099387639842, 11.032516844679346, -7.312033925829253, 1.1094319587842847, -6.976999742825752, 14.000048484968893, 34.510693800874826, 1.6764787908246288, -1.5937613734579141, 51.619793918085946, 16.89791451861472, 31.8696089265111, 19.697621535341753, 25.296084822105286, 26.455407396191944, 1.124922491960612, 7.207418055669791, 24.954578742862793, 42.45216616868751, 38.59284890610563, -0.01668499783020394, 14.079610389547671, 25.183401028931417, 38.53816536622347, 12.617594586960818, 21.030397842097422, -13.60205386101454, 24.25460087344026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.306728819409093, "mean_inference_ms": 1.0550564107757963, "mean_action_processing_ms": 0.13955812220214572, "mean_env_wait_ms": 0.0777479839626506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035197235817132993, "StateBufferConnector_ms": 0.0023348386897597204, "ViewRequirementAgentConnector_ms": 0.0469856483991756}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.3255200679147, "num_env_steps_trained_throughput_per_sec": 736.3255200679147, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 5570.327, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5570.29, "sample_time_ms": 708.724, "learn_time_ms": 4850.229, "learn_throughput": 824.703, "synch_weights_time_ms": 10.979}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-16", "timestamp": 1723390276, "time_this_iter_s": 5.43522310256958, "time_total_s": 22.295388221740723, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22.295388221740723, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.937500000000004, "ram_util_percent": 82.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5302390693997343, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.659742354353269, "policy_loss": -0.015419130281467611, "vf_loss": 6.672019778192043, "vf_explained_var": 0.07913477718830109, "kl": 0.01570851980036007, "entropy": 1.404916673898697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4505014669460554, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6705745925505955, "policy_loss": -0.005985668254773676, "vf_loss": 6.674768234789371, "vf_explained_var": 0.09059243183583021, "kl": 0.008960123016199013, "entropy": 1.473649252826969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 310.1666666666667, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 18610, "policy_reward_min": {"prey_policy": -51.619793918085946, "predator_policy": -33.79534627234691}, "policy_reward_max": {"prey_policy": 33.79534627234691, "predator_policy": 51.619793918085946}, "policy_reward_mean": {"prey_policy": -14.232180157184693, "predator_policy": 14.232180157184693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 390, 400, 400, 400, 400, 400, 400, 400, 399, 3, 400, 400, 380, 286, 327, 254, 224, 43, 374, 400, 265, 269, 259, 180, 281, 169, 331, 400, 400, 186, 281, 400, 143, 80, 243, 129, 400, 124, 400, 400, 162, 400, 174, 400, 400, 20, 226], "policy_prey_policy_reward": [5.4460927636084335, 4.752830978674545, 33.79534627234691, 11.551067217469232, -4.749172689755824, -6.990988872021987, -14.715572109997902, -2.4433272989406944, 3.967259236724921, -2.835000641501132, -6.460854575999717, 31.46768509681354, -1.84064397799445, -24.180360594747, 1.0640071810418181, -22.119099387639842, -11.032516844679346, 7.312033925829253, -1.1094319587842847, 6.976999742825752, -14.000048484968893, -34.510693800874826, -1.6764787908246288, 1.5937613734579141, -51.619793918085946, -16.89791451861472, -31.8696089265111, -19.697621535341753, -25.296084822105286, -26.455407396191944, -1.124922491960612, -7.207418055669791, -24.954578742862793, -42.45216616868751, -38.59284890610563, 0.01668499783020394, -14.079610389547671, -25.183401028931417, -38.53816536622347, -12.617594586960818, -21.030397842097422, 13.60205386101454, -24.25460087344026, -40.86240404032475, -6.593846600764774, -43.884238934480344, -20.78953642830551, -26.99025634672794, -31.185342628381846, -27.451712562122083, -23.068600551223415, -35.017499624962994, -14.150370392289506, -34.75061884369697, -8.807416553603428, -21.598726902936708, -8.012085307586286, -12.147695690227735, -10.809416403134813, -38.82053866988096], "policy_predator_policy_reward": [-5.4460927636084335, -4.752830978674545, -33.79534627234691, -11.551067217469232, 4.749172689755824, 6.990988872021987, 14.715572109997902, 2.4433272989406944, -3.967259236724921, 2.835000641501132, 6.460854575999717, -31.46768509681354, 1.84064397799445, 24.180360594747, -1.0640071810418181, 22.119099387639842, 11.032516844679346, -7.312033925829253, 1.1094319587842847, -6.976999742825752, 14.000048484968893, 34.510693800874826, 1.6764787908246288, -1.5937613734579141, 51.619793918085946, 16.89791451861472, 31.8696089265111, 19.697621535341753, 25.296084822105286, 26.455407396191944, 1.124922491960612, 7.207418055669791, 24.954578742862793, 42.45216616868751, 38.59284890610563, -0.01668499783020394, 14.079610389547671, 25.183401028931417, 38.53816536622347, 12.617594586960818, 21.030397842097422, -13.60205386101454, 24.25460087344026, 40.86240404032475, 6.593846600764774, 43.884238934480344, 20.78953642830551, 26.99025634672794, 31.185342628381846, 27.451712562122083, 23.068600551223415, 35.017499624962994, 14.150370392289506, 34.75061884369697, 8.807416553603428, 21.598726902936708, 8.012085307586286, 12.147695690227735, 10.809416403134813, 38.82053866988096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30083526042391023, "mean_inference_ms": 1.028368098546179, "mean_action_processing_ms": 0.13624643429617367, "mean_env_wait_ms": 0.07548910342589187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00326693058013916, "StateBufferConnector_ms": 0.0022429227828979492, "ViewRequirementAgentConnector_ms": 0.04894574483235677}, "num_episodes": 17, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 753.0911373980639, "num_env_steps_trained_throughput_per_sec": 753.0911373980639, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 5518.552, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5518.515, "sample_time_ms": 693.006, "learn_time_ms": 4814.257, "learn_throughput": 830.865, "synch_weights_time_ms": 10.904}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-22", "timestamp": 1723390282, "time_this_iter_s": 5.314110994338989, "time_total_s": 27.609499216079712, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27.609499216079712, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.8625, "ram_util_percent": 82.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3552887447488804, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6527502651015915, "policy_loss": -0.007486732929343513, "vf_loss": 6.658565819760164, "vf_explained_var": -0.4449233814453085, "kl": 0.008356031674090166, "entropy": 1.4128301803022623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3650787971913814, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.659969273209572, "policy_loss": -0.008621506312435183, "vf_loss": 6.666726293663184, "vf_explained_var": -0.411143088961641, "kl": 0.009322435926886318, "entropy": 1.4882122294356426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 286.5, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 22920, "policy_reward_min": {"prey_policy": -51.619793918085946, "predator_policy": -33.79534627234691}, "policy_reward_max": {"prey_policy": 33.79534627234691, "predator_policy": 51.619793918085946}, "policy_reward_mean": {"prey_policy": -16.70070630837537, "predator_policy": 16.70070630837537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 390, 400, 400, 400, 400, 400, 400, 400, 399, 3, 400, 400, 380, 286, 327, 254, 224, 43, 374, 400, 265, 269, 259, 180, 281, 169, 331, 400, 400, 186, 281, 400, 143, 80, 243, 129, 400, 124, 400, 400, 162, 400, 174, 400, 400, 20, 226, 389, 144, 106, 157, 263, 170, 400, 400, 103, 207, 92, 122, 69, 276, 86, 387, 94, 346, 369, 130], "policy_prey_policy_reward": [5.4460927636084335, 4.752830978674545, 33.79534627234691, 11.551067217469232, -4.749172689755824, -6.990988872021987, -14.715572109997902, -2.4433272989406944, 3.967259236724921, -2.835000641501132, -6.460854575999717, 31.46768509681354, -1.84064397799445, -24.180360594747, 1.0640071810418181, -22.119099387639842, -11.032516844679346, 7.312033925829253, -1.1094319587842847, 6.976999742825752, -14.000048484968893, -34.510693800874826, -1.6764787908246288, 1.5937613734579141, -51.619793918085946, -16.89791451861472, -31.8696089265111, -19.697621535341753, -25.296084822105286, -26.455407396191944, -1.124922491960612, -7.207418055669791, -24.954578742862793, -42.45216616868751, -38.59284890610563, 0.01668499783020394, -14.079610389547671, -25.183401028931417, -38.53816536622347, -12.617594586960818, -21.030397842097422, 13.60205386101454, -24.25460087344026, -40.86240404032475, -6.593846600764774, -43.884238934480344, -20.78953642830551, -26.99025634672794, -31.185342628381846, -27.451712562122083, -23.068600551223415, -35.017499624962994, -14.150370392289506, -34.75061884369697, -8.807416553603428, -21.598726902936708, -8.012085307586286, -12.147695690227735, -10.809416403134813, -38.82053866988096, -30.055204757208386, -29.240399635192677, -11.846315107054554, -42.984176083070714, -16.75003881613729, -16.956925370836732, -27.731650949991497, -27.821224345332567, -42.90094030167901, -27.81947027335227, -38.68570024970822, -31.082190157470702, -23.09924633307217, -10.573850148839188, -17.705001148227232, -26.730723022310105, -11.742505199299675, -14.583441860113108, -13.29648990623069, -20.520201573821108], "policy_predator_policy_reward": [-5.4460927636084335, -4.752830978674545, -33.79534627234691, -11.551067217469232, 4.749172689755824, 6.990988872021987, 14.715572109997902, 2.4433272989406944, -3.967259236724921, 2.835000641501132, 6.460854575999717, -31.46768509681354, 1.84064397799445, 24.180360594747, -1.0640071810418181, 22.119099387639842, 11.032516844679346, -7.312033925829253, 1.1094319587842847, -6.976999742825752, 14.000048484968893, 34.510693800874826, 1.6764787908246288, -1.5937613734579141, 51.619793918085946, 16.89791451861472, 31.8696089265111, 19.697621535341753, 25.296084822105286, 26.455407396191944, 1.124922491960612, 7.207418055669791, 24.954578742862793, 42.45216616868751, 38.59284890610563, -0.01668499783020394, 14.079610389547671, 25.183401028931417, 38.53816536622347, 12.617594586960818, 21.030397842097422, -13.60205386101454, 24.25460087344026, 40.86240404032475, 6.593846600764774, 43.884238934480344, 20.78953642830551, 26.99025634672794, 31.185342628381846, 27.451712562122083, 23.068600551223415, 35.017499624962994, 14.150370392289506, 34.75061884369697, 8.807416553603428, 21.598726902936708, 8.012085307586286, 12.147695690227735, 10.809416403134813, 38.82053866988096, 30.055204757208386, 29.240399635192677, 11.846315107054554, 42.984176083070714, 16.75003881613729, 16.956925370836732, 27.731650949991497, 27.821224345332567, 42.90094030167901, 27.81947027335227, 38.68570024970822, 31.082190157470702, 23.09924633307217, 10.573850148839188, 17.705001148227232, 26.730723022310105, 11.742505199299675, 14.583441860113108, 13.29648990623069, 20.520201573821108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29638425481074926, "mean_inference_ms": 1.0058764731219787, "mean_action_processing_ms": 0.1338741385964624, "mean_env_wait_ms": 0.07343204677850335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031009316444396973, "StateBufferConnector_ms": 0.003025829792022705, "ViewRequirementAgentConnector_ms": 0.048227161169052124}, "num_episodes": 20, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 707.4861418503049, "num_env_steps_trained_throughput_per_sec": 707.4861418503049, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 5541.098, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5541.062, "sample_time_ms": 681.302, "learn_time_ms": 4848.623, "learn_throughput": 824.976, "synch_weights_time_ms": 10.786}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-27", "timestamp": 1723390287, "time_this_iter_s": 5.657600164413452, "time_total_s": 33.267099380493164, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1325dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 33.267099380493164, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.5625, "ram_util_percent": 82.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4526024321404596, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.858313512802124, "policy_loss": -0.012197972437813101, "vf_loss": 5.86804096698761, "vf_explained_var": -0.16398756485432386, "kl": 0.012352691132751314, "entropy": 1.3593998047212759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4900792259412508, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8737978855768835, "policy_loss": -0.00630343358546573, "vf_loss": 5.878688837091128, "vf_explained_var": -0.16624530175079902, "kl": 0.007062370854887234, "entropy": 1.480221234758695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 250.3, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 25030, "policy_reward_min": {"prey_policy": -51.619793918085946, "predator_policy": -31.46768509681354}, "policy_reward_max": {"prey_policy": 31.46768509681354, "predator_policy": 51.619793918085946}, "policy_reward_mean": {"prey_policy": -20.31768881898979, "predator_policy": 20.31768881898979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 8, 390, 400, 400, 400, 400, 400, 400, 400, 399, 3, 400, 400, 380, 286, 327, 254, 224, 43, 374, 400, 265, 269, 259, 180, 281, 169, 331, 400, 400, 186, 281, 400, 143, 80, 243, 129, 400, 124, 400, 400, 162, 400, 174, 400, 400, 20, 226, 389, 144, 106, 157, 263, 170, 400, 400, 103, 207, 92, 122, 69, 276, 86, 387, 94, 346, 369, 130, 177, 104, 240, 68, 114, 306, 143, 104, 106, 164, 133, 127, 221, 137, 400, 194, 170, 73, 79, 48, 400, 154, 183, 91, 174], "policy_prey_policy_reward": [-6.990988872021987, -14.715572109997902, -2.4433272989406944, 3.967259236724921, -2.835000641501132, -6.460854575999717, 31.46768509681354, -1.84064397799445, -24.180360594747, 1.0640071810418181, -22.119099387639842, -11.032516844679346, 7.312033925829253, -1.1094319587842847, 6.976999742825752, -14.000048484968893, -34.510693800874826, -1.6764787908246288, 1.5937613734579141, -51.619793918085946, -16.89791451861472, -31.8696089265111, -19.697621535341753, -25.296084822105286, -26.455407396191944, -1.124922491960612, -7.207418055669791, -24.954578742862793, -42.45216616868751, -38.59284890610563, 0.01668499783020394, -14.079610389547671, -25.183401028931417, -38.53816536622347, -12.617594586960818, -21.030397842097422, 13.60205386101454, -24.25460087344026, -40.86240404032475, -6.593846600764774, -43.884238934480344, -20.78953642830551, -26.99025634672794, -31.185342628381846, -27.451712562122083, -23.068600551223415, -35.017499624962994, -14.150370392289506, -34.75061884369697, -8.807416553603428, -21.598726902936708, -8.012085307586286, -12.147695690227735, -10.809416403134813, -38.82053866988096, -30.055204757208386, -29.240399635192677, -11.846315107054554, -42.984176083070714, -16.75003881613729, -16.956925370836732, -27.731650949991497, -27.821224345332567, -42.90094030167901, -27.81947027335227, -38.68570024970822, -31.082190157470702, -23.09924633307217, -10.573850148839188, -17.705001148227232, -26.730723022310105, -11.742505199299675, -14.583441860113108, -13.29648990623069, -20.520201573821108, -9.655632398351631, -39.1004345358215, -19.398338064258677, -37.559665119078744, -31.939581599920853, -40.75403217486906, -33.813439977610905, -13.33738385650727, -40.18094893137482, -24.91884972902395, -15.584315605668333, -43.377867339281934, -46.59979744266233, -38.453749326221455, -26.875199927991904, -14.808594311996625, -25.725910801839255, -3.900949729985505, -19.29408699753649, -5.558113392232819, -29.32503597525583, -13.563388405774514, -27.067346594743675, -25.29931969672561, -18.82423075187263], "policy_predator_policy_reward": [6.990988872021987, 14.715572109997902, 2.4433272989406944, -3.967259236724921, 2.835000641501132, 6.460854575999717, -31.46768509681354, 1.84064397799445, 24.180360594747, -1.0640071810418181, 22.119099387639842, 11.032516844679346, -7.312033925829253, 1.1094319587842847, -6.976999742825752, 14.000048484968893, 34.510693800874826, 1.6764787908246288, -1.5937613734579141, 51.619793918085946, 16.89791451861472, 31.8696089265111, 19.697621535341753, 25.296084822105286, 26.455407396191944, 1.124922491960612, 7.207418055669791, 24.954578742862793, 42.45216616868751, 38.59284890610563, -0.01668499783020394, 14.079610389547671, 25.183401028931417, 38.53816536622347, 12.617594586960818, 21.030397842097422, -13.60205386101454, 24.25460087344026, 40.86240404032475, 6.593846600764774, 43.884238934480344, 20.78953642830551, 26.99025634672794, 31.185342628381846, 27.451712562122083, 23.068600551223415, 35.017499624962994, 14.150370392289506, 34.75061884369697, 8.807416553603428, 21.598726902936708, 8.012085307586286, 12.147695690227735, 10.809416403134813, 38.82053866988096, 30.055204757208386, 29.240399635192677, 11.846315107054554, 42.984176083070714, 16.75003881613729, 16.956925370836732, 27.731650949991497, 27.821224345332567, 42.90094030167901, 27.81947027335227, 38.68570024970822, 31.082190157470702, 23.09924633307217, 10.573850148839188, 17.705001148227232, 26.730723022310105, 11.742505199299675, 14.583441860113108, 13.29648990623069, 20.520201573821108, 9.655632398351631, 39.1004345358215, 19.398338064258677, 37.559665119078744, 31.939581599920853, 40.75403217486906, 33.813439977610905, 13.33738385650727, 40.18094893137482, 24.91884972902395, 15.584315605668333, 43.377867339281934, 46.59979744266233, 38.453749326221455, 26.875199927991904, 14.808594311996625, 25.725910801839255, 3.900949729985505, 19.29408699753649, 5.558113392232819, 29.32503597525583, 13.563388405774514, 27.067346594743675, 25.29931969672561, 18.82423075187263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29018558369597675, "mean_inference_ms": 0.979963847499647, "mean_action_processing_ms": 0.13063616617453588, "mean_env_wait_ms": 0.07103823831425818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029207468032836914, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.047466158866882324}, "num_episodes": 25, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.2902584180304, "num_env_steps_trained_throughput_per_sec": 713.2902584180304, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 5550.63, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5550.593, "sample_time_ms": 686.802, "learn_time_ms": 4852.59, "learn_throughput": 824.302, "synch_weights_time_ms": 10.838}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-33", "timestamp": 1723390293, "time_this_iter_s": 5.612012624740601, "time_total_s": 38.879112005233765, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b130bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.879112005233765, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.662499999999994, "ram_util_percent": 82.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6949382200526695, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6440571794907255, "policy_loss": -0.0025673690703115425, "vf_loss": 6.645769973099232, "vf_explained_var": -0.5082646769161026, "kl": 0.004272960505846568, "entropy": 1.294783717021346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6891316931073865, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7692893832921985, "policy_loss": -0.006985688299270502, "vf_loss": 6.774806842207909, "vf_explained_var": -0.4058854003747304, "kl": 0.007341081008273889, "entropy": 1.424706701065103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 193.29, "episode_media": {}, "episodes_this_iter": 30, "episodes_timesteps_total": 19329, "policy_reward_min": {"prey_policy": -46.59979744266233, "predator_policy": -13.60205386101454}, "policy_reward_max": {"prey_policy": 13.60205386101454, "predator_policy": 46.59979744266233}, "policy_reward_mean": {"prey_policy": -25.283864231643477, "predator_policy": 25.283864231643477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [259, 180, 281, 169, 331, 400, 400, 186, 281, 400, 143, 80, 243, 129, 400, 124, 400, 400, 162, 400, 174, 400, 400, 20, 226, 389, 144, 106, 157, 263, 170, 400, 400, 103, 207, 92, 122, 69, 276, 86, 387, 94, 346, 369, 130, 177, 104, 240, 68, 114, 306, 143, 104, 106, 164, 133, 127, 221, 137, 400, 194, 170, 73, 79, 48, 400, 154, 183, 91, 174, 374, 122, 96, 72, 57, 167, 139, 134, 93, 72, 102, 138, 119, 118, 149, 120, 400, 102, 117, 64, 54, 149, 206, 143, 116, 192, 74, 400, 123, 109], "policy_prey_policy_reward": [0.01668499783020394, -14.079610389547671, -25.183401028931417, -38.53816536622347, -12.617594586960818, -21.030397842097422, 13.60205386101454, -24.25460087344026, -40.86240404032475, -6.593846600764774, -43.884238934480344, -20.78953642830551, -26.99025634672794, -31.185342628381846, -27.451712562122083, -23.068600551223415, -35.017499624962994, -14.150370392289506, -34.75061884369697, -8.807416553603428, -21.598726902936708, -8.012085307586286, -12.147695690227735, -10.809416403134813, -38.82053866988096, -30.055204757208386, -29.240399635192677, -11.846315107054554, -42.984176083070714, -16.75003881613729, -16.956925370836732, -27.731650949991497, -27.821224345332567, -42.90094030167901, -27.81947027335227, -38.68570024970822, -31.082190157470702, -23.09924633307217, -10.573850148839188, -17.705001148227232, -26.730723022310105, -11.742505199299675, -14.583441860113108, -13.29648990623069, -20.520201573821108, -9.655632398351631, -39.1004345358215, -19.398338064258677, -37.559665119078744, -31.939581599920853, -40.75403217486906, -33.813439977610905, -13.33738385650727, -40.18094893137482, -24.91884972902395, -15.584315605668333, -43.377867339281934, -46.59979744266233, -38.453749326221455, -26.875199927991904, -14.808594311996625, -25.725910801839255, -3.900949729985505, -19.29408699753649, -5.558113392232819, -29.32503597525583, -13.563388405774514, -27.067346594743675, -25.29931969672561, -18.82423075187263, -37.84897217881729, -17.227350162759162, -42.474858942888105, -28.12825444438695, -17.7228759346627, -44.93152186184326, -35.44583984869638, -40.39309245258177, -18.27644481919253, -27.4274907657319, -34.76509462167511, -30.01644066190882, -37.95968449138951, -39.74133565086592, -28.732525295130266, -40.99944951807053, -15.814191865327205, -19.76135686424274, -32.747744059019475, -31.73314042456319, -17.3861946033832, -39.87947317797136, -26.067393396279726, -15.695356712268358, -14.840032615229351, -33.73686867778042, -7.5562214140806985, -24.430371540012302, -36.25725809901182, -36.32234243001727], "policy_predator_policy_reward": [-0.01668499783020394, 14.079610389547671, 25.183401028931417, 38.53816536622347, 12.617594586960818, 21.030397842097422, -13.60205386101454, 24.25460087344026, 40.86240404032475, 6.593846600764774, 43.884238934480344, 20.78953642830551, 26.99025634672794, 31.185342628381846, 27.451712562122083, 23.068600551223415, 35.017499624962994, 14.150370392289506, 34.75061884369697, 8.807416553603428, 21.598726902936708, 8.012085307586286, 12.147695690227735, 10.809416403134813, 38.82053866988096, 30.055204757208386, 29.240399635192677, 11.846315107054554, 42.984176083070714, 16.75003881613729, 16.956925370836732, 27.731650949991497, 27.821224345332567, 42.90094030167901, 27.81947027335227, 38.68570024970822, 31.082190157470702, 23.09924633307217, 10.573850148839188, 17.705001148227232, 26.730723022310105, 11.742505199299675, 14.583441860113108, 13.29648990623069, 20.520201573821108, 9.655632398351631, 39.1004345358215, 19.398338064258677, 37.559665119078744, 31.939581599920853, 40.75403217486906, 33.813439977610905, 13.33738385650727, 40.18094893137482, 24.91884972902395, 15.584315605668333, 43.377867339281934, 46.59979744266233, 38.453749326221455, 26.875199927991904, 14.808594311996625, 25.725910801839255, 3.900949729985505, 19.29408699753649, 5.558113392232819, 29.32503597525583, 13.563388405774514, 27.067346594743675, 25.29931969672561, 18.82423075187263, 37.84897217881729, 17.227350162759162, 42.474858942888105, 28.12825444438695, 17.7228759346627, 44.93152186184326, 35.44583984869638, 40.39309245258177, 18.27644481919253, 27.4274907657319, 34.76509462167511, 30.01644066190882, 37.95968449138951, 39.74133565086592, 28.732525295130266, 40.99944951807053, 15.814191865327205, 19.76135686424274, 32.747744059019475, 31.73314042456319, 17.3861946033832, 39.87947317797136, 26.067393396279726, 15.695356712268358, 14.840032615229351, 33.73686867778042, 7.5562214140806985, 24.430371540012302, 36.25725809901182, 36.32234243001727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2830334065515807, "mean_inference_ms": 0.9467114390302703, "mean_action_processing_ms": 0.12684420851631437, "mean_env_wait_ms": 0.06788895611478225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026220083236694336, "StateBufferConnector_ms": 0.002709507942199707, "ViewRequirementAgentConnector_ms": 0.04832017421722412}, "num_episodes": 30, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 750.2058601515694, "num_env_steps_trained_throughput_per_sec": 750.2058601515694, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 5523.286, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5523.249, "sample_time_ms": 686.972, "learn_time_ms": 4824.884, "learn_throughput": 829.035, "synch_weights_time_ms": 11.027}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-38", "timestamp": 1723390298, "time_this_iter_s": 5.334963083267212, "time_total_s": 44.21407508850098, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a0c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44.21407508850098, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.5, "ram_util_percent": 82.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7013889340062935, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.605965475738048, "policy_loss": -0.006274361360313682, "vf_loss": 5.61125923593839, "vf_explained_var": 0.001852212722102801, "kl": 0.009806019431438617, "entropy": 1.307561465104421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.589026087646683, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.748437079538902, "policy_loss": -0.01293810695836631, "vf_loss": 5.758877776563168, "vf_explained_var": 0.10332009848207235, "kl": 0.012487066126252699, "entropy": 1.415466956049204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 157.97, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 15797, "policy_reward_min": {"prey_policy": -49.08195370274076, "predator_policy": 3.3795744963391554}, "policy_reward_max": {"prey_policy": -3.3795744963391554, "predator_policy": 49.08195370274076}, "policy_reward_mean": {"prey_policy": -25.725564122555937, "predator_policy": 25.725564122555937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [263, 170, 400, 400, 103, 207, 92, 122, 69, 276, 86, 387, 94, 346, 369, 130, 177, 104, 240, 68, 114, 306, 143, 104, 106, 164, 133, 127, 221, 137, 400, 194, 170, 73, 79, 48, 400, 154, 183, 91, 174, 374, 122, 96, 72, 57, 167, 139, 134, 93, 72, 102, 138, 119, 118, 149, 120, 400, 102, 117, 64, 54, 149, 206, 143, 116, 192, 74, 400, 123, 109, 85, 139, 73, 75, 169, 110, 95, 107, 107, 124, 77, 150, 400, 63, 133, 37, 183, 400, 181, 127, 118, 12, 154, 114, 237, 63, 116, 88, 115], "policy_prey_policy_reward": [-16.75003881613729, -16.956925370836732, -27.731650949991497, -27.821224345332567, -42.90094030167901, -27.81947027335227, -38.68570024970822, -31.082190157470702, -23.09924633307217, -10.573850148839188, -17.705001148227232, -26.730723022310105, -11.742505199299675, -14.583441860113108, -13.29648990623069, -20.520201573821108, -9.655632398351631, -39.1004345358215, -19.398338064258677, -37.559665119078744, -31.939581599920853, -40.75403217486906, -33.813439977610905, -13.33738385650727, -40.18094893137482, -24.91884972902395, -15.584315605668333, -43.377867339281934, -46.59979744266233, -38.453749326221455, -26.875199927991904, -14.808594311996625, -25.725910801839255, -3.900949729985505, -19.29408699753649, -5.558113392232819, -29.32503597525583, -13.563388405774514, -27.067346594743675, -25.29931969672561, -18.82423075187263, -37.84897217881729, -17.227350162759162, -42.474858942888105, -28.12825444438695, -17.7228759346627, -44.93152186184326, -35.44583984869638, -40.39309245258177, -18.27644481919253, -27.4274907657319, -34.76509462167511, -30.01644066190882, -37.95968449138951, -39.74133565086592, -28.732525295130266, -40.99944951807053, -15.814191865327205, -19.76135686424274, -32.747744059019475, -31.73314042456319, -17.3861946033832, -39.87947317797136, -26.067393396279726, -15.695356712268358, -14.840032615229351, -33.73686867778042, -7.5562214140806985, -24.430371540012302, -36.25725809901182, -36.32234243001727, -12.452273560193248, -21.243275988443507, -15.531264921618863, -28.939182151293, -49.08195370274076, -23.527281221855883, -32.76957411935993, -11.647609732882659, -41.522294447707196, -29.6108798458669, -31.43868039962765, -10.107210593191063, -13.127876911296706, -15.272741550357203, -40.20180887805361, -8.267674678265008, -33.08014736199303, -29.61669876544231, -42.26615679151191, -12.617629727054899, -28.993808940522293, -3.3795744963391554, -6.64406921515236, -30.664461988911057, -7.345695574133772, -33.585547260940054, -38.62641741960497, -18.972956404507777, -14.786675733911446], "policy_predator_policy_reward": [16.75003881613729, 16.956925370836732, 27.731650949991497, 27.821224345332567, 42.90094030167901, 27.81947027335227, 38.68570024970822, 31.082190157470702, 23.09924633307217, 10.573850148839188, 17.705001148227232, 26.730723022310105, 11.742505199299675, 14.583441860113108, 13.29648990623069, 20.520201573821108, 9.655632398351631, 39.1004345358215, 19.398338064258677, 37.559665119078744, 31.939581599920853, 40.75403217486906, 33.813439977610905, 13.33738385650727, 40.18094893137482, 24.91884972902395, 15.584315605668333, 43.377867339281934, 46.59979744266233, 38.453749326221455, 26.875199927991904, 14.808594311996625, 25.725910801839255, 3.900949729985505, 19.29408699753649, 5.558113392232819, 29.32503597525583, 13.563388405774514, 27.067346594743675, 25.29931969672561, 18.82423075187263, 37.84897217881729, 17.227350162759162, 42.474858942888105, 28.12825444438695, 17.7228759346627, 44.93152186184326, 35.44583984869638, 40.39309245258177, 18.27644481919253, 27.4274907657319, 34.76509462167511, 30.01644066190882, 37.95968449138951, 39.74133565086592, 28.732525295130266, 40.99944951807053, 15.814191865327205, 19.76135686424274, 32.747744059019475, 31.73314042456319, 17.3861946033832, 39.87947317797136, 26.067393396279726, 15.695356712268358, 14.840032615229351, 33.73686867778042, 7.5562214140806985, 24.430371540012302, 36.25725809901182, 36.32234243001727, 12.452273560193248, 21.243275988443507, 15.531264921618863, 28.939182151293, 49.08195370274076, 23.527281221855883, 32.76957411935993, 11.647609732882659, 41.522294447707196, 29.6108798458669, 31.43868039962765, 10.107210593191063, 13.127876911296706, 15.272741550357203, 40.20180887805361, 8.267674678265008, 33.08014736199303, 29.61669876544231, 42.26615679151191, 12.617629727054899, 28.993808940522293, 3.3795744963391554, 6.64406921515236, 30.664461988911057, 7.345695574133772, 33.585547260940054, 38.62641741960497, 18.972956404507777, 14.786675733911446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820206548145785, "mean_inference_ms": 0.9410059661064968, "mean_action_processing_ms": 0.1262610526309472, "mean_env_wait_ms": 0.06715720601232977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00260007381439209, "StateBufferConnector_ms": 0.0026798248291015625, "ViewRequirementAgentConnector_ms": 0.0483478307723999}, "num_episodes": 29, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 747.1987533338366, "num_env_steps_trained_throughput_per_sec": 747.1987533338366, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 5504.403, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5504.365, "sample_time_ms": 686.196, "learn_time_ms": 4806.919, "learn_throughput": 832.134, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-44", "timestamp": 1723390304, "time_this_iter_s": 5.356091737747192, "time_total_s": 49.57016682624817, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b0ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.57016682624817, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.424999999999997, "ram_util_percent": 82.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.786865320087721, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.295735134929418, "policy_loss": -0.0059616891284046385, "vf_loss": 5.300795995195707, "vf_explained_var": -0.8994493089616299, "kl": 0.009008280506499449, "entropy": 1.1790832041452328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.859010724319766, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.504612517356873, "policy_loss": -0.015654445377973995, "vf_loss": 5.517474236090978, "vf_explained_var": -0.9253699569652478, "kl": 0.013963565733542812, "entropy": 1.3516131710261106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 135.25, "episode_media": {}, "episodes_this_iter": 35, "episodes_timesteps_total": 13525, "policy_reward_min": {"prey_policy": -49.08195370274076, "predator_policy": 0.7502885048198094}, "policy_reward_max": {"prey_policy": -0.7502885048198094, "predator_policy": 49.08195370274076}, "policy_reward_mean": {"prey_policy": -25.677921414630397, "predator_policy": 25.677921414630397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [48, 400, 154, 183, 91, 174, 374, 122, 96, 72, 57, 167, 139, 134, 93, 72, 102, 138, 119, 118, 149, 120, 400, 102, 117, 64, 54, 149, 206, 143, 116, 192, 74, 400, 123, 109, 85, 139, 73, 75, 169, 110, 95, 107, 107, 124, 77, 150, 400, 63, 133, 37, 183, 400, 181, 127, 118, 12, 154, 114, 237, 63, 116, 88, 115, 311, 88, 98, 7, 71, 170, 81, 117, 80, 82, 110, 99, 108, 135, 321, 1, 120, 96, 107, 101, 246, 93, 65, 113, 164, 119, 85, 104, 277, 105, 108, 240, 69, 106, 105], "policy_prey_policy_reward": [-5.558113392232819, -29.32503597525583, -13.563388405774514, -27.067346594743675, -25.29931969672561, -18.82423075187263, -37.84897217881729, -17.227350162759162, -42.474858942888105, -28.12825444438695, -17.7228759346627, -44.93152186184326, -35.44583984869638, -40.39309245258177, -18.27644481919253, -27.4274907657319, -34.76509462167511, -30.01644066190882, -37.95968449138951, -39.74133565086592, -28.732525295130266, -40.99944951807053, -15.814191865327205, -19.76135686424274, -32.747744059019475, -31.73314042456319, -17.3861946033832, -39.87947317797136, -26.067393396279726, -15.695356712268358, -14.840032615229351, -33.73686867778042, -7.5562214140806985, -24.430371540012302, -36.25725809901182, -36.32234243001727, -12.452273560193248, -21.243275988443507, -15.531264921618863, -28.939182151293, -49.08195370274076, -23.527281221855883, -32.76957411935993, -11.647609732882659, -41.522294447707196, -29.6108798458669, -31.43868039962765, -10.107210593191063, -13.127876911296706, -15.272741550357203, -40.20180887805361, -8.267674678265008, -33.08014736199303, -29.61669876544231, -42.26615679151191, -12.617629727054899, -28.993808940522293, -3.3795744963391554, -6.64406921515236, -30.664461988911057, -7.345695574133772, -33.585547260940054, -38.62641741960497, -18.972956404507777, -14.786675733911446, -12.300983815659865, -40.30340832156114, -41.86827749843124, -0.9116028010910584, -3.999265065430733, -30.32964807161078, -27.902126539739918, -36.68108402023519, -10.750157267174714, -26.16994691947184, -36.65335469522784, -23.74781708692104, -8.31434990232493, -23.84625440549179, -46.39557441142239, -0.7502885048198094, -11.434454948916462, -44.08345148434969, -25.969047399739168, -42.54294783805042, -36.40317108452291, -14.389655745042012, -28.275137159560963, -30.389162407224184, -10.19014272432997, -40.40524822136385, -25.78598657947537, -20.182976689114376, -18.852713035987183, -8.42726942310189, -36.952517253016524, -21.787887874927915, -36.82476320795963, -20.18922949357367, -44.504204836998454], "policy_predator_policy_reward": [5.558113392232819, 29.32503597525583, 13.563388405774514, 27.067346594743675, 25.29931969672561, 18.82423075187263, 37.84897217881729, 17.227350162759162, 42.474858942888105, 28.12825444438695, 17.7228759346627, 44.93152186184326, 35.44583984869638, 40.39309245258177, 18.27644481919253, 27.4274907657319, 34.76509462167511, 30.01644066190882, 37.95968449138951, 39.74133565086592, 28.732525295130266, 40.99944951807053, 15.814191865327205, 19.76135686424274, 32.747744059019475, 31.73314042456319, 17.3861946033832, 39.87947317797136, 26.067393396279726, 15.695356712268358, 14.840032615229351, 33.73686867778042, 7.5562214140806985, 24.430371540012302, 36.25725809901182, 36.32234243001727, 12.452273560193248, 21.243275988443507, 15.531264921618863, 28.939182151293, 49.08195370274076, 23.527281221855883, 32.76957411935993, 11.647609732882659, 41.522294447707196, 29.6108798458669, 31.43868039962765, 10.107210593191063, 13.127876911296706, 15.272741550357203, 40.20180887805361, 8.267674678265008, 33.08014736199303, 29.61669876544231, 42.26615679151191, 12.617629727054899, 28.993808940522293, 3.3795744963391554, 6.64406921515236, 30.664461988911057, 7.345695574133772, 33.585547260940054, 38.62641741960497, 18.972956404507777, 14.786675733911446, 12.300983815659865, 40.30340832156114, 41.86827749843124, 0.9116028010910584, 3.999265065430733, 30.32964807161078, 27.902126539739918, 36.68108402023519, 10.750157267174714, 26.16994691947184, 36.65335469522784, 23.74781708692104, 8.31434990232493, 23.84625440549179, 46.39557441142239, 0.7502885048198094, 11.434454948916462, 44.08345148434969, 25.969047399739168, 42.54294783805042, 36.40317108452291, 14.389655745042012, 28.275137159560963, 30.389162407224184, 10.19014272432997, 40.40524822136385, 25.78598657947537, 20.182976689114376, 18.852713035987183, 8.42726942310189, 36.952517253016524, 21.787887874927915, 36.82476320795963, 20.18922949357367, 44.504204836998454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28306787349562135, "mean_inference_ms": 0.9413062377174148, "mean_action_processing_ms": 0.12620413900572333, "mean_env_wait_ms": 0.06712334598992617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026837587356567383, "StateBufferConnector_ms": 0.002055525779724121, "ViewRequirementAgentConnector_ms": 0.04943227767944336}, "num_episodes": 35, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 758.6741402892837, "num_env_steps_trained_throughput_per_sec": 758.6741402892837, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 5481.199, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5481.162, "sample_time_ms": 684.284, "learn_time_ms": 4785.728, "learn_throughput": 835.818, "synch_weights_time_ms": 10.796}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-49", "timestamp": 1723390309, "time_this_iter_s": 5.275321006774902, "time_total_s": 54.84548783302307, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b130bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54.84548783302307, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.1625, "ram_util_percent": 82.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6571563901379704, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5800791402657826, "policy_loss": -0.0072895351358359525, "vf_loss": 5.586308058599631, "vf_explained_var": -0.44328628219664096, "kl": 0.010606119637625049, "entropy": 1.2397454008460045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6571032796055079, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.742748709022999, "policy_loss": -0.0062070631446355645, "vf_loss": 5.747713022927443, "vf_explained_var": -0.45807721043626465, "kl": 0.006213708929987351, "entropy": 1.4407271016389132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 142.3, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 14230, "policy_reward_min": {"prey_policy": -52.219890959739146, "predator_policy": 0.7502885048198094}, "policy_reward_max": {"prey_policy": -0.7502885048198094, "predator_policy": 52.219890959739146}, "policy_reward_mean": {"prey_policy": -25.976310771849818, "predator_policy": 25.976310771849818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [118, 149, 120, 400, 102, 117, 64, 54, 149, 206, 143, 116, 192, 74, 400, 123, 109, 85, 139, 73, 75, 169, 110, 95, 107, 107, 124, 77, 150, 400, 63, 133, 37, 183, 400, 181, 127, 118, 12, 154, 114, 237, 63, 116, 88, 115, 311, 88, 98, 7, 71, 170, 81, 117, 80, 82, 110, 99, 108, 135, 321, 1, 120, 96, 107, 101, 246, 93, 65, 113, 164, 119, 85, 104, 277, 105, 108, 240, 69, 106, 105, 359, 101, 297, 83, 131, 174, 74, 91, 112, 191, 400, 122, 311, 123, 84, 175, 138, 74, 400], "policy_prey_policy_reward": [-39.74133565086592, -28.732525295130266, -40.99944951807053, -15.814191865327205, -19.76135686424274, -32.747744059019475, -31.73314042456319, -17.3861946033832, -39.87947317797136, -26.067393396279726, -15.695356712268358, -14.840032615229351, -33.73686867778042, -7.5562214140806985, -24.430371540012302, -36.25725809901182, -36.32234243001727, -12.452273560193248, -21.243275988443507, -15.531264921618863, -28.939182151293, -49.08195370274076, -23.527281221855883, -32.76957411935993, -11.647609732882659, -41.522294447707196, -29.6108798458669, -31.43868039962765, -10.107210593191063, -13.127876911296706, -15.272741550357203, -40.20180887805361, -8.267674678265008, -33.08014736199303, -29.61669876544231, -42.26615679151191, -12.617629727054899, -28.993808940522293, -3.3795744963391554, -6.64406921515236, -30.664461988911057, -7.345695574133772, -33.585547260940054, -38.62641741960497, -18.972956404507777, -14.786675733911446, -12.300983815659865, -40.30340832156114, -41.86827749843124, -0.9116028010910584, -3.999265065430733, -30.32964807161078, -27.902126539739918, -36.68108402023519, -10.750157267174714, -26.16994691947184, -36.65335469522784, -23.74781708692104, -8.31434990232493, -23.84625440549179, -46.39557441142239, -0.7502885048198094, -11.434454948916462, -44.08345148434969, -25.969047399739168, -42.54294783805042, -36.40317108452291, -14.389655745042012, -28.275137159560963, -30.389162407224184, -10.19014272432997, -40.40524822136385, -25.78598657947537, -20.182976689114376, -18.852713035987183, -8.42726942310189, -36.952517253016524, -21.787887874927915, -36.82476320795963, -20.18922949357367, -44.504204836998454, -47.5850636940697, -43.762539537059, -11.807264033511274, -16.696442294299256, -7.8916216828588075, -24.032741855857175, -22.10522413666179, -34.94819938592361, -18.30295303399948, -30.18186538048368, -46.43639067689102, -19.887273254093255, -23.96185708350987, -45.32721626816292, -52.219890959739146, -43.35386056252903, -35.54477197179198, -10.756419612064951, -27.29269630157534], "policy_predator_policy_reward": [39.74133565086592, 28.732525295130266, 40.99944951807053, 15.814191865327205, 19.76135686424274, 32.747744059019475, 31.73314042456319, 17.3861946033832, 39.87947317797136, 26.067393396279726, 15.695356712268358, 14.840032615229351, 33.73686867778042, 7.5562214140806985, 24.430371540012302, 36.25725809901182, 36.32234243001727, 12.452273560193248, 21.243275988443507, 15.531264921618863, 28.939182151293, 49.08195370274076, 23.527281221855883, 32.76957411935993, 11.647609732882659, 41.522294447707196, 29.6108798458669, 31.43868039962765, 10.107210593191063, 13.127876911296706, 15.272741550357203, 40.20180887805361, 8.267674678265008, 33.08014736199303, 29.61669876544231, 42.26615679151191, 12.617629727054899, 28.993808940522293, 3.3795744963391554, 6.64406921515236, 30.664461988911057, 7.345695574133772, 33.585547260940054, 38.62641741960497, 18.972956404507777, 14.786675733911446, 12.300983815659865, 40.30340832156114, 41.86827749843124, 0.9116028010910584, 3.999265065430733, 30.32964807161078, 27.902126539739918, 36.68108402023519, 10.750157267174714, 26.16994691947184, 36.65335469522784, 23.74781708692104, 8.31434990232493, 23.84625440549179, 46.39557441142239, 0.7502885048198094, 11.434454948916462, 44.08345148434969, 25.969047399739168, 42.54294783805042, 36.40317108452291, 14.389655745042012, 28.275137159560963, 30.389162407224184, 10.19014272432997, 40.40524822136385, 25.78598657947537, 20.182976689114376, 18.852713035987183, 8.42726942310189, 36.952517253016524, 21.787887874927915, 36.82476320795963, 20.18922949357367, 44.504204836998454, 47.5850636940697, 43.762539537059, 11.807264033511274, 16.696442294299256, 7.8916216828588075, 24.032741855857175, 22.10522413666179, 34.94819938592361, 18.30295303399948, 30.18186538048368, 46.43639067689102, 19.887273254093255, 23.96185708350987, 45.32721626816292, 52.219890959739146, 43.35386056252903, 35.54477197179198, 10.756419612064951, 27.29269630157534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28269044925894815, "mean_inference_ms": 0.9396369163490068, "mean_action_processing_ms": 0.12625326792110592, "mean_env_wait_ms": 0.06694728671548152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002668023109436035, "StateBufferConnector_ms": 0.002064943313598633, "ViewRequirementAgentConnector_ms": 0.049549221992492676}, "num_episodes": 19, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 748.2793409410617, "num_env_steps_trained_throughput_per_sec": 748.2793409410617, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 5430.662, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5430.626, "sample_time_ms": 667.367, "learn_time_ms": 4751.532, "learn_throughput": 841.834, "synch_weights_time_ms": 11.375}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "abfb9_00000", "date": "2024-08-11_11-31-54", "timestamp": 1723390314, "time_this_iter_s": 5.348695993423462, "time_total_s": 60.19418382644653, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.19418382644653, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 32.114285714285714, "ram_util_percent": 82.38571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8437323498229186, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.345570782820384, "policy_loss": -0.0061323173249547835, "vf_loss": 4.350759157786767, "vf_explained_var": 0.1881001672397057, "kl": 0.009439437340547663, "entropy": 1.1840784126271804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7733996939534942, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.529361693312724, "policy_loss": -0.010677240729273762, "vf_loss": 4.538036982218425, "vf_explained_var": 0.17499661681552728, "kl": 0.010009839088775485, "entropy": 1.3399358461300532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 137.87, "episode_media": {}, "episodes_this_iter": 34, "episodes_timesteps_total": 13787, "policy_reward_min": {"prey_policy": -52.219890959739146, "predator_policy": 0.7502885048198094}, "policy_reward_max": {"prey_policy": -0.7502885048198094, "predator_policy": 52.219890959739146}, "policy_reward_mean": {"prey_policy": -25.65269092443579, "predator_policy": 25.65269092443579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 181, 127, 118, 12, 154, 114, 237, 63, 116, 88, 115, 311, 88, 98, 7, 71, 170, 81, 117, 80, 82, 110, 99, 108, 135, 321, 1, 120, 96, 107, 101, 246, 93, 65, 113, 164, 119, 85, 104, 277, 105, 108, 240, 69, 106, 105, 359, 101, 297, 83, 131, 174, 74, 91, 112, 191, 400, 122, 311, 123, 84, 175, 138, 74, 400, 147, 44, 162, 178, 135, 54, 106, 128, 176, 110, 111, 38, 125, 109, 116, 169, 191, 84, 31, 155, 199, 95, 222, 328, 172, 3, 127, 198, 131, 119, 147, 71, 68, 71], "policy_prey_policy_reward": [-29.61669876544231, -42.26615679151191, -12.617629727054899, -28.993808940522293, -3.3795744963391554, -6.64406921515236, -30.664461988911057, -7.345695574133772, -33.585547260940054, -38.62641741960497, -18.972956404507777, -14.786675733911446, -12.300983815659865, -40.30340832156114, -41.86827749843124, -0.9116028010910584, -3.999265065430733, -30.32964807161078, -27.902126539739918, -36.68108402023519, -10.750157267174714, -26.16994691947184, -36.65335469522784, -23.74781708692104, -8.31434990232493, -23.84625440549179, -46.39557441142239, -0.7502885048198094, -11.434454948916462, -44.08345148434969, -25.969047399739168, -42.54294783805042, -36.40317108452291, -14.389655745042012, -28.275137159560963, -30.389162407224184, -10.19014272432997, -40.40524822136385, -25.78598657947537, -20.182976689114376, -18.852713035987183, -8.42726942310189, -36.952517253016524, -21.787887874927915, -36.82476320795963, -20.18922949357367, -44.504204836998454, -47.5850636940697, -43.762539537059, -11.807264033511274, -16.696442294299256, -7.8916216828588075, -24.032741855857175, -22.10522413666179, -34.94819938592361, -18.30295303399948, -30.18186538048368, -46.43639067689102, -19.887273254093255, -23.96185708350987, -45.32721626816292, -52.219890959739146, -43.35386056252903, -35.54477197179198, -10.756419612064951, -27.29269630157534, -25.843115017478457, -21.14590483269665, -16.291127330854906, -16.79773531528704, -30.778461811639346, -25.79964028527035, -12.625095074943095, -42.23749450872155, -23.391914514320234, -41.14042469084061, -46.41492576687318, -5.900622959034476, -35.920100198631225, -18.746098407623265, -32.473171782427464, -16.94376888476963, -17.18150454960462, -20.501509171083363, -17.06307132900551, -7.164799293971107, -9.805393405490303, -41.44614711563324, -33.521259818064394, -32.089046751980604, -8.842758752840789, -2.7165473666814575, -34.771655360863335, -28.583154471162096, -19.794225668295333, -30.768098201863396, -35.31656055717626, -30.991734772619235, -24.1502659627656, -40.003667736085234], "policy_predator_policy_reward": [29.61669876544231, 42.26615679151191, 12.617629727054899, 28.993808940522293, 3.3795744963391554, 6.64406921515236, 30.664461988911057, 7.345695574133772, 33.585547260940054, 38.62641741960497, 18.972956404507777, 14.786675733911446, 12.300983815659865, 40.30340832156114, 41.86827749843124, 0.9116028010910584, 3.999265065430733, 30.32964807161078, 27.902126539739918, 36.68108402023519, 10.750157267174714, 26.16994691947184, 36.65335469522784, 23.74781708692104, 8.31434990232493, 23.84625440549179, 46.39557441142239, 0.7502885048198094, 11.434454948916462, 44.08345148434969, 25.969047399739168, 42.54294783805042, 36.40317108452291, 14.389655745042012, 28.275137159560963, 30.389162407224184, 10.19014272432997, 40.40524822136385, 25.78598657947537, 20.182976689114376, 18.852713035987183, 8.42726942310189, 36.952517253016524, 21.787887874927915, 36.82476320795963, 20.18922949357367, 44.504204836998454, 47.5850636940697, 43.762539537059, 11.807264033511274, 16.696442294299256, 7.8916216828588075, 24.032741855857175, 22.10522413666179, 34.94819938592361, 18.30295303399948, 30.18186538048368, 46.43639067689102, 19.887273254093255, 23.96185708350987, 45.32721626816292, 52.219890959739146, 43.35386056252903, 35.54477197179198, 10.756419612064951, 27.29269630157534, 25.843115017478457, 21.14590483269665, 16.291127330854906, 16.79773531528704, 30.778461811639346, 25.79964028527035, 12.625095074943095, 42.23749450872155, 23.391914514320234, 41.14042469084061, 46.41492576687318, 5.900622959034476, 35.920100198631225, 18.746098407623265, 32.473171782427464, 16.94376888476963, 17.18150454960462, 20.501509171083363, 17.06307132900551, 7.164799293971107, 9.805393405490303, 41.44614711563324, 33.521259818064394, 32.089046751980604, 8.842758752840789, 2.7165473666814575, 34.771655360863335, 28.583154471162096, 19.794225668295333, 30.768098201863396, 35.31656055717626, 30.991734772619235, 24.1502659627656, 40.003667736085234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28541575573091593, "mean_inference_ms": 0.946779071830683, "mean_action_processing_ms": 0.12674521610951725, "mean_env_wait_ms": 0.06717480113385318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027588605880737305, "StateBufferConnector_ms": 0.0021190643310546875, "ViewRequirementAgentConnector_ms": 0.05339646339416504}, "num_episodes": 34, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.9309200450014, "num_env_steps_trained_throughput_per_sec": 709.9309200450014, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 5454.49, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5454.447, "sample_time_ms": 689.067, "learn_time_ms": 4753.04, "learn_throughput": 841.567, "synch_weights_time_ms": 11.943}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-00", "timestamp": 1723390320, "time_this_iter_s": 5.644351959228516, "time_total_s": 65.83853578567505, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.83853578567505, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.287499999999994, "ram_util_percent": 82.53750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7806856509608526, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.439465031276146, "policy_loss": -0.0032136283198875995, "vf_loss": 5.442147422333559, "vf_explained_var": -0.5944475511709849, "kl": 0.00531256785075177, "entropy": 1.1332568295300007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8294746396442254, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.534298244367043, "policy_loss": -0.0062920967286724284, "vf_loss": 5.539457892874877, "vf_explained_var": -0.7310756143182516, "kl": 0.005662129889913577, "entropy": 1.2846484868476788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 131.63, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 13163, "policy_reward_min": {"prey_policy": -52.219890959739146, "predator_policy": 2.7165473666814575}, "policy_reward_max": {"prey_policy": -2.7165473666814575, "predator_policy": 52.219890959739146}, "policy_reward_mean": {"prey_policy": -26.061089988342722, "predator_policy": 26.061089988342722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [104, 277, 105, 108, 240, 69, 106, 105, 359, 101, 297, 83, 131, 174, 74, 91, 112, 191, 400, 122, 311, 123, 84, 175, 138, 74, 400, 147, 44, 162, 178, 135, 54, 106, 128, 176, 110, 111, 38, 125, 109, 116, 169, 191, 84, 31, 155, 199, 95, 222, 328, 172, 3, 127, 198, 131, 119, 147, 71, 68, 71, 160, 93, 156, 62, 28, 72, 176, 36, 100, 60, 48, 221, 120, 112, 41, 176, 106, 36, 92, 59, 49, 135, 76, 103, 96, 109, 116, 244, 136, 80, 189, 69, 90, 225, 200, 188, 71, 69, 90], "policy_prey_policy_reward": [-20.182976689114376, -18.852713035987183, -8.42726942310189, -36.952517253016524, -21.787887874927915, -36.82476320795963, -20.18922949357367, -44.504204836998454, -47.5850636940697, -43.762539537059, -11.807264033511274, -16.696442294299256, -7.8916216828588075, -24.032741855857175, -22.10522413666179, -34.94819938592361, -18.30295303399948, -30.18186538048368, -46.43639067689102, -19.887273254093255, -23.96185708350987, -45.32721626816292, -52.219890959739146, -43.35386056252903, -35.54477197179198, -10.756419612064951, -27.29269630157534, -25.843115017478457, -21.14590483269665, -16.291127330854906, -16.79773531528704, -30.778461811639346, -25.79964028527035, -12.625095074943095, -42.23749450872155, -23.391914514320234, -41.14042469084061, -46.41492576687318, -5.900622959034476, -35.920100198631225, -18.746098407623265, -32.473171782427464, -16.94376888476963, -17.18150454960462, -20.501509171083363, -17.06307132900551, -7.164799293971107, -9.805393405490303, -41.44614711563324, -33.521259818064394, -32.089046751980604, -8.842758752840789, -2.7165473666814575, -34.771655360863335, -28.583154471162096, -19.794225668295333, -30.768098201863396, -35.31656055717626, -30.991734772619235, -24.1502659627656, -40.003667736085234, -19.854327561432136, -34.7231916355395, -36.812630986450486, -12.238855090092164, -21.020250905490585, -25.030985696909237, -19.149987143254513, -16.46496278620588, -27.26863053296966, -20.08052025026839, -14.546570876996865, -47.32343731095222, -38.12635033000683, -8.507101825583398, -13.270169454032049, -39.71465650196432, -29.227349499676283, -6.695837261742836, -21.227615644815323, -34.57729494925633, -14.610676578688834, -14.99095649240586, -47.256741609308705, -31.11916671124895, -24.140817961920778, -13.592430292057774, -42.453606893163425, -31.30194008297417, -5.743386813025763, -25.091518516709787, -22.566903598557047, -40.41946856589728, -48.69871906809101, -17.68318509676264, -24.23106548543768, -8.82679594972489, -13.280077348878388, -39.065847843381455, -38.198112476040976], "policy_predator_policy_reward": [20.182976689114376, 18.852713035987183, 8.42726942310189, 36.952517253016524, 21.787887874927915, 36.82476320795963, 20.18922949357367, 44.504204836998454, 47.5850636940697, 43.762539537059, 11.807264033511274, 16.696442294299256, 7.8916216828588075, 24.032741855857175, 22.10522413666179, 34.94819938592361, 18.30295303399948, 30.18186538048368, 46.43639067689102, 19.887273254093255, 23.96185708350987, 45.32721626816292, 52.219890959739146, 43.35386056252903, 35.54477197179198, 10.756419612064951, 27.29269630157534, 25.843115017478457, 21.14590483269665, 16.291127330854906, 16.79773531528704, 30.778461811639346, 25.79964028527035, 12.625095074943095, 42.23749450872155, 23.391914514320234, 41.14042469084061, 46.41492576687318, 5.900622959034476, 35.920100198631225, 18.746098407623265, 32.473171782427464, 16.94376888476963, 17.18150454960462, 20.501509171083363, 17.06307132900551, 7.164799293971107, 9.805393405490303, 41.44614711563324, 33.521259818064394, 32.089046751980604, 8.842758752840789, 2.7165473666814575, 34.771655360863335, 28.583154471162096, 19.794225668295333, 30.768098201863396, 35.31656055717626, 30.991734772619235, 24.1502659627656, 40.003667736085234, 19.854327561432136, 34.7231916355395, 36.812630986450486, 12.238855090092164, 21.020250905490585, 25.030985696909237, 19.149987143254513, 16.46496278620588, 27.26863053296966, 20.08052025026839, 14.546570876996865, 47.32343731095222, 38.12635033000683, 8.507101825583398, 13.270169454032049, 39.71465650196432, 29.227349499676283, 6.695837261742836, 21.227615644815323, 34.57729494925633, 14.610676578688834, 14.99095649240586, 47.256741609308705, 31.11916671124895, 24.140817961920778, 13.592430292057774, 42.453606893163425, 31.30194008297417, 5.743386813025763, 25.091518516709787, 22.566903598557047, 40.41946856589728, 48.69871906809101, 17.68318509676264, 24.23106548543768, 8.82679594972489, 13.280077348878388, 39.065847843381455, 38.198112476040976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28956290416456676, "mean_inference_ms": 0.9563275127588758, "mean_action_processing_ms": 0.12758131413468302, "mean_env_wait_ms": 0.0675879995238782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002892136573791504, "StateBufferConnector_ms": 0.003392934799194336, "ViewRequirementAgentConnector_ms": 0.05345046520233154}, "num_episodes": 39, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.4337232024072, "num_env_steps_trained_throughput_per_sec": 699.4337232024072, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 5466.198, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5466.136, "sample_time_ms": 684.819, "learn_time_ms": 4765.306, "learn_throughput": 839.4, "synch_weights_time_ms": 14.722}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-06", "timestamp": 1723390326, "time_this_iter_s": 5.751911163330078, "time_total_s": 71.59044694900513, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.59044694900513, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 47.275, "ram_util_percent": 82.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1468443820873895, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.812456317742666, "policy_loss": -0.005988004545118505, "vf_loss": 4.817735059310992, "vf_explained_var": -0.738619931663076, "kl": 0.0070926627074117945, "entropy": 1.1047290802001952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.068758851910631, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.9528202953437965, "policy_loss": -0.009654140367395788, "vf_loss": 4.960853338986635, "vf_explained_var": -0.6610619364927213, "kl": 0.008105459084339664, "entropy": 1.2358381399263938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 113.76, "episode_media": {}, "episodes_this_iter": 34, "episodes_timesteps_total": 11376, "policy_reward_min": {"prey_policy": -48.69871906809101, "predator_policy": 2.3426142496627937}, "policy_reward_max": {"prey_policy": -2.3426142496627937, "predator_policy": 48.69871906809101}, "policy_reward_mean": {"prey_policy": -24.64939559928942, "predator_policy": 24.64939559928942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [128, 176, 110, 111, 38, 125, 109, 116, 169, 191, 84, 31, 155, 199, 95, 222, 328, 172, 3, 127, 198, 131, 119, 147, 71, 68, 71, 160, 93, 156, 62, 28, 72, 176, 36, 100, 60, 48, 221, 120, 112, 41, 176, 106, 36, 92, 59, 49, 135, 76, 103, 96, 109, 116, 244, 136, 80, 189, 69, 90, 225, 200, 188, 71, 69, 90, 81, 63, 110, 138, 127, 65, 120, 94, 92, 97, 103, 142, 62, 133, 131, 101, 142, 160, 34, 82, 89, 192, 149, 179, 105, 56, 70, 85, 11, 52, 159, 70, 155, 144], "policy_prey_policy_reward": [-42.23749450872155, -23.391914514320234, -41.14042469084061, -46.41492576687318, -5.900622959034476, -35.920100198631225, -18.746098407623265, -32.473171782427464, -16.94376888476963, -17.18150454960462, -20.501509171083363, -17.06307132900551, -7.164799293971107, -9.805393405490303, -41.44614711563324, -33.521259818064394, -32.089046751980604, -8.842758752840789, -2.7165473666814575, -34.771655360863335, -28.583154471162096, -19.794225668295333, -30.768098201863396, -35.31656055717626, -30.991734772619235, -24.1502659627656, -40.003667736085234, -19.854327561432136, -34.7231916355395, -36.812630986450486, -12.238855090092164, -21.020250905490585, -25.030985696909237, -19.149987143254513, -16.46496278620588, -27.26863053296966, -20.08052025026839, -14.546570876996865, -47.32343731095222, -38.12635033000683, -8.507101825583398, -13.270169454032049, -39.71465650196432, -29.227349499676283, -6.695837261742836, -21.227615644815323, -34.57729494925633, -14.610676578688834, -14.99095649240586, -47.256741609308705, -31.11916671124895, -24.140817961920778, -13.592430292057774, -42.453606893163425, -31.30194008297417, -5.743386813025763, -25.091518516709787, -22.566903598557047, -40.41946856589728, -48.69871906809101, -17.68318509676264, -24.23106548543768, -8.82679594972489, -13.280077348878388, -39.065847843381455, -38.198112476040976, -28.327388696888015, -2.3426142496627937, -29.282804070629535, -17.24418979163316, -26.029562161025943, -15.551273227193507, -21.896784198122912, -35.01414652470448, -24.18038743846568, -17.76561516567454, -36.656527676083336, -39.664869407461, -29.385519861812554, -38.37400439875036, -13.51303768194686, -39.173183716838466, -13.536208838739475, -23.727752470574575, -4.000708786646474, -28.098436788684808, -35.175353952574184, -16.43563780120961, -19.849936599508652, -10.815729768929708, -25.856025162117078, -32.46397796313402, -26.858716303820604, -32.1961886671312, -8.998829612868482, -9.616553361937262, -12.675361247216632, -32.47471988239478, -15.126771157017664, -15.618677671202088], "policy_predator_policy_reward": [42.23749450872155, 23.391914514320234, 41.14042469084061, 46.41492576687318, 5.900622959034476, 35.920100198631225, 18.746098407623265, 32.473171782427464, 16.94376888476963, 17.18150454960462, 20.501509171083363, 17.06307132900551, 7.164799293971107, 9.805393405490303, 41.44614711563324, 33.521259818064394, 32.089046751980604, 8.842758752840789, 2.7165473666814575, 34.771655360863335, 28.583154471162096, 19.794225668295333, 30.768098201863396, 35.31656055717626, 30.991734772619235, 24.1502659627656, 40.003667736085234, 19.854327561432136, 34.7231916355395, 36.812630986450486, 12.238855090092164, 21.020250905490585, 25.030985696909237, 19.149987143254513, 16.46496278620588, 27.26863053296966, 20.08052025026839, 14.546570876996865, 47.32343731095222, 38.12635033000683, 8.507101825583398, 13.270169454032049, 39.71465650196432, 29.227349499676283, 6.695837261742836, 21.227615644815323, 34.57729494925633, 14.610676578688834, 14.99095649240586, 47.256741609308705, 31.11916671124895, 24.140817961920778, 13.592430292057774, 42.453606893163425, 31.30194008297417, 5.743386813025763, 25.091518516709787, 22.566903598557047, 40.41946856589728, 48.69871906809101, 17.68318509676264, 24.23106548543768, 8.82679594972489, 13.280077348878388, 39.065847843381455, 38.198112476040976, 28.327388696888015, 2.3426142496627937, 29.282804070629535, 17.24418979163316, 26.029562161025943, 15.551273227193507, 21.896784198122912, 35.01414652470448, 24.18038743846568, 17.76561516567454, 36.656527676083336, 39.664869407461, 29.385519861812554, 38.37400439875036, 13.51303768194686, 39.173183716838466, 13.536208838739475, 23.727752470574575, 4.000708786646474, 28.098436788684808, 35.175353952574184, 16.43563780120961, 19.849936599508652, 10.815729768929708, 25.856025162117078, 32.46397796313402, 26.858716303820604, 32.1961886671312, 8.998829612868482, 9.616553361937262, 12.675361247216632, 32.47471988239478, 15.126771157017664, 15.618677671202088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29537503126696785, "mean_inference_ms": 0.9773942473914885, "mean_action_processing_ms": 0.13127814737315194, "mean_env_wait_ms": 0.06930837417171296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002970099449157715, "StateBufferConnector_ms": 0.0035015344619750977, "ViewRequirementAgentConnector_ms": 0.05569624900817871}, "num_episodes": 34, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 627.7682607417262, "num_env_steps_trained_throughput_per_sec": 627.7682607417262, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 5560.14, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5560.073, "sample_time_ms": 744.883, "learn_time_ms": 4798.552, "learn_throughput": 833.585, "synch_weights_time_ms": 15.33}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-12", "timestamp": 1723390332, "time_this_iter_s": 6.377767086029053, "time_total_s": 77.96821403503418, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b0ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.96821403503418, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 49.4, "ram_util_percent": 82.02222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1883340063815315, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3718133114278315, "policy_loss": -0.004911483425045541, "vf_loss": 5.375959746042887, "vf_explained_var": -0.7198895351961255, "kl": 0.007650629782922605, "entropy": 1.0429113052164516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1014651263753574, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.285096923013528, "policy_loss": -0.004207682061921029, "vf_loss": 5.288202333450317, "vf_explained_var": -0.8076904859393835, "kl": 0.00551139471851095, "entropy": 1.2745011487354836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 106.11, "episode_media": {}, "episodes_this_iter": 44, "episodes_timesteps_total": 10611, "policy_reward_min": {"prey_policy": -53.37015570611558, "predator_policy": 0.9665066178021411}, "policy_reward_max": {"prey_policy": -0.9665066178021411, "predator_policy": 53.37015570611558}, "policy_reward_mean": {"prey_policy": -25.103956973009193, "predator_policy": 25.103956973009193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [36, 92, 59, 49, 135, 76, 103, 96, 109, 116, 244, 136, 80, 189, 69, 90, 225, 200, 188, 71, 69, 90, 81, 63, 110, 138, 127, 65, 120, 94, 92, 97, 103, 142, 62, 133, 131, 101, 142, 160, 34, 82, 89, 192, 149, 179, 105, 56, 70, 85, 11, 52, 159, 70, 155, 144, 134, 88, 76, 153, 86, 17, 95, 60, 7, 56, 89, 92, 220, 102, 111, 77, 99, 157, 101, 77, 158, 91, 41, 100, 142, 82, 106, 93, 113, 102, 93, 25, 20, 107, 135, 80, 257, 70, 78, 348, 155, 91, 2, 110], "policy_prey_policy_reward": [-6.695837261742836, -21.227615644815323, -34.57729494925633, -14.610676578688834, -14.99095649240586, -47.256741609308705, -31.11916671124895, -24.140817961920778, -13.592430292057774, -42.453606893163425, -31.30194008297417, -5.743386813025763, -25.091518516709787, -22.566903598557047, -40.41946856589728, -48.69871906809101, -17.68318509676264, -24.23106548543768, -8.82679594972489, -13.280077348878388, -39.065847843381455, -38.198112476040976, -28.327388696888015, -2.3426142496627937, -29.282804070629535, -17.24418979163316, -26.029562161025943, -15.551273227193507, -21.896784198122912, -35.01414652470448, -24.18038743846568, -17.76561516567454, -36.656527676083336, -39.664869407461, -29.385519861812554, -38.37400439875036, -13.51303768194686, -39.173183716838466, -13.536208838739475, -23.727752470574575, -4.000708786646474, -28.098436788684808, -35.175353952574184, -16.43563780120961, -19.849936599508652, -10.815729768929708, -25.856025162117078, -32.46397796313402, -26.858716303820604, -32.1961886671312, -8.998829612868482, -9.616553361937262, -12.675361247216632, -32.47471988239478, -15.126771157017664, -15.618677671202088, -15.604895095428748, -12.857447065091403, -35.685237067686494, -18.502146673841224, -30.219643164720495, -8.400904227346226, -31.858957255472696, -21.12367393376756, -7.045409458519636, -10.175952290213175, -47.22814392437939, -7.701374600135114, -12.35037352102145, -25.78262190666665, -48.440897306745065, -12.455888356328296, -47.31950988020631, -6.878155607515965, -22.789487102588406, -38.463462764792425, -53.37015570611558, -25.839902132705383, -13.48431307315055, -31.27559030258121, -39.05326169412585, -44.3321100905998, -28.850150832115162, -8.256008328685146, -45.83437963950846, -32.65740093705339, -47.15197960485269, -6.986656321226934, -8.041841293283682, -38.253671259211345, -44.168166600763115, -37.12714938974491, -30.048409940797832, -24.41855154162993, -17.670982463965185, -22.963862780313658, -9.457808185264629, -47.71755453160525, -0.9665066178021411, -47.88544328866075], "policy_predator_policy_reward": [6.695837261742836, 21.227615644815323, 34.57729494925633, 14.610676578688834, 14.99095649240586, 47.256741609308705, 31.11916671124895, 24.140817961920778, 13.592430292057774, 42.453606893163425, 31.30194008297417, 5.743386813025763, 25.091518516709787, 22.566903598557047, 40.41946856589728, 48.69871906809101, 17.68318509676264, 24.23106548543768, 8.82679594972489, 13.280077348878388, 39.065847843381455, 38.198112476040976, 28.327388696888015, 2.3426142496627937, 29.282804070629535, 17.24418979163316, 26.029562161025943, 15.551273227193507, 21.896784198122912, 35.01414652470448, 24.18038743846568, 17.76561516567454, 36.656527676083336, 39.664869407461, 29.385519861812554, 38.37400439875036, 13.51303768194686, 39.173183716838466, 13.536208838739475, 23.727752470574575, 4.000708786646474, 28.098436788684808, 35.175353952574184, 16.43563780120961, 19.849936599508652, 10.815729768929708, 25.856025162117078, 32.46397796313402, 26.858716303820604, 32.1961886671312, 8.998829612868482, 9.616553361937262, 12.675361247216632, 32.47471988239478, 15.126771157017664, 15.618677671202088, 15.604895095428748, 12.857447065091403, 35.685237067686494, 18.502146673841224, 30.219643164720495, 8.400904227346226, 31.858957255472696, 21.12367393376756, 7.045409458519636, 10.175952290213175, 47.22814392437939, 7.701374600135114, 12.35037352102145, 25.78262190666665, 48.440897306745065, 12.455888356328296, 47.31950988020631, 6.878155607515965, 22.789487102588406, 38.463462764792425, 53.37015570611558, 25.839902132705383, 13.48431307315055, 31.27559030258121, 39.05326169412585, 44.3321100905998, 28.850150832115162, 8.256008328685146, 45.83437963950846, 32.65740093705339, 47.15197960485269, 6.986656321226934, 8.041841293283682, 38.253671259211345, 44.168166600763115, 37.12714938974491, 30.048409940797832, 24.41855154162993, 17.670982463965185, 22.963862780313658, 9.457808185264629, 47.71755453160525, 0.9665066178021411, 47.88544328866075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30101553695184163, "mean_inference_ms": 0.9950539018131521, "mean_action_processing_ms": 0.1340476294705705, "mean_env_wait_ms": 0.07102090340862026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031282901763916016, "StateBufferConnector_ms": 0.0035228729248046875, "ViewRequirementAgentConnector_ms": 0.053237199783325195}, "num_episodes": 44, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 754.7608547380057, "num_env_steps_trained_throughput_per_sec": 754.7608547380057, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 5558.966, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5558.898, "sample_time_ms": 748.23, "learn_time_ms": 4793.992, "learn_throughput": 834.378, "synch_weights_time_ms": 15.369}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-18", "timestamp": 1723390338, "time_this_iter_s": 5.302711725234985, "time_total_s": 83.27092576026917, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.27092576026917, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.0875, "ram_util_percent": 81.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5273203713198504, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.036312340199947, "policy_loss": -0.005164299976119461, "vf_loss": 6.040748988091946, "vf_explained_var": -0.9574706925700108, "kl": 0.007276501330000538, "entropy": 1.0146403325721622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.316637668882807, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.088246125976244, "policy_loss": -0.005211334980655616, "vf_loss": 6.092776698370774, "vf_explained_var": -0.9680743294457594, "kl": 0.0034038457807883215, "entropy": 1.2656148797521989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 92.26, "episode_media": {}, "episodes_this_iter": 45, "episodes_timesteps_total": 9226, "policy_reward_min": {"prey_policy": -54.077362558560196, "predator_policy": 0.9665066178021411}, "policy_reward_max": {"prey_policy": -0.9665066178021411, "predator_policy": 54.077362558560196}, "policy_reward_mean": {"prey_policy": -25.764704082550324, "predator_policy": 25.764704082550324}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [179, 105, 56, 70, 85, 11, 52, 159, 70, 155, 144, 134, 88, 76, 153, 86, 17, 95, 60, 7, 56, 89, 92, 220, 102, 111, 77, 99, 157, 101, 77, 158, 91, 41, 100, 142, 82, 106, 93, 113, 102, 93, 25, 20, 107, 135, 80, 257, 70, 78, 348, 155, 91, 2, 110, 65, 75, 116, 81, 71, 219, 59, 111, 120, 77, 98, 67, 92, 93, 108, 89, 42, 67, 85, 66, 92, 82, 70, 48, 27, 50, 250, 111, 32, 182, 68, 73, 81, 49, 27, 71, 28, 44, 31, 69, 93, 54, 45, 74, 92], "policy_prey_policy_reward": [-10.815729768929708, -25.856025162117078, -32.46397796313402, -26.858716303820604, -32.1961886671312, -8.998829612868482, -9.616553361937262, -12.675361247216632, -32.47471988239478, -15.126771157017664, -15.618677671202088, -15.604895095428748, -12.857447065091403, -35.685237067686494, -18.502146673841224, -30.219643164720495, -8.400904227346226, -31.858957255472696, -21.12367393376756, -7.045409458519636, -10.175952290213175, -47.22814392437939, -7.701374600135114, -12.35037352102145, -25.78262190666665, -48.440897306745065, -12.455888356328296, -47.31950988020631, -6.878155607515965, -22.789487102588406, -38.463462764792425, -53.37015570611558, -25.839902132705383, -13.48431307315055, -31.27559030258121, -39.05326169412585, -44.3321100905998, -28.850150832115162, -8.256008328685146, -45.83437963950846, -32.65740093705339, -47.15197960485269, -6.986656321226934, -8.041841293283682, -38.253671259211345, -44.168166600763115, -37.12714938974491, -30.048409940797832, -24.41855154162993, -17.670982463965185, -22.963862780313658, -9.457808185264629, -47.71755453160525, -0.9665066178021411, -47.88544328866075, -34.45662235762518, -34.94815954040828, -8.302793819217689, -29.175165744392626, -32.31732398194518, -45.77533441794506, -18.843739120369648, -43.191420352019904, -54.077362558560196, -41.5416188683467, -19.75377806864431, -28.659943935861985, -26.738797715656677, -48.746294984675195, -46.769639289949254, -49.057889087166856, -12.354125058115017, -45.11097298076397, -30.407657038089184, -28.081211198988598, -12.55830848896932, -45.46827863778444, -19.019315524655827, -14.443897628275353, -9.984804529649082, -17.436075227487944, -38.79712542151266, -11.191250455287271, -10.148914079672746, -40.6402077538708, -16.916307437585356, -24.267085962075964, -28.585834556370266, -24.886498664927586, -18.677763958662005, -35.752219440864785, -11.900401029403564, -15.45445739983178, -8.557650710308936, -15.615125767784715, -32.18748740738915, -22.171639565383906, -9.329723078423218, -15.071644612761293, -9.700952241353905], "policy_predator_policy_reward": [10.815729768929708, 25.856025162117078, 32.46397796313402, 26.858716303820604, 32.1961886671312, 8.998829612868482, 9.616553361937262, 12.675361247216632, 32.47471988239478, 15.126771157017664, 15.618677671202088, 15.604895095428748, 12.857447065091403, 35.685237067686494, 18.502146673841224, 30.219643164720495, 8.400904227346226, 31.858957255472696, 21.12367393376756, 7.045409458519636, 10.175952290213175, 47.22814392437939, 7.701374600135114, 12.35037352102145, 25.78262190666665, 48.440897306745065, 12.455888356328296, 47.31950988020631, 6.878155607515965, 22.789487102588406, 38.463462764792425, 53.37015570611558, 25.839902132705383, 13.48431307315055, 31.27559030258121, 39.05326169412585, 44.3321100905998, 28.850150832115162, 8.256008328685146, 45.83437963950846, 32.65740093705339, 47.15197960485269, 6.986656321226934, 8.041841293283682, 38.253671259211345, 44.168166600763115, 37.12714938974491, 30.048409940797832, 24.41855154162993, 17.670982463965185, 22.963862780313658, 9.457808185264629, 47.71755453160525, 0.9665066178021411, 47.88544328866075, 34.45662235762518, 34.94815954040828, 8.302793819217689, 29.175165744392626, 32.31732398194518, 45.77533441794506, 18.843739120369648, 43.191420352019904, 54.077362558560196, 41.5416188683467, 19.75377806864431, 28.659943935861985, 26.738797715656677, 48.746294984675195, 46.769639289949254, 49.057889087166856, 12.354125058115017, 45.11097298076397, 30.407657038089184, 28.081211198988598, 12.55830848896932, 45.46827863778444, 19.019315524655827, 14.443897628275353, 9.984804529649082, 17.436075227487944, 38.79712542151266, 11.191250455287271, 10.148914079672746, 40.6402077538708, 16.916307437585356, 24.267085962075964, 28.585834556370266, 24.886498664927586, 18.677763958662005, 35.752219440864785, 11.900401029403564, 15.45445739983178, 8.557650710308936, 15.615125767784715, 32.18748740738915, 22.171639565383906, 9.329723078423218, 15.071644612761293, 9.700952241353905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30357512403409587, "mean_inference_ms": 1.0027528736319689, "mean_action_processing_ms": 0.1354948318994477, "mean_env_wait_ms": 0.0714512533995933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003034353256225586, "StateBufferConnector_ms": 0.002127408981323242, "ViewRequirementAgentConnector_ms": 0.04970502853393555}, "num_episodes": 45, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 752.9377973767566, "num_env_steps_trained_throughput_per_sec": 752.9377973767566, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 5524.836, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5524.769, "sample_time_ms": 750.078, "learn_time_ms": 4758.066, "learn_throughput": 840.678, "synch_weights_time_ms": 15.324}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-23", "timestamp": 1723390343, "time_this_iter_s": 5.315244197845459, "time_total_s": 88.58616995811462, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.58616995811462, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.662499999999998, "ram_util_percent": 81.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.502088772691786, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3725367650389675, "policy_loss": -0.003637060729670338, "vf_loss": 5.375757052749395, "vf_explained_var": -0.34971632876743874, "kl": 0.004167782476240384, "entropy": 1.0278443137183786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.315570372963945, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.948129615187645, "policy_loss": -0.007927793225098867, "vf_loss": 4.9548859864473345, "vf_explained_var": -0.4757058054829637, "kl": 0.011714226255188956, "entropy": 1.2903956096619367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 93.32, "episode_media": {}, "episodes_this_iter": 44, "episodes_timesteps_total": 9332, "policy_reward_min": {"prey_policy": -54.077362558560196, "predator_policy": 0.9665066178021411}, "policy_reward_max": {"prey_policy": -0.9665066178021411, "predator_policy": 54.077362558560196}, "policy_reward_mean": {"prey_policy": -26.48578756859395, "predator_policy": 26.48578756859395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [107, 135, 80, 257, 70, 78, 348, 155, 91, 2, 110, 65, 75, 116, 81, 71, 219, 59, 111, 120, 77, 98, 67, 92, 93, 108, 89, 42, 67, 85, 66, 92, 82, 70, 48, 27, 50, 250, 111, 32, 182, 68, 73, 81, 49, 27, 71, 28, 44, 31, 69, 93, 54, 45, 74, 92, 88, 72, 161, 77, 109, 96, 86, 89, 66, 141, 64, 45, 85, 85, 240, 122, 78, 142, 67, 61, 70, 58, 104, 74, 32, 74, 89, 51, 80, 260, 52, 89, 64, 126, 42, 177, 83, 70, 199, 87, 52, 99, 225, 24], "policy_prey_policy_reward": [-38.253671259211345, -44.168166600763115, -37.12714938974491, -30.048409940797832, -24.41855154162993, -17.670982463965185, -22.963862780313658, -9.457808185264629, -47.71755453160525, -0.9665066178021411, -47.88544328866075, -34.45662235762518, -34.94815954040828, -8.302793819217689, -29.175165744392626, -32.31732398194518, -45.77533441794506, -18.843739120369648, -43.191420352019904, -54.077362558560196, -41.5416188683467, -19.75377806864431, -28.659943935861985, -26.738797715656677, -48.746294984675195, -46.769639289949254, -49.057889087166856, -12.354125058115017, -45.11097298076397, -30.407657038089184, -28.081211198988598, -12.55830848896932, -45.46827863778444, -19.019315524655827, -14.443897628275353, -9.984804529649082, -17.436075227487944, -38.79712542151266, -11.191250455287271, -10.148914079672746, -40.6402077538708, -16.916307437585356, -24.267085962075964, -28.585834556370266, -24.886498664927586, -18.677763958662005, -35.752219440864785, -11.900401029403564, -15.45445739983178, -8.557650710308936, -15.615125767784715, -32.18748740738915, -22.171639565383906, -9.329723078423218, -15.071644612761293, -9.700952241353905, -40.9531618686745, -27.806785879988816, -25.08080878777898, -32.22803485371817, -5.4530403652342985, -22.740921174318526, -45.92330877499201, -12.326657424145207, -16.595720161876873, -18.276798467724632, -35.684570662224445, -8.86724364388496, -50.12960618247915, -18.200163282673465, -14.348029955095873, -13.602420007835207, -15.716934019398668, -10.815467141384321, -27.403131619045595, -32.20438636460125, -18.934331729492463, -25.41121890250644, -50.457881290204405, -31.68599815489659, -9.605960491832253, -47.46284042457741, -27.6446691584515, -34.26644320954325, -30.186582642594548, -44.811555442043925, -35.656493137052664, -14.327484828529721, -23.147694879732203, -12.397053298710484, -12.998767277201202, -29.049503173974525, -33.57345216197915, -40.459023567696164, -17.7937799340043, -32.85888729456051, -17.905273773299058, -41.21037464078201, -21.087127422131452, -13.538243087731967], "policy_predator_policy_reward": [38.253671259211345, 44.168166600763115, 37.12714938974491, 30.048409940797832, 24.41855154162993, 17.670982463965185, 22.963862780313658, 9.457808185264629, 47.71755453160525, 0.9665066178021411, 47.88544328866075, 34.45662235762518, 34.94815954040828, 8.302793819217689, 29.175165744392626, 32.31732398194518, 45.77533441794506, 18.843739120369648, 43.191420352019904, 54.077362558560196, 41.5416188683467, 19.75377806864431, 28.659943935861985, 26.738797715656677, 48.746294984675195, 46.769639289949254, 49.057889087166856, 12.354125058115017, 45.11097298076397, 30.407657038089184, 28.081211198988598, 12.55830848896932, 45.46827863778444, 19.019315524655827, 14.443897628275353, 9.984804529649082, 17.436075227487944, 38.79712542151266, 11.191250455287271, 10.148914079672746, 40.6402077538708, 16.916307437585356, 24.267085962075964, 28.585834556370266, 24.886498664927586, 18.677763958662005, 35.752219440864785, 11.900401029403564, 15.45445739983178, 8.557650710308936, 15.615125767784715, 32.18748740738915, 22.171639565383906, 9.329723078423218, 15.071644612761293, 9.700952241353905, 40.9531618686745, 27.806785879988816, 25.08080878777898, 32.22803485371817, 5.4530403652342985, 22.740921174318526, 45.92330877499201, 12.326657424145207, 16.595720161876873, 18.276798467724632, 35.684570662224445, 8.86724364388496, 50.12960618247915, 18.200163282673465, 14.348029955095873, 13.602420007835207, 15.716934019398668, 10.815467141384321, 27.403131619045595, 32.20438636460125, 18.934331729492463, 25.41121890250644, 50.457881290204405, 31.68599815489659, 9.605960491832253, 47.46284042457741, 27.6446691584515, 34.26644320954325, 30.186582642594548, 44.811555442043925, 35.656493137052664, 14.327484828529721, 23.147694879732203, 12.397053298710484, 12.998767277201202, 29.049503173974525, 33.57345216197915, 40.459023567696164, 17.7937799340043, 32.85888729456051, 17.905273773299058, 41.21037464078201, 21.087127422131452, 13.538243087731967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30249365480168966, "mean_inference_ms": 0.9971338342552178, "mean_action_processing_ms": 0.133954104236318, "mean_env_wait_ms": 0.07112380922169051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035222768783569336, "StateBufferConnector_ms": 0.002031564712524414, "ViewRequirementAgentConnector_ms": 0.04699575901031494}, "num_episodes": 44, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.0084305775999, "num_env_steps_trained_throughput_per_sec": 713.0084305775999, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 5525.058, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5524.991, "sample_time_ms": 741.001, "learn_time_ms": 4766.79, "learn_throughput": 839.139, "synch_weights_time_ms": 15.885}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-28", "timestamp": 1723390348, "time_this_iter_s": 5.614713907241821, "time_total_s": 94.20088386535645, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a0160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.20088386535645, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.28750000000001, "ram_util_percent": 81.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.487770870514214, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3065780706703665, "policy_loss": -0.0043882145182578824, "vf_loss": 4.310648513585329, "vf_explained_var": -0.2462726985414823, "kl": 0.006355463359849179, "entropy": 0.9719737185165286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3468628484755754, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.400668054819107, "policy_loss": -0.006394359029218322, "vf_loss": 4.4062028874953585, "vf_explained_var": -0.3600614804774523, "kl": 0.008595149603810212, "entropy": 1.298949700842301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 87.41, "episode_media": {}, "episodes_this_iter": 45, "episodes_timesteps_total": 8741, "policy_reward_min": {"prey_policy": -50.457881290204405, "predator_policy": 2.6510386512164446}, "policy_reward_max": {"prey_policy": -2.6510386512164446, "predator_policy": 50.457881290204405}, "policy_reward_mean": {"prey_policy": -24.451604139920697, "predator_policy": 24.451604139920697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [27, 71, 28, 44, 31, 69, 93, 54, 45, 74, 92, 88, 72, 161, 77, 109, 96, 86, 89, 66, 141, 64, 45, 85, 85, 240, 122, 78, 142, 67, 61, 70, 58, 104, 74, 32, 74, 89, 51, 80, 260, 52, 89, 64, 126, 42, 177, 83, 70, 199, 87, 52, 99, 225, 24, 95, 73, 58, 83, 100, 69, 48, 96, 90, 73, 73, 311, 43, 21, 75, 85, 123, 81, 106, 129, 84, 78, 65, 75, 70, 74, 62, 77, 40, 127, 54, 58, 85, 46, 41, 86, 96, 68, 71, 57, 86, 70, 34, 83, 339], "policy_prey_policy_reward": [-18.677763958662005, -35.752219440864785, -11.900401029403564, -15.45445739983178, -8.557650710308936, -15.615125767784715, -32.18748740738915, -22.171639565383906, -9.329723078423218, -15.071644612761293, -9.700952241353905, -40.9531618686745, -27.806785879988816, -25.08080878777898, -32.22803485371817, -5.4530403652342985, -22.740921174318526, -45.92330877499201, -12.326657424145207, -16.595720161876873, -18.276798467724632, -35.684570662224445, -8.86724364388496, -50.12960618247915, -18.200163282673465, -14.348029955095873, -13.602420007835207, -15.716934019398668, -10.815467141384321, -27.403131619045595, -32.20438636460125, -18.934331729492463, -25.41121890250644, -50.457881290204405, -31.68599815489659, -9.605960491832253, -47.46284042457741, -27.6446691584515, -34.26644320954325, -30.186582642594548, -44.811555442043925, -35.656493137052664, -14.327484828529721, -23.147694879732203, -12.397053298710484, -12.998767277201202, -29.049503173974525, -33.57345216197915, -40.459023567696164, -17.7937799340043, -32.85888729456051, -17.905273773299058, -41.21037464078201, -21.087127422131452, -13.538243087731967, -34.734358065433916, -37.62021289728368, -21.836314832739227, -18.550847769831208, -23.333211205840115, -20.624628682242793, -23.450801684028246, -30.104400109327663, -39.16936295287081, -29.103714627056323, -37.61300699140853, -27.25379174050242, -14.667558797894436, -2.6510386512164446, -29.019087026768155, -31.028213239554194, -49.106202543413076, -26.487072150107476, -38.36715697876224, -11.327760400218883, -41.128984929413825, -40.12334087635408, -11.028772605738396, -19.823594681900524, -38.17448949574166, -36.142357238046735, -26.825379918470777, -8.128714814453868, -14.006548661546079, -9.046851849965925, -25.020773521724426, -17.658397391501147, -33.26122294094587, -18.475069027705356, -7.407976851790085, -41.091544561740044, -28.137293089030212, -22.952630026714694, -34.14129448876755, -15.913179108189052, -32.71132112015507, -7.791440461487118, -6.20772321069148, -20.94532461403953, -7.720551386685919], "policy_predator_policy_reward": [18.677763958662005, 35.752219440864785, 11.900401029403564, 15.45445739983178, 8.557650710308936, 15.615125767784715, 32.18748740738915, 22.171639565383906, 9.329723078423218, 15.071644612761293, 9.700952241353905, 40.9531618686745, 27.806785879988816, 25.08080878777898, 32.22803485371817, 5.4530403652342985, 22.740921174318526, 45.92330877499201, 12.326657424145207, 16.595720161876873, 18.276798467724632, 35.684570662224445, 8.86724364388496, 50.12960618247915, 18.200163282673465, 14.348029955095873, 13.602420007835207, 15.716934019398668, 10.815467141384321, 27.403131619045595, 32.20438636460125, 18.934331729492463, 25.41121890250644, 50.457881290204405, 31.68599815489659, 9.605960491832253, 47.46284042457741, 27.6446691584515, 34.26644320954325, 30.186582642594548, 44.811555442043925, 35.656493137052664, 14.327484828529721, 23.147694879732203, 12.397053298710484, 12.998767277201202, 29.049503173974525, 33.57345216197915, 40.459023567696164, 17.7937799340043, 32.85888729456051, 17.905273773299058, 41.21037464078201, 21.087127422131452, 13.538243087731967, 34.734358065433916, 37.62021289728368, 21.836314832739227, 18.550847769831208, 23.333211205840115, 20.624628682242793, 23.450801684028246, 30.104400109327663, 39.16936295287081, 29.103714627056323, 37.61300699140853, 27.25379174050242, 14.667558797894436, 2.6510386512164446, 29.019087026768155, 31.028213239554194, 49.106202543413076, 26.487072150107476, 38.36715697876224, 11.327760400218883, 41.128984929413825, 40.12334087635408, 11.028772605738396, 19.823594681900524, 38.17448949574166, 36.142357238046735, 26.825379918470777, 8.128714814453868, 14.006548661546079, 9.046851849965925, 25.020773521724426, 17.658397391501147, 33.26122294094587, 18.475069027705356, 7.407976851790085, 41.091544561740044, 28.137293089030212, 22.952630026714694, 34.14129448876755, 15.913179108189052, 32.71132112015507, 7.791440461487118, 6.20772321069148, 20.94532461403953, 7.720551386685919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30087957225854445, "mean_inference_ms": 0.990145267830955, "mean_action_processing_ms": 0.13309551430666602, "mean_env_wait_ms": 0.07082007431381061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003603816032409668, "StateBufferConnector_ms": 0.0020415782928466797, "ViewRequirementAgentConnector_ms": 0.049231886863708496}, "num_episodes": 45, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 688.4740980805867, "num_env_steps_trained_throughput_per_sec": 688.4740980805867, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 5572.867, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5572.799, "sample_time_ms": 739.531, "learn_time_ms": 4815.987, "learn_throughput": 830.567, "synch_weights_time_ms": 15.975}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-34", "timestamp": 1723390354, "time_this_iter_s": 5.815173149108887, "time_total_s": 100.01605701446533, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.01605701446533, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.6875, "ram_util_percent": 81.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5226040709763766, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.109643807510535, "policy_loss": -0.004291537388053257, "vf_loss": 5.1135096048315365, "vf_explained_var": -0.9655995411177476, "kl": 0.008514902509956564, "entropy": 0.9324993671228489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4809101237605016, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.033151723444462, "policy_loss": -0.005154430085046139, "vf_loss": 5.036697603017092, "vf_explained_var": -0.9705413288126389, "kl": 0.016085458713193806, "entropy": 1.28420986396571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 79.79, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 7979, "policy_reward_min": {"prey_policy": -49.106202543413076, "predator_policy": 2.6510386512164446}, "policy_reward_max": {"prey_policy": -2.6510386512164446, "predator_policy": 49.106202543413076}, "policy_reward_mean": {"prey_policy": -24.577589772636316, "predator_policy": 24.577589772636316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [73, 58, 83, 100, 69, 48, 96, 90, 73, 73, 311, 43, 21, 75, 85, 123, 81, 106, 129, 84, 78, 65, 75, 70, 74, 62, 77, 40, 127, 54, 58, 85, 46, 41, 86, 96, 68, 71, 57, 86, 70, 34, 83, 339, 69, 109, 79, 44, 80, 84, 62, 91, 69, 19, 40, 50, 61, 58, 107, 128, 77, 72, 55, 41, 14, 83, 39, 209, 94, 83, 46, 103, 71, 71, 100, 70, 27, 124, 49, 57, 108, 165, 69, 44, 66, 41, 13, 62, 29, 23, 150, 91, 60, 65, 102, 80, 170, 87, 116, 40], "policy_prey_policy_reward": [-37.62021289728368, -21.836314832739227, -18.550847769831208, -23.333211205840115, -20.624628682242793, -23.450801684028246, -30.104400109327663, -39.16936295287081, -29.103714627056323, -37.61300699140853, -27.25379174050242, -14.667558797894436, -2.6510386512164446, -29.019087026768155, -31.028213239554194, -49.106202543413076, -26.487072150107476, -38.36715697876224, -11.327760400218883, -41.128984929413825, -40.12334087635408, -11.028772605738396, -19.823594681900524, -38.17448949574166, -36.142357238046735, -26.825379918470777, -8.128714814453868, -14.006548661546079, -9.046851849965925, -25.020773521724426, -17.658397391501147, -33.26122294094587, -18.475069027705356, -7.407976851790085, -41.091544561740044, -28.137293089030212, -22.952630026714694, -34.14129448876755, -15.913179108189052, -32.71132112015507, -7.791440461487118, -6.20772321069148, -20.94532461403953, -7.720551386685919, -46.72653085214502, -21.579973317913073, -40.130632431918286, -3.4492675059743716, -30.583102499850064, -27.106811014180813, -32.20725624349819, -39.137823234368724, -40.39272316622616, -12.048766437721662, -13.768528331621615, -22.344974546907327, -31.912014686126053, -34.381520614509185, -18.304255562268025, -38.54240536004061, -39.53145850437224, -34.43028116658643, -5.8063198631263795, -5.376849558720804, -5.945819060511959, -5.178373212734755, -10.416914870351167, -26.592193124457516, -14.140499528712997, -20.910639708888564, -23.519815060128153, -29.92830141011869, -32.85744033441181, -23.328112098811, -45.14506030153763, -44.594984828690535, -8.997022756288093, -19.96609581174408, -15.990645722491681, -32.660472679548995, -42.39745254338199, -46.34937402857159, -18.969924105702837, -4.214673366361014, -22.587153560035468, -15.226268234898907, -2.6920552494846572, -28.4616245594835, -8.792574740426272, -12.197011958857264, -14.715440615673987, -27.123798949111162, -3.258161037456137, -42.91975342388232, -48.48048763350491, -39.62257776295592, -18.597964458714994, -39.75256107778358, -25.773399389577776, -22.513675006399726], "policy_predator_policy_reward": [37.62021289728368, 21.836314832739227, 18.550847769831208, 23.333211205840115, 20.624628682242793, 23.450801684028246, 30.104400109327663, 39.16936295287081, 29.103714627056323, 37.61300699140853, 27.25379174050242, 14.667558797894436, 2.6510386512164446, 29.019087026768155, 31.028213239554194, 49.106202543413076, 26.487072150107476, 38.36715697876224, 11.327760400218883, 41.128984929413825, 40.12334087635408, 11.028772605738396, 19.823594681900524, 38.17448949574166, 36.142357238046735, 26.825379918470777, 8.128714814453868, 14.006548661546079, 9.046851849965925, 25.020773521724426, 17.658397391501147, 33.26122294094587, 18.475069027705356, 7.407976851790085, 41.091544561740044, 28.137293089030212, 22.952630026714694, 34.14129448876755, 15.913179108189052, 32.71132112015507, 7.791440461487118, 6.20772321069148, 20.94532461403953, 7.720551386685919, 46.72653085214502, 21.579973317913073, 40.130632431918286, 3.4492675059743716, 30.583102499850064, 27.106811014180813, 32.20725624349819, 39.137823234368724, 40.39272316622616, 12.048766437721662, 13.768528331621615, 22.344974546907327, 31.912014686126053, 34.381520614509185, 18.304255562268025, 38.54240536004061, 39.53145850437224, 34.43028116658643, 5.8063198631263795, 5.376849558720804, 5.945819060511959, 5.178373212734755, 10.416914870351167, 26.592193124457516, 14.140499528712997, 20.910639708888564, 23.519815060128153, 29.92830141011869, 32.85744033441181, 23.328112098811, 45.14506030153763, 44.594984828690535, 8.997022756288093, 19.96609581174408, 15.990645722491681, 32.660472679548995, 42.39745254338199, 46.34937402857159, 18.969924105702837, 4.214673366361014, 22.587153560035468, 15.226268234898907, 2.6920552494846572, 28.4616245594835, 8.792574740426272, 12.197011958857264, 14.715440615673987, 27.123798949111162, 3.258161037456137, 42.91975342388232, 48.48048763350491, 39.62257776295592, 18.597964458714994, 39.75256107778358, 25.773399389577776, 22.513675006399726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.298856964218486, "mean_inference_ms": 0.9836251604757967, "mean_action_processing_ms": 0.13294367297156254, "mean_env_wait_ms": 0.07050896341099885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889275550842285, "StateBufferConnector_ms": 0.002156496047973633, "ViewRequirementAgentConnector_ms": 0.055524230003356934}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 659.4671666660836, "num_env_steps_trained_throughput_per_sec": 659.4671666660836, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 5644.084, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5644.016, "sample_time_ms": 738.616, "learn_time_ms": 4886.848, "learn_throughput": 818.524, "synch_weights_time_ms": 17.222}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-40", "timestamp": 1723390360, "time_this_iter_s": 6.071295976638794, "time_total_s": 106.08735299110413, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b12aec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.08735299110413, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 30.775, "ram_util_percent": 82.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9778071763614813, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.8741490965088206, "policy_loss": -0.008383377187419683, "vf_loss": 4.8821167205770815, "vf_explained_var": -0.5654659553741416, "kl": 0.008315004059731497, "entropy": 0.9588192124540608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.615200494105617, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.562208116054535, "policy_loss": -0.0029698110248621862, "vf_loss": 4.5646203192571795, "vf_explained_var": -0.6658135420332353, "kl": 0.005576005722255706, "entropy": 1.2601995124171177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 76.29, "episode_media": {}, "episodes_this_iter": 51, "episodes_timesteps_total": 7629, "policy_reward_min": {"prey_policy": -52.89433163507157, "predator_policy": 2.6920552494846572}, "policy_reward_max": {"prey_policy": -2.6920552494846572, "predator_policy": 52.89433163507157}, "policy_reward_mean": {"prey_policy": -25.028146722368795, "predator_policy": 25.028146722368795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [91, 69, 19, 40, 50, 61, 58, 107, 128, 77, 72, 55, 41, 14, 83, 39, 209, 94, 83, 46, 103, 71, 71, 100, 70, 27, 124, 49, 57, 108, 165, 69, 44, 66, 41, 13, 62, 29, 23, 150, 91, 60, 65, 102, 80, 170, 87, 116, 40, 48, 58, 50, 72, 56, 142, 88, 35, 70, 68, 128, 99, 89, 47, 116, 81, 45, 86, 55, 62, 52, 71, 64, 75, 55, 109, 157, 93, 55, 34, 62, 12, 129, 121, 39, 79, 109, 58, 74, 120, 111, 71, 133, 91, 52, 87, 71, 94, 92, 49, 26], "policy_prey_policy_reward": [-39.137823234368724, -40.39272316622616, -12.048766437721662, -13.768528331621615, -22.344974546907327, -31.912014686126053, -34.381520614509185, -18.304255562268025, -38.54240536004061, -39.53145850437224, -34.43028116658643, -5.8063198631263795, -5.376849558720804, -5.945819060511959, -5.178373212734755, -10.416914870351167, -26.592193124457516, -14.140499528712997, -20.910639708888564, -23.519815060128153, -29.92830141011869, -32.85744033441181, -23.328112098811, -45.14506030153763, -44.594984828690535, -8.997022756288093, -19.96609581174408, -15.990645722491681, -32.660472679548995, -42.39745254338199, -46.34937402857159, -18.969924105702837, -4.214673366361014, -22.587153560035468, -15.226268234898907, -2.6920552494846572, -28.4616245594835, -8.792574740426272, -12.197011958857264, -14.715440615673987, -27.123798949111162, -3.258161037456137, -42.91975342388232, -48.48048763350491, -39.62257776295592, -18.597964458714994, -39.75256107778358, -25.773399389577776, -22.513675006399726, -11.117876196815141, -15.244834846582894, -33.989080356581326, -21.82745506401753, -20.159351982189115, -14.510639884071441, -22.59437816831553, -14.85678145501877, -2.7286707431564743, -31.714079063348485, -24.31587157720154, -37.27666023430393, -46.968607111118104, -24.556970439949357, -34.58974025340828, -33.22307245333626, -4.517200540812181, -28.539800962649913, -32.708585242586686, -37.52326203389519, -30.5350335964537, -24.961010737948943, -30.477333529692856, -34.548830642499205, -27.94888140766965, -36.2623427132892, -28.440507890312862, -18.29146117545813, -29.396107702614927, -3.993010459265372, -33.51807096199631, -5.997557043858518, -36.26381416147092, -48.930341347309934, -14.778758830716738, -31.737419077268346, -51.65665591654276, -20.210017481087796, -37.58624270616531, -52.89433163507157, -32.05084990219413, -8.208805979247174, -24.594812061743973, -29.970210142843197, -23.20671331232331, -24.72612979632907, -10.481593654611075, -18.35063468863358, -21.826195589598353, -14.924523530397453, -22.287312708620878], "policy_predator_policy_reward": [39.137823234368724, 40.39272316622616, 12.048766437721662, 13.768528331621615, 22.344974546907327, 31.912014686126053, 34.381520614509185, 18.304255562268025, 38.54240536004061, 39.53145850437224, 34.43028116658643, 5.8063198631263795, 5.376849558720804, 5.945819060511959, 5.178373212734755, 10.416914870351167, 26.592193124457516, 14.140499528712997, 20.910639708888564, 23.519815060128153, 29.92830141011869, 32.85744033441181, 23.328112098811, 45.14506030153763, 44.594984828690535, 8.997022756288093, 19.96609581174408, 15.990645722491681, 32.660472679548995, 42.39745254338199, 46.34937402857159, 18.969924105702837, 4.214673366361014, 22.587153560035468, 15.226268234898907, 2.6920552494846572, 28.4616245594835, 8.792574740426272, 12.197011958857264, 14.715440615673987, 27.123798949111162, 3.258161037456137, 42.91975342388232, 48.48048763350491, 39.62257776295592, 18.597964458714994, 39.75256107778358, 25.773399389577776, 22.513675006399726, 11.117876196815141, 15.244834846582894, 33.989080356581326, 21.82745506401753, 20.159351982189115, 14.510639884071441, 22.59437816831553, 14.85678145501877, 2.7286707431564743, 31.714079063348485, 24.31587157720154, 37.27666023430393, 46.968607111118104, 24.556970439949357, 34.58974025340828, 33.22307245333626, 4.517200540812181, 28.539800962649913, 32.708585242586686, 37.52326203389519, 30.5350335964537, 24.961010737948943, 30.477333529692856, 34.548830642499205, 27.94888140766965, 36.2623427132892, 28.440507890312862, 18.29146117545813, 29.396107702614927, 3.993010459265372, 33.51807096199631, 5.997557043858518, 36.26381416147092, 48.930341347309934, 14.778758830716738, 31.737419077268346, 51.65665591654276, 20.210017481087796, 37.58624270616531, 52.89433163507157, 32.05084990219413, 8.208805979247174, 24.594812061743973, 29.970210142843197, 23.20671331232331, 24.72612979632907, 10.481593654611075, 18.35063468863358, 21.826195589598353, 14.924523530397453, 22.287312708620878]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29823448233096406, "mean_inference_ms": 0.9813883734564137, "mean_action_processing_ms": 0.13247957268841545, "mean_env_wait_ms": 0.07020766352140129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028525590896606445, "StateBufferConnector_ms": 0.0022063255310058594, "ViewRequirementAgentConnector_ms": 0.05478107929229736}, "num_episodes": 51, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 680.8742463737938, "num_env_steps_trained_throughput_per_sec": 680.8742463737938, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 5704.329, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5704.26, "sample_time_ms": 736.204, "learn_time_ms": 4949.179, "learn_throughput": 808.215, "synch_weights_time_ms": 17.55}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-46", "timestamp": 1723390366, "time_this_iter_s": 5.879343748092651, "time_total_s": 111.96669673919678, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b6430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.96669673919678, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.288888888888888, "ram_util_percent": 82.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1951021355887255, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.032619195679824, "policy_loss": -0.004815654751049199, "vf_loss": 5.036964305738608, "vf_explained_var": -0.7650575211271644, "kl": 0.009411161209519313, "entropy": 0.897501134686172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.880088647579153, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.632810086260239, "policy_loss": -0.006143976014088063, "vf_loss": 4.638180952270826, "vf_explained_var": -0.8160373477265239, "kl": 0.007731079171548641, "entropy": 1.206894567484657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 78.85, "episode_media": {}, "episodes_this_iter": 52, "episodes_timesteps_total": 7885, "policy_reward_min": {"prey_policy": -53.65929625844289, "predator_policy": 2.7286707431564743}, "policy_reward_max": {"prey_policy": -2.7286707431564743, "predator_policy": 53.65929625844289}, "policy_reward_mean": {"prey_policy": -26.789473385674906, "predator_policy": 26.789473385674906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [72, 56, 142, 88, 35, 70, 68, 128, 99, 89, 47, 116, 81, 45, 86, 55, 62, 52, 71, 64, 75, 55, 109, 157, 93, 55, 34, 62, 12, 129, 121, 39, 79, 109, 58, 74, 120, 111, 71, 133, 91, 52, 87, 71, 94, 92, 49, 26, 77, 115, 67, 87, 69, 78, 122, 64, 75, 60, 98, 31, 66, 124, 67, 54, 68, 134, 63, 36, 73, 71, 74, 127, 49, 86, 88, 75, 83, 120, 107, 97, 97, 65, 73, 61, 60, 52, 86, 77, 71, 12, 65, 101, 55, 94, 52, 124, 84, 130, 51, 86], "policy_prey_policy_reward": [-21.82745506401753, -20.159351982189115, -14.510639884071441, -22.59437816831553, -14.85678145501877, -2.7286707431564743, -31.714079063348485, -24.31587157720154, -37.27666023430393, -46.968607111118104, -24.556970439949357, -34.58974025340828, -33.22307245333626, -4.517200540812181, -28.539800962649913, -32.708585242586686, -37.52326203389519, -30.5350335964537, -24.961010737948943, -30.477333529692856, -34.548830642499205, -27.94888140766965, -36.2623427132892, -28.440507890312862, -18.29146117545813, -29.396107702614927, -3.993010459265372, -33.51807096199631, -5.997557043858518, -36.26381416147092, -48.930341347309934, -14.778758830716738, -31.737419077268346, -51.65665591654276, -20.210017481087796, -37.58624270616531, -52.89433163507157, -32.05084990219413, -8.208805979247174, -24.594812061743973, -29.970210142843197, -23.20671331232331, -24.72612979632907, -10.481593654611075, -18.35063468863358, -21.826195589598353, -14.924523530397453, -22.287312708620878, -30.914713452196164, -32.88194663767976, -17.150653198637958, -31.87310486179734, -37.614712144934664, -45.6626403362431, -21.345526813631366, -24.527448399674846, -33.84080728124536, -36.1254360346197, -53.65929625844289, -8.592667620395737, -34.907200137572254, -10.99944330479112, -29.304279318955178, -10.792845734202107, -12.41509943937009, -38.240033956810606, -30.301634771203336, -15.207886353728808, -32.15190792083743, -38.9065570455625, -32.86801837835728, -17.952739259422728, -26.106073683024164, -19.538725634194506, -37.321018504206265, -36.42148317275332, -20.373680766354838, -20.581600963720888, -18.96745196790824, -19.751203091481354, -27.868459988033408, -38.48924632075228, -33.58832311350451, -18.051117959870908, -28.698466473802274, -25.84106884460554, -41.5939485080831, -34.98834720237591, -10.714767865654727, -4.389196018909752, -11.083609593617673, -31.684937277388162, -17.924951044532932, -27.345608708092907, -14.892324037977147, -15.394236261108482, -46.48562050239425, -35.65707056938986, -38.42308212592018, -36.86848211490663], "policy_predator_policy_reward": [21.82745506401753, 20.159351982189115, 14.510639884071441, 22.59437816831553, 14.85678145501877, 2.7286707431564743, 31.714079063348485, 24.31587157720154, 37.27666023430393, 46.968607111118104, 24.556970439949357, 34.58974025340828, 33.22307245333626, 4.517200540812181, 28.539800962649913, 32.708585242586686, 37.52326203389519, 30.5350335964537, 24.961010737948943, 30.477333529692856, 34.548830642499205, 27.94888140766965, 36.2623427132892, 28.440507890312862, 18.29146117545813, 29.396107702614927, 3.993010459265372, 33.51807096199631, 5.997557043858518, 36.26381416147092, 48.930341347309934, 14.778758830716738, 31.737419077268346, 51.65665591654276, 20.210017481087796, 37.58624270616531, 52.89433163507157, 32.05084990219413, 8.208805979247174, 24.594812061743973, 29.970210142843197, 23.20671331232331, 24.72612979632907, 10.481593654611075, 18.35063468863358, 21.826195589598353, 14.924523530397453, 22.287312708620878, 30.914713452196164, 32.88194663767976, 17.150653198637958, 31.87310486179734, 37.614712144934664, 45.6626403362431, 21.345526813631366, 24.527448399674846, 33.84080728124536, 36.1254360346197, 53.65929625844289, 8.592667620395737, 34.907200137572254, 10.99944330479112, 29.304279318955178, 10.792845734202107, 12.41509943937009, 38.240033956810606, 30.301634771203336, 15.207886353728808, 32.15190792083743, 38.9065570455625, 32.86801837835728, 17.952739259422728, 26.106073683024164, 19.538725634194506, 37.321018504206265, 36.42148317275332, 20.373680766354838, 20.581600963720888, 18.96745196790824, 19.751203091481354, 27.868459988033408, 38.48924632075228, 33.58832311350451, 18.051117959870908, 28.698466473802274, 25.84106884460554, 41.5939485080831, 34.98834720237591, 10.714767865654727, 4.389196018909752, 11.083609593617673, 31.684937277388162, 17.924951044532932, 27.345608708092907, 14.892324037977147, 15.394236261108482, 46.48562050239425, 35.65707056938986, 38.42308212592018, 36.86848211490663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2981579921922778, "mean_inference_ms": 0.9773413081828406, "mean_action_processing_ms": 0.13166410775306972, "mean_env_wait_ms": 0.06997989299832978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003062009811401367, "StateBufferConnector_ms": 0.002164483070373535, "ViewRequirementAgentConnector_ms": 0.04748427867889404}, "num_episodes": 52, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 654.3974988662184, "num_env_steps_trained_throughput_per_sec": 654.3974988662184, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 5781.018, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5780.949, "sample_time_ms": 732.743, "learn_time_ms": 5029.631, "learn_throughput": 795.287, "synch_weights_time_ms": 17.251}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-52", "timestamp": 1723390372, "time_this_iter_s": 6.117456912994385, "time_total_s": 118.08415365219116, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 118.08415365219116, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.08888888888889, "ram_util_percent": 82.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2641637790948153, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.087392890453339, "policy_loss": -0.008383733215547787, "vf_loss": 4.095507526149352, "vf_explained_var": -0.3535230979944269, "kl": 0.005382223988655383, "entropy": 0.9345996296033263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.974735556853314, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7955129720270633, "policy_loss": -0.008695393620534257, "vf_loss": 3.803244252006213, "vf_explained_var": -0.5405019139871001, "kl": 0.009641114028696999, "entropy": 1.2375986396024625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 81.77, "episode_media": {}, "episodes_this_iter": 45, "episodes_timesteps_total": 8177, "policy_reward_min": {"prey_policy": -53.65929625844289, "predator_policy": 2.466874301176441}, "policy_reward_max": {"prey_policy": -2.466874301176441, "predator_policy": 53.65929625844289}, "policy_reward_mean": {"prey_policy": -25.90395556932076, "predator_policy": 25.90395556932076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [92, 49, 26, 77, 115, 67, 87, 69, 78, 122, 64, 75, 60, 98, 31, 66, 124, 67, 54, 68, 134, 63, 36, 73, 71, 74, 127, 49, 86, 88, 75, 83, 120, 107, 97, 97, 65, 73, 61, 60, 52, 86, 77, 71, 12, 65, 101, 55, 94, 52, 124, 84, 130, 51, 86, 61, 55, 46, 83, 100, 84, 57, 65, 156, 100, 66, 112, 74, 65, 204, 50, 38, 62, 98, 95, 22, 72, 46, 98, 241, 92, 47, 17, 66, 62, 62, 62, 75, 113, 73, 111, 79, 89, 54, 128, 81, 114, 110, 125, 199], "policy_prey_policy_reward": [-21.826195589598353, -14.924523530397453, -22.287312708620878, -30.914713452196164, -32.88194663767976, -17.150653198637958, -31.87310486179734, -37.614712144934664, -45.6626403362431, -21.345526813631366, -24.527448399674846, -33.84080728124536, -36.1254360346197, -53.65929625844289, -8.592667620395737, -34.907200137572254, -10.99944330479112, -29.304279318955178, -10.792845734202107, -12.41509943937009, -38.240033956810606, -30.301634771203336, -15.207886353728808, -32.15190792083743, -38.9065570455625, -32.86801837835728, -17.952739259422728, -26.106073683024164, -19.538725634194506, -37.321018504206265, -36.42148317275332, -20.373680766354838, -20.581600963720888, -18.96745196790824, -19.751203091481354, -27.868459988033408, -38.48924632075228, -33.58832311350451, -18.051117959870908, -28.698466473802274, -25.84106884460554, -41.5939485080831, -34.98834720237591, -10.714767865654727, -4.389196018909752, -11.083609593617673, -31.684937277388162, -17.924951044532932, -27.345608708092907, -14.892324037977147, -15.394236261108482, -46.48562050239425, -35.65707056938986, -38.42308212592018, -36.86848211490663, -3.7930693383492864, -8.805518743766351, -13.274953915972008, -16.703425581533217, -26.34149624522862, -29.793077093896894, -12.121766158556863, -22.13594049759835, -33.674865694140344, -2.466874301176441, -46.479438307165104, -19.642081336460777, -45.76211563615409, -32.18038479314572, -26.360430727276036, -23.659150698979595, -6.009525923051946, -41.671003211276, -37.78560225417364, -24.5503779184233, -6.535048913214952, -29.408307846407787, -13.985972232841231, -40.701874743463094, -41.942497047672745, -21.510588889119788, -15.934835494384128, -5.620540892997939, -11.319999264405332, -7.666484538155599, -21.942999979551377, -30.167390860630857, -26.66436470272287, -27.82613430632245, -30.087269192361177, -49.2583413861432, -28.973459980658703, -13.412162574471175, -37.36135053902502, -37.679070747954874, -22.98668252690431, -10.889538149067915, -27.019062384548207, -48.930511765518276, -33.04123679371526], "policy_predator_policy_reward": [21.826195589598353, 14.924523530397453, 22.287312708620878, 30.914713452196164, 32.88194663767976, 17.150653198637958, 31.87310486179734, 37.614712144934664, 45.6626403362431, 21.345526813631366, 24.527448399674846, 33.84080728124536, 36.1254360346197, 53.65929625844289, 8.592667620395737, 34.907200137572254, 10.99944330479112, 29.304279318955178, 10.792845734202107, 12.41509943937009, 38.240033956810606, 30.301634771203336, 15.207886353728808, 32.15190792083743, 38.9065570455625, 32.86801837835728, 17.952739259422728, 26.106073683024164, 19.538725634194506, 37.321018504206265, 36.42148317275332, 20.373680766354838, 20.581600963720888, 18.96745196790824, 19.751203091481354, 27.868459988033408, 38.48924632075228, 33.58832311350451, 18.051117959870908, 28.698466473802274, 25.84106884460554, 41.5939485080831, 34.98834720237591, 10.714767865654727, 4.389196018909752, 11.083609593617673, 31.684937277388162, 17.924951044532932, 27.345608708092907, 14.892324037977147, 15.394236261108482, 46.48562050239425, 35.65707056938986, 38.42308212592018, 36.86848211490663, 3.7930693383492864, 8.805518743766351, 13.274953915972008, 16.703425581533217, 26.34149624522862, 29.793077093896894, 12.121766158556863, 22.13594049759835, 33.674865694140344, 2.466874301176441, 46.479438307165104, 19.642081336460777, 45.76211563615409, 32.18038479314572, 26.360430727276036, 23.659150698979595, 6.009525923051946, 41.671003211276, 37.78560225417364, 24.5503779184233, 6.535048913214952, 29.408307846407787, 13.985972232841231, 40.701874743463094, 41.942497047672745, 21.510588889119788, 15.934835494384128, 5.620540892997939, 11.319999264405332, 7.666484538155599, 21.942999979551377, 30.167390860630857, 26.66436470272287, 27.82613430632245, 30.087269192361177, 49.2583413861432, 28.973459980658703, 13.412162574471175, 37.36135053902502, 37.679070747954874, 22.98668252690431, 10.889538149067915, 27.019062384548207, 48.930511765518276, 33.04123679371526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2977180759658136, "mean_inference_ms": 0.9727474940518371, "mean_action_processing_ms": 0.13099624641181115, "mean_env_wait_ms": 0.0696359415737796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030744075775146484, "StateBufferConnector_ms": 0.0020145177841186523, "ViewRequirementAgentConnector_ms": 0.04741489887237549}, "num_episodes": 45, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.6071926138897, "num_env_steps_trained_throughput_per_sec": 687.6071926138897, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5799.31, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5799.247, "sample_time_ms": 706.681, "learn_time_ms": 5074.353, "learn_throughput": 788.278, "synch_weights_time_ms": 16.932}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "abfb9_00000", "date": "2024-08-11_11-32-58", "timestamp": 1723390378, "time_this_iter_s": 5.823243856430054, "time_total_s": 123.90739750862122, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.90739750862122, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.099999999999998, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9244967314104238, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.172292704631885, "policy_loss": -0.003801979707107724, "vf_loss": 5.175658715764682, "vf_explained_var": -0.43230533742656313, "kl": 0.008719339324278525, "entropy": 0.8408818459138274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.896294758841395, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.786304460217555, "policy_loss": -0.013309515105599226, "vf_loss": 4.7978745321432745, "vf_explained_var": -0.809981453170379, "kl": 0.017394338783318974, "entropy": 1.2098409631599982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 81.65, "episode_media": {}, "episodes_this_iter": 52, "episodes_timesteps_total": 8165, "policy_reward_min": {"prey_policy": -49.400247757166866, "predator_policy": 2.466874301176441}, "policy_reward_max": {"prey_policy": -2.466874301176441, "predator_policy": 49.400247757166866}, "policy_reward_mean": {"prey_policy": -25.391848026603043, "predator_policy": 25.391848026603043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [130, 51, 86, 61, 55, 46, 83, 100, 84, 57, 65, 156, 100, 66, 112, 74, 65, 204, 50, 38, 62, 98, 95, 22, 72, 46, 98, 241, 92, 47, 17, 66, 62, 62, 62, 75, 113, 73, 111, 79, 89, 54, 128, 81, 114, 110, 125, 199, 64, 45, 51, 76, 91, 56, 31, 53, 76, 81, 88, 91, 116, 51, 135, 109, 48, 84, 66, 126, 89, 96, 47, 103, 71, 95, 53, 70, 73, 56, 69, 61, 63, 100, 85, 80, 95, 91, 72, 12, 77, 68, 81, 66, 64, 76, 133, 77, 74, 113, 55, 86], "policy_prey_policy_reward": [-35.65707056938986, -38.42308212592018, -36.86848211490663, -3.7930693383492864, -8.805518743766351, -13.274953915972008, -16.703425581533217, -26.34149624522862, -29.793077093896894, -12.121766158556863, -22.13594049759835, -33.674865694140344, -2.466874301176441, -46.479438307165104, -19.642081336460777, -45.76211563615409, -32.18038479314572, -26.360430727276036, -23.659150698979595, -6.009525923051946, -41.671003211276, -37.78560225417364, -24.5503779184233, -6.535048913214952, -29.408307846407787, -13.985972232841231, -40.701874743463094, -41.942497047672745, -21.510588889119788, -15.934835494384128, -5.620540892997939, -11.319999264405332, -7.666484538155599, -21.942999979551377, -30.167390860630857, -26.66436470272287, -27.82613430632245, -30.087269192361177, -49.2583413861432, -28.973459980658703, -13.412162574471175, -37.36135053902502, -37.679070747954874, -22.98668252690431, -10.889538149067915, -27.019062384548207, -48.930511765518276, -33.04123679371526, -17.76451207680278, -23.84018282193056, -8.716601336821972, -23.796312268976486, -22.121935017630676, -5.595422602202795, -13.663200089123983, -27.95409020190577, -26.081422223124612, -25.008901454846846, -13.495768885124422, -36.883190027914004, -47.07166918693234, -36.66922056378997, -40.241922752431435, -30.159588660288428, -17.75841600020861, -46.81978831551348, -18.362353366069094, -44.3746567860173, -43.33311417050491, -17.35984190334922, -8.907052595925396, -17.99667516384625, -14.957203676443616, -36.863300592946636, -15.904638775386555, -31.699164376126316, -25.936934486779542, -12.690656826762988, -10.65574908240037, -34.515751755267274, -25.71712911038248, -21.905902288750042, -28.57868767234084, -39.39587756769601, -49.400247757166866, -14.903777276141042, -31.103509081471053, -3.4486961857751943, -28.412492419470713, -6.336906970901216, -38.10135995563848, -8.883003519502239, -24.7442999725107, -34.724810815986366, -23.03956474330816, -40.29942094219501, -21.00501564672363, -30.521214908645362, -25.495783438212506, -20.942405405291534], "policy_predator_policy_reward": [35.65707056938986, 38.42308212592018, 36.86848211490663, 3.7930693383492864, 8.805518743766351, 13.274953915972008, 16.703425581533217, 26.34149624522862, 29.793077093896894, 12.121766158556863, 22.13594049759835, 33.674865694140344, 2.466874301176441, 46.479438307165104, 19.642081336460777, 45.76211563615409, 32.18038479314572, 26.360430727276036, 23.659150698979595, 6.009525923051946, 41.671003211276, 37.78560225417364, 24.5503779184233, 6.535048913214952, 29.408307846407787, 13.985972232841231, 40.701874743463094, 41.942497047672745, 21.510588889119788, 15.934835494384128, 5.620540892997939, 11.319999264405332, 7.666484538155599, 21.942999979551377, 30.167390860630857, 26.66436470272287, 27.82613430632245, 30.087269192361177, 49.2583413861432, 28.973459980658703, 13.412162574471175, 37.36135053902502, 37.679070747954874, 22.98668252690431, 10.889538149067915, 27.019062384548207, 48.930511765518276, 33.04123679371526, 17.76451207680278, 23.84018282193056, 8.716601336821972, 23.796312268976486, 22.121935017630676, 5.595422602202795, 13.663200089123983, 27.95409020190577, 26.081422223124612, 25.008901454846846, 13.495768885124422, 36.883190027914004, 47.07166918693234, 36.66922056378997, 40.241922752431435, 30.159588660288428, 17.75841600020861, 46.81978831551348, 18.362353366069094, 44.3746567860173, 43.33311417050491, 17.35984190334922, 8.907052595925396, 17.99667516384625, 14.957203676443616, 36.863300592946636, 15.904638775386555, 31.699164376126316, 25.936934486779542, 12.690656826762988, 10.65574908240037, 34.515751755267274, 25.71712911038248, 21.905902288750042, 28.57868767234084, 39.39587756769601, 49.400247757166866, 14.903777276141042, 31.103509081471053, 3.4486961857751943, 28.412492419470713, 6.336906970901216, 38.10135995563848, 8.883003519502239, 24.7442999725107, 34.724810815986366, 23.03956474330816, 40.29942094219501, 21.00501564672363, 30.521214908645362, 25.495783438212506, 20.942405405291534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29708113295211724, "mean_inference_ms": 0.9686840906332398, "mean_action_processing_ms": 0.13050694267737975, "mean_env_wait_ms": 0.06939446304795575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034159421920776367, "StateBufferConnector_ms": 0.0021789073944091797, "ViewRequirementAgentConnector_ms": 0.051364898681640625}, "num_episodes": 52, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 682.6274744723926, "num_env_steps_trained_throughput_per_sec": 682.6274744723926, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 5813.389, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5813.345, "sample_time_ms": 711.925, "learn_time_ms": 5086.754, "learn_throughput": 786.356, "synch_weights_time_ms": 14.293}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-04", "timestamp": 1723390384, "time_this_iter_s": 5.864995956420898, "time_total_s": 129.77239346504211, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 129.77239346504211, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 28.375, "ram_util_percent": 82.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.352067521897455, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.317704537262519, "policy_loss": -0.001931690030323807, "vf_loss": 4.319331082701683, "vf_explained_var": 0.1305939232930541, "kl": 0.0061031881785297394, "entropy": 0.8551048766200741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7849650647491218, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.946882068614165, "policy_loss": -0.008792499767635794, "vf_loss": 3.954936979462703, "vf_explained_var": -0.05739285573363304, "kl": 0.007375922914488562, "entropy": 1.1491193102051815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 79.4, "episode_media": {}, "episodes_this_iter": 51, "episodes_timesteps_total": 7940, "policy_reward_min": {"prey_policy": -61.538302030709765, "predator_policy": 2.8196053631144147}, "policy_reward_max": {"prey_policy": -2.8196053631144147, "predator_policy": 61.538302030709765}, "policy_reward_mean": {"prey_policy": -26.284885485301473, "predator_policy": 26.284885485301473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [76, 91, 56, 31, 53, 76, 81, 88, 91, 116, 51, 135, 109, 48, 84, 66, 126, 89, 96, 47, 103, 71, 95, 53, 70, 73, 56, 69, 61, 63, 100, 85, 80, 95, 91, 72, 12, 77, 68, 81, 66, 64, 76, 133, 77, 74, 113, 55, 86, 66, 52, 117, 64, 78, 44, 66, 91, 45, 55, 118, 81, 79, 111, 186, 85, 89, 86, 92, 100, 60, 31, 23, 49, 102, 60, 93, 115, 40, 89, 68, 71, 36, 60, 45, 86, 32, 87, 66, 51, 229, 68, 110, 232, 112, 117, 28, 45, 28, 60, 113], "policy_prey_policy_reward": [-23.796312268976486, -22.121935017630676, -5.595422602202795, -13.663200089123983, -27.95409020190577, -26.081422223124612, -25.008901454846846, -13.495768885124422, -36.883190027914004, -47.07166918693234, -36.66922056378997, -40.241922752431435, -30.159588660288428, -17.75841600020861, -46.81978831551348, -18.362353366069094, -44.3746567860173, -43.33311417050491, -17.35984190334922, -8.907052595925396, -17.99667516384625, -14.957203676443616, -36.863300592946636, -15.904638775386555, -31.699164376126316, -25.936934486779542, -12.690656826762988, -10.65574908240037, -34.515751755267274, -25.71712911038248, -21.905902288750042, -28.57868767234084, -39.39587756769601, -49.400247757166866, -14.903777276141042, -31.103509081471053, -3.4486961857751943, -28.412492419470713, -6.336906970901216, -38.10135995563848, -8.883003519502239, -24.7442999725107, -34.724810815986366, -23.03956474330816, -40.29942094219501, -21.00501564672363, -30.521214908645362, -25.495783438212506, -20.942405405291534, -17.782368165774265, -12.698848629904624, -32.32431512395455, -31.3209358386099, -39.71974671310278, -15.591585357584124, -35.34398919979671, -41.29129804210649, -13.032619727899803, -19.36854440643136, -42.22366998886954, -39.91176903924079, -42.866621204841074, -36.26653116711884, -38.50880233905134, -41.996028795955006, -31.268759028615655, -39.77570235525675, -25.87823999238965, -19.563329809900434, -23.495385063253373, -7.891131874275548, -7.245656211699757, -12.073599608087822, -42.10366913766453, -30.203109030113392, -20.569572948629492, -19.86172455860122, -5.535806048435729, -29.739300861229484, -21.293788276918036, -21.241350734950036, -20.436127796236597, -38.10695873727647, -21.90020827732691, -40.86157610793125, -16.524382086075896, -31.131668733907897, -38.71245317363423, -15.058276131909821, -38.462705013953645, -3.6327470894942664, -36.57462019341662, -61.538302030709765, -6.805800272271172, -35.237651323359906, -7.588688717332495, -23.954700724152357, -2.8196053631144147, -27.672854464243308, -39.64337552758947], "policy_predator_policy_reward": [23.796312268976486, 22.121935017630676, 5.595422602202795, 13.663200089123983, 27.95409020190577, 26.081422223124612, 25.008901454846846, 13.495768885124422, 36.883190027914004, 47.07166918693234, 36.66922056378997, 40.241922752431435, 30.159588660288428, 17.75841600020861, 46.81978831551348, 18.362353366069094, 44.3746567860173, 43.33311417050491, 17.35984190334922, 8.907052595925396, 17.99667516384625, 14.957203676443616, 36.863300592946636, 15.904638775386555, 31.699164376126316, 25.936934486779542, 12.690656826762988, 10.65574908240037, 34.515751755267274, 25.71712911038248, 21.905902288750042, 28.57868767234084, 39.39587756769601, 49.400247757166866, 14.903777276141042, 31.103509081471053, 3.4486961857751943, 28.412492419470713, 6.336906970901216, 38.10135995563848, 8.883003519502239, 24.7442999725107, 34.724810815986366, 23.03956474330816, 40.29942094219501, 21.00501564672363, 30.521214908645362, 25.495783438212506, 20.942405405291534, 17.782368165774265, 12.698848629904624, 32.32431512395455, 31.3209358386099, 39.71974671310278, 15.591585357584124, 35.34398919979671, 41.29129804210649, 13.032619727899803, 19.36854440643136, 42.22366998886954, 39.91176903924079, 42.866621204841074, 36.26653116711884, 38.50880233905134, 41.996028795955006, 31.268759028615655, 39.77570235525675, 25.87823999238965, 19.563329809900434, 23.495385063253373, 7.891131874275548, 7.245656211699757, 12.073599608087822, 42.10366913766453, 30.203109030113392, 20.569572948629492, 19.86172455860122, 5.535806048435729, 29.739300861229484, 21.293788276918036, 21.241350734950036, 20.436127796236597, 38.10695873727647, 21.90020827732691, 40.86157610793125, 16.524382086075896, 31.131668733907897, 38.71245317363423, 15.058276131909821, 38.462705013953645, 3.6327470894942664, 36.57462019341662, 61.538302030709765, 6.805800272271172, 35.237651323359906, 7.588688717332495, 23.954700724152357, 2.8196053631144147, 27.672854464243308, 39.64337552758947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29644485335042603, "mean_inference_ms": 0.9654965799203938, "mean_action_processing_ms": 0.1300495094197833, "mean_env_wait_ms": 0.06925796632545232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031163692474365234, "StateBufferConnector_ms": 0.002127528190612793, "ViewRequirementAgentConnector_ms": 0.05046844482421875}, "num_episodes": 51, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 705.8722454581175, "num_env_steps_trained_throughput_per_sec": 705.8722454581175, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 5742.884, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5742.844, "sample_time_ms": 650.556, "learn_time_ms": 5077.959, "learn_throughput": 787.718, "synch_weights_time_ms": 13.972}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-10", "timestamp": 1723390390, "time_this_iter_s": 5.671647071838379, "time_total_s": 135.4440405368805, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1325b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.4440405368805, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.825, "ram_util_percent": 83.08749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3847824069360892, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.167679887513319, "policy_loss": -0.004621191786524529, "vf_loss": 4.171859022726616, "vf_explained_var": 0.06697115457306306, "kl": 0.00884073289635754, "entropy": 0.8195576614389817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.289075234035651, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.367693830281496, "policy_loss": -0.006958094073343091, "vf_loss": 3.373496562490861, "vf_explained_var": 0.13898365156104167, "kl": 0.011553773383871913, "entropy": 1.1139954209327698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 78.72, "episode_media": {}, "episodes_this_iter": 51, "episodes_timesteps_total": 7872, "policy_reward_min": {"prey_policy": -61.538302030709765, "predator_policy": 1.9833952051558934}, "policy_reward_max": {"prey_policy": -1.9833952051558934, "predator_policy": 61.538302030709765}, "policy_reward_mean": {"prey_policy": -25.180145706716033, "predator_policy": 25.180145706716033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [117, 64, 78, 44, 66, 91, 45, 55, 118, 81, 79, 111, 186, 85, 89, 86, 92, 100, 60, 31, 23, 49, 102, 60, 93, 115, 40, 89, 68, 71, 36, 60, 45, 86, 32, 87, 66, 51, 229, 68, 110, 232, 112, 117, 28, 45, 28, 60, 113, 86, 83, 89, 126, 53, 14, 98, 56, 78, 113, 88, 129, 243, 24, 49, 82, 62, 48, 63, 102, 73, 99, 55, 82, 75, 65, 36, 61, 85, 120, 89, 46, 27, 169, 24, 62, 78, 43, 83, 68, 89, 75, 84, 69, 88, 67, 62, 54, 69, 78, 18], "policy_prey_policy_reward": [-32.32431512395455, -31.3209358386099, -39.71974671310278, -15.591585357584124, -35.34398919979671, -41.29129804210649, -13.032619727899803, -19.36854440643136, -42.22366998886954, -39.91176903924079, -42.866621204841074, -36.26653116711884, -38.50880233905134, -41.996028795955006, -31.268759028615655, -39.77570235525675, -25.87823999238965, -19.563329809900434, -23.495385063253373, -7.891131874275548, -7.245656211699757, -12.073599608087822, -42.10366913766453, -30.203109030113392, -20.569572948629492, -19.86172455860122, -5.535806048435729, -29.739300861229484, -21.293788276918036, -21.241350734950036, -20.436127796236597, -38.10695873727647, -21.90020827732691, -40.86157610793125, -16.524382086075896, -31.131668733907897, -38.71245317363423, -15.058276131909821, -38.462705013953645, -3.6327470894942664, -36.57462019341662, -61.538302030709765, -6.805800272271172, -35.237651323359906, -7.588688717332495, -23.954700724152357, -2.8196053631144147, -27.672854464243308, -39.64337552758947, -40.69736326175926, -20.266102225577818, -35.857205533957654, -57.16247753299227, -9.210783990126867, -9.960094116487287, -43.19017311184108, -27.248222728588644, -15.539160797092862, -23.36387482071112, -41.023882932809805, -20.590496035881387, -19.049880864031596, -12.082199297790858, -4.253793800199677, -7.469330977254598, -13.37990604567035, -13.93494562241174, -21.839780865474783, -16.594863705120762, -13.847244809228282, -37.3762206692603, -25.74749395105884, -18.792756457579536, -41.40996350228954, -30.0279627451106, -17.266145160028266, -41.50481047284121, -43.902091832988525, -39.60356274217386, -28.07370484211198, -8.542113910427746, -11.326742508089659, -21.740829757942222, -10.561411686954425, -9.435725263034172, -25.951021236338015, -2.673177482703433, -34.311460347674426, -24.256374663214228, -42.554325065554586, -18.098967316303657, -17.455424479360133, -29.596211721850427, -30.56479163271133, -15.727578851567031, -31.828832039400947, -25.732884570415628, -18.021350329919716, -13.2161729040149, -1.9833952051558934], "policy_predator_policy_reward": [32.32431512395455, 31.3209358386099, 39.71974671310278, 15.591585357584124, 35.34398919979671, 41.29129804210649, 13.032619727899803, 19.36854440643136, 42.22366998886954, 39.91176903924079, 42.866621204841074, 36.26653116711884, 38.50880233905134, 41.996028795955006, 31.268759028615655, 39.77570235525675, 25.87823999238965, 19.563329809900434, 23.495385063253373, 7.891131874275548, 7.245656211699757, 12.073599608087822, 42.10366913766453, 30.203109030113392, 20.569572948629492, 19.86172455860122, 5.535806048435729, 29.739300861229484, 21.293788276918036, 21.241350734950036, 20.436127796236597, 38.10695873727647, 21.90020827732691, 40.86157610793125, 16.524382086075896, 31.131668733907897, 38.71245317363423, 15.058276131909821, 38.462705013953645, 3.6327470894942664, 36.57462019341662, 61.538302030709765, 6.805800272271172, 35.237651323359906, 7.588688717332495, 23.954700724152357, 2.8196053631144147, 27.672854464243308, 39.64337552758947, 40.69736326175926, 20.266102225577818, 35.857205533957654, 57.16247753299227, 9.210783990126867, 9.960094116487287, 43.19017311184108, 27.248222728588644, 15.539160797092862, 23.36387482071112, 41.023882932809805, 20.590496035881387, 19.049880864031596, 12.082199297790858, 4.253793800199677, 7.469330977254598, 13.37990604567035, 13.93494562241174, 21.839780865474783, 16.594863705120762, 13.847244809228282, 37.3762206692603, 25.74749395105884, 18.792756457579536, 41.40996350228954, 30.0279627451106, 17.266145160028266, 41.50481047284121, 43.902091832988525, 39.60356274217386, 28.07370484211198, 8.542113910427746, 11.326742508089659, 21.740829757942222, 10.561411686954425, 9.435725263034172, 25.951021236338015, 2.673177482703433, 34.311460347674426, 24.256374663214228, 42.554325065554586, 18.098967316303657, 17.455424479360133, 29.596211721850427, 30.56479163271133, 15.727578851567031, 31.828832039400947, 25.732884570415628, 18.021350329919716, 13.2161729040149, 1.9833952051558934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2958653186997022, "mean_inference_ms": 0.9627945554931702, "mean_action_processing_ms": 0.1295041305953605, "mean_env_wait_ms": 0.06894676084213577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026646852493286133, "StateBufferConnector_ms": 0.001970052719116211, "ViewRequirementAgentConnector_ms": 0.04578292369842529}, "num_episodes": 51, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 679.7900064659649, "num_env_steps_trained_throughput_per_sec": 679.7900064659649, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 5801.331, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5801.292, "sample_time_ms": 649.622, "learn_time_ms": 5137.0, "learn_throughput": 778.665, "synch_weights_time_ms": 14.306}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-16", "timestamp": 1723390396, "time_this_iter_s": 5.889480352401733, "time_total_s": 141.33352088928223, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a03a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.33352088928223, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 28.022222222222222, "ram_util_percent": 83.11111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2784333476796745, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7298840078214806, "policy_loss": -0.0056453921907329155, "vf_loss": 4.7346875794231895, "vf_explained_var": 0.20752893767009178, "kl": 0.016836369618019074, "entropy": 0.779157172764341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3719765235980352, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.688962170978387, "policy_loss": -0.00845129851368256, "vf_loss": 3.696282574782769, "vf_explained_var": 0.3658980367084344, "kl": 0.01130904237597837, "entropy": 1.0398310178890824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.26, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6926, "policy_reward_min": {"prey_policy": -53.55728971510961, "predator_policy": 1.4133536304709322}, "policy_reward_max": {"prey_policy": -1.4133536304709322, "predator_policy": 53.55728971510961}, "policy_reward_mean": {"prey_policy": -24.266498595832495, "predator_policy": 24.266498595832495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 49, 82, 62, 48, 63, 102, 73, 99, 55, 82, 75, 65, 36, 61, 85, 120, 89, 46, 27, 169, 24, 62, 78, 43, 83, 68, 89, 75, 84, 69, 88, 67, 62, 54, 69, 78, 18, 78, 54, 30, 59, 103, 86, 86, 84, 62, 65, 52, 40, 48, 11, 32, 80, 35, 49, 61, 77, 73, 71, 15, 61, 35, 153, 135, 77, 63, 78, 91, 71, 63, 74, 78, 52, 62, 40, 73, 87, 52, 92, 87, 84, 96, 66, 78, 27, 44, 60, 114, 114, 123, 17, 82, 91, 85, 8, 68, 98, 96, 77], "policy_prey_policy_reward": [-12.082199297790858, -4.253793800199677, -7.469330977254598, -13.37990604567035, -13.93494562241174, -21.839780865474783, -16.594863705120762, -13.847244809228282, -37.3762206692603, -25.74749395105884, -18.792756457579536, -41.40996350228954, -30.0279627451106, -17.266145160028266, -41.50481047284121, -43.902091832988525, -39.60356274217386, -28.07370484211198, -8.542113910427746, -11.326742508089659, -21.740829757942222, -10.561411686954425, -9.435725263034172, -25.951021236338015, -2.673177482703433, -34.311460347674426, -24.256374663214228, -42.554325065554586, -18.098967316303657, -17.455424479360133, -29.596211721850427, -30.56479163271133, -15.727578851567031, -31.828832039400947, -25.732884570415628, -18.021350329919716, -13.2161729040149, -1.9833952051558934, -41.01372820403106, -20.92893320598532, -13.174678926778821, -17.18080142420896, -50.964460960158206, -46.57797611301066, -30.5423214281648, -9.133153028978812, -11.694282836418052, -22.630247212793435, -28.503496424773576, -20.36114661097853, -12.242476121866455, -1.4133536304709322, -8.797222681583282, -24.586602854994382, -9.51463011871562, -3.1183267123528715, -24.76394980481448, -36.90778747030618, -15.617800442827242, -42.561947925212216, -5.737069412044174, -29.402299437740822, -16.801168691847415, -40.83933612111145, -36.751209192739616, -42.5263839837199, -24.50205600007817, -26.48946144801063, -41.32126517208411, -17.79749365448942, -31.548732006018756, -21.90132647539343, -27.923123591969205, -26.804984233043857, -36.199074204506566, -1.5812205671105266, -48.44588650642963, -30.94663001057848, -28.749805520287833, -34.33717614043608, -35.18844999138203, -43.57422733595953, -12.943634249569266, -22.844590488192466, -35.21922263224561, -15.116316373870836, -8.136868882214019, -34.845250358505176, -53.55728971510961, -46.015049914940775, -33.35088764772956, -9.302686095893767, -12.292587733685552, -38.95726320423389, -25.244619274765224, -4.516998255903074, -26.990679560204196, -43.31893201537744, -21.156698944074524, -20.557011929102792], "policy_predator_policy_reward": [12.082199297790858, 4.253793800199677, 7.469330977254598, 13.37990604567035, 13.93494562241174, 21.839780865474783, 16.594863705120762, 13.847244809228282, 37.3762206692603, 25.74749395105884, 18.792756457579536, 41.40996350228954, 30.0279627451106, 17.266145160028266, 41.50481047284121, 43.902091832988525, 39.60356274217386, 28.07370484211198, 8.542113910427746, 11.326742508089659, 21.740829757942222, 10.561411686954425, 9.435725263034172, 25.951021236338015, 2.673177482703433, 34.311460347674426, 24.256374663214228, 42.554325065554586, 18.098967316303657, 17.455424479360133, 29.596211721850427, 30.56479163271133, 15.727578851567031, 31.828832039400947, 25.732884570415628, 18.021350329919716, 13.2161729040149, 1.9833952051558934, 41.01372820403106, 20.92893320598532, 13.174678926778821, 17.18080142420896, 50.964460960158206, 46.57797611301066, 30.5423214281648, 9.133153028978812, 11.694282836418052, 22.630247212793435, 28.503496424773576, 20.36114661097853, 12.242476121866455, 1.4133536304709322, 8.797222681583282, 24.586602854994382, 9.51463011871562, 3.1183267123528715, 24.76394980481448, 36.90778747030618, 15.617800442827242, 42.561947925212216, 5.737069412044174, 29.402299437740822, 16.801168691847415, 40.83933612111145, 36.751209192739616, 42.5263839837199, 24.50205600007817, 26.48946144801063, 41.32126517208411, 17.79749365448942, 31.548732006018756, 21.90132647539343, 27.923123591969205, 26.804984233043857, 36.199074204506566, 1.5812205671105266, 48.44588650642963, 30.94663001057848, 28.749805520287833, 34.33717614043608, 35.18844999138203, 43.57422733595953, 12.943634249569266, 22.844590488192466, 35.21922263224561, 15.116316373870836, 8.136868882214019, 34.845250358505176, 53.55728971510961, 46.015049914940775, 33.35088764772956, 9.302686095893767, 12.292587733685552, 38.95726320423389, 25.244619274765224, 4.516998255903074, 26.990679560204196, 43.31893201537744, 21.156698944074524, 20.557011929102792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2947660544730317, "mean_inference_ms": 0.9585042851113008, "mean_action_processing_ms": 0.12941553787471094, "mean_env_wait_ms": 0.0685108273279038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026723146438598633, "StateBufferConnector_ms": 0.002151966094970703, "ViewRequirementAgentConnector_ms": 0.04552590847015381}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 675.2267264796268, "num_env_steps_trained_throughput_per_sec": 675.2267264796268, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 5862.472, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5862.433, "sample_time_ms": 649.44, "learn_time_ms": 5198.008, "learn_throughput": 769.526, "synch_weights_time_ms": 14.619}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-22", "timestamp": 1723390402, "time_this_iter_s": 5.92929482460022, "time_total_s": 147.26281571388245, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.26281571388245, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 26.7875, "ram_util_percent": 83.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.578700339732071, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.336078393707672, "policy_loss": -0.00247239629534306, "vf_loss": 4.338432110349337, "vf_explained_var": 0.36421908376117546, "kl": 0.00237346836710166, "entropy": 0.8443823844194412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5661635899295407, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5765681422005096, "policy_loss": -0.008348792663794787, "vf_loss": 3.5837223584453266, "vf_explained_var": 0.5862308982759714, "kl": 0.011945643902986093, "entropy": 1.015136154741049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 74.05, "episode_media": {}, "episodes_this_iter": 44, "episodes_timesteps_total": 7405, "policy_reward_min": {"prey_policy": -53.55728971510961, "predator_policy": 1.4133536304709322}, "policy_reward_max": {"prey_policy": -1.4133536304709322, "predator_policy": 53.55728971510961}, "policy_reward_mean": {"prey_policy": -24.743849649962527, "predator_policy": 24.743849649962527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [86, 84, 62, 65, 52, 40, 48, 11, 32, 80, 35, 49, 61, 77, 73, 71, 15, 61, 35, 153, 135, 77, 63, 78, 91, 71, 63, 74, 78, 52, 62, 40, 73, 87, 52, 92, 87, 84, 96, 66, 78, 27, 44, 60, 114, 114, 123, 17, 82, 91, 85, 8, 68, 98, 96, 77, 72, 60, 112, 94, 68, 137, 96, 73, 129, 127, 74, 88, 76, 59, 83, 53, 85, 81, 52, 50, 20, 69, 54, 81, 58, 59, 56, 132, 73, 43, 86, 69, 44, 63, 206, 149, 65, 57, 94, 84, 118, 74, 68, 21], "policy_prey_policy_reward": [-30.5423214281648, -9.133153028978812, -11.694282836418052, -22.630247212793435, -28.503496424773576, -20.36114661097853, -12.242476121866455, -1.4133536304709322, -8.797222681583282, -24.586602854994382, -9.51463011871562, -3.1183267123528715, -24.76394980481448, -36.90778747030618, -15.617800442827242, -42.561947925212216, -5.737069412044174, -29.402299437740822, -16.801168691847415, -40.83933612111145, -36.751209192739616, -42.5263839837199, -24.50205600007817, -26.48946144801063, -41.32126517208411, -17.79749365448942, -31.548732006018756, -21.90132647539343, -27.923123591969205, -26.804984233043857, -36.199074204506566, -1.5812205671105266, -48.44588650642963, -30.94663001057848, -28.749805520287833, -34.33717614043608, -35.18844999138203, -43.57422733595953, -12.943634249569266, -22.844590488192466, -35.21922263224561, -15.116316373870836, -8.136868882214019, -34.845250358505176, -53.55728971510961, -46.015049914940775, -33.35088764772956, -9.302686095893767, -12.292587733685552, -38.95726320423389, -25.244619274765224, -4.516998255903074, -26.990679560204196, -43.31893201537744, -21.156698944074524, -20.557011929102792, -23.220008792454816, -10.6473245320743, -38.87683831402877, -10.226752280950768, -29.70619466579387, -10.889206622340934, -18.53805094722818, -20.379762006738854, -23.872384127315, -44.87529158367364, -13.46802262792779, -45.93770589080218, -23.849430314042497, -17.451184345622064, -46.85150270584946, -19.693135732727534, -33.147204573123254, -29.54851737914511, -16.7098653965557, -28.621688760871997, -8.098995831691903, -37.005685363356996, -37.267659116286715, -35.57358219805809, -23.769393086056432, -25.036187036204876, -4.169118346439579, -27.61827265630205, -7.73572211281851, -20.5581761493362, -22.7352783421199, -18.981926372258208, -7.155924521473386, -20.43165186304678, -44.28009956131479, -42.60046780324089, -31.279785020412604, -20.9091360947675, -18.509937878949476, -24.45111864339326, -22.610445640820245, -35.428589981734596, -11.422840826418835, -4.12118667263335], "policy_predator_policy_reward": [30.5423214281648, 9.133153028978812, 11.694282836418052, 22.630247212793435, 28.503496424773576, 20.36114661097853, 12.242476121866455, 1.4133536304709322, 8.797222681583282, 24.586602854994382, 9.51463011871562, 3.1183267123528715, 24.76394980481448, 36.90778747030618, 15.617800442827242, 42.561947925212216, 5.737069412044174, 29.402299437740822, 16.801168691847415, 40.83933612111145, 36.751209192739616, 42.5263839837199, 24.50205600007817, 26.48946144801063, 41.32126517208411, 17.79749365448942, 31.548732006018756, 21.90132647539343, 27.923123591969205, 26.804984233043857, 36.199074204506566, 1.5812205671105266, 48.44588650642963, 30.94663001057848, 28.749805520287833, 34.33717614043608, 35.18844999138203, 43.57422733595953, 12.943634249569266, 22.844590488192466, 35.21922263224561, 15.116316373870836, 8.136868882214019, 34.845250358505176, 53.55728971510961, 46.015049914940775, 33.35088764772956, 9.302686095893767, 12.292587733685552, 38.95726320423389, 25.244619274765224, 4.516998255903074, 26.990679560204196, 43.31893201537744, 21.156698944074524, 20.557011929102792, 23.220008792454816, 10.6473245320743, 38.87683831402877, 10.226752280950768, 29.70619466579387, 10.889206622340934, 18.53805094722818, 20.379762006738854, 23.872384127315, 44.87529158367364, 13.46802262792779, 45.93770589080218, 23.849430314042497, 17.451184345622064, 46.85150270584946, 19.693135732727534, 33.147204573123254, 29.54851737914511, 16.7098653965557, 28.621688760871997, 8.098995831691903, 37.005685363356996, 37.267659116286715, 35.57358219805809, 23.769393086056432, 25.036187036204876, 4.169118346439579, 27.61827265630205, 7.73572211281851, 20.5581761493362, 22.7352783421199, 18.981926372258208, 7.155924521473386, 20.43165186304678, 44.28009956131479, 42.60046780324089, 31.279785020412604, 20.9091360947675, 18.509937878949476, 24.45111864339326, 22.610445640820245, 35.428589981734596, 11.422840826418835, 4.12118667263335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29403523554767275, "mean_inference_ms": 0.9555852280740467, "mean_action_processing_ms": 0.12867025559893996, "mean_env_wait_ms": 0.06834681691018883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026140213012695312, "StateBufferConnector_ms": 0.0022231340408325195, "ViewRequirementAgentConnector_ms": 0.04645037651062012}, "num_episodes": 44, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 656.0499031031812, "num_env_steps_trained_throughput_per_sec": 656.0499031031812, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 5911.179, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5911.141, "sample_time_ms": 649.169, "learn_time_ms": 5247.443, "learn_throughput": 762.276, "synch_weights_time_ms": 14.181}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-28", "timestamp": 1723390408, "time_this_iter_s": 6.102428913116455, "time_total_s": 153.3652446269989, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.3652446269989, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.15555555555555, "ram_util_percent": 82.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3260363157217703, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1341490797698497, "policy_loss": -0.0012930361578279796, "vf_loss": 3.1352853460858268, "vf_explained_var": 0.5404839215179285, "kl": 0.006271001316543234, "entropy": 0.8871184953177969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.380424854842325, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.646662173916896, "policy_loss": -0.007953106924833264, "vf_loss": 2.653962781528632, "vf_explained_var": 0.7010653141265114, "kl": 0.006524986786155127, "entropy": 1.0240436218058069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 84.9, "episode_media": {}, "episodes_this_iter": 45, "episodes_timesteps_total": 8490, "policy_reward_min": {"prey_policy": -49.447159054965546, "predator_policy": 2.7813708048548023}, "policy_reward_max": {"prey_policy": -2.7813708048548023, "predator_policy": 49.447159054965546}, "policy_reward_mean": {"prey_policy": -24.50133743694336, "predator_policy": 24.50133743694336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [114, 123, 17, 82, 91, 85, 8, 68, 98, 96, 77, 72, 60, 112, 94, 68, 137, 96, 73, 129, 127, 74, 88, 76, 59, 83, 53, 85, 81, 52, 50, 20, 69, 54, 81, 58, 59, 56, 132, 73, 43, 86, 69, 44, 63, 206, 149, 65, 57, 94, 84, 118, 74, 68, 21, 160, 130, 80, 66, 52, 28, 84, 126, 99, 168, 76, 79, 70, 58, 335, 147, 30, 71, 159, 51, 66, 42, 95, 135, 48, 82, 77, 69, 92, 94, 70, 66, 68, 134, 114, 101, 112, 27, 143, 92, 117, 22, 129, 26, 29], "policy_prey_policy_reward": [-46.015049914940775, -33.35088764772956, -9.302686095893767, -12.292587733685552, -38.95726320423389, -25.244619274765224, -4.516998255903074, -26.990679560204196, -43.31893201537744, -21.156698944074524, -20.557011929102792, -23.220008792454816, -10.6473245320743, -38.87683831402877, -10.226752280950768, -29.70619466579387, -10.889206622340934, -18.53805094722818, -20.379762006738854, -23.872384127315, -44.87529158367364, -13.46802262792779, -45.93770589080218, -23.849430314042497, -17.451184345622064, -46.85150270584946, -19.693135732727534, -33.147204573123254, -29.54851737914511, -16.7098653965557, -28.621688760871997, -8.098995831691903, -37.005685363356996, -37.267659116286715, -35.57358219805809, -23.769393086056432, -25.036187036204876, -4.169118346439579, -27.61827265630205, -7.73572211281851, -20.5581761493362, -22.7352783421199, -18.981926372258208, -7.155924521473386, -20.43165186304678, -44.28009956131479, -42.60046780324089, -31.279785020412604, -20.9091360947675, -18.509937878949476, -24.45111864339326, -22.610445640820245, -35.428589981734596, -11.422840826418835, -4.12118667263335, -43.07013861543561, -15.80439335900018, -5.260566268278224, -9.304421254071192, -16.760623819445758, -10.418456668509336, -43.99933359574689, -10.303426089904205, -45.217743722923636, -39.511811469718126, -44.43329060269458, -2.7813708048548023, -30.337436625420068, -39.44025514091494, -46.08541275057219, -28.464052096407876, -22.794302701744343, -22.358753128525027, -13.584729819218545, -12.04241037935071, -49.447159054965546, -16.545309419283928, -43.5018889350273, -34.062565664604406, -20.508184989554497, -32.68787397948599, -28.448487912113976, -18.266620790291178, -32.87961450289726, -44.02473502064773, -11.221635044641019, -30.20834915791445, -6.115406641178896, -31.234869131230372, -23.750117453038143, -5.031514416547543, -35.60155780839945, -5.7266832674733585, -46.55702543280026, -20.844563843376502, -14.631028408875771, -12.19790445830141, -18.113395559094563, -8.653620248799392, -17.936036346744434], "policy_predator_policy_reward": [46.015049914940775, 33.35088764772956, 9.302686095893767, 12.292587733685552, 38.95726320423389, 25.244619274765224, 4.516998255903074, 26.990679560204196, 43.31893201537744, 21.156698944074524, 20.557011929102792, 23.220008792454816, 10.6473245320743, 38.87683831402877, 10.226752280950768, 29.70619466579387, 10.889206622340934, 18.53805094722818, 20.379762006738854, 23.872384127315, 44.87529158367364, 13.46802262792779, 45.93770589080218, 23.849430314042497, 17.451184345622064, 46.85150270584946, 19.693135732727534, 33.147204573123254, 29.54851737914511, 16.7098653965557, 28.621688760871997, 8.098995831691903, 37.005685363356996, 37.267659116286715, 35.57358219805809, 23.769393086056432, 25.036187036204876, 4.169118346439579, 27.61827265630205, 7.73572211281851, 20.5581761493362, 22.7352783421199, 18.981926372258208, 7.155924521473386, 20.43165186304678, 44.28009956131479, 42.60046780324089, 31.279785020412604, 20.9091360947675, 18.509937878949476, 24.45111864339326, 22.610445640820245, 35.428589981734596, 11.422840826418835, 4.12118667263335, 43.07013861543561, 15.80439335900018, 5.260566268278224, 9.304421254071192, 16.760623819445758, 10.418456668509336, 43.99933359574689, 10.303426089904205, 45.217743722923636, 39.511811469718126, 44.43329060269458, 2.7813708048548023, 30.337436625420068, 39.44025514091494, 46.08541275057219, 28.464052096407876, 22.794302701744343, 22.358753128525027, 13.584729819218545, 12.04241037935071, 49.447159054965546, 16.545309419283928, 43.5018889350273, 34.062565664604406, 20.508184989554497, 32.68787397948599, 28.448487912113976, 18.266620790291178, 32.87961450289726, 44.02473502064773, 11.221635044641019, 30.20834915791445, 6.115406641178896, 31.234869131230372, 23.750117453038143, 5.031514416547543, 35.60155780839945, 5.7266832674733585, 46.55702543280026, 20.844563843376502, 14.631028408875771, 12.19790445830141, 18.113395559094563, 8.653620248799392, 17.936036346744434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29496029651658107, "mean_inference_ms": 0.955206061089449, "mean_action_processing_ms": 0.12844739276412734, "mean_env_wait_ms": 0.0682313200734396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035402774810791016, "StateBufferConnector_ms": 0.002217888832092285, "ViewRequirementAgentConnector_ms": 0.04762911796569824}, "num_episodes": 45, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 661.5227824180336, "num_env_steps_trained_throughput_per_sec": 661.5227824180336, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 5934.851, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5934.807, "sample_time_ms": 648.147, "learn_time_ms": 5271.934, "learn_throughput": 758.735, "synch_weights_time_ms": 14.376}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-34", "timestamp": 1723390414, "time_this_iter_s": 6.051619052886963, "time_total_s": 159.41686367988586, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.41686367988586, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 27.766666666666666, "ram_util_percent": 82.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1373291628435256, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6683689158409836, "policy_loss": -0.006539057154926317, "vf_loss": 2.6745578375955423, "vf_explained_var": 0.07249420421818892, "kl": 0.014005542082073334, "entropy": 0.9273719592640798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4575826985761524, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5943401392549275, "policy_loss": -0.004021749652990062, "vf_loss": 2.598105119044582, "vf_explained_var": 0.4653971180319786, "kl": 0.002567712825018298, "entropy": 0.9940317214777072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 86.43, "episode_media": {}, "episodes_this_iter": 51, "episodes_timesteps_total": 8643, "policy_reward_min": {"prey_policy": -54.57815010036844, "predator_policy": 2.7813708048548023}, "policy_reward_max": {"prey_policy": -2.7813708048548023, "predator_policy": 54.57815010036844}, "policy_reward_mean": {"prey_policy": -24.975029937274783, "predator_policy": 24.975029937274783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [118, 74, 68, 21, 160, 130, 80, 66, 52, 28, 84, 126, 99, 168, 76, 79, 70, 58, 335, 147, 30, 71, 159, 51, 66, 42, 95, 135, 48, 82, 77, 69, 92, 94, 70, 66, 68, 134, 114, 101, 112, 27, 143, 92, 117, 22, 129, 26, 29, 116, 69, 57, 63, 45, 50, 37, 256, 69, 62, 58, 43, 46, 53, 147, 49, 197, 108, 64, 79, 91, 154, 52, 117, 45, 82, 80, 76, 38, 91, 71, 84, 72, 87, 141, 59, 105, 49, 70, 38, 98, 91, 62, 78, 109, 140, 183, 28, 64, 77, 43], "policy_prey_policy_reward": [-22.610445640820245, -35.428589981734596, -11.422840826418835, -4.12118667263335, -43.07013861543561, -15.80439335900018, -5.260566268278224, -9.304421254071192, -16.760623819445758, -10.418456668509336, -43.99933359574689, -10.303426089904205, -45.217743722923636, -39.511811469718126, -44.43329060269458, -2.7813708048548023, -30.337436625420068, -39.44025514091494, -46.08541275057219, -28.464052096407876, -22.794302701744343, -22.358753128525027, -13.584729819218545, -12.04241037935071, -49.447159054965546, -16.545309419283928, -43.5018889350273, -34.062565664604406, -20.508184989554497, -32.68787397948599, -28.448487912113976, -18.266620790291178, -32.87961450289726, -44.02473502064773, -11.221635044641019, -30.20834915791445, -6.115406641178896, -31.234869131230372, -23.750117453038143, -5.031514416547543, -35.60155780839945, -5.7266832674733585, -46.55702543280026, -20.844563843376502, -14.631028408875771, -12.19790445830141, -18.113395559094563, -8.653620248799392, -17.936036346744434, -38.81406922051771, -32.49268294616864, -25.177977759121617, -43.91277867561712, -24.929084787794384, -18.74596339782378, -7.66405089924384, -25.891831991892854, -37.00565238463988, -6.490555744822055, -38.357959993558524, -28.27846688356018, -27.904655865116457, -35.74750696839046, -34.12140532552671, -17.405509131367975, -20.45237125181867, -19.27423548745918, -28.127423894376406, -37.48790963859619, -5.472502258890251, -43.36706592990108, -17.066004996137032, -40.42511285738411, -9.73035072516373, -14.735208974406346, -22.39930043648608, -51.25208750982277, -19.330061943337405, -25.076319098992283, -14.57955375381332, -39.46107332930603, -14.6873729683926, -28.253454207084935, -29.52409118430724, -14.598035822678504, -35.504827734289016, -28.15112616007662, -33.2494658725774, -19.2929495325119, -41.83356506115445, -54.57815010036844, -14.860330723072055, -13.591321920785997, -21.89251477349786, -36.4072571112222, -14.709840259325576, -6.679156245244653, -15.893640833452613, -35.822496127589595, -3.04452350716343], "policy_predator_policy_reward": [22.610445640820245, 35.428589981734596, 11.422840826418835, 4.12118667263335, 43.07013861543561, 15.80439335900018, 5.260566268278224, 9.304421254071192, 16.760623819445758, 10.418456668509336, 43.99933359574689, 10.303426089904205, 45.217743722923636, 39.511811469718126, 44.43329060269458, 2.7813708048548023, 30.337436625420068, 39.44025514091494, 46.08541275057219, 28.464052096407876, 22.794302701744343, 22.358753128525027, 13.584729819218545, 12.04241037935071, 49.447159054965546, 16.545309419283928, 43.5018889350273, 34.062565664604406, 20.508184989554497, 32.68787397948599, 28.448487912113976, 18.266620790291178, 32.87961450289726, 44.02473502064773, 11.221635044641019, 30.20834915791445, 6.115406641178896, 31.234869131230372, 23.750117453038143, 5.031514416547543, 35.60155780839945, 5.7266832674733585, 46.55702543280026, 20.844563843376502, 14.631028408875771, 12.19790445830141, 18.113395559094563, 8.653620248799392, 17.936036346744434, 38.81406922051771, 32.49268294616864, 25.177977759121617, 43.91277867561712, 24.929084787794384, 18.74596339782378, 7.66405089924384, 25.891831991892854, 37.00565238463988, 6.490555744822055, 38.357959993558524, 28.27846688356018, 27.904655865116457, 35.74750696839046, 34.12140532552671, 17.405509131367975, 20.45237125181867, 19.27423548745918, 28.127423894376406, 37.48790963859619, 5.472502258890251, 43.36706592990108, 17.066004996137032, 40.42511285738411, 9.73035072516373, 14.735208974406346, 22.39930043648608, 51.25208750982277, 19.330061943337405, 25.076319098992283, 14.57955375381332, 39.46107332930603, 14.6873729683926, 28.253454207084935, 29.52409118430724, 14.598035822678504, 35.504827734289016, 28.15112616007662, 33.2494658725774, 19.2929495325119, 41.83356506115445, 54.57815010036844, 14.860330723072055, 13.591321920785997, 21.89251477349786, 36.4072571112222, 14.709840259325576, 6.679156245244653, 15.893640833452613, 35.822496127589595, 3.04452350716343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2952040374569869, "mean_inference_ms": 0.9541714483036035, "mean_action_processing_ms": 0.12885119238032117, "mean_env_wait_ms": 0.06826389957938621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037363767623901367, "StateBufferConnector_ms": 0.0021800994873046875, "ViewRequirementAgentConnector_ms": 0.04985535144805908}, "num_episodes": 51, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 652.8017058150043, "num_env_steps_trained_throughput_per_sec": 652.8017058150043, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 5941.044, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5941.001, "sample_time_ms": 656.747, "learn_time_ms": 5270.563, "learn_throughput": 758.932, "synch_weights_time_ms": 13.365}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 29, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-40", "timestamp": 1723390420, "time_this_iter_s": 6.132226228713989, "time_total_s": 165.54908990859985, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.54908990859985, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.612499999999997, "ram_util_percent": 82.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.462758115430673, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4343798788885276, "policy_loss": -0.0034688384209099845, "vf_loss": 2.437730651597182, "vf_explained_var": 0.5104351886237661, "kl": 0.004722952693954896, "entropy": 0.8877557954440515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5183711878955366, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3735999771083396, "policy_loss": -0.004340585489020062, "vf_loss": 2.3776582570125657, "vf_explained_var": 0.7407430345813434, "kl": 0.005646296758708078, "entropy": 0.9682080116122961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 82.77, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 8277, "policy_reward_min": {"prey_policy": -54.57815010036844, "predator_policy": 2.833304011731485}, "policy_reward_max": {"prey_policy": -2.833304011731485, "predator_policy": 54.57815010036844}, "policy_reward_mean": {"prey_policy": -24.65530779184905, "predator_policy": 24.65530779184905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [92, 117, 22, 129, 26, 29, 116, 69, 57, 63, 45, 50, 37, 256, 69, 62, 58, 43, 46, 53, 147, 49, 197, 108, 64, 79, 91, 154, 52, 117, 45, 82, 80, 76, 38, 91, 71, 84, 72, 87, 141, 59, 105, 49, 70, 38, 98, 91, 62, 78, 109, 140, 183, 28, 64, 77, 43, 68, 62, 66, 150, 70, 204, 64, 127, 93, 52, 198, 27, 72, 29, 46, 79, 97, 97, 73, 76, 97, 64, 27, 59, 50, 83, 145, 67, 36, 112, 104, 167, 42, 99, 108, 92, 61, 61, 58, 76, 81, 69, 111], "policy_prey_policy_reward": [-20.844563843376502, -14.631028408875771, -12.19790445830141, -18.113395559094563, -8.653620248799392, -17.936036346744434, -38.81406922051771, -32.49268294616864, -25.177977759121617, -43.91277867561712, -24.929084787794384, -18.74596339782378, -7.66405089924384, -25.891831991892854, -37.00565238463988, -6.490555744822055, -38.357959993558524, -28.27846688356018, -27.904655865116457, -35.74750696839046, -34.12140532552671, -17.405509131367975, -20.45237125181867, -19.27423548745918, -28.127423894376406, -37.48790963859619, -5.472502258890251, -43.36706592990108, -17.066004996137032, -40.42511285738411, -9.73035072516373, -14.735208974406346, -22.39930043648608, -51.25208750982277, -19.330061943337405, -25.076319098992283, -14.57955375381332, -39.46107332930603, -14.6873729683926, -28.253454207084935, -29.52409118430724, -14.598035822678504, -35.504827734289016, -28.15112616007662, -33.2494658725774, -19.2929495325119, -41.83356506115445, -54.57815010036844, -14.860330723072055, -13.591321920785997, -21.89251477349786, -36.4072571112222, -14.709840259325576, -6.679156245244653, -15.893640833452613, -35.822496127589595, -3.04452350716343, -7.838155435671969, -16.851497210647313, -28.482202056436545, -35.358867740040616, -27.074049595274765, -6.940041963279208, -32.38114923341594, -34.55096823968895, -29.76404731791335, -17.95054132152474, -36.994369435209165, -4.101701504881366, -16.180519109832428, -8.201528167524021, -22.25463425983276, -7.551480065637474, -28.037636621171515, -39.51146713866679, -28.282180548312574, -53.11501967886505, -41.84706679521015, -33.13213534046507, -7.9431570132847815, -9.08689471224442, -18.596743738250648, -37.640637599399206, -26.71665304431203, -26.151454587977447, -11.34701709614674, -46.7226096595589, -33.70143853826907, -34.50745004527204, -16.49240630396244, -27.032828947768145, -5.956787133152632, -2.833304011731485, -24.40519146517926, -21.271124958899076, -24.86741373028154, -35.50116330246509, -40.24988373591363, -29.66835821831556, -22.309599491979554], "policy_predator_policy_reward": [20.844563843376502, 14.631028408875771, 12.19790445830141, 18.113395559094563, 8.653620248799392, 17.936036346744434, 38.81406922051771, 32.49268294616864, 25.177977759121617, 43.91277867561712, 24.929084787794384, 18.74596339782378, 7.66405089924384, 25.891831991892854, 37.00565238463988, 6.490555744822055, 38.357959993558524, 28.27846688356018, 27.904655865116457, 35.74750696839046, 34.12140532552671, 17.405509131367975, 20.45237125181867, 19.27423548745918, 28.127423894376406, 37.48790963859619, 5.472502258890251, 43.36706592990108, 17.066004996137032, 40.42511285738411, 9.73035072516373, 14.735208974406346, 22.39930043648608, 51.25208750982277, 19.330061943337405, 25.076319098992283, 14.57955375381332, 39.46107332930603, 14.6873729683926, 28.253454207084935, 29.52409118430724, 14.598035822678504, 35.504827734289016, 28.15112616007662, 33.2494658725774, 19.2929495325119, 41.83356506115445, 54.57815010036844, 14.860330723072055, 13.591321920785997, 21.89251477349786, 36.4072571112222, 14.709840259325576, 6.679156245244653, 15.893640833452613, 35.822496127589595, 3.04452350716343, 7.838155435671969, 16.851497210647313, 28.482202056436545, 35.358867740040616, 27.074049595274765, 6.940041963279208, 32.38114923341594, 34.55096823968895, 29.76404731791335, 17.95054132152474, 36.994369435209165, 4.101701504881366, 16.180519109832428, 8.201528167524021, 22.25463425983276, 7.551480065637474, 28.037636621171515, 39.51146713866679, 28.282180548312574, 53.11501967886505, 41.84706679521015, 33.13213534046507, 7.9431570132847815, 9.08689471224442, 18.596743738250648, 37.640637599399206, 26.71665304431203, 26.151454587977447, 11.34701709614674, 46.7226096595589, 33.70143853826907, 34.50745004527204, 16.49240630396244, 27.032828947768145, 5.956787133152632, 2.833304011731485, 24.40519146517926, 21.271124958899076, 24.86741373028154, 35.50116330246509, 40.24988373591363, 29.66835821831556, 22.309599491979554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2956592257585666, "mean_inference_ms": 0.9554165751163627, "mean_action_processing_ms": 0.12878612396464528, "mean_env_wait_ms": 0.06830853185767866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028182268142700195, "StateBufferConnector_ms": 0.0020407438278198242, "ViewRequirementAgentConnector_ms": 0.0482325553894043}, "num_episodes": 43, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 661.7303697040016, "num_env_steps_trained_throughput_per_sec": 661.7303697040016, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 5958.039, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5957.997, "sample_time_ms": 658.635, "learn_time_ms": 5285.629, "learn_throughput": 756.769, "synch_weights_time_ms": 13.358}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 30, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-46", "timestamp": 1723390426, "time_this_iter_s": 6.050023794174194, "time_total_s": 171.59911370277405, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.59911370277405, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 26.922222222222228, "ram_util_percent": 82.24444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2870794273912907, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3065406625469524, "policy_loss": -0.006608348426622493, "vf_loss": 3.312933436781168, "vf_explained_var": 0.22168602384626865, "kl": 0.0172463778189046, "entropy": 0.8372899003326892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.466956139045457, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1560966218511264, "policy_loss": -0.006654495118709747, "vf_loss": 3.1624547973275186, "vf_explained_var": 0.537808525065581, "kl": 0.0059264849038265415, "entropy": 0.9646758527184526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 85.87, "episode_media": {}, "episodes_this_iter": 48, "episodes_timesteps_total": 8587, "policy_reward_min": {"prey_policy": -53.20325624753664, "predator_policy": 1.4945243714011656}, "policy_reward_max": {"prey_policy": -1.4945243714011656, "predator_policy": 53.20325624753664}, "policy_reward_mean": {"prey_policy": -24.392955754507106, "predator_policy": 24.392955754507106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [62, 78, 109, 140, 183, 28, 64, 77, 43, 68, 62, 66, 150, 70, 204, 64, 127, 93, 52, 198, 27, 72, 29, 46, 79, 97, 97, 73, 76, 97, 64, 27, 59, 50, 83, 145, 67, 36, 112, 104, 167, 42, 99, 108, 92, 61, 61, 58, 76, 81, 69, 111, 71, 51, 41, 96, 49, 73, 25, 30, 181, 49, 41, 105, 11, 147, 39, 98, 286, 28, 57, 78, 70, 75, 61, 55, 145, 172, 48, 94, 113, 81, 71, 86, 64, 69, 42, 71, 135, 72, 99, 103, 137, 73, 127, 78, 52, 161, 154, 120], "policy_prey_policy_reward": [-14.860330723072055, -13.591321920785997, -21.89251477349786, -36.4072571112222, -14.709840259325576, -6.679156245244653, -15.893640833452613, -35.822496127589595, -3.04452350716343, -7.838155435671969, -16.851497210647313, -28.482202056436545, -35.358867740040616, -27.074049595274765, -6.940041963279208, -32.38114923341594, -34.55096823968895, -29.76404731791335, -17.95054132152474, -36.994369435209165, -4.101701504881366, -16.180519109832428, -8.201528167524021, -22.25463425983276, -7.551480065637474, -28.037636621171515, -39.51146713866679, -28.282180548312574, -53.11501967886505, -41.84706679521015, -33.13213534046507, -7.9431570132847815, -9.08689471224442, -18.596743738250648, -37.640637599399206, -26.71665304431203, -26.151454587977447, -11.34701709614674, -46.7226096595589, -33.70143853826907, -34.50745004527204, -16.49240630396244, -27.032828947768145, -5.956787133152632, -2.833304011731485, -24.40519146517926, -21.271124958899076, -24.86741373028154, -35.50116330246509, -40.24988373591363, -29.66835821831556, -22.309599491979554, -45.08512858032029, -23.1966225929046, -22.995431639108055, -27.46983228682057, -27.36979707102601, -31.118541085904912, -9.83748033039228, -14.15556431817394, -41.244188598280374, -40.199720002519136, -22.40151523611655, -40.80713310760513, -8.117103597098598, -53.20325624753664, -7.177986009669317, -33.50559553982298, -36.450907114369755, -8.724372339825496, -36.285841322669015, -14.917814702161158, -35.33406170545295, -16.547372440392984, -26.59014298166004, -30.94393435461667, -39.41108569801443, -37.59028249829946, -18.95891845534604, -31.68850204842696, -20.70990979946115, -42.47255436993715, -32.15582461805236, -21.03183574970474, -1.4945243714011656, -23.48034245476904, -25.144097271226762, -28.951158440955936, -27.678130041649453, -32.47815340635442, -18.199771923733742, -18.709714690837487, -7.616077152861845, -23.837157784499606, -28.84008821419503, -5.315408332893497, -23.837446204795896, -16.22901433221022, -20.14006509550945, -17.341711675908503], "policy_predator_policy_reward": [14.860330723072055, 13.591321920785997, 21.89251477349786, 36.4072571112222, 14.709840259325576, 6.679156245244653, 15.893640833452613, 35.822496127589595, 3.04452350716343, 7.838155435671969, 16.851497210647313, 28.482202056436545, 35.358867740040616, 27.074049595274765, 6.940041963279208, 32.38114923341594, 34.55096823968895, 29.76404731791335, 17.95054132152474, 36.994369435209165, 4.101701504881366, 16.180519109832428, 8.201528167524021, 22.25463425983276, 7.551480065637474, 28.037636621171515, 39.51146713866679, 28.282180548312574, 53.11501967886505, 41.84706679521015, 33.13213534046507, 7.9431570132847815, 9.08689471224442, 18.596743738250648, 37.640637599399206, 26.71665304431203, 26.151454587977447, 11.34701709614674, 46.7226096595589, 33.70143853826907, 34.50745004527204, 16.49240630396244, 27.032828947768145, 5.956787133152632, 2.833304011731485, 24.40519146517926, 21.271124958899076, 24.86741373028154, 35.50116330246509, 40.24988373591363, 29.66835821831556, 22.309599491979554, 45.08512858032029, 23.1966225929046, 22.995431639108055, 27.46983228682057, 27.36979707102601, 31.118541085904912, 9.83748033039228, 14.15556431817394, 41.244188598280374, 40.199720002519136, 22.40151523611655, 40.80713310760513, 8.117103597098598, 53.20325624753664, 7.177986009669317, 33.50559553982298, 36.450907114369755, 8.724372339825496, 36.285841322669015, 14.917814702161158, 35.33406170545295, 16.547372440392984, 26.59014298166004, 30.94393435461667, 39.41108569801443, 37.59028249829946, 18.95891845534604, 31.68850204842696, 20.70990979946115, 42.47255436993715, 32.15582461805236, 21.03183574970474, 1.4945243714011656, 23.48034245476904, 25.144097271226762, 28.951158440955936, 27.678130041649453, 32.47815340635442, 18.199771923733742, 18.709714690837487, 7.616077152861845, 23.837157784499606, 28.84008821419503, 5.315408332893497, 23.837446204795896, 16.22901433221022, 20.14006509550945, 17.341711675908503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2948134368885258, "mean_inference_ms": 0.95304734781649, "mean_action_processing_ms": 0.12818832620207207, "mean_env_wait_ms": 0.06804386405073795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026941299438476562, "StateBufferConnector_ms": 0.0023293495178222656, "ViewRequirementAgentConnector_ms": 0.04694008827209473}, "num_episodes": 48, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.6369998379727, "num_env_steps_trained_throughput_per_sec": 681.6369998379727, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 5933.612, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5933.57, "sample_time_ms": 660.478, "learn_time_ms": 5259.433, "learn_throughput": 760.538, "synch_weights_time_ms": 13.285}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 31, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-52", "timestamp": 1723390432, "time_this_iter_s": 5.873653888702393, "time_total_s": 177.47276759147644, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.47276759147644, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 27.6625, "ram_util_percent": 82.36250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.352816719810168, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5088027734309435, "policy_loss": -0.005883351112424861, "vf_loss": 2.514578614135583, "vf_explained_var": 0.8483608895912766, "kl": 0.008599394827874758, "entropy": 0.825282457532982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5660661616673073, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4045484023789565, "policy_loss": -0.007784001009228329, "vf_loss": 2.411912487819791, "vf_explained_var": 0.8750653029729922, "kl": 0.008398255342918453, "entropy": 0.9597681154807408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 86.41, "episode_media": {}, "episodes_this_iter": 46, "episodes_timesteps_total": 8641, "policy_reward_min": {"prey_policy": -53.20325624753664, "predator_policy": 1.4945243714011656}, "policy_reward_max": {"prey_policy": -1.4945243714011656, "predator_policy": 53.20325624753664}, "policy_reward_mean": {"prey_policy": -26.394130831473625, "predator_policy": 26.394130831473625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [61, 58, 76, 81, 69, 111, 71, 51, 41, 96, 49, 73, 25, 30, 181, 49, 41, 105, 11, 147, 39, 98, 286, 28, 57, 78, 70, 75, 61, 55, 145, 172, 48, 94, 113, 81, 71, 86, 64, 69, 42, 71, 135, 72, 99, 103, 137, 73, 127, 78, 52, 161, 154, 120, 115, 39, 57, 164, 23, 75, 28, 99, 54, 75, 74, 91, 54, 73, 56, 189, 100, 84, 82, 74, 213, 50, 59, 105, 78, 99, 47, 95, 102, 191, 94, 70, 54, 60, 100, 76, 69, 66, 54, 86, 144, 134, 79, 128, 85, 57], "policy_prey_policy_reward": [-21.271124958899076, -24.86741373028154, -35.50116330246509, -40.24988373591363, -29.66835821831556, -22.309599491979554, -45.08512858032029, -23.1966225929046, -22.995431639108055, -27.46983228682057, -27.36979707102601, -31.118541085904912, -9.83748033039228, -14.15556431817394, -41.244188598280374, -40.199720002519136, -22.40151523611655, -40.80713310760513, -8.117103597098598, -53.20325624753664, -7.177986009669317, -33.50559553982298, -36.450907114369755, -8.724372339825496, -36.285841322669015, -14.917814702161158, -35.33406170545295, -16.547372440392984, -26.59014298166004, -30.94393435461667, -39.41108569801443, -37.59028249829946, -18.95891845534604, -31.68850204842696, -20.70990979946115, -42.47255436993715, -32.15582461805236, -21.03183574970474, -1.4945243714011656, -23.48034245476904, -25.144097271226762, -28.951158440955936, -27.678130041649453, -32.47815340635442, -18.199771923733742, -18.709714690837487, -7.616077152861845, -23.837157784499606, -28.84008821419503, -5.315408332893497, -23.837446204795896, -16.22901433221022, -20.14006509550945, -17.341711675908503, -39.48506830710563, -12.38420341733319, -25.532421442891373, -41.16614896252162, -19.462860202027137, -17.656647787321536, -10.445408487167656, -26.003931885482533, -24.04477237516877, -38.48134575032647, -34.051113128182415, -21.742006261661366, -18.943030532080826, -42.10966132408413, -16.294863148622525, -12.653327600708833, -7.812733578697705, -30.930823038779007, -26.82655625199579, -21.739304568621122, -13.574939309673923, -22.618029576394513, -38.850395637198986, -43.20139037138928, -23.359614199697063, -21.70080907432269, -22.46925720104585, -15.88887706809342, -23.072877678827535, -23.063066321555674, -21.08246754655105, -20.63232870006167, -20.666299477319573, -31.844145991443188, -39.910536328458484, -33.08670194343353, -24.96723059438406, -7.554253565862371, -22.841697857810814, -45.01010708078155, -34.71420539064381, -47.580910243663425, -41.5132760169087, -44.13941608331994, -46.104550919222035, -31.340809645173646], "policy_predator_policy_reward": [21.271124958899076, 24.86741373028154, 35.50116330246509, 40.24988373591363, 29.66835821831556, 22.309599491979554, 45.08512858032029, 23.1966225929046, 22.995431639108055, 27.46983228682057, 27.36979707102601, 31.118541085904912, 9.83748033039228, 14.15556431817394, 41.244188598280374, 40.199720002519136, 22.40151523611655, 40.80713310760513, 8.117103597098598, 53.20325624753664, 7.177986009669317, 33.50559553982298, 36.450907114369755, 8.724372339825496, 36.285841322669015, 14.917814702161158, 35.33406170545295, 16.547372440392984, 26.59014298166004, 30.94393435461667, 39.41108569801443, 37.59028249829946, 18.95891845534604, 31.68850204842696, 20.70990979946115, 42.47255436993715, 32.15582461805236, 21.03183574970474, 1.4945243714011656, 23.48034245476904, 25.144097271226762, 28.951158440955936, 27.678130041649453, 32.47815340635442, 18.199771923733742, 18.709714690837487, 7.616077152861845, 23.837157784499606, 28.84008821419503, 5.315408332893497, 23.837446204795896, 16.22901433221022, 20.14006509550945, 17.341711675908503, 39.48506830710563, 12.38420341733319, 25.532421442891373, 41.16614896252162, 19.462860202027137, 17.656647787321536, 10.445408487167656, 26.003931885482533, 24.04477237516877, 38.48134575032647, 34.051113128182415, 21.742006261661366, 18.943030532080826, 42.10966132408413, 16.294863148622525, 12.653327600708833, 7.812733578697705, 30.930823038779007, 26.82655625199579, 21.739304568621122, 13.574939309673923, 22.618029576394513, 38.850395637198986, 43.20139037138928, 23.359614199697063, 21.70080907432269, 22.46925720104585, 15.88887706809342, 23.072877678827535, 23.063066321555674, 21.08246754655105, 20.63232870006167, 20.666299477319573, 31.844145991443188, 39.910536328458484, 33.08670194343353, 24.96723059438406, 7.554253565862371, 22.841697857810814, 45.01010708078155, 34.71420539064381, 47.580910243663425, 41.5132760169087, 44.13941608331994, 46.104550919222035, 31.340809645173646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29419530843238956, "mean_inference_ms": 0.9491658103681533, "mean_action_processing_ms": 0.1281291353702685, "mean_env_wait_ms": 0.06779229402717693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026837587356567383, "StateBufferConnector_ms": 0.002327442169189453, "ViewRequirementAgentConnector_ms": 0.0464099645614624}, "num_episodes": 46, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 676.42258381311, "num_env_steps_trained_throughput_per_sec": 676.42258381311, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 5943.231, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5943.19, "sample_time_ms": 659.759, "learn_time_ms": 5269.814, "learn_throughput": 759.04, "synch_weights_time_ms": 13.244}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 32, "trial_id": "abfb9_00000", "date": "2024-08-11_11-33-58", "timestamp": 1723390438, "time_this_iter_s": 5.91849684715271, "time_total_s": 183.39126443862915, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.39126443862915, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.31111111111111, "ram_util_percent": 82.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.735346252843738, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3428547117859124, "policy_loss": -0.0039605999207803205, "vf_loss": 2.346689612790942, "vf_explained_var": 0.844814132588605, "kl": 0.010055966498264013, "entropy": 0.7626437700043122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.884568634505073, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2092377920945485, "policy_loss": -0.017365940342036385, "vf_loss": 2.225870082527399, "vf_explained_var": 0.8701300878698627, "kl": 0.014672935592655811, "entropy": 0.9802695898960034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 87.59, "episode_media": {}, "episodes_this_iter": 46, "episodes_timesteps_total": 8759, "policy_reward_min": {"prey_policy": -57.725921013844044, "predator_policy": 1.14942623259775}, "policy_reward_max": {"prey_policy": -1.14942623259775, "predator_policy": 57.725921013844044}, "policy_reward_mean": {"prey_policy": -25.679695015996813, "predator_policy": 25.679695015996813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [137, 73, 127, 78, 52, 161, 154, 120, 115, 39, 57, 164, 23, 75, 28, 99, 54, 75, 74, 91, 54, 73, 56, 189, 100, 84, 82, 74, 213, 50, 59, 105, 78, 99, 47, 95, 102, 191, 94, 70, 54, 60, 100, 76, 69, 66, 54, 86, 144, 134, 79, 128, 85, 57, 126, 73, 62, 44, 133, 84, 125, 68, 187, 83, 68, 107, 57, 60, 47, 82, 67, 118, 77, 108, 79, 65, 38, 47, 45, 67, 82, 98, 88, 121, 33, 92, 81, 105, 45, 110, 72, 58, 100, 125, 39, 83, 94, 57, 135, 121], "policy_prey_policy_reward": [-7.616077152861845, -23.837157784499606, -28.84008821419503, -5.315408332893497, -23.837446204795896, -16.22901433221022, -20.14006509550945, -17.341711675908503, -39.48506830710563, -12.38420341733319, -25.532421442891373, -41.16614896252162, -19.462860202027137, -17.656647787321536, -10.445408487167656, -26.003931885482533, -24.04477237516877, -38.48134575032647, -34.051113128182415, -21.742006261661366, -18.943030532080826, -42.10966132408413, -16.294863148622525, -12.653327600708833, -7.812733578697705, -30.930823038779007, -26.82655625199579, -21.739304568621122, -13.574939309673923, -22.618029576394513, -38.850395637198986, -43.20139037138928, -23.359614199697063, -21.70080907432269, -22.46925720104585, -15.88887706809342, -23.072877678827535, -23.063066321555674, -21.08246754655105, -20.63232870006167, -20.666299477319573, -31.844145991443188, -39.910536328458484, -33.08670194343353, -24.96723059438406, -7.554253565862371, -22.841697857810814, -45.01010708078155, -34.71420539064381, -47.580910243663425, -41.5132760169087, -44.13941608331994, -46.104550919222035, -31.340809645173646, -33.6343110984799, -27.178696785045844, -29.652801701174376, -23.921300340964823, -57.725921013844044, -29.12872411043408, -27.676343305531407, -16.632469373109558, -43.79969958681105, -31.99342284228539, -32.330154981474536, -49.55984407697191, -6.129559410942363, -21.37376735571776, -37.77683511255598, -10.76872944334569, -31.30003111330748, -17.862434560482683, -17.870015016531553, -18.403972231867776, -23.258535825207296, -35.76278483001453, -2.5288492149526913, -20.206114879316498, -19.86879605368579, -8.02906427865848, -28.362426724597967, -4.621088428877118, -16.50501442631332, -19.75418555185093, -18.891266790416353, -55.01477060685589, -21.04740925593859, -52.176503209651294, -19.510807180552224, -29.96928610322947, -30.11727607763257, -41.217609153635, -33.6471531442514, -22.92711501119554, -1.14942623259775, -40.35641114793052, -25.895754404285842, -14.789734969977243, -10.167325926046933, -15.764368044240475], "policy_predator_policy_reward": [7.616077152861845, 23.837157784499606, 28.84008821419503, 5.315408332893497, 23.837446204795896, 16.22901433221022, 20.14006509550945, 17.341711675908503, 39.48506830710563, 12.38420341733319, 25.532421442891373, 41.16614896252162, 19.462860202027137, 17.656647787321536, 10.445408487167656, 26.003931885482533, 24.04477237516877, 38.48134575032647, 34.051113128182415, 21.742006261661366, 18.943030532080826, 42.10966132408413, 16.294863148622525, 12.653327600708833, 7.812733578697705, 30.930823038779007, 26.82655625199579, 21.739304568621122, 13.574939309673923, 22.618029576394513, 38.850395637198986, 43.20139037138928, 23.359614199697063, 21.70080907432269, 22.46925720104585, 15.88887706809342, 23.072877678827535, 23.063066321555674, 21.08246754655105, 20.63232870006167, 20.666299477319573, 31.844145991443188, 39.910536328458484, 33.08670194343353, 24.96723059438406, 7.554253565862371, 22.841697857810814, 45.01010708078155, 34.71420539064381, 47.580910243663425, 41.5132760169087, 44.13941608331994, 46.104550919222035, 31.340809645173646, 33.6343110984799, 27.178696785045844, 29.652801701174376, 23.921300340964823, 57.725921013844044, 29.12872411043408, 27.676343305531407, 16.632469373109558, 43.79969958681105, 31.99342284228539, 32.330154981474536, 49.55984407697191, 6.129559410942363, 21.37376735571776, 37.77683511255598, 10.76872944334569, 31.30003111330748, 17.862434560482683, 17.870015016531553, 18.403972231867776, 23.258535825207296, 35.76278483001453, 2.5288492149526913, 20.206114879316498, 19.86879605368579, 8.02906427865848, 28.362426724597967, 4.621088428877118, 16.50501442631332, 19.75418555185093, 18.891266790416353, 55.01477060685589, 21.04740925593859, 52.176503209651294, 19.510807180552224, 29.96928610322947, 30.11727607763257, 41.217609153635, 33.6471531442514, 22.92711501119554, 1.14942623259775, 40.35641114793052, 25.895754404285842, 14.789734969977243, 10.167325926046933, 15.764368044240475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2932553865477884, "mean_inference_ms": 0.9473729921456061, "mean_action_processing_ms": 0.12788498151628339, "mean_env_wait_ms": 0.06752577725269064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002733945846557617, "StateBufferConnector_ms": 0.00196230411529541, "ViewRequirementAgentConnector_ms": 0.045128583908081055}, "num_episodes": 46, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 654.2175725639103, "num_env_steps_trained_throughput_per_sec": 654.2175725639103, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 5968.675, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5968.637, "sample_time_ms": 655.787, "learn_time_ms": 5298.963, "learn_throughput": 754.865, "synch_weights_time_ms": 13.471}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 33, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-04", "timestamp": 1723390444, "time_this_iter_s": 6.119370937347412, "time_total_s": 189.51063537597656, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 189.51063537597656, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 31.775000000000006, "ram_util_percent": 82.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.687325003246466, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1126897390310964, "policy_loss": -0.0064451721499305375, "vf_loss": 2.118965761115154, "vf_explained_var": 0.9319798616071542, "kl": 0.013531904503364939, "entropy": 0.6960604095210632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.563303353637457, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.045555455858509, "policy_loss": -0.010785987602624421, "vf_loss": 2.0558098065356414, "vf_explained_var": 0.9381930631274978, "kl": 0.010632627011268861, "entropy": 1.0009895569334428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 82.33, "episode_media": {}, "episodes_this_iter": 53, "episodes_timesteps_total": 8233, "policy_reward_min": {"prey_policy": -57.725921013844044, "predator_policy": 1.14942623259775}, "policy_reward_max": {"prey_policy": -1.14942623259775, "predator_policy": 57.725921013844044}, "policy_reward_mean": {"prey_policy": -28.10466966929511, "predator_policy": 28.10466966929511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [57, 126, 73, 62, 44, 133, 84, 125, 68, 187, 83, 68, 107, 57, 60, 47, 82, 67, 118, 77, 108, 79, 65, 38, 47, 45, 67, 82, 98, 88, 121, 33, 92, 81, 105, 45, 110, 72, 58, 100, 125, 39, 83, 94, 57, 135, 121, 109, 96, 82, 93, 79, 72, 100, 67, 63, 170, 127, 72, 71, 22, 47, 44, 112, 38, 80, 116, 76, 145, 113, 83, 74, 58, 55, 62, 54, 63, 83, 58, 48, 65, 82, 72, 226, 80, 41, 75, 136, 149, 87, 132, 38, 15, 96, 85, 71, 47, 27, 73, 91], "policy_prey_policy_reward": [-31.340809645173646, -33.6343110984799, -27.178696785045844, -29.652801701174376, -23.921300340964823, -57.725921013844044, -29.12872411043408, -27.676343305531407, -16.632469373109558, -43.79969958681105, -31.99342284228539, -32.330154981474536, -49.55984407697191, -6.129559410942363, -21.37376735571776, -37.77683511255598, -10.76872944334569, -31.30003111330748, -17.862434560482683, -17.870015016531553, -18.403972231867776, -23.258535825207296, -35.76278483001453, -2.5288492149526913, -20.206114879316498, -19.86879605368579, -8.02906427865848, -28.362426724597967, -4.621088428877118, -16.50501442631332, -19.75418555185093, -18.891266790416353, -55.01477060685589, -21.04740925593859, -52.176503209651294, -19.510807180552224, -29.96928610322947, -30.11727607763257, -41.217609153635, -33.6471531442514, -22.92711501119554, -1.14942623259775, -40.35641114793052, -25.895754404285842, -14.789734969977243, -10.167325926046933, -15.764368044240475, -50.63899979149447, -55.17317041744851, -36.23873681084374, -33.5776122164475, -24.6641832621172, -20.42994281058995, -50.227000519195045, -29.58333197097494, -40.4679383692078, -33.79235618471505, -51.23967689521176, -29.21609827036987, -35.81554454971741, -7.704405415921017, -25.57790036067742, -20.154173980634923, -45.99223842773225, -15.456562937405588, -19.01021082700464, -34.67397401471518, -47.95961303283918, -10.822936998706432, -45.102871667940526, -40.95139383402552, -23.32634573097355, -17.047421651697142, -39.51975566453397, -20.168840336368227, -16.50235544228143, -39.95065009515716, -43.77161860479749, -21.36357849761045, -25.426984297148955, -36.88823077614121, -35.26491014543753, -28.707977192697218, -54.024065574143286, -41.24790305570012, -24.26162862971398, -4.665449508230663, -5.879525283745238, -26.043321072314892, -23.636928719979757, -27.81004410834386, -17.313400335267673, -5.687238403590577, -49.18784153363356, -26.314956374753, -40.39493154826783, -15.414585991330767, -15.198865089137986, -37.64695433443107, -35.73086478818273], "policy_predator_policy_reward": [31.340809645173646, 33.6343110984799, 27.178696785045844, 29.652801701174376, 23.921300340964823, 57.725921013844044, 29.12872411043408, 27.676343305531407, 16.632469373109558, 43.79969958681105, 31.99342284228539, 32.330154981474536, 49.55984407697191, 6.129559410942363, 21.37376735571776, 37.77683511255598, 10.76872944334569, 31.30003111330748, 17.862434560482683, 17.870015016531553, 18.403972231867776, 23.258535825207296, 35.76278483001453, 2.5288492149526913, 20.206114879316498, 19.86879605368579, 8.02906427865848, 28.362426724597967, 4.621088428877118, 16.50501442631332, 19.75418555185093, 18.891266790416353, 55.01477060685589, 21.04740925593859, 52.176503209651294, 19.510807180552224, 29.96928610322947, 30.11727607763257, 41.217609153635, 33.6471531442514, 22.92711501119554, 1.14942623259775, 40.35641114793052, 25.895754404285842, 14.789734969977243, 10.167325926046933, 15.764368044240475, 50.63899979149447, 55.17317041744851, 36.23873681084374, 33.5776122164475, 24.6641832621172, 20.42994281058995, 50.227000519195045, 29.58333197097494, 40.4679383692078, 33.79235618471505, 51.23967689521176, 29.21609827036987, 35.81554454971741, 7.704405415921017, 25.57790036067742, 20.154173980634923, 45.99223842773225, 15.456562937405588, 19.01021082700464, 34.67397401471518, 47.95961303283918, 10.822936998706432, 45.102871667940526, 40.95139383402552, 23.32634573097355, 17.047421651697142, 39.51975566453397, 20.168840336368227, 16.50235544228143, 39.95065009515716, 43.77161860479749, 21.36357849761045, 25.426984297148955, 36.88823077614121, 35.26491014543753, 28.707977192697218, 54.024065574143286, 41.24790305570012, 24.26162862971398, 4.665449508230663, 5.879525283745238, 26.043321072314892, 23.636928719979757, 27.81004410834386, 17.313400335267673, 5.687238403590577, 49.18784153363356, 26.314956374753, 40.39493154826783, 15.414585991330767, 15.198865089137986, 37.64695433443107, 35.73086478818273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.292563625351266, "mean_inference_ms": 0.9439865899409352, "mean_action_processing_ms": 0.12731095137197437, "mean_env_wait_ms": 0.06736953638136506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027081966400146484, "StateBufferConnector_ms": 0.0019432306289672852, "ViewRequirementAgentConnector_ms": 0.04486525058746338}, "num_episodes": 53, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.2431809017887, "num_env_steps_trained_throughput_per_sec": 683.2431809017887, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 5987.444, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5987.405, "sample_time_ms": 654.788, "learn_time_ms": 5318.756, "learn_throughput": 752.056, "synch_weights_time_ms": 13.446}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 34, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-10", "timestamp": 1723390450, "time_this_iter_s": 5.860419988632202, "time_total_s": 195.37105536460876, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b12aed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.37105536460876, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.933333333333337, "ram_util_percent": 82.52222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.856911562445263, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2967962877204022, "policy_loss": -0.005013238908820009, "vf_loss": 2.3017042192320027, "vf_explained_var": 0.9162437155842781, "kl": 0.008423993582528929, "entropy": 0.6832332611083984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.930756383265058, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1410360989471275, "policy_loss": -0.012715771389290845, "vf_loss": 2.1531421463936566, "vf_explained_var": 0.9367361189797521, "kl": 0.01219446433923339, "entropy": 0.9683345787848036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 78.51, "episode_media": {}, "episodes_this_iter": 52, "episodes_timesteps_total": 7851, "policy_reward_min": {"prey_policy": -54.024065574143286, "predator_policy": 0.9319461183187503}, "policy_reward_max": {"prey_policy": -0.9319461183187503, "predator_policy": 54.024065574143286}, "policy_reward_mean": {"prey_policy": -27.416579581969938, "predator_policy": 27.416579581969938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [72, 100, 67, 63, 170, 127, 72, 71, 22, 47, 44, 112, 38, 80, 116, 76, 145, 113, 83, 74, 58, 55, 62, 54, 63, 83, 58, 48, 65, 82, 72, 226, 80, 41, 75, 136, 149, 87, 132, 38, 15, 96, 85, 71, 47, 27, 73, 91, 39, 81, 67, 70, 98, 151, 182, 83, 85, 63, 52, 19, 20, 68, 61, 106, 69, 35, 100, 37, 60, 188, 48, 55, 47, 75, 70, 71, 59, 46, 76, 73, 97, 81, 86, 57, 231, 73, 53, 93, 222, 78, 73, 49, 72, 65, 23, 42, 70, 36, 34, 101], "policy_prey_policy_reward": [-20.42994281058995, -50.227000519195045, -29.58333197097494, -40.4679383692078, -33.79235618471505, -51.23967689521176, -29.21609827036987, -35.81554454971741, -7.704405415921017, -25.57790036067742, -20.154173980634923, -45.99223842773225, -15.456562937405588, -19.01021082700464, -34.67397401471518, -47.95961303283918, -10.822936998706432, -45.102871667940526, -40.95139383402552, -23.32634573097355, -17.047421651697142, -39.51975566453397, -20.168840336368227, -16.50235544228143, -39.95065009515716, -43.77161860479749, -21.36357849761045, -25.426984297148955, -36.88823077614121, -35.26491014543753, -28.707977192697218, -54.024065574143286, -41.24790305570012, -24.26162862971398, -4.665449508230663, -5.879525283745238, -26.043321072314892, -23.636928719979757, -27.81004410834386, -17.313400335267673, -5.687238403590577, -49.18784153363356, -26.314956374753, -40.39493154826783, -15.414585991330767, -15.198865089137986, -37.64695433443107, -35.73086478818273, -3.777646619431739, -45.702014128349575, -27.99605863615025, -25.416382356037825, -39.37110059890746, -41.694754899615944, -19.335189327310452, -44.858717530463394, -19.336605556704036, -25.004165901428614, -12.468607019885491, -5.784016096424741, -2.487574264683304, -14.864054575445131, -31.126018934336734, -41.43341636924616, -20.114796020425437, -0.9319461183187503, -29.384187640175192, -13.130441037966833, -29.536631878274548, -34.63920621575154, -38.802665738728884, -26.149181009777852, -29.250551667210424, -37.654551173789756, -23.933522838517153, -25.402181275580734, -19.053211414958998, -26.07344015599792, -39.57503375985776, -28.260873826363206, -14.990766998228535, -30.11561557893854, -31.652248568583467, -33.227553512827434, -28.636952183456355, -19.86893733457145, -18.44300921100951, -31.759833487900703, -17.34903507478768, -28.974829784790977, -24.19627672944306, -8.731115636106983, -48.43009492495844, -24.122001627458925, -15.97649544858702, -18.168292493144875, -43.34778419892089, -12.290596904776754, -15.545385778083586, -50.70704428110655], "policy_predator_policy_reward": [20.42994281058995, 50.227000519195045, 29.58333197097494, 40.4679383692078, 33.79235618471505, 51.23967689521176, 29.21609827036987, 35.81554454971741, 7.704405415921017, 25.57790036067742, 20.154173980634923, 45.99223842773225, 15.456562937405588, 19.01021082700464, 34.67397401471518, 47.95961303283918, 10.822936998706432, 45.102871667940526, 40.95139383402552, 23.32634573097355, 17.047421651697142, 39.51975566453397, 20.168840336368227, 16.50235544228143, 39.95065009515716, 43.77161860479749, 21.36357849761045, 25.426984297148955, 36.88823077614121, 35.26491014543753, 28.707977192697218, 54.024065574143286, 41.24790305570012, 24.26162862971398, 4.665449508230663, 5.879525283745238, 26.043321072314892, 23.636928719979757, 27.81004410834386, 17.313400335267673, 5.687238403590577, 49.18784153363356, 26.314956374753, 40.39493154826783, 15.414585991330767, 15.198865089137986, 37.64695433443107, 35.73086478818273, 3.777646619431739, 45.702014128349575, 27.99605863615025, 25.416382356037825, 39.37110059890746, 41.694754899615944, 19.335189327310452, 44.858717530463394, 19.336605556704036, 25.004165901428614, 12.468607019885491, 5.784016096424741, 2.487574264683304, 14.864054575445131, 31.126018934336734, 41.43341636924616, 20.114796020425437, 0.9319461183187503, 29.384187640175192, 13.130441037966833, 29.536631878274548, 34.63920621575154, 38.802665738728884, 26.149181009777852, 29.250551667210424, 37.654551173789756, 23.933522838517153, 25.402181275580734, 19.053211414958998, 26.07344015599792, 39.57503375985776, 28.260873826363206, 14.990766998228535, 30.11561557893854, 31.652248568583467, 33.227553512827434, 28.636952183456355, 19.86893733457145, 18.44300921100951, 31.759833487900703, 17.34903507478768, 28.974829784790977, 24.19627672944306, 8.731115636106983, 48.43009492495844, 24.122001627458925, 15.97649544858702, 18.168292493144875, 43.34778419892089, 12.290596904776754, 15.545385778083586, 50.70704428110655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29212327600439325, "mean_inference_ms": 0.9434863333943736, "mean_action_processing_ms": 0.12702438898195453, "mean_env_wait_ms": 0.0672416567664633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002662181854248047, "StateBufferConnector_ms": 0.002083420753479004, "ViewRequirementAgentConnector_ms": 0.04794037342071533}, "num_episodes": 52, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.8841480051193, "num_env_steps_trained_throughput_per_sec": 681.8841480051193, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 5985.638, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5985.597, "sample_time_ms": 656.024, "learn_time_ms": 5315.938, "learn_throughput": 752.454, "synch_weights_time_ms": 13.227}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 35, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-16", "timestamp": 1723390456, "time_this_iter_s": 5.871392011642456, "time_total_s": 201.24244737625122, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 201.24244737625122, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.7875, "ram_util_percent": 82.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2650461247811715, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6117976263786356, "policy_loss": -0.003995854925597087, "vf_loss": 1.615733872850736, "vf_explained_var": 0.9438962777455647, "kl": 0.004768422787114076, "entropy": 0.6669092473263541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3769687360773486, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5708299458026886, "policy_loss": -0.006195870770413118, "vf_loss": 1.5766332160060605, "vf_explained_var": 0.9453002855181694, "kl": 0.007851978740335315, "entropy": 1.021065791261693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 76.07, "episode_media": {}, "episodes_this_iter": 49, "episodes_timesteps_total": 7607, "policy_reward_min": {"prey_policy": -50.70704428110655, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 50.70704428110655}, "policy_reward_mean": {"prey_policy": -24.273314477108908, "predator_policy": 24.273314477108908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [81, 67, 70, 98, 151, 182, 83, 85, 63, 52, 19, 20, 68, 61, 106, 69, 35, 100, 37, 60, 188, 48, 55, 47, 75, 70, 71, 59, 46, 76, 73, 97, 81, 86, 57, 231, 73, 53, 93, 222, 78, 73, 49, 72, 65, 23, 42, 70, 36, 34, 101, 148, 2, 67, 109, 159, 76, 149, 97, 63, 10, 31, 47, 36, 42, 34, 67, 73, 59, 105, 41, 37, 59, 130, 36, 79, 96, 67, 55, 77, 67, 112, 150, 87, 61, 101, 93, 126, 53, 47, 42, 157, 65, 68, 51, 90, 53, 65, 87, 30], "policy_prey_policy_reward": [-45.702014128349575, -27.99605863615025, -25.416382356037825, -39.37110059890746, -41.694754899615944, -19.335189327310452, -44.858717530463394, -19.336605556704036, -25.004165901428614, -12.468607019885491, -5.784016096424741, -2.487574264683304, -14.864054575445131, -31.126018934336734, -41.43341636924616, -20.114796020425437, -0.9319461183187503, -29.384187640175192, -13.130441037966833, -29.536631878274548, -34.63920621575154, -38.802665738728884, -26.149181009777852, -29.250551667210424, -37.654551173789756, -23.933522838517153, -25.402181275580734, -19.053211414958998, -26.07344015599792, -39.57503375985776, -28.260873826363206, -14.990766998228535, -30.11561557893854, -31.652248568583467, -33.227553512827434, -28.636952183456355, -19.86893733457145, -18.44300921100951, -31.759833487900703, -17.34903507478768, -28.974829784790977, -24.19627672944306, -8.731115636106983, -48.43009492495844, -24.122001627458925, -15.97649544858702, -18.168292493144875, -43.34778419892089, -12.290596904776754, -15.545385778083586, -50.70704428110655, -18.85900534624807, 0.0, -12.748093036459618, -21.638266834692658, -43.53595891025614, -31.640259159328796, -30.502769655478517, -35.180103857883395, -40.051163708033584, -3.107296290433603, -7.669987847185665, -10.316940835185319, -19.465987291308632, -5.498518911062751, -11.237865585572353, -28.122962028641357, -32.46855064562865, -35.64007793900193, -31.162942708626602, -5.849738499820743, -18.195772602708836, -18.420567553348675, -2.1874179797364524, -19.453095988670196, -30.354989171886093, -23.798396694803934, -25.24294973605094, -8.824123335254463, -33.27959765321535, -37.896789371461686, -28.85988371673935, -16.76604802046038, -14.62787195297112, -12.68980949898615, -36.30675658402244, -45.28051843707398, -22.157840329958407, -19.453496744538803, -19.62236618377905, -3.1678795902265344, -13.894722682944378, -23.89142706620738, -38.562013313586846, -16.91064351173444, -48.01186961776583, -34.88473295432215, -35.99467064092676, -12.274847551221754, -6.318892411074192], "policy_predator_policy_reward": [45.702014128349575, 27.99605863615025, 25.416382356037825, 39.37110059890746, 41.694754899615944, 19.335189327310452, 44.858717530463394, 19.336605556704036, 25.004165901428614, 12.468607019885491, 5.784016096424741, 2.487574264683304, 14.864054575445131, 31.126018934336734, 41.43341636924616, 20.114796020425437, 0.9319461183187503, 29.384187640175192, 13.130441037966833, 29.536631878274548, 34.63920621575154, 38.802665738728884, 26.149181009777852, 29.250551667210424, 37.654551173789756, 23.933522838517153, 25.402181275580734, 19.053211414958998, 26.07344015599792, 39.57503375985776, 28.260873826363206, 14.990766998228535, 30.11561557893854, 31.652248568583467, 33.227553512827434, 28.636952183456355, 19.86893733457145, 18.44300921100951, 31.759833487900703, 17.34903507478768, 28.974829784790977, 24.19627672944306, 8.731115636106983, 48.43009492495844, 24.122001627458925, 15.97649544858702, 18.168292493144875, 43.34778419892089, 12.290596904776754, 15.545385778083586, 50.70704428110655, 18.85900534624807, 0.0, 12.748093036459618, 21.638266834692658, 43.53595891025614, 31.640259159328796, 30.502769655478517, 35.180103857883395, 40.051163708033584, 3.107296290433603, 7.669987847185665, 10.316940835185319, 19.465987291308632, 5.498518911062751, 11.237865585572353, 28.122962028641357, 32.46855064562865, 35.64007793900193, 31.162942708626602, 5.849738499820743, 18.195772602708836, 18.420567553348675, 2.1874179797364524, 19.453095988670196, 30.354989171886093, 23.798396694803934, 25.24294973605094, 8.824123335254463, 33.27959765321535, 37.896789371461686, 28.85988371673935, 16.76604802046038, 14.62787195297112, 12.68980949898615, 36.30675658402244, 45.28051843707398, 22.157840329958407, 19.453496744538803, 19.62236618377905, 3.1678795902265344, 13.894722682944378, 23.89142706620738, 38.562013313586846, 16.91064351173444, 48.01186961776583, 34.88473295432215, 35.99467064092676, 12.274847551221754, 6.318892411074192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29201027830355186, "mean_inference_ms": 0.9415957217567795, "mean_action_processing_ms": 0.12667100458963992, "mean_env_wait_ms": 0.06707867432437506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027889013290405273, "StateBufferConnector_ms": 0.0023227930068969727, "ViewRequirementAgentConnector_ms": 0.04828667640686035}, "num_episodes": 49, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 705.2172627161725, "num_env_steps_trained_throughput_per_sec": 705.2172627161725, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 5960.445, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5960.404, "sample_time_ms": 654.417, "learn_time_ms": 5292.446, "learn_throughput": 755.794, "synch_weights_time_ms": 13.135}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 36, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-22", "timestamp": 1723390462, "time_this_iter_s": 5.678071737289429, "time_total_s": 206.92051911354065, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b6ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.92051911354065, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.087500000000002, "ram_util_percent": 82.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.291172027774155, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5376007496689756, "policy_loss": -0.0012087278919352684, "vf_loss": 1.5387713938330612, "vf_explained_var": 0.9469793946171801, "kl": 0.006094575515103237, "entropy": 0.5981777733191848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.491133733590444, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5430091065354645, "policy_loss": -0.007743047429054665, "vf_loss": 1.5503746514519057, "vf_explained_var": 0.9496028731887539, "kl": 0.007549942317609633, "entropy": 0.9044609105214476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 72.87, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 7287, "policy_reward_min": {"prey_policy": -57.77525546110884, "predator_policy": 2.1874179797364524}, "policy_reward_max": {"prey_policy": -2.1874179797364524, "predator_policy": 57.77525546110884}, "policy_reward_mean": {"prey_policy": -24.340683363218776, "predator_policy": 24.340683363218776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [31, 47, 36, 42, 34, 67, 73, 59, 105, 41, 37, 59, 130, 36, 79, 96, 67, 55, 77, 67, 112, 150, 87, 61, 101, 93, 126, 53, 47, 42, 157, 65, 68, 51, 90, 53, 65, 87, 30, 76, 30, 91, 88, 107, 28, 32, 61, 58, 55, 68, 52, 46, 91, 65, 201, 74, 88, 127, 69, 147, 39, 59, 82, 87, 103, 76, 42, 8, 51, 64, 63, 73, 53, 50, 70, 89, 62, 55, 21, 57, 103, 231, 88, 59, 61, 126, 64, 50, 77, 84, 79, 74, 59, 98, 56, 27, 75, 89, 73, 80], "policy_prey_policy_reward": [-7.669987847185665, -10.316940835185319, -19.465987291308632, -5.498518911062751, -11.237865585572353, -28.122962028641357, -32.46855064562865, -35.64007793900193, -31.162942708626602, -5.849738499820743, -18.195772602708836, -18.420567553348675, -2.1874179797364524, -19.453095988670196, -30.354989171886093, -23.798396694803934, -25.24294973605094, -8.824123335254463, -33.27959765321535, -37.896789371461686, -28.85988371673935, -16.76604802046038, -14.62787195297112, -12.68980949898615, -36.30675658402244, -45.28051843707398, -22.157840329958407, -19.453496744538803, -19.62236618377905, -3.1678795902265344, -13.894722682944378, -23.89142706620738, -38.562013313586846, -16.91064351173444, -48.01186961776583, -34.88473295432215, -35.99467064092676, -12.274847551221754, -6.318892411074192, -36.876044893060175, -9.425171013436259, -35.006809117700556, -34.311948534562504, -24.102186864708855, -6.613450850077366, -20.427237301816564, -22.630365352205974, -26.47975784081159, -26.38939411923325, -16.14709341505249, -23.15538731548132, -12.48233621583951, -16.594951162628348, -25.839666593428834, -50.13259759690183, -34.75398412482944, -22.47749105868889, -21.275764989984843, -41.91094990782195, -7.471505945656368, -18.61543634918373, -36.61038049471435, -29.338605189944015, -33.73586387190628, -39.60319478206266, -25.640281577834102, -12.263100662491206, -4.91546014689319, -16.916837984987986, -13.818347961608758, -13.476953968613927, -29.01665025277462, -14.122365070756416, -11.022661384134434, -36.75612189185118, -12.055035474213295, -38.579297521549606, -21.565643739883594, -7.817888959787519, -33.87742292815007, -37.94491350343739, -25.94769514268907, -57.77525546110884, -38.204630545440544, -6.575607079507794, -33.779061333243945, -38.81370145573831, -14.467718861922949, -25.54237920944393, -33.76542444338163, -42.32172436512176, -17.35442423000761, -27.329408315344807, -38.60515424432837, -19.563519539328148, -17.921074929171425, -33.74116916601464, -55.07529038168431, -17.239107047189698, -33.0858694527941], "policy_predator_policy_reward": [7.669987847185665, 10.316940835185319, 19.465987291308632, 5.498518911062751, 11.237865585572353, 28.122962028641357, 32.46855064562865, 35.64007793900193, 31.162942708626602, 5.849738499820743, 18.195772602708836, 18.420567553348675, 2.1874179797364524, 19.453095988670196, 30.354989171886093, 23.798396694803934, 25.24294973605094, 8.824123335254463, 33.27959765321535, 37.896789371461686, 28.85988371673935, 16.76604802046038, 14.62787195297112, 12.68980949898615, 36.30675658402244, 45.28051843707398, 22.157840329958407, 19.453496744538803, 19.62236618377905, 3.1678795902265344, 13.894722682944378, 23.89142706620738, 38.562013313586846, 16.91064351173444, 48.01186961776583, 34.88473295432215, 35.99467064092676, 12.274847551221754, 6.318892411074192, 36.876044893060175, 9.425171013436259, 35.006809117700556, 34.311948534562504, 24.102186864708855, 6.613450850077366, 20.427237301816564, 22.630365352205974, 26.47975784081159, 26.38939411923325, 16.14709341505249, 23.15538731548132, 12.48233621583951, 16.594951162628348, 25.839666593428834, 50.13259759690183, 34.75398412482944, 22.47749105868889, 21.275764989984843, 41.91094990782195, 7.471505945656368, 18.61543634918373, 36.61038049471435, 29.338605189944015, 33.73586387190628, 39.60319478206266, 25.640281577834102, 12.263100662491206, 4.91546014689319, 16.916837984987986, 13.818347961608758, 13.476953968613927, 29.01665025277462, 14.122365070756416, 11.022661384134434, 36.75612189185118, 12.055035474213295, 38.579297521549606, 21.565643739883594, 7.817888959787519, 33.87742292815007, 37.94491350343739, 25.94769514268907, 57.77525546110884, 38.204630545440544, 6.575607079507794, 33.779061333243945, 38.81370145573831, 14.467718861922949, 25.54237920944393, 33.76542444338163, 42.32172436512176, 17.35442423000761, 27.329408315344807, 38.60515424432837, 19.563519539328148, 17.921074929171425, 33.74116916601464, 55.07529038168431, 17.239107047189698, 33.0858694527941]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29104207022452605, "mean_inference_ms": 0.9385662160294421, "mean_action_processing_ms": 0.12650410558639527, "mean_env_wait_ms": 0.06675812999441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028094053268432617, "StateBufferConnector_ms": 0.0021851062774658203, "ViewRequirementAgentConnector_ms": 0.046527862548828125}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 658.9402592350799, "num_env_steps_trained_throughput_per_sec": 658.9402592350799, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 5957.77, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5957.73, "sample_time_ms": 658.315, "learn_time_ms": 5285.896, "learn_throughput": 756.731, "synch_weights_time_ms": 13.116}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 37, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-28", "timestamp": 1723390468, "time_this_iter_s": 6.074556827545166, "time_total_s": 212.99507594108582, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.99507594108582, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 82.62222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.978194651628534, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4034099393213788, "policy_loss": -0.00500405685743317, "vf_loss": 1.4083724216247597, "vf_explained_var": 0.9583006335422397, "kl": 0.006652312855032072, "entropy": 0.5536243407366176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1780884971221286, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4170892218127846, "policy_loss": -0.00801011863174305, "vf_loss": 1.4246985973169406, "vf_explained_var": 0.9602738320206602, "kl": 0.008014889382593409, "entropy": 0.8974121651301782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.0, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6900, "policy_reward_min": {"prey_policy": -57.77525546110884, "predator_policy": 2.798205507467524}, "policy_reward_max": {"prey_policy": -2.798205507467524, "predator_policy": 57.77525546110884}, "policy_reward_mean": {"prey_policy": -25.900160820504073, "predator_policy": 25.900160820504073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [147, 39, 59, 82, 87, 103, 76, 42, 8, 51, 64, 63, 73, 53, 50, 70, 89, 62, 55, 21, 57, 103, 231, 88, 59, 61, 126, 64, 50, 77, 84, 79, 74, 59, 98, 56, 27, 75, 89, 73, 80, 37, 93, 74, 50, 68, 56, 59, 84, 41, 54, 108, 92, 81, 63, 74, 84, 30, 76, 67, 62, 113, 69, 43, 124, 57, 74, 32, 85, 75, 60, 64, 35, 91, 74, 113, 51, 91, 94, 49, 36, 36, 56, 32, 85, 53, 40, 77, 59, 99, 119, 56, 23, 49, 74, 65, 65, 9, 51, 65], "policy_prey_policy_reward": [-7.471505945656368, -18.61543634918373, -36.61038049471435, -29.338605189944015, -33.73586387190628, -39.60319478206266, -25.640281577834102, -12.263100662491206, -4.91546014689319, -16.916837984987986, -13.818347961608758, -13.476953968613927, -29.01665025277462, -14.122365070756416, -11.022661384134434, -36.75612189185118, -12.055035474213295, -38.579297521549606, -21.565643739883594, -7.817888959787519, -33.87742292815007, -37.94491350343739, -25.94769514268907, -57.77525546110884, -38.204630545440544, -6.575607079507794, -33.779061333243945, -38.81370145573831, -14.467718861922949, -25.54237920944393, -33.76542444338163, -42.32172436512176, -17.35442423000761, -27.329408315344807, -38.60515424432837, -19.563519539328148, -17.921074929171425, -33.74116916601464, -55.07529038168431, -17.239107047189698, -33.0858694527941, -19.246122467151178, -38.673783575810546, -32.474989790667195, -20.164852028883082, -33.739663141314566, -37.2553538982585, -44.78137843801137, -18.205154455808753, -13.878400525486626, -2.798205507467524, -39.24436913162248, -39.86389767974406, -49.113302429747456, -43.64544401679864, -29.202946138921853, -30.681718899353907, -11.214658403856314, -48.467310939043685, -10.747465209950803, -7.265873514674331, -24.031498916419032, -37.253153140912076, -13.973671268510207, -24.13625111647868, -16.043934251769343, -12.387750963668424, -7.325082358103652, -6.175819861145969, -21.432817485986693, -42.10912293014041, -44.248088029623396, -8.540466064596076, -37.014880769759856, -32.02611741875787, -5.820476443041185, -38.118222907873914, -53.645395732163905, -41.521781489297446, -26.30419311571233, -15.725780206484075, -16.193383854761265, -44.123004431339204, -11.423299481214078, -44.134081698281484, -28.02519725227234, -10.986434902892404, -5.526103884261178, -29.373626549093732, -23.219800176419668, -4.567496959544744, -21.853693855418424, -4.423965158322037, -22.56826758255223, -36.89627388997831, -25.296657603066787, -26.696030749662608, -6.352098912251305, -44.829660286400404, -32.75542529376148], "policy_predator_policy_reward": [7.471505945656368, 18.61543634918373, 36.61038049471435, 29.338605189944015, 33.73586387190628, 39.60319478206266, 25.640281577834102, 12.263100662491206, 4.91546014689319, 16.916837984987986, 13.818347961608758, 13.476953968613927, 29.01665025277462, 14.122365070756416, 11.022661384134434, 36.75612189185118, 12.055035474213295, 38.579297521549606, 21.565643739883594, 7.817888959787519, 33.87742292815007, 37.94491350343739, 25.94769514268907, 57.77525546110884, 38.204630545440544, 6.575607079507794, 33.779061333243945, 38.81370145573831, 14.467718861922949, 25.54237920944393, 33.76542444338163, 42.32172436512176, 17.35442423000761, 27.329408315344807, 38.60515424432837, 19.563519539328148, 17.921074929171425, 33.74116916601464, 55.07529038168431, 17.239107047189698, 33.0858694527941, 19.246122467151178, 38.673783575810546, 32.474989790667195, 20.164852028883082, 33.739663141314566, 37.2553538982585, 44.78137843801137, 18.205154455808753, 13.878400525486626, 2.798205507467524, 39.24436913162248, 39.86389767974406, 49.113302429747456, 43.64544401679864, 29.202946138921853, 30.681718899353907, 11.214658403856314, 48.467310939043685, 10.747465209950803, 7.265873514674331, 24.031498916419032, 37.253153140912076, 13.973671268510207, 24.13625111647868, 16.043934251769343, 12.387750963668424, 7.325082358103652, 6.175819861145969, 21.432817485986693, 42.10912293014041, 44.248088029623396, 8.540466064596076, 37.014880769759856, 32.02611741875787, 5.820476443041185, 38.118222907873914, 53.645395732163905, 41.521781489297446, 26.30419311571233, 15.725780206484075, 16.193383854761265, 44.123004431339204, 11.423299481214078, 44.134081698281484, 28.02519725227234, 10.986434902892404, 5.526103884261178, 29.373626549093732, 23.219800176419668, 4.567496959544744, 21.853693855418424, 4.423965158322037, 22.56826758255223, 36.89627388997831, 25.296657603066787, 26.696030749662608, 6.352098912251305, 44.829660286400404, 32.75542529376148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29074030757037644, "mean_inference_ms": 0.9378861877327183, "mean_action_processing_ms": 0.1268204803490085, "mean_env_wait_ms": 0.06666663930074178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026322603225708008, "StateBufferConnector_ms": 0.0020388364791870117, "ViewRequirementAgentConnector_ms": 0.04682910442352295}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 666.6025647240228, "num_env_steps_trained_throughput_per_sec": 666.6025647240228, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 5953.16, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5953.126, "sample_time_ms": 662.263, "learn_time_ms": 5277.552, "learn_throughput": 757.927, "synch_weights_time_ms": 12.871}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 38, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-34", "timestamp": 1723390474, "time_this_iter_s": 6.005902051925659, "time_total_s": 219.00097799301147, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d2e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.00097799301147, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 27.633333333333336, "ram_util_percent": 82.44444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4936888347690305, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5778739970177411, "policy_loss": -0.005546262780262623, "vf_loss": 1.5833681395898263, "vf_explained_var": 0.9698107421398163, "kl": 0.008339630475421533, "entropy": 0.568119563596944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5818174914767344, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5166016769905886, "policy_loss": -0.00493786120484098, "vf_loss": 1.521190489580234, "vf_explained_var": 0.9709032175441583, "kl": 0.006980975331052745, "entropy": 0.9137191181381543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.12, "episode_media": {}, "episodes_this_iter": 54, "episodes_timesteps_total": 6812, "policy_reward_min": {"prey_policy": -58.00744089861815, "predator_policy": 1.816682733471007}, "policy_reward_max": {"prey_policy": -1.816682733471007, "predator_policy": 58.00744089861815}, "policy_reward_mean": {"prey_policy": -25.409474847740995, "predator_policy": 25.409474847740995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [63, 74, 84, 30, 76, 67, 62, 113, 69, 43, 124, 57, 74, 32, 85, 75, 60, 64, 35, 91, 74, 113, 51, 91, 94, 49, 36, 36, 56, 32, 85, 53, 40, 77, 59, 99, 119, 56, 23, 49, 74, 65, 65, 9, 51, 65, 49, 44, 53, 56, 31, 89, 62, 13, 46, 84, 57, 94, 88, 62, 61, 85, 66, 10, 47, 78, 86, 60, 66, 96, 67, 89, 74, 52, 103, 167, 47, 141, 3, 55, 41, 91, 62, 28, 107, 66, 71, 40, 73, 86, 44, 36, 97, 86, 95, 91, 67, 167, 80, 104], "policy_prey_policy_reward": [-43.64544401679864, -29.202946138921853, -30.681718899353907, -11.214658403856314, -48.467310939043685, -10.747465209950803, -7.265873514674331, -24.031498916419032, -37.253153140912076, -13.973671268510207, -24.13625111647868, -16.043934251769343, -12.387750963668424, -7.325082358103652, -6.175819861145969, -21.432817485986693, -42.10912293014041, -44.248088029623396, -8.540466064596076, -37.014880769759856, -32.02611741875787, -5.820476443041185, -38.118222907873914, -53.645395732163905, -41.521781489297446, -26.30419311571233, -15.725780206484075, -16.193383854761265, -44.123004431339204, -11.423299481214078, -44.134081698281484, -28.02519725227234, -10.986434902892404, -5.526103884261178, -29.373626549093732, -23.219800176419668, -4.567496959544744, -21.853693855418424, -4.423965158322037, -22.56826758255223, -36.89627388997831, -25.296657603066787, -26.696030749662608, -6.352098912251305, -44.829660286400404, -32.75542529376148, -8.595191994642061, -11.56696117984628, -21.98833928653547, -12.50641696177157, -17.98107400843632, -43.56042693372221, -43.230057786286466, -3.088011425596075, -26.403718989200165, -32.35892783374439, -16.08635799762697, -49.45531138748908, -39.750369300051375, -29.250765464917645, -15.489491477404737, -34.89685280973845, -25.383013329782933, -3.809779004803211, -5.637609672188473, -25.37368913163995, -28.340734916903614, -33.26690365732561, -34.40651337531599, -20.71983460577332, -30.88465221826372, -54.806640119852204, -35.71574149759467, -35.32866502089386, -7.679130002148874, -30.055713645809192, -26.684483161579966, -14.656859545267446, -1.816682733471007, -36.49517987325329, -20.133101913304888, -33.96352805923258, -36.73663153118263, -6.064842799034038, -58.00744089861815, -28.737295909170502, -16.784941597800394, -4.067261373656599, -33.60990658454154, -24.80178606515086, -27.226333499846223, -17.221883077486744, -13.307439512525743, -24.633642822704893, -47.800808998601404, -46.81661735126897, -35.73772670540138, -28.45210121029588, -42.53377264389212, -8.735897756969722], "policy_predator_policy_reward": [43.64544401679864, 29.202946138921853, 30.681718899353907, 11.214658403856314, 48.467310939043685, 10.747465209950803, 7.265873514674331, 24.031498916419032, 37.253153140912076, 13.973671268510207, 24.13625111647868, 16.043934251769343, 12.387750963668424, 7.325082358103652, 6.175819861145969, 21.432817485986693, 42.10912293014041, 44.248088029623396, 8.540466064596076, 37.014880769759856, 32.02611741875787, 5.820476443041185, 38.118222907873914, 53.645395732163905, 41.521781489297446, 26.30419311571233, 15.725780206484075, 16.193383854761265, 44.123004431339204, 11.423299481214078, 44.134081698281484, 28.02519725227234, 10.986434902892404, 5.526103884261178, 29.373626549093732, 23.219800176419668, 4.567496959544744, 21.853693855418424, 4.423965158322037, 22.56826758255223, 36.89627388997831, 25.296657603066787, 26.696030749662608, 6.352098912251305, 44.829660286400404, 32.75542529376148, 8.595191994642061, 11.56696117984628, 21.98833928653547, 12.50641696177157, 17.98107400843632, 43.56042693372221, 43.230057786286466, 3.088011425596075, 26.403718989200165, 32.35892783374439, 16.08635799762697, 49.45531138748908, 39.750369300051375, 29.250765464917645, 15.489491477404737, 34.89685280973845, 25.383013329782933, 3.809779004803211, 5.637609672188473, 25.37368913163995, 28.340734916903614, 33.26690365732561, 34.40651337531599, 20.71983460577332, 30.88465221826372, 54.806640119852204, 35.71574149759467, 35.32866502089386, 7.679130002148874, 30.055713645809192, 26.684483161579966, 14.656859545267446, 1.816682733471007, 36.49517987325329, 20.133101913304888, 33.96352805923258, 36.73663153118263, 6.064842799034038, 58.00744089861815, 28.737295909170502, 16.784941597800394, 4.067261373656599, 33.60990658454154, 24.80178606515086, 27.226333499846223, 17.221883077486744, 13.307439512525743, 24.633642822704893, 47.800808998601404, 46.81661735126897, 35.73772670540138, 28.45210121029588, 42.53377264389212, 8.735897756969722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2906797151406006, "mean_inference_ms": 0.9378756833578631, "mean_action_processing_ms": 0.1269445362493293, "mean_env_wait_ms": 0.06682519178158539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003063201904296875, "StateBufferConnector_ms": 0.002197742462158203, "ViewRequirementAgentConnector_ms": 0.04966425895690918}, "num_episodes": 54, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 669.9374195382654, "num_env_steps_trained_throughput_per_sec": 669.9374195382654, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 5937.487, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5937.453, "sample_time_ms": 656.75, "learn_time_ms": 5267.309, "learn_throughput": 759.401, "synch_weights_time_ms": 12.913}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 39, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-40", "timestamp": 1723390480, "time_this_iter_s": 5.975977897644043, "time_total_s": 224.97695589065552, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b64c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.97695589065552, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 28.1375, "ram_util_percent": 82.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9586254451423883, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1284985615561405, "policy_loss": -0.002978702585581535, "vf_loss": 1.1314354436472058, "vf_explained_var": 0.9775167050460974, "kl": 0.006691882062318536, "entropy": 0.52855985260879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.258670423304041, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1259324444457888, "policy_loss": -0.005992461133670682, "vf_loss": 1.1317217767238616, "vf_explained_var": 0.9791628709062934, "kl": 0.00406251677225595, "entropy": 0.8566674993063013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 70.65, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 7065, "policy_reward_min": {"prey_policy": -58.00744089861815, "predator_policy": 1.6682573947226174}, "policy_reward_max": {"prey_policy": -1.6682573947226174, "predator_policy": 58.00744089861815}, "policy_reward_mean": {"prey_policy": -25.240943800793957, "predator_policy": 25.240943800793957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [88, 62, 61, 85, 66, 10, 47, 78, 86, 60, 66, 96, 67, 89, 74, 52, 103, 167, 47, 141, 3, 55, 41, 91, 62, 28, 107, 66, 71, 40, 73, 86, 44, 36, 97, 86, 95, 91, 67, 167, 80, 104, 209, 60, 41, 66, 56, 71, 44, 34, 122, 67, 61, 40, 57, 53, 25, 27, 68, 60, 75, 28, 43, 100, 83, 51, 45, 61, 74, 35, 111, 83, 153, 148, 75, 33, 66, 52, 73, 8, 108, 60, 44, 42, 75, 35, 38, 63, 82, 68, 65, 70, 47, 183, 35, 73, 65, 69, 94, 56], "policy_prey_policy_reward": [-39.750369300051375, -29.250765464917645, -15.489491477404737, -34.89685280973845, -25.383013329782933, -3.809779004803211, -5.637609672188473, -25.37368913163995, -28.340734916903614, -33.26690365732561, -34.40651337531599, -20.71983460577332, -30.88465221826372, -54.806640119852204, -35.71574149759467, -35.32866502089386, -7.679130002148874, -30.055713645809192, -26.684483161579966, -14.656859545267446, -1.816682733471007, -36.49517987325329, -20.133101913304888, -33.96352805923258, -36.73663153118263, -6.064842799034038, -58.00744089861815, -28.737295909170502, -16.784941597800394, -4.067261373656599, -33.60990658454154, -24.80178606515086, -27.226333499846223, -17.221883077486744, -13.307439512525743, -24.633642822704893, -47.800808998601404, -46.81661735126897, -35.73772670540138, -28.45210121029588, -42.53377264389212, -8.735897756969722, -41.5124911833374, -22.444674521356287, -27.973914222887963, -28.07916823498414, -19.091323210988104, -27.203251202990298, -17.55433762063446, -14.81018718767067, -36.73224737624222, -38.46723597667371, -33.95487941303566, -14.839657154072693, -26.932925348939, -33.1781353256889, -6.796624094320555, -10.351660536557517, -32.286201036162495, -34.74675827473597, -32.62781084388421, -13.072552654864605, -37.728949756535805, -8.48759649966755, -19.151454795550684, -10.903869431797283, -31.687142790684167, -24.191515510112954, -22.390924610826556, -9.686653994897537, -13.826075531253673, -45.68227714315926, -34.94561325771311, -32.72776550734247, -21.381347902104782, -24.675783562235004, -27.171967251923284, -15.492662385656246, -30.118668015612954, -2.958992772206985, -31.148200470996063, -32.120562524688225, -33.817712075818996, -32.620120969837544, -3.9944592500652263, -21.60535402949817, -20.622477854643186, -30.840283427917413, -32.87630855306469, -18.249337288257394, -11.723419895028002, -35.196299034258104, -11.384803750645311, -32.620029596944846, -11.125378575110735, -13.498933812934222, -1.6682573947226174, -23.613616430075712, -52.74775460655526, -20.933509524362297], "policy_predator_policy_reward": [39.750369300051375, 29.250765464917645, 15.489491477404737, 34.89685280973845, 25.383013329782933, 3.809779004803211, 5.637609672188473, 25.37368913163995, 28.340734916903614, 33.26690365732561, 34.40651337531599, 20.71983460577332, 30.88465221826372, 54.806640119852204, 35.71574149759467, 35.32866502089386, 7.679130002148874, 30.055713645809192, 26.684483161579966, 14.656859545267446, 1.816682733471007, 36.49517987325329, 20.133101913304888, 33.96352805923258, 36.73663153118263, 6.064842799034038, 58.00744089861815, 28.737295909170502, 16.784941597800394, 4.067261373656599, 33.60990658454154, 24.80178606515086, 27.226333499846223, 17.221883077486744, 13.307439512525743, 24.633642822704893, 47.800808998601404, 46.81661735126897, 35.73772670540138, 28.45210121029588, 42.53377264389212, 8.735897756969722, 41.5124911833374, 22.444674521356287, 27.973914222887963, 28.07916823498414, 19.091323210988104, 27.203251202990298, 17.55433762063446, 14.81018718767067, 36.73224737624222, 38.46723597667371, 33.95487941303566, 14.839657154072693, 26.932925348939, 33.1781353256889, 6.796624094320555, 10.351660536557517, 32.286201036162495, 34.74675827473597, 32.62781084388421, 13.072552654864605, 37.728949756535805, 8.48759649966755, 19.151454795550684, 10.903869431797283, 31.687142790684167, 24.191515510112954, 22.390924610826556, 9.686653994897537, 13.826075531253673, 45.68227714315926, 34.94561325771311, 32.72776550734247, 21.381347902104782, 24.675783562235004, 27.171967251923284, 15.492662385656246, 30.118668015612954, 2.958992772206985, 31.148200470996063, 32.120562524688225, 33.817712075818996, 32.620120969837544, 3.9944592500652263, 21.60535402949817, 20.622477854643186, 30.840283427917413, 32.87630855306469, 18.249337288257394, 11.723419895028002, 35.196299034258104, 11.384803750645311, 32.620029596944846, 11.125378575110735, 13.498933812934222, 1.6682573947226174, 23.613616430075712, 52.74775460655526, 20.933509524362297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29026300344504713, "mean_inference_ms": 0.936783312555152, "mean_action_processing_ms": 0.12685196774531693, "mean_env_wait_ms": 0.06677123790324328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029144287109375, "StateBufferConnector_ms": 0.0020699501037597656, "ViewRequirementAgentConnector_ms": 0.047901034355163574}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.2795428734277, "num_env_steps_trained_throughput_per_sec": 672.2795428734277, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 5928.002, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5927.968, "sample_time_ms": 652.018, "learn_time_ms": 5262.576, "learn_throughput": 760.084, "synch_weights_time_ms": 12.94}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 40, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-46", "timestamp": 1723390486, "time_this_iter_s": 5.9542529582977295, "time_total_s": 230.93120884895325, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.93120884895325, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.65555555555555, "ram_util_percent": 82.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.348549879404406, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.453025408834219, "policy_loss": -0.0038670393703796437, "vf_loss": 1.456854341427485, "vf_explained_var": 0.9679615028823415, "kl": 0.0060973475495473975, "entropy": 0.5379856821770469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.561210395892461, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4017745696008206, "policy_loss": -0.008214473957195878, "vf_loss": 1.4097642566387851, "vf_explained_var": 0.9688078651204706, "kl": 0.00899139908720817, "entropy": 0.8672367101535201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.48, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6848, "policy_reward_min": {"prey_policy": -52.74775460655526, "predator_policy": 1.6682573947226174}, "policy_reward_max": {"prey_policy": -1.6682573947226174, "predator_policy": 52.74775460655526}, "policy_reward_mean": {"prey_policy": -24.149058737696144, "predator_policy": 24.149058737696144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [60, 75, 28, 43, 100, 83, 51, 45, 61, 74, 35, 111, 83, 153, 148, 75, 33, 66, 52, 73, 8, 108, 60, 44, 42, 75, 35, 38, 63, 82, 68, 65, 70, 47, 183, 35, 73, 65, 69, 94, 56, 90, 86, 74, 82, 76, 85, 77, 88, 84, 48, 47, 153, 102, 82, 90, 81, 42, 53, 81, 23, 43, 42, 63, 58, 75, 89, 49, 50, 56, 18, 60, 83, 51, 91, 74, 74, 126, 51, 43, 50, 93, 84, 71, 55, 66, 63, 29, 93, 78, 62, 41, 34, 53, 32, 89, 78, 61, 86, 61], "policy_prey_policy_reward": [-34.74675827473597, -32.62781084388421, -13.072552654864605, -37.728949756535805, -8.48759649966755, -19.151454795550684, -10.903869431797283, -31.687142790684167, -24.191515510112954, -22.390924610826556, -9.686653994897537, -13.826075531253673, -45.68227714315926, -34.94561325771311, -32.72776550734247, -21.381347902104782, -24.675783562235004, -27.171967251923284, -15.492662385656246, -30.118668015612954, -2.958992772206985, -31.148200470996063, -32.120562524688225, -33.817712075818996, -32.620120969837544, -3.9944592500652263, -21.60535402949817, -20.622477854643186, -30.840283427917413, -32.87630855306469, -18.249337288257394, -11.723419895028002, -35.196299034258104, -11.384803750645311, -32.620029596944846, -11.125378575110735, -13.498933812934222, -1.6682573947226174, -23.613616430075712, -52.74775460655526, -20.933509524362297, -15.082241468714113, -42.3904575366988, -44.78635802389953, -10.463170762597711, -11.781798782346687, -35.16297753216714, -51.83242110267408, -37.73199904309409, -25.81958563251326, -13.356576645568657, -25.89760129674016, -32.42488009130595, -27.49231695395046, -47.61093756706877, -22.033845237576855, -33.74006724071004, -20.504965985033945, -16.982106277675364, -17.966024496332942, -22.813040484930482, -5.316988325737598, -13.900884321100204, -35.61239868722036, -12.061111250745945, -23.723998378518502, -49.85741287815254, -22.04364914349614, -8.930980124129706, -11.918161053233693, -6.436020853521997, -23.799425529413764, -34.12705405597592, -16.618920701079, -33.425663961314015, -13.721666010115953, -43.495441615939434, -12.457555425932766, -12.47083685094301, -12.887696629347973, -35.04013367487291, -31.62750289003179, -44.11836364472649, -9.628477622479847, -21.05907712726725, -21.547779836680277, -25.201385018952585, -13.223318642473686, -34.53988478379194, -30.273389845949147, -16.200192551644548, -15.606908062698933, -10.024961498498095, -6.418789445469063, -18.009844235067227, -34.014584318205806, -42.97748079936383, -12.023713531718473, -40.62571567307001, -38.00193105094582], "policy_predator_policy_reward": [34.74675827473597, 32.62781084388421, 13.072552654864605, 37.728949756535805, 8.48759649966755, 19.151454795550684, 10.903869431797283, 31.687142790684167, 24.191515510112954, 22.390924610826556, 9.686653994897537, 13.826075531253673, 45.68227714315926, 34.94561325771311, 32.72776550734247, 21.381347902104782, 24.675783562235004, 27.171967251923284, 15.492662385656246, 30.118668015612954, 2.958992772206985, 31.148200470996063, 32.120562524688225, 33.817712075818996, 32.620120969837544, 3.9944592500652263, 21.60535402949817, 20.622477854643186, 30.840283427917413, 32.87630855306469, 18.249337288257394, 11.723419895028002, 35.196299034258104, 11.384803750645311, 32.620029596944846, 11.125378575110735, 13.498933812934222, 1.6682573947226174, 23.613616430075712, 52.74775460655526, 20.933509524362297, 15.082241468714113, 42.3904575366988, 44.78635802389953, 10.463170762597711, 11.781798782346687, 35.16297753216714, 51.83242110267408, 37.73199904309409, 25.81958563251326, 13.356576645568657, 25.89760129674016, 32.42488009130595, 27.49231695395046, 47.61093756706877, 22.033845237576855, 33.74006724071004, 20.504965985033945, 16.982106277675364, 17.966024496332942, 22.813040484930482, 5.316988325737598, 13.900884321100204, 35.61239868722036, 12.061111250745945, 23.723998378518502, 49.85741287815254, 22.04364914349614, 8.930980124129706, 11.918161053233693, 6.436020853521997, 23.799425529413764, 34.12705405597592, 16.618920701079, 33.425663961314015, 13.721666010115953, 43.495441615939434, 12.457555425932766, 12.47083685094301, 12.887696629347973, 35.04013367487291, 31.62750289003179, 44.11836364472649, 9.628477622479847, 21.05907712726725, 21.547779836680277, 25.201385018952585, 13.223318642473686, 34.53988478379194, 30.273389845949147, 16.200192551644548, 15.606908062698933, 10.024961498498095, 6.418789445469063, 18.009844235067227, 34.014584318205806, 42.97748079936383, 12.023713531718473, 40.62571567307001, 38.00193105094582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.290493784348049, "mean_inference_ms": 0.9353977963441992, "mean_action_processing_ms": 0.12648301383560928, "mean_env_wait_ms": 0.06644651481875481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002833843231201172, "StateBufferConnector_ms": 0.001973867416381836, "ViewRequirementAgentConnector_ms": 0.045749664306640625}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.152072848566, "num_env_steps_trained_throughput_per_sec": 699.152072848566, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 5913.301, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5913.267, "sample_time_ms": 650.539, "learn_time_ms": 5249.373, "learn_throughput": 761.996, "synch_weights_time_ms": 12.921}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 41, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-51", "timestamp": 1723390491, "time_this_iter_s": 5.726672172546387, "time_total_s": 236.65788102149963, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b12aed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.65788102149963, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 28.4125, "ram_util_percent": 82.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.02294294120123, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1161521469553313, "policy_loss": -0.002936969573784154, "vf_loss": 1.1190553915376464, "vf_explained_var": 0.9748568767681718, "kl": 0.005395976124177795, "entropy": 0.47268728880832594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1920740438625215, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1497875665004054, "policy_loss": -0.009168583168260133, "vf_loss": 1.1587973664825162, "vf_explained_var": 0.9759568115075429, "kl": 0.006351230251689377, "entropy": 0.8887018661325177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.65, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6665, "policy_reward_min": {"prey_policy": -49.85741287815254, "predator_policy": 3.0854471076075227}, "policy_reward_max": {"prey_policy": -3.0854471076075227, "predator_policy": 49.85741287815254}, "policy_reward_mean": {"prey_policy": -23.566401099742375, "predator_policy": 23.566401099742375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [43, 42, 63, 58, 75, 89, 49, 50, 56, 18, 60, 83, 51, 91, 74, 74, 126, 51, 43, 50, 93, 84, 71, 55, 66, 63, 29, 93, 78, 62, 41, 34, 53, 32, 89, 78, 61, 86, 61, 105, 55, 65, 57, 44, 14, 67, 52, 24, 98, 75, 58, 76, 71, 43, 86, 66, 85, 73, 39, 51, 57, 150, 66, 77, 58, 40, 47, 69, 89, 78, 51, 52, 54, 92, 120, 73, 32, 82, 75, 55, 96, 98, 202, 27, 64, 42, 53, 57, 80, 66, 63, 55, 88, 20, 77, 74, 58, 75, 140, 34], "policy_prey_policy_reward": [-5.316988325737598, -13.900884321100204, -35.61239868722036, -12.061111250745945, -23.723998378518502, -49.85741287815254, -22.04364914349614, -8.930980124129706, -11.918161053233693, -6.436020853521997, -23.799425529413764, -34.12705405597592, -16.618920701079, -33.425663961314015, -13.721666010115953, -43.495441615939434, -12.457555425932766, -12.47083685094301, -12.887696629347973, -35.04013367487291, -31.62750289003179, -44.11836364472649, -9.628477622479847, -21.05907712726725, -21.547779836680277, -25.201385018952585, -13.223318642473686, -34.53988478379194, -30.273389845949147, -16.200192551644548, -15.606908062698933, -10.024961498498095, -6.418789445469063, -18.009844235067227, -34.014584318205806, -42.97748079936383, -12.023713531718473, -40.62571567307001, -38.00193105094582, -21.833169180253, -15.91809018497507, -30.36107572813264, -36.33845747864992, -36.71387945598773, -5.378359600510309, -8.325933926052329, -19.598958639445495, -13.488615175654466, -10.969259598379551, -21.289689799476676, -27.543624112631633, -12.192912680107712, -32.53390610147797, -19.836058386103044, -35.33040872880594, -27.421169241334542, -35.39441682923098, -44.44328163203759, -8.403775117607125, -18.54594882208413, -23.770192866545457, -44.67369844168066, -33.18541452748555, -32.38641886694052, -19.640766978935098, -12.685491616450472, -3.3994355245746397, -5.932925833808974, -42.512699624176726, -13.299851765282265, -18.524162756880546, -16.188647334740562, -30.29234609474262, -27.201785977760434, -25.43547142972779, -34.349893573923794, -3.0854471076075227, -48.589779212665874, -31.003010530195603, -19.002566856621012, -39.328752583872024, -45.932609958541605, -30.20752099006248, -7.191706517846265, -31.24262039543183, -13.479974834739101, -24.749320712273388, -25.056868792896505, -27.20317291603739, -28.87098086827795, -34.492272443356875, -21.16654773888157, -26.87865695435439, -11.655074931652669, -38.543544671536296, -36.7536745103112, -17.562118924352973, -21.0592103910512, -9.369958609786648, -5.905224839464581], "policy_predator_policy_reward": [5.316988325737598, 13.900884321100204, 35.61239868722036, 12.061111250745945, 23.723998378518502, 49.85741287815254, 22.04364914349614, 8.930980124129706, 11.918161053233693, 6.436020853521997, 23.799425529413764, 34.12705405597592, 16.618920701079, 33.425663961314015, 13.721666010115953, 43.495441615939434, 12.457555425932766, 12.47083685094301, 12.887696629347973, 35.04013367487291, 31.62750289003179, 44.11836364472649, 9.628477622479847, 21.05907712726725, 21.547779836680277, 25.201385018952585, 13.223318642473686, 34.53988478379194, 30.273389845949147, 16.200192551644548, 15.606908062698933, 10.024961498498095, 6.418789445469063, 18.009844235067227, 34.014584318205806, 42.97748079936383, 12.023713531718473, 40.62571567307001, 38.00193105094582, 21.833169180253, 15.91809018497507, 30.36107572813264, 36.33845747864992, 36.71387945598773, 5.378359600510309, 8.325933926052329, 19.598958639445495, 13.488615175654466, 10.969259598379551, 21.289689799476676, 27.543624112631633, 12.192912680107712, 32.53390610147797, 19.836058386103044, 35.33040872880594, 27.421169241334542, 35.39441682923098, 44.44328163203759, 8.403775117607125, 18.54594882208413, 23.770192866545457, 44.67369844168066, 33.18541452748555, 32.38641886694052, 19.640766978935098, 12.685491616450472, 3.3994355245746397, 5.932925833808974, 42.512699624176726, 13.299851765282265, 18.524162756880546, 16.188647334740562, 30.29234609474262, 27.201785977760434, 25.43547142972779, 34.349893573923794, 3.0854471076075227, 48.589779212665874, 31.003010530195603, 19.002566856621012, 39.328752583872024, 45.932609958541605, 30.20752099006248, 7.191706517846265, 31.24262039543183, 13.479974834739101, 24.749320712273388, 25.056868792896505, 27.20317291603739, 28.87098086827795, 34.492272443356875, 21.16654773888157, 26.87865695435439, 11.655074931652669, 38.543544671536296, 36.7536745103112, 17.562118924352973, 21.0592103910512, 9.369958609786648, 5.905224839464581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2901701340798563, "mean_inference_ms": 0.9331581797559562, "mean_action_processing_ms": 0.12593214279060228, "mean_env_wait_ms": 0.06623564264062003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002544403076171875, "StateBufferConnector_ms": 0.0018916130065917969, "ViewRequirementAgentConnector_ms": 0.04415106773376465}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 698.4697435603663, "num_env_steps_trained_throughput_per_sec": 698.4697435603663, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 5894.635, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5894.601, "sample_time_ms": 650.152, "learn_time_ms": 5231.102, "learn_throughput": 764.657, "synch_weights_time_ms": 12.914}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 42, "trial_id": "abfb9_00000", "date": "2024-08-11_11-34-57", "timestamp": 1723390497, "time_this_iter_s": 5.731563091278076, "time_total_s": 242.3894441127777, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.3894441127777, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.325, "ram_util_percent": 82.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9764693364501, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0158069954874616, "policy_loss": -0.003373049857812778, "vf_loss": 1.0191508646433551, "vf_explained_var": 0.9820010229324301, "kl": 0.004668960850869456, "entropy": 0.45379984683046737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.163339407493671, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.029769451978306, "policy_loss": -0.01345025980990613, "vf_loss": 1.0428672558317582, "vf_explained_var": 0.983136824083825, "kl": 0.014098201176873444, "entropy": 0.822157631876568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.23, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 6623, "policy_reward_min": {"prey_policy": -50.15338650992036, "predator_policy": 3.0854471076075227}, "policy_reward_max": {"prey_policy": -3.0854471076075227, "predator_policy": 50.15338650992036}, "policy_reward_mean": {"prey_policy": -24.503892824213985, "predator_policy": 24.503892824213985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [39, 51, 57, 150, 66, 77, 58, 40, 47, 69, 89, 78, 51, 52, 54, 92, 120, 73, 32, 82, 75, 55, 96, 98, 202, 27, 64, 42, 53, 57, 80, 66, 63, 55, 88, 20, 77, 74, 58, 75, 140, 34, 51, 50, 47, 95, 52, 68, 57, 42, 45, 92, 44, 43, 62, 74, 72, 89, 63, 69, 84, 51, 61, 69, 73, 75, 37, 92, 22, 59, 79, 85, 76, 41, 37, 91, 126, 83, 63, 76, 37, 34, 67, 83, 58, 51, 58, 37, 61, 53, 43, 72, 77, 69, 61, 46, 68, 75, 17, 85], "policy_prey_policy_reward": [-8.403775117607125, -18.54594882208413, -23.770192866545457, -44.67369844168066, -33.18541452748555, -32.38641886694052, -19.640766978935098, -12.685491616450472, -3.3994355245746397, -5.932925833808974, -42.512699624176726, -13.299851765282265, -18.524162756880546, -16.188647334740562, -30.29234609474262, -27.201785977760434, -25.43547142972779, -34.349893573923794, -3.0854471076075227, -48.589779212665874, -31.003010530195603, -19.002566856621012, -39.328752583872024, -45.932609958541605, -30.20752099006248, -7.191706517846265, -31.24262039543183, -13.479974834739101, -24.749320712273388, -25.056868792896505, -27.20317291603739, -28.87098086827795, -34.492272443356875, -21.16654773888157, -26.87865695435439, -11.655074931652669, -38.543544671536296, -36.7536745103112, -17.562118924352973, -21.0592103910512, -9.369958609786648, -5.905224839464581, -4.021958632956668, -33.54632852881563, -10.071397443062502, -45.65587318514601, -18.50579076483973, -38.10926818399189, -8.041169083184604, -14.320688297402063, -24.71462799411873, -39.34539150319956, -9.283858859686925, -12.13304176659944, -37.31872103869213, -30.239614602586272, -45.97849297408851, -37.234489941784, -27.65924062684278, -35.2787078086163, -36.2491055034193, -20.964167430439044, -23.766447508860708, -29.960069522369025, -42.0141133102552, -22.537760982928674, -9.472512798921137, -30.549717524671706, -10.05582246121528, -14.772734645792378, -40.79518504055254, -13.614376332665529, -36.15811657714704, -14.031894102057263, -17.878926195377076, -4.752631612102087, -39.00426378461522, -24.638894696399962, -25.85685365674053, -27.128610340550665, -6.8994749575745855, -5.317320580833678, -27.125148104228593, -25.026935625498933, -14.432236016705692, -22.250845237903086, -32.72981776174262, -4.983134744261358, -23.939849201102707, -35.66294312707134, -15.088789348398663, -6.440290087645941, -38.5604207517327, -22.025872532072547, -24.65436787810866, -42.39497226247958, -27.351248399039306, -50.15338650992036, -11.898630524303819, -49.03319006291575], "policy_predator_policy_reward": [8.403775117607125, 18.54594882208413, 23.770192866545457, 44.67369844168066, 33.18541452748555, 32.38641886694052, 19.640766978935098, 12.685491616450472, 3.3994355245746397, 5.932925833808974, 42.512699624176726, 13.299851765282265, 18.524162756880546, 16.188647334740562, 30.29234609474262, 27.201785977760434, 25.43547142972779, 34.349893573923794, 3.0854471076075227, 48.589779212665874, 31.003010530195603, 19.002566856621012, 39.328752583872024, 45.932609958541605, 30.20752099006248, 7.191706517846265, 31.24262039543183, 13.479974834739101, 24.749320712273388, 25.056868792896505, 27.20317291603739, 28.87098086827795, 34.492272443356875, 21.16654773888157, 26.87865695435439, 11.655074931652669, 38.543544671536296, 36.7536745103112, 17.562118924352973, 21.0592103910512, 9.369958609786648, 5.905224839464581, 4.021958632956668, 33.54632852881563, 10.071397443062502, 45.65587318514601, 18.50579076483973, 38.10926818399189, 8.041169083184604, 14.320688297402063, 24.71462799411873, 39.34539150319956, 9.283858859686925, 12.13304176659944, 37.31872103869213, 30.239614602586272, 45.97849297408851, 37.234489941784, 27.65924062684278, 35.2787078086163, 36.2491055034193, 20.964167430439044, 23.766447508860708, 29.960069522369025, 42.0141133102552, 22.537760982928674, 9.472512798921137, 30.549717524671706, 10.05582246121528, 14.772734645792378, 40.79518504055254, 13.614376332665529, 36.15811657714704, 14.031894102057263, 17.878926195377076, 4.752631612102087, 39.00426378461522, 24.638894696399962, 25.85685365674053, 27.128610340550665, 6.8994749575745855, 5.317320580833678, 27.125148104228593, 25.026935625498933, 14.432236016705692, 22.250845237903086, 32.72981776174262, 4.983134744261358, 23.939849201102707, 35.66294312707134, 15.088789348398663, 6.440290087645941, 38.5604207517327, 22.025872532072547, 24.65436787810866, 42.39497226247958, 27.351248399039306, 50.15338650992036, 11.898630524303819, 49.03319006291575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2895122722598334, "mean_inference_ms": 0.9313746419697776, "mean_action_processing_ms": 0.12597659674290784, "mean_env_wait_ms": 0.066104996769123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025702714920043945, "StateBufferConnector_ms": 0.0018720626831054688, "ViewRequirementAgentConnector_ms": 0.04402875900268555}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.8031930022984, "num_env_steps_trained_throughput_per_sec": 687.8031930022984, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 5864.779, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5864.746, "sample_time_ms": 644.914, "learn_time_ms": 5206.906, "learn_throughput": 768.211, "synch_weights_time_ms": 12.535}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 43, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-03", "timestamp": 1723390503, "time_this_iter_s": 5.820420265197754, "time_total_s": 248.20986437797546, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.20986437797546, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 26.662499999999998, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0341775814071297, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1491759888206918, "policy_loss": -0.003170917868555989, "vf_loss": 1.152332230595251, "vf_explained_var": 0.9787304499497016, "kl": 0.004696359412506338, "entropy": 0.41144540611033636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1236244406551124, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1875003117447098, "policy_loss": -0.01235760917988955, "vf_loss": 1.1996178577343624, "vf_explained_var": 0.9762010213608543, "kl": 0.00960265565268317, "entropy": 0.7659181746343772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.78, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6578, "policy_reward_min": {"prey_policy": -50.15338650992036, "predator_policy": 1.2873415512673374}, "policy_reward_max": {"prey_policy": -1.2873415512673374, "predator_policy": 50.15338650992036}, "policy_reward_mean": {"prey_policy": -23.858887802880545, "predator_policy": 23.858887802880545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [75, 37, 92, 22, 59, 79, 85, 76, 41, 37, 91, 126, 83, 63, 76, 37, 34, 67, 83, 58, 51, 58, 37, 61, 53, 43, 72, 77, 69, 61, 46, 68, 75, 17, 85, 105, 62, 37, 52, 141, 66, 79, 180, 119, 36, 57, 47, 79, 46, 80, 88, 80, 86, 81, 55, 126, 35, 39, 44, 40, 33, 93, 42, 22, 59, 76, 62, 86, 125, 39, 83, 34, 41, 22, 59, 7, 86, 69, 69, 133, 73, 50, 82, 78, 97, 33, 58, 3, 45, 59, 72, 42, 71, 127, 85, 78, 77, 70, 53, 31], "policy_prey_policy_reward": [-22.537760982928674, -9.472512798921137, -30.549717524671706, -10.05582246121528, -14.772734645792378, -40.79518504055254, -13.614376332665529, -36.15811657714704, -14.031894102057263, -17.878926195377076, -4.752631612102087, -39.00426378461522, -24.638894696399962, -25.85685365674053, -27.128610340550665, -6.8994749575745855, -5.317320580833678, -27.125148104228593, -25.026935625498933, -14.432236016705692, -22.250845237903086, -32.72981776174262, -4.983134744261358, -23.939849201102707, -35.66294312707134, -15.088789348398663, -6.440290087645941, -38.5604207517327, -22.025872532072547, -24.65436787810866, -42.39497226247958, -27.351248399039306, -50.15338650992036, -11.898630524303819, -49.03319006291575, -8.242867925328127, -37.36892746793125, -18.867261622938834, -35.57628349424145, -13.629222629296969, -25.13433697544968, -39.16494008684449, -39.607935804754014, -22.588630078522513, -22.66129118521929, -22.222878700767986, -18.706798920591464, -33.40864419960517, -34.835503399701906, -15.968814981525199, -27.863152033859294, -31.32160788568676, -46.425999299416624, -36.51711251431414, -23.135495519495052, -28.953381918685885, -16.75767119886502, -19.423015709979015, -16.54193445737303, -11.997633121525196, -12.848251263826716, -22.95248824940329, -21.92410388136743, -1.9717676453077901, -31.510117374110933, -33.86822952142533, -37.9766393093601, -42.66759468093755, -30.630633672976394, -17.608290677182428, -17.170794160642448, -13.894761020890448, -19.046828663827267, -13.39316719734044, -14.670604319479153, -1.8653059048535772, -27.256770829854993, -28.061310074074186, -25.189703160597038, -21.353191631841582, -32.442586220273746, -33.16911012399683, -41.16683675199982, -15.508247088359091, -31.255304829148873, -16.067156434608734, -32.95604692057555, -1.2873415512673374, -31.232797938488165, -16.323880759306224, -39.24858943630721, -5.240662974278806, -43.17541782342449, -17.272875461032342, -10.134068281886778, -46.05062899259476, -14.290608688723244, -35.16863164045747, -14.379039047703184, -9.519880487127125], "policy_predator_policy_reward": [22.537760982928674, 9.472512798921137, 30.549717524671706, 10.05582246121528, 14.772734645792378, 40.79518504055254, 13.614376332665529, 36.15811657714704, 14.031894102057263, 17.878926195377076, 4.752631612102087, 39.00426378461522, 24.638894696399962, 25.85685365674053, 27.128610340550665, 6.8994749575745855, 5.317320580833678, 27.125148104228593, 25.026935625498933, 14.432236016705692, 22.250845237903086, 32.72981776174262, 4.983134744261358, 23.939849201102707, 35.66294312707134, 15.088789348398663, 6.440290087645941, 38.5604207517327, 22.025872532072547, 24.65436787810866, 42.39497226247958, 27.351248399039306, 50.15338650992036, 11.898630524303819, 49.03319006291575, 8.242867925328127, 37.36892746793125, 18.867261622938834, 35.57628349424145, 13.629222629296969, 25.13433697544968, 39.16494008684449, 39.607935804754014, 22.588630078522513, 22.66129118521929, 22.222878700767986, 18.706798920591464, 33.40864419960517, 34.835503399701906, 15.968814981525199, 27.863152033859294, 31.32160788568676, 46.425999299416624, 36.51711251431414, 23.135495519495052, 28.953381918685885, 16.75767119886502, 19.423015709979015, 16.54193445737303, 11.997633121525196, 12.848251263826716, 22.95248824940329, 21.92410388136743, 1.9717676453077901, 31.510117374110933, 33.86822952142533, 37.9766393093601, 42.66759468093755, 30.630633672976394, 17.608290677182428, 17.170794160642448, 13.894761020890448, 19.046828663827267, 13.39316719734044, 14.670604319479153, 1.8653059048535772, 27.256770829854993, 28.061310074074186, 25.189703160597038, 21.353191631841582, 32.442586220273746, 33.16911012399683, 41.16683675199982, 15.508247088359091, 31.255304829148873, 16.067156434608734, 32.95604692057555, 1.2873415512673374, 31.232797938488165, 16.323880759306224, 39.24858943630721, 5.240662974278806, 43.17541782342449, 17.272875461032342, 10.134068281886778, 46.05062899259476, 14.290608688723244, 35.16863164045747, 14.379039047703184, 9.519880487127125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28915684319490514, "mean_inference_ms": 0.9281414044915707, "mean_action_processing_ms": 0.12549678009875073, "mean_env_wait_ms": 0.06587447665790991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027120113372802734, "StateBufferConnector_ms": 0.0019838809967041016, "ViewRequirementAgentConnector_ms": 0.044237732887268066}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 695.9958249914749, "num_env_steps_trained_throughput_per_sec": 695.9958249914749, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 5854.052, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5854.018, "sample_time_ms": 645.245, "learn_time_ms": 5195.738, "learn_throughput": 769.862, "synch_weights_time_ms": 12.648}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 44, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-09", "timestamp": 1723390509, "time_this_iter_s": 5.752823114395142, "time_total_s": 253.9626874923706, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b1040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.9626874923706, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.775, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4831340237210195, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3182706558456023, "policy_loss": -0.004032958836614853, "vf_loss": 1.322293247282505, "vf_explained_var": 0.9785136594126622, "kl": 0.006627717871693473, "entropy": 0.47476166461904845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.564890026176969, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3895470858862002, "policy_loss": -0.00560231788646585, "vf_loss": 1.3948854834462205, "vf_explained_var": 0.9773467644428213, "kl": 0.01055680914040754, "entropy": 0.7824001874774694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.05, "episode_media": {}, "episodes_this_iter": 57, "episodes_timesteps_total": 6405, "policy_reward_min": {"prey_policy": -56.773141183985395, "predator_policy": 1.2873415512673374}, "policy_reward_max": {"prey_policy": -1.2873415512673374, "predator_policy": 56.773141183985395}, "policy_reward_mean": {"prey_policy": -23.79241742174762, "predator_policy": 23.79241742174762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [39, 44, 40, 33, 93, 42, 22, 59, 76, 62, 86, 125, 39, 83, 34, 41, 22, 59, 7, 86, 69, 69, 133, 73, 50, 82, 78, 97, 33, 58, 3, 45, 59, 72, 42, 71, 127, 85, 78, 77, 70, 53, 31, 82, 84, 37, 89, 59, 58, 33, 81, 87, 84, 52, 111, 68, 28, 24, 109, 84, 49, 58, 64, 83, 47, 51, 53, 55, 50, 86, 58, 88, 80, 29, 43, 66, 81, 73, 138, 41, 66, 56, 55, 56, 121, 82, 47, 92, 55, 105, 94, 66, 54, 77, 73, 65, 65, 6, 8, 52], "policy_prey_policy_reward": [-19.423015709979015, -16.54193445737303, -11.997633121525196, -12.848251263826716, -22.95248824940329, -21.92410388136743, -1.9717676453077901, -31.510117374110933, -33.86822952142533, -37.9766393093601, -42.66759468093755, -30.630633672976394, -17.608290677182428, -17.170794160642448, -13.894761020890448, -19.046828663827267, -13.39316719734044, -14.670604319479153, -1.8653059048535772, -27.256770829854993, -28.061310074074186, -25.189703160597038, -21.353191631841582, -32.442586220273746, -33.16911012399683, -41.16683675199982, -15.508247088359091, -31.255304829148873, -16.067156434608734, -32.95604692057555, -1.2873415512673374, -31.232797938488165, -16.323880759306224, -39.24858943630721, -5.240662974278806, -43.17541782342449, -17.272875461032342, -10.134068281886778, -46.05062899259476, -14.290608688723244, -35.16863164045747, -14.379039047703184, -9.519880487127125, -46.598085759506226, -29.439350920941, -19.5068736956214, -44.12415639047509, -24.33347971111765, -5.989899502968765, -18.270568662712503, -29.05975988621525, -49.711068553810506, -49.63929625578121, -36.25678316197057, -7.2532670913152115, -28.22930764708703, -16.50983999321416, -6.1849240352439505, -13.729475083303397, -14.882233689585174, -26.8845654065313, -29.01176047868182, -40.81410824021837, -21.042479625599807, -15.449780403446692, -13.667417639898725, -13.654004177348549, -24.79384252961824, -23.23413610571359, -40.33769607274495, -4.601802433603134, -23.270888858474382, -56.773141183985395, -3.736206302838012, -15.067636721034633, -22.517517583287237, -44.503448553390584, -21.906956103115434, -36.50880631155579, -5.309604001975629, -21.43634920650064, -22.014273937072364, -38.558445947854, -15.823557003481053, -5.927965237591925, -35.264619681852565, -20.31322408912732, -43.38306086531813, -36.371976782965284, -43.59109922738376, -38.28587224557472, -21.63954716546703, -14.676687932489235, -13.319933967536892, -31.813299841932153, -28.72790917199518, -17.532648832487407, -2.1456972808425805, -4.313821786057146, -31.584735217564347], "policy_predator_policy_reward": [19.423015709979015, 16.54193445737303, 11.997633121525196, 12.848251263826716, 22.95248824940329, 21.92410388136743, 1.9717676453077901, 31.510117374110933, 33.86822952142533, 37.9766393093601, 42.66759468093755, 30.630633672976394, 17.608290677182428, 17.170794160642448, 13.894761020890448, 19.046828663827267, 13.39316719734044, 14.670604319479153, 1.8653059048535772, 27.256770829854993, 28.061310074074186, 25.189703160597038, 21.353191631841582, 32.442586220273746, 33.16911012399683, 41.16683675199982, 15.508247088359091, 31.255304829148873, 16.067156434608734, 32.95604692057555, 1.2873415512673374, 31.232797938488165, 16.323880759306224, 39.24858943630721, 5.240662974278806, 43.17541782342449, 17.272875461032342, 10.134068281886778, 46.05062899259476, 14.290608688723244, 35.16863164045747, 14.379039047703184, 9.519880487127125, 46.598085759506226, 29.439350920941, 19.5068736956214, 44.12415639047509, 24.33347971111765, 5.989899502968765, 18.270568662712503, 29.05975988621525, 49.711068553810506, 49.63929625578121, 36.25678316197057, 7.2532670913152115, 28.22930764708703, 16.50983999321416, 6.1849240352439505, 13.729475083303397, 14.882233689585174, 26.8845654065313, 29.01176047868182, 40.81410824021837, 21.042479625599807, 15.449780403446692, 13.667417639898725, 13.654004177348549, 24.79384252961824, 23.23413610571359, 40.33769607274495, 4.601802433603134, 23.270888858474382, 56.773141183985395, 3.736206302838012, 15.067636721034633, 22.517517583287237, 44.503448553390584, 21.906956103115434, 36.50880631155579, 5.309604001975629, 21.43634920650064, 22.014273937072364, 38.558445947854, 15.823557003481053, 5.927965237591925, 35.264619681852565, 20.31322408912732, 43.38306086531813, 36.371976782965284, 43.59109922738376, 38.28587224557472, 21.63954716546703, 14.676687932489235, 13.319933967536892, 31.813299841932153, 28.72790917199518, 17.532648832487407, 2.1456972808425805, 4.313821786057146, 31.584735217564347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28935838149631843, "mean_inference_ms": 0.9287602695049071, "mean_action_processing_ms": 0.12544173236212824, "mean_env_wait_ms": 0.0659977906176335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002817988395690918, "StateBufferConnector_ms": 0.0022313594818115234, "ViewRequirementAgentConnector_ms": 0.047007083892822266}, "num_episodes": 57, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 684.0619013210294, "num_env_steps_trained_throughput_per_sec": 684.0619013210294, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 5852.184, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5852.151, "sample_time_ms": 648.99, "learn_time_ms": 5189.977, "learn_throughput": 770.716, "synch_weights_time_ms": 12.789}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 45, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-15", "timestamp": 1723390515, "time_this_iter_s": 5.853657007217407, "time_total_s": 259.816344499588, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.816344499588, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 26.48888888888889, "ram_util_percent": 82.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.836962893232703, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9801494926990321, "policy_loss": -0.004479959852081568, "vf_loss": 0.9846234682016075, "vf_explained_var": 0.9855095811809103, "kl": 0.003829043230121399, "entropy": 0.43177220517148573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.995192087069154, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9677398724171022, "policy_loss": -0.008725630507494012, "vf_loss": 0.9762534206733108, "vf_explained_var": 0.985901554984351, "kl": 0.008483333133421188, "entropy": 0.7431206252425909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 70.02, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 7002, "policy_reward_min": {"prey_policy": -56.773141183985395, "predator_policy": 1.1843217988052936}, "policy_reward_max": {"prey_policy": -1.1843217988052936, "predator_policy": 56.773141183985395}, "policy_reward_mean": {"prey_policy": -24.57064310038683, "predator_policy": 24.57064310038683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [109, 84, 49, 58, 64, 83, 47, 51, 53, 55, 50, 86, 58, 88, 80, 29, 43, 66, 81, 73, 138, 41, 66, 56, 55, 56, 121, 82, 47, 92, 55, 105, 94, 66, 54, 77, 73, 65, 65, 6, 8, 52, 147, 69, 138, 118, 62, 77, 124, 44, 89, 72, 67, 75, 66, 67, 25, 144, 58, 72, 74, 49, 116, 54, 119, 64, 65, 74, 82, 166, 47, 70, 61, 70, 116, 56, 47, 112, 40, 88, 95, 1, 34, 34, 90, 59, 101, 70, 41, 82, 26, 27, 93, 76, 7, 42, 69, 13, 135, 42], "policy_prey_policy_reward": [-13.729475083303397, -14.882233689585174, -26.8845654065313, -29.01176047868182, -40.81410824021837, -21.042479625599807, -15.449780403446692, -13.667417639898725, -13.654004177348549, -24.79384252961824, -23.23413610571359, -40.33769607274495, -4.601802433603134, -23.270888858474382, -56.773141183985395, -3.736206302838012, -15.067636721034633, -22.517517583287237, -44.503448553390584, -21.906956103115434, -36.50880631155579, -5.309604001975629, -21.43634920650064, -22.014273937072364, -38.558445947854, -15.823557003481053, -5.927965237591925, -35.264619681852565, -20.31322408912732, -43.38306086531813, -36.371976782965284, -43.59109922738376, -38.28587224557472, -21.63954716546703, -14.676687932489235, -13.319933967536892, -31.813299841932153, -28.72790917199518, -17.532648832487407, -2.1456972808425805, -4.313821786057146, -31.584735217564347, -16.04526931786726, -26.916537794704393, -23.92993609804916, -18.925993888011952, -21.999768183811813, -39.797738985891385, -23.926059395402522, -19.13766698738488, -46.95352843045277, -28.907038195515153, -39.47428073525276, -32.45306694894274, -42.051361707311386, -4.137086510632743, -1.1843217988052936, -47.95123253268815, -40.298621430564005, -44.514944490444016, -19.808113579390273, -20.4583074456065, -28.17706009642947, -13.091452967285802, -34.887794591874126, -35.033974189972156, -25.430350911438218, -40.092609121398255, -35.112590408707256, -36.50280283029626, -26.62094849234943, -7.9846857691466075, -38.25592564809457, -26.06313795973501, -23.898154787990546, -19.000123367616844, -23.000997584504223, -26.601240841601665, -18.172213294380896, -43.172833459620406, -40.27612566194537, -1.4152957282171652, -9.045291143227674, -7.534446071643151, -24.655042938193535, -4.714162152469848, -7.02036110486247, -24.560427845259756, -19.260727426295094, -32.38053745106503, -4.218454066103668, -16.180293297728177, -51.47897874948693, -40.601039761341724, -1.9241265060263288, -9.573417374259417, -38.45619626606506, -5.695122984166208, -36.88325269232973, -22.799007111781613], "policy_predator_policy_reward": [13.729475083303397, 14.882233689585174, 26.8845654065313, 29.01176047868182, 40.81410824021837, 21.042479625599807, 15.449780403446692, 13.667417639898725, 13.654004177348549, 24.79384252961824, 23.23413610571359, 40.33769607274495, 4.601802433603134, 23.270888858474382, 56.773141183985395, 3.736206302838012, 15.067636721034633, 22.517517583287237, 44.503448553390584, 21.906956103115434, 36.50880631155579, 5.309604001975629, 21.43634920650064, 22.014273937072364, 38.558445947854, 15.823557003481053, 5.927965237591925, 35.264619681852565, 20.31322408912732, 43.38306086531813, 36.371976782965284, 43.59109922738376, 38.28587224557472, 21.63954716546703, 14.676687932489235, 13.319933967536892, 31.813299841932153, 28.72790917199518, 17.532648832487407, 2.1456972808425805, 4.313821786057146, 31.584735217564347, 16.04526931786726, 26.916537794704393, 23.92993609804916, 18.925993888011952, 21.999768183811813, 39.797738985891385, 23.926059395402522, 19.13766698738488, 46.95352843045277, 28.907038195515153, 39.47428073525276, 32.45306694894274, 42.051361707311386, 4.137086510632743, 1.1843217988052936, 47.95123253268815, 40.298621430564005, 44.514944490444016, 19.808113579390273, 20.4583074456065, 28.17706009642947, 13.091452967285802, 34.887794591874126, 35.033974189972156, 25.430350911438218, 40.092609121398255, 35.112590408707256, 36.50280283029626, 26.62094849234943, 7.9846857691466075, 38.25592564809457, 26.06313795973501, 23.898154787990546, 19.000123367616844, 23.000997584504223, 26.601240841601665, 18.172213294380896, 43.172833459620406, 40.27612566194537, 1.4152957282171652, 9.045291143227674, 7.534446071643151, 24.655042938193535, 4.714162152469848, 7.02036110486247, 24.560427845259756, 19.260727426295094, 32.38053745106503, 4.218454066103668, 16.180293297728177, 51.47897874948693, 40.601039761341724, 1.9241265060263288, 9.573417374259417, 38.45619626606506, 5.695122984166208, 36.88325269232973, 22.799007111781613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2897181033558289, "mean_inference_ms": 0.9286481680316622, "mean_action_processing_ms": 0.12575187957006612, "mean_env_wait_ms": 0.06610734894103716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002835988998413086, "StateBufferConnector_ms": 0.0021691322326660156, "ViewRequirementAgentConnector_ms": 0.04724693298339844}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 694.6088456927084, "num_env_steps_trained_throughput_per_sec": 694.6088456927084, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 5860.847, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5860.813, "sample_time_ms": 650.822, "learn_time_ms": 5196.544, "learn_throughput": 769.742, "synch_weights_time_ms": 13.05}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 46, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-20", "timestamp": 1723390520, "time_this_iter_s": 5.763615846633911, "time_total_s": 265.5799603462219, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.5799603462219, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.8125, "ram_util_percent": 82.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8847738979384303, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1445799577360352, "policy_loss": -0.001160142506705597, "vf_loss": 1.1457353182137013, "vf_explained_var": 0.9818855322276553, "kl": 0.0061177662123035525, "entropy": 0.4709579091519117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0536285884678365, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.184952788737913, "policy_loss": -0.011100987653480842, "vf_loss": 1.1957287355015676, "vf_explained_var": 0.9811914940054218, "kl": 0.013001647377933167, "entropy": 0.727799244162937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 72.12, "episode_media": {}, "episodes_this_iter": 52, "episodes_timesteps_total": 7212, "policy_reward_min": {"prey_policy": -51.47897874948693, "predator_policy": 1.1843217988052936}, "policy_reward_max": {"prey_policy": -1.1843217988052936, "predator_policy": 51.47897874948693}, "policy_reward_mean": {"prey_policy": -26.352466125881435, "predator_policy": 26.352466125881435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [67, 75, 66, 67, 25, 144, 58, 72, 74, 49, 116, 54, 119, 64, 65, 74, 82, 166, 47, 70, 61, 70, 116, 56, 47, 112, 40, 88, 95, 1, 34, 34, 90, 59, 101, 70, 41, 82, 26, 27, 93, 76, 7, 42, 69, 13, 135, 42, 72, 126, 64, 118, 47, 87, 106, 66, 48, 42, 80, 80, 81, 60, 31, 95, 54, 113, 44, 107, 63, 120, 87, 85, 77, 144, 36, 89, 75, 131, 50, 86, 116, 57, 64, 65, 55, 47, 51, 70, 93, 101, 56, 80, 58, 90, 46, 84, 47, 51, 55, 81], "policy_prey_policy_reward": [-39.47428073525276, -32.45306694894274, -42.051361707311386, -4.137086510632743, -1.1843217988052936, -47.95123253268815, -40.298621430564005, -44.514944490444016, -19.808113579390273, -20.4583074456065, -28.17706009642947, -13.091452967285802, -34.887794591874126, -35.033974189972156, -25.430350911438218, -40.092609121398255, -35.112590408707256, -36.50280283029626, -26.62094849234943, -7.9846857691466075, -38.25592564809457, -26.06313795973501, -23.898154787990546, -19.000123367616844, -23.000997584504223, -26.601240841601665, -18.172213294380896, -43.172833459620406, -40.27612566194537, -1.4152957282171652, -9.045291143227674, -7.534446071643151, -24.655042938193535, -4.714162152469848, -7.02036110486247, -24.560427845259756, -19.260727426295094, -32.38053745106503, -4.218454066103668, -16.180293297728177, -51.47897874948693, -40.601039761341724, -1.9241265060263288, -9.573417374259417, -38.45619626606506, -5.695122984166208, -36.88325269232973, -22.799007111781613, -10.995644029249304, -22.734732854457352, -46.793993651654, -16.029038562605454, -10.274631089840952, -47.56720789023563, -20.756213236495476, -32.976317524850664, -35.082159141214, -9.116460043684377, -43.12851373310164, -41.26284120291167, -48.27875666556816, -23.328219353466665, -14.824163293814419, -16.236323196905385, -20.77529424019465, -21.37752223987172, -33.794880963655125, -38.999442230269345, -19.702821310418187, -31.488532154113976, -44.38915749152685, -39.71512065938775, -37.26220643099794, -51.245365583468335, -19.37427696084075, -42.572993582174206, -40.90766094328937, -19.989446819108426, -22.977914658845453, -24.16141323699949, -29.445901415530688, -17.18868928601563, -32.01846071612158, -14.123063033773441, -26.283198572685293, -10.239948652241026, -6.351186370232653, -17.810796902328807, -25.5643805929195, -48.72639012159813, -23.486358857944868, -37.31726344367275, -35.40728872595185, -6.933156050104774, -14.824910951628802, -39.72640518174467, -22.863106090517203, -23.11472213856869, -35.12910184063265, -28.47047883416603], "policy_predator_policy_reward": [39.47428073525276, 32.45306694894274, 42.051361707311386, 4.137086510632743, 1.1843217988052936, 47.95123253268815, 40.298621430564005, 44.514944490444016, 19.808113579390273, 20.4583074456065, 28.17706009642947, 13.091452967285802, 34.887794591874126, 35.033974189972156, 25.430350911438218, 40.092609121398255, 35.112590408707256, 36.50280283029626, 26.62094849234943, 7.9846857691466075, 38.25592564809457, 26.06313795973501, 23.898154787990546, 19.000123367616844, 23.000997584504223, 26.601240841601665, 18.172213294380896, 43.172833459620406, 40.27612566194537, 1.4152957282171652, 9.045291143227674, 7.534446071643151, 24.655042938193535, 4.714162152469848, 7.02036110486247, 24.560427845259756, 19.260727426295094, 32.38053745106503, 4.218454066103668, 16.180293297728177, 51.47897874948693, 40.601039761341724, 1.9241265060263288, 9.573417374259417, 38.45619626606506, 5.695122984166208, 36.88325269232973, 22.799007111781613, 10.995644029249304, 22.734732854457352, 46.793993651654, 16.029038562605454, 10.274631089840952, 47.56720789023563, 20.756213236495476, 32.976317524850664, 35.082159141214, 9.116460043684377, 43.12851373310164, 41.26284120291167, 48.27875666556816, 23.328219353466665, 14.824163293814419, 16.236323196905385, 20.77529424019465, 21.37752223987172, 33.794880963655125, 38.999442230269345, 19.702821310418187, 31.488532154113976, 44.38915749152685, 39.71512065938775, 37.26220643099794, 51.245365583468335, 19.37427696084075, 42.572993582174206, 40.90766094328937, 19.989446819108426, 22.977914658845453, 24.16141323699949, 29.445901415530688, 17.18868928601563, 32.01846071612158, 14.123063033773441, 26.283198572685293, 10.239948652241026, 6.351186370232653, 17.810796902328807, 25.5643805929195, 48.72639012159813, 23.486358857944868, 37.31726344367275, 35.40728872595185, 6.933156050104774, 14.824910951628802, 39.72640518174467, 22.863106090517203, 23.11472213856869, 35.12910184063265, 28.47047883416603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2896104710510894, "mean_inference_ms": 0.9276325610251882, "mean_action_processing_ms": 0.12564243611811485, "mean_env_wait_ms": 0.06611647724964326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027892589569091797, "StateBufferConnector_ms": 0.0020422935485839844, "ViewRequirementAgentConnector_ms": 0.04696774482727051}, "num_episodes": 52, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 703.2552540166186, "num_env_steps_trained_throughput_per_sec": 703.2552540166186, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 5822.595, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5822.557, "sample_time_ms": 647.026, "learn_time_ms": 5161.948, "learn_throughput": 774.901, "synch_weights_time_ms": 13.127}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 47, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-26", "timestamp": 1723390526, "time_this_iter_s": 5.692800998687744, "time_total_s": 271.27276134490967, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 271.27276134490967, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.075, "ram_util_percent": 82.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2218239532783626, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2994567083350073, "policy_loss": -0.003039970507476634, "vf_loss": 1.3024900008613864, "vf_explained_var": 0.9720059815173347, "kl": 0.008547825087785156, "entropy": 0.4612996815703809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.494110846146941, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3672195095568895, "policy_loss": -0.004962392263890555, "vf_loss": 1.3720553276439509, "vf_explained_var": 0.9709435742348432, "kl": 0.005062943088519173, "entropy": 0.7203437207266689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 71.21, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 7121, "policy_reward_min": {"prey_policy": -51.28827178958197, "predator_policy": 4.740035325225714}, "policy_reward_max": {"prey_policy": -4.740035325225714, "predator_policy": 51.28827178958197}, "policy_reward_mean": {"prey_policy": -26.77869258393489, "predator_policy": 26.77869258393489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [80, 81, 60, 31, 95, 54, 113, 44, 107, 63, 120, 87, 85, 77, 144, 36, 89, 75, 131, 50, 86, 116, 57, 64, 65, 55, 47, 51, 70, 93, 101, 56, 80, 58, 90, 46, 84, 47, 51, 55, 81, 58, 26, 71, 51, 52, 96, 80, 69, 73, 72, 76, 82, 44, 37, 33, 162, 57, 32, 81, 64, 64, 96, 86, 98, 55, 68, 16, 88, 86, 48, 97, 95, 128, 70, 61, 57, 30, 72, 75, 49, 54, 87, 48, 83, 70, 88, 34, 89, 87, 59, 78, 49, 67, 67, 38, 88, 85, 62, 58], "policy_prey_policy_reward": [-41.26284120291167, -48.27875666556816, -23.328219353466665, -14.824163293814419, -16.236323196905385, -20.77529424019465, -21.37752223987172, -33.794880963655125, -38.999442230269345, -19.702821310418187, -31.488532154113976, -44.38915749152685, -39.71512065938775, -37.26220643099794, -51.245365583468335, -19.37427696084075, -42.572993582174206, -40.90766094328937, -19.989446819108426, -22.977914658845453, -24.16141323699949, -29.445901415530688, -17.18868928601563, -32.01846071612158, -14.123063033773441, -26.283198572685293, -10.239948652241026, -6.351186370232653, -17.810796902328807, -25.5643805929195, -48.72639012159813, -23.486358857944868, -37.31726344367275, -35.40728872595185, -6.933156050104774, -14.824910951628802, -39.72640518174467, -22.863106090517203, -23.11472213856869, -35.12910184063265, -28.47047883416603, -43.575595883649726, -8.048899950875004, -15.202915705002571, -18.35710345762703, -14.374574726401484, -31.401915379501148, -14.374513020487978, -18.003659569734474, -25.764563662703257, -33.52549704357716, -7.102904823081837, -44.74551961339402, -15.086721203748109, -20.377567879638818, -21.228788908215428, -25.364914974426966, -11.253178770338828, -13.183613875559793, -37.18097336618562, -32.10383271149144, -16.74556142874535, -40.98275417916281, -35.295443763251406, -27.70399065516475, -34.86705364718898, -46.08319702590865, -4.740035325225714, -28.395266944985494, -19.37222241235734, -18.608589692405108, -40.08053004583709, -27.498469894777564, -32.88909373412127, -29.674343984938943, -13.281493072896215, -30.696792966022407, -12.482887810381756, -20.464188023781233, -16.501238979067363, -19.824249259430193, -21.733666794339612, -28.21100894709617, -28.18175421503341, -22.088604840237323, -49.49010159988537, -51.28827178958197, -7.60730244040149, -25.864188091844795, -44.341363226504356, -40.333180969291604, -45.24992740574261, -38.77630344722793, -29.802203358170026, -27.596726150565516, -4.859909555414325, -44.1179076374029, -20.121830824930733, -17.030288527827352, -17.040900204493845], "policy_predator_policy_reward": [41.26284120291167, 48.27875666556816, 23.328219353466665, 14.824163293814419, 16.236323196905385, 20.77529424019465, 21.37752223987172, 33.794880963655125, 38.999442230269345, 19.702821310418187, 31.488532154113976, 44.38915749152685, 39.71512065938775, 37.26220643099794, 51.245365583468335, 19.37427696084075, 42.572993582174206, 40.90766094328937, 19.989446819108426, 22.977914658845453, 24.16141323699949, 29.445901415530688, 17.18868928601563, 32.01846071612158, 14.123063033773441, 26.283198572685293, 10.239948652241026, 6.351186370232653, 17.810796902328807, 25.5643805929195, 48.72639012159813, 23.486358857944868, 37.31726344367275, 35.40728872595185, 6.933156050104774, 14.824910951628802, 39.72640518174467, 22.863106090517203, 23.11472213856869, 35.12910184063265, 28.47047883416603, 43.575595883649726, 8.048899950875004, 15.202915705002571, 18.35710345762703, 14.374574726401484, 31.401915379501148, 14.374513020487978, 18.003659569734474, 25.764563662703257, 33.52549704357716, 7.102904823081837, 44.74551961339402, 15.086721203748109, 20.377567879638818, 21.228788908215428, 25.364914974426966, 11.253178770338828, 13.183613875559793, 37.18097336618562, 32.10383271149144, 16.74556142874535, 40.98275417916281, 35.295443763251406, 27.70399065516475, 34.86705364718898, 46.08319702590865, 4.740035325225714, 28.395266944985494, 19.37222241235734, 18.608589692405108, 40.08053004583709, 27.498469894777564, 32.88909373412127, 29.674343984938943, 13.281493072896215, 30.696792966022407, 12.482887810381756, 20.464188023781233, 16.501238979067363, 19.824249259430193, 21.733666794339612, 28.21100894709617, 28.18175421503341, 22.088604840237323, 49.49010159988537, 51.28827178958197, 7.60730244040149, 25.864188091844795, 44.341363226504356, 40.333180969291604, 45.24992740574261, 38.77630344722793, 29.802203358170026, 27.596726150565516, 4.859909555414325, 44.1179076374029, 20.121830824930733, 17.030288527827352, 17.040900204493845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29057827686257554, "mean_inference_ms": 0.9323364000418175, "mean_action_processing_ms": 0.1259988018077985, "mean_env_wait_ms": 0.06652375309230055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003029465675354004, "StateBufferConnector_ms": 0.003176450729370117, "ViewRequirementAgentConnector_ms": 0.06344437599182129}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 646.089299967771, "num_env_steps_trained_throughput_per_sec": 646.089299967771, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 5841.648, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5841.609, "sample_time_ms": 673.428, "learn_time_ms": 5154.617, "learn_throughput": 776.003, "synch_weights_time_ms": 13.146}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 48, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-32", "timestamp": 1723390532, "time_this_iter_s": 6.196320056915283, "time_total_s": 277.46908140182495, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001d670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.46908140182495, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.555555555555557, "ram_util_percent": 82.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.110947510538002, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.422213518526405, "policy_loss": -0.0031361359089108493, "vf_loss": 1.4253461929038167, "vf_explained_var": 0.9620678204422196, "kl": 0.004431805844479005, "entropy": 0.4280414404347539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2278593707829715, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4490808001408975, "policy_loss": -0.008375834563048556, "vf_loss": 1.457234137132764, "vf_explained_var": 0.9600883760179083, "kl": 0.008900127376309396, "entropy": 0.6503596812486648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.44, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6444, "policy_reward_min": {"prey_policy": -51.28827178958197, "predator_policy": 2.377825912008034}, "policy_reward_max": {"prey_policy": -2.377825912008034, "predator_policy": 51.28827178958197}, "policy_reward_mean": {"prey_policy": -24.759576701646324, "predator_policy": 24.759576701646324}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [55, 68, 16, 88, 86, 48, 97, 95, 128, 70, 61, 57, 30, 72, 75, 49, 54, 87, 48, 83, 70, 88, 34, 89, 87, 59, 78, 49, 67, 67, 38, 88, 85, 62, 58, 76, 53, 9, 71, 42, 20, 35, 66, 72, 32, 82, 17, 51, 45, 48, 65, 65, 72, 60, 72, 37, 20, 50, 67, 84, 75, 75, 37, 77, 80, 108, 158, 75, 59, 91, 52, 49, 31, 84, 43, 96, 88, 68, 18, 85, 56, 78, 71, 67, 75, 83, 82, 46, 38, 60, 68, 79, 50, 48, 58, 54, 38, 139, 49, 59], "policy_prey_policy_reward": [-34.86705364718898, -46.08319702590865, -4.740035325225714, -28.395266944985494, -19.37222241235734, -18.608589692405108, -40.08053004583709, -27.498469894777564, -32.88909373412127, -29.674343984938943, -13.281493072896215, -30.696792966022407, -12.482887810381756, -20.464188023781233, -16.501238979067363, -19.824249259430193, -21.733666794339612, -28.21100894709617, -28.18175421503341, -22.088604840237323, -49.49010159988537, -51.28827178958197, -7.60730244040149, -25.864188091844795, -44.341363226504356, -40.333180969291604, -45.24992740574261, -38.77630344722793, -29.802203358170026, -27.596726150565516, -4.859909555414325, -44.1179076374029, -20.121830824930733, -17.030288527827352, -17.040900204493845, -26.206975161109547, -21.319680162916555, -7.060677174487884, -42.95729216514746, -13.832901815606407, -10.988383247169775, -3.35520349365805, -3.9522997498251398, -47.311721787697294, -7.423939896927208, -41.248857254048914, -6.383467334443807, -2.377825912008034, -23.453561869632946, -31.42805209280668, -16.61367238925349, -16.831005869030076, -29.84048203437403, -36.38488227361565, -38.312531724358706, -24.346913879919985, -14.227991958654805, -17.903239018804697, -28.030829022666783, -15.254566469153936, -44.46002449059034, -29.646817437599616, -20.435732169837276, -38.47259569673821, -47.89935963639207, -22.885476161152795, -34.06270000175719, -30.946151703792356, -18.702706662396928, -22.3279702611206, -30.57228824817801, -18.82798126300694, -18.608353312155394, -10.279813821714063, -12.621789277926045, -24.430135690420077, -13.35956685423951, -15.672228719590995, -8.69602298799004, -16.425816129411142, -32.116795134451266, -46.55045070041054, -20.494017262670084, -20.19810307017869, -23.01602479534929, -43.23160377365883, -24.8648557817425, -20.76755340547433, -12.60279691028912, -38.457104389669645, -16.616292936437823, -25.941285487365658, -10.928506928708677, -31.526138215845574, -12.134842311178033, -16.084485423084026, -18.513784058564827, -35.02866798572607, -28.403834931732852, -32.9049495334509], "policy_predator_policy_reward": [34.86705364718898, 46.08319702590865, 4.740035325225714, 28.395266944985494, 19.37222241235734, 18.608589692405108, 40.08053004583709, 27.498469894777564, 32.88909373412127, 29.674343984938943, 13.281493072896215, 30.696792966022407, 12.482887810381756, 20.464188023781233, 16.501238979067363, 19.824249259430193, 21.733666794339612, 28.21100894709617, 28.18175421503341, 22.088604840237323, 49.49010159988537, 51.28827178958197, 7.60730244040149, 25.864188091844795, 44.341363226504356, 40.333180969291604, 45.24992740574261, 38.77630344722793, 29.802203358170026, 27.596726150565516, 4.859909555414325, 44.1179076374029, 20.121830824930733, 17.030288527827352, 17.040900204493845, 26.206975161109547, 21.319680162916555, 7.060677174487884, 42.95729216514746, 13.832901815606407, 10.988383247169775, 3.35520349365805, 3.9522997498251398, 47.311721787697294, 7.423939896927208, 41.248857254048914, 6.383467334443807, 2.377825912008034, 23.453561869632946, 31.42805209280668, 16.61367238925349, 16.831005869030076, 29.84048203437403, 36.38488227361565, 38.312531724358706, 24.346913879919985, 14.227991958654805, 17.903239018804697, 28.030829022666783, 15.254566469153936, 44.46002449059034, 29.646817437599616, 20.435732169837276, 38.47259569673821, 47.89935963639207, 22.885476161152795, 34.06270000175719, 30.946151703792356, 18.702706662396928, 22.3279702611206, 30.57228824817801, 18.82798126300694, 18.608353312155394, 10.279813821714063, 12.621789277926045, 24.430135690420077, 13.35956685423951, 15.672228719590995, 8.69602298799004, 16.425816129411142, 32.116795134451266, 46.55045070041054, 20.494017262670084, 20.19810307017869, 23.01602479534929, 43.23160377365883, 24.8648557817425, 20.76755340547433, 12.60279691028912, 38.457104389669645, 16.616292936437823, 25.941285487365658, 10.928506928708677, 31.526138215845574, 12.134842311178033, 16.084485423084026, 18.513784058564827, 35.02866798572607, 28.403834931732852, 32.9049495334509]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29186361494835833, "mean_inference_ms": 0.9356000564041254, "mean_action_processing_ms": 0.12611634266823418, "mean_env_wait_ms": 0.06675258672828072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031621456146240234, "StateBufferConnector_ms": 0.0031540393829345703, "ViewRequirementAgentConnector_ms": 0.06801772117614746}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.2934606296548, "num_env_steps_trained_throughput_per_sec": 673.2934606296548, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 5838.673, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5838.63, "sample_time_ms": 676.774, "learn_time_ms": 5147.562, "learn_throughput": 777.067, "synch_weights_time_ms": 13.906}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 49, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-38", "timestamp": 1723390538, "time_this_iter_s": 5.946779012680054, "time_total_s": 283.415860414505, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.415860414505, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.1625, "ram_util_percent": 82.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.24577050122122, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.346201227248336, "policy_loss": -0.005913114798507498, "vf_loss": 1.35211088458697, "vf_explained_var": 0.9734408010418216, "kl": 0.008859010276690544, "entropy": 0.39390135581294694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4381368435919284, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3809141645828882, "policy_loss": -0.007575742285310601, "vf_loss": 1.3882377513373891, "vf_explained_var": 0.9729784806569417, "kl": 0.01008609108572108, "entropy": 0.6651847938075661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.97, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6697, "policy_reward_min": {"prey_policy": -49.02670800066596, "predator_policy": 0.9881174956119285}, "policy_reward_max": {"prey_policy": -0.9881174956119285, "predator_policy": 49.02670800066596}, "policy_reward_mean": {"prey_policy": -24.27145418389766, "predator_policy": 24.27145418389766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [37, 77, 80, 108, 158, 75, 59, 91, 52, 49, 31, 84, 43, 96, 88, 68, 18, 85, 56, 78, 71, 67, 75, 83, 82, 46, 38, 60, 68, 79, 50, 48, 58, 54, 38, 139, 49, 59, 73, 76, 77, 79, 63, 69, 26, 53, 120, 53, 79, 70, 80, 109, 90, 56, 51, 67, 86, 87, 90, 33, 55, 24, 63, 84, 28, 73, 59, 85, 95, 42, 23, 31, 54, 82, 60, 48, 125, 76, 80, 78, 76, 85, 42, 78, 36, 64, 152, 1, 97, 52, 84, 38, 73, 64, 26, 43, 59, 32, 81, 65], "policy_prey_policy_reward": [-20.435732169837276, -38.47259569673821, -47.89935963639207, -22.885476161152795, -34.06270000175719, -30.946151703792356, -18.702706662396928, -22.3279702611206, -30.57228824817801, -18.82798126300694, -18.608353312155394, -10.279813821714063, -12.621789277926045, -24.430135690420077, -13.35956685423951, -15.672228719590995, -8.69602298799004, -16.425816129411142, -32.116795134451266, -46.55045070041054, -20.494017262670084, -20.19810307017869, -23.01602479534929, -43.23160377365883, -24.8648557817425, -20.76755340547433, -12.60279691028912, -38.457104389669645, -16.616292936437823, -25.941285487365658, -10.928506928708677, -31.526138215845574, -12.134842311178033, -16.084485423084026, -18.513784058564827, -35.02866798572607, -28.403834931732852, -32.9049495334509, -24.9091174791316, -39.3245400969174, -35.77345205786335, -38.799140323333525, -23.310347770853507, -42.458519274813284, -17.50626135300124, -17.88335096490071, -17.519518235696093, -28.922007347693047, -6.49628307826837, -40.92678245136209, -26.728508526223766, -11.015568101990835, -49.02670800066596, -25.404321248591316, -19.510366752451983, -29.2010404966821, -23.804008247739414, -8.745522781290715, -16.0799875922375, -9.838764163992382, -25.901975708802226, -11.237737977680055, -32.04565507194759, -31.919747064789508, -20.671996444400985, -30.089672519679787, -29.648598923534735, -32.140803301149155, -37.92615497665206, -23.091357714667396, -2.380679662981634, -11.659585894628448, -10.41436521813325, -14.406744902782576, -26.695367762138805, -33.80781819601445, -17.098153999445348, -19.478826360544986, -28.798629213609583, -15.237913759801595, -42.13951859619764, -41.67857023839106, -18.79526572243483, -48.512372008319645, -11.334733678207245, -13.176799831987301, -37.93551275205244, -0.9881174956119285, -39.90554919399302, -35.84289774623644, -7.300741222264277, -13.540250923044189, -44.607194147301165, -29.228225408972868, -12.75962275264881, -8.02328012368324, -10.85971593704252, -13.403650826100794, -41.692340502918846, -31.976376629465378], "policy_predator_policy_reward": [20.435732169837276, 38.47259569673821, 47.89935963639207, 22.885476161152795, 34.06270000175719, 30.946151703792356, 18.702706662396928, 22.3279702611206, 30.57228824817801, 18.82798126300694, 18.608353312155394, 10.279813821714063, 12.621789277926045, 24.430135690420077, 13.35956685423951, 15.672228719590995, 8.69602298799004, 16.425816129411142, 32.116795134451266, 46.55045070041054, 20.494017262670084, 20.19810307017869, 23.01602479534929, 43.23160377365883, 24.8648557817425, 20.76755340547433, 12.60279691028912, 38.457104389669645, 16.616292936437823, 25.941285487365658, 10.928506928708677, 31.526138215845574, 12.134842311178033, 16.084485423084026, 18.513784058564827, 35.02866798572607, 28.403834931732852, 32.9049495334509, 24.9091174791316, 39.3245400969174, 35.77345205786335, 38.799140323333525, 23.310347770853507, 42.458519274813284, 17.50626135300124, 17.88335096490071, 17.519518235696093, 28.922007347693047, 6.49628307826837, 40.92678245136209, 26.728508526223766, 11.015568101990835, 49.02670800066596, 25.404321248591316, 19.510366752451983, 29.2010404966821, 23.804008247739414, 8.745522781290715, 16.0799875922375, 9.838764163992382, 25.901975708802226, 11.237737977680055, 32.04565507194759, 31.919747064789508, 20.671996444400985, 30.089672519679787, 29.648598923534735, 32.140803301149155, 37.92615497665206, 23.091357714667396, 2.380679662981634, 11.659585894628448, 10.41436521813325, 14.406744902782576, 26.695367762138805, 33.80781819601445, 17.098153999445348, 19.478826360544986, 28.798629213609583, 15.237913759801595, 42.13951859619764, 41.67857023839106, 18.79526572243483, 48.512372008319645, 11.334733678207245, 13.176799831987301, 37.93551275205244, 0.9881174956119285, 39.90554919399302, 35.84289774623644, 7.300741222264277, 13.540250923044189, 44.607194147301165, 29.228225408972868, 12.75962275264881, 8.02328012368324, 10.85971593704252, 13.403650826100794, 41.692340502918846, 31.976376629465378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29227984225191306, "mean_inference_ms": 0.9369866613690729, "mean_action_processing_ms": 0.12614863315513894, "mean_env_wait_ms": 0.06679217895584638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030214786529541016, "StateBufferConnector_ms": 0.0021039247512817383, "ViewRequirementAgentConnector_ms": 0.05332672595977783}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.6215003100441, "num_env_steps_trained_throughput_per_sec": 683.6215003100441, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 5828.802, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5828.759, "sample_time_ms": 683.793, "learn_time_ms": 5130.708, "learn_throughput": 779.619, "synch_weights_time_ms": 13.821}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 50, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-44", "timestamp": 1723390544, "time_this_iter_s": 5.85649299621582, "time_total_s": 289.2723534107208, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.2723534107208, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.4375, "ram_util_percent": 82.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.774905892337362, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9553551462323715, "policy_loss": -0.004569775531126652, "vf_loss": 0.9599227607250214, "vf_explained_var": 0.9834826694180568, "kl": 0.0055267164521061495, "entropy": 0.37892742132147156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8856163177018366, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9895597816134493, "policy_loss": -0.009176834898729188, "vf_loss": 0.9984204673518737, "vf_explained_var": 0.9822744616617759, "kl": 0.012645878077933515, "entropy": 0.6003723485395313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.17, "episode_media": {}, "episodes_this_iter": 55, "episodes_timesteps_total": 6517, "policy_reward_min": {"prey_policy": -48.512372008319645, "predator_policy": 0.9881174956119285}, "policy_reward_max": {"prey_policy": -0.9881174956119285, "predator_policy": 48.512372008319645}, "policy_reward_mean": {"prey_policy": -24.057315497232867, "predator_policy": 24.057315497232867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [67, 86, 87, 90, 33, 55, 24, 63, 84, 28, 73, 59, 85, 95, 42, 23, 31, 54, 82, 60, 48, 125, 76, 80, 78, 76, 85, 42, 78, 36, 64, 152, 1, 97, 52, 84, 38, 73, 64, 26, 43, 59, 32, 81, 65, 60, 66, 52, 62, 88, 47, 41, 57, 126, 48, 31, 56, 70, 88, 51, 92, 35, 25, 51, 82, 48, 90, 77, 107, 68, 79, 51, 46, 92, 30, 28, 78, 101, 126, 32, 41, 42, 85, 89, 144, 61, 45, 86, 61, 48, 78, 1, 90, 82, 76, 52, 130, 77, 37, 35], "policy_prey_policy_reward": [-29.2010404966821, -23.804008247739414, -8.745522781290715, -16.0799875922375, -9.838764163992382, -25.901975708802226, -11.237737977680055, -32.04565507194759, -31.919747064789508, -20.671996444400985, -30.089672519679787, -29.648598923534735, -32.140803301149155, -37.92615497665206, -23.091357714667396, -2.380679662981634, -11.659585894628448, -10.41436521813325, -14.406744902782576, -26.695367762138805, -33.80781819601445, -17.098153999445348, -19.478826360544986, -28.798629213609583, -15.237913759801595, -42.13951859619764, -41.67857023839106, -18.79526572243483, -48.512372008319645, -11.334733678207245, -13.176799831987301, -37.93551275205244, -0.9881174956119285, -39.90554919399302, -35.84289774623644, -7.300741222264277, -13.540250923044189, -44.607194147301165, -29.228225408972868, -12.75962275264881, -8.02328012368324, -10.85971593704252, -13.403650826100794, -41.692340502918846, -31.976376629465378, -24.076052744637884, -36.391096424103644, -26.99334706771268, -36.41345828987644, -24.02837559445987, -9.15198021705536, -11.969977001088658, -7.386753915766654, -37.593718406103456, -18.343691839763125, -8.943244343360263, -40.11511954783197, -22.729101567547982, -22.401910997350505, -4.460072267453917, -9.90656702752163, -10.72917008714033, -21.72506892389977, -19.54633426371917, -38.21129473847182, -28.891850059852015, -41.21153841287237, -18.473926832673843, -34.17092391694262, -42.29510192263925, -40.85338544039964, -20.533063465836992, -7.071935074041929, -10.626221185654828, -3.6477296752497255, -9.687315160077855, -19.88132860308163, -29.047425165348326, -31.999627480682133, -18.783346228477654, -10.510483322067428, -9.697548434036595, -46.63737935105169, -38.471772258843274, -33.83204506800523, -18.276171252401728, -14.058956896024, -41.349462119562915, -42.943226940808, -11.378736038682703, -40.813838092044286, -1.3599782032364895, -43.9720677445816, -38.61629465040747, -38.26535292731895, -22.951542569350334, -39.36195717815375, -32.11954708903385, -18.41805972917079, -28.384232277609865], "policy_predator_policy_reward": [29.2010404966821, 23.804008247739414, 8.745522781290715, 16.0799875922375, 9.838764163992382, 25.901975708802226, 11.237737977680055, 32.04565507194759, 31.919747064789508, 20.671996444400985, 30.089672519679787, 29.648598923534735, 32.140803301149155, 37.92615497665206, 23.091357714667396, 2.380679662981634, 11.659585894628448, 10.41436521813325, 14.406744902782576, 26.695367762138805, 33.80781819601445, 17.098153999445348, 19.478826360544986, 28.798629213609583, 15.237913759801595, 42.13951859619764, 41.67857023839106, 18.79526572243483, 48.512372008319645, 11.334733678207245, 13.176799831987301, 37.93551275205244, 0.9881174956119285, 39.90554919399302, 35.84289774623644, 7.300741222264277, 13.540250923044189, 44.607194147301165, 29.228225408972868, 12.75962275264881, 8.02328012368324, 10.85971593704252, 13.403650826100794, 41.692340502918846, 31.976376629465378, 24.076052744637884, 36.391096424103644, 26.99334706771268, 36.41345828987644, 24.02837559445987, 9.15198021705536, 11.969977001088658, 7.386753915766654, 37.593718406103456, 18.343691839763125, 8.943244343360263, 40.11511954783197, 22.729101567547982, 22.401910997350505, 4.460072267453917, 9.90656702752163, 10.72917008714033, 21.72506892389977, 19.54633426371917, 38.21129473847182, 28.891850059852015, 41.21153841287237, 18.473926832673843, 34.17092391694262, 42.29510192263925, 40.85338544039964, 20.533063465836992, 7.071935074041929, 10.626221185654828, 3.6477296752497255, 9.687315160077855, 19.88132860308163, 29.047425165348326, 31.999627480682133, 18.783346228477654, 10.510483322067428, 9.697548434036595, 46.63737935105169, 38.471772258843274, 33.83204506800523, 18.276171252401728, 14.058956896024, 41.349462119562915, 42.943226940808, 11.378736038682703, 40.813838092044286, 1.3599782032364895, 43.9720677445816, 38.61629465040747, 38.26535292731895, 22.951542569350334, 39.36195717815375, 32.11954708903385, 18.41805972917079, 28.384232277609865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921686369984507, "mean_inference_ms": 0.9368878187099884, "mean_action_processing_ms": 0.12602724055087514, "mean_env_wait_ms": 0.0667649057135887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030270814895629883, "StateBufferConnector_ms": 0.0021053552627563477, "ViewRequirementAgentConnector_ms": 0.05006849765777588}, "num_episodes": 55, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.1558747651688, "num_env_steps_trained_throughput_per_sec": 673.1558747651688, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 5850.896, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5850.853, "sample_time_ms": 690.924, "learn_time_ms": 5145.5, "learn_throughput": 777.378, "synch_weights_time_ms": 13.989}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 51, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-50", "timestamp": 1723390550, "time_this_iter_s": 5.947520971298218, "time_total_s": 295.21987438201904, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.21987438201904, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 27.32222222222222, "ram_util_percent": 82.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1051864414165418, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2902623071645698, "policy_loss": -0.004762324722105404, "vf_loss": 1.295022573756675, "vf_explained_var": 0.9734448843325177, "kl": 0.005259655656909675, "entropy": 0.3889086289020876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.254397687067588, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3476237337415418, "policy_loss": -0.0063460564319636125, "vf_loss": 1.3538318693327407, "vf_explained_var": 0.9709311611329515, "kl": 0.005516827764251036, "entropy": 0.637495067405204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.41, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6941, "policy_reward_min": {"prey_policy": -47.89192797219802, "predator_policy": 1.3599782032364895}, "policy_reward_max": {"prey_policy": -1.3599782032364895, "predator_policy": 47.89192797219802}, "policy_reward_mean": {"prey_policy": -25.013070209043526, "predator_policy": 25.013070209043526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [51, 92, 35, 25, 51, 82, 48, 90, 77, 107, 68, 79, 51, 46, 92, 30, 28, 78, 101, 126, 32, 41, 42, 85, 89, 144, 61, 45, 86, 61, 48, 78, 1, 90, 82, 76, 52, 130, 77, 37, 35, 90, 86, 90, 95, 76, 44, 48, 84, 83, 77, 41, 50, 124, 144, 56, 68, 70, 68, 58, 87, 62, 16, 60, 52, 88, 30, 136, 78, 61, 43, 69, 59, 73, 78, 50, 64, 78, 62, 118, 142, 69, 134, 115, 30, 48, 36, 37, 87, 36, 51, 78, 68, 75, 28, 114, 64, 68, 20, 76], "policy_prey_policy_reward": [-4.460072267453917, -9.90656702752163, -10.72917008714033, -21.72506892389977, -19.54633426371917, -38.21129473847182, -28.891850059852015, -41.21153841287237, -18.473926832673843, -34.17092391694262, -42.29510192263925, -40.85338544039964, -20.533063465836992, -7.071935074041929, -10.626221185654828, -3.6477296752497255, -9.687315160077855, -19.88132860308163, -29.047425165348326, -31.999627480682133, -18.783346228477654, -10.510483322067428, -9.697548434036595, -46.63737935105169, -38.471772258843274, -33.83204506800523, -18.276171252401728, -14.058956896024, -41.349462119562915, -42.943226940808, -11.378736038682703, -40.813838092044286, -1.3599782032364895, -43.9720677445816, -38.61629465040747, -38.26535292731895, -22.951542569350334, -39.36195717815375, -32.11954708903385, -18.41805972917079, -28.384232277609865, -8.627750281381493, -43.59693387749876, -29.97581650036518, -38.19251515508873, -27.78119457843975, -7.908423900699563, -14.81814714486139, -19.320941972983558, -23.28555905511952, -32.067070226690674, -30.109330082072724, -30.80852012957457, -17.098527231848966, -24.3635110154853, -24.471677149023588, -47.89192797219802, -28.932888958346584, -40.92779301809344, -30.92140329481875, -29.01735546390854, -15.602837193197717, -4.945288714472123, -21.590937763161374, -8.119557547766725, -32.75518996586064, -15.831645817853742, -35.11398791046323, -30.05954845293571, -26.88447847316867, -21.539818432783473, -23.669625362074626, -18.353006202928352, -29.186100131865228, -5.622542152128071, -14.413004583922962, -14.774069346648542, -45.611070344882286, -14.863913267422769, -40.55269176554226, -43.59653955139698, -6.4686632242228574, -46.103451626529164, -35.51779695552099, -14.81946063996815, -23.7220292745949, -21.77323869208907, -6.5401433611888145, -43.10402111548159, -16.892863248219992, -19.334793022674035, -24.510125365893405, -28.235165429063365, -31.680798599048117, -9.953911469503545, -40.93126060515411, -25.30868606207616, -40.87442378101241, -8.803941649498967, -10.357228719210475], "policy_predator_policy_reward": [4.460072267453917, 9.90656702752163, 10.72917008714033, 21.72506892389977, 19.54633426371917, 38.21129473847182, 28.891850059852015, 41.21153841287237, 18.473926832673843, 34.17092391694262, 42.29510192263925, 40.85338544039964, 20.533063465836992, 7.071935074041929, 10.626221185654828, 3.6477296752497255, 9.687315160077855, 19.88132860308163, 29.047425165348326, 31.999627480682133, 18.783346228477654, 10.510483322067428, 9.697548434036595, 46.63737935105169, 38.471772258843274, 33.83204506800523, 18.276171252401728, 14.058956896024, 41.349462119562915, 42.943226940808, 11.378736038682703, 40.813838092044286, 1.3599782032364895, 43.9720677445816, 38.61629465040747, 38.26535292731895, 22.951542569350334, 39.36195717815375, 32.11954708903385, 18.41805972917079, 28.384232277609865, 8.627750281381493, 43.59693387749876, 29.97581650036518, 38.19251515508873, 27.78119457843975, 7.908423900699563, 14.81814714486139, 19.320941972983558, 23.28555905511952, 32.067070226690674, 30.109330082072724, 30.80852012957457, 17.098527231848966, 24.3635110154853, 24.471677149023588, 47.89192797219802, 28.932888958346584, 40.92779301809344, 30.92140329481875, 29.01735546390854, 15.602837193197717, 4.945288714472123, 21.590937763161374, 8.119557547766725, 32.75518996586064, 15.831645817853742, 35.11398791046323, 30.05954845293571, 26.88447847316867, 21.539818432783473, 23.669625362074626, 18.353006202928352, 29.186100131865228, 5.622542152128071, 14.413004583922962, 14.774069346648542, 45.611070344882286, 14.863913267422769, 40.55269176554226, 43.59653955139698, 6.4686632242228574, 46.103451626529164, 35.51779695552099, 14.81946063996815, 23.7220292745949, 21.77323869208907, 6.5401433611888145, 43.10402111548159, 16.892863248219992, 19.334793022674035, 24.510125365893405, 28.235165429063365, 31.680798599048117, 9.953911469503545, 40.93126060515411, 25.30868606207616, 40.87442378101241, 8.803941649498967, 10.357228719210475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29185640940552654, "mean_inference_ms": 0.9360422808677678, "mean_action_processing_ms": 0.1258906087628752, "mean_env_wait_ms": 0.06672303433980925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029282569885253906, "StateBufferConnector_ms": 0.002063155174255371, "ViewRequirementAgentConnector_ms": 0.048342108726501465}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.9296552685006, "num_env_steps_trained_throughput_per_sec": 677.9296552685006, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 5868.248, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5868.203, "sample_time_ms": 696.619, "learn_time_ms": 5157.061, "learn_throughput": 775.636, "synch_weights_time_ms": 14.08}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 52, "trial_id": "abfb9_00000", "date": "2024-08-11_11-35-56", "timestamp": 1723390556, "time_this_iter_s": 5.905908823013306, "time_total_s": 301.12578320503235, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d20d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 301.12578320503235, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 29.7375, "ram_util_percent": 82.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1399470233048, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1871353551434973, "policy_loss": -0.003424614021302356, "vf_loss": 1.190558090309302, "vf_explained_var": 0.9782436324283481, "kl": 0.004807130012038825, "entropy": 0.3665701985048751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.186448416300118, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1888088456044594, "policy_loss": -0.0036828415395575576, "vf_loss": 1.1922708046933015, "vf_explained_var": 0.9781027009089788, "kl": 0.008835345658215456, "entropy": 0.6273242966582377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.51, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 6951, "policy_reward_min": {"prey_policy": -47.89192797219802, "predator_policy": 4.945288714472123}, "policy_reward_max": {"prey_policy": -4.945288714472123, "predator_policy": 47.89192797219802}, "policy_reward_mean": {"prey_policy": -25.003096382944445, "predator_policy": 25.003096382944445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [68, 70, 68, 58, 87, 62, 16, 60, 52, 88, 30, 136, 78, 61, 43, 69, 59, 73, 78, 50, 64, 78, 62, 118, 142, 69, 134, 115, 30, 48, 36, 37, 87, 36, 51, 78, 68, 75, 28, 114, 64, 68, 20, 76, 70, 92, 47, 140, 174, 83, 68, 86, 42, 55, 37, 56, 52, 74, 74, 50, 43, 64, 62, 59, 85, 85, 77, 89, 39, 99, 79, 73, 85, 41, 41, 43, 85, 126, 18, 80, 61, 91, 31, 49, 78, 39, 85, 88, 39, 61, 61, 64, 57, 76, 66, 63, 32, 145, 139, 49], "policy_prey_policy_reward": [-47.89192797219802, -28.932888958346584, -40.92779301809344, -30.92140329481875, -29.01735546390854, -15.602837193197717, -4.945288714472123, -21.590937763161374, -8.119557547766725, -32.75518996586064, -15.831645817853742, -35.11398791046323, -30.05954845293571, -26.88447847316867, -21.539818432783473, -23.669625362074626, -18.353006202928352, -29.186100131865228, -5.622542152128071, -14.413004583922962, -14.774069346648542, -45.611070344882286, -14.863913267422769, -40.55269176554226, -43.59653955139698, -6.4686632242228574, -46.103451626529164, -35.51779695552099, -14.81946063996815, -23.7220292745949, -21.77323869208907, -6.5401433611888145, -43.10402111548159, -16.892863248219992, -19.334793022674035, -24.510125365893405, -28.235165429063365, -31.680798599048117, -9.953911469503545, -40.93126060515411, -25.30868606207616, -40.87442378101241, -8.803941649498967, -10.357228719210475, -35.943794448855755, -10.468093468955791, -15.34406471976727, -34.27367441927531, -44.26462407863178, -13.192672623337213, -18.608083164247653, -28.779038562851497, -15.6976382231958, -11.724496032619903, -14.832390992274934, -38.51898990117786, -19.707017679828045, -28.992688247571124, -24.272634632110137, -16.783282091346926, -10.72521640693023, -25.616000303833726, -40.44586402800191, -30.411195993345803, -31.206004841064868, -18.175130704847327, -25.30447065945466, -39.00662507912104, -26.77189775684063, -40.67646293168372, -15.805981314111962, -42.31681723771186, -37.79658820431889, -34.291695745231216, -9.91186780185551, -34.23999871284696, -40.70275327707073, -29.35187656214747, -5.701672117183622, -19.261667066711638, -18.415519530333857, -37.94973235730699, -13.270861132316043, -20.805657360785244, -26.93734085659476, -16.496747778720998, -47.75388220247053, -8.159949242404362, -26.62167659165407, -21.72500864349891, -8.539744395825453, -30.426539712193915, -36.742940894712774, -24.773162480831076, -30.20891201209647, -42.64669626866172, -8.142807437431372, -24.379862585803412, -18.77531598847787, -12.705086263173062], "policy_predator_policy_reward": [47.89192797219802, 28.932888958346584, 40.92779301809344, 30.92140329481875, 29.01735546390854, 15.602837193197717, 4.945288714472123, 21.590937763161374, 8.119557547766725, 32.75518996586064, 15.831645817853742, 35.11398791046323, 30.05954845293571, 26.88447847316867, 21.539818432783473, 23.669625362074626, 18.353006202928352, 29.186100131865228, 5.622542152128071, 14.413004583922962, 14.774069346648542, 45.611070344882286, 14.863913267422769, 40.55269176554226, 43.59653955139698, 6.4686632242228574, 46.103451626529164, 35.51779695552099, 14.81946063996815, 23.7220292745949, 21.77323869208907, 6.5401433611888145, 43.10402111548159, 16.892863248219992, 19.334793022674035, 24.510125365893405, 28.235165429063365, 31.680798599048117, 9.953911469503545, 40.93126060515411, 25.30868606207616, 40.87442378101241, 8.803941649498967, 10.357228719210475, 35.943794448855755, 10.468093468955791, 15.34406471976727, 34.27367441927531, 44.26462407863178, 13.192672623337213, 18.608083164247653, 28.779038562851497, 15.6976382231958, 11.724496032619903, 14.832390992274934, 38.51898990117786, 19.707017679828045, 28.992688247571124, 24.272634632110137, 16.783282091346926, 10.72521640693023, 25.616000303833726, 40.44586402800191, 30.411195993345803, 31.206004841064868, 18.175130704847327, 25.30447065945466, 39.00662507912104, 26.77189775684063, 40.67646293168372, 15.805981314111962, 42.31681723771186, 37.79658820431889, 34.291695745231216, 9.91186780185551, 34.23999871284696, 40.70275327707073, 29.35187656214747, 5.701672117183622, 19.261667066711638, 18.415519530333857, 37.94973235730699, 13.270861132316043, 20.805657360785244, 26.93734085659476, 16.496747778720998, 47.75388220247053, 8.159949242404362, 26.62167659165407, 21.72500864349891, 8.539744395825453, 30.426539712193915, 36.742940894712774, 24.773162480831076, 30.20891201209647, 42.64669626866172, 8.142807437431372, 24.379862585803412, 18.77531598847787, 12.705086263173062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29176268009744155, "mean_inference_ms": 0.935389005925578, "mean_action_processing_ms": 0.1259808205100171, "mean_env_wait_ms": 0.06670973707715948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002774477005004883, "StateBufferConnector_ms": 0.0019915103912353516, "ViewRequirementAgentConnector_ms": 0.04922056198120117}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 666.819581023935, "num_env_steps_trained_throughput_per_sec": 666.819581023935, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 5886.548, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5886.504, "sample_time_ms": 701.665, "learn_time_ms": 5170.167, "learn_throughput": 773.669, "synch_weights_time_ms": 14.225}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "training_iteration": 53, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-02", "timestamp": 1723390562, "time_this_iter_s": 6.003432750701904, "time_total_s": 307.12921595573425, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.12921595573425, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 29.055555555555557, "ram_util_percent": 82.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2425772562623023, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1997708664896587, "policy_loss": -0.0011723160952290832, "vf_loss": 1.2009425009911259, "vf_explained_var": 0.9803662408764163, "kl": 0.0034899057301534717, "entropy": 0.39050362358490626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4648847743868827, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2173344491670528, "policy_loss": -0.004063517466420308, "vf_loss": 1.2212544295936822, "vf_explained_var": 0.9798713566114505, "kl": 0.005741620627007648, "entropy": 0.6051749104633928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.76, "episode_media": {}, "episodes_this_iter": 66, "episodes_timesteps_total": 6476, "policy_reward_min": {"prey_policy": -52.48508618014417, "predator_policy": 1.0645175405678606}, "policy_reward_max": {"prey_policy": -1.0645175405678606, "predator_policy": 52.48508618014417}, "policy_reward_mean": {"prey_policy": -24.52355075956018, "predator_policy": 24.52355075956018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [77, 89, 39, 99, 79, 73, 85, 41, 41, 43, 85, 126, 18, 80, 61, 91, 31, 49, 78, 39, 85, 88, 39, 61, 61, 64, 57, 76, 66, 63, 32, 145, 139, 49, 116, 71, 80, 68, 46, 35, 64, 48, 84, 58, 73, 49, 156, 16, 44, 87, 50, 47, 50, 62, 77, 60, 30, 13, 62, 50, 59, 69, 86, 60, 37, 49, 58, 79, 76, 101, 63, 67, 87, 76, 66, 83, 57, 15, 78, 60, 61, 88, 43, 47, 89, 68, 122, 31, 86, 77, 11, 42, 25, 23, 70, 75, 43, 73, 79, 52], "policy_prey_policy_reward": [-25.30447065945466, -39.00662507912104, -26.77189775684063, -40.67646293168372, -15.805981314111962, -42.31681723771186, -37.79658820431889, -34.291695745231216, -9.91186780185551, -34.23999871284696, -40.70275327707073, -29.35187656214747, -5.701672117183622, -19.261667066711638, -18.415519530333857, -37.94973235730699, -13.270861132316043, -20.805657360785244, -26.93734085659476, -16.496747778720998, -47.75388220247053, -8.159949242404362, -26.62167659165407, -21.72500864349891, -8.539744395825453, -30.426539712193915, -36.742940894712774, -24.773162480831076, -30.20891201209647, -42.64669626866172, -8.142807437431372, -24.379862585803412, -18.77531598847787, -12.705086263173062, -41.383034269344606, -49.541651057900836, -13.29701202146914, -25.56310143086987, -4.676789165925613, -10.546622886118405, -14.298497134420378, -12.86119376784266, -52.48508618014417, -14.281708545508215, -26.487716264269444, -33.617667297887685, -12.015544042933264, -6.0450022914916275, -26.591505014808817, -34.22042854512098, -31.76606555710934, -37.283515529067095, -29.370504339708514, -31.26806193022752, -35.58450215554652, -32.50228828765346, -14.542962391979044, -1.8794615318398498, -27.16690042744505, -24.7900923187774, -21.01131968848939, -41.49857695970341, -26.475753799569482, -20.982516149474996, -10.675611204128543, -3.5505830076105687, -31.01166879004397, -10.91479291381905, -12.842937918911868, -14.382703852767827, -19.541624024473023, -15.921708717437502, -51.64950901641596, -41.253603333707495, -14.414375271934407, -5.038497251874761, -32.34510494318556, -5.707466748299062, -47.07903200116482, -24.82589585927285, -23.92366954074304, -29.965259721378022, -33.13332964010147, -27.381575138681008, -32.769131297271926, -34.97574268525572, -43.5430707307054, -3.2768725104265126, -19.601111725847773, -38.66479501467387, -1.0645175405678606, -2.7383505620013993, -9.478013745441142, -11.964714310430498, -24.385628765509594, -28.375665385924908, -26.751492379162624, -27.889422917550206, -44.27243065426002, -16.39226765080764], "policy_predator_policy_reward": [25.30447065945466, 39.00662507912104, 26.77189775684063, 40.67646293168372, 15.805981314111962, 42.31681723771186, 37.79658820431889, 34.291695745231216, 9.91186780185551, 34.23999871284696, 40.70275327707073, 29.35187656214747, 5.701672117183622, 19.261667066711638, 18.415519530333857, 37.94973235730699, 13.270861132316043, 20.805657360785244, 26.93734085659476, 16.496747778720998, 47.75388220247053, 8.159949242404362, 26.62167659165407, 21.72500864349891, 8.539744395825453, 30.426539712193915, 36.742940894712774, 24.773162480831076, 30.20891201209647, 42.64669626866172, 8.142807437431372, 24.379862585803412, 18.77531598847787, 12.705086263173062, 41.383034269344606, 49.541651057900836, 13.29701202146914, 25.56310143086987, 4.676789165925613, 10.546622886118405, 14.298497134420378, 12.86119376784266, 52.48508618014417, 14.281708545508215, 26.487716264269444, 33.617667297887685, 12.015544042933264, 6.0450022914916275, 26.591505014808817, 34.22042854512098, 31.76606555710934, 37.283515529067095, 29.370504339708514, 31.26806193022752, 35.58450215554652, 32.50228828765346, 14.542962391979044, 1.8794615318398498, 27.16690042744505, 24.7900923187774, 21.01131968848939, 41.49857695970341, 26.475753799569482, 20.982516149474996, 10.675611204128543, 3.5505830076105687, 31.01166879004397, 10.91479291381905, 12.842937918911868, 14.382703852767827, 19.541624024473023, 15.921708717437502, 51.64950901641596, 41.253603333707495, 14.414375271934407, 5.038497251874761, 32.34510494318556, 5.707466748299062, 47.07903200116482, 24.82589585927285, 23.92366954074304, 29.965259721378022, 33.13332964010147, 27.381575138681008, 32.769131297271926, 34.97574268525572, 43.5430707307054, 3.2768725104265126, 19.601111725847773, 38.66479501467387, 1.0645175405678606, 2.7383505620013993, 9.478013745441142, 11.964714310430498, 24.385628765509594, 28.375665385924908, 26.751492379162624, 27.889422917550206, 44.27243065426002, 16.39226765080764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917536455790603, "mean_inference_ms": 0.9334070138458626, "mean_action_processing_ms": 0.12583114491642808, "mean_env_wait_ms": 0.06643605075604347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027810335159301758, "StateBufferConnector_ms": 0.0019589662551879883, "ViewRequirementAgentConnector_ms": 0.04943716526031494}, "num_episodes": 66, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.5548075801604, "num_env_steps_trained_throughput_per_sec": 687.5548075801604, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 5893.604, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5893.56, "sample_time_ms": 707.386, "learn_time_ms": 5171.615, "learn_throughput": 773.453, "synch_weights_time_ms": 14.107}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 54, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-08", "timestamp": 1723390568, "time_this_iter_s": 5.82274603843689, "time_total_s": 312.95196199417114, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.95196199417114, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 27.75, "ram_util_percent": 82.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1901365123689174, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2473953543851772, "policy_loss": -0.003602725310823492, "vf_loss": 1.250997531786561, "vf_explained_var": 0.9792831509063641, "kl": 0.005598341915268801, "entropy": 0.449150203820318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4070146137227613, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2124562601869304, "policy_loss": -0.0068236888910178095, "vf_loss": 1.2190286391725143, "vf_explained_var": 0.9811468965684375, "kl": 0.010052589521164756, "entropy": 0.5859181184942523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.32, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 6532, "policy_reward_min": {"prey_policy": -58.56018969252216, "predator_policy": 1.0366746108315663}, "policy_reward_max": {"prey_policy": -1.0366746108315663, "predator_policy": 58.56018969252216}, "policy_reward_mean": {"prey_policy": -26.1417189517516, "predator_policy": 26.1417189517516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [62, 50, 59, 69, 86, 60, 37, 49, 58, 79, 76, 101, 63, 67, 87, 76, 66, 83, 57, 15, 78, 60, 61, 88, 43, 47, 89, 68, 122, 31, 86, 77, 11, 42, 25, 23, 70, 75, 43, 73, 79, 52, 88, 65, 117, 74, 79, 76, 76, 103, 5, 53, 48, 80, 69, 46, 62, 19, 77, 81, 92, 65, 57, 43, 37, 104, 20, 86, 77, 76, 142, 38, 85, 73, 96, 67, 62, 56, 89, 29, 15, 90, 8, 86, 69, 56, 56, 72, 65, 22, 45, 73, 136, 57, 58, 81, 116, 58, 55, 59], "policy_prey_policy_reward": [-27.16690042744505, -24.7900923187774, -21.01131968848939, -41.49857695970341, -26.475753799569482, -20.982516149474996, -10.675611204128543, -3.5505830076105687, -31.01166879004397, -10.91479291381905, -12.842937918911868, -14.382703852767827, -19.541624024473023, -15.921708717437502, -51.64950901641596, -41.253603333707495, -14.414375271934407, -5.038497251874761, -32.34510494318556, -5.707466748299062, -47.07903200116482, -24.82589585927285, -23.92366954074304, -29.965259721378022, -33.13332964010147, -27.381575138681008, -32.769131297271926, -34.97574268525572, -43.5430707307054, -3.2768725104265126, -19.601111725847773, -38.66479501467387, -1.0645175405678606, -2.7383505620013993, -9.478013745441142, -11.964714310430498, -24.385628765509594, -28.375665385924908, -26.751492379162624, -27.889422917550206, -44.27243065426002, -16.39226765080764, -50.42701057533084, -29.014407723430452, -46.478437926891445, -23.30878854023901, -34.81780931921908, -42.27169145152847, -45.485606634428954, -58.56018969252216, -1.0366746108315663, -11.703132785830796, -13.313277753262962, -35.06153390606306, -33.952459745024896, -22.163929091003634, -38.21539310849567, -18.554261580326127, -20.149092328138803, -34.590921919112, -32.402690980247286, -11.748393038183266, -36.21635586242693, -17.526693245422614, -8.807002502071676, -30.5395533546713, -14.414966878395628, -5.479452156694235, -27.2170719475345, -51.23021949527158, -31.74108320830054, -12.500574518454208, -29.850216125124174, -24.432390667021785, -55.37444655505006, -29.86659883410434, -35.487344872463936, -39.88889064652688, -38.44638230066844, -16.43626992223257, -7.407574856526097, -41.33835395164535, -3.6000965353217285, -35.65335288409955, -26.5763476211802, -33.86723449622477, -32.506773936854444, -20.69701848827822, -44.65615259204299, -2.924970360609234, -15.714232377349818, -35.751245406571634, -38.90054275491365, -18.782413346950268, -8.800343099233158, -35.934686378677696, -31.48651634814728, -19.366563749950142, -38.441870965219486, -29.4270531075703], "policy_predator_policy_reward": [27.16690042744505, 24.7900923187774, 21.01131968848939, 41.49857695970341, 26.475753799569482, 20.982516149474996, 10.675611204128543, 3.5505830076105687, 31.01166879004397, 10.91479291381905, 12.842937918911868, 14.382703852767827, 19.541624024473023, 15.921708717437502, 51.64950901641596, 41.253603333707495, 14.414375271934407, 5.038497251874761, 32.34510494318556, 5.707466748299062, 47.07903200116482, 24.82589585927285, 23.92366954074304, 29.965259721378022, 33.13332964010147, 27.381575138681008, 32.769131297271926, 34.97574268525572, 43.5430707307054, 3.2768725104265126, 19.601111725847773, 38.66479501467387, 1.0645175405678606, 2.7383505620013993, 9.478013745441142, 11.964714310430498, 24.385628765509594, 28.375665385924908, 26.751492379162624, 27.889422917550206, 44.27243065426002, 16.39226765080764, 50.42701057533084, 29.014407723430452, 46.478437926891445, 23.30878854023901, 34.81780931921908, 42.27169145152847, 45.485606634428954, 58.56018969252216, 1.0366746108315663, 11.703132785830796, 13.313277753262962, 35.06153390606306, 33.952459745024896, 22.163929091003634, 38.21539310849567, 18.554261580326127, 20.149092328138803, 34.590921919112, 32.402690980247286, 11.748393038183266, 36.21635586242693, 17.526693245422614, 8.807002502071676, 30.5395533546713, 14.414966878395628, 5.479452156694235, 27.2170719475345, 51.23021949527158, 31.74108320830054, 12.500574518454208, 29.850216125124174, 24.432390667021785, 55.37444655505006, 29.86659883410434, 35.487344872463936, 39.88889064652688, 38.44638230066844, 16.43626992223257, 7.407574856526097, 41.33835395164535, 3.6000965353217285, 35.65335288409955, 26.5763476211802, 33.86723449622477, 32.506773936854444, 20.69701848827822, 44.65615259204299, 2.924970360609234, 15.714232377349818, 35.751245406571634, 38.90054275491365, 18.782413346950268, 8.800343099233158, 35.934686378677696, 31.48651634814728, 19.366563749950142, 38.441870965219486, 29.4270531075703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29176056039098924, "mean_inference_ms": 0.9334381038968574, "mean_action_processing_ms": 0.12586231382407234, "mean_env_wait_ms": 0.06649092499202743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027805566787719727, "StateBufferConnector_ms": 0.002014756202697754, "ViewRequirementAgentConnector_ms": 0.048891544342041016}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 656.5293146132732, "num_env_steps_trained_throughput_per_sec": 656.5293146132732, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 5918.126, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5918.082, "sample_time_ms": 699.196, "learn_time_ms": 5204.442, "learn_throughput": 768.574, "synch_weights_time_ms": 13.94}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 55, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-14", "timestamp": 1723390574, "time_this_iter_s": 6.0977559089660645, "time_total_s": 319.0497179031372, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.0497179031372, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.15555555555556, "ram_util_percent": 82.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1643064801891643, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.191010525698463, "policy_loss": -0.0036494731924904046, "vf_loss": 1.1946591471632322, "vf_explained_var": 0.9792543624217311, "kl": 0.00868456737044524, "entropy": 0.4249905588105321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.173023000980417, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2154247074698408, "policy_loss": -0.006735964429875215, "vf_loss": 1.2218616021797062, "vf_explained_var": 0.9783975365882118, "kl": 0.011963002934030768, "entropy": 0.5706260854378342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.85, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6685, "policy_reward_min": {"prey_policy": -57.40646934453936, "predator_policy": 2.924970360609234}, "policy_reward_max": {"prey_policy": -2.924970360609234, "predator_policy": 57.40646934453936}, "policy_reward_mean": {"prey_policy": -27.07521864808801, "predator_policy": 27.07521864808801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [65, 57, 43, 37, 104, 20, 86, 77, 76, 142, 38, 85, 73, 96, 67, 62, 56, 89, 29, 15, 90, 8, 86, 69, 56, 56, 72, 65, 22, 45, 73, 136, 57, 58, 81, 116, 58, 55, 59, 88, 64, 73, 52, 106, 65, 144, 48, 81, 74, 80, 87, 12, 55, 93, 50, 71, 68, 33, 124, 57, 63, 39, 10, 23, 59, 62, 42, 45, 45, 13, 81, 50, 61, 72, 54, 54, 80, 82, 65, 75, 91, 47, 61, 125, 63, 82, 31, 82, 89, 74, 123, 85, 66, 43, 59, 59, 73, 65, 114, 74], "policy_prey_policy_reward": [-11.748393038183266, -36.21635586242693, -17.526693245422614, -8.807002502071676, -30.5395533546713, -14.414966878395628, -5.479452156694235, -27.2170719475345, -51.23021949527158, -31.74108320830054, -12.500574518454208, -29.850216125124174, -24.432390667021785, -55.37444655505006, -29.86659883410434, -35.487344872463936, -39.88889064652688, -38.44638230066844, -16.43626992223257, -7.407574856526097, -41.33835395164535, -3.6000965353217285, -35.65335288409955, -26.5763476211802, -33.86723449622477, -32.506773936854444, -20.69701848827822, -44.65615259204299, -2.924970360609234, -15.714232377349818, -35.751245406571634, -38.90054275491365, -18.782413346950268, -8.800343099233158, -35.934686378677696, -31.48651634814728, -19.366563749950142, -38.441870965219486, -29.4270531075703, -38.03815955290598, -43.203539058696265, -17.36586865275187, -3.818261012519904, -41.13978768196195, -18.30438185487508, -57.40646934453936, -21.54698821851624, -28.923685096836277, -16.681719073489134, -33.3816942774763, -22.370267001004972, -5.528159160305579, -26.310929351792833, -47.955674642710086, -36.121243206545714, -22.737503359072672, -31.675984739000654, -9.119085706253072, -22.8951645647686, -44.44374395136902, -38.934437346616974, -14.41114273417178, -6.8444464659448165, -9.69395389526433, -30.701224270093945, -9.094296063681226, -10.820428091801977, -26.130266618591637, -40.28241356362961, -6.334666820084781, -48.89861426927352, -15.46979711230099, -31.079863924153695, -42.34401767284014, -14.30763449263094, -17.550496781499163, -14.059125339373233, -45.03455976120565, -37.26536998514699, -40.047420104816034, -41.48631686287406, -10.835341867465239, -36.054732198452946, -29.57653927470423, -14.282247041320588, -39.876663922497215, -14.286399948293473, -15.763623416595047, -48.64250990360666, -20.99145920228087, -23.999244886573397, -30.7127058803455, -39.28749229261706, -33.30728148981673, -40.743751060148924, -13.121779090316444, -45.4398906078079, -31.487553379760026, -24.28274382293483, -26.033854451892775], "policy_predator_policy_reward": [11.748393038183266, 36.21635586242693, 17.526693245422614, 8.807002502071676, 30.5395533546713, 14.414966878395628, 5.479452156694235, 27.2170719475345, 51.23021949527158, 31.74108320830054, 12.500574518454208, 29.850216125124174, 24.432390667021785, 55.37444655505006, 29.86659883410434, 35.487344872463936, 39.88889064652688, 38.44638230066844, 16.43626992223257, 7.407574856526097, 41.33835395164535, 3.6000965353217285, 35.65335288409955, 26.5763476211802, 33.86723449622477, 32.506773936854444, 20.69701848827822, 44.65615259204299, 2.924970360609234, 15.714232377349818, 35.751245406571634, 38.90054275491365, 18.782413346950268, 8.800343099233158, 35.934686378677696, 31.48651634814728, 19.366563749950142, 38.441870965219486, 29.4270531075703, 38.03815955290598, 43.203539058696265, 17.36586865275187, 3.818261012519904, 41.13978768196195, 18.30438185487508, 57.40646934453936, 21.54698821851624, 28.923685096836277, 16.681719073489134, 33.3816942774763, 22.370267001004972, 5.528159160305579, 26.310929351792833, 47.955674642710086, 36.121243206545714, 22.737503359072672, 31.675984739000654, 9.119085706253072, 22.8951645647686, 44.44374395136902, 38.934437346616974, 14.41114273417178, 6.8444464659448165, 9.69395389526433, 30.701224270093945, 9.094296063681226, 10.820428091801977, 26.130266618591637, 40.28241356362961, 6.334666820084781, 48.89861426927352, 15.46979711230099, 31.079863924153695, 42.34401767284014, 14.30763449263094, 17.550496781499163, 14.059125339373233, 45.03455976120565, 37.26536998514699, 40.047420104816034, 41.48631686287406, 10.835341867465239, 36.054732198452946, 29.57653927470423, 14.282247041320588, 39.876663922497215, 14.286399948293473, 15.763623416595047, 48.64250990360666, 20.99145920228087, 23.999244886573397, 30.7127058803455, 39.28749229261706, 33.30728148981673, 40.743751060148924, 13.121779090316444, 45.4398906078079, 31.487553379760026, 24.28274382293483, 26.033854451892775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917966126442015, "mean_inference_ms": 0.9339670511049342, "mean_action_processing_ms": 0.12591667469552031, "mean_env_wait_ms": 0.06647587795708661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028655529022216797, "StateBufferConnector_ms": 0.0022873878479003906, "ViewRequirementAgentConnector_ms": 0.048413872718811035}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 652.5736887869975, "num_env_steps_trained_throughput_per_sec": 652.5736887869975, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 5955.22, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5955.172, "sample_time_ms": 705.464, "learn_time_ms": 5234.806, "learn_throughput": 764.116, "synch_weights_time_ms": 14.384}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-20", "timestamp": 1723390580, "time_this_iter_s": 6.155685901641846, "time_total_s": 325.20540380477905, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.20540380477905, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.35, "ram_util_percent": 83.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0185477030773957, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.202745912472407, "policy_loss": -0.003091117810011686, "vf_loss": 1.2058366377527514, "vf_explained_var": 0.9789332217847307, "kl": 0.0040141982871635135, "entropy": 0.4203744917176664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1176275458186864, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1558649496485789, "policy_loss": -0.0037335682165576143, "vf_loss": 1.1593919046223164, "vf_explained_var": 0.9797677556673686, "kl": 0.008264593668581902, "entropy": 0.5735368885099887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.59, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 6759, "policy_reward_min": {"prey_policy": -50.162710676795804, "predator_policy": 6.334666820084781}, "policy_reward_max": {"prey_policy": -6.334666820084781, "predator_policy": 50.162710676795804}, "policy_reward_mean": {"prey_policy": -28.0392452423956, "predator_policy": 28.0392452423956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [68, 33, 124, 57, 63, 39, 10, 23, 59, 62, 42, 45, 45, 13, 81, 50, 61, 72, 54, 54, 80, 82, 65, 75, 91, 47, 61, 125, 63, 82, 31, 82, 89, 74, 123, 85, 66, 43, 59, 59, 73, 65, 114, 74, 77, 58, 80, 50, 97, 37, 67, 65, 73, 61, 79, 95, 65, 93, 90, 96, 87, 71, 89, 81, 70, 55, 44, 39, 40, 73, 23, 87, 131, 52, 67, 63, 68, 61, 64, 97, 66, 47, 83, 59, 40, 40, 54, 111, 82, 86, 93, 62, 122, 31, 50, 32, 74, 64, 79, 76], "policy_prey_policy_reward": [-31.675984739000654, -9.119085706253072, -22.8951645647686, -44.44374395136902, -38.934437346616974, -14.41114273417178, -6.8444464659448165, -9.69395389526433, -30.701224270093945, -9.094296063681226, -10.820428091801977, -26.130266618591637, -40.28241356362961, -6.334666820084781, -48.89861426927352, -15.46979711230099, -31.079863924153695, -42.34401767284014, -14.30763449263094, -17.550496781499163, -14.059125339373233, -45.03455976120565, -37.26536998514699, -40.047420104816034, -41.48631686287406, -10.835341867465239, -36.054732198452946, -29.57653927470423, -14.282247041320588, -39.876663922497215, -14.286399948293473, -15.763623416595047, -48.64250990360666, -20.99145920228087, -23.999244886573397, -30.7127058803455, -39.28749229261706, -33.30728148981673, -40.743751060148924, -13.121779090316444, -45.4398906078079, -31.487553379760026, -24.28274382293483, -26.033854451892775, -47.12405904209089, -24.8456813228472, -45.99379256721678, -19.722127496540907, -15.619425364302767, -11.038876719193093, -31.576613750827523, -36.38928733466301, -26.032860628294337, -23.624402893062605, -25.86646079611245, -50.162710676795804, -38.05596752549781, -15.604400189274333, -44.90730324210282, -13.975735140924355, -44.60416991113765, -25.420864917502627, -42.27942611481457, -38.94985768625177, -42.562612389305, -11.133749047581016, -10.39133282597252, -26.247209855445835, -17.894048635787318, -46.69182276960975, -11.432184727733178, -26.855391923738992, -20.26768245669674, -22.08784206222146, -40.22354591225912, -23.252934024483366, -21.90405532376515, -8.362971173247168, -34.36767558552806, -40.289611719184705, -31.55270455224558, -22.503976275605794, -43.9943599868585, -19.400902528472788, -32.554602424141315, -10.179734796035985, -29.328627639899445, -33.01776954673511, -40.95245022487432, -38.01976231738046, -43.83705766829028, -30.32303364619313, -33.167951039539744, -18.75996253886365, -28.18223429997959, -17.21468284846072, -47.00494700944043, -32.76485937305012, -23.062508531097944, -14.693418365565615], "policy_predator_policy_reward": [31.675984739000654, 9.119085706253072, 22.8951645647686, 44.44374395136902, 38.934437346616974, 14.41114273417178, 6.8444464659448165, 9.69395389526433, 30.701224270093945, 9.094296063681226, 10.820428091801977, 26.130266618591637, 40.28241356362961, 6.334666820084781, 48.89861426927352, 15.46979711230099, 31.079863924153695, 42.34401767284014, 14.30763449263094, 17.550496781499163, 14.059125339373233, 45.03455976120565, 37.26536998514699, 40.047420104816034, 41.48631686287406, 10.835341867465239, 36.054732198452946, 29.57653927470423, 14.282247041320588, 39.876663922497215, 14.286399948293473, 15.763623416595047, 48.64250990360666, 20.99145920228087, 23.999244886573397, 30.7127058803455, 39.28749229261706, 33.30728148981673, 40.743751060148924, 13.121779090316444, 45.4398906078079, 31.487553379760026, 24.28274382293483, 26.033854451892775, 47.12405904209089, 24.8456813228472, 45.99379256721678, 19.722127496540907, 15.619425364302767, 11.038876719193093, 31.576613750827523, 36.38928733466301, 26.032860628294337, 23.624402893062605, 25.86646079611245, 50.162710676795804, 38.05596752549781, 15.604400189274333, 44.90730324210282, 13.975735140924355, 44.60416991113765, 25.420864917502627, 42.27942611481457, 38.94985768625177, 42.562612389305, 11.133749047581016, 10.39133282597252, 26.247209855445835, 17.894048635787318, 46.69182276960975, 11.432184727733178, 26.855391923738992, 20.26768245669674, 22.08784206222146, 40.22354591225912, 23.252934024483366, 21.90405532376515, 8.362971173247168, 34.36767558552806, 40.289611719184705, 31.55270455224558, 22.503976275605794, 43.9943599868585, 19.400902528472788, 32.554602424141315, 10.179734796035985, 29.328627639899445, 33.01776954673511, 40.95245022487432, 38.01976231738046, 43.83705766829028, 30.32303364619313, 33.167951039539744, 18.75996253886365, 28.18223429997959, 17.21468284846072, 47.00494700944043, 32.76485937305012, 23.062508531097944, 14.693418365565615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919259702073917, "mean_inference_ms": 0.9346872929362046, "mean_action_processing_ms": 0.12579625649451745, "mean_env_wait_ms": 0.06641403058676452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028496980667114258, "StateBufferConnector_ms": 0.002084493637084961, "ViewRequirementAgentConnector_ms": 0.04941964149475098}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.5386063337112, "num_env_steps_trained_throughput_per_sec": 672.5386063337112, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 5981.2, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5981.154, "sample_time_ms": 724.093, "learn_time_ms": 5242.156, "learn_throughput": 763.045, "synch_weights_time_ms": 14.45}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 57, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-26", "timestamp": 1723390586, "time_this_iter_s": 5.96045994758606, "time_total_s": 331.1658637523651, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d2310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 331.1658637523651, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.9, "ram_util_percent": 83.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.136565246184667, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1858916325184206, "policy_loss": -0.002899668167810887, "vf_loss": 1.1887910240640243, "vf_explained_var": 0.9789279085894426, "kl": 0.005704690312488598, "entropy": 0.4119423723158737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.225794826510052, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2557971375683943, "policy_loss": -0.008693980103028782, "vf_loss": 1.2642390596990785, "vf_explained_var": 0.9783003081878027, "kl": 0.010082354481824799, "entropy": 0.5998819598307212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.75, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6675, "policy_reward_min": {"prey_policy": -51.942108288600956, "predator_policy": 0.9797678367215006}, "policy_reward_max": {"prey_policy": -0.9797678367215006, "predator_policy": 51.942108288600956}, "policy_reward_mean": {"prey_policy": -27.441711682190935, "predator_policy": 27.441711682190935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [87, 71, 89, 81, 70, 55, 44, 39, 40, 73, 23, 87, 131, 52, 67, 63, 68, 61, 64, 97, 66, 47, 83, 59, 40, 40, 54, 111, 82, 86, 93, 62, 122, 31, 50, 32, 74, 64, 79, 76, 72, 34, 26, 70, 70, 109, 34, 41, 96, 64, 56, 88, 38, 65, 59, 61, 98, 78, 159, 33, 69, 53, 87, 56, 57, 87, 33, 54, 33, 50, 84, 89, 54, 43, 74, 73, 81, 136, 45, 63, 48, 74, 51, 66, 42, 90, 89, 29, 87, 77, 76, 66, 17, 48, 84, 69, 47, 82, 63, 85], "policy_prey_policy_reward": [-44.60416991113765, -25.420864917502627, -42.27942611481457, -38.94985768625177, -42.562612389305, -11.133749047581016, -10.39133282597252, -26.247209855445835, -17.894048635787318, -46.69182276960975, -11.432184727733178, -26.855391923738992, -20.26768245669674, -22.08784206222146, -40.22354591225912, -23.252934024483366, -21.90405532376515, -8.362971173247168, -34.36767558552806, -40.289611719184705, -31.55270455224558, -22.503976275605794, -43.9943599868585, -19.400902528472788, -32.554602424141315, -10.179734796035985, -29.328627639899445, -33.01776954673511, -40.95245022487432, -38.01976231738046, -43.83705766829028, -30.32303364619313, -33.167951039539744, -18.75996253886365, -28.18223429997959, -17.21468284846072, -47.00494700944043, -32.76485937305012, -23.062508531097944, -14.693418365565615, -6.389840734175125, -22.38243830040394, -5.277226128430789, -43.66042050825398, -29.305825948155857, -38.72335713747015, -25.923383433602133, -22.974102845320132, -21.83300701552942, -13.09890185514559, -15.911287491951574, -32.9050752013563, -17.657222058878293, -45.6384296284223, -22.564118262494933, -24.06721252081267, -46.1992526948103, -40.43234171996571, -48.20660009807641, -0.9797678367215006, -25.477013031010095, -23.937082649406054, -44.13774809000929, -15.322396326522023, -6.741188894072703, -42.06157497361625, -6.075553831459507, -16.12261465249057, -13.03733175900975, -23.349681211814627, -29.764501359090453, -48.510073939588466, -27.894238007202652, -26.644185912063634, -45.741431904376334, -17.333140031753654, -10.656606989543135, -48.68225042791729, -24.134913256658592, -20.341064736429615, -29.615024293991937, -20.162799565861697, -13.149475840076521, -20.512286169404913, -11.101138476481962, -30.984888848120413, -51.942108288600956, -12.920807210547066, -31.221318118551864, -22.472765442874906, -25.452306166496253, -37.12359734184308, -6.095948870692753, -34.261258342498515, -40.36491064046487, -44.035493831279325, -8.383809992279476, -46.14722303431702, -33.053928828760874, -39.34114083694071], "policy_predator_policy_reward": [44.60416991113765, 25.420864917502627, 42.27942611481457, 38.94985768625177, 42.562612389305, 11.133749047581016, 10.39133282597252, 26.247209855445835, 17.894048635787318, 46.69182276960975, 11.432184727733178, 26.855391923738992, 20.26768245669674, 22.08784206222146, 40.22354591225912, 23.252934024483366, 21.90405532376515, 8.362971173247168, 34.36767558552806, 40.289611719184705, 31.55270455224558, 22.503976275605794, 43.9943599868585, 19.400902528472788, 32.554602424141315, 10.179734796035985, 29.328627639899445, 33.01776954673511, 40.95245022487432, 38.01976231738046, 43.83705766829028, 30.32303364619313, 33.167951039539744, 18.75996253886365, 28.18223429997959, 17.21468284846072, 47.00494700944043, 32.76485937305012, 23.062508531097944, 14.693418365565615, 6.389840734175125, 22.38243830040394, 5.277226128430789, 43.66042050825398, 29.305825948155857, 38.72335713747015, 25.923383433602133, 22.974102845320132, 21.83300701552942, 13.09890185514559, 15.911287491951574, 32.9050752013563, 17.657222058878293, 45.6384296284223, 22.564118262494933, 24.06721252081267, 46.1992526948103, 40.43234171996571, 48.20660009807641, 0.9797678367215006, 25.477013031010095, 23.937082649406054, 44.13774809000929, 15.322396326522023, 6.741188894072703, 42.06157497361625, 6.075553831459507, 16.12261465249057, 13.03733175900975, 23.349681211814627, 29.764501359090453, 48.510073939588466, 27.894238007202652, 26.644185912063634, 45.741431904376334, 17.333140031753654, 10.656606989543135, 48.68225042791729, 24.134913256658592, 20.341064736429615, 29.615024293991937, 20.162799565861697, 13.149475840076521, 20.512286169404913, 11.101138476481962, 30.984888848120413, 51.942108288600956, 12.920807210547066, 31.221318118551864, 22.472765442874906, 25.452306166496253, 37.12359734184308, 6.095948870692753, 34.261258342498515, 40.36491064046487, 44.035493831279325, 8.383809992279476, 46.14722303431702, 33.053928828760874, 39.34114083694071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29282851450216574, "mean_inference_ms": 0.949216148162403, "mean_action_processing_ms": 0.1259767233958537, "mean_env_wait_ms": 0.06651347032473179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030891895294189453, "StateBufferConnector_ms": 0.0024799108505249023, "ViewRequirementAgentConnector_ms": 0.052200913429260254}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 587.7893648176315, "num_env_steps_trained_throughput_per_sec": 587.7893648176315, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 6042.607, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6042.529, "sample_time_ms": 773.891, "learn_time_ms": 5252.063, "learn_throughput": 761.605, "synch_weights_time_ms": 16.013}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 58, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-33", "timestamp": 1723390593, "time_this_iter_s": 6.814476013183594, "time_total_s": 337.9803397655487, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.9803397655487, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 36.31111111111111, "ram_util_percent": 83.04444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.079980310735603, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2146280511282384, "policy_loss": -0.0036314663613059867, "vf_loss": 1.2182591550673048, "vf_explained_var": 0.9768019100651145, "kl": 0.007509954360671855, "entropy": 0.41445910070712366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.108420073116819, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2610545462928713, "policy_loss": -0.003701484383782372, "vf_loss": 1.2646167693038781, "vf_explained_var": 0.9759609865024685, "kl": 0.005570430903017609, "entropy": 0.6361018783723315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.57, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6557, "policy_reward_min": {"prey_policy": -55.41087429116647, "predator_policy": 4.494736570939633}, "policy_reward_max": {"prey_policy": -4.494736570939633, "predator_policy": 55.41087429116647}, "policy_reward_mean": {"prey_policy": -25.43121543422326, "predator_policy": 25.43121543422326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [53, 87, 56, 57, 87, 33, 54, 33, 50, 84, 89, 54, 43, 74, 73, 81, 136, 45, 63, 48, 74, 51, 66, 42, 90, 89, 29, 87, 77, 76, 66, 17, 48, 84, 69, 47, 82, 63, 85, 67, 90, 29, 53, 65, 57, 36, 88, 53, 63, 60, 79, 92, 66, 63, 70, 73, 42, 40, 67, 112, 67, 42, 138, 84, 102, 46, 22, 15, 92, 70, 17, 80, 72, 13, 88, 61, 50, 81, 24, 18, 65, 56, 76, 76, 16, 86, 42, 166, 80, 17, 69, 99, 105, 71, 88, 75, 77, 80, 86, 38], "policy_prey_policy_reward": [-23.937082649406054, -44.13774809000929, -15.322396326522023, -6.741188894072703, -42.06157497361625, -6.075553831459507, -16.12261465249057, -13.03733175900975, -23.349681211814627, -29.764501359090453, -48.510073939588466, -27.894238007202652, -26.644185912063634, -45.741431904376334, -17.333140031753654, -10.656606989543135, -48.68225042791729, -24.134913256658592, -20.341064736429615, -29.615024293991937, -20.162799565861697, -13.149475840076521, -20.512286169404913, -11.101138476481962, -30.984888848120413, -51.942108288600956, -12.920807210547066, -31.221318118551864, -22.472765442874906, -25.452306166496253, -37.12359734184308, -6.095948870692753, -34.261258342498515, -40.36491064046487, -44.035493831279325, -8.383809992279476, -46.14722303431702, -33.053928828760874, -39.34114083694071, -31.649226424615648, -40.08897802570834, -15.427225365344135, -15.259165669717538, -18.610549392280312, -11.892935602179254, -11.488577584653518, -52.496166786245794, -9.667577194043433, -6.548427303971144, -11.991432394040173, -45.46130717960325, -21.904797133547728, -34.35912450347108, -10.231390919654396, -35.52349583984378, -21.008788208982917, -17.201428920137086, -18.006002935963753, -16.154931758576335, -17.00763554346284, -23.30231714227066, -18.032414825582165, -26.183355182210768, -26.357455407877303, -48.14840000891967, -12.979178360795675, -11.299777427739055, -7.250678417871175, -45.46209306904715, -37.71422163451498, -13.392514481943255, -51.92334269956872, -16.47113034552493, -5.741833749571599, -28.047877284361704, -28.558431122382217, -23.136364770828756, -55.41087429116647, -12.997595105757918, -4.66371873135188, -41.93806253312256, -26.432679647085955, -4.494736570939633, -17.091999676141835, -6.541586934060072, -39.654591836133854, -20.674719242678144, -39.35637672570645, -25.025798815955383, -4.970270841276126, -26.978814915050805, -45.04742033225908, -26.2699778889949, -43.07658754359326, -36.44945035226776, -41.88118653201211, -32.08647417339732, -26.344371280572968, -13.880684143012797, -17.043205599627594], "policy_predator_policy_reward": [23.937082649406054, 44.13774809000929, 15.322396326522023, 6.741188894072703, 42.06157497361625, 6.075553831459507, 16.12261465249057, 13.03733175900975, 23.349681211814627, 29.764501359090453, 48.510073939588466, 27.894238007202652, 26.644185912063634, 45.741431904376334, 17.333140031753654, 10.656606989543135, 48.68225042791729, 24.134913256658592, 20.341064736429615, 29.615024293991937, 20.162799565861697, 13.149475840076521, 20.512286169404913, 11.101138476481962, 30.984888848120413, 51.942108288600956, 12.920807210547066, 31.221318118551864, 22.472765442874906, 25.452306166496253, 37.12359734184308, 6.095948870692753, 34.261258342498515, 40.36491064046487, 44.035493831279325, 8.383809992279476, 46.14722303431702, 33.053928828760874, 39.34114083694071, 31.649226424615648, 40.08897802570834, 15.427225365344135, 15.259165669717538, 18.610549392280312, 11.892935602179254, 11.488577584653518, 52.496166786245794, 9.667577194043433, 6.548427303971144, 11.991432394040173, 45.46130717960325, 21.904797133547728, 34.35912450347108, 10.231390919654396, 35.52349583984378, 21.008788208982917, 17.201428920137086, 18.006002935963753, 16.154931758576335, 17.00763554346284, 23.30231714227066, 18.032414825582165, 26.183355182210768, 26.357455407877303, 48.14840000891967, 12.979178360795675, 11.299777427739055, 7.250678417871175, 45.46209306904715, 37.71422163451498, 13.392514481943255, 51.92334269956872, 16.47113034552493, 5.741833749571599, 28.047877284361704, 28.558431122382217, 23.136364770828756, 55.41087429116647, 12.997595105757918, 4.66371873135188, 41.93806253312256, 26.432679647085955, 4.494736570939633, 17.091999676141835, 6.541586934060072, 39.654591836133854, 20.674719242678144, 39.35637672570645, 25.025798815955383, 4.970270841276126, 26.978814915050805, 45.04742033225908, 26.2699778889949, 43.07658754359326, 36.44945035226776, 41.88118653201211, 32.08647417339732, 26.344371280572968, 13.880684143012797, 17.043205599627594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2929008223163063, "mean_inference_ms": 0.9598672359834441, "mean_action_processing_ms": 0.1257997884648897, "mean_env_wait_ms": 0.06645589347288762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002915501594543457, "StateBufferConnector_ms": 0.002106189727783203, "ViewRequirementAgentConnector_ms": 0.05392003059387207}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.4804696770764, "num_env_steps_trained_throughput_per_sec": 692.4804696770764, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 6026.145, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6026.071, "sample_time_ms": 768.189, "learn_time_ms": 5241.981, "learn_throughput": 763.07, "synch_weights_time_ms": 15.35}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "training_iteration": 59, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-39", "timestamp": 1723390599, "time_this_iter_s": 5.782214879989624, "time_total_s": 343.76255464553833, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 343.76255464553833, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 28.325, "ram_util_percent": 83.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9286947683120768, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4622233643506963, "policy_loss": -0.001125075257732533, "vf_loss": 1.463348148142298, "vf_explained_var": 0.9675203680371245, "kl": 0.006104997381774635, "entropy": 0.43358807104329267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.161092457175255, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4165458939348659, "policy_loss": -0.009204923544893972, "vf_loss": 1.4254323850696287, "vf_explained_var": 0.9700833442310492, "kl": 0.012737214018133968, "entropy": 0.6329997187480331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.18, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6818, "policy_reward_min": {"prey_policy": -55.41087429116647, "predator_policy": 3.9546184291620397}, "policy_reward_max": {"prey_policy": -3.9546184291620397, "predator_policy": 55.41087429116647}, "policy_reward_mean": {"prey_policy": -25.84253112132857, "predator_policy": 25.84253112132857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [112, 67, 42, 138, 84, 102, 46, 22, 15, 92, 70, 17, 80, 72, 13, 88, 61, 50, 81, 24, 18, 65, 56, 76, 76, 16, 86, 42, 166, 80, 17, 69, 99, 105, 71, 88, 75, 77, 80, 86, 38, 114, 44, 65, 46, 66, 86, 80, 115, 91, 85, 49, 88, 82, 67, 74, 61, 37, 59, 37, 59, 34, 74, 50, 86, 74, 83, 70, 79, 44, 91, 88, 67, 63, 142, 85, 57, 89, 31, 46, 60, 86, 57, 72, 61, 82, 80, 83, 36, 61, 82, 59, 70, 26, 71, 61, 59, 51, 79, 62], "policy_prey_policy_reward": [-17.00763554346284, -23.30231714227066, -18.032414825582165, -26.183355182210768, -26.357455407877303, -48.14840000891967, -12.979178360795675, -11.299777427739055, -7.250678417871175, -45.46209306904715, -37.71422163451498, -13.392514481943255, -51.92334269956872, -16.47113034552493, -5.741833749571599, -28.047877284361704, -28.558431122382217, -23.136364770828756, -55.41087429116647, -12.997595105757918, -4.66371873135188, -41.93806253312256, -26.432679647085955, -4.494736570939633, -17.091999676141835, -6.541586934060072, -39.654591836133854, -20.674719242678144, -39.35637672570645, -25.025798815955383, -4.970270841276126, -26.978814915050805, -45.04742033225908, -26.2699778889949, -43.07658754359326, -36.44945035226776, -41.88118653201211, -32.08647417339732, -26.344371280572968, -13.880684143012797, -17.043205599627594, -22.2359064888768, -12.181869067962896, -12.003812030554085, -5.391522338451729, -39.92874134163513, -30.42660053738061, -22.177002102231732, -44.31309579304063, -34.02903949214888, -25.572515888574642, -11.173184123438386, -17.410267697752815, -48.051303619434755, -38.43358657304371, -13.393975818883183, -3.9546184291620397, -11.09201951479909, -37.76008009824861, -8.697927841736497, -38.04947108067438, -11.732721584649092, -46.63609331486949, -25.106340229741104, -28.925900637335705, -26.099948854693086, -45.33233854623851, -26.42936939152591, -22.959351695570753, -24.152947536842795, -17.25066597252334, -40.773215169408985, -8.92823807526224, -12.604147794080482, -26.654853719975097, -36.96524467597861, -7.311730164422025, -49.877913772409094, -12.338018532883211, -19.454725307628394, -19.01150659099354, -39.93425472694561, -25.865930927319297, -25.782186138042814, -26.706983169809412, -26.000654053628484, -42.33676633689247, -32.01817152427664, -18.555130064054794, -38.47586469185427, -26.039412863797974, -38.35019705157605, -33.39114027809272, -15.881096601721975, -10.630294723334387, -25.414005233323063, -33.199411593236746, -36.706996458725285, -48.86184466956459, -5.960754394961075], "policy_predator_policy_reward": [17.00763554346284, 23.30231714227066, 18.032414825582165, 26.183355182210768, 26.357455407877303, 48.14840000891967, 12.979178360795675, 11.299777427739055, 7.250678417871175, 45.46209306904715, 37.71422163451498, 13.392514481943255, 51.92334269956872, 16.47113034552493, 5.741833749571599, 28.047877284361704, 28.558431122382217, 23.136364770828756, 55.41087429116647, 12.997595105757918, 4.66371873135188, 41.93806253312256, 26.432679647085955, 4.494736570939633, 17.091999676141835, 6.541586934060072, 39.654591836133854, 20.674719242678144, 39.35637672570645, 25.025798815955383, 4.970270841276126, 26.978814915050805, 45.04742033225908, 26.2699778889949, 43.07658754359326, 36.44945035226776, 41.88118653201211, 32.08647417339732, 26.344371280572968, 13.880684143012797, 17.043205599627594, 22.2359064888768, 12.181869067962896, 12.003812030554085, 5.391522338451729, 39.92874134163513, 30.42660053738061, 22.177002102231732, 44.31309579304063, 34.02903949214888, 25.572515888574642, 11.173184123438386, 17.410267697752815, 48.051303619434755, 38.43358657304371, 13.393975818883183, 3.9546184291620397, 11.09201951479909, 37.76008009824861, 8.697927841736497, 38.04947108067438, 11.732721584649092, 46.63609331486949, 25.106340229741104, 28.925900637335705, 26.099948854693086, 45.33233854623851, 26.42936939152591, 22.959351695570753, 24.152947536842795, 17.25066597252334, 40.773215169408985, 8.92823807526224, 12.604147794080482, 26.654853719975097, 36.96524467597861, 7.311730164422025, 49.877913772409094, 12.338018532883211, 19.454725307628394, 19.01150659099354, 39.93425472694561, 25.865930927319297, 25.782186138042814, 26.706983169809412, 26.000654053628484, 42.33676633689247, 32.01817152427664, 18.555130064054794, 38.47586469185427, 26.039412863797974, 38.35019705157605, 33.39114027809272, 15.881096601721975, 10.630294723334387, 25.414005233323063, 33.199411593236746, 36.706996458725285, 48.86184466956459, 5.960754394961075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29338572557164405, "mean_inference_ms": 0.9597037081659242, "mean_action_processing_ms": 0.12603363264431935, "mean_env_wait_ms": 0.06661814012280617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028998851776123047, "StateBufferConnector_ms": 0.0021570920944213867, "ViewRequirementAgentConnector_ms": 0.0521235466003418}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 667.2955983598032, "num_env_steps_trained_throughput_per_sec": 667.2955983598032, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 6040.46, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6040.386, "sample_time_ms": 768.404, "learn_time_ms": 5255.939, "learn_throughput": 761.044, "synch_weights_time_ms": 15.536}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 60, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-45", "timestamp": 1723390605, "time_this_iter_s": 6.000197887420654, "time_total_s": 349.762752532959, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 349.762752532959, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 26.744444444444444, "ram_util_percent": 83.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.04984642205139, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3319172053908308, "policy_loss": -0.004000475847472747, "vf_loss": 1.335917331216236, "vf_explained_var": 0.9715081519757708, "kl": 0.007202481831049312, "entropy": 0.42007390782237053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1517730887979267, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.338703223504126, "policy_loss": -0.005048632816275737, "vf_loss": 1.3435494048831365, "vf_explained_var": 0.9709454569344719, "kl": 0.008097989215597321, "entropy": 0.6454548535868525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.75, "episode_media": {}, "episodes_this_iter": 55, "episodes_timesteps_total": 6875, "policy_reward_min": {"prey_policy": -49.877913772409094, "predator_policy": 3.9546184291620397}, "policy_reward_max": {"prey_policy": -3.9546184291620397, "predator_policy": 49.877913772409094}, "policy_reward_mean": {"prey_policy": -25.65116015508043, "predator_policy": 25.65116015508043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [74, 61, 37, 59, 37, 59, 34, 74, 50, 86, 74, 83, 70, 79, 44, 91, 88, 67, 63, 142, 85, 57, 89, 31, 46, 60, 86, 57, 72, 61, 82, 80, 83, 36, 61, 82, 59, 70, 26, 71, 61, 59, 51, 79, 62, 53, 83, 95, 90, 80, 110, 63, 126, 75, 48, 85, 88, 48, 71, 60, 57, 69, 83, 75, 68, 50, 79, 74, 40, 44, 87, 95, 43, 98, 40, 88, 69, 86, 76, 65, 92, 91, 71, 67, 41, 70, 60, 58, 58, 71, 75, 90, 45, 56, 94, 44, 56, 72, 78, 47], "policy_prey_policy_reward": [-13.393975818883183, -3.9546184291620397, -11.09201951479909, -37.76008009824861, -8.697927841736497, -38.04947108067438, -11.732721584649092, -46.63609331486949, -25.106340229741104, -28.925900637335705, -26.099948854693086, -45.33233854623851, -26.42936939152591, -22.959351695570753, -24.152947536842795, -17.25066597252334, -40.773215169408985, -8.92823807526224, -12.604147794080482, -26.654853719975097, -36.96524467597861, -7.311730164422025, -49.877913772409094, -12.338018532883211, -19.454725307628394, -19.01150659099354, -39.93425472694561, -25.865930927319297, -25.782186138042814, -26.706983169809412, -26.000654053628484, -42.33676633689247, -32.01817152427664, -18.555130064054794, -38.47586469185427, -26.039412863797974, -38.35019705157605, -33.39114027809272, -15.881096601721975, -10.630294723334387, -25.414005233323063, -33.199411593236746, -36.706996458725285, -48.86184466956459, -5.960754394961075, -16.004335054057318, -35.448822693468685, -37.22861990426449, -8.236946757607045, -29.933876770183367, -31.620467648913426, -19.15858024389252, -29.320090202453077, -6.071440233378336, -10.610502978106895, -45.797986348840055, -37.41157245543711, -22.561528818367286, -41.95046611940752, -23.46237474643636, -15.396272491874836, -35.83084226192572, -29.618835226593454, -18.881901049104282, -16.62247526269597, -21.04010004408212, -26.717298980330575, -35.54985680240951, -13.30841162917469, -15.224573585765798, -10.746547917102083, -29.131706535275413, -7.146467228877442, -26.338167461521962, -25.316115037090487, -40.48575144925816, -23.82509829675437, -18.37120095200525, -38.82599740793233, -34.8491004337394, -35.70725148168726, -17.733966721755458, -48.14888662622185, -36.04203407164924, -28.131713611937666, -20.631366771269775, -28.815817512862342, -7.000210975621977, -36.97296175245745, -8.092184411181949, -43.2257305664809, -48.24322146265687, -18.007302189022504, -15.150109216411295, -27.305456012059324, -23.418354461477115, -13.479946425850237, -18.436984410478384, -20.315295551706754, -20.60843039523416], "policy_predator_policy_reward": [13.393975818883183, 3.9546184291620397, 11.09201951479909, 37.76008009824861, 8.697927841736497, 38.04947108067438, 11.732721584649092, 46.63609331486949, 25.106340229741104, 28.925900637335705, 26.099948854693086, 45.33233854623851, 26.42936939152591, 22.959351695570753, 24.152947536842795, 17.25066597252334, 40.773215169408985, 8.92823807526224, 12.604147794080482, 26.654853719975097, 36.96524467597861, 7.311730164422025, 49.877913772409094, 12.338018532883211, 19.454725307628394, 19.01150659099354, 39.93425472694561, 25.865930927319297, 25.782186138042814, 26.706983169809412, 26.000654053628484, 42.33676633689247, 32.01817152427664, 18.555130064054794, 38.47586469185427, 26.039412863797974, 38.35019705157605, 33.39114027809272, 15.881096601721975, 10.630294723334387, 25.414005233323063, 33.199411593236746, 36.706996458725285, 48.86184466956459, 5.960754394961075, 16.004335054057318, 35.448822693468685, 37.22861990426449, 8.236946757607045, 29.933876770183367, 31.620467648913426, 19.15858024389252, 29.320090202453077, 6.071440233378336, 10.610502978106895, 45.797986348840055, 37.41157245543711, 22.561528818367286, 41.95046611940752, 23.46237474643636, 15.396272491874836, 35.83084226192572, 29.618835226593454, 18.881901049104282, 16.62247526269597, 21.04010004408212, 26.717298980330575, 35.54985680240951, 13.30841162917469, 15.224573585765798, 10.746547917102083, 29.131706535275413, 7.146467228877442, 26.338167461521962, 25.316115037090487, 40.48575144925816, 23.82509829675437, 18.37120095200525, 38.82599740793233, 34.8491004337394, 35.70725148168726, 17.733966721755458, 48.14888662622185, 36.04203407164924, 28.131713611937666, 20.631366771269775, 28.815817512862342, 7.000210975621977, 36.97296175245745, 8.092184411181949, 43.2257305664809, 48.24322146265687, 18.007302189022504, 15.150109216411295, 27.305456012059324, 23.418354461477115, 13.479946425850237, 18.436984410478384, 20.315295551706754, 20.60843039523416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29366769999597614, "mean_inference_ms": 0.9583368470569333, "mean_action_processing_ms": 0.12608682575918068, "mean_env_wait_ms": 0.06677622160325523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029535293579101562, "StateBufferConnector_ms": 0.0021572113037109375, "ViewRequirementAgentConnector_ms": 0.047612547874450684}, "num_episodes": 55, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 682.3527000190505, "num_env_steps_trained_throughput_per_sec": 682.3527000190505, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 6032.451, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6032.377, "sample_time_ms": 760.956, "learn_time_ms": 5255.373, "learn_throughput": 761.126, "synch_weights_time_ms": 15.535}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "training_iteration": 61, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-51", "timestamp": 1723390611, "time_this_iter_s": 5.86764121055603, "time_total_s": 355.630393743515, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13b1790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 355.630393743515, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 27.05, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3378984426458675, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3396257334699233, "policy_loss": -0.0025289342209968407, "vf_loss": 1.3421543288975954, "vf_explained_var": 0.9748847344890237, "kl": 0.0070825874626100705, "entropy": 0.3829688391958674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3516989396264156, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3748951319605112, "policy_loss": -0.004091283898742404, "vf_loss": 1.3787987931941947, "vf_explained_var": 0.9740991892293096, "kl": 0.007504727708687045, "entropy": 0.5920085129638513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.89, "episode_media": {}, "episodes_this_iter": 55, "episodes_timesteps_total": 6989, "policy_reward_min": {"prey_policy": -55.50722560692208, "predator_policy": 3.067902072823739}, "policy_reward_max": {"prey_policy": -3.067902072823739, "predator_policy": 55.50722560692208}, "policy_reward_mean": {"prey_policy": -26.4814616717758, "predator_policy": 26.4814616717758}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [85, 88, 48, 71, 60, 57, 69, 83, 75, 68, 50, 79, 74, 40, 44, 87, 95, 43, 98, 40, 88, 69, 86, 76, 65, 92, 91, 71, 67, 41, 70, 60, 58, 58, 71, 75, 90, 45, 56, 94, 44, 56, 72, 78, 47, 171, 45, 84, 160, 87, 83, 64, 4, 75, 110, 83, 89, 37, 88, 57, 79, 71, 78, 24, 49, 42, 70, 76, 87, 71, 58, 61, 72, 102, 48, 30, 36, 26, 86, 61, 63, 76, 59, 84, 57, 64, 79, 92, 69, 67, 60, 94, 70, 62, 77, 89, 83, 97, 45, 64], "policy_prey_policy_reward": [-45.797986348840055, -37.41157245543711, -22.561528818367286, -41.95046611940752, -23.46237474643636, -15.396272491874836, -35.83084226192572, -29.618835226593454, -18.881901049104282, -16.62247526269597, -21.04010004408212, -26.717298980330575, -35.54985680240951, -13.30841162917469, -15.224573585765798, -10.746547917102083, -29.131706535275413, -7.146467228877442, -26.338167461521962, -25.316115037090487, -40.48575144925816, -23.82509829675437, -18.37120095200525, -38.82599740793233, -34.8491004337394, -35.70725148168726, -17.733966721755458, -48.14888662622185, -36.04203407164924, -28.131713611937666, -20.631366771269775, -28.815817512862342, -7.000210975621977, -36.97296175245745, -8.092184411181949, -43.2257305664809, -48.24322146265687, -18.007302189022504, -15.150109216411295, -27.305456012059324, -23.418354461477115, -13.479946425850237, -18.436984410478384, -20.315295551706754, -20.60843039523416, -48.20385497607414, -27.48386480838485, -30.993628286096712, -31.239529985175647, -34.0344448593714, -28.49317509765637, -38.92913214957023, -3.067902072823739, -7.578587589751263, -31.065523031042513, -21.045672400648236, -44.177481123061504, -13.624870642899854, -46.49900583024695, -25.19405058145086, -33.212454897353844, -17.05975789405629, -40.99517370086697, -10.972955708235823, -7.872960639374176, -4.528596119703753, -34.73790327125722, -17.46963591883513, -36.232127379766084, -18.49267392391769, -26.207236016619735, -23.116567432237794, -25.667484140510748, -24.784716109848, -21.5643791806634, -10.915871883727544, -7.207536978022003, -10.341120263314739, -55.50722560692208, -17.613058411088264, -40.195641009166096, -25.13042999786344, -30.33658771596906, -34.105355392396234, -31.0806875778927, -25.609068425079304, -31.14788507478446, -54.49725294069834, -36.189409449134196, -18.97746879971458, -19.404250279912855, -18.633334336948998, -34.171017493760104, -37.98786292138395, -30.988849806338585, -21.77737781699834, -29.556537956636046, -25.911023134033197, -22.275004163903017, -34.163090804366355], "policy_predator_policy_reward": [45.797986348840055, 37.41157245543711, 22.561528818367286, 41.95046611940752, 23.46237474643636, 15.396272491874836, 35.83084226192572, 29.618835226593454, 18.881901049104282, 16.62247526269597, 21.04010004408212, 26.717298980330575, 35.54985680240951, 13.30841162917469, 15.224573585765798, 10.746547917102083, 29.131706535275413, 7.146467228877442, 26.338167461521962, 25.316115037090487, 40.48575144925816, 23.82509829675437, 18.37120095200525, 38.82599740793233, 34.8491004337394, 35.70725148168726, 17.733966721755458, 48.14888662622185, 36.04203407164924, 28.131713611937666, 20.631366771269775, 28.815817512862342, 7.000210975621977, 36.97296175245745, 8.092184411181949, 43.2257305664809, 48.24322146265687, 18.007302189022504, 15.150109216411295, 27.305456012059324, 23.418354461477115, 13.479946425850237, 18.436984410478384, 20.315295551706754, 20.60843039523416, 48.20385497607414, 27.48386480838485, 30.993628286096712, 31.239529985175647, 34.0344448593714, 28.49317509765637, 38.92913214957023, 3.067902072823739, 7.578587589751263, 31.065523031042513, 21.045672400648236, 44.177481123061504, 13.624870642899854, 46.49900583024695, 25.19405058145086, 33.212454897353844, 17.05975789405629, 40.99517370086697, 10.972955708235823, 7.872960639374176, 4.528596119703753, 34.73790327125722, 17.46963591883513, 36.232127379766084, 18.49267392391769, 26.207236016619735, 23.116567432237794, 25.667484140510748, 24.784716109848, 21.5643791806634, 10.915871883727544, 7.207536978022003, 10.341120263314739, 55.50722560692208, 17.613058411088264, 40.195641009166096, 25.13042999786344, 30.33658771596906, 34.105355392396234, 31.0806875778927, 25.609068425079304, 31.14788507478446, 54.49725294069834, 36.189409449134196, 18.97746879971458, 19.404250279912855, 18.633334336948998, 34.171017493760104, 37.98786292138395, 30.988849806338585, 21.77737781699834, 29.556537956636046, 25.911023134033197, 22.275004163903017, 34.163090804366355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29302966172352507, "mean_inference_ms": 0.9561044549593675, "mean_action_processing_ms": 0.125663363041493, "mean_env_wait_ms": 0.06654573042009687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028090476989746094, "StateBufferConnector_ms": 0.0020639896392822266, "ViewRequirementAgentConnector_ms": 0.046741366386413574}, "num_episodes": 55, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 658.9511292125375, "num_env_steps_trained_throughput_per_sec": 658.9511292125375, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 6049.446, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6049.371, "sample_time_ms": 757.157, "learn_time_ms": 5276.236, "learn_throughput": 758.116, "synch_weights_time_ms": 15.467}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 62, "trial_id": "abfb9_00000", "date": "2024-08-11_11-36-57", "timestamp": 1723390617, "time_this_iter_s": 6.075599193572998, "time_total_s": 361.705992937088, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1328040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 361.705992937088, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 29.488888888888887, "ram_util_percent": 83.17777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0663458653415243, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4389298266110322, "policy_loss": -0.0008188290574859517, "vf_loss": 1.439748425098757, "vf_explained_var": 0.9724509057278434, "kl": 0.004802086418674409, "entropy": 0.4203187785732249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3439143054187297, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4642394541452328, "policy_loss": -0.005882262771532017, "vf_loss": 1.4699420876801015, "vf_explained_var": 0.9715014899770419, "kl": 0.007185139350574286, "entropy": 0.5948896638428172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.94, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6894, "policy_reward_min": {"prey_policy": -55.50722560692208, "predator_policy": 1.2471734354934285}, "policy_reward_max": {"prey_policy": -1.2471734354934285, "predator_policy": 55.50722560692208}, "policy_reward_mean": {"prey_policy": -25.082607427001204, "predator_policy": 25.082607427001204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [57, 79, 71, 78, 24, 49, 42, 70, 76, 87, 71, 58, 61, 72, 102, 48, 30, 36, 26, 86, 61, 63, 76, 59, 84, 57, 64, 79, 92, 69, 67, 60, 94, 70, 62, 77, 89, 83, 97, 45, 64, 97, 131, 49, 39, 57, 67, 91, 94, 58, 88, 27, 59, 82, 76, 49, 27, 41, 95, 51, 64, 57, 85, 64, 50, 64, 138, 83, 46, 48, 100, 13, 76, 66, 129, 77, 118, 76, 81, 51, 142, 86, 97, 80, 50, 73, 58, 61, 69, 67, 91, 85, 25, 64, 49, 54, 59, 57, 87, 41], "policy_prey_policy_reward": [-25.19405058145086, -33.212454897353844, -17.05975789405629, -40.99517370086697, -10.972955708235823, -7.872960639374176, -4.528596119703753, -34.73790327125722, -17.46963591883513, -36.232127379766084, -18.49267392391769, -26.207236016619735, -23.116567432237794, -25.667484140510748, -24.784716109848, -21.5643791806634, -10.915871883727544, -7.207536978022003, -10.341120263314739, -55.50722560692208, -17.613058411088264, -40.195641009166096, -25.13042999786344, -30.33658771596906, -34.105355392396234, -31.0806875778927, -25.609068425079304, -31.14788507478446, -54.49725294069834, -36.189409449134196, -18.97746879971458, -19.404250279912855, -18.633334336948998, -34.171017493760104, -37.98786292138395, -30.988849806338585, -21.77737781699834, -29.556537956636046, -25.911023134033197, -22.275004163903017, -34.163090804366355, -29.28567334680808, -47.843602258935434, -16.545650827397687, -1.2471734354934285, -40.76116137594956, -22.345493843824517, -36.08270188775622, -30.60036917436155, -28.719733982344426, -30.12457520561894, -4.952715308986512, -16.94046023216341, -40.2764676344253, -14.125184542895767, -31.404586095419226, -3.748547263220443, -14.673395996214706, -24.992813438722585, -20.088954748398685, -21.348176111356484, -10.849691101844352, -41.43432157725977, -23.86534298454552, -22.4767641207427, -14.905996802281795, -53.28349159816218, -34.09299276123514, -19.86298381188145, -10.499271289666611, -7.793908073895212, -9.635983182430296, -27.864302364986067, -41.525043089686335, -16.56432062502521, -29.31461023295435, -42.22495517941621, -28.74618657871388, -18.98683734332196, -16.902238764620613, -39.38412853716634, -37.5471857969261, -20.764735738420093, -13.293946861596165, -6.374729456792095, -47.037397741264, -29.99762605871576, -27.407621946115, -37.03501614073681, -14.753128580017933, -31.695062119151473, -16.47714509060814, -4.625763289438461, -37.619256136974336, -13.490876759356718, -15.955353300343956, -30.601744961518687, -33.73553875586853, -8.927680846598879, -22.768505234796073], "policy_predator_policy_reward": [25.19405058145086, 33.212454897353844, 17.05975789405629, 40.99517370086697, 10.972955708235823, 7.872960639374176, 4.528596119703753, 34.73790327125722, 17.46963591883513, 36.232127379766084, 18.49267392391769, 26.207236016619735, 23.116567432237794, 25.667484140510748, 24.784716109848, 21.5643791806634, 10.915871883727544, 7.207536978022003, 10.341120263314739, 55.50722560692208, 17.613058411088264, 40.195641009166096, 25.13042999786344, 30.33658771596906, 34.105355392396234, 31.0806875778927, 25.609068425079304, 31.14788507478446, 54.49725294069834, 36.189409449134196, 18.97746879971458, 19.404250279912855, 18.633334336948998, 34.171017493760104, 37.98786292138395, 30.988849806338585, 21.77737781699834, 29.556537956636046, 25.911023134033197, 22.275004163903017, 34.163090804366355, 29.28567334680808, 47.843602258935434, 16.545650827397687, 1.2471734354934285, 40.76116137594956, 22.345493843824517, 36.08270188775622, 30.60036917436155, 28.719733982344426, 30.12457520561894, 4.952715308986512, 16.94046023216341, 40.2764676344253, 14.125184542895767, 31.404586095419226, 3.748547263220443, 14.673395996214706, 24.992813438722585, 20.088954748398685, 21.348176111356484, 10.849691101844352, 41.43432157725977, 23.86534298454552, 22.4767641207427, 14.905996802281795, 53.28349159816218, 34.09299276123514, 19.86298381188145, 10.499271289666611, 7.793908073895212, 9.635983182430296, 27.864302364986067, 41.525043089686335, 16.56432062502521, 29.31461023295435, 42.22495517941621, 28.74618657871388, 18.98683734332196, 16.902238764620613, 39.38412853716634, 37.5471857969261, 20.764735738420093, 13.293946861596165, 6.374729456792095, 47.037397741264, 29.99762605871576, 27.407621946115, 37.03501614073681, 14.753128580017933, 31.695062119151473, 16.47714509060814, 4.625763289438461, 37.619256136974336, 13.490876759356718, 15.955353300343956, 30.601744961518687, 33.73553875586853, 8.927680846598879, 22.768505234796073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2928713917719171, "mean_inference_ms": 0.9544615915865461, "mean_action_processing_ms": 0.12559530255064932, "mean_env_wait_ms": 0.06643876496575801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002596616744995117, "StateBufferConnector_ms": 0.0019600391387939453, "ViewRequirementAgentConnector_ms": 0.046405792236328125}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 679.8101418490265, "num_env_steps_trained_throughput_per_sec": 679.8101418490265, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 6037.983, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6037.909, "sample_time_ms": 756.258, "learn_time_ms": 5265.585, "learn_throughput": 759.65, "synch_weights_time_ms": 15.558}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 63, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-03", "timestamp": 1723390623, "time_this_iter_s": 5.889162063598633, "time_total_s": 367.59515500068665, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b12ae9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 367.59515500068665, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 27.849999999999998, "ram_util_percent": 83.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9577886555343866, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1778942638076841, "policy_loss": -0.003448070269466067, "vf_loss": 1.1813421766584118, "vf_explained_var": 0.9747469002380967, "kl": 0.006760232635843363, "entropy": 0.42329351358736556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0514977620293697, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2328439546128114, "policy_loss": -0.00596862837652831, "vf_loss": 1.238590122324725, "vf_explained_var": 0.9725871303429207, "kl": 0.008898463649611133, "entropy": 0.596518796371917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.1, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6810, "policy_reward_min": {"prey_policy": -53.776778317177865, "predator_policy": 1.289951491786393}, "policy_reward_max": {"prey_policy": -1.289951491786393, "predator_policy": 53.776778317177865}, "policy_reward_mean": {"prey_policy": -24.84841183561891, "predator_policy": 24.84841183561891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [85, 64, 50, 64, 138, 83, 46, 48, 100, 13, 76, 66, 129, 77, 118, 76, 81, 51, 142, 86, 97, 80, 50, 73, 58, 61, 69, 67, 91, 85, 25, 64, 49, 54, 59, 57, 87, 41, 95, 73, 95, 60, 61, 73, 41, 57, 44, 90, 67, 75, 83, 71, 60, 69, 70, 68, 74, 21, 46, 46, 15, 79, 86, 75, 61, 56, 3, 77, 61, 71, 74, 26, 73, 94, 48, 122, 74, 25, 60, 84, 127, 61, 81, 39, 71, 45, 37, 70, 16, 77, 95, 54, 59, 68, 81, 81, 70, 83, 72, 60], "policy_prey_policy_reward": [-41.43432157725977, -23.86534298454552, -22.4767641207427, -14.905996802281795, -53.28349159816218, -34.09299276123514, -19.86298381188145, -10.499271289666611, -7.793908073895212, -9.635983182430296, -27.864302364986067, -41.525043089686335, -16.56432062502521, -29.31461023295435, -42.22495517941621, -28.74618657871388, -18.98683734332196, -16.902238764620613, -39.38412853716634, -37.5471857969261, -20.764735738420093, -13.293946861596165, -6.374729456792095, -47.037397741264, -29.99762605871576, -27.407621946115, -37.03501614073681, -14.753128580017933, -31.695062119151473, -16.47714509060814, -4.625763289438461, -37.619256136974336, -13.490876759356718, -15.955353300343956, -30.601744961518687, -33.73553875586853, -8.927680846598879, -22.768505234796073, -32.38185723855844, -31.08283857151974, -31.42742870001248, -36.74988657371664, -28.12364836809985, -27.57027089487334, -8.75098695076068, -32.625019285335, -15.952178594416226, -20.379153194989847, -41.420921711200585, -28.12742739062184, -18.24117187656962, -14.487951897100123, -24.482942310731737, -31.07523027499516, -44.280577820748285, -28.210706545121, -21.588583609830604, -10.909343982463362, -27.866135002793573, -24.565323704169867, -7.982272980065856, -27.817368137192968, -26.177640405375502, -28.745620090731336, -22.125228757169474, -30.22415992387319, -1.289951491786393, -37.23922395223033, -15.515851898638934, -43.30091480039379, -43.40557014324564, -18.294166636113598, -30.550893085668257, -42.594959546620565, -6.298579017453703, -23.160231408399483, -24.576142685790355, -3.750790996860035, -17.279526622863514, -28.994642161624327, -40.407919813254644, -14.605659280151258, -53.776778317177865, -21.51500391231564, -27.102660342086917, -24.540757762298785, -1.7256417962586732, -37.991456621666245, -10.525700484016761, -28.9164222123461, -20.507769927028022, -23.181823364139394, -23.480730121016684, -12.372423945939904, -35.470875838664824, -44.39520043787625, -7.7693274289961956, -7.792855038129639, -22.92838330539611, -16.738480639175336], "policy_predator_policy_reward": [41.43432157725977, 23.86534298454552, 22.4767641207427, 14.905996802281795, 53.28349159816218, 34.09299276123514, 19.86298381188145, 10.499271289666611, 7.793908073895212, 9.635983182430296, 27.864302364986067, 41.525043089686335, 16.56432062502521, 29.31461023295435, 42.22495517941621, 28.74618657871388, 18.98683734332196, 16.902238764620613, 39.38412853716634, 37.5471857969261, 20.764735738420093, 13.293946861596165, 6.374729456792095, 47.037397741264, 29.99762605871576, 27.407621946115, 37.03501614073681, 14.753128580017933, 31.695062119151473, 16.47714509060814, 4.625763289438461, 37.619256136974336, 13.490876759356718, 15.955353300343956, 30.601744961518687, 33.73553875586853, 8.927680846598879, 22.768505234796073, 32.38185723855844, 31.08283857151974, 31.42742870001248, 36.74988657371664, 28.12364836809985, 27.57027089487334, 8.75098695076068, 32.625019285335, 15.952178594416226, 20.379153194989847, 41.420921711200585, 28.12742739062184, 18.24117187656962, 14.487951897100123, 24.482942310731737, 31.07523027499516, 44.280577820748285, 28.210706545121, 21.588583609830604, 10.909343982463362, 27.866135002793573, 24.565323704169867, 7.982272980065856, 27.817368137192968, 26.177640405375502, 28.745620090731336, 22.125228757169474, 30.22415992387319, 1.289951491786393, 37.23922395223033, 15.515851898638934, 43.30091480039379, 43.40557014324564, 18.294166636113598, 30.550893085668257, 42.594959546620565, 6.298579017453703, 23.160231408399483, 24.576142685790355, 3.750790996860035, 17.279526622863514, 28.994642161624327, 40.407919813254644, 14.605659280151258, 53.776778317177865, 21.51500391231564, 27.102660342086917, 24.540757762298785, 1.7256417962586732, 37.991456621666245, 10.525700484016761, 28.9164222123461, 20.507769927028022, 23.181823364139394, 23.480730121016684, 12.372423945939904, 35.470875838664824, 44.39520043787625, 7.7693274289961956, 7.792855038129639, 22.92838330539611, 16.738480639175336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2925061387308114, "mean_inference_ms": 0.9530841452911802, "mean_action_processing_ms": 0.12550649378226228, "mean_env_wait_ms": 0.06629722994202158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026949644088745117, "StateBufferConnector_ms": 0.0019495487213134766, "ViewRequirementAgentConnector_ms": 0.045743703842163086}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.2519735033932, "num_env_steps_trained_throughput_per_sec": 692.2519735033932, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 6034.035, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6033.961, "sample_time_ms": 750.437, "learn_time_ms": 5267.367, "learn_throughput": 759.393, "synch_weights_time_ms": 15.651}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 64, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-08", "timestamp": 1723390628, "time_this_iter_s": 5.783900022506714, "time_total_s": 373.37905502319336, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a0310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 373.37905502319336, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 27.125, "ram_util_percent": 83.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9418938257421057, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2411064109299332, "policy_loss": -0.0021761912466899958, "vf_loss": 1.2432824793582162, "vf_explained_var": 0.9756986356029907, "kl": 0.005290343903188891, "entropy": 0.4308293272120257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0338349234312774, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.172663027482728, "policy_loss": -0.009076045767142205, "vf_loss": 1.1814815016152957, "vf_explained_var": 0.9769262682025631, "kl": 0.010302800777736716, "entropy": 0.617093296845754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.74, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6174, "policy_reward_min": {"prey_policy": -57.75913322149584, "predator_policy": 0.5246401891734153}, "policy_reward_max": {"prey_policy": -0.5246401891734153, "predator_policy": 57.75913322149584}, "policy_reward_mean": {"prey_policy": -24.04470021360576, "predator_policy": 24.04470021360576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [56, 3, 77, 61, 71, 74, 26, 73, 94, 48, 122, 74, 25, 60, 84, 127, 61, 81, 39, 71, 45, 37, 70, 16, 77, 95, 54, 59, 68, 81, 81, 70, 83, 72, 60, 52, 67, 55, 24, 107, 55, 53, 19, 62, 44, 110, 73, 58, 32, 82, 85, 39, 32, 1, 96, 56, 79, 44, 40, 36, 85, 73, 82, 77, 74, 53, 83, 89, 50, 55, 67, 38, 84, 34, 63, 32, 53, 58, 60, 89, 3, 41, 86, 135, 55, 66, 58, 64, 20, 75, 51, 44, 85, 79, 30, 62, 92, 88, 42, 3], "policy_prey_policy_reward": [-30.22415992387319, -1.289951491786393, -37.23922395223033, -15.515851898638934, -43.30091480039379, -43.40557014324564, -18.294166636113598, -30.550893085668257, -42.594959546620565, -6.298579017453703, -23.160231408399483, -24.576142685790355, -3.750790996860035, -17.279526622863514, -28.994642161624327, -40.407919813254644, -14.605659280151258, -53.776778317177865, -21.51500391231564, -27.102660342086917, -24.540757762298785, -1.7256417962586732, -37.991456621666245, -10.525700484016761, -28.9164222123461, -20.507769927028022, -23.181823364139394, -23.480730121016684, -12.372423945939904, -35.470875838664824, -44.39520043787625, -7.7693274289961956, -7.792855038129639, -22.92838330539611, -16.738480639175336, -0.5246401891734153, -40.53552343129024, -15.41175050655801, -8.329803955860033, -46.7010373331557, -36.58925882225412, -31.047166975153402, -4.244546494015734, -11.099586349004248, -20.71335286743436, -45.93792569673506, -40.01425341395145, -11.91352644497681, -13.612680677819325, -24.32139128642362, -57.75913322149584, -12.78899852602811, -12.716333954656383, -0.7127334549517413, -24.15721690375583, -19.419698910965597, -34.75858184680604, -14.569143170187361, -31.07843242031196, -11.481459580431126, -22.58388646824769, -24.974922647581295, -46.16431360246205, -29.46140481263883, -26.43874748678335, -18.236715556047887, -37.37974679968179, -29.88666420686268, -6.257355899370973, -7.41459652160813, -46.09848129410627, -30.489700309625174, -31.493140497609478, -11.160294789779098, -32.864211847677495, -28.92756482822853, -20.579892316908847, -19.745234211510372, -7.33906687386771, -24.071853169316917, -2.0867800562807464, -13.812250004952718, -52.385292433737774, -40.4415457340861, -33.88924950599089, -17.095899968524325, -29.23685345893497, -20.858658856332845, -9.289861237808843, -31.658484317870286, -20.17348637134808, -24.71873984910734, -41.47848852931816, -36.14969414447734, -15.421447824219912, -14.542007940345423, -26.66437092222507, -50.851056009983964, -6.344196865152114, -3.1442117970716903], "policy_predator_policy_reward": [30.22415992387319, 1.289951491786393, 37.23922395223033, 15.515851898638934, 43.30091480039379, 43.40557014324564, 18.294166636113598, 30.550893085668257, 42.594959546620565, 6.298579017453703, 23.160231408399483, 24.576142685790355, 3.750790996860035, 17.279526622863514, 28.994642161624327, 40.407919813254644, 14.605659280151258, 53.776778317177865, 21.51500391231564, 27.102660342086917, 24.540757762298785, 1.7256417962586732, 37.991456621666245, 10.525700484016761, 28.9164222123461, 20.507769927028022, 23.181823364139394, 23.480730121016684, 12.372423945939904, 35.470875838664824, 44.39520043787625, 7.7693274289961956, 7.792855038129639, 22.92838330539611, 16.738480639175336, 0.5246401891734153, 40.53552343129024, 15.41175050655801, 8.329803955860033, 46.7010373331557, 36.58925882225412, 31.047166975153402, 4.244546494015734, 11.099586349004248, 20.71335286743436, 45.93792569673506, 40.01425341395145, 11.91352644497681, 13.612680677819325, 24.32139128642362, 57.75913322149584, 12.78899852602811, 12.716333954656383, 0.7127334549517413, 24.15721690375583, 19.419698910965597, 34.75858184680604, 14.569143170187361, 31.07843242031196, 11.481459580431126, 22.58388646824769, 24.974922647581295, 46.16431360246205, 29.46140481263883, 26.43874748678335, 18.236715556047887, 37.37974679968179, 29.88666420686268, 6.257355899370973, 7.41459652160813, 46.09848129410627, 30.489700309625174, 31.493140497609478, 11.160294789779098, 32.864211847677495, 28.92756482822853, 20.579892316908847, 19.745234211510372, 7.33906687386771, 24.071853169316917, 2.0867800562807464, 13.812250004952718, 52.385292433737774, 40.4415457340861, 33.88924950599089, 17.095899968524325, 29.23685345893497, 20.858658856332845, 9.289861237808843, 31.658484317870286, 20.17348637134808, 24.71873984910734, 41.47848852931816, 36.14969414447734, 15.421447824219912, 14.542007940345423, 26.66437092222507, 50.851056009983964, 6.344196865152114, 3.1442117970716903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921506260242688, "mean_inference_ms": 0.9505073640263041, "mean_action_processing_ms": 0.12527851472815588, "mean_env_wait_ms": 0.0661115797693342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002911806106567383, "StateBufferConnector_ms": 0.002026081085205078, "ViewRequirementAgentConnector_ms": 0.0470118522644043}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 658.3726205278858, "num_env_steps_trained_throughput_per_sec": 658.3726205278858, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 6032.329, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6032.254, "sample_time_ms": 765.635, "learn_time_ms": 5250.476, "learn_throughput": 761.836, "synch_weights_time_ms": 15.695}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 65, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-15", "timestamp": 1723390635, "time_this_iter_s": 6.080590009689331, "time_total_s": 379.4596450328827, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 379.4596450328827, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 25.81111111111111, "ram_util_percent": 82.98888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.869296389942368, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1720854414006074, "policy_loss": -0.0026730245323657678, "vf_loss": 1.1747583330919344, "vf_explained_var": 0.980657314384977, "kl": 0.005626863884843073, "entropy": 0.3738586053562661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1096081449339787, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1516678160677354, "policy_loss": -0.00911797316390827, "vf_loss": 1.1605310233930746, "vf_explained_var": 0.9817006170749665, "kl": 0.010190548838688623, "entropy": 0.5815349020063877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.15, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6315, "policy_reward_min": {"prey_policy": -52.385292433737774, "predator_policy": 2.0867800562807464}, "policy_reward_max": {"prey_policy": -2.0867800562807464, "predator_policy": 52.385292433737774}, "policy_reward_mean": {"prey_policy": -23.859622133202834, "predator_policy": 23.859622133202834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [82, 77, 74, 53, 83, 89, 50, 55, 67, 38, 84, 34, 63, 32, 53, 58, 60, 89, 3, 41, 86, 135, 55, 66, 58, 64, 20, 75, 51, 44, 85, 79, 30, 62, 92, 88, 42, 3, 64, 36, 33, 70, 52, 41, 63, 23, 70, 65, 122, 70, 29, 59, 60, 69, 37, 74, 90, 34, 73, 63, 72, 60, 56, 116, 133, 60, 64, 96, 50, 51, 80, 64, 52, 59, 62, 45, 69, 67, 53, 50, 78, 47, 83, 93, 54, 85, 24, 43, 76, 50, 75, 76, 48, 134, 52, 36, 104, 98, 66, 17], "policy_prey_policy_reward": [-46.16431360246205, -29.46140481263883, -26.43874748678335, -18.236715556047887, -37.37974679968179, -29.88666420686268, -6.257355899370973, -7.41459652160813, -46.09848129410627, -30.489700309625174, -31.493140497609478, -11.160294789779098, -32.864211847677495, -28.92756482822853, -20.579892316908847, -19.745234211510372, -7.33906687386771, -24.071853169316917, -2.0867800562807464, -13.812250004952718, -52.385292433737774, -40.4415457340861, -33.88924950599089, -17.095899968524325, -29.23685345893497, -20.858658856332845, -9.289861237808843, -31.658484317870286, -20.17348637134808, -24.71873984910734, -41.47848852931816, -36.14969414447734, -15.421447824219912, -14.542007940345423, -26.66437092222507, -50.851056009983964, -6.344196865152114, -3.1442117970716903, -18.33174675591533, -15.864182321998923, -22.919792578295954, -28.488839679527096, -18.940576549638905, -11.731759528621428, -29.816656388782803, -11.186539033167263, -33.173807907072806, -5.511560046555906, -14.359647365973558, -22.564820749462417, -19.567739818180097, -42.29865494079063, -21.216136478014906, -41.420810541863766, -21.003571708572288, -18.922837365842025, -40.79459668713973, -26.82196030514445, -39.38208232186409, -9.678160336264417, -27.165461372345163, -13.934348758606678, -33.2038886775721, -8.618817493487832, -34.02756012190444, -11.147086630213945, -26.23687669144124, -48.15890235227928, -5.036231881552024, -6.021258801550247, -47.56718243059974, -10.597687330149114, -13.89733077950571, -17.419702300950995, -17.481876294257777, -12.435029815719805, -30.914125959715477, -7.881515905466992, -20.93464203054931, -21.33561226910122, -33.526951610467194, -16.444086911052352, -44.55246692082444, -17.059522020133784, -24.830026954782664, -9.687264557123548, -5.48515226249795, -20.635822981598583, -17.04956179419051, -31.159305085615248, -45.995469540278854, -30.25302118546667, -25.144691932691156, -40.55415135647578, -34.049459577720214, -16.928117045645426, -33.929078133792416, -15.584628098695834, -47.69160240490956, -3.1386547888091627], "policy_predator_policy_reward": [46.16431360246205, 29.46140481263883, 26.43874748678335, 18.236715556047887, 37.37974679968179, 29.88666420686268, 6.257355899370973, 7.41459652160813, 46.09848129410627, 30.489700309625174, 31.493140497609478, 11.160294789779098, 32.864211847677495, 28.92756482822853, 20.579892316908847, 19.745234211510372, 7.33906687386771, 24.071853169316917, 2.0867800562807464, 13.812250004952718, 52.385292433737774, 40.4415457340861, 33.88924950599089, 17.095899968524325, 29.23685345893497, 20.858658856332845, 9.289861237808843, 31.658484317870286, 20.17348637134808, 24.71873984910734, 41.47848852931816, 36.14969414447734, 15.421447824219912, 14.542007940345423, 26.66437092222507, 50.851056009983964, 6.344196865152114, 3.1442117970716903, 18.33174675591533, 15.864182321998923, 22.919792578295954, 28.488839679527096, 18.940576549638905, 11.731759528621428, 29.816656388782803, 11.186539033167263, 33.173807907072806, 5.511560046555906, 14.359647365973558, 22.564820749462417, 19.567739818180097, 42.29865494079063, 21.216136478014906, 41.420810541863766, 21.003571708572288, 18.922837365842025, 40.79459668713973, 26.82196030514445, 39.38208232186409, 9.678160336264417, 27.165461372345163, 13.934348758606678, 33.2038886775721, 8.618817493487832, 34.02756012190444, 11.147086630213945, 26.23687669144124, 48.15890235227928, 5.036231881552024, 6.021258801550247, 47.56718243059974, 10.597687330149114, 13.89733077950571, 17.419702300950995, 17.481876294257777, 12.435029815719805, 30.914125959715477, 7.881515905466992, 20.93464203054931, 21.33561226910122, 33.526951610467194, 16.444086911052352, 44.55246692082444, 17.059522020133784, 24.830026954782664, 9.687264557123548, 5.48515226249795, 20.635822981598583, 17.04956179419051, 31.159305085615248, 45.995469540278854, 30.25302118546667, 25.144691932691156, 40.55415135647578, 34.049459577720214, 16.928117045645426, 33.929078133792416, 15.584628098695834, 47.69160240490956, 3.1386547888091627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918485572327083, "mean_inference_ms": 0.9495556654901517, "mean_action_processing_ms": 0.12507619706096235, "mean_env_wait_ms": 0.06595183687240419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034285783767700195, "StateBufferConnector_ms": 0.0019335746765136719, "ViewRequirementAgentConnector_ms": 0.04698336124420166}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 690.6621148405187, "num_env_steps_trained_throughput_per_sec": 690.6621148405187, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 5998.526, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5998.455, "sample_time_ms": 757.286, "learn_time_ms": 5225.586, "learn_throughput": 765.464, "synch_weights_time_ms": 15.152}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 66, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-20", "timestamp": 1723390640, "time_this_iter_s": 5.797000885009766, "time_total_s": 385.25664591789246, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 385.25664591789246, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 26.237500000000004, "ram_util_percent": 82.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.289903977451225, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3606915053290625, "policy_loss": -0.0012902970294817351, "vf_loss": 1.3619816647221645, "vf_explained_var": 0.9663959118848046, "kl": 0.005829870309621299, "entropy": 0.42569286543875934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.405570030895372, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.414889452047646, "policy_loss": -0.007401099988055648, "vf_loss": 1.4220774560545881, "vf_explained_var": 0.9657521307468414, "kl": 0.00852367054507596, "entropy": 0.6321029177556435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.28, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6828, "policy_reward_min": {"prey_policy": -52.78106965943587, "predator_policy": 1.0401977290296942}, "policy_reward_max": {"prey_policy": -1.0401977290296942, "predator_policy": 52.78106965943587}, "policy_reward_mean": {"prey_policy": -24.90263045794156, "predator_policy": 24.90263045794156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [72, 60, 56, 116, 133, 60, 64, 96, 50, 51, 80, 64, 52, 59, 62, 45, 69, 67, 53, 50, 78, 47, 83, 93, 54, 85, 24, 43, 76, 50, 75, 76, 48, 134, 52, 36, 104, 98, 66, 17, 90, 69, 45, 68, 70, 75, 28, 73, 60, 48, 59, 49, 86, 88, 83, 59, 69, 75, 48, 75, 56, 136, 69, 59, 67, 81, 80, 46, 70, 113, 17, 77, 76, 57, 80, 28, 61, 62, 75, 52, 65, 83, 60, 55, 62, 59, 152, 67, 44, 105, 74, 97, 23, 67, 90, 74, 55, 58, 93, 68], "policy_prey_policy_reward": [-27.165461372345163, -13.934348758606678, -33.2038886775721, -8.618817493487832, -34.02756012190444, -11.147086630213945, -26.23687669144124, -48.15890235227928, -5.036231881552024, -6.021258801550247, -47.56718243059974, -10.597687330149114, -13.89733077950571, -17.419702300950995, -17.481876294257777, -12.435029815719805, -30.914125959715477, -7.881515905466992, -20.93464203054931, -21.33561226910122, -33.526951610467194, -16.444086911052352, -44.55246692082444, -17.059522020133784, -24.830026954782664, -9.687264557123548, -5.48515226249795, -20.635822981598583, -17.04956179419051, -31.159305085615248, -45.995469540278854, -30.25302118546667, -25.144691932691156, -40.55415135647578, -34.049459577720214, -16.928117045645426, -33.929078133792416, -15.584628098695834, -47.69160240490956, -3.1386547888091627, -34.81002669094963, -16.84599648457276, -36.99334025630143, -32.777704876651505, -23.900266954371197, -20.004258946903665, -15.919587497445654, -7.234855591798098, -29.38387968457935, -13.77671075549726, -27.72203752770133, -27.538084138297133, -45.01789625971781, -39.29879236812244, -44.567217524614264, -17.759553310587833, -23.746007360941316, -15.349132895376144, -37.26807458099662, -22.03367750511436, -13.91459944790906, -52.78106965943587, -28.958962009251273, -26.66599520558959, -38.9906246927552, -38.85567452382117, -44.1192593666077, -28.013006724561215, -39.21563693939632, -21.855762831111363, -4.064458253038278, -20.615107933619075, -48.59235771039688, -14.734810118441757, -26.701771111865234, -8.505976968057848, -37.51980284537047, -18.993631031873644, -13.681353551862237, -7.610281088009371, -20.310148825366692, -37.23009958139871, -11.905738239063531, -27.145161039303673, -9.811326454571118, -20.190565665701126, -28.341274726553884, -26.485508258922387, -25.77783280641238, -41.05293133918588, -24.60609952045009, -32.8127440243138, -1.0401977290296942, -31.14212669788651, -48.907322575469344, -28.69659780551882, -15.220160597591285, -13.059945708367522, -25.89930928969441, -26.576538626101442], "policy_predator_policy_reward": [27.165461372345163, 13.934348758606678, 33.2038886775721, 8.618817493487832, 34.02756012190444, 11.147086630213945, 26.23687669144124, 48.15890235227928, 5.036231881552024, 6.021258801550247, 47.56718243059974, 10.597687330149114, 13.89733077950571, 17.419702300950995, 17.481876294257777, 12.435029815719805, 30.914125959715477, 7.881515905466992, 20.93464203054931, 21.33561226910122, 33.526951610467194, 16.444086911052352, 44.55246692082444, 17.059522020133784, 24.830026954782664, 9.687264557123548, 5.48515226249795, 20.635822981598583, 17.04956179419051, 31.159305085615248, 45.995469540278854, 30.25302118546667, 25.144691932691156, 40.55415135647578, 34.049459577720214, 16.928117045645426, 33.929078133792416, 15.584628098695834, 47.69160240490956, 3.1386547888091627, 34.81002669094963, 16.84599648457276, 36.99334025630143, 32.777704876651505, 23.900266954371197, 20.004258946903665, 15.919587497445654, 7.234855591798098, 29.38387968457935, 13.77671075549726, 27.72203752770133, 27.538084138297133, 45.01789625971781, 39.29879236812244, 44.567217524614264, 17.759553310587833, 23.746007360941316, 15.349132895376144, 37.26807458099662, 22.03367750511436, 13.91459944790906, 52.78106965943587, 28.958962009251273, 26.66599520558959, 38.9906246927552, 38.85567452382117, 44.1192593666077, 28.013006724561215, 39.21563693939632, 21.855762831111363, 4.064458253038278, 20.615107933619075, 48.59235771039688, 14.734810118441757, 26.701771111865234, 8.505976968057848, 37.51980284537047, 18.993631031873644, 13.681353551862237, 7.610281088009371, 20.310148825366692, 37.23009958139871, 11.905738239063531, 27.145161039303673, 9.811326454571118, 20.190565665701126, 28.341274726553884, 26.485508258922387, 25.77783280641238, 41.05293133918588, 24.60609952045009, 32.8127440243138, 1.0401977290296942, 31.14212669788651, 48.907322575469344, 28.69659780551882, 15.220160597591285, 13.059945708367522, 25.89930928969441, 26.576538626101442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915727451655314, "mean_inference_ms": 0.9483699968375576, "mean_action_processing_ms": 0.12507668850634698, "mean_env_wait_ms": 0.06592286123122085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002716660499572754, "StateBufferConnector_ms": 0.0020006895065307617, "ViewRequirementAgentConnector_ms": 0.04573798179626465}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 694.2835135631838, "num_env_steps_trained_throughput_per_sec": 694.2835135631838, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 5979.896, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5979.828, "sample_time_ms": 741.236, "learn_time_ms": 5223.033, "learn_throughput": 765.839, "synch_weights_time_ms": 15.13}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "training_iteration": 67, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-26", "timestamp": 1723390646, "time_this_iter_s": 5.766723155975342, "time_total_s": 391.0233690738678, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 391.0233690738678, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 27.0125, "ram_util_percent": 82.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.212373130520185, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3237367747972408, "policy_loss": -0.001946897490415722, "vf_loss": 1.3256835324068865, "vf_explained_var": 0.9723075119778514, "kl": 0.005634405705455239, "entropy": 0.45074620097875595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.389198942606648, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3381671006480853, "policy_loss": -0.005780263618604901, "vf_loss": 1.3437335085123778, "vf_explained_var": 0.972712972201407, "kl": 0.008554216539386815, "entropy": 0.6017509274805586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.45, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6745, "policy_reward_min": {"prey_policy": -53.49886345727353, "predator_policy": 1.0401977290296942}, "policy_reward_max": {"prey_policy": -1.0401977290296942, "predator_policy": 53.49886345727353}, "policy_reward_mean": {"prey_policy": -25.53959906719352, "predator_policy": 25.53959906719352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [136, 69, 59, 67, 81, 80, 46, 70, 113, 17, 77, 76, 57, 80, 28, 61, 62, 75, 52, 65, 83, 60, 55, 62, 59, 152, 67, 44, 105, 74, 97, 23, 67, 90, 74, 55, 58, 93, 68, 93, 61, 74, 76, 21, 58, 38, 32, 73, 81, 79, 22, 85, 75, 63, 88, 98, 33, 29, 95, 72, 100, 81, 62, 68, 84, 61, 35, 85, 59, 86, 75, 85, 63, 51, 89, 59, 107, 32, 97, 78, 63, 46, 82, 23, 48, 57, 41, 75, 77, 93, 11, 34, 65, 65, 65, 93, 76, 71, 42, 58], "policy_prey_policy_reward": [-52.78106965943587, -28.958962009251273, -26.66599520558959, -38.9906246927552, -38.85567452382117, -44.1192593666077, -28.013006724561215, -39.21563693939632, -21.855762831111363, -4.064458253038278, -20.615107933619075, -48.59235771039688, -14.734810118441757, -26.701771111865234, -8.505976968057848, -37.51980284537047, -18.993631031873644, -13.681353551862237, -7.610281088009371, -20.310148825366692, -37.23009958139871, -11.905738239063531, -27.145161039303673, -9.811326454571118, -20.190565665701126, -28.341274726553884, -26.485508258922387, -25.77783280641238, -41.05293133918588, -24.60609952045009, -32.8127440243138, -1.0401977290296942, -31.14212669788651, -48.907322575469344, -28.69659780551882, -15.220160597591285, -13.059945708367522, -25.89930928969441, -26.576538626101442, -23.405329526182612, -23.49664963490754, -21.506039091521668, -36.060361474576915, -9.314959019395413, -10.461870544695001, -17.139525900579635, -9.979483129011143, -31.752795493187453, -19.457471886241212, -46.05324318238661, -9.624185940322544, -24.100451957805113, -30.256213422429127, -32.77133445345571, -36.93582216406175, -37.22691256530987, -23.985491606620403, -5.527233640217655, -53.49886345727353, -3.3464701513962285, -41.39212565140335, -19.088245756527883, -36.826504553343256, -33.07953382121571, -17.025618381361205, -21.973140625967257, -15.80450486592453, -26.35937054858011, -9.774667881922907, -52.241314102084175, -41.85826207450711, -18.65782159981555, -43.48860965292895, -15.249486933880537, -30.654971109388036, -19.95060922436998, -27.024841704105437, -16.604474949969674, -25.186538476556134, -43.09232687755329, -36.968982519874814, -20.207039765761127, -33.19995216418764, -11.994791963493322, -17.236192389495166, -30.082331732161002, -8.935123614787209, -34.87815115637256, -41.19601404909505, -25.837365285647916, -7.752478968041558, -17.228173419844058, -22.951047670451512, -29.671821217379865, -30.267325131472205, -44.6555153587921, -24.416948622046334, -28.11086424530943, -3.459248986618274, -6.989689349572046], "policy_predator_policy_reward": [52.78106965943587, 28.958962009251273, 26.66599520558959, 38.9906246927552, 38.85567452382117, 44.1192593666077, 28.013006724561215, 39.21563693939632, 21.855762831111363, 4.064458253038278, 20.615107933619075, 48.59235771039688, 14.734810118441757, 26.701771111865234, 8.505976968057848, 37.51980284537047, 18.993631031873644, 13.681353551862237, 7.610281088009371, 20.310148825366692, 37.23009958139871, 11.905738239063531, 27.145161039303673, 9.811326454571118, 20.190565665701126, 28.341274726553884, 26.485508258922387, 25.77783280641238, 41.05293133918588, 24.60609952045009, 32.8127440243138, 1.0401977290296942, 31.14212669788651, 48.907322575469344, 28.69659780551882, 15.220160597591285, 13.059945708367522, 25.89930928969441, 26.576538626101442, 23.405329526182612, 23.49664963490754, 21.506039091521668, 36.060361474576915, 9.314959019395413, 10.461870544695001, 17.139525900579635, 9.979483129011143, 31.752795493187453, 19.457471886241212, 46.05324318238661, 9.624185940322544, 24.100451957805113, 30.256213422429127, 32.77133445345571, 36.93582216406175, 37.22691256530987, 23.985491606620403, 5.527233640217655, 53.49886345727353, 3.3464701513962285, 41.39212565140335, 19.088245756527883, 36.826504553343256, 33.07953382121571, 17.025618381361205, 21.973140625967257, 15.80450486592453, 26.35937054858011, 9.774667881922907, 52.241314102084175, 41.85826207450711, 18.65782159981555, 43.48860965292895, 15.249486933880537, 30.654971109388036, 19.95060922436998, 27.024841704105437, 16.604474949969674, 25.186538476556134, 43.09232687755329, 36.968982519874814, 20.207039765761127, 33.19995216418764, 11.994791963493322, 17.236192389495166, 30.082331732161002, 8.935123614787209, 34.87815115637256, 41.19601404909505, 25.837365285647916, 7.752478968041558, 17.228173419844058, 22.951047670451512, 29.671821217379865, 30.267325131472205, 44.6555153587921, 24.416948622046334, 28.11086424530943, 3.459248986618274, 6.989689349572046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29249229329694537, "mean_inference_ms": 0.9507494740869018, "mean_action_processing_ms": 0.1255117275499096, "mean_env_wait_ms": 0.06621113893190503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031605958938598633, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.051622629165649414}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 676.5554243262923, "num_env_steps_trained_throughput_per_sec": 676.5554243262923, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 5890.609, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5890.571, "sample_time_ms": 686.815, "learn_time_ms": 5188.971, "learn_throughput": 770.866, "synch_weights_time_ms": 14.444}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 68, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-32", "timestamp": 1723390652, "time_this_iter_s": 5.918031930923462, "time_total_s": 396.94140100479126, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 396.94140100479126, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 29.799999999999997, "ram_util_percent": 82.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.079339401051402, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.147246718298023, "policy_loss": -0.0023316247045537847, "vf_loss": 1.1495781790465116, "vf_explained_var": 0.9762014158690969, "kl": 0.006630805616152137, "entropy": 0.39484557264174025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1548216732218863, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1096286565996707, "policy_loss": -0.007189049346197862, "vf_loss": 1.11655994442602, "vf_explained_var": 0.9770259748523434, "kl": 0.010310573978308153, "entropy": 0.5837864730507135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.69, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6469, "policy_reward_min": {"prey_policy": -53.85123990473565, "predator_policy": 2.970318354616365}, "policy_reward_max": {"prey_policy": -2.970318354616365, "predator_policy": 53.85123990473565}, "policy_reward_mean": {"prey_policy": -25.561160872547276, "predator_policy": 25.561160872547276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [100, 81, 62, 68, 84, 61, 35, 85, 59, 86, 75, 85, 63, 51, 89, 59, 107, 32, 97, 78, 63, 46, 82, 23, 48, 57, 41, 75, 77, 93, 11, 34, 65, 65, 65, 93, 76, 71, 42, 58, 73, 17, 59, 18, 100, 96, 51, 66, 73, 82, 78, 42, 70, 74, 74, 52, 70, 69, 53, 71, 51, 57, 80, 61, 76, 61, 90, 17, 72, 54, 76, 72, 41, 31, 57, 66, 36, 84, 100, 69, 96, 51, 75, 84, 72, 55, 99, 47, 108, 30, 56, 58, 87, 36, 43, 34, 76, 65, 58, 58], "policy_prey_policy_reward": [-41.39212565140335, -19.088245756527883, -36.826504553343256, -33.07953382121571, -17.025618381361205, -21.973140625967257, -15.80450486592453, -26.35937054858011, -9.774667881922907, -52.241314102084175, -41.85826207450711, -18.65782159981555, -43.48860965292895, -15.249486933880537, -30.654971109388036, -19.95060922436998, -27.024841704105437, -16.604474949969674, -25.186538476556134, -43.09232687755329, -36.968982519874814, -20.207039765761127, -33.19995216418764, -11.994791963493322, -17.236192389495166, -30.082331732161002, -8.935123614787209, -34.87815115637256, -41.19601404909505, -25.837365285647916, -7.752478968041558, -17.228173419844058, -22.951047670451512, -29.671821217379865, -30.267325131472205, -44.6555153587921, -24.416948622046334, -28.11086424530943, -3.459248986618274, -6.989689349572046, -20.51312168217491, -12.405552190043288, -22.7295506850485, -12.844906323416462, -36.61702968315834, -53.85123990473565, -34.19514947557832, -15.338514488377502, -38.17373541768631, -38.6608877297922, -7.764127930544696, -7.077155321311366, -29.148172738637857, -33.91351401097654, -28.206281813383093, -28.72275330512942, -22.02188511814257, -23.67096267050086, -2.970318354616365, -32.779140053441864, -20.966611257733522, -18.000943096151822, -15.024864414641229, -28.51832706228656, -34.852491199161136, -19.355677999380365, -18.149084579146127, -8.673859913895704, -20.450545087673465, -28.518345905693202, -35.364776206357206, -32.755218760398094, -19.252455151057333, -8.470193264010787, -36.1571299491801, -32.741947826019675, -3.752529852652656, -6.2630895731404514, -26.57416934140552, -38.16932733334255, -42.23732084696363, -10.65801722563116, -45.49061823441443, -43.770950980828154, -43.00280621571339, -26.129250840173697, -28.086168606463293, -14.390352541402631, -25.507868582722256, -28.880844039565275, -26.968559260992468, -37.277099535001064, -36.17706598255881, -15.771533630335924, -22.60787539576497, -14.324239678630146, -24.89631685997963, -29.093227945457443, -42.73807752806285, -13.12028025223449], "policy_predator_policy_reward": [41.39212565140335, 19.088245756527883, 36.826504553343256, 33.07953382121571, 17.025618381361205, 21.973140625967257, 15.80450486592453, 26.35937054858011, 9.774667881922907, 52.241314102084175, 41.85826207450711, 18.65782159981555, 43.48860965292895, 15.249486933880537, 30.654971109388036, 19.95060922436998, 27.024841704105437, 16.604474949969674, 25.186538476556134, 43.09232687755329, 36.968982519874814, 20.207039765761127, 33.19995216418764, 11.994791963493322, 17.236192389495166, 30.082331732161002, 8.935123614787209, 34.87815115637256, 41.19601404909505, 25.837365285647916, 7.752478968041558, 17.228173419844058, 22.951047670451512, 29.671821217379865, 30.267325131472205, 44.6555153587921, 24.416948622046334, 28.11086424530943, 3.459248986618274, 6.989689349572046, 20.51312168217491, 12.405552190043288, 22.7295506850485, 12.844906323416462, 36.61702968315834, 53.85123990473565, 34.19514947557832, 15.338514488377502, 38.17373541768631, 38.6608877297922, 7.764127930544696, 7.077155321311366, 29.148172738637857, 33.91351401097654, 28.206281813383093, 28.72275330512942, 22.02188511814257, 23.67096267050086, 2.970318354616365, 32.779140053441864, 20.966611257733522, 18.000943096151822, 15.024864414641229, 28.51832706228656, 34.852491199161136, 19.355677999380365, 18.149084579146127, 8.673859913895704, 20.450545087673465, 28.518345905693202, 35.364776206357206, 32.755218760398094, 19.252455151057333, 8.470193264010787, 36.1571299491801, 32.741947826019675, 3.752529852652656, 6.2630895731404514, 26.57416934140552, 38.16932733334255, 42.23732084696363, 10.65801722563116, 45.49061823441443, 43.770950980828154, 43.00280621571339, 26.129250840173697, 28.086168606463293, 14.390352541402631, 25.507868582722256, 28.880844039565275, 26.968559260992468, 37.277099535001064, 36.17706598255881, 15.771533630335924, 22.60787539576497, 14.324239678630146, 24.89631685997963, 29.093227945457443, 42.73807752806285, 13.12028025223449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293253112203425, "mean_inference_ms": 0.9522491935091062, "mean_action_processing_ms": 0.1256118722999332, "mean_env_wait_ms": 0.06645344094716267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003132939338684082, "StateBufferConnector_ms": 0.0024939775466918945, "ViewRequirementAgentConnector_ms": 0.05029153823852539}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 700.8099917501227, "num_env_steps_trained_throughput_per_sec": 700.8099917501227, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 5883.744, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5883.7, "sample_time_ms": 683.18, "learn_time_ms": 5185.653, "learn_throughput": 771.359, "synch_weights_time_ms": 14.529}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 69, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-38", "timestamp": 1723390658, "time_this_iter_s": 5.713477849960327, "time_total_s": 402.6548788547516, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.6548788547516, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 27.4, "ram_util_percent": 82.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.272324666256706, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.092321279582878, "policy_loss": -0.0029973445659076483, "vf_loss": 1.095318532238404, "vf_explained_var": 0.9824432371805112, "kl": 0.0036229119742799297, "entropy": 0.3793498724388579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.307611882686615, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1105752787552774, "policy_loss": -0.010386328784322055, "vf_loss": 1.1206588882021606, "vf_explained_var": 0.9819361235325536, "kl": 0.012108761974872699, "entropy": 0.5336777558860679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.08, "episode_media": {}, "episodes_this_iter": 67, "episodes_timesteps_total": 6308, "policy_reward_min": {"prey_policy": -58.841696214063575, "predator_policy": 1.922895647816921}, "policy_reward_max": {"prey_policy": -1.922895647816921, "predator_policy": 58.841696214063575}, "policy_reward_mean": {"prey_policy": -25.84720774755251, "predator_policy": 25.84720774755251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [17, 72, 54, 76, 72, 41, 31, 57, 66, 36, 84, 100, 69, 96, 51, 75, 84, 72, 55, 99, 47, 108, 30, 56, 58, 87, 36, 43, 34, 76, 65, 58, 58, 94, 58, 28, 72, 53, 54, 72, 81, 83, 64, 67, 65, 69, 84, 50, 78, 54, 43, 76, 72, 65, 44, 74, 16, 65, 36, 55, 64, 77, 83, 63, 72, 125, 66, 41, 42, 76, 46, 95, 56, 13, 59, 15, 58, 88, 60, 97, 95, 39, 68, 75, 94, 76, 42, 90, 66, 66, 61, 46, 17, 72, 84, 69, 72, 44, 33, 68], "policy_prey_policy_reward": [-8.673859913895704, -20.450545087673465, -28.518345905693202, -35.364776206357206, -32.755218760398094, -19.252455151057333, -8.470193264010787, -36.1571299491801, -32.741947826019675, -3.752529852652656, -6.2630895731404514, -26.57416934140552, -38.16932733334255, -42.23732084696363, -10.65801722563116, -45.49061823441443, -43.770950980828154, -43.00280621571339, -26.129250840173697, -28.086168606463293, -14.390352541402631, -25.507868582722256, -28.880844039565275, -26.968559260992468, -37.277099535001064, -36.17706598255881, -15.771533630335924, -22.60787539576497, -14.324239678630146, -24.89631685997963, -29.093227945457443, -42.73807752806285, -13.12028025223449, -24.624206576067852, -14.88960397156723, -7.620250596037853, -36.58260594944836, -39.766383646857285, -16.59191931425987, -29.464940617630482, -45.24340056032828, -38.05335870958207, -27.310867519730564, -34.31573108366925, -29.13033998614658, -36.470251904589084, -29.808360713490337, -19.92432214593375, -21.009507145891895, -7.336978134040676, -10.87652820437994, -46.998296155334174, -18.26187348254357, -39.308723575558886, -13.780601939311227, -21.46877789940326, -7.533959316938477, -44.895140554211956, -15.695284033259892, -13.691302160333871, -22.83495330629319, -32.609427928301415, -39.92471593193423, -15.243530825694581, -20.037341607831472, -43.377780368190706, -14.056561904025347, -16.17937646744483, -8.17225645113982, -25.993316874839966, -26.995452732497906, -38.15711596498343, -12.909943222934503, -1.922895647816921, -8.5072445690799, -2.293572161108592, -23.396703856442386, -37.898711247023165, -10.577305382107609, -49.301596872703115, -22.46582562607833, -23.701588190098594, -33.18888942806815, -43.16330928196225, -58.841696214063575, -39.229739640965846, -8.487881113365816, -53.64628386071526, -38.812053975179325, -45.16633962380168, -26.139277867801695, -27.72692201913123, -4.099708683195712, -21.071094893942764, -25.33926622334859, -36.78416881210325, -18.282681095152515, -14.8027646442638, -8.551141906365029, -25.904760088985245], "policy_predator_policy_reward": [8.673859913895704, 20.450545087673465, 28.518345905693202, 35.364776206357206, 32.755218760398094, 19.252455151057333, 8.470193264010787, 36.1571299491801, 32.741947826019675, 3.752529852652656, 6.2630895731404514, 26.57416934140552, 38.16932733334255, 42.23732084696363, 10.65801722563116, 45.49061823441443, 43.770950980828154, 43.00280621571339, 26.129250840173697, 28.086168606463293, 14.390352541402631, 25.507868582722256, 28.880844039565275, 26.968559260992468, 37.277099535001064, 36.17706598255881, 15.771533630335924, 22.60787539576497, 14.324239678630146, 24.89631685997963, 29.093227945457443, 42.73807752806285, 13.12028025223449, 24.624206576067852, 14.88960397156723, 7.620250596037853, 36.58260594944836, 39.766383646857285, 16.59191931425987, 29.464940617630482, 45.24340056032828, 38.05335870958207, 27.310867519730564, 34.31573108366925, 29.13033998614658, 36.470251904589084, 29.808360713490337, 19.92432214593375, 21.009507145891895, 7.336978134040676, 10.87652820437994, 46.998296155334174, 18.26187348254357, 39.308723575558886, 13.780601939311227, 21.46877789940326, 7.533959316938477, 44.895140554211956, 15.695284033259892, 13.691302160333871, 22.83495330629319, 32.609427928301415, 39.92471593193423, 15.243530825694581, 20.037341607831472, 43.377780368190706, 14.056561904025347, 16.17937646744483, 8.17225645113982, 25.993316874839966, 26.995452732497906, 38.15711596498343, 12.909943222934503, 1.922895647816921, 8.5072445690799, 2.293572161108592, 23.396703856442386, 37.898711247023165, 10.577305382107609, 49.301596872703115, 22.46582562607833, 23.701588190098594, 33.18888942806815, 43.16330928196225, 58.841696214063575, 39.229739640965846, 8.487881113365816, 53.64628386071526, 38.812053975179325, 45.16633962380168, 26.139277867801695, 27.72692201913123, 4.099708683195712, 21.071094893942764, 25.33926622334859, 36.78416881210325, 18.282681095152515, 14.8027646442638, 8.551141906365029, 25.904760088985245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2936259632109173, "mean_inference_ms": 0.9507898392452993, "mean_action_processing_ms": 0.12546255853838037, "mean_env_wait_ms": 0.06635494575688344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026875734329223633, "StateBufferConnector_ms": 0.002062678337097168, "ViewRequirementAgentConnector_ms": 0.04821300506591797}, "num_episodes": 67, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 667.9426833966166, "num_env_steps_trained_throughput_per_sec": 667.9426833966166, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 5883.163, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5883.12, "sample_time_ms": 681.444, "learn_time_ms": 5186.958, "learn_throughput": 771.165, "synch_weights_time_ms": 14.374}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 70, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-44", "timestamp": 1723390664, "time_this_iter_s": 5.994278907775879, "time_total_s": 408.64915776252747, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.64915776252747, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 27.775, "ram_util_percent": 82.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0369428118690847, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3495441606268286, "policy_loss": -0.0019982147564102585, "vf_loss": 1.3515423323338231, "vf_explained_var": 0.9760525946194927, "kl": 0.004502914330794903, "entropy": 0.4066072416802247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2749051323781413, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4217061701541145, "policy_loss": -0.007595317713761081, "vf_loss": 1.4290440982207655, "vf_explained_var": 0.9741373969862859, "kl": 0.010295762598602359, "entropy": 0.5942650399481256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.37, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6337, "policy_reward_min": {"prey_policy": -58.841696214063575, "predator_policy": 1.5993353201037444}, "policy_reward_max": {"prey_policy": -1.5993353201037444, "predator_policy": 58.841696214063575}, "policy_reward_mean": {"prey_policy": -26.91050699765472, "predator_policy": 26.91050699765472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [64, 77, 83, 63, 72, 125, 66, 41, 42, 76, 46, 95, 56, 13, 59, 15, 58, 88, 60, 97, 95, 39, 68, 75, 94, 76, 42, 90, 66, 66, 61, 46, 17, 72, 84, 69, 72, 44, 33, 68, 80, 88, 76, 41, 61, 55, 58, 37, 83, 53, 63, 67, 35, 62, 51, 89, 59, 46, 94, 92, 1, 29, 50, 81, 41, 56, 31, 84, 71, 94, 106, 53, 50, 58, 100, 81, 46, 46, 89, 46, 77, 95, 3, 64, 49, 23, 71, 69, 74, 76, 89, 68, 66, 67, 67, 60, 45, 82, 36, 80], "policy_prey_policy_reward": [-22.83495330629319, -32.609427928301415, -39.92471593193423, -15.243530825694581, -20.037341607831472, -43.377780368190706, -14.056561904025347, -16.17937646744483, -8.17225645113982, -25.993316874839966, -26.995452732497906, -38.15711596498343, -12.909943222934503, -1.922895647816921, -8.5072445690799, -2.293572161108592, -23.396703856442386, -37.898711247023165, -10.577305382107609, -49.301596872703115, -22.46582562607833, -23.701588190098594, -33.18888942806815, -43.16330928196225, -58.841696214063575, -39.229739640965846, -8.487881113365816, -53.64628386071526, -38.812053975179325, -45.16633962380168, -26.139277867801695, -27.72692201913123, -4.099708683195712, -21.071094893942764, -25.33926622334859, -36.78416881210325, -18.282681095152515, -14.8027646442638, -8.551141906365029, -25.904760088985245, -46.266574465648894, -42.817585266401245, -40.491280499625525, -28.23953533518181, -11.716316451496617, -36.99027265973586, -16.88393567652875, -22.08102095189429, -34.012720542813845, -37.1448654695172, -23.612174860099756, -37.14858661103072, -16.767446876795226, -27.162161473251842, -30.99354921556649, -24.74846114911912, -28.79339794753974, -24.20799051284858, -31.321883213470528, -45.31250621574202, -1.786016681877419, -14.00539288263572, -16.310979126776303, -25.790193050998596, -21.602839818041524, -9.748509543198699, -23.230266219452606, -22.00725969099271, -42.23677058371102, -39.74632623117294, -33.69998328456279, -26.48392280610456, -30.763840262585997, -11.547836859215181, -53.216554763650656, -29.564468434636122, -22.32453444061307, -18.40039071384738, -58.28170524022526, -18.716292082589415, -34.28412702170354, -33.759522897658044, -1.5993353201037444, -36.35978411710431, -6.9989703485628185, -15.59759609375172, -26.081947972197316, -45.42784567286558, -31.337215755343202, -34.41697943781779, -41.788221984728835, -40.41744080213542, -14.160149836355984, -40.13715735150659, -22.27096351198085, -12.13920822188759, -21.300373282029934, -34.42171067867779, -15.628911055095594, -30.951693781788133], "policy_predator_policy_reward": [22.83495330629319, 32.609427928301415, 39.92471593193423, 15.243530825694581, 20.037341607831472, 43.377780368190706, 14.056561904025347, 16.17937646744483, 8.17225645113982, 25.993316874839966, 26.995452732497906, 38.15711596498343, 12.909943222934503, 1.922895647816921, 8.5072445690799, 2.293572161108592, 23.396703856442386, 37.898711247023165, 10.577305382107609, 49.301596872703115, 22.46582562607833, 23.701588190098594, 33.18888942806815, 43.16330928196225, 58.841696214063575, 39.229739640965846, 8.487881113365816, 53.64628386071526, 38.812053975179325, 45.16633962380168, 26.139277867801695, 27.72692201913123, 4.099708683195712, 21.071094893942764, 25.33926622334859, 36.78416881210325, 18.282681095152515, 14.8027646442638, 8.551141906365029, 25.904760088985245, 46.266574465648894, 42.817585266401245, 40.491280499625525, 28.23953533518181, 11.716316451496617, 36.99027265973586, 16.88393567652875, 22.08102095189429, 34.012720542813845, 37.1448654695172, 23.612174860099756, 37.14858661103072, 16.767446876795226, 27.162161473251842, 30.99354921556649, 24.74846114911912, 28.79339794753974, 24.20799051284858, 31.321883213470528, 45.31250621574202, 1.786016681877419, 14.00539288263572, 16.310979126776303, 25.790193050998596, 21.602839818041524, 9.748509543198699, 23.230266219452606, 22.00725969099271, 42.23677058371102, 39.74632623117294, 33.69998328456279, 26.48392280610456, 30.763840262585997, 11.547836859215181, 53.216554763650656, 29.564468434636122, 22.32453444061307, 18.40039071384738, 58.28170524022526, 18.716292082589415, 34.28412702170354, 33.759522897658044, 1.5993353201037444, 36.35978411710431, 6.9989703485628185, 15.59759609375172, 26.081947972197316, 45.42784567286558, 31.337215755343202, 34.41697943781779, 41.788221984728835, 40.41744080213542, 14.160149836355984, 40.13715735150659, 22.27096351198085, 12.13920822188759, 21.300373282029934, 34.42171067867779, 15.628911055095594, 30.951693781788133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930347726819553, "mean_inference_ms": 0.9503015612693798, "mean_action_processing_ms": 0.1255159063820699, "mean_env_wait_ms": 0.06636935854509977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002736210823059082, "StateBufferConnector_ms": 0.0020236968994140625, "ViewRequirementAgentConnector_ms": 0.0458223819732666}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.5801591221802, "num_env_steps_trained_throughput_per_sec": 673.5801591221802, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 5890.797, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5890.754, "sample_time_ms": 681.493, "learn_time_ms": 5194.252, "learn_throughput": 770.082, "synch_weights_time_ms": 14.63}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "training_iteration": 71, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-50", "timestamp": 1723390670, "time_this_iter_s": 5.943247079849243, "time_total_s": 414.5924048423767, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1328700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 414.5924048423767, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.766666666666666, "ram_util_percent": 83.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.937847149123748, "cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0007120971567929, "policy_loss": -0.0010526627049936602, "vf_loss": 1.0017647578691442, "vf_explained_var": 0.9804085987930496, "kl": 0.003582344574912441, "entropy": 0.37574449544772504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.086558136840661, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9788933164129655, "policy_loss": -0.005791821017677042, "vf_loss": 0.9844420747831464, "vf_explained_var": 0.9830061303451657, "kl": 0.009722483352583518, "entropy": 0.5617495295281212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.73, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6573, "policy_reward_min": {"prey_policy": -58.28170524022526, "predator_policy": 1.5993353201037444}, "policy_reward_max": {"prey_policy": -1.5993353201037444, "predator_policy": 58.28170524022526}, "policy_reward_mean": {"prey_policy": -27.33600202559152, "predator_policy": 27.33600202559152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1, 29, 50, 81, 41, 56, 31, 84, 71, 94, 106, 53, 50, 58, 100, 81, 46, 46, 89, 46, 77, 95, 3, 64, 49, 23, 71, 69, 74, 76, 89, 68, 66, 67, 67, 60, 45, 82, 36, 80, 88, 88, 55, 73, 80, 73, 119, 52, 67, 63, 62, 42, 51, 111, 136, 120, 67, 88, 69, 70, 49, 110, 21, 24, 131, 81, 129, 38, 52, 55, 76, 24, 56, 75, 87, 42, 60, 52, 37, 16, 64, 74, 92, 76, 60, 43, 46, 56, 49, 78, 96, 56, 61, 96, 61, 85, 65, 38, 64, 50], "policy_prey_policy_reward": [-1.786016681877419, -14.00539288263572, -16.310979126776303, -25.790193050998596, -21.602839818041524, -9.748509543198699, -23.230266219452606, -22.00725969099271, -42.23677058371102, -39.74632623117294, -33.69998328456279, -26.48392280610456, -30.763840262585997, -11.547836859215181, -53.216554763650656, -29.564468434636122, -22.32453444061307, -18.40039071384738, -58.28170524022526, -18.716292082589415, -34.28412702170354, -33.759522897658044, -1.5993353201037444, -36.35978411710431, -6.9989703485628185, -15.59759609375172, -26.081947972197316, -45.42784567286558, -31.337215755343202, -34.41697943781779, -41.788221984728835, -40.41744080213542, -14.160149836355984, -40.13715735150659, -22.27096351198085, -12.13920822188759, -21.300373282029934, -34.42171067867779, -15.628911055095594, -30.951693781788133, -31.919018702972195, -41.81011252060899, -12.67504790390592, -32.829141079631725, -48.5184702442064, -30.10664958142448, -22.731811146150573, -36.74891837134471, -31.60036320286712, -17.411612504244076, -17.616744783369455, -17.085616169676285, -25.595316151495517, -19.727358305139322, -32.24279379048805, -16.5873765078611, -31.390301507763393, -45.64846434489232, -35.60121441433352, -43.32237869404215, -33.581629323357184, -31.324525226051367, -12.751083791179346, -8.613671166264963, -49.851054730952335, -38.9157480628221, -41.14526220374279, -13.722768846316232, -31.418590315304108, -29.231716435868204, -36.27484095103792, -11.297043461305304, -29.10776771116095, -46.32893978178987, -40.37877311823347, -18.421181606139534, -21.472352559368783, -19.39194417229107, -9.37666236417103, -8.582727267323651, -16.926725426451753, -42.15873416512934, -42.076037581110036, -16.8486208996634, -12.709592493174894, -25.20774419944991, -17.123194964759403, -31.85953857203749, -14.05664227631428, -35.407356799460246, -41.35561607159871, -16.416988299935923, -28.879929363233433, -57.59956002125964, -31.24320123538771, -38.32502437745086, -27.019368351305157, -6.216219676178909, -37.49956621446247, -13.770310689508227], "policy_predator_policy_reward": [1.786016681877419, 14.00539288263572, 16.310979126776303, 25.790193050998596, 21.602839818041524, 9.748509543198699, 23.230266219452606, 22.00725969099271, 42.23677058371102, 39.74632623117294, 33.69998328456279, 26.48392280610456, 30.763840262585997, 11.547836859215181, 53.216554763650656, 29.564468434636122, 22.32453444061307, 18.40039071384738, 58.28170524022526, 18.716292082589415, 34.28412702170354, 33.759522897658044, 1.5993353201037444, 36.35978411710431, 6.9989703485628185, 15.59759609375172, 26.081947972197316, 45.42784567286558, 31.337215755343202, 34.41697943781779, 41.788221984728835, 40.41744080213542, 14.160149836355984, 40.13715735150659, 22.27096351198085, 12.13920822188759, 21.300373282029934, 34.42171067867779, 15.628911055095594, 30.951693781788133, 31.919018702972195, 41.81011252060899, 12.67504790390592, 32.829141079631725, 48.5184702442064, 30.10664958142448, 22.731811146150573, 36.74891837134471, 31.60036320286712, 17.411612504244076, 17.616744783369455, 17.085616169676285, 25.595316151495517, 19.727358305139322, 32.24279379048805, 16.5873765078611, 31.390301507763393, 45.64846434489232, 35.60121441433352, 43.32237869404215, 33.581629323357184, 31.324525226051367, 12.751083791179346, 8.613671166264963, 49.851054730952335, 38.9157480628221, 41.14526220374279, 13.722768846316232, 31.418590315304108, 29.231716435868204, 36.27484095103792, 11.297043461305304, 29.10776771116095, 46.32893978178987, 40.37877311823347, 18.421181606139534, 21.472352559368783, 19.39194417229107, 9.37666236417103, 8.582727267323651, 16.926725426451753, 42.15873416512934, 42.076037581110036, 16.8486208996634, 12.709592493174894, 25.20774419944991, 17.123194964759403, 31.85953857203749, 14.05664227631428, 35.407356799460246, 41.35561607159871, 16.416988299935923, 28.879929363233433, 57.59956002125964, 31.24320123538771, 38.32502437745086, 27.019368351305157, 6.216219676178909, 37.49956621446247, 13.770310689508227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2926802608627125, "mean_inference_ms": 0.949502003378145, "mean_action_processing_ms": 0.12558928406483316, "mean_env_wait_ms": 0.06634318689375454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030448436737060547, "StateBufferConnector_ms": 0.002061009407043457, "ViewRequirementAgentConnector_ms": 0.04667365550994873}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 662.6360806605375, "num_env_steps_trained_throughput_per_sec": 662.6360806605375, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 5887.421, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5887.378, "sample_time_ms": 681.41, "learn_time_ms": 5190.876, "learn_throughput": 770.583, "synch_weights_time_ms": 14.651}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 72, "trial_id": "abfb9_00000", "date": "2024-08-11_11-37-56", "timestamp": 1723390676, "time_this_iter_s": 6.042346000671387, "time_total_s": 420.6347508430481, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 420.6347508430481, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 33.0, "ram_util_percent": 83.13749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4282594854633013, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6809417610367139, "policy_loss": -0.0009464776406578798, "vf_loss": 1.6818882383406162, "vf_explained_var": 0.9649647538239757, "kl": 0.005736502301311356, "entropy": 0.39687187392264606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6558902163058518, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6182195331901312, "policy_loss": -0.006305291946046054, "vf_loss": 1.6243571515505513, "vf_explained_var": 0.9668897334486246, "kl": 0.006706963173247734, "entropy": 0.5694018818127612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.94, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6494, "policy_reward_min": {"prey_policy": -58.0943200966173, "predator_policy": 1.3148545680433787}, "policy_reward_max": {"prey_policy": -1.3148545680433787, "predator_policy": 58.0943200966173}, "policy_reward_mean": {"prey_policy": -26.00236247747583, "predator_policy": 26.00236247747583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [110, 21, 24, 131, 81, 129, 38, 52, 55, 76, 24, 56, 75, 87, 42, 60, 52, 37, 16, 64, 74, 92, 76, 60, 43, 46, 56, 49, 78, 96, 56, 61, 96, 61, 85, 65, 38, 64, 50, 64, 59, 68, 46, 83, 38, 72, 88, 3, 49, 82, 79, 110, 83, 66, 54, 54, 96, 69, 62, 51, 76, 54, 84, 77, 83, 39, 79, 35, 9, 87, 64, 85, 49, 50, 84, 50, 30, 67, 80, 43, 67, 88, 58, 77, 66, 94, 50, 75, 76, 70, 74, 87, 83, 74, 48, 59, 55, 64, 71, 81], "policy_prey_policy_reward": [-31.324525226051367, -12.751083791179346, -8.613671166264963, -49.851054730952335, -38.9157480628221, -41.14526220374279, -13.722768846316232, -31.418590315304108, -29.231716435868204, -36.27484095103792, -11.297043461305304, -29.10776771116095, -46.32893978178987, -40.37877311823347, -18.421181606139534, -21.472352559368783, -19.39194417229107, -9.37666236417103, -8.582727267323651, -16.926725426451753, -42.15873416512934, -42.076037581110036, -16.8486208996634, -12.709592493174894, -25.20774419944991, -17.123194964759403, -31.85953857203749, -14.05664227631428, -35.407356799460246, -41.35561607159871, -16.416988299935923, -28.879929363233433, -57.59956002125964, -31.24320123538771, -38.32502437745086, -27.019368351305157, -6.216219676178909, -37.49956621446247, -13.770310689508227, -22.621690930814008, -17.868415318395797, -25.63149401070802, -23.81340937243872, -21.22812428622364, -33.10003194661843, -36.49847984511407, -29.054544023338845, -1.3148545680433787, -30.393104611470008, -10.874501724912005, -22.596551852435887, -19.646066542805734, -35.51792382001171, -21.917864179972632, -13.99469088384394, -22.178309144611276, -27.928488589603674, -14.151585991598386, -33.658340254100644, -42.06749179014524, -18.0808699678268, -27.327855606313854, -40.074348661396215, -31.460856560930882, -17.31241707371435, -20.26175349006956, -45.41900125892424, -25.634209111081038, -7.19640116248237, -58.0943200966173, -19.852986148892878, -50.908383071590514, -15.061848413283151, -20.339549883074852, -20.392232681290622, -44.04301163827316, -13.004085250230492, -43.87038951621708, -15.011903126177264, -8.716259027716282, -29.836337518505896, -37.02795527847384, -34.05693156342962, -30.89290840078357, -30.85780000599469, -15.502772841694508, -12.16001602622839, -17.876295347463, -26.29282818579303, -12.716417474947288, -27.32426367577766, -45.18987519837649, -28.745144276091334, -37.03913687161372, -2.468524594017841, -29.179761793305094, -33.64669191683849, -9.829167705169912, -18.44907195471304, -22.719076235861777], "policy_predator_policy_reward": [31.324525226051367, 12.751083791179346, 8.613671166264963, 49.851054730952335, 38.9157480628221, 41.14526220374279, 13.722768846316232, 31.418590315304108, 29.231716435868204, 36.27484095103792, 11.297043461305304, 29.10776771116095, 46.32893978178987, 40.37877311823347, 18.421181606139534, 21.472352559368783, 19.39194417229107, 9.37666236417103, 8.582727267323651, 16.926725426451753, 42.15873416512934, 42.076037581110036, 16.8486208996634, 12.709592493174894, 25.20774419944991, 17.123194964759403, 31.85953857203749, 14.05664227631428, 35.407356799460246, 41.35561607159871, 16.416988299935923, 28.879929363233433, 57.59956002125964, 31.24320123538771, 38.32502437745086, 27.019368351305157, 6.216219676178909, 37.49956621446247, 13.770310689508227, 22.621690930814008, 17.868415318395797, 25.63149401070802, 23.81340937243872, 21.22812428622364, 33.10003194661843, 36.49847984511407, 29.054544023338845, 1.3148545680433787, 30.393104611470008, 10.874501724912005, 22.596551852435887, 19.646066542805734, 35.51792382001171, 21.917864179972632, 13.99469088384394, 22.178309144611276, 27.928488589603674, 14.151585991598386, 33.658340254100644, 42.06749179014524, 18.0808699678268, 27.327855606313854, 40.074348661396215, 31.460856560930882, 17.31241707371435, 20.26175349006956, 45.41900125892424, 25.634209111081038, 7.19640116248237, 58.0943200966173, 19.852986148892878, 50.908383071590514, 15.061848413283151, 20.339549883074852, 20.392232681290622, 44.04301163827316, 13.004085250230492, 43.87038951621708, 15.011903126177264, 8.716259027716282, 29.836337518505896, 37.02795527847384, 34.05693156342962, 30.89290840078357, 30.85780000599469, 15.502772841694508, 12.16001602622839, 17.876295347463, 26.29282818579303, 12.716417474947288, 27.32426367577766, 45.18987519837649, 28.745144276091334, 37.03913687161372, 2.468524594017841, 29.179761793305094, 33.64669191683849, 9.829167705169912, 18.44907195471304, 22.719076235861777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29268573535065856, "mean_inference_ms": 0.9482793636847299, "mean_action_processing_ms": 0.1253395376359532, "mean_env_wait_ms": 0.06620421221033068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027413368225097656, "StateBufferConnector_ms": 0.0020117759704589844, "ViewRequirementAgentConnector_ms": 0.048267245292663574}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 676.01309797297, "num_env_steps_trained_throughput_per_sec": 676.01309797297, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 5890.726, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5890.683, "sample_time_ms": 684.713, "learn_time_ms": 5190.895, "learn_throughput": 770.58, "synch_weights_time_ms": 14.622}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "training_iteration": 73, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-02", "timestamp": 1723390682, "time_this_iter_s": 5.922828912734985, "time_total_s": 426.5575797557831, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13280d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 426.5575797557831, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 27.87777777777778, "ram_util_percent": 82.97777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7461067031448088, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9333594381188353, "policy_loss": -0.002236575745822241, "vf_loss": 0.9355960138452549, "vf_explained_var": 0.98359820364664, "kl": 0.004223706194687319, "entropy": 0.4070157959746818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9996348736807703, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9696106197312474, "policy_loss": -0.0036797618246055207, "vf_loss": 0.9731556049548089, "vf_explained_var": 0.9834501568848888, "kl": 0.005391046081940798, "entropy": 0.599181850006183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.71, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6571, "policy_reward_min": {"prey_policy": -58.0943200966173, "predator_policy": 2.468524594017841}, "policy_reward_max": {"prey_policy": -2.468524594017841, "predator_policy": 58.0943200966173}, "policy_reward_mean": {"prey_policy": -26.07124628220602, "predator_policy": 26.07124628220602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [77, 83, 39, 79, 35, 9, 87, 64, 85, 49, 50, 84, 50, 30, 67, 80, 43, 67, 88, 58, 77, 66, 94, 50, 75, 76, 70, 74, 87, 83, 74, 48, 59, 55, 64, 71, 81, 80, 40, 92, 58, 98, 85, 88, 69, 61, 84, 84, 40, 35, 84, 66, 80, 39, 33, 54, 55, 23, 53, 84, 26, 60, 39, 53, 76, 64, 52, 48, 77, 92, 83, 69, 75, 54, 60, 8, 49, 48, 69, 35, 61, 23, 141, 77, 92, 94, 35, 100, 58, 63, 71, 60, 82, 80, 71, 90, 90, 71, 82, 80], "policy_prey_policy_reward": [-31.460856560930882, -17.31241707371435, -20.26175349006956, -45.41900125892424, -25.634209111081038, -7.19640116248237, -58.0943200966173, -19.852986148892878, -50.908383071590514, -15.061848413283151, -20.339549883074852, -20.392232681290622, -44.04301163827316, -13.004085250230492, -43.87038951621708, -15.011903126177264, -8.716259027716282, -29.836337518505896, -37.02795527847384, -34.05693156342962, -30.89290840078357, -30.85780000599469, -15.502772841694508, -12.16001602622839, -17.876295347463, -26.29282818579303, -12.716417474947288, -27.32426367577766, -45.18987519837649, -28.745144276091334, -37.03913687161372, -2.468524594017841, -29.179761793305094, -33.64669191683849, -9.829167705169912, -18.44907195471304, -22.719076235861777, -28.431059593809174, -10.092215778641444, -48.85027618927732, -15.65398080296207, -48.7224467957347, -32.24527200777734, -47.86266083387485, -37.12588665041026, -21.39767025808867, -35.04016191495111, -47.022373380689636, -9.030743706081118, -19.530610336892018, -22.929333519888665, -33.22436765080757, -10.001574424707284, -27.5016994103285, -14.413397115688923, -23.74392985851582, -15.29774552924438, -9.800641689178587, -19.187295262833658, -35.96434981943003, -4.276724616567344, -31.41643603672065, -5.9924885436188475, -17.439628957800934, -42.575486012251694, -16.858927457040956, -11.307200153594192, -24.259290168549818, -43.964848821996775, -31.50997749413721, -30.586177178872717, -22.216835203548797, -34.7869340416228, -14.871719214258729, -20.75583698413454, -5.412772062888932, -27.631241577402402, -30.453514792747598, -29.66958804222364, -11.70286870177214, -26.16309040162272, -10.880354580931556, -31.640139368942627, -39.4075923272527, -17.58454580483, -37.43267041907483, -29.737847534609237, -13.056977637166838, -6.813714220019331, -25.150625907800524, -24.00339513641115, -35.77653752675312, -55.75018937699958, -40.18353180147232, -13.409233673104014, -22.044461256376582, -39.64560557507577, -44.69174831208545, -40.61291672868893, -23.99067766417525], "policy_predator_policy_reward": [31.460856560930882, 17.31241707371435, 20.26175349006956, 45.41900125892424, 25.634209111081038, 7.19640116248237, 58.0943200966173, 19.852986148892878, 50.908383071590514, 15.061848413283151, 20.339549883074852, 20.392232681290622, 44.04301163827316, 13.004085250230492, 43.87038951621708, 15.011903126177264, 8.716259027716282, 29.836337518505896, 37.02795527847384, 34.05693156342962, 30.89290840078357, 30.85780000599469, 15.502772841694508, 12.16001602622839, 17.876295347463, 26.29282818579303, 12.716417474947288, 27.32426367577766, 45.18987519837649, 28.745144276091334, 37.03913687161372, 2.468524594017841, 29.179761793305094, 33.64669191683849, 9.829167705169912, 18.44907195471304, 22.719076235861777, 28.431059593809174, 10.092215778641444, 48.85027618927732, 15.65398080296207, 48.7224467957347, 32.24527200777734, 47.86266083387485, 37.12588665041026, 21.39767025808867, 35.04016191495111, 47.022373380689636, 9.030743706081118, 19.530610336892018, 22.929333519888665, 33.22436765080757, 10.001574424707284, 27.5016994103285, 14.413397115688923, 23.74392985851582, 15.29774552924438, 9.800641689178587, 19.187295262833658, 35.96434981943003, 4.276724616567344, 31.41643603672065, 5.9924885436188475, 17.439628957800934, 42.575486012251694, 16.858927457040956, 11.307200153594192, 24.259290168549818, 43.964848821996775, 31.50997749413721, 30.586177178872717, 22.216835203548797, 34.7869340416228, 14.871719214258729, 20.75583698413454, 5.412772062888932, 27.631241577402402, 30.453514792747598, 29.66958804222364, 11.70286870177214, 26.16309040162272, 10.880354580931556, 31.640139368942627, 39.4075923272527, 17.58454580483, 37.43267041907483, 29.737847534609237, 13.056977637166838, 6.813714220019331, 25.150625907800524, 24.00339513641115, 35.77653752675312, 55.75018937699958, 40.18353180147232, 13.409233673104014, 22.044461256376582, 39.64560557507577, 44.69174831208545, 40.61291672868893, 23.99067766417525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2925810465392448, "mean_inference_ms": 0.9471129984506149, "mean_action_processing_ms": 0.12503101905851133, "mean_env_wait_ms": 0.06615166047464355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027593374252319336, "StateBufferConnector_ms": 0.002086639404296875, "ViewRequirementAgentConnector_ms": 0.046973347663879395}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 676.5627361607864, "num_env_steps_trained_throughput_per_sec": 676.5627361607864, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 5904.126, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5904.083, "sample_time_ms": 687.607, "learn_time_ms": 5201.355, "learn_throughput": 769.03, "synch_weights_time_ms": 14.67}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 74, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-08", "timestamp": 1723390688, "time_this_iter_s": 5.917425155639648, "time_total_s": 432.47500491142273, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.47500491142273, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 27.975, "ram_util_percent": 82.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2552603371441364, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2954551895769935, "policy_loss": -0.0039027037846002107, "vf_loss": 1.299357891548425, "vf_explained_var": 0.9746283925448854, "kl": 0.007413397575467756, "entropy": 0.39966213994969924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2212581201146047, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3060355391353369, "policy_loss": -0.007506209235968223, "vf_loss": 1.3132497635359566, "vf_explained_var": 0.9739656090736389, "kl": 0.011679313655117663, "entropy": 0.6379215953250726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.26, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6526, "policy_reward_min": {"prey_policy": -57.70889027354335, "predator_policy": 5.030861137769031}, "policy_reward_max": {"prey_policy": -5.030861137769031, "predator_policy": 57.70889027354335}, "policy_reward_mean": {"prey_policy": -25.575260930001942, "predator_policy": 25.575260930001942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [39, 53, 76, 64, 52, 48, 77, 92, 83, 69, 75, 54, 60, 8, 49, 48, 69, 35, 61, 23, 141, 77, 92, 94, 35, 100, 58, 63, 71, 60, 82, 80, 71, 90, 90, 71, 82, 80, 47, 73, 51, 92, 44, 34, 91, 48, 42, 99, 62, 102, 62, 44, 108, 89, 82, 80, 76, 37, 47, 61, 45, 97, 74, 43, 29, 38, 84, 39, 78, 89, 65, 49, 79, 56, 88, 58, 52, 51, 38, 60, 70, 53, 59, 68, 69, 81, 58, 76, 64, 38, 75, 78, 49, 31, 68, 59, 63, 78, 68, 66], "policy_prey_policy_reward": [-5.9924885436188475, -17.439628957800934, -42.575486012251694, -16.858927457040956, -11.307200153594192, -24.259290168549818, -43.964848821996775, -31.50997749413721, -30.586177178872717, -22.216835203548797, -34.7869340416228, -14.871719214258729, -20.75583698413454, -5.412772062888932, -27.631241577402402, -30.453514792747598, -29.66958804222364, -11.70286870177214, -26.16309040162272, -10.880354580931556, -31.640139368942627, -39.4075923272527, -17.58454580483, -37.43267041907483, -29.737847534609237, -13.056977637166838, -6.813714220019331, -25.150625907800524, -24.00339513641115, -35.77653752675312, -55.75018937699958, -40.18353180147232, -13.409233673104014, -22.044461256376582, -39.64560557507577, -44.69174831208545, -40.61291672868893, -23.99067766417525, -14.605234909119082, -23.83438870189349, -10.091655344456498, -38.69176093876619, -19.84370425558751, -7.196132314639996, -27.865761115807828, -30.773901796823253, -12.666235968538372, -42.47248527260216, -33.3338645237948, -36.6319847688842, -12.273838341892993, -37.17895422702573, -20.4410861590557, -35.48884791641615, -19.230684669962393, -25.87163645082128, -40.318978711541035, -8.815780588041784, -25.51631614550184, -15.41522231324164, -25.878801086384733, -57.70889027354335, -10.432519183750845, -33.15631080912872, -13.566080174693315, -20.993937953462662, -38.04763983184064, -5.030861137769031, -48.87784929789933, -29.12841914199482, -35.82060985337652, -8.116469888249803, -35.832325926128576, -39.19958843904717, -36.661015286933846, -14.33869904814737, -14.196762985772617, -34.84346268280039, -6.946946890160874, -21.54181611622621, -39.42213459583826, -33.76549754877853, -34.381511427577784, -14.673375726736142, -30.91662398180148, -42.715269021064394, -40.941805710226575, -22.202846273701105, -12.488157389635333, -17.30603337465114, -24.752252478583443, -23.697908134695137, -17.83024691347573, -8.63173823056484, -31.347041461396593, -5.283784389692747, -15.487663431201407, -16.18039340663793, -28.964821451830893, -27.688335948524383], "policy_predator_policy_reward": [5.9924885436188475, 17.439628957800934, 42.575486012251694, 16.858927457040956, 11.307200153594192, 24.259290168549818, 43.964848821996775, 31.50997749413721, 30.586177178872717, 22.216835203548797, 34.7869340416228, 14.871719214258729, 20.75583698413454, 5.412772062888932, 27.631241577402402, 30.453514792747598, 29.66958804222364, 11.70286870177214, 26.16309040162272, 10.880354580931556, 31.640139368942627, 39.4075923272527, 17.58454580483, 37.43267041907483, 29.737847534609237, 13.056977637166838, 6.813714220019331, 25.150625907800524, 24.00339513641115, 35.77653752675312, 55.75018937699958, 40.18353180147232, 13.409233673104014, 22.044461256376582, 39.64560557507577, 44.69174831208545, 40.61291672868893, 23.99067766417525, 14.605234909119082, 23.83438870189349, 10.091655344456498, 38.69176093876619, 19.84370425558751, 7.196132314639996, 27.865761115807828, 30.773901796823253, 12.666235968538372, 42.47248527260216, 33.3338645237948, 36.6319847688842, 12.273838341892993, 37.17895422702573, 20.4410861590557, 35.48884791641615, 19.230684669962393, 25.87163645082128, 40.318978711541035, 8.815780588041784, 25.51631614550184, 15.41522231324164, 25.878801086384733, 57.70889027354335, 10.432519183750845, 33.15631080912872, 13.566080174693315, 20.993937953462662, 38.04763983184064, 5.030861137769031, 48.87784929789933, 29.12841914199482, 35.82060985337652, 8.116469888249803, 35.832325926128576, 39.19958843904717, 36.661015286933846, 14.33869904814737, 14.196762985772617, 34.84346268280039, 6.946946890160874, 21.54181611622621, 39.42213459583826, 33.76549754877853, 34.381511427577784, 14.673375726736142, 30.91662398180148, 42.715269021064394, 40.941805710226575, 22.202846273701105, 12.488157389635333, 17.30603337465114, 24.752252478583443, 23.697908134695137, 17.83024691347573, 8.63173823056484, 31.347041461396593, 5.283784389692747, 15.487663431201407, 16.18039340663793, 28.964821451830893, 27.688335948524383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29234830071331, "mean_inference_ms": 0.946426694513058, "mean_action_processing_ms": 0.12500327202949715, "mean_env_wait_ms": 0.06604928229450296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026085376739501953, "StateBufferConnector_ms": 0.0020052194595336914, "ViewRequirementAgentConnector_ms": 0.044945359230041504}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 680.2401832817628, "num_env_steps_trained_throughput_per_sec": 680.2401832817628, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 5884.595, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5884.553, "sample_time_ms": 675.499, "learn_time_ms": 5193.778, "learn_throughput": 770.152, "synch_weights_time_ms": 14.825}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 75, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-14", "timestamp": 1723390694, "time_this_iter_s": 5.886200189590454, "time_total_s": 438.3612051010132, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 438.3612051010132, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 25.77777777777778, "ram_util_percent": 82.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4256829230114816, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6198477639506261, "policy_loss": -0.0005098651898151729, "vf_loss": 1.6203576224545637, "vf_explained_var": 0.9631039461120963, "kl": 0.004474370760049357, "entropy": 0.3724114543758333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.594522560139497, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5448180468752981, "policy_loss": -0.007354204277604973, "vf_loss": 1.5519581949959198, "vf_explained_var": 0.966582954612871, "kl": 0.008562249830467487, "entropy": 0.6702379181360205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.2, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6220, "policy_reward_min": {"prey_policy": -48.87784929789933, "predator_policy": 0.48844492531035866}, "policy_reward_max": {"prey_policy": -0.48844492531035866, "predator_policy": 48.87784929789933}, "policy_reward_mean": {"prey_policy": -23.965470610759688, "predator_policy": 23.965470610759688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [29, 38, 84, 39, 78, 89, 65, 49, 79, 56, 88, 58, 52, 51, 38, 60, 70, 53, 59, 68, 69, 81, 58, 76, 64, 38, 75, 78, 49, 31, 68, 59, 63, 78, 68, 66, 68, 52, 74, 87, 55, 54, 63, 63, 30, 82, 56, 61, 63, 81, 63, 40, 20, 74, 64, 78, 57, 45, 19, 75, 85, 82, 122, 51, 38, 71, 46, 65, 52, 63, 36, 78, 39, 14, 65, 50, 63, 103, 133, 57, 41, 80, 45, 137, 50, 80, 64, 54, 32, 83, 52, 48, 47, 28, 72, 66, 79, 46, 88, 67], "policy_prey_policy_reward": [-13.566080174693315, -20.993937953462662, -38.04763983184064, -5.030861137769031, -48.87784929789933, -29.12841914199482, -35.82060985337652, -8.116469888249803, -35.832325926128576, -39.19958843904717, -36.661015286933846, -14.33869904814737, -14.196762985772617, -34.84346268280039, -6.946946890160874, -21.54181611622621, -39.42213459583826, -33.76549754877853, -34.381511427577784, -14.673375726736142, -30.91662398180148, -42.715269021064394, -40.941805710226575, -22.202846273701105, -12.488157389635333, -17.30603337465114, -24.752252478583443, -23.697908134695137, -17.83024691347573, -8.63173823056484, -31.347041461396593, -5.283784389692747, -15.487663431201407, -16.18039340663793, -28.964821451830893, -27.688335948524383, -18.8141233479729, -44.697230096692024, -32.910890429056955, -34.62846897548824, -30.66652478485107, -31.884225038646335, -21.519802067825132, -25.864527989106136, -6.7885100262139275, -32.898076535422994, -31.320708539278428, -33.23289362093333, -23.08308940155063, -45.82011287170807, -19.071989077094397, -25.307314833533606, -5.549242545310388, -11.315119282113526, -36.38054456491707, -14.563472739144638, -43.18074697161375, -18.304059891142987, -15.096222984204948, -30.46813120137498, -24.149303485389296, -37.42576321805509, -21.126901099827666, -26.85594957886774, -27.708746742187458, -34.04847139915909, -7.833352486522927, -25.128080952226753, -25.666060514945013, -16.704125497224457, -15.296069106352675, -17.375570961420188, -0.48844492531035866, -7.2972418215333175, -6.121384027917701, -37.5175274535412, -18.409943169144167, -30.718273357583495, -20.9853038041346, -8.045805648551863, -11.655440096321323, -20.113741936434913, -21.908358986837268, -34.32674617357756, -8.046507112514561, -48.823159653855456, -25.193549468716565, -16.401241182345714, -22.472737658822233, -29.292954841382766, -41.838620625512995, -15.989841466242458, -22.95487547476433, -11.059207869393923, -14.224984225598442, -17.038787334630964, -40.38939862696407, -15.975272492151092, -33.168281165372015, -11.585082068322107], "policy_predator_policy_reward": [13.566080174693315, 20.993937953462662, 38.04763983184064, 5.030861137769031, 48.87784929789933, 29.12841914199482, 35.82060985337652, 8.116469888249803, 35.832325926128576, 39.19958843904717, 36.661015286933846, 14.33869904814737, 14.196762985772617, 34.84346268280039, 6.946946890160874, 21.54181611622621, 39.42213459583826, 33.76549754877853, 34.381511427577784, 14.673375726736142, 30.91662398180148, 42.715269021064394, 40.941805710226575, 22.202846273701105, 12.488157389635333, 17.30603337465114, 24.752252478583443, 23.697908134695137, 17.83024691347573, 8.63173823056484, 31.347041461396593, 5.283784389692747, 15.487663431201407, 16.18039340663793, 28.964821451830893, 27.688335948524383, 18.8141233479729, 44.697230096692024, 32.910890429056955, 34.62846897548824, 30.66652478485107, 31.884225038646335, 21.519802067825132, 25.864527989106136, 6.7885100262139275, 32.898076535422994, 31.320708539278428, 33.23289362093333, 23.08308940155063, 45.82011287170807, 19.071989077094397, 25.307314833533606, 5.549242545310388, 11.315119282113526, 36.38054456491707, 14.563472739144638, 43.18074697161375, 18.304059891142987, 15.096222984204948, 30.46813120137498, 24.149303485389296, 37.42576321805509, 21.126901099827666, 26.85594957886774, 27.708746742187458, 34.04847139915909, 7.833352486522927, 25.128080952226753, 25.666060514945013, 16.704125497224457, 15.296069106352675, 17.375570961420188, 0.48844492531035866, 7.2972418215333175, 6.121384027917701, 37.5175274535412, 18.409943169144167, 30.718273357583495, 20.9853038041346, 8.045805648551863, 11.655440096321323, 20.113741936434913, 21.908358986837268, 34.32674617357756, 8.046507112514561, 48.823159653855456, 25.193549468716565, 16.401241182345714, 22.472737658822233, 29.292954841382766, 41.838620625512995, 15.989841466242458, 22.95487547476433, 11.059207869393923, 14.224984225598442, 17.038787334630964, 40.38939862696407, 15.975272492151092, 33.168281165372015, 11.585082068322107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923629785874694, "mean_inference_ms": 0.9457300067968998, "mean_action_processing_ms": 0.12503328243195277, "mean_env_wait_ms": 0.0659906887570389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027393102645874023, "StateBufferConnector_ms": 0.0020502805709838867, "ViewRequirementAgentConnector_ms": 0.04700648784637451}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 693.8231429241972, "num_env_steps_trained_throughput_per_sec": 693.8231429241972, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 5881.956, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5881.914, "sample_time_ms": 678.812, "learn_time_ms": 5187.651, "learn_throughput": 771.062, "synch_weights_time_ms": 15.0}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 76, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-19", "timestamp": 1723390699, "time_this_iter_s": 5.770883798599243, "time_total_s": 444.1320888996124, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 444.1320888996124, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 28.612500000000004, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3041796163966257, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.215871561318636, "policy_loss": -0.00021973322242653618, "vf_loss": 1.2160912957042456, "vf_explained_var": 0.9761840709795554, "kl": 0.004439316812835836, "entropy": 0.3672678091873725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4819407789657513, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2335460328186552, "policy_loss": -0.00506648145140692, "vf_loss": 1.2383867221573988, "vf_explained_var": 0.9760070386653145, "kl": 0.009031771270382986, "entropy": 0.6709149059529106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.82, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6182, "policy_reward_min": {"prey_policy": -48.823159653855456, "predator_policy": 0.48844492531035866}, "policy_reward_max": {"prey_policy": -0.48844492531035866, "predator_policy": 48.823159653855456}, "policy_reward_mean": {"prey_policy": -23.92460606027429, "predator_policy": 23.92460606027429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [51, 38, 71, 46, 65, 52, 63, 36, 78, 39, 14, 65, 50, 63, 103, 133, 57, 41, 80, 45, 137, 50, 80, 64, 54, 32, 83, 52, 48, 47, 28, 72, 66, 79, 46, 88, 67, 54, 71, 55, 77, 36, 62, 81, 61, 52, 45, 64, 27, 67, 85, 66, 63, 88, 72, 40, 53, 76, 39, 44, 45, 63, 44, 67, 63, 49, 76, 95, 78, 71, 73, 67, 3, 38, 89, 72, 88, 83, 14, 55, 73, 28, 59, 68, 63, 33, 73, 72, 63, 76, 59, 59, 67, 74, 86, 52, 77, 61, 54, 91], "policy_prey_policy_reward": [-26.85594957886774, -27.708746742187458, -34.04847139915909, -7.833352486522927, -25.128080952226753, -25.666060514945013, -16.704125497224457, -15.296069106352675, -17.375570961420188, -0.48844492531035866, -7.2972418215333175, -6.121384027917701, -37.5175274535412, -18.409943169144167, -30.718273357583495, -20.9853038041346, -8.045805648551863, -11.655440096321323, -20.113741936434913, -21.908358986837268, -34.32674617357756, -8.046507112514561, -48.823159653855456, -25.193549468716565, -16.401241182345714, -22.472737658822233, -29.292954841382766, -41.838620625512995, -15.989841466242458, -22.95487547476433, -11.059207869393923, -14.224984225598442, -17.038787334630964, -40.38939862696407, -15.975272492151092, -33.168281165372015, -11.585082068322107, -26.7242434438868, -35.95996267272434, -9.761476994477551, -32.29931628508018, -7.1169808271465005, -34.93740589646241, -22.318932050509723, -18.952589472930406, -32.05491517521051, -16.39951547201348, -19.165423258680686, -16.47548773207575, -12.716121358169037, -41.93314125184365, -37.33917229655959, -33.54487556719139, -28.06023541827334, -14.40277491908817, -20.57719673002509, -26.870461269227285, -32.14362794835868, -24.487723085624943, -12.902916864150873, -21.126458350963375, -30.512358562648615, -24.069073714531115, -12.355851580600927, -28.92572655564625, -25.73455222035141, -37.79264831534526, -39.49959344686888, -35.35279196649737, -4.215889100534348, -24.803833816920402, -18.305737002343065, -2.5148814127583385, -5.457197526475407, -41.187061118845705, -24.993552037460923, -36.99952300491902, -25.55454683070717, -6.456823457556354, -31.779248559127957, -19.88080581279288, -16.947717216219882, -29.829100765949697, -8.740786518925905, -45.23674674163232, -26.747301966578448, -23.365792376047004, -42.88655774828311, -23.33335403202609, -32.282183613613874, -36.299595327938505, -43.420061769152575, -36.55155133390937, -14.006063439487395, -40.30241518988634, -15.913860022955474, -46.23741339658179, -14.156468384912271, -18.360155889722314, -34.52169000361735], "policy_predator_policy_reward": [26.85594957886774, 27.708746742187458, 34.04847139915909, 7.833352486522927, 25.128080952226753, 25.666060514945013, 16.704125497224457, 15.296069106352675, 17.375570961420188, 0.48844492531035866, 7.2972418215333175, 6.121384027917701, 37.5175274535412, 18.409943169144167, 30.718273357583495, 20.9853038041346, 8.045805648551863, 11.655440096321323, 20.113741936434913, 21.908358986837268, 34.32674617357756, 8.046507112514561, 48.823159653855456, 25.193549468716565, 16.401241182345714, 22.472737658822233, 29.292954841382766, 41.838620625512995, 15.989841466242458, 22.95487547476433, 11.059207869393923, 14.224984225598442, 17.038787334630964, 40.38939862696407, 15.975272492151092, 33.168281165372015, 11.585082068322107, 26.7242434438868, 35.95996267272434, 9.761476994477551, 32.29931628508018, 7.1169808271465005, 34.93740589646241, 22.318932050509723, 18.952589472930406, 32.05491517521051, 16.39951547201348, 19.165423258680686, 16.47548773207575, 12.716121358169037, 41.93314125184365, 37.33917229655959, 33.54487556719139, 28.06023541827334, 14.40277491908817, 20.57719673002509, 26.870461269227285, 32.14362794835868, 24.487723085624943, 12.902916864150873, 21.126458350963375, 30.512358562648615, 24.069073714531115, 12.355851580600927, 28.92572655564625, 25.73455222035141, 37.79264831534526, 39.49959344686888, 35.35279196649737, 4.215889100534348, 24.803833816920402, 18.305737002343065, 2.5148814127583385, 5.457197526475407, 41.187061118845705, 24.993552037460923, 36.99952300491902, 25.55454683070717, 6.456823457556354, 31.779248559127957, 19.88080581279288, 16.947717216219882, 29.829100765949697, 8.740786518925905, 45.23674674163232, 26.747301966578448, 23.365792376047004, 42.88655774828311, 23.33335403202609, 32.282183613613874, 36.299595327938505, 43.420061769152575, 36.55155133390937, 14.006063439487395, 40.30241518988634, 15.913860022955474, 46.23741339658179, 14.156468384912271, 18.360155889722314, 34.52169000361735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920328510466377, "mean_inference_ms": 0.9449945983294957, "mean_action_processing_ms": 0.12500331474055904, "mean_env_wait_ms": 0.06597004996019411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028181076049804688, "StateBufferConnector_ms": 0.0020292997360229492, "ViewRequirementAgentConnector_ms": 0.04771316051483154}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 678.5394921724883, "num_env_steps_trained_throughput_per_sec": 678.5394921724883, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 5895.324, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5895.281, "sample_time_ms": 678.865, "learn_time_ms": 5200.921, "learn_throughput": 769.095, "synch_weights_time_ms": 15.041}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "training_iteration": 77, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-25", "timestamp": 1723390705, "time_this_iter_s": 5.899832010269165, "time_total_s": 450.0319209098816, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13280d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 450.0319209098816, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 28.2875, "ram_util_percent": 82.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0421047255396845, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2580589385392764, "policy_loss": -0.0021447809476133747, "vf_loss": 1.2602037201945981, "vf_explained_var": 0.9753313525269429, "kl": 0.005858673013376791, "entropy": 0.3864050566839675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2367015823721887, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2308294078335167, "policy_loss": -0.005405026812998888, "vf_loss": 1.2359585851430892, "vf_explained_var": 0.9770688589041432, "kl": 0.011034083064492961, "entropy": 0.668819879864653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.45, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6545, "policy_reward_min": {"prey_policy": -56.586540885292614, "predator_policy": 2.5148814127583385}, "policy_reward_max": {"prey_policy": -2.5148814127583385, "predator_policy": 56.586540885292614}, "policy_reward_mean": {"prey_policy": -26.064716487698362, "predator_policy": 26.064716487698362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [45, 63, 44, 67, 63, 49, 76, 95, 78, 71, 73, 67, 3, 38, 89, 72, 88, 83, 14, 55, 73, 28, 59, 68, 63, 33, 73, 72, 63, 76, 59, 59, 67, 74, 86, 52, 77, 61, 54, 91, 40, 58, 74, 80, 91, 87, 80, 53, 75, 62, 65, 81, 73, 56, 45, 41, 95, 85, 77, 87, 30, 39, 72, 49, 42, 69, 86, 57, 82, 75, 77, 38, 68, 60, 45, 53, 83, 63, 59, 157, 54, 49, 49, 77, 94, 45, 48, 64, 83, 80, 104, 75, 79, 93, 61, 61, 22, 43, 64, 70], "policy_prey_policy_reward": [-21.126458350963375, -30.512358562648615, -24.069073714531115, -12.355851580600927, -28.92572655564625, -25.73455222035141, -37.79264831534526, -39.49959344686888, -35.35279196649737, -4.215889100534348, -24.803833816920402, -18.305737002343065, -2.5148814127583385, -5.457197526475407, -41.187061118845705, -24.993552037460923, -36.99952300491902, -25.55454683070717, -6.456823457556354, -31.779248559127957, -19.88080581279288, -16.947717216219882, -29.829100765949697, -8.740786518925905, -45.23674674163232, -26.747301966578448, -23.365792376047004, -42.88655774828311, -23.33335403202609, -32.282183613613874, -36.299595327938505, -43.420061769152575, -36.55155133390937, -14.006063439487395, -40.30241518988634, -15.913860022955474, -46.23741339658179, -14.156468384912271, -18.360155889722314, -34.52169000361735, -15.386917490901501, -27.036961772880296, -39.286935179460954, -17.74643117433898, -42.31012068243381, -39.043597715979004, -31.36139320090654, -19.928123826014357, -21.14617406495727, -19.198290791037785, -31.71415837772218, -43.29866548716265, -10.389499379144993, -14.20480242293983, -24.847363342650905, -6.2619379448221295, -17.636127314769926, -45.662649433976625, -34.80939866490359, -40.77534253010539, -18.14457035564491, -17.63457558811114, -25.184757638564935, -8.853651048407258, -22.951762119309507, -31.003856019932716, -43.24102297642655, -15.377637029714197, -20.278460539638644, -28.251255248906048, -50.20626037429806, -19.202573228280325, -24.24733323097596, -5.21275446878732, -13.870476946974046, -17.489998251417717, -31.266819782782452, -23.57281450460277, -17.673100144146197, -35.17673784243502, -10.393283273771276, -16.855575195213166, -29.720276436792584, -33.53802014783235, -56.586540885292614, -33.04517121740702, -12.27517084006898, -30.21045248989878, -24.359695861950584, -18.438838286147416, -13.430554279059933, -49.01995328933385, -28.85310829722092, -33.176897811248345, -11.66320866382286, -27.162134557537364, -14.498902116490319, -26.308554026116827, -40.46402017948749, -38.9290126473446], "policy_predator_policy_reward": [21.126458350963375, 30.512358562648615, 24.069073714531115, 12.355851580600927, 28.92572655564625, 25.73455222035141, 37.79264831534526, 39.49959344686888, 35.35279196649737, 4.215889100534348, 24.803833816920402, 18.305737002343065, 2.5148814127583385, 5.457197526475407, 41.187061118845705, 24.993552037460923, 36.99952300491902, 25.55454683070717, 6.456823457556354, 31.779248559127957, 19.88080581279288, 16.947717216219882, 29.829100765949697, 8.740786518925905, 45.23674674163232, 26.747301966578448, 23.365792376047004, 42.88655774828311, 23.33335403202609, 32.282183613613874, 36.299595327938505, 43.420061769152575, 36.55155133390937, 14.006063439487395, 40.30241518988634, 15.913860022955474, 46.23741339658179, 14.156468384912271, 18.360155889722314, 34.52169000361735, 15.386917490901501, 27.036961772880296, 39.286935179460954, 17.74643117433898, 42.31012068243381, 39.043597715979004, 31.36139320090654, 19.928123826014357, 21.14617406495727, 19.198290791037785, 31.71415837772218, 43.29866548716265, 10.389499379144993, 14.20480242293983, 24.847363342650905, 6.2619379448221295, 17.636127314769926, 45.662649433976625, 34.80939866490359, 40.77534253010539, 18.14457035564491, 17.63457558811114, 25.184757638564935, 8.853651048407258, 22.951762119309507, 31.003856019932716, 43.24102297642655, 15.377637029714197, 20.278460539638644, 28.251255248906048, 50.20626037429806, 19.202573228280325, 24.24733323097596, 5.21275446878732, 13.870476946974046, 17.489998251417717, 31.266819782782452, 23.57281450460277, 17.673100144146197, 35.17673784243502, 10.393283273771276, 16.855575195213166, 29.720276436792584, 33.53802014783235, 56.586540885292614, 33.04517121740702, 12.27517084006898, 30.21045248989878, 24.359695861950584, 18.438838286147416, 13.430554279059933, 49.01995328933385, 28.85310829722092, 33.176897811248345, 11.66320866382286, 27.162134557537364, 14.498902116490319, 26.308554026116827, 40.46402017948749, 38.9290126473446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29203337600308765, "mean_inference_ms": 0.9446298577998925, "mean_action_processing_ms": 0.12514378177202926, "mean_env_wait_ms": 0.06606570425478128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028754472732543945, "StateBufferConnector_ms": 0.0020705461502075195, "ViewRequirementAgentConnector_ms": 0.04729163646697998}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 630.0739746219821, "num_env_steps_trained_throughput_per_sec": 630.0739746219821, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 5938.94, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5938.886, "sample_time_ms": 647.615, "learn_time_ms": 5275.426, "learn_throughput": 758.233, "synch_weights_time_ms": 15.203}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 78, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-32", "timestamp": 1723390712, "time_this_iter_s": 6.387108087539673, "time_total_s": 456.41902899742126, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 456.41902899742126, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 31.04444444444444, "ram_util_percent": 82.88888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.160097886994481, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1807843678320447, "policy_loss": -0.011420188976141313, "vf_loss": 1.1922045540064574, "vf_explained_var": 0.9784622728203733, "kl": 0.03542381389484238, "entropy": 0.43586858451987304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1618907121320565, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.197358283897241, "policy_loss": -0.006642286193770512, "vf_loss": 1.2037098450586199, "vf_explained_var": 0.9762788914144039, "kl": 0.011628755138415887, "entropy": 0.6260216155399879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.37, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6737, "policy_reward_min": {"prey_policy": -56.586540885292614, "predator_policy": 4.1154551443873295}, "policy_reward_max": {"prey_policy": -4.1154551443873295, "predator_policy": 56.586540885292614}, "policy_reward_mean": {"prey_policy": -26.227453333618033, "predator_policy": 26.227453333618033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [30, 39, 72, 49, 42, 69, 86, 57, 82, 75, 77, 38, 68, 60, 45, 53, 83, 63, 59, 157, 54, 49, 49, 77, 94, 45, 48, 64, 83, 80, 104, 75, 79, 93, 61, 61, 22, 43, 64, 70, 83, 62, 65, 65, 110, 85, 58, 80, 42, 83, 78, 77, 81, 87, 64, 32, 66, 32, 56, 90, 45, 53, 90, 53, 51, 44, 36, 83, 81, 56, 91, 82, 92, 91, 94, 90, 58, 58, 66, 96, 59, 82, 41, 80, 40, 72, 71, 95, 83, 84, 54, 45, 81, 78, 59, 76, 31, 28, 64, 89], "policy_prey_policy_reward": [-18.14457035564491, -17.63457558811114, -25.184757638564935, -8.853651048407258, -22.951762119309507, -31.003856019932716, -43.24102297642655, -15.377637029714197, -20.278460539638644, -28.251255248906048, -50.20626037429806, -19.202573228280325, -24.24733323097596, -5.21275446878732, -13.870476946974046, -17.489998251417717, -31.266819782782452, -23.57281450460277, -17.673100144146197, -35.17673784243502, -10.393283273771276, -16.855575195213166, -29.720276436792584, -33.53802014783235, -56.586540885292614, -33.04517121740702, -12.27517084006898, -30.21045248989878, -24.359695861950584, -18.438838286147416, -13.430554279059933, -49.01995328933385, -28.85310829722092, -33.176897811248345, -11.66320866382286, -27.162134557537364, -14.498902116490319, -26.308554026116827, -40.46402017948749, -38.9290126473446, -30.257926021711796, -31.95946092162341, -32.34990549545846, -30.006517113937768, -24.0277616627429, -39.7891209221009, -8.187685353989707, -36.89888586177501, -24.336529398933937, -26.379559837637395, -45.10221942246733, -43.35443176762078, -31.6820006559218, -27.916532621425226, -20.94585424127552, -14.342312269370767, -26.741986763227047, -4.1154551443873295, -6.268534708507673, -42.96220659249882, -18.59932469783231, -25.608779146305622, -19.34826777678735, -46.908880684926366, -15.105058297109123, -20.683659213542242, -17.290530876850877, -50.00227536565739, -45.62287203556442, -20.339338855580458, -34.17612302260176, -44.312654440385245, -51.17422022113299, -11.410363044188617, -26.521815219627307, -29.842761757829336, -16.331783826383344, -10.219544595131127, -39.14368856639329, -42.101694938327434, -13.081306077245255, -21.650144440027468, -12.089402334951039, -32.65735121651078, -22.10207873363893, -38.69376130923258, -24.569580549282747, -25.32785631190393, -25.30743759062487, -34.56144573419807, -20.941797094784924, -14.436773333214683, -25.272694858954093, -26.834624977801884, -34.70206319144881, -25.104994418953506, -19.92772640145992, -14.459433595149948, -28.412965104081454, -12.473584888174482], "policy_predator_policy_reward": [18.14457035564491, 17.63457558811114, 25.184757638564935, 8.853651048407258, 22.951762119309507, 31.003856019932716, 43.24102297642655, 15.377637029714197, 20.278460539638644, 28.251255248906048, 50.20626037429806, 19.202573228280325, 24.24733323097596, 5.21275446878732, 13.870476946974046, 17.489998251417717, 31.266819782782452, 23.57281450460277, 17.673100144146197, 35.17673784243502, 10.393283273771276, 16.855575195213166, 29.720276436792584, 33.53802014783235, 56.586540885292614, 33.04517121740702, 12.27517084006898, 30.21045248989878, 24.359695861950584, 18.438838286147416, 13.430554279059933, 49.01995328933385, 28.85310829722092, 33.176897811248345, 11.66320866382286, 27.162134557537364, 14.498902116490319, 26.308554026116827, 40.46402017948749, 38.9290126473446, 30.257926021711796, 31.95946092162341, 32.34990549545846, 30.006517113937768, 24.0277616627429, 39.7891209221009, 8.187685353989707, 36.89888586177501, 24.336529398933937, 26.379559837637395, 45.10221942246733, 43.35443176762078, 31.6820006559218, 27.916532621425226, 20.94585424127552, 14.342312269370767, 26.741986763227047, 4.1154551443873295, 6.268534708507673, 42.96220659249882, 18.59932469783231, 25.608779146305622, 19.34826777678735, 46.908880684926366, 15.105058297109123, 20.683659213542242, 17.290530876850877, 50.00227536565739, 45.62287203556442, 20.339338855580458, 34.17612302260176, 44.312654440385245, 51.17422022113299, 11.410363044188617, 26.521815219627307, 29.842761757829336, 16.331783826383344, 10.219544595131127, 39.14368856639329, 42.101694938327434, 13.081306077245255, 21.650144440027468, 12.089402334951039, 32.65735121651078, 22.10207873363893, 38.69376130923258, 24.569580549282747, 25.32785631190393, 25.30743759062487, 34.56144573419807, 20.941797094784924, 14.436773333214683, 25.272694858954093, 26.834624977801884, 34.70206319144881, 25.104994418953506, 19.92772640145992, 14.459433595149948, 28.412965104081454, 12.473584888174482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29224363874938797, "mean_inference_ms": 0.9438179158570946, "mean_action_processing_ms": 0.12518337265394097, "mean_env_wait_ms": 0.06607036421170234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030355453491210938, "StateBufferConnector_ms": 0.002082228660583496, "ViewRequirementAgentConnector_ms": 0.046746134757995605}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 640.387710317629, "num_env_steps_trained_throughput_per_sec": 640.387710317629, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 5992.795, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5992.744, "sample_time_ms": 652.452, "learn_time_ms": 5324.744, "learn_throughput": 751.21, "synch_weights_time_ms": 14.9}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "training_iteration": 79, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-38", "timestamp": 1723390718, "time_this_iter_s": 6.251988887786865, "time_total_s": 462.67101788520813, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 462.67101788520813, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 31.91111111111111, "ram_util_percent": 83.08888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.856807384019097, "cur_kl_coeff": 5.722045898437499e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3815483872157832, "policy_loss": -0.007906158307741861, "vf_loss": 1.3894545489922165, "vf_explained_var": 0.9419510461390018, "kl": 0.015584892077139478, "entropy": 0.5671487095455329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0251233144352834, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3916036861017347, "policy_loss": -0.0015490608692440824, "vf_loss": 1.3929986796031395, "vf_explained_var": 0.9422012879823645, "kl": 0.006162756705222586, "entropy": 0.603598752245307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.63, "episode_media": {}, "episodes_this_iter": 54, "episodes_timesteps_total": 6863, "policy_reward_min": {"prey_policy": -51.17422022113299, "predator_policy": 1.6198512593169894}, "policy_reward_max": {"prey_policy": -1.6198512593169894, "predator_policy": 51.17422022113299}, "policy_reward_mean": {"prey_policy": -24.950136901087845, "predator_policy": 24.950136901087845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [64, 32, 66, 32, 56, 90, 45, 53, 90, 53, 51, 44, 36, 83, 81, 56, 91, 82, 92, 91, 94, 90, 58, 58, 66, 96, 59, 82, 41, 80, 40, 72, 71, 95, 83, 84, 54, 45, 81, 78, 59, 76, 31, 28, 64, 89, 39, 20, 30, 88, 122, 64, 68, 64, 61, 74, 115, 69, 82, 69, 103, 62, 66, 61, 102, 115, 122, 68, 38, 34, 71, 80, 66, 5, 84, 74, 69, 87, 72, 69, 106, 96, 95, 20, 43, 72, 97, 58, 52, 36, 127, 113, 54, 100, 66, 53, 39, 60, 49, 52], "policy_prey_policy_reward": [-20.94585424127552, -14.342312269370767, -26.741986763227047, -4.1154551443873295, -6.268534708507673, -42.96220659249882, -18.59932469783231, -25.608779146305622, -19.34826777678735, -46.908880684926366, -15.105058297109123, -20.683659213542242, -17.290530876850877, -50.00227536565739, -45.62287203556442, -20.339338855580458, -34.17612302260176, -44.312654440385245, -51.17422022113299, -11.410363044188617, -26.521815219627307, -29.842761757829336, -16.331783826383344, -10.219544595131127, -39.14368856639329, -42.101694938327434, -13.081306077245255, -21.650144440027468, -12.089402334951039, -32.65735121651078, -22.10207873363893, -38.69376130923258, -24.569580549282747, -25.32785631190393, -25.30743759062487, -34.56144573419807, -20.941797094784924, -14.436773333214683, -25.272694858954093, -26.834624977801884, -34.70206319144881, -25.104994418953506, -19.92772640145992, -14.459433595149948, -28.412965104081454, -12.473584888174482, -11.664410923257332, -5.357322146821191, -11.728204606414595, -29.478405290860326, -33.14722294723546, -35.53109868004913, -23.83625383408942, -29.222181959386084, -21.37326739302036, -46.49485702772932, -11.568220855413514, -37.1400361300883, -32.60812131920771, -21.925675990659716, -31.876600932541848, -9.189659515810664, -27.538520219870918, -19.08286834693498, -32.2542687342394, -28.803253282422606, -32.155285717535065, -33.80690872681947, -13.579458080604635, -9.17550038898038, -17.21632577708003, -26.05958041319121, -33.19972757279845, -1.6198512593169894, -32.42646833646447, -34.79234469672184, -32.09128535439586, -25.545703085392443, -24.225403274434907, -33.746608119109894, -34.63445284280939, -27.62612566832992, -39.61578507774994, -8.312478457071922, -23.242211317634865, -45.45899265612798, -40.60369255812293, -19.01719797874421, -30.010321823467542, -9.054074308561905, -24.417371506314044, -13.094142371571712, -31.99762621933879, -32.076836289398045, -10.175696561276304, -15.325978461316588, -14.21113689813453, -23.703602694374304, -8.579422750206952, -21.668634266270875], "policy_predator_policy_reward": [20.94585424127552, 14.342312269370767, 26.741986763227047, 4.1154551443873295, 6.268534708507673, 42.96220659249882, 18.59932469783231, 25.608779146305622, 19.34826777678735, 46.908880684926366, 15.105058297109123, 20.683659213542242, 17.290530876850877, 50.00227536565739, 45.62287203556442, 20.339338855580458, 34.17612302260176, 44.312654440385245, 51.17422022113299, 11.410363044188617, 26.521815219627307, 29.842761757829336, 16.331783826383344, 10.219544595131127, 39.14368856639329, 42.101694938327434, 13.081306077245255, 21.650144440027468, 12.089402334951039, 32.65735121651078, 22.10207873363893, 38.69376130923258, 24.569580549282747, 25.32785631190393, 25.30743759062487, 34.56144573419807, 20.941797094784924, 14.436773333214683, 25.272694858954093, 26.834624977801884, 34.70206319144881, 25.104994418953506, 19.92772640145992, 14.459433595149948, 28.412965104081454, 12.473584888174482, 11.664410923257332, 5.357322146821191, 11.728204606414595, 29.478405290860326, 33.14722294723546, 35.53109868004913, 23.83625383408942, 29.222181959386084, 21.37326739302036, 46.49485702772932, 11.568220855413514, 37.1400361300883, 32.60812131920771, 21.925675990659716, 31.876600932541848, 9.189659515810664, 27.538520219870918, 19.08286834693498, 32.2542687342394, 28.803253282422606, 32.155285717535065, 33.80690872681947, 13.579458080604635, 9.17550038898038, 17.21632577708003, 26.05958041319121, 33.19972757279845, 1.6198512593169894, 32.42646833646447, 34.79234469672184, 32.09128535439586, 25.545703085392443, 24.225403274434907, 33.746608119109894, 34.63445284280939, 27.62612566832992, 39.61578507774994, 8.312478457071922, 23.242211317634865, 45.45899265612798, 40.60369255812293, 19.01719797874421, 30.010321823467542, 9.054074308561905, 24.417371506314044, 13.094142371571712, 31.99762621933879, 32.076836289398045, 10.175696561276304, 15.325978461316588, 14.21113689813453, 23.703602694374304, 8.579422750206952, 21.668634266270875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29234071724217564, "mean_inference_ms": 0.94343887214477, "mean_action_processing_ms": 0.1251738470684001, "mean_env_wait_ms": 0.06607877374528309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687143325805664, "StateBufferConnector_ms": 0.002008199691772461, "ViewRequirementAgentConnector_ms": 0.04648613929748535}, "num_episodes": 54, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 670.5278909353685, "num_env_steps_trained_throughput_per_sec": 670.5278909353685, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 5990.487, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5990.434, "sample_time_ms": 649.308, "learn_time_ms": 5325.423, "learn_throughput": 751.114, "synch_weights_time_ms": 15.015}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 80, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-44", "timestamp": 1723390724, "time_this_iter_s": 5.971674680709839, "time_total_s": 468.64269256591797, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.64269256591797, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 27.9125, "ram_util_percent": 83.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.131563533718387, "cur_kl_coeff": 5.722045898437499e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3965158597255747, "policy_loss": -0.0015192578663118183, "vf_loss": 1.3980351124579709, "vf_explained_var": 0.9661351220682264, "kl": 0.004570924945155852, "entropy": 0.5079482773939769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.310239348933101, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4031341544662912, "policy_loss": -0.003772961073264014, "vf_loss": 1.4067639629046123, "vf_explained_var": 0.9658634915947915, "kl": 0.005726109642568981, "entropy": 0.6334918066859245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 70.23, "episode_media": {}, "episodes_this_iter": 57, "episodes_timesteps_total": 7023, "policy_reward_min": {"prey_policy": -50.48512697977194, "predator_policy": 1.6198512593169894}, "policy_reward_max": {"prey_policy": -1.6198512593169894, "predator_policy": 50.48512697977194}, "policy_reward_mean": {"prey_policy": -25.501223933075277, "predator_policy": 25.501223933075277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [69, 82, 69, 103, 62, 66, 61, 102, 115, 122, 68, 38, 34, 71, 80, 66, 5, 84, 74, 69, 87, 72, 69, 106, 96, 95, 20, 43, 72, 97, 58, 52, 36, 127, 113, 54, 100, 66, 53, 39, 60, 49, 52, 89, 91, 94, 60, 47, 90, 33, 71, 114, 80, 63, 71, 70, 72, 72, 29, 107, 70, 55, 55, 85, 102, 74, 103, 45, 102, 62, 106, 14, 70, 109, 22, 65, 26, 96, 60, 56, 57, 45, 63, 58, 60, 97, 83, 30, 60, 102, 55, 53, 20, 91, 81, 58, 89, 57, 105, 73], "policy_prey_policy_reward": [-37.1400361300883, -32.60812131920771, -21.925675990659716, -31.876600932541848, -9.189659515810664, -27.538520219870918, -19.08286834693498, -32.2542687342394, -28.803253282422606, -32.155285717535065, -33.80690872681947, -13.579458080604635, -9.17550038898038, -17.21632577708003, -26.05958041319121, -33.19972757279845, -1.6198512593169894, -32.42646833646447, -34.79234469672184, -32.09128535439586, -25.545703085392443, -24.225403274434907, -33.746608119109894, -34.63445284280939, -27.62612566832992, -39.61578507774994, -8.312478457071922, -23.242211317634865, -45.45899265612798, -40.60369255812293, -19.01719797874421, -30.010321823467542, -9.054074308561905, -24.417371506314044, -13.094142371571712, -31.99762621933879, -32.076836289398045, -10.175696561276304, -15.325978461316588, -14.21113689813453, -23.703602694374304, -8.579422750206952, -21.668634266270875, -46.24407440648185, -32.4757446121369, -26.588593778648516, -38.06991858523298, -22.619154873003133, -50.48512697977194, -15.809418953018278, -29.660074992328223, -37.104255336954374, -45.03179123204417, -29.359099045308902, -32.553921053157424, -37.40710326020908, -28.522763595380788, -36.822280351677335, -8.88896638245606, -26.589035945070332, -11.951891471325876, -17.66636927545901, -12.209780788008544, -34.2705529874216, -18.809325224219066, -19.239968573766053, -19.306007321139806, -30.69153624853655, -28.002044504903015, -35.560707409183934, -11.613665450321815, -9.021810918355422, -37.06134427076561, -32.264198948578525, -6.743659990785135, -23.945251363786703, -13.871622350557775, -27.26942736575608, -13.862286549045113, -22.358160443642987, -13.022323814573518, -16.663324124930348, -22.841168805170433, -18.862637474140584, -34.96197932959742, -40.7104105519606, -34.55652992182943, -7.0085043456465765, -18.184459546740516, -36.2747636471714, -37.860436130276646, -37.370376687543256, -8.093960305358825, -21.77277692712741, -40.972430354309765, -26.7099850509993, -23.902509043025812, -4.952903298546373, -25.548299913179456, -47.0164432155161], "policy_predator_policy_reward": [37.1400361300883, 32.60812131920771, 21.925675990659716, 31.876600932541848, 9.189659515810664, 27.538520219870918, 19.08286834693498, 32.2542687342394, 28.803253282422606, 32.155285717535065, 33.80690872681947, 13.579458080604635, 9.17550038898038, 17.21632577708003, 26.05958041319121, 33.19972757279845, 1.6198512593169894, 32.42646833646447, 34.79234469672184, 32.09128535439586, 25.545703085392443, 24.225403274434907, 33.746608119109894, 34.63445284280939, 27.62612566832992, 39.61578507774994, 8.312478457071922, 23.242211317634865, 45.45899265612798, 40.60369255812293, 19.01719797874421, 30.010321823467542, 9.054074308561905, 24.417371506314044, 13.094142371571712, 31.99762621933879, 32.076836289398045, 10.175696561276304, 15.325978461316588, 14.21113689813453, 23.703602694374304, 8.579422750206952, 21.668634266270875, 46.24407440648185, 32.4757446121369, 26.588593778648516, 38.06991858523298, 22.619154873003133, 50.48512697977194, 15.809418953018278, 29.660074992328223, 37.104255336954374, 45.03179123204417, 29.359099045308902, 32.553921053157424, 37.40710326020908, 28.522763595380788, 36.822280351677335, 8.88896638245606, 26.589035945070332, 11.951891471325876, 17.66636927545901, 12.209780788008544, 34.2705529874216, 18.809325224219066, 19.239968573766053, 19.306007321139806, 30.69153624853655, 28.002044504903015, 35.560707409183934, 11.613665450321815, 9.021810918355422, 37.06134427076561, 32.264198948578525, 6.743659990785135, 23.945251363786703, 13.871622350557775, 27.26942736575608, 13.862286549045113, 22.358160443642987, 13.022323814573518, 16.663324124930348, 22.841168805170433, 18.862637474140584, 34.96197932959742, 40.7104105519606, 34.55652992182943, 7.0085043456465765, 18.184459546740516, 36.2747636471714, 37.860436130276646, 37.370376687543256, 8.093960305358825, 21.77277692712741, 40.972430354309765, 26.7099850509993, 23.902509043025812, 4.952903298546373, 25.548299913179456, 47.0164432155161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920111499022216, "mean_inference_ms": 0.9419708571087076, "mean_action_processing_ms": 0.12497637149860451, "mean_env_wait_ms": 0.06592097928536975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037317276000976562, "StateBufferConnector_ms": 0.0019696950912475586, "ViewRequirementAgentConnector_ms": 0.04748570919036865}, "num_episodes": 57, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 695.9032990170083, "num_env_steps_trained_throughput_per_sec": 695.9032990170083, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 5971.438, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5971.385, "sample_time_ms": 647.434, "learn_time_ms": 5308.356, "learn_throughput": 753.529, "synch_weights_time_ms": 14.952}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 81, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-50", "timestamp": 1723390730, "time_this_iter_s": 5.752880811691284, "time_total_s": 474.39557337760925, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.39557337760925, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.099999999999998, "ram_util_percent": 83.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0000470757484434, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3754501026744643, "policy_loss": -0.003492411645614387, "vf_loss": 1.3789425153285264, "vf_explained_var": 0.9653063343216975, "kl": 0.009974496158565565, "entropy": 0.549968437757343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1171038786570233, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.385327660354475, "policy_loss": -0.006770265975501388, "vf_loss": 1.3918961540485422, "vf_explained_var": 0.9653069982926051, "kl": 0.00807076533835449, "entropy": 0.6334057626624902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 72.48, "episode_media": {}, "episodes_this_iter": 54, "episodes_timesteps_total": 7248, "policy_reward_min": {"prey_policy": -54.050098225671974, "predator_policy": 4.699601206102244}, "policy_reward_max": {"prey_policy": -4.699601206102244, "predator_policy": 54.050098225671974}, "policy_reward_mean": {"prey_policy": -25.035214499835163, "predator_policy": 25.035214499835163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [71, 70, 72, 72, 29, 107, 70, 55, 55, 85, 102, 74, 103, 45, 102, 62, 106, 14, 70, 109, 22, 65, 26, 96, 60, 56, 57, 45, 63, 58, 60, 97, 83, 30, 60, 102, 55, 53, 20, 91, 81, 58, 89, 57, 105, 73, 60, 107, 33, 91, 86, 37, 80, 149, 127, 41, 62, 100, 77, 82, 95, 39, 51, 78, 77, 60, 62, 41, 153, 33, 30, 61, 80, 104, 69, 135, 56, 83, 56, 100, 51, 45, 90, 49, 66, 77, 106, 96, 93, 108, 90, 112, 21, 65, 126, 93, 19, 80, 20, 111], "policy_prey_policy_reward": [-32.553921053157424, -37.40710326020908, -28.522763595380788, -36.822280351677335, -8.88896638245606, -26.589035945070332, -11.951891471325876, -17.66636927545901, -12.209780788008544, -34.2705529874216, -18.809325224219066, -19.239968573766053, -19.306007321139806, -30.69153624853655, -28.002044504903015, -35.560707409183934, -11.613665450321815, -9.021810918355422, -37.06134427076561, -32.264198948578525, -6.743659990785135, -23.945251363786703, -13.871622350557775, -27.26942736575608, -13.862286549045113, -22.358160443642987, -13.022323814573518, -16.663324124930348, -22.841168805170433, -18.862637474140584, -34.96197932959742, -40.7104105519606, -34.55652992182943, -7.0085043456465765, -18.184459546740516, -36.2747636471714, -37.860436130276646, -37.370376687543256, -8.093960305358825, -21.77277692712741, -40.972430354309765, -26.7099850509993, -23.902509043025812, -4.952903298546373, -25.548299913179456, -47.0164432155161, -42.66336758377974, -34.88247347307566, -7.193490265384881, -46.60775090171669, -27.107085846768143, -11.528452805936887, -22.883074186523533, -46.25149430689462, -54.050098225671974, -14.536822586546952, -25.466387382601926, -27.378459631086614, -19.45327290154346, -28.855604054319087, -40.886269751816734, -15.492193361447354, -15.070448378862027, -23.508753087030524, -13.413826310176095, -30.859732413528732, -38.789859097700855, -19.113273446182742, -28.516101249752644, -10.366422068254758, -23.502181003238597, -8.289466905837958, -18.173421868456177, -12.161388959246107, -26.231425706239456, -52.04540955646349, -10.13120268761359, -32.27657903528126, -23.49416648491859, -42.059011800745154, -4.699601206102244, -13.209278050153651, -30.41832018896477, -24.817700372635212, -28.109573895779416, -37.86471415066289, -25.73390892538371, -44.8954246243068, -49.535710218268534, -24.497324564641918, -19.300374828911735, -43.25406882830091, -4.79870688567911, -23.42303345348425, -19.84724809236727, -28.756054009619106, -14.623605739612465, -17.875318420801925, -7.905639971622654, -32.92697170042135], "policy_predator_policy_reward": [32.553921053157424, 37.40710326020908, 28.522763595380788, 36.822280351677335, 8.88896638245606, 26.589035945070332, 11.951891471325876, 17.66636927545901, 12.209780788008544, 34.2705529874216, 18.809325224219066, 19.239968573766053, 19.306007321139806, 30.69153624853655, 28.002044504903015, 35.560707409183934, 11.613665450321815, 9.021810918355422, 37.06134427076561, 32.264198948578525, 6.743659990785135, 23.945251363786703, 13.871622350557775, 27.26942736575608, 13.862286549045113, 22.358160443642987, 13.022323814573518, 16.663324124930348, 22.841168805170433, 18.862637474140584, 34.96197932959742, 40.7104105519606, 34.55652992182943, 7.0085043456465765, 18.184459546740516, 36.2747636471714, 37.860436130276646, 37.370376687543256, 8.093960305358825, 21.77277692712741, 40.972430354309765, 26.7099850509993, 23.902509043025812, 4.952903298546373, 25.548299913179456, 47.0164432155161, 42.66336758377974, 34.88247347307566, 7.193490265384881, 46.60775090171669, 27.107085846768143, 11.528452805936887, 22.883074186523533, 46.25149430689462, 54.050098225671974, 14.536822586546952, 25.466387382601926, 27.378459631086614, 19.45327290154346, 28.855604054319087, 40.886269751816734, 15.492193361447354, 15.070448378862027, 23.508753087030524, 13.413826310176095, 30.859732413528732, 38.789859097700855, 19.113273446182742, 28.516101249752644, 10.366422068254758, 23.502181003238597, 8.289466905837958, 18.173421868456177, 12.161388959246107, 26.231425706239456, 52.04540955646349, 10.13120268761359, 32.27657903528126, 23.49416648491859, 42.059011800745154, 4.699601206102244, 13.209278050153651, 30.41832018896477, 24.817700372635212, 28.109573895779416, 37.86471415066289, 25.73390892538371, 44.8954246243068, 49.535710218268534, 24.497324564641918, 19.300374828911735, 43.25406882830091, 4.79870688567911, 23.42303345348425, 19.84724809236727, 28.756054009619106, 14.623605739612465, 17.875318420801925, 7.905639971622654, 32.92697170042135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918179615862453, "mean_inference_ms": 0.9403061337679433, "mean_action_processing_ms": 0.12483553510283266, "mean_env_wait_ms": 0.06587959926873074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026401281356811523, "StateBufferConnector_ms": 0.0018674135208129883, "ViewRequirementAgentConnector_ms": 0.04494607448577881}, "num_episodes": 54, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 678.9201193608513, "num_env_steps_trained_throughput_per_sec": 678.9201193608513, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 5956.959, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5956.907, "sample_time_ms": 645.759, "learn_time_ms": 5295.575, "learn_throughput": 755.348, "synch_weights_time_ms": 14.991}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 82, "trial_id": "abfb9_00000", "date": "2024-08-11_11-38-56", "timestamp": 1723390736, "time_this_iter_s": 5.897110939025879, "time_total_s": 480.29268431663513, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 480.29268431663513, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 26.35, "ram_util_percent": 83.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9781821577499312, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5141004429509242, "policy_loss": -0.004507800427381881, "vf_loss": 1.518608240224421, "vf_explained_var": 0.9624749522035321, "kl": 0.005868208488378745, "entropy": 0.4685538715993365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.074728984571993, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5594594582294425, "policy_loss": -0.0027055190100024142, "vf_loss": 1.5620501949141423, "vf_explained_var": 0.9620086220403512, "kl": 0.004591316592884733, "entropy": 0.6092734459166725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 75.17, "episode_media": {}, "episodes_this_iter": 54, "episodes_timesteps_total": 7517, "policy_reward_min": {"prey_policy": -54.050098225671974, "predator_policy": 1.5861316731899309}, "policy_reward_max": {"prey_policy": -1.5861316731899309, "predator_policy": 54.050098225671974}, "policy_reward_mean": {"prey_policy": -25.298842504898534, "predator_policy": 25.298842504898534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [127, 41, 62, 100, 77, 82, 95, 39, 51, 78, 77, 60, 62, 41, 153, 33, 30, 61, 80, 104, 69, 135, 56, 83, 56, 100, 51, 45, 90, 49, 66, 77, 106, 96, 93, 108, 90, 112, 21, 65, 126, 93, 19, 80, 20, 111, 88, 37, 76, 92, 65, 23, 76, 29, 51, 72, 143, 67, 90, 50, 106, 59, 79, 96, 96, 131, 83, 107, 33, 33, 87, 65, 84, 117, 60, 15, 61, 74, 85, 70, 64, 36, 178, 84, 95, 58, 102, 77, 89, 95, 71, 49, 67, 85, 83, 109, 46, 41, 57, 61], "policy_prey_policy_reward": [-54.050098225671974, -14.536822586546952, -25.466387382601926, -27.378459631086614, -19.45327290154346, -28.855604054319087, -40.886269751816734, -15.492193361447354, -15.070448378862027, -23.508753087030524, -13.413826310176095, -30.859732413528732, -38.789859097700855, -19.113273446182742, -28.516101249752644, -10.366422068254758, -23.502181003238597, -8.289466905837958, -18.173421868456177, -12.161388959246107, -26.231425706239456, -52.04540955646349, -10.13120268761359, -32.27657903528126, -23.49416648491859, -42.059011800745154, -4.699601206102244, -13.209278050153651, -30.41832018896477, -24.817700372635212, -28.109573895779416, -37.86471415066289, -25.73390892538371, -44.8954246243068, -49.535710218268534, -24.497324564641918, -19.300374828911735, -43.25406882830091, -4.79870688567911, -23.42303345348425, -19.84724809236727, -28.756054009619106, -14.623605739612465, -17.875318420801925, -7.905639971622654, -32.92697170042135, -41.278411585420194, -2.2069947673183563, -29.952468405387602, -23.397519125676148, -34.579799679182806, -8.406387267546172, -15.424254423657636, -21.197566568770167, -7.880528798365017, -29.04303758767698, -22.33069080851032, -43.45325183058218, -28.742869696418246, -21.13963144563912, -48.55152111530581, -29.88201388445246, -25.065232111553048, -23.485972839907785, -43.52676049131207, -17.24720149915626, -36.789354191298536, -53.69515299993493, -24.98479129130536, -10.612406744292937, -32.72924444782664, -23.332795552920967, -27.64275459823503, -15.224299351278075, -7.280120449656501, -7.856630726633988, -20.265533558345194, -10.080721158419083, -20.910219734404798, -39.89257366792367, -29.936358453110497, -17.570336760570964, -18.411506921604335, -45.357763660463775, -42.61081838706025, -30.600159379024685, -18.698483955266656, -37.32371283548543, -9.372533169287813, -37.93138978049561, -38.036438820459125, -22.06895976210216, -39.231676478603035, -43.77449411518969, -19.47967381299619, -29.7166038570446, -1.5861316731899309, -11.046804404327196, -15.696878834887091, -22.73045694208773], "policy_predator_policy_reward": [54.050098225671974, 14.536822586546952, 25.466387382601926, 27.378459631086614, 19.45327290154346, 28.855604054319087, 40.886269751816734, 15.492193361447354, 15.070448378862027, 23.508753087030524, 13.413826310176095, 30.859732413528732, 38.789859097700855, 19.113273446182742, 28.516101249752644, 10.366422068254758, 23.502181003238597, 8.289466905837958, 18.173421868456177, 12.161388959246107, 26.231425706239456, 52.04540955646349, 10.13120268761359, 32.27657903528126, 23.49416648491859, 42.059011800745154, 4.699601206102244, 13.209278050153651, 30.41832018896477, 24.817700372635212, 28.109573895779416, 37.86471415066289, 25.73390892538371, 44.8954246243068, 49.535710218268534, 24.497324564641918, 19.300374828911735, 43.25406882830091, 4.79870688567911, 23.42303345348425, 19.84724809236727, 28.756054009619106, 14.623605739612465, 17.875318420801925, 7.905639971622654, 32.92697170042135, 41.278411585420194, 2.2069947673183563, 29.952468405387602, 23.397519125676148, 34.579799679182806, 8.406387267546172, 15.424254423657636, 21.197566568770167, 7.880528798365017, 29.04303758767698, 22.33069080851032, 43.45325183058218, 28.742869696418246, 21.13963144563912, 48.55152111530581, 29.88201388445246, 25.065232111553048, 23.485972839907785, 43.52676049131207, 17.24720149915626, 36.789354191298536, 53.69515299993493, 24.98479129130536, 10.612406744292937, 32.72924444782664, 23.332795552920967, 27.64275459823503, 15.224299351278075, 7.280120449656501, 7.856630726633988, 20.265533558345194, 10.080721158419083, 20.910219734404798, 39.89257366792367, 29.936358453110497, 17.570336760570964, 18.411506921604335, 45.357763660463775, 42.61081838706025, 30.600159379024685, 18.698483955266656, 37.32371283548543, 9.372533169287813, 37.93138978049561, 38.036438820459125, 22.06895976210216, 39.231676478603035, 43.77449411518969, 19.47967381299619, 29.7166038570446, 1.5861316731899309, 11.046804404327196, 15.696878834887091, 22.73045694208773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29176772837345566, "mean_inference_ms": 0.9397582052883995, "mean_action_processing_ms": 0.12473931239801576, "mean_env_wait_ms": 0.06586648127870089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027294158935546875, "StateBufferConnector_ms": 0.0019282102584838867, "ViewRequirementAgentConnector_ms": 0.04569375514984131}, "num_episodes": 54, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 666.535350391577, "num_env_steps_trained_throughput_per_sec": 666.535350391577, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 5965.372, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5965.32, "sample_time_ms": 651.826, "learn_time_ms": 5297.944, "learn_throughput": 755.01, "synch_weights_time_ms": 14.979}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "training_iteration": 83, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-02", "timestamp": 1723390742, "time_this_iter_s": 6.006105899810791, "time_total_s": 486.2987902164459, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001d790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 486.2987902164459, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 27.388888888888893, "ram_util_percent": 82.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.103699519423147, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6086128398155173, "policy_loss": -0.0034230258568034816, "vf_loss": 1.6120358697449169, "vf_explained_var": 0.9534804483875632, "kl": 0.007395832295154866, "entropy": 0.4758201101484398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2315388444811104, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5753154155487816, "policy_loss": -0.002254947661519206, "vf_loss": 1.57750660063078, "vf_explained_var": 0.9543896770725647, "kl": 0.005101178826886762, "entropy": 0.6393067670365175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 73.26, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 7326, "policy_reward_min": {"prey_policy": -53.69515299993493, "predator_policy": 1.5861316731899309}, "policy_reward_max": {"prey_policy": -1.5861316731899309, "predator_policy": 53.69515299993493}, "policy_reward_mean": {"prey_policy": -25.683540392081028, "predator_policy": 25.683540392081028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [143, 67, 90, 50, 106, 59, 79, 96, 96, 131, 83, 107, 33, 33, 87, 65, 84, 117, 60, 15, 61, 74, 85, 70, 64, 36, 178, 84, 95, 58, 102, 77, 89, 95, 71, 49, 67, 85, 83, 109, 46, 41, 57, 61, 74, 81, 86, 8, 56, 63, 87, 68, 36, 115, 38, 47, 77, 41, 86, 42, 90, 62, 64, 51, 93, 75, 18, 50, 79, 121, 76, 66, 70, 70, 94, 52, 56, 76, 140, 82, 63, 60, 67, 87, 10, 34, 94, 29, 124, 95, 40, 73, 130, 76, 59, 102, 52, 52, 58, 93], "policy_prey_policy_reward": [-22.33069080851032, -43.45325183058218, -28.742869696418246, -21.13963144563912, -48.55152111530581, -29.88201388445246, -25.065232111553048, -23.485972839907785, -43.52676049131207, -17.24720149915626, -36.789354191298536, -53.69515299993493, -24.98479129130536, -10.612406744292937, -32.72924444782664, -23.332795552920967, -27.64275459823503, -15.224299351278075, -7.280120449656501, -7.856630726633988, -20.265533558345194, -10.080721158419083, -20.910219734404798, -39.89257366792367, -29.936358453110497, -17.570336760570964, -18.411506921604335, -45.357763660463775, -42.61081838706025, -30.600159379024685, -18.698483955266656, -37.32371283548543, -9.372533169287813, -37.93138978049561, -38.036438820459125, -22.06895976210216, -39.231676478603035, -43.77449411518969, -19.47967381299619, -29.7166038570446, -1.5861316731899309, -11.046804404327196, -15.696878834887091, -22.73045694208773, -39.15101414072064, -40.20174256444507, -34.19688740495633, -3.8061976362123766, -34.56177266035773, -18.166370596345356, -47.06448728436945, -48.45226836579779, -13.427564488016046, -39.090001658634236, -19.362979722535897, -17.24920562580566, -23.681266266950978, -7.126528075540242, -14.37365827249848, -19.576275250863628, -45.21630322533724, -22.9803575275366, -28.183509999424636, -6.590300689560772, -36.87983838886719, -7.834324170437575, -3.203107858098991, -16.338385696065522, -21.183800490554045, -11.195167891433327, -38.3045343379086, -2.735840482563937, -47.320097218925355, -39.20716021841293, -17.702362209465015, -15.736645282255541, -18.265680719504022, -20.32515029837122, -46.91917016569083, -39.34785763692419, -6.469310478847816, -15.290035309345816, -36.51562297138414, -28.35308124573924, -2.1592113330702416, -5.874099124004049, -9.448369906330498, -11.376415199184818, -44.136614928222166, -38.02765005266988, -22.209167897869005, -43.42832365505005, -21.63048849121528, -31.694043296337593, -44.2476313834966, -42.227930893768246, -35.12989144814853, -18.534941898899127, -24.709711942739325, -16.030757031822873], "policy_predator_policy_reward": [22.33069080851032, 43.45325183058218, 28.742869696418246, 21.13963144563912, 48.55152111530581, 29.88201388445246, 25.065232111553048, 23.485972839907785, 43.52676049131207, 17.24720149915626, 36.789354191298536, 53.69515299993493, 24.98479129130536, 10.612406744292937, 32.72924444782664, 23.332795552920967, 27.64275459823503, 15.224299351278075, 7.280120449656501, 7.856630726633988, 20.265533558345194, 10.080721158419083, 20.910219734404798, 39.89257366792367, 29.936358453110497, 17.570336760570964, 18.411506921604335, 45.357763660463775, 42.61081838706025, 30.600159379024685, 18.698483955266656, 37.32371283548543, 9.372533169287813, 37.93138978049561, 38.036438820459125, 22.06895976210216, 39.231676478603035, 43.77449411518969, 19.47967381299619, 29.7166038570446, 1.5861316731899309, 11.046804404327196, 15.696878834887091, 22.73045694208773, 39.15101414072064, 40.20174256444507, 34.19688740495633, 3.8061976362123766, 34.56177266035773, 18.166370596345356, 47.06448728436945, 48.45226836579779, 13.427564488016046, 39.090001658634236, 19.362979722535897, 17.24920562580566, 23.681266266950978, 7.126528075540242, 14.37365827249848, 19.576275250863628, 45.21630322533724, 22.9803575275366, 28.183509999424636, 6.590300689560772, 36.87983838886719, 7.834324170437575, 3.203107858098991, 16.338385696065522, 21.183800490554045, 11.195167891433327, 38.3045343379086, 2.735840482563937, 47.320097218925355, 39.20716021841293, 17.702362209465015, 15.736645282255541, 18.265680719504022, 20.32515029837122, 46.91917016569083, 39.34785763692419, 6.469310478847816, 15.290035309345816, 36.51562297138414, 28.35308124573924, 2.1592113330702416, 5.874099124004049, 9.448369906330498, 11.376415199184818, 44.136614928222166, 38.02765005266988, 22.209167897869005, 43.42832365505005, 21.63048849121528, 31.694043296337593, 44.2476313834966, 42.227930893768246, 35.12989144814853, 18.534941898899127, 24.709711942739325, 16.030757031822873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2914524057634687, "mean_inference_ms": 0.9388312010077305, "mean_action_processing_ms": 0.12468859183780179, "mean_env_wait_ms": 0.06575783189373144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002746105194091797, "StateBufferConnector_ms": 0.0019207000732421875, "ViewRequirementAgentConnector_ms": 0.04473412036895752}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.8778578979916, "num_env_steps_trained_throughput_per_sec": 677.8778578979916, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 5964.225, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5964.173, "sample_time_ms": 646.859, "learn_time_ms": 5301.796, "learn_throughput": 754.461, "synch_weights_time_ms": 14.945}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 84, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-08", "timestamp": 1723390748, "time_this_iter_s": 5.9060070514678955, "time_total_s": 492.2047972679138, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d2670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 492.2047972679138, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 28.5875, "ram_util_percent": 82.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.229646813000242, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.685358309932053, "policy_loss": -0.0016667296219869362, "vf_loss": 1.6870250468452772, "vf_explained_var": 0.9393020875131091, "kl": 0.006182429394432582, "entropy": 0.48445417784775296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.293181155746182, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6588862597942353, "policy_loss": -0.005387071341101546, "vf_loss": 1.6641716324413816, "vf_explained_var": 0.9238032060364882, "kl": 0.008135710203546476, "entropy": 0.6346615254258116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.97, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6997, "policy_reward_min": {"prey_policy": -53.287603162263366, "predator_policy": 1.219621221621916}, "policy_reward_max": {"prey_policy": -1.219621221621916, "predator_policy": 53.287603162263366}, "policy_reward_mean": {"prey_policy": -25.356638747693527, "predator_policy": 25.356638747693527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [42, 90, 62, 64, 51, 93, 75, 18, 50, 79, 121, 76, 66, 70, 70, 94, 52, 56, 76, 140, 82, 63, 60, 67, 87, 10, 34, 94, 29, 124, 95, 40, 73, 130, 76, 59, 102, 52, 52, 58, 93, 80, 97, 47, 61, 35, 87, 84, 63, 64, 93, 75, 84, 29, 45, 69, 68, 88, 32, 102, 117, 52, 60, 1, 73, 79, 45, 47, 105, 61, 68, 52, 53, 48, 97, 90, 96, 89, 65, 54, 94, 85, 35, 117, 62, 59, 65, 80, 91, 90, 64, 80, 91, 64, 63, 81, 64, 52, 79, 1], "policy_prey_policy_reward": [-19.576275250863628, -45.21630322533724, -22.9803575275366, -28.183509999424636, -6.590300689560772, -36.87983838886719, -7.834324170437575, -3.203107858098991, -16.338385696065522, -21.183800490554045, -11.195167891433327, -38.3045343379086, -2.735840482563937, -47.320097218925355, -39.20716021841293, -17.702362209465015, -15.736645282255541, -18.265680719504022, -20.32515029837122, -46.91917016569083, -39.34785763692419, -6.469310478847816, -15.290035309345816, -36.51562297138414, -28.35308124573924, -2.1592113330702416, -5.874099124004049, -9.448369906330498, -11.376415199184818, -44.136614928222166, -38.02765005266988, -22.209167897869005, -43.42832365505005, -21.63048849121528, -31.694043296337593, -44.2476313834966, -42.227930893768246, -35.12989144814853, -18.534941898899127, -24.709711942739325, -16.030757031822873, -12.986571511655688, -28.04422237129033, -14.655211447261363, -40.97206493222442, -24.10410663974272, -37.549395308621925, -34.37497708006601, -18.73616901833777, -33.755490753777856, -49.617800021240214, -30.466402754874938, -46.97909876777041, -4.968967447355731, -9.357719372019112, -39.317650395331945, -26.745171652017792, -13.04646708555316, -4.004855152571797, -10.139151299722194, -33.43163304545496, -35.46029244929696, -31.790812637844223, -1.219621221621916, -20.479283289249956, -30.156567521993196, -16.69222539524272, -13.335956414120265, -42.602652924830174, -22.54259763792851, -19.120162978193424, -4.3149220114442475, -12.814678220190821, -23.854898330680044, -53.287603162263366, -41.922045297767085, -25.705923137874503, -14.47422066492323, -47.68689096454752, -22.014223377873307, -24.87222925888047, -37.73577951234958, -10.960019746171051, -47.89468155430722, -21.73924500245611, -16.589091346735497, -16.67635244989751, -21.152368306795346, -50.71344804374561, -39.703621850197905, -11.572081826031845, -48.82398308515531, -39.26839262731865, -20.75402994362141, -17.40913306711509, -22.251467121985485, -29.6466171058731, -20.486919379731127, -40.33668773010703, -1.8098538697551945], "policy_predator_policy_reward": [19.576275250863628, 45.21630322533724, 22.9803575275366, 28.183509999424636, 6.590300689560772, 36.87983838886719, 7.834324170437575, 3.203107858098991, 16.338385696065522, 21.183800490554045, 11.195167891433327, 38.3045343379086, 2.735840482563937, 47.320097218925355, 39.20716021841293, 17.702362209465015, 15.736645282255541, 18.265680719504022, 20.32515029837122, 46.91917016569083, 39.34785763692419, 6.469310478847816, 15.290035309345816, 36.51562297138414, 28.35308124573924, 2.1592113330702416, 5.874099124004049, 9.448369906330498, 11.376415199184818, 44.136614928222166, 38.02765005266988, 22.209167897869005, 43.42832365505005, 21.63048849121528, 31.694043296337593, 44.2476313834966, 42.227930893768246, 35.12989144814853, 18.534941898899127, 24.709711942739325, 16.030757031822873, 12.986571511655688, 28.04422237129033, 14.655211447261363, 40.97206493222442, 24.10410663974272, 37.549395308621925, 34.37497708006601, 18.73616901833777, 33.755490753777856, 49.617800021240214, 30.466402754874938, 46.97909876777041, 4.968967447355731, 9.357719372019112, 39.317650395331945, 26.745171652017792, 13.04646708555316, 4.004855152571797, 10.139151299722194, 33.43163304545496, 35.46029244929696, 31.790812637844223, 1.219621221621916, 20.479283289249956, 30.156567521993196, 16.69222539524272, 13.335956414120265, 42.602652924830174, 22.54259763792851, 19.120162978193424, 4.3149220114442475, 12.814678220190821, 23.854898330680044, 53.287603162263366, 41.922045297767085, 25.705923137874503, 14.47422066492323, 47.68689096454752, 22.014223377873307, 24.87222925888047, 37.73577951234958, 10.960019746171051, 47.89468155430722, 21.73924500245611, 16.589091346735497, 16.67635244989751, 21.152368306795346, 50.71344804374561, 39.703621850197905, 11.572081826031845, 48.82398308515531, 39.26839262731865, 20.75402994362141, 17.40913306711509, 22.251467121985485, 29.6466171058731, 20.486919379731127, 40.33668773010703, 1.8098538697551945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29142519236367903, "mean_inference_ms": 0.9391132438703744, "mean_action_processing_ms": 0.12482926461159505, "mean_env_wait_ms": 0.0658083384984156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002736687660217285, "StateBufferConnector_ms": 0.001963496208190918, "ViewRequirementAgentConnector_ms": 0.044928789138793945}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 684.8885973252254, "num_env_steps_trained_throughput_per_sec": 684.8885973252254, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 5960.234, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5960.182, "sample_time_ms": 648.018, "learn_time_ms": 5296.533, "learn_throughput": 755.211, "synch_weights_time_ms": 14.98}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 85, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-14", "timestamp": 1723390754, "time_this_iter_s": 5.845355749130249, "time_total_s": 498.05015301704407, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.05015301704407, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 27.962500000000002, "ram_util_percent": 82.83749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3308012490471204, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3639866802530984, "policy_loss": -0.0052742630078379685, "vf_loss": 1.369260940887034, "vf_explained_var": 0.967302520511051, "kl": 0.007147828015777175, "entropy": 0.4309248429723084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4510954663157465, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3839691350546977, "policy_loss": -0.005751755005136753, "vf_loss": 1.3896151608477036, "vf_explained_var": 0.9663736540824175, "kl": 0.008458419296553244, "entropy": 0.6723726876700918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.08, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6508, "policy_reward_min": {"prey_policy": -53.287603162263366, "predator_policy": 1.8098538697551945}, "policy_reward_max": {"prey_policy": -1.8098538697551945, "predator_policy": 53.287603162263366}, "policy_reward_mean": {"prey_policy": -25.722080032097452, "predator_policy": 25.722080032097452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [79, 45, 47, 105, 61, 68, 52, 53, 48, 97, 90, 96, 89, 65, 54, 94, 85, 35, 117, 62, 59, 65, 80, 91, 90, 64, 80, 91, 64, 63, 81, 64, 52, 79, 1, 88, 88, 87, 83, 78, 49, 68, 67, 76, 46, 59, 59, 77, 51, 61, 42, 71, 71, 68, 53, 46, 59, 17, 56, 56, 83, 78, 80, 62, 52, 20, 90, 71, 55, 52, 61, 103, 79, 48, 50, 60, 80, 77, 92, 67, 95, 69, 39, 49, 38, 64, 46, 25, 49, 74, 61, 57, 74, 85, 53, 35, 20, 32, 51, 90], "policy_prey_policy_reward": [-30.156567521993196, -16.69222539524272, -13.335956414120265, -42.602652924830174, -22.54259763792851, -19.120162978193424, -4.3149220114442475, -12.814678220190821, -23.854898330680044, -53.287603162263366, -41.922045297767085, -25.705923137874503, -14.47422066492323, -47.68689096454752, -22.014223377873307, -24.87222925888047, -37.73577951234958, -10.960019746171051, -47.89468155430722, -21.73924500245611, -16.589091346735497, -16.67635244989751, -21.152368306795346, -50.71344804374561, -39.703621850197905, -11.572081826031845, -48.82398308515531, -39.26839262731865, -20.75402994362141, -17.40913306711509, -22.251467121985485, -29.6466171058731, -20.486919379731127, -40.33668773010703, -1.8098538697551945, -37.99304824632288, -42.99341131634296, -34.203726636531506, -23.85268190881372, -44.49309700791695, -14.186432264678633, -15.645124115476165, -37.4468419712937, -30.951655348475885, -25.584510389325164, -19.130571585365026, -39.796273450779346, -33.968214469819294, -28.57409999697116, -28.08260822404382, -6.842479662980533, -23.22260892433679, -33.642688872976855, -29.707960296509583, -18.697539841986956, -3.6479074891412413, -29.185574511569406, -8.584575892388782, -13.96049353771865, -16.94194219180704, -8.677622004685373, -16.808954314950682, -30.509922200176653, -22.903433544664296, -35.47145723718138, -5.687423112619476, -47.824725553671634, -21.794249175107595, -22.285524120277643, -12.668640011796462, -21.38047747125265, -25.815641169436592, -17.259413382489093, -33.0911625424701, -26.67382622906439, -33.769604035605006, -30.311111165193385, -9.800339101783539, -39.84030055546971, -20.945074529326767, -45.17708061301251, -33.654612852211756, -16.92447166869972, -8.64568845026156, -5.917489477745665, -28.956982346524242, -24.93355816561354, -15.53287996522914, -26.07503747390458, -32.84598673069354, -20.77692354148511, -38.65810412547417, -21.99124305286649, -45.677084560835354, -39.03214277183314, -25.063037478019048, -4.995442702355151, -11.691766185721432, -30.295060575055224, -39.586869993305775], "policy_predator_policy_reward": [30.156567521993196, 16.69222539524272, 13.335956414120265, 42.602652924830174, 22.54259763792851, 19.120162978193424, 4.3149220114442475, 12.814678220190821, 23.854898330680044, 53.287603162263366, 41.922045297767085, 25.705923137874503, 14.47422066492323, 47.68689096454752, 22.014223377873307, 24.87222925888047, 37.73577951234958, 10.960019746171051, 47.89468155430722, 21.73924500245611, 16.589091346735497, 16.67635244989751, 21.152368306795346, 50.71344804374561, 39.703621850197905, 11.572081826031845, 48.82398308515531, 39.26839262731865, 20.75402994362141, 17.40913306711509, 22.251467121985485, 29.6466171058731, 20.486919379731127, 40.33668773010703, 1.8098538697551945, 37.99304824632288, 42.99341131634296, 34.203726636531506, 23.85268190881372, 44.49309700791695, 14.186432264678633, 15.645124115476165, 37.4468419712937, 30.951655348475885, 25.584510389325164, 19.130571585365026, 39.796273450779346, 33.968214469819294, 28.57409999697116, 28.08260822404382, 6.842479662980533, 23.22260892433679, 33.642688872976855, 29.707960296509583, 18.697539841986956, 3.6479074891412413, 29.185574511569406, 8.584575892388782, 13.96049353771865, 16.94194219180704, 8.677622004685373, 16.808954314950682, 30.509922200176653, 22.903433544664296, 35.47145723718138, 5.687423112619476, 47.824725553671634, 21.794249175107595, 22.285524120277643, 12.668640011796462, 21.38047747125265, 25.815641169436592, 17.259413382489093, 33.0911625424701, 26.67382622906439, 33.769604035605006, 30.311111165193385, 9.800339101783539, 39.84030055546971, 20.945074529326767, 45.17708061301251, 33.654612852211756, 16.92447166869972, 8.64568845026156, 5.917489477745665, 28.956982346524242, 24.93355816561354, 15.53287996522914, 26.07503747390458, 32.84598673069354, 20.77692354148511, 38.65810412547417, 21.99124305286649, 45.677084560835354, 39.03214277183314, 25.063037478019048, 4.995442702355151, 11.691766185721432, 30.295060575055224, 39.586869993305775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29151523715410255, "mean_inference_ms": 0.9390869007345757, "mean_action_processing_ms": 0.12460057319875364, "mean_env_wait_ms": 0.06569830400712641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028606653213500977, "StateBufferConnector_ms": 0.002021193504333496, "ViewRequirementAgentConnector_ms": 0.04746699333190918}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 609.7836061150291, "num_env_steps_trained_throughput_per_sec": 609.7836061150291, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 6039.689, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6039.634, "sample_time_ms": 649.388, "learn_time_ms": 5373.845, "learn_throughput": 744.346, "synch_weights_time_ms": 15.736}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 86, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-20", "timestamp": 1723390760, "time_this_iter_s": 6.566419839859009, "time_total_s": 504.6165728569031, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 504.6165728569031, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 34.42, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.103774809402724, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3742503275163471, "policy_loss": -0.0035864541799431513, "vf_loss": 1.377836782236894, "vf_explained_var": 0.9693738363683224, "kl": 0.005638406953468689, "entropy": 0.42920108611385027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3097406322757403, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4078349256888032, "policy_loss": -0.008780012723582331, "vf_loss": 1.41645345253249, "vf_explained_var": 0.9663302224129439, "kl": 0.012918905928088224, "entropy": 0.633282384586831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.23, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 6523, "policy_reward_min": {"prey_policy": -56.89300003486899, "predator_policy": 0.21061044562785947}, "policy_reward_max": {"prey_policy": -0.21061044562785947, "predator_policy": 56.89300003486899}, "policy_reward_mean": {"prey_policy": -24.82312273138937, "predator_policy": 24.82312273138937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [59, 17, 56, 56, 83, 78, 80, 62, 52, 20, 90, 71, 55, 52, 61, 103, 79, 48, 50, 60, 80, 77, 92, 67, 95, 69, 39, 49, 38, 64, 46, 25, 49, 74, 61, 57, 74, 85, 53, 35, 20, 32, 51, 90, 66, 47, 78, 81, 141, 50, 132, 60, 9, 67, 85, 67, 87, 63, 58, 103, 51, 81, 83, 62, 62, 53, 37, 70, 56, 62, 28, 60, 62, 81, 70, 51, 53, 53, 59, 73, 129, 72, 52, 60, 73, 63, 47, 119, 59, 56, 81, 90, 58, 69, 74, 61, 91, 59, 56, 99], "policy_prey_policy_reward": [-29.185574511569406, -8.584575892388782, -13.96049353771865, -16.94194219180704, -8.677622004685373, -16.808954314950682, -30.509922200176653, -22.903433544664296, -35.47145723718138, -5.687423112619476, -47.824725553671634, -21.794249175107595, -22.285524120277643, -12.668640011796462, -21.38047747125265, -25.815641169436592, -17.259413382489093, -33.0911625424701, -26.67382622906439, -33.769604035605006, -30.311111165193385, -9.800339101783539, -39.84030055546971, -20.945074529326767, -45.17708061301251, -33.654612852211756, -16.92447166869972, -8.64568845026156, -5.917489477745665, -28.956982346524242, -24.93355816561354, -15.53287996522914, -26.07503747390458, -32.84598673069354, -20.77692354148511, -38.65810412547417, -21.99124305286649, -45.677084560835354, -39.03214277183314, -25.063037478019048, -4.995442702355151, -11.691766185721432, -30.295060575055224, -39.586869993305775, -19.760877439570553, -0.21061044562785947, -17.23021966958386, -23.221310739313896, -48.345663004471774, -32.1042678286798, -42.9535384912579, -27.750716928681058, -4.613287117917037, -11.629893488894709, -29.358970008372047, -27.604954296973585, -45.98729679900899, -30.81150428858023, -24.611315182386523, -47.98046525940235, -3.771170412846923, -20.841314437852674, -13.87494750395401, -27.684638333968028, -20.399836807663718, -33.40126878467739, -22.60979515637767, -26.176089629135284, -12.540794428503963, -24.202575199821634, -10.430479790653154, -30.147998282660705, -16.6715799900788, -23.865919868560393, -28.270527824835604, -16.050883291990857, -29.7400559537427, -8.555404623801307, -27.170394099404486, -41.45821844602911, -34.357453187184035, -35.8398640021865, -17.19694111310507, -30.46672048377571, -43.362053829944074, -28.696601992175392, -29.10472437331907, -15.645746903198576, -11.005260950222944, -24.040982366920716, -16.600474219724425, -56.89300003486899, -22.262369416803118, -22.97506743775147, -30.67303990996296, -13.191005632418232, -42.82536899805542, -13.868142862520564, -35.541739162237, -17.103982085728255], "policy_predator_policy_reward": [29.185574511569406, 8.584575892388782, 13.96049353771865, 16.94194219180704, 8.677622004685373, 16.808954314950682, 30.509922200176653, 22.903433544664296, 35.47145723718138, 5.687423112619476, 47.824725553671634, 21.794249175107595, 22.285524120277643, 12.668640011796462, 21.38047747125265, 25.815641169436592, 17.259413382489093, 33.0911625424701, 26.67382622906439, 33.769604035605006, 30.311111165193385, 9.800339101783539, 39.84030055546971, 20.945074529326767, 45.17708061301251, 33.654612852211756, 16.92447166869972, 8.64568845026156, 5.917489477745665, 28.956982346524242, 24.93355816561354, 15.53287996522914, 26.07503747390458, 32.84598673069354, 20.77692354148511, 38.65810412547417, 21.99124305286649, 45.677084560835354, 39.03214277183314, 25.063037478019048, 4.995442702355151, 11.691766185721432, 30.295060575055224, 39.586869993305775, 19.760877439570553, 0.21061044562785947, 17.23021966958386, 23.221310739313896, 48.345663004471774, 32.1042678286798, 42.9535384912579, 27.750716928681058, 4.613287117917037, 11.629893488894709, 29.358970008372047, 27.604954296973585, 45.98729679900899, 30.81150428858023, 24.611315182386523, 47.98046525940235, 3.771170412846923, 20.841314437852674, 13.87494750395401, 27.684638333968028, 20.399836807663718, 33.40126878467739, 22.60979515637767, 26.176089629135284, 12.540794428503963, 24.202575199821634, 10.430479790653154, 30.147998282660705, 16.6715799900788, 23.865919868560393, 28.270527824835604, 16.050883291990857, 29.7400559537427, 8.555404623801307, 27.170394099404486, 41.45821844602911, 34.357453187184035, 35.8398640021865, 17.19694111310507, 30.46672048377571, 43.362053829944074, 28.696601992175392, 29.10472437331907, 15.645746903198576, 11.005260950222944, 24.040982366920716, 16.600474219724425, 56.89300003486899, 22.262369416803118, 22.97506743775147, 30.67303990996296, 13.191005632418232, 42.82536899805542, 13.868142862520564, 35.541739162237, 17.103982085728255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29135385186677853, "mean_inference_ms": 0.9389179808207706, "mean_action_processing_ms": 0.12450638699390713, "mean_env_wait_ms": 0.06570986420599009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029077529907226562, "StateBufferConnector_ms": 0.00200045108795166, "ViewRequirementAgentConnector_ms": 0.047450900077819824}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.5015826779883, "num_env_steps_trained_throughput_per_sec": 530.5015826779883, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 6204.192, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6204.134, "sample_time_ms": 658.448, "learn_time_ms": 5529.159, "learn_throughput": 723.437, "synch_weights_time_ms": 15.801}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 87, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-28", "timestamp": 1723390768, "time_this_iter_s": 7.591610908508301, "time_total_s": 512.2081837654114, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 512.2081837654114, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 44.489999999999995, "ram_util_percent": 83.19000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1881391135354837, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2879165821087857, "policy_loss": -0.0018909169477410615, "vf_loss": 1.2898074988275767, "vf_explained_var": 0.9786576624959707, "kl": 0.00744910486199295, "entropy": 0.4452069872369369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2604887347047526, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.354059552339216, "policy_loss": -0.011871422811721762, "vf_loss": 1.3657613289852937, "vf_explained_var": 0.9737502902125319, "kl": 0.01357182890533585, "entropy": 0.6472220335155725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.9, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6690, "policy_reward_min": {"prey_policy": -56.89300003486899, "predator_policy": 0.3654313458545039}, "policy_reward_max": {"prey_policy": -0.3654313458545039, "predator_policy": 56.89300003486899}, "policy_reward_mean": {"prey_policy": -26.233859539708888, "predator_policy": 26.233859539708888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [51, 81, 83, 62, 62, 53, 37, 70, 56, 62, 28, 60, 62, 81, 70, 51, 53, 53, 59, 73, 129, 72, 52, 60, 73, 63, 47, 119, 59, 56, 81, 90, 58, 69, 74, 61, 91, 59, 56, 99, 48, 68, 94, 84, 71, 77, 81, 45, 79, 87, 77, 61, 1, 86, 59, 49, 44, 93, 61, 50, 48, 52, 87, 78, 67, 75, 34, 50, 90, 78, 68, 74, 96, 64, 16, 102, 74, 4, 59, 68, 70, 83, 101, 47, 69, 93, 46, 110, 75, 73, 86, 90, 68, 45, 55, 48, 79, 46, 88, 44], "policy_prey_policy_reward": [-3.771170412846923, -20.841314437852674, -13.87494750395401, -27.684638333968028, -20.399836807663718, -33.40126878467739, -22.60979515637767, -26.176089629135284, -12.540794428503963, -24.202575199821634, -10.430479790653154, -30.147998282660705, -16.6715799900788, -23.865919868560393, -28.270527824835604, -16.050883291990857, -29.7400559537427, -8.555404623801307, -27.170394099404486, -41.45821844602911, -34.357453187184035, -35.8398640021865, -17.19694111310507, -30.46672048377571, -43.362053829944074, -28.696601992175392, -29.10472437331907, -15.645746903198576, -11.005260950222944, -24.040982366920716, -16.600474219724425, -56.89300003486899, -22.262369416803118, -22.97506743775147, -30.67303990996296, -13.191005632418232, -42.82536899805542, -13.868142862520564, -35.541739162237, -17.103982085728255, -10.990392386235074, -34.70881313935692, -44.71565625364167, -33.40494393388114, -46.96109624352158, -14.83998101601139, -21.60943495668085, -38.13746068606239, -24.08779701593144, -51.181923153350056, -41.080455185548324, -31.514062345766387, -1.4537365356026966, -46.89415063562629, -26.268110197481864, -27.544992215835155, -20.60890313087783, -39.26332564163747, -12.880087523394796, -4.772871751889923, -11.967515619730335, -7.740891780202391, -48.59038494439129, -29.05391270284128, -37.348111353010275, -39.596788104254664, -17.96927726023937, -15.698896656811103, -36.45823601640673, -15.366549466398336, -28.28033410749214, -19.68145068480928, -29.32990715637756, -15.171112070291027, -3.1056986311065264, -39.07569497474317, -17.77858950221841, -0.3654313458545039, -12.902011864940665, -18.99403712503764, -14.232460076887246, -43.959709505317164, -28.54230236405594, -25.228366074130005, -23.712486376952704, -54.08420948488545, -37.24028589912839, -21.231102856546094, -40.471051001802714, -36.807520039412985, -23.475974940794856, -55.297153810437685, -39.29980592479771, -5.422479669392607, -35.82968295399834, -27.860125222665637, -47.61164436904795, -16.960942590939958, -34.79475072033386, -14.416442945210687], "policy_predator_policy_reward": [3.771170412846923, 20.841314437852674, 13.87494750395401, 27.684638333968028, 20.399836807663718, 33.40126878467739, 22.60979515637767, 26.176089629135284, 12.540794428503963, 24.202575199821634, 10.430479790653154, 30.147998282660705, 16.6715799900788, 23.865919868560393, 28.270527824835604, 16.050883291990857, 29.7400559537427, 8.555404623801307, 27.170394099404486, 41.45821844602911, 34.357453187184035, 35.8398640021865, 17.19694111310507, 30.46672048377571, 43.362053829944074, 28.696601992175392, 29.10472437331907, 15.645746903198576, 11.005260950222944, 24.040982366920716, 16.600474219724425, 56.89300003486899, 22.262369416803118, 22.97506743775147, 30.67303990996296, 13.191005632418232, 42.82536899805542, 13.868142862520564, 35.541739162237, 17.103982085728255, 10.990392386235074, 34.70881313935692, 44.71565625364167, 33.40494393388114, 46.96109624352158, 14.83998101601139, 21.60943495668085, 38.13746068606239, 24.08779701593144, 51.181923153350056, 41.080455185548324, 31.514062345766387, 1.4537365356026966, 46.89415063562629, 26.268110197481864, 27.544992215835155, 20.60890313087783, 39.26332564163747, 12.880087523394796, 4.772871751889923, 11.967515619730335, 7.740891780202391, 48.59038494439129, 29.05391270284128, 37.348111353010275, 39.596788104254664, 17.96927726023937, 15.698896656811103, 36.45823601640673, 15.366549466398336, 28.28033410749214, 19.68145068480928, 29.32990715637756, 15.171112070291027, 3.1056986311065264, 39.07569497474317, 17.77858950221841, 0.3654313458545039, 12.902011864940665, 18.99403712503764, 14.232460076887246, 43.959709505317164, 28.54230236405594, 25.228366074130005, 23.712486376952704, 54.08420948488545, 37.24028589912839, 21.231102856546094, 40.471051001802714, 36.807520039412985, 23.475974940794856, 55.297153810437685, 39.29980592479771, 5.422479669392607, 35.82968295399834, 27.860125222665637, 47.61164436904795, 16.960942590939958, 34.79475072033386, 14.416442945210687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2914893939092396, "mean_inference_ms": 0.9385195269072015, "mean_action_processing_ms": 0.1246394174882386, "mean_env_wait_ms": 0.06580001540965248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029172897338867188, "StateBufferConnector_ms": 0.0020668506622314453, "ViewRequirementAgentConnector_ms": 0.04755449295043945}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 646.7830753269948, "num_env_steps_trained_throughput_per_sec": 646.7830753269948, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 6187.791, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6187.747, "sample_time_ms": 668.518, "learn_time_ms": 5503.911, "learn_throughput": 726.756, "synch_weights_time_ms": 14.79}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 88, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-34", "timestamp": 1723390774, "time_this_iter_s": 6.191187143325806, "time_total_s": 518.3993709087372, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1328d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 518.3993709087372, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.15555555555555, "ram_util_percent": 82.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.169561732063691, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2691530444659294, "policy_loss": -0.002362433423210556, "vf_loss": 1.2715154799322288, "vf_explained_var": 0.9778901361549894, "kl": 0.0062827022004596595, "entropy": 0.3867614591494203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2288132213056087, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2319088322110474, "policy_loss": -0.00863638611966356, "vf_loss": 1.240387601715823, "vf_explained_var": 0.9788392011076212, "kl": 0.01260917954690221, "entropy": 0.6298957052951057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.97, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6697, "policy_reward_min": {"prey_policy": -57.0969580356145, "predator_policy": 0.3654313458545039}, "policy_reward_max": {"prey_policy": -0.3654313458545039, "predator_policy": 57.0969580356145}, "policy_reward_mean": {"prey_policy": -25.56692776105353, "predator_policy": 25.56692776105353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [87, 78, 67, 75, 34, 50, 90, 78, 68, 74, 96, 64, 16, 102, 74, 4, 59, 68, 70, 83, 101, 47, 69, 93, 46, 110, 75, 73, 86, 90, 68, 45, 55, 48, 79, 46, 88, 44, 78, 68, 45, 63, 53, 115, 69, 80, 62, 80, 88, 47, 56, 43, 17, 56, 62, 89, 79, 48, 67, 111, 59, 36, 56, 61, 40, 47, 77, 67, 83, 70, 72, 39, 71, 57, 95, 76, 15, 77, 66, 89, 74, 32, 82, 43, 57, 62, 70, 73, 46, 75, 59, 68, 70, 148, 82, 95, 69, 76, 46, 41], "policy_prey_policy_reward": [-48.59038494439129, -29.05391270284128, -37.348111353010275, -39.596788104254664, -17.96927726023937, -15.698896656811103, -36.45823601640673, -15.366549466398336, -28.28033410749214, -19.68145068480928, -29.32990715637756, -15.171112070291027, -3.1056986311065264, -39.07569497474317, -17.77858950221841, -0.3654313458545039, -12.902011864940665, -18.99403712503764, -14.232460076887246, -43.959709505317164, -28.54230236405594, -25.228366074130005, -23.712486376952704, -54.08420948488545, -37.24028589912839, -21.231102856546094, -40.471051001802714, -36.807520039412985, -23.475974940794856, -55.297153810437685, -39.29980592479771, -5.422479669392607, -35.82968295399834, -27.860125222665637, -47.61164436904795, -16.960942590939958, -34.79475072033386, -14.416442945210687, -23.93641464681224, -6.789972893958796, -9.564793578862549, -30.598267628920514, -26.23502253791758, -17.96759164788353, -36.26893580287638, -38.83341865399494, -10.628041051533483, -15.8075964130986, -57.0969580356145, -19.81245381846599, -4.773669100946805, -3.7630372380078443, -8.651469921731517, -21.753440997986722, -22.368510000390728, -25.44561619357432, -48.45011576732216, -19.286187964850164, -15.152237409148952, -9.31096801507037, -28.339361608074633, -6.638945013224143, -28.96150913541785, -3.9356873808386377, -14.02345774081819, -26.57333535827639, -50.9964802066372, -43.128795206296935, -16.818169601947915, -34.31899172747415, -14.00421304266553, -13.32761430515521, -13.671469904385663, -32.33186249270964, -40.108173746509706, -30.446961448622382, -3.5106089284510134, -39.74081566394547, -19.50165381177714, -13.924708292434701, -29.78959460423885, -7.828099132116124, -27.99881832396385, -19.185552551958153, -43.033645379372224, -35.81774279804982, -29.052475286693685, -18.961493102885754, -5.9305998294150415, -17.059431472614595, -14.994272529963387, -27.864244812390897, -33.2570458126985, -50.032719983474074, -27.026670615247557, -43.82009660877513, -25.2527977241753, -49.28515096323065, -41.06029365869266, -11.399576186803985], "policy_predator_policy_reward": [48.59038494439129, 29.05391270284128, 37.348111353010275, 39.596788104254664, 17.96927726023937, 15.698896656811103, 36.45823601640673, 15.366549466398336, 28.28033410749214, 19.68145068480928, 29.32990715637756, 15.171112070291027, 3.1056986311065264, 39.07569497474317, 17.77858950221841, 0.3654313458545039, 12.902011864940665, 18.99403712503764, 14.232460076887246, 43.959709505317164, 28.54230236405594, 25.228366074130005, 23.712486376952704, 54.08420948488545, 37.24028589912839, 21.231102856546094, 40.471051001802714, 36.807520039412985, 23.475974940794856, 55.297153810437685, 39.29980592479771, 5.422479669392607, 35.82968295399834, 27.860125222665637, 47.61164436904795, 16.960942590939958, 34.79475072033386, 14.416442945210687, 23.93641464681224, 6.789972893958796, 9.564793578862549, 30.598267628920514, 26.23502253791758, 17.96759164788353, 36.26893580287638, 38.83341865399494, 10.628041051533483, 15.8075964130986, 57.0969580356145, 19.81245381846599, 4.773669100946805, 3.7630372380078443, 8.651469921731517, 21.753440997986722, 22.368510000390728, 25.44561619357432, 48.45011576732216, 19.286187964850164, 15.152237409148952, 9.31096801507037, 28.339361608074633, 6.638945013224143, 28.96150913541785, 3.9356873808386377, 14.02345774081819, 26.57333535827639, 50.9964802066372, 43.128795206296935, 16.818169601947915, 34.31899172747415, 14.00421304266553, 13.32761430515521, 13.671469904385663, 32.33186249270964, 40.108173746509706, 30.446961448622382, 3.5106089284510134, 39.74081566394547, 19.50165381177714, 13.924708292434701, 29.78959460423885, 7.828099132116124, 27.99881832396385, 19.185552551958153, 43.033645379372224, 35.81774279804982, 29.052475286693685, 18.961493102885754, 5.9305998294150415, 17.059431472614595, 14.994272529963387, 27.864244812390897, 33.2570458126985, 50.032719983474074, 27.026670615247557, 43.82009660877513, 25.2527977241753, 49.28515096323065, 41.06029365869266, 11.399576186803985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29187845856243405, "mean_inference_ms": 0.9398274111661732, "mean_action_processing_ms": 0.12476149668751244, "mean_env_wait_ms": 0.06589668393886101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029561519622802734, "StateBufferConnector_ms": 0.00277554988861084, "ViewRequirementAgentConnector_ms": 0.0536578893661499}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 610.3429627092781, "num_env_steps_trained_throughput_per_sec": 610.3429627092781, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 6218.537, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6218.496, "sample_time_ms": 677.226, "learn_time_ms": 5525.736, "learn_throughput": 723.886, "synch_weights_time_ms": 15.01}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "training_iteration": 89, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-41", "timestamp": 1723390781, "time_this_iter_s": 6.561028957366943, "time_total_s": 524.9603998661041, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 524.9603998661041, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.86666666666667, "ram_util_percent": 83.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8328597597777843, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0480749307510753, "policy_loss": -0.0017618681051923583, "vf_loss": 1.0498367990677555, "vf_explained_var": 0.9822187650948763, "kl": 0.006590311968611455, "entropy": 0.4285682150162756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9671089087923366, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0548744341358542, "policy_loss": -0.003867585295787042, "vf_loss": 1.0586250130397579, "vf_explained_var": 0.9809891902531187, "kl": 0.00936070183214189, "entropy": 0.7000969386349122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.51, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6651, "policy_reward_min": {"prey_policy": -50.9964802066372, "predator_policy": 3.5106089284510134}, "policy_reward_max": {"prey_policy": -3.5106089284510134, "predator_policy": 50.9964802066372}, "policy_reward_mean": {"prey_policy": -25.583434498716674, "predator_policy": 25.583434498716674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [36, 56, 61, 40, 47, 77, 67, 83, 70, 72, 39, 71, 57, 95, 76, 15, 77, 66, 89, 74, 32, 82, 43, 57, 62, 70, 73, 46, 75, 59, 68, 70, 148, 82, 95, 69, 76, 46, 41, 57, 34, 129, 65, 67, 80, 55, 66, 41, 73, 61, 55, 118, 94, 49, 76, 79, 55, 66, 74, 58, 93, 67, 36, 73, 147, 67, 62, 59, 67, 59, 51, 42, 39, 55, 86, 75, 88, 87, 91, 59, 44, 70, 31, 104, 27, 67, 65, 140, 39, 31, 57, 80, 57, 83, 80, 88, 29, 62, 64, 16], "policy_prey_policy_reward": [-6.638945013224143, -28.96150913541785, -3.9356873808386377, -14.02345774081819, -26.57333535827639, -50.9964802066372, -43.128795206296935, -16.818169601947915, -34.31899172747415, -14.00421304266553, -13.32761430515521, -13.671469904385663, -32.33186249270964, -40.108173746509706, -30.446961448622382, -3.5106089284510134, -39.74081566394547, -19.50165381177714, -13.924708292434701, -29.78959460423885, -7.828099132116124, -27.99881832396385, -19.185552551958153, -43.033645379372224, -35.81774279804982, -29.052475286693685, -18.961493102885754, -5.9305998294150415, -17.059431472614595, -14.994272529963387, -27.864244812390897, -33.2570458126985, -50.032719983474074, -27.026670615247557, -43.82009660877513, -25.2527977241753, -49.28515096323065, -41.06029365869266, -11.399576186803985, -5.931564571127843, -5.705303538800781, -25.588641891926912, -48.03865139176275, -19.909474582270686, -32.29502375535664, -11.226136334856463, -7.964650213865589, -13.013701697055634, -30.178798656103186, -35.46147378246046, -19.515746295073345, -48.351844107759995, -41.96222866071426, -32.660756311804704, -16.892477656748405, -17.6810229305553, -10.580912376982356, -29.238465094802955, -49.892557991594735, -42.05277759798904, -14.094246055821063, -30.93073918266124, -11.474348065735665, -50.19512106844954, -21.55170598473881, -15.90088123870679, -44.81362569752374, -33.319736855169246, -24.29960230172428, -22.2393378984766, -20.49691401570827, -10.493589293082914, -6.573356194863609, -30.708889879519774, -48.95247983180455, -29.494248823210906, -32.52807343265645, -12.30289786855843, -33.56469512301371, -20.901874022621065, -14.764353637540765, -42.20256013168963, -18.444260254851656, -38.891638847573056, -9.249852232093799, -16.39620322728399, -24.802885865755872, -38.89204686797058, -13.7340679016586, -4.114255095683659, -34.058518834588476, -43.965551074665605, -31.70413294408671, -46.35220343891333, -10.78599060265854, -35.39400180563664, -5.528891388310993, -32.52680440497911, -27.918213953834375, -5.0246707038856195], "policy_predator_policy_reward": [6.638945013224143, 28.96150913541785, 3.9356873808386377, 14.02345774081819, 26.57333535827639, 50.9964802066372, 43.128795206296935, 16.818169601947915, 34.31899172747415, 14.00421304266553, 13.32761430515521, 13.671469904385663, 32.33186249270964, 40.108173746509706, 30.446961448622382, 3.5106089284510134, 39.74081566394547, 19.50165381177714, 13.924708292434701, 29.78959460423885, 7.828099132116124, 27.99881832396385, 19.185552551958153, 43.033645379372224, 35.81774279804982, 29.052475286693685, 18.961493102885754, 5.9305998294150415, 17.059431472614595, 14.994272529963387, 27.864244812390897, 33.2570458126985, 50.032719983474074, 27.026670615247557, 43.82009660877513, 25.2527977241753, 49.28515096323065, 41.06029365869266, 11.399576186803985, 5.931564571127843, 5.705303538800781, 25.588641891926912, 48.03865139176275, 19.909474582270686, 32.29502375535664, 11.226136334856463, 7.964650213865589, 13.013701697055634, 30.178798656103186, 35.46147378246046, 19.515746295073345, 48.351844107759995, 41.96222866071426, 32.660756311804704, 16.892477656748405, 17.6810229305553, 10.580912376982356, 29.238465094802955, 49.892557991594735, 42.05277759798904, 14.094246055821063, 30.93073918266124, 11.474348065735665, 50.19512106844954, 21.55170598473881, 15.90088123870679, 44.81362569752374, 33.319736855169246, 24.29960230172428, 22.2393378984766, 20.49691401570827, 10.493589293082914, 6.573356194863609, 30.708889879519774, 48.95247983180455, 29.494248823210906, 32.52807343265645, 12.30289786855843, 33.56469512301371, 20.901874022621065, 14.764353637540765, 42.20256013168963, 18.444260254851656, 38.891638847573056, 9.249852232093799, 16.39620322728399, 24.802885865755872, 38.89204686797058, 13.7340679016586, 4.114255095683659, 34.058518834588476, 43.965551074665605, 31.70413294408671, 46.35220343891333, 10.78599060265854, 35.39400180563664, 5.528891388310993, 32.52680440497911, 27.918213953834375, 5.0246707038856195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2935309435232734, "mean_inference_ms": 0.944810557519238, "mean_action_processing_ms": 0.12544214436415219, "mean_env_wait_ms": 0.06622070069263025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004423856735229492, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.07440471649169922}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 569.850407108158, "num_env_steps_trained_throughput_per_sec": 569.850407108158, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 6323.932, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6323.865, "sample_time_ms": 720.017, "learn_time_ms": 5585.218, "learn_throughput": 716.176, "synch_weights_time_ms": 18.064}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 90, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-48", "timestamp": 1723390788, "time_this_iter_s": 7.046683073043823, "time_total_s": 532.007082939148, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d2790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 532.007082939148, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 36.30909090909091, "ram_util_percent": 83.29090909090911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1577928248792886, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2112467451641957, "policy_loss": -0.001881809036907119, "vf_loss": 1.2131285538276038, "vf_explained_var": 0.9783788740014037, "kl": 0.0045628278228117365, "entropy": 0.38522409480065106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5012411755820114, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2478647098566096, "policy_loss": -0.0060326397125512205, "vf_loss": 1.2537690730765463, "vf_explained_var": 0.9775873566667239, "kl": 0.010262123293678895, "entropy": 0.6628818174824118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.6, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6460, "policy_reward_min": {"prey_policy": -56.36130945483994, "predator_policy": 1.6036517414254623}, "policy_reward_max": {"prey_policy": -1.6036517414254623, "predator_policy": 56.36130945483994}, "policy_reward_mean": {"prey_policy": -25.025748478347147, "predator_policy": 25.025748478347147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [36, 73, 147, 67, 62, 59, 67, 59, 51, 42, 39, 55, 86, 75, 88, 87, 91, 59, 44, 70, 31, 104, 27, 67, 65, 140, 39, 31, 57, 80, 57, 83, 80, 88, 29, 62, 64, 16, 47, 75, 82, 62, 25, 49, 74, 39, 128, 45, 50, 50, 84, 67, 46, 21, 78, 91, 79, 74, 56, 28, 27, 82, 44, 60, 74, 19, 45, 71, 70, 72, 66, 71, 52, 15, 62, 64, 93, 80, 60, 92, 29, 73, 91, 85, 67, 78, 57, 42, 85, 74, 45, 98, 87, 65, 134, 73, 108, 45, 66, 12], "policy_prey_policy_reward": [-11.474348065735665, -50.19512106844954, -21.55170598473881, -15.90088123870679, -44.81362569752374, -33.319736855169246, -24.29960230172428, -22.2393378984766, -20.49691401570827, -10.493589293082914, -6.573356194863609, -30.708889879519774, -48.95247983180455, -29.494248823210906, -32.52807343265645, -12.30289786855843, -33.56469512301371, -20.901874022621065, -14.764353637540765, -42.20256013168963, -18.444260254851656, -38.891638847573056, -9.249852232093799, -16.39620322728399, -24.802885865755872, -38.89204686797058, -13.7340679016586, -4.114255095683659, -34.058518834588476, -43.965551074665605, -31.70413294408671, -46.35220343891333, -10.78599060265854, -35.39400180563664, -5.528891388310993, -32.52680440497911, -27.918213953834375, -5.0246707038856195, -23.34309188709894, -7.100272880332571, -22.776176936762806, -24.989427513826175, -3.50620166973399, -22.92270664695411, -42.50060752770252, -14.126886475271748, -31.571397212573977, -17.75533446924075, -19.460825503981074, -11.255822550550176, -18.33229395397949, -31.20694410927332, -8.1514265335897, -11.64937338183554, -16.77512641584463, -49.809234539673966, -43.453187414199895, -28.608940588784893, -10.604186271213385, -12.45876691286656, -13.736111379179002, -36.855856398025374, -22.04823026461874, -21.744338508310378, -28.961416234908626, -4.868256460298052, -27.514373443914078, -26.21766256251253, -33.80659523542893, -43.124477619643855, -38.46857279830141, -23.463685951807754, -30.276166151785134, -2.6652055014950533, -15.688912154265417, -30.6114388440222, -56.36130945483994, -36.92858984841003, -8.025781762047783, -41.301743411681265, -12.491227726828619, -31.362682449418877, -26.760371151771178, -18.298573826123032, -48.1835172444213, -32.185080249740814, -14.139681950673893, -1.6036517414254623, -43.76334110217055, -34.959125112763786, -9.334776287427124, -55.671872075017276, -25.06125136348492, -24.52021968205537, -44.96209737584197, -30.278717230800172, -28.916812186576404, -20.623390570376806, -16.99058390872398, -2.8784384090615998], "policy_predator_policy_reward": [11.474348065735665, 50.19512106844954, 21.55170598473881, 15.90088123870679, 44.81362569752374, 33.319736855169246, 24.29960230172428, 22.2393378984766, 20.49691401570827, 10.493589293082914, 6.573356194863609, 30.708889879519774, 48.95247983180455, 29.494248823210906, 32.52807343265645, 12.30289786855843, 33.56469512301371, 20.901874022621065, 14.764353637540765, 42.20256013168963, 18.444260254851656, 38.891638847573056, 9.249852232093799, 16.39620322728399, 24.802885865755872, 38.89204686797058, 13.7340679016586, 4.114255095683659, 34.058518834588476, 43.965551074665605, 31.70413294408671, 46.35220343891333, 10.78599060265854, 35.39400180563664, 5.528891388310993, 32.52680440497911, 27.918213953834375, 5.0246707038856195, 23.34309188709894, 7.100272880332571, 22.776176936762806, 24.989427513826175, 3.50620166973399, 22.92270664695411, 42.50060752770252, 14.126886475271748, 31.571397212573977, 17.75533446924075, 19.460825503981074, 11.255822550550176, 18.33229395397949, 31.20694410927332, 8.1514265335897, 11.64937338183554, 16.77512641584463, 49.809234539673966, 43.453187414199895, 28.608940588784893, 10.604186271213385, 12.45876691286656, 13.736111379179002, 36.855856398025374, 22.04823026461874, 21.744338508310378, 28.961416234908626, 4.868256460298052, 27.514373443914078, 26.21766256251253, 33.80659523542893, 43.124477619643855, 38.46857279830141, 23.463685951807754, 30.276166151785134, 2.6652055014950533, 15.688912154265417, 30.6114388440222, 56.36130945483994, 36.92858984841003, 8.025781762047783, 41.301743411681265, 12.491227726828619, 31.362682449418877, 26.760371151771178, 18.298573826123032, 48.1835172444213, 32.185080249740814, 14.139681950673893, 1.6036517414254623, 43.76334110217055, 34.959125112763786, 9.334776287427124, 55.671872075017276, 25.06125136348492, 24.52021968205537, 44.96209737584197, 30.278717230800172, 28.916812186576404, 20.623390570376806, 16.99058390872398, 2.8784384090615998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2950163202936548, "mean_inference_ms": 0.9490630602835455, "mean_action_processing_ms": 0.1262187826173581, "mean_env_wait_ms": 0.06658671905104162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045577287673950195, "StateBufferConnector_ms": 0.0025742053985595703, "ViewRequirementAgentConnector_ms": 0.07147276401519775}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 635.2818429078078, "num_env_steps_trained_throughput_per_sec": 635.2818429078078, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 6378.782, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6378.714, "sample_time_ms": 754.987, "learn_time_ms": 5605.355, "learn_throughput": 713.603, "synch_weights_time_ms": 17.804}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "training_iteration": 91, "trial_id": "abfb9_00000", "date": "2024-08-11_11-39-54", "timestamp": 1723390794, "time_this_iter_s": 6.301524877548218, "time_total_s": 538.3086078166962, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 538.3086078166962, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 31.76666666666667, "ram_util_percent": 82.76666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.26101552999268, "cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3324539084608356, "policy_loss": -0.005296622867657182, "vf_loss": 1.3377505293736855, "vf_explained_var": 0.9769673857837915, "kl": 0.006615976667303869, "entropy": 0.4225799125308792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4097417729596295, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3139094445854425, "policy_loss": -0.0038701740762917326, "vf_loss": 1.3176776244305075, "vf_explained_var": 0.9776819384346406, "kl": 0.008159228446515947, "entropy": 0.6976420693720381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.12, "episode_media": {}, "episodes_this_iter": 57, "episodes_timesteps_total": 6612, "policy_reward_min": {"prey_policy": -56.36130945483994, "predator_policy": 0.1508100599713902}, "policy_reward_max": {"prey_policy": -0.1508100599713902, "predator_policy": 56.36130945483994}, "policy_reward_mean": {"prey_policy": -24.688135606758934, "predator_policy": 24.688135606758934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [74, 56, 28, 27, 82, 44, 60, 74, 19, 45, 71, 70, 72, 66, 71, 52, 15, 62, 64, 93, 80, 60, 92, 29, 73, 91, 85, 67, 78, 57, 42, 85, 74, 45, 98, 87, 65, 134, 73, 108, 45, 66, 12, 72, 53, 80, 76, 60, 86, 55, 91, 83, 74, 76, 34, 81, 60, 74, 89, 79, 89, 66, 68, 54, 18, 63, 27, 92, 84, 97, 45, 61, 38, 56, 62, 66, 93, 31, 79, 75, 13, 123, 78, 52, 65, 131, 87, 83, 54, 43, 67, 46, 35, 72, 16, 75, 90, 113, 14, 77], "policy_prey_policy_reward": [-28.608940588784893, -10.604186271213385, -12.45876691286656, -13.736111379179002, -36.855856398025374, -22.04823026461874, -21.744338508310378, -28.961416234908626, -4.868256460298052, -27.514373443914078, -26.21766256251253, -33.80659523542893, -43.124477619643855, -38.46857279830141, -23.463685951807754, -30.276166151785134, -2.6652055014950533, -15.688912154265417, -30.6114388440222, -56.36130945483994, -36.92858984841003, -8.025781762047783, -41.301743411681265, -12.491227726828619, -31.362682449418877, -26.760371151771178, -18.298573826123032, -48.1835172444213, -32.185080249740814, -14.139681950673893, -1.6036517414254623, -43.76334110217055, -34.959125112763786, -9.334776287427124, -55.671872075017276, -25.06125136348492, -24.52021968205537, -44.96209737584197, -30.278717230800172, -28.916812186576404, -20.623390570376806, -16.99058390872398, -2.8784384090615998, -33.36521499501493, -14.351263531024916, -19.655726221788374, -37.39592795187061, -29.032916884450714, -22.35572087714004, -15.069866029421762, -13.935737630739101, -21.564780190063843, -8.65333849911945, -16.213973943287247, -0.1508100599713902, -32.30017205261853, -14.043143918764613, -39.38061835702719, -43.29763573654968, -33.15560454400745, -38.325495076153764, -42.18801586955522, -25.622750677942236, -21.61101681265817, -5.6120436395148054, -16.416570029630684, -10.017805122832163, -26.399534439997343, -20.960972528271768, -37.86529668582859, -19.138623644696256, -22.621506742477145, -19.114303801690816, -24.6823535745159, -39.80479844564652, -12.997066398979984, -50.030980909898695, -21.126291070442832, -28.1533266255213, -30.473798496925678, -3.347799886685782, -43.282910637976094, -41.198413604807115, -19.372463255004618, -25.70918802298115, -10.044758882392337, -29.703889453719043, -31.51440936328974, -5.422589304572818, -24.052704990744896, -26.336058468035315, -14.898786585500735, -12.44776075082871, -33.45428079280121, -9.34386486865871, -7.092339806687478, -35.114914190989964, -47.282830557531476, -5.280331949906396, -19.502233883676546], "policy_predator_policy_reward": [28.608940588784893, 10.604186271213385, 12.45876691286656, 13.736111379179002, 36.855856398025374, 22.04823026461874, 21.744338508310378, 28.961416234908626, 4.868256460298052, 27.514373443914078, 26.21766256251253, 33.80659523542893, 43.124477619643855, 38.46857279830141, 23.463685951807754, 30.276166151785134, 2.6652055014950533, 15.688912154265417, 30.6114388440222, 56.36130945483994, 36.92858984841003, 8.025781762047783, 41.301743411681265, 12.491227726828619, 31.362682449418877, 26.760371151771178, 18.298573826123032, 48.1835172444213, 32.185080249740814, 14.139681950673893, 1.6036517414254623, 43.76334110217055, 34.959125112763786, 9.334776287427124, 55.671872075017276, 25.06125136348492, 24.52021968205537, 44.96209737584197, 30.278717230800172, 28.916812186576404, 20.623390570376806, 16.99058390872398, 2.8784384090615998, 33.36521499501493, 14.351263531024916, 19.655726221788374, 37.39592795187061, 29.032916884450714, 22.35572087714004, 15.069866029421762, 13.935737630739101, 21.564780190063843, 8.65333849911945, 16.213973943287247, 0.1508100599713902, 32.30017205261853, 14.043143918764613, 39.38061835702719, 43.29763573654968, 33.15560454400745, 38.325495076153764, 42.18801586955522, 25.622750677942236, 21.61101681265817, 5.6120436395148054, 16.416570029630684, 10.017805122832163, 26.399534439997343, 20.960972528271768, 37.86529668582859, 19.138623644696256, 22.621506742477145, 19.114303801690816, 24.6823535745159, 39.80479844564652, 12.997066398979984, 50.030980909898695, 21.126291070442832, 28.1533266255213, 30.473798496925678, 3.347799886685782, 43.282910637976094, 41.198413604807115, 19.372463255004618, 25.70918802298115, 10.044758882392337, 29.703889453719043, 31.51440936328974, 5.422589304572818, 24.052704990744896, 26.336058468035315, 14.898786585500735, 12.44776075082871, 33.45428079280121, 9.34386486865871, 7.092339806687478, 35.114914190989964, 47.282830557531476, 5.280331949906396, 19.502233883676546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2954092421736159, "mean_inference_ms": 0.9501735333162867, "mean_action_processing_ms": 0.1263589288932922, "mean_env_wait_ms": 0.06682067957703178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525376319885254, "StateBufferConnector_ms": 0.0021805763244628906, "ViewRequirementAgentConnector_ms": 0.05338311195373535}, "num_episodes": 57, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.5476908797915, "num_env_steps_trained_throughput_per_sec": 685.5476908797915, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 6373.087, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6373.018, "sample_time_ms": 756.875, "learn_time_ms": 5597.835, "learn_throughput": 714.562, "synch_weights_time_ms": 17.741}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 92, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-00", "timestamp": 1723390800, "time_this_iter_s": 5.839618682861328, "time_total_s": 544.1482264995575, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16001d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.1482264995575, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 27.6125, "ram_util_percent": 81.97500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0171620256577927, "cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4262586106856665, "policy_loss": -0.0011488422154798173, "vf_loss": 1.4274074553822478, "vf_explained_var": 0.9649582379808028, "kl": 0.005440839888917423, "entropy": 0.4318473252778252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.227944927290082, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4222931616629164, "policy_loss": -0.004331628674117382, "vf_loss": 1.426532501106461, "vf_explained_var": 0.9648162234574557, "kl": 0.007383041192987453, "entropy": 0.7029106520116329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.32, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6832, "policy_reward_min": {"prey_policy": -57.38742492127777, "predator_policy": 3.347799886685782}, "policy_reward_max": {"prey_policy": -3.347799886685782, "predator_policy": 57.38742492127777}, "policy_reward_mean": {"prey_policy": -26.15039476237322, "predator_policy": 26.15039476237322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [79, 89, 66, 68, 54, 18, 63, 27, 92, 84, 97, 45, 61, 38, 56, 62, 66, 93, 31, 79, 75, 13, 123, 78, 52, 65, 131, 87, 83, 54, 43, 67, 46, 35, 72, 16, 75, 90, 113, 14, 77, 81, 56, 82, 48, 63, 73, 84, 92, 68, 76, 37, 11, 72, 117, 62, 54, 73, 25, 70, 79, 45, 65, 91, 63, 82, 55, 93, 85, 71, 88, 59, 33, 93, 70, 81, 71, 32, 33, 95, 54, 93, 93, 53, 74, 56, 67, 173, 81, 52, 22, 99, 49, 85, 77, 56, 86, 82, 85, 90], "policy_prey_policy_reward": [-33.15560454400745, -38.325495076153764, -42.18801586955522, -25.622750677942236, -21.61101681265817, -5.6120436395148054, -16.416570029630684, -10.017805122832163, -26.399534439997343, -20.960972528271768, -37.86529668582859, -19.138623644696256, -22.621506742477145, -19.114303801690816, -24.6823535745159, -39.80479844564652, -12.997066398979984, -50.030980909898695, -21.126291070442832, -28.1533266255213, -30.473798496925678, -3.347799886685782, -43.282910637976094, -41.198413604807115, -19.372463255004618, -25.70918802298115, -10.044758882392337, -29.703889453719043, -31.51440936328974, -5.422589304572818, -24.052704990744896, -26.336058468035315, -14.898786585500735, -12.44776075082871, -33.45428079280121, -9.34386486865871, -7.092339806687478, -35.114914190989964, -47.282830557531476, -5.280331949906396, -19.502233883676546, -22.676286689523238, -24.147490295631147, -39.204004115271225, -10.954731146039986, -19.35898273534533, -33.83635948648128, -49.390754560519824, -29.21905661876517, -18.887922303526366, -24.927682040076334, -13.502423791042233, -3.9125782813698624, -27.213463371624243, -45.16862556023213, -22.1181119654498, -44.345790596144795, -33.131728677802975, -9.495912843892715, -32.52145065738254, -28.27104860321864, -27.847809930170623, -39.66830554351928, -57.38742492127777, -19.318447760839604, -33.069754486804584, -22.005239835977836, -32.87499953227149, -39.253296310729006, -30.09628920127012, -40.46020733522077, -28.542345457176644, -19.923896126997786, -23.875982803664307, -21.975260789065103, -17.362652711637754, -32.4356728206687, -9.992457381541549, -17.838985271448216, -26.649344380529186, -4.14860891236375, -45.42360843879895, -43.8050136235965, -17.21935351845766, -31.48208125690815, -26.414158839779926, -32.03439222132101, -48.75897408091288, -25.786075054015036, -5.230082142236374, -17.757506641454228, -23.91489311562193, -3.5121410356193703, -28.409386198231285, -32.07235711070869, -15.091708904573508, -44.31510452821223, -46.95543634658393, -32.97611313903886, -26.14901979476015], "policy_predator_policy_reward": [33.15560454400745, 38.325495076153764, 42.18801586955522, 25.622750677942236, 21.61101681265817, 5.6120436395148054, 16.416570029630684, 10.017805122832163, 26.399534439997343, 20.960972528271768, 37.86529668582859, 19.138623644696256, 22.621506742477145, 19.114303801690816, 24.6823535745159, 39.80479844564652, 12.997066398979984, 50.030980909898695, 21.126291070442832, 28.1533266255213, 30.473798496925678, 3.347799886685782, 43.282910637976094, 41.198413604807115, 19.372463255004618, 25.70918802298115, 10.044758882392337, 29.703889453719043, 31.51440936328974, 5.422589304572818, 24.052704990744896, 26.336058468035315, 14.898786585500735, 12.44776075082871, 33.45428079280121, 9.34386486865871, 7.092339806687478, 35.114914190989964, 47.282830557531476, 5.280331949906396, 19.502233883676546, 22.676286689523238, 24.147490295631147, 39.204004115271225, 10.954731146039986, 19.35898273534533, 33.83635948648128, 49.390754560519824, 29.21905661876517, 18.887922303526366, 24.927682040076334, 13.502423791042233, 3.9125782813698624, 27.213463371624243, 45.16862556023213, 22.1181119654498, 44.345790596144795, 33.131728677802975, 9.495912843892715, 32.52145065738254, 28.27104860321864, 27.847809930170623, 39.66830554351928, 57.38742492127777, 19.318447760839604, 33.069754486804584, 22.005239835977836, 32.87499953227149, 39.253296310729006, 30.09628920127012, 40.46020733522077, 28.542345457176644, 19.923896126997786, 23.875982803664307, 21.975260789065103, 17.362652711637754, 32.4356728206687, 9.992457381541549, 17.838985271448216, 26.649344380529186, 4.14860891236375, 45.42360843879895, 43.8050136235965, 17.21935351845766, 31.48208125690815, 26.414158839779926, 32.03439222132101, 48.75897408091288, 25.786075054015036, 5.230082142236374, 17.757506641454228, 23.91489311562193, 3.5121410356193703, 28.409386198231285, 32.07235711070869, 15.091708904573508, 44.31510452821223, 46.95543634658393, 32.97611313903886, 26.14901979476015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29519514279976905, "mean_inference_ms": 0.9487747755510503, "mean_action_processing_ms": 0.12617019725458845, "mean_env_wait_ms": 0.06671723432195914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026035308837890625, "StateBufferConnector_ms": 0.0022592544555664062, "ViewRequirementAgentConnector_ms": 0.04537761211395264}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 694.062468623936, "num_env_steps_trained_throughput_per_sec": 694.062468623936, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 6349.285, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6349.217, "sample_time_ms": 743.548, "learn_time_ms": 5587.538, "learn_throughput": 715.879, "synch_weights_time_ms": 17.565}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 93, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-06", "timestamp": 1723390806, "time_this_iter_s": 5.768419027328491, "time_total_s": 549.916645526886, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 549.916645526886, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.2875, "ram_util_percent": 81.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1764326450725395, "cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4754989135079086, "policy_loss": -0.004824253887151523, "vf_loss": 1.4803231678903104, "vf_explained_var": 0.9684458789726098, "kl": 0.007626490776196763, "entropy": 0.4484359168137113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3266473926603792, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4897857607652745, "policy_loss": -0.0024859659623568103, "vf_loss": 1.492150599633654, "vf_explained_var": 0.9684122039626042, "kl": 0.009689933667405625, "entropy": 0.6598237620666623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.68, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 6868, "policy_reward_min": {"prey_policy": -57.38742492127777, "predator_policy": 2.5712162249969817}, "policy_reward_max": {"prey_policy": -2.5712162249969817, "predator_policy": 57.38742492127777}, "policy_reward_mean": {"prey_policy": -27.490739933671037, "predator_policy": 27.490739933671037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [25, 70, 79, 45, 65, 91, 63, 82, 55, 93, 85, 71, 88, 59, 33, 93, 70, 81, 71, 32, 33, 95, 54, 93, 93, 53, 74, 56, 67, 173, 81, 52, 22, 99, 49, 85, 77, 56, 86, 82, 85, 90, 80, 83, 92, 54, 103, 64, 58, 72, 71, 81, 69, 74, 43, 65, 79, 74, 44, 67, 45, 75, 53, 81, 70, 88, 79, 86, 39, 91, 75, 58, 83, 47, 81, 65, 80, 71, 44, 67, 53, 33, 16, 61, 95, 99, 65, 140, 20, 20, 62, 75, 60, 98, 56, 28, 74, 33, 53, 70], "policy_prey_policy_reward": [-9.495912843892715, -32.52145065738254, -28.27104860321864, -27.847809930170623, -39.66830554351928, -57.38742492127777, -19.318447760839604, -33.069754486804584, -22.005239835977836, -32.87499953227149, -39.253296310729006, -30.09628920127012, -40.46020733522077, -28.542345457176644, -19.923896126997786, -23.875982803664307, -21.975260789065103, -17.362652711637754, -32.4356728206687, -9.992457381541549, -17.838985271448216, -26.649344380529186, -4.14860891236375, -45.42360843879895, -43.8050136235965, -17.21935351845766, -31.48208125690815, -26.414158839779926, -32.03439222132101, -48.75897408091288, -25.786075054015036, -5.230082142236374, -17.757506641454228, -23.91489311562193, -3.5121410356193703, -28.409386198231285, -32.07235711070869, -15.091708904573508, -44.31510452821223, -46.95543634658393, -32.97611313903886, -26.14901979476015, -17.396955712981004, -30.422917020451298, -56.64450911649365, -26.65975873587422, -39.205301658869864, -31.29141245292285, -16.804291527259046, -41.738760594392936, -26.696989788108418, -32.60231350054784, -31.17320869389982, -39.252525950489215, -8.581675264241094, -38.86769930640733, -15.074487895057954, -40.48885815493405, -26.026030326849074, -40.08835475855305, -29.159982560401282, -30.44602234874871, -17.675588351428562, -26.067661796522, -42.641782186726886, -50.039324699364, -37.18566446763636, -36.26978603270181, -29.075338010104666, -24.109593833657915, -35.66075994149777, -12.983041840806926, -21.304573246742912, -31.384013671386263, -16.060745379250424, -19.876476682572978, -35.87502255655466, -38.64857847310221, -8.355265465686433, -14.932682541541938, -25.063683940553446, -23.999997921377314, -2.5712162249969817, -29.74295662217116, -41.11156867505852, -31.73857729783417, -26.270281332975337, -34.22820616752134, -4.565653376811206, -5.7742855839379965, -45.77980709443272, -18.620939369651087, -2.8826812494825718, -29.150933267731645, -41.82369906533445, -12.636496068430047, -19.87226999207629, -15.289955801494308, -29.561193717362656, -29.2988364446048], "policy_predator_policy_reward": [9.495912843892715, 32.52145065738254, 28.27104860321864, 27.847809930170623, 39.66830554351928, 57.38742492127777, 19.318447760839604, 33.069754486804584, 22.005239835977836, 32.87499953227149, 39.253296310729006, 30.09628920127012, 40.46020733522077, 28.542345457176644, 19.923896126997786, 23.875982803664307, 21.975260789065103, 17.362652711637754, 32.4356728206687, 9.992457381541549, 17.838985271448216, 26.649344380529186, 4.14860891236375, 45.42360843879895, 43.8050136235965, 17.21935351845766, 31.48208125690815, 26.414158839779926, 32.03439222132101, 48.75897408091288, 25.786075054015036, 5.230082142236374, 17.757506641454228, 23.91489311562193, 3.5121410356193703, 28.409386198231285, 32.07235711070869, 15.091708904573508, 44.31510452821223, 46.95543634658393, 32.97611313903886, 26.14901979476015, 17.396955712981004, 30.422917020451298, 56.64450911649365, 26.65975873587422, 39.205301658869864, 31.29141245292285, 16.804291527259046, 41.738760594392936, 26.696989788108418, 32.60231350054784, 31.17320869389982, 39.252525950489215, 8.581675264241094, 38.86769930640733, 15.074487895057954, 40.48885815493405, 26.026030326849074, 40.08835475855305, 29.159982560401282, 30.44602234874871, 17.675588351428562, 26.067661796522, 42.641782186726886, 50.039324699364, 37.18566446763636, 36.26978603270181, 29.075338010104666, 24.109593833657915, 35.66075994149777, 12.983041840806926, 21.304573246742912, 31.384013671386263, 16.060745379250424, 19.876476682572978, 35.87502255655466, 38.64857847310221, 8.355265465686433, 14.932682541541938, 25.063683940553446, 23.999997921377314, 2.5712162249969817, 29.74295662217116, 41.11156867505852, 31.73857729783417, 26.270281332975337, 34.22820616752134, 4.565653376811206, 5.7742855839379965, 45.77980709443272, 18.620939369651087, 2.8826812494825718, 29.150933267731645, 41.82369906533445, 12.636496068430047, 19.87226999207629, 15.289955801494308, 29.561193717362656, 29.2988364446048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29506689167800043, "mean_inference_ms": 0.9479586396721661, "mean_action_processing_ms": 0.1261969381183273, "mean_env_wait_ms": 0.06663756844986884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002687692642211914, "StateBufferConnector_ms": 0.0022634267807006836, "ViewRequirementAgentConnector_ms": 0.04675400257110596}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 655.5445511554757, "num_env_steps_trained_throughput_per_sec": 655.5445511554757, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 6369.388, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6369.32, "sample_time_ms": 749.417, "learn_time_ms": 5601.745, "learn_throughput": 714.063, "synch_weights_time_ms": 17.59}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 94, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-12", "timestamp": 1723390812, "time_this_iter_s": 6.107470273971558, "time_total_s": 556.0241158008575, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 556.0241158008575, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 29.633333333333333, "ram_util_percent": 81.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.126769721756379, "cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1993311625905334, "policy_loss": -0.0025921008937681714, "vf_loss": 1.2019232616449396, "vf_explained_var": 0.977670048798124, "kl": 0.006200286831909807, "entropy": 0.37757117425402004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2733819361776115, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2027928330004216, "policy_loss": -0.007238239066888734, "vf_loss": 1.209909190237522, "vf_explained_var": 0.9774670664221048, "kl": 0.009750503084853849, "entropy": 0.6710797934482495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.22, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6522, "policy_reward_min": {"prey_policy": -59.04968146920596, "predator_policy": 2.5712162249969817}, "policy_reward_max": {"prey_policy": -2.5712162249969817, "predator_policy": 59.04968146920596}, "policy_reward_mean": {"prey_policy": -24.572260402791752, "predator_policy": 24.572260402791752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [53, 81, 70, 88, 79, 86, 39, 91, 75, 58, 83, 47, 81, 65, 80, 71, 44, 67, 53, 33, 16, 61, 95, 99, 65, 140, 20, 20, 62, 75, 60, 98, 56, 28, 74, 33, 53, 70, 77, 62, 15, 51, 122, 71, 91, 78, 82, 102, 63, 54, 50, 72, 57, 46, 49, 30, 69, 49, 52, 35, 39, 66, 63, 82, 68, 81, 54, 41, 67, 69, 81, 90, 79, 64, 58, 64, 45, 92, 73, 82, 42, 24, 52, 95, 64, 88, 68, 82, 69, 81, 74, 61, 77, 46, 83, 22, 71, 88, 63, 68], "policy_prey_policy_reward": [-17.675588351428562, -26.067661796522, -42.641782186726886, -50.039324699364, -37.18566446763636, -36.26978603270181, -29.075338010104666, -24.109593833657915, -35.66075994149777, -12.983041840806926, -21.304573246742912, -31.384013671386263, -16.060745379250424, -19.876476682572978, -35.87502255655466, -38.64857847310221, -8.355265465686433, -14.932682541541938, -25.063683940553446, -23.999997921377314, -2.5712162249969817, -29.74295662217116, -41.11156867505852, -31.73857729783417, -26.270281332975337, -34.22820616752134, -4.565653376811206, -5.7742855839379965, -45.77980709443272, -18.620939369651087, -2.8826812494825718, -29.150933267731645, -41.82369906533445, -12.636496068430047, -19.87226999207629, -15.289955801494308, -29.561193717362656, -29.2988364446048, -32.1891347013415, -16.11373634249322, -3.4850607648471446, -23.120067034030566, -4.4093172374586445, -18.07321897771204, -9.322057720227969, -43.698914358870226, -38.15185280303432, -10.508496082945767, -28.965678147024374, -9.433382635893903, -10.655915103351553, -41.915974438550684, -28.09660372377542, -10.915796960494719, -9.76240973656127, -7.88221050671673, -28.948937339606964, -17.32129928489278, -4.3876812355814145, -21.392226705776583, -22.853391088937688, -35.68005643639403, -27.181163450476742, -23.489821749548277, -40.73666151588865, -45.03325407813927, -19.31576885575594, -18.6854826318615, -37.455976225494645, -33.7766232077219, -37.898140934088374, -59.04968146920596, -30.424049370209165, -10.078842054598793, -39.10731612058001, -27.17142919291229, -18.13467708062653, -5.336890469033965, -16.416845981170024, -42.65479134044375, -16.76628504979398, -9.007974988030949, -25.71464474767247, -31.385143599080692, -16.959516911517234, -36.66821439019689, -35.097250938288695, -46.269379950628505, -39.04349060682435, -22.29321544726599, -24.606670047818085, -4.585754447732497, -36.29997028520741, -8.703580106250643, -25.84229382051206, -6.197468262442706, -19.966133937031096, -6.4970221497693705, -29.950100786909616, -38.01195632080432], "policy_predator_policy_reward": [17.675588351428562, 26.067661796522, 42.641782186726886, 50.039324699364, 37.18566446763636, 36.26978603270181, 29.075338010104666, 24.109593833657915, 35.66075994149777, 12.983041840806926, 21.304573246742912, 31.384013671386263, 16.060745379250424, 19.876476682572978, 35.87502255655466, 38.64857847310221, 8.355265465686433, 14.932682541541938, 25.063683940553446, 23.999997921377314, 2.5712162249969817, 29.74295662217116, 41.11156867505852, 31.73857729783417, 26.270281332975337, 34.22820616752134, 4.565653376811206, 5.7742855839379965, 45.77980709443272, 18.620939369651087, 2.8826812494825718, 29.150933267731645, 41.82369906533445, 12.636496068430047, 19.87226999207629, 15.289955801494308, 29.561193717362656, 29.2988364446048, 32.1891347013415, 16.11373634249322, 3.4850607648471446, 23.120067034030566, 4.4093172374586445, 18.07321897771204, 9.322057720227969, 43.698914358870226, 38.15185280303432, 10.508496082945767, 28.965678147024374, 9.433382635893903, 10.655915103351553, 41.915974438550684, 28.09660372377542, 10.915796960494719, 9.76240973656127, 7.88221050671673, 28.948937339606964, 17.32129928489278, 4.3876812355814145, 21.392226705776583, 22.853391088937688, 35.68005643639403, 27.181163450476742, 23.489821749548277, 40.73666151588865, 45.03325407813927, 19.31576885575594, 18.6854826318615, 37.455976225494645, 33.7766232077219, 37.898140934088374, 59.04968146920596, 30.424049370209165, 10.078842054598793, 39.10731612058001, 27.17142919291229, 18.13467708062653, 5.336890469033965, 16.416845981170024, 42.65479134044375, 16.76628504979398, 9.007974988030949, 25.71464474767247, 31.385143599080692, 16.959516911517234, 36.66821439019689, 35.097250938288695, 46.269379950628505, 39.04349060682435, 22.29321544726599, 24.606670047818085, 4.585754447732497, 36.29997028520741, 8.703580106250643, 25.84229382051206, 6.197468262442706, 19.966133937031096, 6.4970221497693705, 29.950100786909616, 38.01195632080432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29471106896290195, "mean_inference_ms": 0.9471555520632023, "mean_action_processing_ms": 0.1261961037637056, "mean_env_wait_ms": 0.06657494529030625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002795696258544922, "StateBufferConnector_ms": 0.002055644989013672, "ViewRequirementAgentConnector_ms": 0.04783213138580322}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 669.7461739790294, "num_env_steps_trained_throughput_per_sec": 669.7461739790294, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 6382.593, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6382.524, "sample_time_ms": 748.381, "learn_time_ms": 5615.992, "learn_throughput": 712.252, "synch_weights_time_ms": 17.657}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 95, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-18", "timestamp": 1723390818, "time_this_iter_s": 5.977833986282349, "time_total_s": 562.0019497871399, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 562.0019497871399, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 27.8875, "ram_util_percent": 81.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3787526870767275, "cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6754293472195665, "policy_loss": -0.0007307515586338317, "vf_loss": 1.676160096252958, "vf_explained_var": 0.9639365290602048, "kl": 0.005682726942463934, "entropy": 0.41592019523183504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5703680546333394, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6706994830320279, "policy_loss": -0.008071682978091606, "vf_loss": 1.678609385341406, "vf_explained_var": 0.9657066793491443, "kl": 0.012942319199402872, "entropy": 0.6513161947950721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.84, "episode_media": {}, "episodes_this_iter": 57, "episodes_timesteps_total": 6784, "policy_reward_min": {"prey_policy": -59.04968146920596, "predator_policy": 0.2503590743248767}, "policy_reward_max": {"prey_policy": -0.2503590743248767, "predator_policy": 59.04968146920596}, "policy_reward_mean": {"prey_policy": -26.707850910874868, "predator_policy": 26.707850910874868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [49, 52, 35, 39, 66, 63, 82, 68, 81, 54, 41, 67, 69, 81, 90, 79, 64, 58, 64, 45, 92, 73, 82, 42, 24, 52, 95, 64, 88, 68, 82, 69, 81, 74, 61, 77, 46, 83, 22, 71, 88, 63, 68, 88, 61, 28, 84, 105, 82, 78, 78, 68, 53, 55, 57, 75, 100, 39, 80, 71, 29, 68, 59, 27, 81, 54, 92, 51, 75, 67, 64, 58, 78, 86, 83, 69, 86, 65, 146, 63, 57, 81, 61, 53, 35, 66, 81, 61, 67, 62, 58, 71, 59, 74, 103, 87, 90, 79, 44, 80], "policy_prey_policy_reward": [-17.32129928489278, -4.3876812355814145, -21.392226705776583, -22.853391088937688, -35.68005643639403, -27.181163450476742, -23.489821749548277, -40.73666151588865, -45.03325407813927, -19.31576885575594, -18.6854826318615, -37.455976225494645, -33.7766232077219, -37.898140934088374, -59.04968146920596, -30.424049370209165, -10.078842054598793, -39.10731612058001, -27.17142919291229, -18.13467708062653, -5.336890469033965, -16.416845981170024, -42.65479134044375, -16.76628504979398, -9.007974988030949, -25.71464474767247, -31.385143599080692, -16.959516911517234, -36.66821439019689, -35.097250938288695, -46.269379950628505, -39.04349060682435, -22.29321544726599, -24.606670047818085, -4.585754447732497, -36.29997028520741, -8.703580106250643, -25.84229382051206, -6.197468262442706, -19.966133937031096, -6.4970221497693705, -29.950100786909616, -38.01195632080432, -24.867816852107595, -8.185804434908762, -22.42341308703901, -37.962966231000955, -39.359912548513186, -40.964899986191874, -31.053167703609027, -38.90365647090666, -30.282795179891597, -34.4701961318272, -26.126146057554386, -36.026034470164305, -13.63496979188117, -27.833776436278395, -17.972166236583753, -27.34053392904067, -33.073492928806715, -11.0404503026204, -25.82364166527528, -31.745517741245397, -8.51141856399892, -21.84210204460169, -26.816209668744136, -41.83164258345849, -13.317284876617185, -38.91701273147764, -33.03297662514973, -26.909990954156072, -42.50205686112213, -18.53124059087455, -12.015734790396905, -29.918983491368028, -14.918811636636134, -40.23596270937134, -42.88204216962966, -10.355829799304498, -19.71635282307208, -17.726581767747255, -35.51848678039442, -31.75378520918414, -35.22949015290169, -0.2503590743248767, -10.349799938197107, -41.59292476863344, -19.834625740579938, -33.40549028565826, -23.101165656358198, -22.19619047474289, -28.58985383689616, -8.24390853864711, -46.874606752572234, -40.46805902774541, -51.827305819882184, -43.26317205366221, -34.81696485223694, -14.999807001141141, -15.94736497743899], "policy_predator_policy_reward": [17.32129928489278, 4.3876812355814145, 21.392226705776583, 22.853391088937688, 35.68005643639403, 27.181163450476742, 23.489821749548277, 40.73666151588865, 45.03325407813927, 19.31576885575594, 18.6854826318615, 37.455976225494645, 33.7766232077219, 37.898140934088374, 59.04968146920596, 30.424049370209165, 10.078842054598793, 39.10731612058001, 27.17142919291229, 18.13467708062653, 5.336890469033965, 16.416845981170024, 42.65479134044375, 16.76628504979398, 9.007974988030949, 25.71464474767247, 31.385143599080692, 16.959516911517234, 36.66821439019689, 35.097250938288695, 46.269379950628505, 39.04349060682435, 22.29321544726599, 24.606670047818085, 4.585754447732497, 36.29997028520741, 8.703580106250643, 25.84229382051206, 6.197468262442706, 19.966133937031096, 6.4970221497693705, 29.950100786909616, 38.01195632080432, 24.867816852107595, 8.185804434908762, 22.42341308703901, 37.962966231000955, 39.359912548513186, 40.964899986191874, 31.053167703609027, 38.90365647090666, 30.282795179891597, 34.4701961318272, 26.126146057554386, 36.026034470164305, 13.63496979188117, 27.833776436278395, 17.972166236583753, 27.34053392904067, 33.073492928806715, 11.0404503026204, 25.82364166527528, 31.745517741245397, 8.51141856399892, 21.84210204460169, 26.816209668744136, 41.83164258345849, 13.317284876617185, 38.91701273147764, 33.03297662514973, 26.909990954156072, 42.50205686112213, 18.53124059087455, 12.015734790396905, 29.918983491368028, 14.918811636636134, 40.23596270937134, 42.88204216962966, 10.355829799304498, 19.71635282307208, 17.726581767747255, 35.51848678039442, 31.75378520918414, 35.22949015290169, 0.2503590743248767, 10.349799938197107, 41.59292476863344, 19.834625740579938, 33.40549028565826, 23.101165656358198, 22.19619047474289, 28.58985383689616, 8.24390853864711, 46.874606752572234, 40.46805902774541, 51.827305819882184, 43.26317205366221, 34.81696485223694, 14.999807001141141, 15.94736497743899]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2943830270143416, "mean_inference_ms": 0.9462293114830571, "mean_action_processing_ms": 0.1260424696234385, "mean_env_wait_ms": 0.06651116680451472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029369592666625977, "StateBufferConnector_ms": 0.0020078420639038086, "ViewRequirementAgentConnector_ms": 0.04645800590515137}, "num_episodes": 57, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 655.8560936483362, "num_env_steps_trained_throughput_per_sec": 655.8560936483362, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 6336.511, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6336.447, "sample_time_ms": 746.068, "learn_time_ms": 5572.537, "learn_throughput": 717.806, "synch_weights_time_ms": 17.359}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 96, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-24", "timestamp": 1723390824, "time_this_iter_s": 6.105740070343018, "time_total_s": 568.1076898574829, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 568.1076898574829, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 30.188888888888886, "ram_util_percent": 81.45555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3080606766045095, "cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7687477135409913, "policy_loss": -0.0017099547544300246, "vf_loss": 1.7704576678574084, "vf_explained_var": 0.95461446326226, "kl": 0.004160218328585518, "entropy": 0.4103751494238774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4473553624004127, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7694426355262598, "policy_loss": -0.006777104045856201, "vf_loss": 1.7760650755216678, "vf_explained_var": 0.9552915695433816, "kl": 0.012373694238932005, "entropy": 0.6436140919725101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.47, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6747, "policy_reward_min": {"prey_policy": -53.25124812489061, "predator_policy": 0.2503590743248767}, "policy_reward_max": {"prey_policy": -0.2503590743248767, "predator_policy": 53.25124812489061}, "policy_reward_mean": {"prey_policy": -25.451290399339673, "predator_policy": 25.451290399339673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [59, 27, 81, 54, 92, 51, 75, 67, 64, 58, 78, 86, 83, 69, 86, 65, 146, 63, 57, 81, 61, 53, 35, 66, 81, 61, 67, 62, 58, 71, 59, 74, 103, 87, 90, 79, 44, 80, 84, 66, 90, 68, 91, 49, 66, 66, 53, 39, 61, 63, 80, 87, 115, 61, 90, 56, 78, 30, 81, 94, 32, 82, 48, 89, 49, 90, 73, 41, 46, 93, 34, 24, 79, 43, 67, 13, 72, 84, 4, 50, 56, 91, 92, 90, 28, 99, 84, 47, 58, 50, 74, 36, 78, 62, 59, 97, 83, 74, 48, 87], "policy_prey_policy_reward": [-31.745517741245397, -8.51141856399892, -21.84210204460169, -26.816209668744136, -41.83164258345849, -13.317284876617185, -38.91701273147764, -33.03297662514973, -26.909990954156072, -42.50205686112213, -18.53124059087455, -12.015734790396905, -29.918983491368028, -14.918811636636134, -40.23596270937134, -42.88204216962966, -10.355829799304498, -19.71635282307208, -17.726581767747255, -35.51848678039442, -31.75378520918414, -35.22949015290169, -0.2503590743248767, -10.349799938197107, -41.59292476863344, -19.834625740579938, -33.40549028565826, -23.101165656358198, -22.19619047474289, -28.58985383689616, -8.24390853864711, -46.874606752572234, -40.46805902774541, -51.827305819882184, -43.26317205366221, -34.81696485223694, -14.999807001141141, -15.94736497743899, -39.52070156589618, -20.048625002654298, -42.267730297502084, -36.88347198498016, -15.69489653445685, -14.028443466567596, -36.29785250717477, -35.52805634891765, -16.157099109136137, -23.081084924661184, -30.909089724751553, -22.77519667068614, -12.606156247565004, -31.26342002354134, -11.601120531658463, -29.85780311648583, -20.069750903138573, -45.225548356556345, -37.77325188915952, -9.694600539210242, -24.957377863281106, -35.26191174645556, -9.679768796824781, -9.731380425305133, -4.47581149579757, -38.48007389275533, -9.018451509689498, -36.90069577094002, -26.377960562557412, -18.627313940317492, -16.584426273336035, -46.220476168801994, -15.102351686780523, -11.5640707971362, -42.94356842236742, -18.935597396628715, -16.860942588349992, -6.45776917298929, -39.17611669486892, -25.13906270517285, -1.770257769206549, -30.26461660219312, -30.2770982683638, -29.328513577685364, -53.25124812489061, -16.144144089401003, -12.727112186585034, -41.202598563299176, -40.4269208107998, -11.460806549481845, -11.694193359953037, -13.948235964202382, -16.88887340981517, -17.45534043540479, -37.104576707704645, -3.655501221619768, -26.590571015438595, -28.029520327431975, -26.843837804923474, -20.192128519068476, -30.431536254054837, -31.671267347219356], "policy_predator_policy_reward": [31.745517741245397, 8.51141856399892, 21.84210204460169, 26.816209668744136, 41.83164258345849, 13.317284876617185, 38.91701273147764, 33.03297662514973, 26.909990954156072, 42.50205686112213, 18.53124059087455, 12.015734790396905, 29.918983491368028, 14.918811636636134, 40.23596270937134, 42.88204216962966, 10.355829799304498, 19.71635282307208, 17.726581767747255, 35.51848678039442, 31.75378520918414, 35.22949015290169, 0.2503590743248767, 10.349799938197107, 41.59292476863344, 19.834625740579938, 33.40549028565826, 23.101165656358198, 22.19619047474289, 28.58985383689616, 8.24390853864711, 46.874606752572234, 40.46805902774541, 51.827305819882184, 43.26317205366221, 34.81696485223694, 14.999807001141141, 15.94736497743899, 39.52070156589618, 20.048625002654298, 42.267730297502084, 36.88347198498016, 15.69489653445685, 14.028443466567596, 36.29785250717477, 35.52805634891765, 16.157099109136137, 23.081084924661184, 30.909089724751553, 22.77519667068614, 12.606156247565004, 31.26342002354134, 11.601120531658463, 29.85780311648583, 20.069750903138573, 45.225548356556345, 37.77325188915952, 9.694600539210242, 24.957377863281106, 35.26191174645556, 9.679768796824781, 9.731380425305133, 4.47581149579757, 38.48007389275533, 9.018451509689498, 36.90069577094002, 26.377960562557412, 18.627313940317492, 16.584426273336035, 46.220476168801994, 15.102351686780523, 11.5640707971362, 42.94356842236742, 18.935597396628715, 16.860942588349992, 6.45776917298929, 39.17611669486892, 25.13906270517285, 1.770257769206549, 30.26461660219312, 30.2770982683638, 29.328513577685364, 53.25124812489061, 16.144144089401003, 12.727112186585034, 41.202598563299176, 40.4269208107998, 11.460806549481845, 11.694193359953037, 13.948235964202382, 16.88887340981517, 17.45534043540479, 37.104576707704645, 3.655501221619768, 26.590571015438595, 28.029520327431975, 26.843837804923474, 20.192128519068476, 30.431536254054837, 31.671267347219356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29420418385458774, "mean_inference_ms": 0.9457932348716537, "mean_action_processing_ms": 0.12583001143694866, "mean_env_wait_ms": 0.06648022344082496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002869129180908203, "StateBufferConnector_ms": 0.001979351043701172, "ViewRequirementAgentConnector_ms": 0.04694318771362305}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 637.6352349266218, "num_env_steps_trained_throughput_per_sec": 637.6352349266218, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 6209.826, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6209.763, "sample_time_ms": 737.923, "learn_time_ms": 5454.153, "learn_throughput": 733.386, "synch_weights_time_ms": 17.266}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "training_iteration": 97, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-30", "timestamp": 1723390830, "time_this_iter_s": 6.279246091842651, "time_total_s": 574.3869359493256, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 574.3869359493256, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.71111111111111, "ram_util_percent": 81.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1264890902365248, "cur_kl_coeff": 7.152557373046873e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3569245893508195, "policy_loss": -0.002994881570339203, "vf_loss": 1.3599194678788384, "vf_explained_var": 0.9712506347646316, "kl": 0.004122812999353794, "entropy": 0.37346509483953316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.26894585651656, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3835149658843875, "policy_loss": -0.007641376407021502, "vf_loss": 1.3909357186717293, "vf_explained_var": 0.9702863935381174, "kl": 0.017649835841156366, "entropy": 0.6742038577174146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.39, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6339, "policy_reward_min": {"prey_policy": -53.25124812489061, "predator_policy": 0.48879236238356205}, "policy_reward_max": {"prey_policy": -0.48879236238356205, "predator_policy": 53.25124812489061}, "policy_reward_mean": {"prey_policy": -24.393425738784998, "predator_policy": 24.393425738784998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [48, 89, 49, 90, 73, 41, 46, 93, 34, 24, 79, 43, 67, 13, 72, 84, 4, 50, 56, 91, 92, 90, 28, 99, 84, 47, 58, 50, 74, 36, 78, 62, 59, 97, 83, 74, 48, 87, 72, 75, 81, 148, 85, 43, 81, 54, 64, 49, 2, 60, 83, 32, 80, 77, 44, 92, 51, 44, 84, 61, 43, 63, 54, 62, 78, 86, 66, 86, 50, 74, 47, 71, 94, 49, 88, 32, 61, 29, 61, 53, 50, 73, 54, 67, 66, 67, 32, 49, 44, 74, 61, 58, 70, 73, 79, 47, 76, 57, 93, 48], "policy_prey_policy_reward": [-4.47581149579757, -38.48007389275533, -9.018451509689498, -36.90069577094002, -26.377960562557412, -18.627313940317492, -16.584426273336035, -46.220476168801994, -15.102351686780523, -11.5640707971362, -42.94356842236742, -18.935597396628715, -16.860942588349992, -6.45776917298929, -39.17611669486892, -25.13906270517285, -1.770257769206549, -30.26461660219312, -30.2770982683638, -29.328513577685364, -53.25124812489061, -16.144144089401003, -12.727112186585034, -41.202598563299176, -40.4269208107998, -11.460806549481845, -11.694193359953037, -13.948235964202382, -16.88887340981517, -17.45534043540479, -37.104576707704645, -3.655501221619768, -26.590571015438595, -28.029520327431975, -26.843837804923474, -20.192128519068476, -30.431536254054837, -31.671267347219356, -21.42247317432821, -35.29144385530114, -46.43680985801397, -20.669798942230084, -36.92532875500527, -15.402503129488878, -33.73902044619332, -19.360693930450104, -15.022894477620884, -22.994814543555655, -0.48879236238356205, -22.677132792329566, -23.98919365454889, -6.680539807439411, -27.22203178392441, -49.2421303860515, -33.55735144709339, -13.612234144957965, -22.533648808998233, -23.481093804771493, -39.24283200058713, -35.54541951608557, -26.632969316512657, -37.65011957547882, -30.30491740555611, -20.79577313985095, -33.487637814487755, -25.71074206611094, -21.213723426459477, -49.13148768201925, -4.829454017552954, -15.390691260363512, -11.635195843035211, -32.047523668271104, -32.771537900622924, -19.755256825236074, -33.71366150901586, -16.382280742855244, -32.08768704049414, -8.314965682429891, -11.191933385168658, -33.984771903316, -13.202171288719288, -31.80333637241173, -34.51335217930714, -37.82875531705287, -31.80527013710128, -25.639091800590446, -8.045412048659292, -24.22433268492975, -11.07924779095772, -38.02787520058044, -13.210001652686788, -24.581637091578944, -18.363699660699517, -8.655306047702279, -47.039001652177085, -9.333364509441957, -34.31797545347875, -18.955240346850886, -24.31918332711606, -17.604219503029068], "policy_predator_policy_reward": [4.47581149579757, 38.48007389275533, 9.018451509689498, 36.90069577094002, 26.377960562557412, 18.627313940317492, 16.584426273336035, 46.220476168801994, 15.102351686780523, 11.5640707971362, 42.94356842236742, 18.935597396628715, 16.860942588349992, 6.45776917298929, 39.17611669486892, 25.13906270517285, 1.770257769206549, 30.26461660219312, 30.2770982683638, 29.328513577685364, 53.25124812489061, 16.144144089401003, 12.727112186585034, 41.202598563299176, 40.4269208107998, 11.460806549481845, 11.694193359953037, 13.948235964202382, 16.88887340981517, 17.45534043540479, 37.104576707704645, 3.655501221619768, 26.590571015438595, 28.029520327431975, 26.843837804923474, 20.192128519068476, 30.431536254054837, 31.671267347219356, 21.42247317432821, 35.29144385530114, 46.43680985801397, 20.669798942230084, 36.92532875500527, 15.402503129488878, 33.73902044619332, 19.360693930450104, 15.022894477620884, 22.994814543555655, 0.48879236238356205, 22.677132792329566, 23.98919365454889, 6.680539807439411, 27.22203178392441, 49.2421303860515, 33.55735144709339, 13.612234144957965, 22.533648808998233, 23.481093804771493, 39.24283200058713, 35.54541951608557, 26.632969316512657, 37.65011957547882, 30.30491740555611, 20.79577313985095, 33.487637814487755, 25.71074206611094, 21.213723426459477, 49.13148768201925, 4.829454017552954, 15.390691260363512, 11.635195843035211, 32.047523668271104, 32.771537900622924, 19.755256825236074, 33.71366150901586, 16.382280742855244, 32.08768704049414, 8.314965682429891, 11.191933385168658, 33.984771903316, 13.202171288719288, 31.80333637241173, 34.51335217930714, 37.82875531705287, 31.80527013710128, 25.639091800590446, 8.045412048659292, 24.22433268492975, 11.07924779095772, 38.02787520058044, 13.210001652686788, 24.581637091578944, 18.363699660699517, 8.655306047702279, 47.039001652177085, 9.333364509441957, 34.31797545347875, 18.955240346850886, 24.31918332711606, 17.604219503029068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29419946063311214, "mean_inference_ms": 0.9449676418906608, "mean_action_processing_ms": 0.1258287029784169, "mean_env_wait_ms": 0.066409996595499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026987791061401367, "StateBufferConnector_ms": 0.0020542144775390625, "ViewRequirementAgentConnector_ms": 0.04699695110321045}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 663.557999886251, "num_env_steps_trained_throughput_per_sec": 663.557999886251, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 6194.191, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6194.129, "sample_time_ms": 730.726, "learn_time_ms": 5445.777, "learn_throughput": 734.514, "synch_weights_time_ms": 17.171}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 98, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-36", "timestamp": 1723390836, "time_this_iter_s": 6.034244060516357, "time_total_s": 580.4211800098419, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 580.4211800098419, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 30.34444444444444, "ram_util_percent": 81.48888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2012121251473826, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5725512121183176, "policy_loss": -0.0028350586420856417, "vf_loss": 1.5753862721845509, "vf_explained_var": 0.9673663917928934, "kl": 0.0055386850425089545, "entropy": 0.41906111476322017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.450429325302442, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5252995676671466, "policy_loss": -0.008588445136410883, "vf_loss": 1.5337475382412473, "vf_explained_var": 0.9681882019465168, "kl": 0.011237908532977375, "entropy": 0.6638897821928064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.27, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6427, "policy_reward_min": {"prey_policy": -55.114783680322304, "predator_policy": 1.5171867305385338}, "policy_reward_max": {"prey_policy": -1.5171867305385338, "predator_policy": 55.114783680322304}, "policy_reward_mean": {"prey_policy": -26.03902264870033, "predator_policy": 26.03902264870033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [63, 54, 62, 78, 86, 66, 86, 50, 74, 47, 71, 94, 49, 88, 32, 61, 29, 61, 53, 50, 73, 54, 67, 66, 67, 32, 49, 44, 74, 61, 58, 70, 73, 79, 47, 76, 57, 93, 48, 140, 39, 10, 85, 75, 85, 84, 60, 43, 66, 65, 41, 59, 60, 89, 89, 77, 84, 50, 72, 91, 81, 31, 80, 73, 51, 69, 76, 45, 53, 84, 91, 90, 75, 94, 71, 49, 48, 47, 53, 54, 41, 46, 47, 64, 33, 3, 69, 53, 65, 76, 80, 76, 78, 83, 12, 45, 81, 78, 96, 80], "policy_prey_policy_reward": [-37.65011957547882, -30.30491740555611, -20.79577313985095, -33.487637814487755, -25.71074206611094, -21.213723426459477, -49.13148768201925, -4.829454017552954, -15.390691260363512, -11.635195843035211, -32.047523668271104, -32.771537900622924, -19.755256825236074, -33.71366150901586, -16.382280742855244, -32.08768704049414, -8.314965682429891, -11.191933385168658, -33.984771903316, -13.202171288719288, -31.80333637241173, -34.51335217930714, -37.82875531705287, -31.80527013710128, -25.639091800590446, -8.045412048659292, -24.22433268492975, -11.07924779095772, -38.02787520058044, -13.210001652686788, -24.581637091578944, -18.363699660699517, -8.655306047702279, -47.039001652177085, -9.333364509441957, -34.31797545347875, -18.955240346850886, -24.31918332711606, -17.604219503029068, -25.681424132311452, -15.75491736835471, -2.3008537068008463, -47.15001379144669, -23.539127393899644, -19.601323052209533, -44.62663456911298, -33.094348728321286, -13.944641318860644, -19.85522003778485, -35.993219976444756, -20.448349926497478, -16.720171418907753, -38.93895620114372, -38.6745823408171, -37.21531148126369, -32.75119039870013, -29.932059432050263, -33.03881162973601, -26.13589195820652, -37.162662501990646, -39.03607129664438, -4.017965255547293, -45.104883772417644, -27.190580820951478, -33.47876781199388, -35.8813604980555, -29.673344251404867, -27.123599157127437, -15.038045061607058, -54.67812637137822, -32.90021710001367, -49.29268076366403, -23.642871641700115, -55.114783680322304, -17.70679374764082, -21.158499775504634, -20.14918999910939, -17.310457833484726, -9.20796101342587, -37.3966965393584, -9.62977189905332, -9.30985275724572, -22.334709636512514, -28.495134757370334, -14.165296185642978, -1.5171867305385338, -17.879582316341068, -25.374372521029304, -16.964084536724535, -36.27960917792351, -39.52829283986963, -21.062555742646847, -40.1695006090543, -25.93449569631572, -8.002314708888669, -9.092423260476872, -29.75416373252273, -51.26526848067138, -50.227469340150094, -16.3057372314464], "policy_predator_policy_reward": [37.65011957547882, 30.30491740555611, 20.79577313985095, 33.487637814487755, 25.71074206611094, 21.213723426459477, 49.13148768201925, 4.829454017552954, 15.390691260363512, 11.635195843035211, 32.047523668271104, 32.771537900622924, 19.755256825236074, 33.71366150901586, 16.382280742855244, 32.08768704049414, 8.314965682429891, 11.191933385168658, 33.984771903316, 13.202171288719288, 31.80333637241173, 34.51335217930714, 37.82875531705287, 31.80527013710128, 25.639091800590446, 8.045412048659292, 24.22433268492975, 11.07924779095772, 38.02787520058044, 13.210001652686788, 24.581637091578944, 18.363699660699517, 8.655306047702279, 47.039001652177085, 9.333364509441957, 34.31797545347875, 18.955240346850886, 24.31918332711606, 17.604219503029068, 25.681424132311452, 15.75491736835471, 2.3008537068008463, 47.15001379144669, 23.539127393899644, 19.601323052209533, 44.62663456911298, 33.094348728321286, 13.944641318860644, 19.85522003778485, 35.993219976444756, 20.448349926497478, 16.720171418907753, 38.93895620114372, 38.6745823408171, 37.21531148126369, 32.75119039870013, 29.932059432050263, 33.03881162973601, 26.13589195820652, 37.162662501990646, 39.03607129664438, 4.017965255547293, 45.104883772417644, 27.190580820951478, 33.47876781199388, 35.8813604980555, 29.673344251404867, 27.123599157127437, 15.038045061607058, 54.67812637137822, 32.90021710001367, 49.29268076366403, 23.642871641700115, 55.114783680322304, 17.70679374764082, 21.158499775504634, 20.14918999910939, 17.310457833484726, 9.20796101342587, 37.3966965393584, 9.62977189905332, 9.30985275724572, 22.334709636512514, 28.495134757370334, 14.165296185642978, 1.5171867305385338, 17.879582316341068, 25.374372521029304, 16.964084536724535, 36.27960917792351, 39.52829283986963, 21.062555742646847, 40.1695006090543, 25.93449569631572, 8.002314708888669, 9.092423260476872, 29.75416373252273, 51.26526848067138, 50.227469340150094, 16.3057372314464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29397865412287244, "mean_inference_ms": 0.9442000685026385, "mean_action_processing_ms": 0.12604569448335112, "mean_env_wait_ms": 0.06636441292034563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.002038240432739258, "ViewRequirementAgentConnector_ms": 0.04943287372589111}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 665.3747476619479, "num_env_steps_trained_throughput_per_sec": 665.3747476619479, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 6139.986, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6139.924, "sample_time_ms": 716.625, "learn_time_ms": 5405.718, "learn_throughput": 739.957, "synch_weights_time_ms": 17.127}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 99, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-42", "timestamp": 1723390842, "time_this_iter_s": 6.016202449798584, "time_total_s": 586.4373824596405, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 586.4373824596405, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.9375, "ram_util_percent": 81.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3014701432238023, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4934162124991417, "policy_loss": -0.006098296829441097, "vf_loss": 1.499514507378141, "vf_explained_var": 0.9704826757311821, "kl": 0.01752317351477283, "entropy": 0.4560775007431706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4084954526275397, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.515848484573265, "policy_loss": -0.005110163861293889, "vf_loss": 1.520804561053713, "vf_explained_var": 0.9697625840082764, "kl": 0.01232736470009711, "entropy": 0.6680264003574848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.34, "episode_media": {}, "episodes_this_iter": 55, "episodes_timesteps_total": 6834, "policy_reward_min": {"prey_policy": -55.41024640345166, "predator_policy": 1.5171867305385338}, "policy_reward_max": {"prey_policy": -1.5171867305385338, "predator_policy": 55.41024640345166}, "policy_reward_mean": {"prey_policy": -27.24773341524268, "predator_policy": 27.24773341524268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [77, 84, 50, 72, 91, 81, 31, 80, 73, 51, 69, 76, 45, 53, 84, 91, 90, 75, 94, 71, 49, 48, 47, 53, 54, 41, 46, 47, 64, 33, 3, 69, 53, 65, 76, 80, 76, 78, 83, 12, 45, 81, 78, 96, 80, 84, 90, 70, 60, 74, 82, 38, 87, 47, 28, 95, 71, 75, 76, 86, 69, 73, 92, 125, 76, 73, 31, 83, 59, 63, 43, 82, 88, 86, 85, 60, 82, 87, 73, 84, 42, 85, 28, 63, 59, 85, 88, 69, 60, 94, 72, 81, 107, 95, 30, 66, 50, 60, 92, 36], "policy_prey_policy_reward": [-32.75119039870013, -29.932059432050263, -33.03881162973601, -26.13589195820652, -37.162662501990646, -39.03607129664438, -4.017965255547293, -45.104883772417644, -27.190580820951478, -33.47876781199388, -35.8813604980555, -29.673344251404867, -27.123599157127437, -15.038045061607058, -54.67812637137822, -32.90021710001367, -49.29268076366403, -23.642871641700115, -55.114783680322304, -17.70679374764082, -21.158499775504634, -20.14918999910939, -17.310457833484726, -9.20796101342587, -37.3966965393584, -9.62977189905332, -9.30985275724572, -22.334709636512514, -28.495134757370334, -14.165296185642978, -1.5171867305385338, -17.879582316341068, -25.374372521029304, -16.964084536724535, -36.27960917792351, -39.52829283986963, -21.062555742646847, -40.1695006090543, -25.93449569631572, -8.002314708888669, -9.092423260476872, -29.75416373252273, -51.26526848067138, -50.227469340150094, -16.3057372314464, -50.91694717089682, -32.37720643652187, -39.104638170230466, -17.450806346671815, -11.545630499648777, -55.41024640345166, -12.23411142370569, -38.091696950212075, -30.13643715478526, -7.362671894711024, -45.81194509063069, -11.701005371603694, -36.94029352529862, -38.921635992414366, -21.89900084601003, -22.562241043241922, -31.48723144433899, -30.684094807789023, -28.784812225280895, -23.49672283379784, -36.55097427795296, -8.10161123227779, -20.675996204548138, -29.347173610796595, -33.47477400549671, -10.597331071379333, -17.62983106756304, -19.244380206894956, -45.06612304734373, -42.403102940131916, -23.07086519890334, -35.60336420618655, -48.94752015144411, -22.454953976771954, -13.961886887728884, -21.620380217924144, -48.28303495278538, -23.01432123434707, -15.058789825283919, -21.18592389534839, -26.579202800661697, -37.383041498662266, -26.27727680243082, -25.19817418503345, -34.835689801874366, -36.08239418151662, -19.73379771761494, -26.56843225049795, -21.919347330302788, -5.25132816861833, -21.53830664023773, -16.490422547254383, -30.537812030494432, -32.18625938684376, -13.564807867415063], "policy_predator_policy_reward": [32.75119039870013, 29.932059432050263, 33.03881162973601, 26.13589195820652, 37.162662501990646, 39.03607129664438, 4.017965255547293, 45.104883772417644, 27.190580820951478, 33.47876781199388, 35.8813604980555, 29.673344251404867, 27.123599157127437, 15.038045061607058, 54.67812637137822, 32.90021710001367, 49.29268076366403, 23.642871641700115, 55.114783680322304, 17.70679374764082, 21.158499775504634, 20.14918999910939, 17.310457833484726, 9.20796101342587, 37.3966965393584, 9.62977189905332, 9.30985275724572, 22.334709636512514, 28.495134757370334, 14.165296185642978, 1.5171867305385338, 17.879582316341068, 25.374372521029304, 16.964084536724535, 36.27960917792351, 39.52829283986963, 21.062555742646847, 40.1695006090543, 25.93449569631572, 8.002314708888669, 9.092423260476872, 29.75416373252273, 51.26526848067138, 50.227469340150094, 16.3057372314464, 50.91694717089682, 32.37720643652187, 39.104638170230466, 17.450806346671815, 11.545630499648777, 55.41024640345166, 12.23411142370569, 38.091696950212075, 30.13643715478526, 7.362671894711024, 45.81194509063069, 11.701005371603694, 36.94029352529862, 38.921635992414366, 21.89900084601003, 22.562241043241922, 31.48723144433899, 30.684094807789023, 28.784812225280895, 23.49672283379784, 36.55097427795296, 8.10161123227779, 20.675996204548138, 29.347173610796595, 33.47477400549671, 10.597331071379333, 17.62983106756304, 19.244380206894956, 45.06612304734373, 42.403102940131916, 23.07086519890334, 35.60336420618655, 48.94752015144411, 22.454953976771954, 13.961886887728884, 21.620380217924144, 48.28303495278538, 23.01432123434707, 15.058789825283919, 21.18592389534839, 26.579202800661697, 37.383041498662266, 26.27727680243082, 25.19817418503345, 34.835689801874366, 36.08239418151662, 19.73379771761494, 26.56843225049795, 21.919347330302788, 5.25132816861833, 21.53830664023773, 16.490422547254383, 30.537812030494432, 32.18625938684376, 13.564807867415063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29390202538511356, "mean_inference_ms": 0.9437841836667922, "mean_action_processing_ms": 0.12606271353153567, "mean_env_wait_ms": 0.06644049325097255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00349581241607666, "StateBufferConnector_ms": 0.0020467042922973633, "ViewRequirementAgentConnector_ms": 0.050330400466918945}, "num_episodes": 55, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 679.8127862560699, "num_env_steps_trained_throughput_per_sec": 679.8127862560699, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 6026.444, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6026.408, "sample_time_ms": 675.677, "learn_time_ms": 5336.098, "learn_throughput": 749.611, "synch_weights_time_ms": 14.264}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 100, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-48", "timestamp": 1723390848, "time_this_iter_s": 5.88978123664856, "time_total_s": 592.3271636962891, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 592.3271636962891, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.588888888888885, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1896484840661286, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6522356974581878, "policy_loss": -0.005171971830228965, "vf_loss": 1.6574076644455393, "vf_explained_var": 0.9533481017996868, "kl": 0.008583359664734284, "entropy": 0.536098642864575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.332534665862719, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6794399190073213, "policy_loss": -0.005803736315768523, "vf_loss": 1.6850775795678297, "vf_explained_var": 0.95244648065418, "kl": 0.013286076678254162, "entropy": 0.6633736114328106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 71.47, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 7147, "policy_reward_min": {"prey_policy": -54.108353139837156, "predator_policy": 3.4680769655431227}, "policy_reward_max": {"prey_policy": -3.4680769655431227, "predator_policy": 54.108353139837156}, "policy_reward_mean": {"prey_policy": -26.740958654736236, "predator_policy": 26.740958654736236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [76, 86, 69, 73, 92, 125, 76, 73, 31, 83, 59, 63, 43, 82, 88, 86, 85, 60, 82, 87, 73, 84, 42, 85, 28, 63, 59, 85, 88, 69, 60, 94, 72, 81, 107, 95, 30, 66, 50, 60, 92, 36, 76, 70, 51, 46, 48, 59, 71, 67, 39, 91, 115, 58, 88, 84, 87, 76, 64, 80, 89, 70, 106, 41, 71, 51, 79, 75, 74, 110, 47, 83, 92, 83, 95, 78, 80, 50, 53, 60, 61, 53, 93, 92, 83, 85, 101, 50, 63, 49, 79, 70, 84, 72, 54, 44, 62, 51, 73, 33], "policy_prey_policy_reward": [-38.921635992414366, -21.89900084601003, -22.562241043241922, -31.48723144433899, -30.684094807789023, -28.784812225280895, -23.49672283379784, -36.55097427795296, -8.10161123227779, -20.675996204548138, -29.347173610796595, -33.47477400549671, -10.597331071379333, -17.62983106756304, -19.244380206894956, -45.06612304734373, -42.403102940131916, -23.07086519890334, -35.60336420618655, -48.94752015144411, -22.454953976771954, -13.961886887728884, -21.620380217924144, -48.28303495278538, -23.01432123434707, -15.058789825283919, -21.18592389534839, -26.579202800661697, -37.383041498662266, -26.27727680243082, -25.19817418503345, -34.835689801874366, -36.08239418151662, -19.73379771761494, -26.56843225049795, -21.919347330302788, -5.25132816861833, -21.53830664023773, -16.490422547254383, -30.537812030494432, -32.18625938684376, -13.564807867415063, -50.484896451741704, -32.5903872177398, -3.4680769655431227, -14.519608529823751, -19.53253009411442, -18.647173464637163, -42.42732577486381, -39.1000012438879, -10.96760469092986, -17.724926729740453, -43.48393856117657, -38.475647772587, -35.77197437871241, -34.17896122248773, -16.394264900498992, -24.562905841824293, -15.281691700086885, -30.347725638063995, -16.608003425014356, -22.416437855580682, -24.97111460672146, -11.291038159302204, -33.10749744630574, -20.012863892230243, -37.25086345013145, -45.010029283171555, -31.200258145572068, -50.90807671589021, -7.472385063795482, -24.45934772025276, -54.108353139837156, -37.791396962528395, -42.056337312750614, -36.800394935307224, -25.116265302561477, -9.051941742968584, -37.32093017048633, -12.157431682846125, -38.92594054545379, -23.92640926025988, -17.792708509448303, -34.80152436237907, -32.328703637345654, -21.67142255350864, -42.83828480181404, -15.351406323342937, -22.239146416442168, -21.275536965934954, -26.871574209256636, -15.877466088113012, -52.2602526906552, -38.587772825135175, -7.488232004826281, -24.3745395067293, -8.19893284224909, -15.277685722071658, -21.705616728235682, -16.9577306752674], "policy_predator_policy_reward": [38.921635992414366, 21.89900084601003, 22.562241043241922, 31.48723144433899, 30.684094807789023, 28.784812225280895, 23.49672283379784, 36.55097427795296, 8.10161123227779, 20.675996204548138, 29.347173610796595, 33.47477400549671, 10.597331071379333, 17.62983106756304, 19.244380206894956, 45.06612304734373, 42.403102940131916, 23.07086519890334, 35.60336420618655, 48.94752015144411, 22.454953976771954, 13.961886887728884, 21.620380217924144, 48.28303495278538, 23.01432123434707, 15.058789825283919, 21.18592389534839, 26.579202800661697, 37.383041498662266, 26.27727680243082, 25.19817418503345, 34.835689801874366, 36.08239418151662, 19.73379771761494, 26.56843225049795, 21.919347330302788, 5.25132816861833, 21.53830664023773, 16.490422547254383, 30.537812030494432, 32.18625938684376, 13.564807867415063, 50.484896451741704, 32.5903872177398, 3.4680769655431227, 14.519608529823751, 19.53253009411442, 18.647173464637163, 42.42732577486381, 39.1000012438879, 10.96760469092986, 17.724926729740453, 43.48393856117657, 38.475647772587, 35.77197437871241, 34.17896122248773, 16.394264900498992, 24.562905841824293, 15.281691700086885, 30.347725638063995, 16.608003425014356, 22.416437855580682, 24.97111460672146, 11.291038159302204, 33.10749744630574, 20.012863892230243, 37.25086345013145, 45.010029283171555, 31.200258145572068, 50.90807671589021, 7.472385063795482, 24.45934772025276, 54.108353139837156, 37.791396962528395, 42.056337312750614, 36.800394935307224, 25.116265302561477, 9.051941742968584, 37.32093017048633, 12.157431682846125, 38.92594054545379, 23.92640926025988, 17.792708509448303, 34.80152436237907, 32.328703637345654, 21.67142255350864, 42.83828480181404, 15.351406323342937, 22.239146416442168, 21.275536965934954, 26.871574209256636, 15.877466088113012, 52.2602526906552, 38.587772825135175, 7.488232004826281, 24.3745395067293, 8.19893284224909, 15.277685722071658, 21.705616728235682, 16.9577306752674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29420080844001645, "mean_inference_ms": 0.9440334192472587, "mean_action_processing_ms": 0.12595720776044125, "mean_env_wait_ms": 0.06643962352591605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554224967956543, "StateBufferConnector_ms": 0.0020040273666381836, "ViewRequirementAgentConnector_ms": 0.04744219779968262}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 704.217658337904, "num_env_steps_trained_throughput_per_sec": 704.217658337904, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 5964.807, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5964.773, "sample_time_ms": 647.019, "learn_time_ms": 5303.081, "learn_throughput": 754.278, "synch_weights_time_ms": 14.302}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "training_iteration": 101, "trial_id": "abfb9_00000", "date": "2024-08-11_11-40-54", "timestamp": 1723390854, "time_this_iter_s": 5.684838771820068, "time_total_s": 598.0120024681091, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 598.0120024681091, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 30.95, "ram_util_percent": 81.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3110551570852595, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3233663620737692, "policy_loss": -0.0027267268815194257, "vf_loss": 1.3260930913190048, "vf_explained_var": 0.9716506992777189, "kl": 0.006607073872989544, "entropy": 0.48939253858601056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.357574242477616, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3522606720527013, "policy_loss": -0.006286467717048557, "vf_loss": 1.358359150464336, "vf_explained_var": 0.9705723656962315, "kl": 0.015038548772584667, "entropy": 0.6246603516861796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.12, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6712, "policy_reward_min": {"prey_policy": -56.0599492925566, "predator_policy": 1.1028188778094412}, "policy_reward_max": {"prey_policy": -1.1028188778094412, "predator_policy": 56.0599492925566}, "policy_reward_mean": {"prey_policy": -25.001620473383174, "predator_policy": 25.001620473383174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [89, 70, 106, 41, 71, 51, 79, 75, 74, 110, 47, 83, 92, 83, 95, 78, 80, 50, 53, 60, 61, 53, 93, 92, 83, 85, 101, 50, 63, 49, 79, 70, 84, 72, 54, 44, 62, 51, 73, 33, 176, 78, 63, 78, 19, 92, 64, 7, 69, 88, 42, 78, 58, 73, 99, 44, 86, 84, 95, 84, 64, 54, 41, 87, 60, 61, 15, 71, 46, 80, 55, 27, 53, 62, 65, 16, 61, 52, 41, 74, 78, 52, 69, 76, 67, 47, 72, 46, 79, 51, 111, 72, 13, 61, 58, 50, 94, 62, 74, 79], "policy_prey_policy_reward": [-16.608003425014356, -22.416437855580682, -24.97111460672146, -11.291038159302204, -33.10749744630574, -20.012863892230243, -37.25086345013145, -45.010029283171555, -31.200258145572068, -50.90807671589021, -7.472385063795482, -24.45934772025276, -54.108353139837156, -37.791396962528395, -42.056337312750614, -36.800394935307224, -25.116265302561477, -9.051941742968584, -37.32093017048633, -12.157431682846125, -38.92594054545379, -23.92640926025988, -17.792708509448303, -34.80152436237907, -32.328703637345654, -21.67142255350864, -42.83828480181404, -15.351406323342937, -22.239146416442168, -21.275536965934954, -26.871574209256636, -15.877466088113012, -52.2602526906552, -38.587772825135175, -7.488232004826281, -24.3745395067293, -8.19893284224909, -15.277685722071658, -21.705616728235682, -16.9577306752674, -37.39351987929119, -20.436344678952423, -17.32173715558478, -21.26095497849444, -8.543397841812862, -20.960522410495688, -38.587331152131405, -4.103628389517235, -35.50477009657078, -22.757208363684235, -26.568995068017504, -31.271902748220064, -9.929550578678484, -32.238307089850146, -44.572435204124204, -22.079071464063077, -36.57624145908512, -39.65553180419673, -31.42445070696628, -44.11879182757432, -17.035077171628362, -11.170245782455318, -24.485641731153223, -29.487555433662184, -30.034223844645016, -15.568968943212248, -1.1028188778094412, -24.695500551320922, -8.802633099300886, -30.002781230208114, -5.320496391236278, -7.65577349016788, -30.374963889308116, -38.659366872766675, -33.57281286626816, -5.487624242548037, -19.130641757616466, -7.309169334159881, -4.0683520438347145, -19.414633884647465, -47.14713971076181, -5.851382673106092, -43.83748042293524, -21.660729859742233, -31.819914952934166, -17.065541343286924, -29.840194381754795, -28.478258469683894, -22.34152259945742, -27.92388382756972, -38.45912330506322, -18.130694292743954, -8.363144169694147, -17.809716979719145, -30.613166665885487, -15.468875353239214, -56.0599492925566, -19.2718680490314, -31.616802900636298, -1.8568300715318449], "policy_predator_policy_reward": [16.608003425014356, 22.416437855580682, 24.97111460672146, 11.291038159302204, 33.10749744630574, 20.012863892230243, 37.25086345013145, 45.010029283171555, 31.200258145572068, 50.90807671589021, 7.472385063795482, 24.45934772025276, 54.108353139837156, 37.791396962528395, 42.056337312750614, 36.800394935307224, 25.116265302561477, 9.051941742968584, 37.32093017048633, 12.157431682846125, 38.92594054545379, 23.92640926025988, 17.792708509448303, 34.80152436237907, 32.328703637345654, 21.67142255350864, 42.83828480181404, 15.351406323342937, 22.239146416442168, 21.275536965934954, 26.871574209256636, 15.877466088113012, 52.2602526906552, 38.587772825135175, 7.488232004826281, 24.3745395067293, 8.19893284224909, 15.277685722071658, 21.705616728235682, 16.9577306752674, 37.39351987929119, 20.436344678952423, 17.32173715558478, 21.26095497849444, 8.543397841812862, 20.960522410495688, 38.587331152131405, 4.103628389517235, 35.50477009657078, 22.757208363684235, 26.568995068017504, 31.271902748220064, 9.929550578678484, 32.238307089850146, 44.572435204124204, 22.079071464063077, 36.57624145908512, 39.65553180419673, 31.42445070696628, 44.11879182757432, 17.035077171628362, 11.170245782455318, 24.485641731153223, 29.487555433662184, 30.034223844645016, 15.568968943212248, 1.1028188778094412, 24.695500551320922, 8.802633099300886, 30.002781230208114, 5.320496391236278, 7.65577349016788, 30.374963889308116, 38.659366872766675, 33.57281286626816, 5.487624242548037, 19.130641757616466, 7.309169334159881, 4.0683520438347145, 19.414633884647465, 47.14713971076181, 5.851382673106092, 43.83748042293524, 21.660729859742233, 31.819914952934166, 17.065541343286924, 29.840194381754795, 28.478258469683894, 22.34152259945742, 27.92388382756972, 38.45912330506322, 18.130694292743954, 8.363144169694147, 17.809716979719145, 30.613166665885487, 15.468875353239214, 56.0599492925566, 19.2718680490314, 31.616802900636298, 1.8568300715318449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2937470966903475, "mean_inference_ms": 0.943051632202343, "mean_action_processing_ms": 0.12569246371458226, "mean_env_wait_ms": 0.06631556973649186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035386085510253906, "StateBufferConnector_ms": 0.0019752979278564453, "ViewRequirementAgentConnector_ms": 0.04557204246520996}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.2192524854188, "num_env_steps_trained_throughput_per_sec": 683.2192524854188, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 5966.795, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5966.761, "sample_time_ms": 645.554, "learn_time_ms": 5306.834, "learn_throughput": 753.745, "synch_weights_time_ms": 13.999}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 102, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-00", "timestamp": 1723390860, "time_this_iter_s": 5.860513925552368, "time_total_s": 603.8725163936615, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1328d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.8725163936615, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 27.1375, "ram_util_percent": 81.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.330872951447964, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6420894240650037, "policy_loss": -0.006905494519499674, "vf_loss": 1.6489949141318598, "vf_explained_var": 0.9643518906086683, "kl": 0.008893410416689784, "entropy": 0.521136412024498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3745773365100225, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.63734557852149, "policy_loss": -0.009231781100728162, "vf_loss": 1.6462623234217366, "vf_explained_var": 0.9644763691350817, "kl": 0.025203327104156306, "entropy": 0.614314764427642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.54, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 6854, "policy_reward_min": {"prey_policy": -57.15055205559191, "predator_policy": 1.1028188778094412}, "policy_reward_max": {"prey_policy": -1.1028188778094412, "predator_policy": 57.15055205559191}, "policy_reward_mean": {"prey_policy": -24.49001541338259, "predator_policy": 24.49001541338259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [86, 84, 95, 84, 64, 54, 41, 87, 60, 61, 15, 71, 46, 80, 55, 27, 53, 62, 65, 16, 61, 52, 41, 74, 78, 52, 69, 76, 67, 47, 72, 46, 79, 51, 111, 72, 13, 61, 58, 50, 94, 62, 74, 79, 67, 96, 74, 78, 100, 82, 93, 76, 24, 37, 98, 69, 113, 64, 99, 85, 88, 103, 98, 60, 62, 71, 78, 99, 39, 80, 71, 43, 138, 73, 95, 93, 41, 53, 58, 9, 72, 75, 141, 76, 23, 30, 75, 69, 98, 77, 67, 62, 64, 77, 72, 46, 103, 37, 66, 72], "policy_prey_policy_reward": [-36.57624145908512, -39.65553180419673, -31.42445070696628, -44.11879182757432, -17.035077171628362, -11.170245782455318, -24.485641731153223, -29.487555433662184, -30.034223844645016, -15.568968943212248, -1.1028188778094412, -24.695500551320922, -8.802633099300886, -30.002781230208114, -5.320496391236278, -7.65577349016788, -30.374963889308116, -38.659366872766675, -33.57281286626816, -5.487624242548037, -19.130641757616466, -7.309169334159881, -4.0683520438347145, -19.414633884647465, -47.14713971076181, -5.851382673106092, -43.83748042293524, -21.660729859742233, -31.819914952934166, -17.065541343286924, -29.840194381754795, -28.478258469683894, -22.34152259945742, -27.92388382756972, -38.45912330506322, -18.130694292743954, -8.363144169694147, -17.809716979719145, -30.613166665885487, -15.468875353239214, -56.0599492925566, -19.2718680490314, -31.616802900636298, -1.8568300715318449, -37.448779622361315, -38.17647432577447, -29.23754098990766, -30.17893434844385, -46.71750211888947, -32.117806179542924, -32.609327453858526, -20.427335006673058, -18.01626674944631, -13.217876050958541, -47.38210382005161, -45.17971034788151, -25.500898983890792, -35.46164960918057, -17.28579679569996, -28.792278738795964, -45.099030822610246, -37.99360893992557, -46.3334261353846, -28.294505072359012, -16.102450247606324, -26.23306632120038, -27.01571419599044, -27.989055112558574, -15.196739778173608, -42.865594422692126, -22.141534858532843, -22.184457208478904, -36.76613194215622, -8.987947593283272, -22.38586636651005, -11.162347277245946, -6.494959564669466, -21.59909924014171, -20.001545758992318, -3.2122444769476335, -15.43664415976834, -19.765194308182167, -57.15055205559191, -17.990407063397136, -16.067544236536392, -9.100016512572266, -23.218578419678654, -6.540812506524904, -38.779618265010036, -51.99329867078035, -17.1476766981413, -17.621877211085543, -10.45750311867462, -20.536514648676327, -21.02543087755463, -17.209885212714724, -22.397630512701923, -15.43669626422326, -16.244158479619404, -20.30137908290371], "policy_predator_policy_reward": [36.57624145908512, 39.65553180419673, 31.42445070696628, 44.11879182757432, 17.035077171628362, 11.170245782455318, 24.485641731153223, 29.487555433662184, 30.034223844645016, 15.568968943212248, 1.1028188778094412, 24.695500551320922, 8.802633099300886, 30.002781230208114, 5.320496391236278, 7.65577349016788, 30.374963889308116, 38.659366872766675, 33.57281286626816, 5.487624242548037, 19.130641757616466, 7.309169334159881, 4.0683520438347145, 19.414633884647465, 47.14713971076181, 5.851382673106092, 43.83748042293524, 21.660729859742233, 31.819914952934166, 17.065541343286924, 29.840194381754795, 28.478258469683894, 22.34152259945742, 27.92388382756972, 38.45912330506322, 18.130694292743954, 8.363144169694147, 17.809716979719145, 30.613166665885487, 15.468875353239214, 56.0599492925566, 19.2718680490314, 31.616802900636298, 1.8568300715318449, 37.448779622361315, 38.17647432577447, 29.23754098990766, 30.17893434844385, 46.71750211888947, 32.117806179542924, 32.609327453858526, 20.427335006673058, 18.01626674944631, 13.217876050958541, 47.38210382005161, 45.17971034788151, 25.500898983890792, 35.46164960918057, 17.28579679569996, 28.792278738795964, 45.099030822610246, 37.99360893992557, 46.3334261353846, 28.294505072359012, 16.102450247606324, 26.23306632120038, 27.01571419599044, 27.989055112558574, 15.196739778173608, 42.865594422692126, 22.141534858532843, 22.184457208478904, 36.76613194215622, 8.987947593283272, 22.38586636651005, 11.162347277245946, 6.494959564669466, 21.59909924014171, 20.001545758992318, 3.2122444769476335, 15.43664415976834, 19.765194308182167, 57.15055205559191, 17.990407063397136, 16.067544236536392, 9.100016512572266, 23.218578419678654, 6.540812506524904, 38.779618265010036, 51.99329867078035, 17.1476766981413, 17.621877211085543, 10.45750311867462, 20.536514648676327, 21.02543087755463, 17.209885212714724, 22.397630512701923, 15.43669626422326, 16.244158479619404, 20.30137908290371]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293319929771422, "mean_inference_ms": 0.941882336272526, "mean_action_processing_ms": 0.12552004588571491, "mean_env_wait_ms": 0.06623024202851253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002657294273376465, "StateBufferConnector_ms": 0.0018981695175170898, "ViewRequirementAgentConnector_ms": 0.04540252685546875}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 695.7111084065012, "num_env_steps_trained_throughput_per_sec": 695.7111084065012, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 5965.43, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5965.395, "sample_time_ms": 648.61, "learn_time_ms": 5302.303, "learn_throughput": 754.389, "synch_weights_time_ms": 14.06}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "training_iteration": 103, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-05", "timestamp": 1723390865, "time_this_iter_s": 5.755133867263794, "time_total_s": 609.6276502609253, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13a00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 609.6276502609253, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 29.012500000000003, "ram_util_percent": 81.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0631686532249054, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2629443684903283, "policy_loss": -0.0038822391417246156, "vf_loss": 1.266826602568229, "vf_explained_var": 0.9750568292414149, "kl": 0.007246851022709751, "entropy": 0.45620642189557353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.216344453766942, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2949150282268722, "policy_loss": -0.0072044149611125855, "vf_loss": 1.301857704296708, "vf_explained_var": 0.9749853570014239, "kl": 0.013959551947468443, "entropy": 0.5776555883387725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 71.17, "episode_media": {}, "episodes_this_iter": 57, "episodes_timesteps_total": 7117, "policy_reward_min": {"prey_policy": -59.88653112621444, "predator_policy": 1.5587961663428818}, "policy_reward_max": {"prey_policy": -1.5587961663428818, "predator_policy": 59.88653112621444}, "policy_reward_mean": {"prey_policy": -24.9065500009546, "predator_policy": 24.9065500009546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [64, 99, 85, 88, 103, 98, 60, 62, 71, 78, 99, 39, 80, 71, 43, 138, 73, 95, 93, 41, 53, 58, 9, 72, 75, 141, 76, 23, 30, 75, 69, 98, 77, 67, 62, 64, 77, 72, 46, 103, 37, 66, 72, 94, 73, 93, 54, 60, 68, 51, 43, 60, 88, 93, 57, 63, 37, 94, 98, 81, 68, 110, 71, 72, 65, 57, 69, 104, 80, 146, 62, 111, 80, 97, 53, 30, 57, 77, 61, 69, 69, 59, 65, 91, 64, 43, 35, 60, 6, 143, 65, 71, 2, 29, 106, 60, 82, 48, 49, 122], "policy_prey_policy_reward": [-35.46164960918057, -17.28579679569996, -28.792278738795964, -45.099030822610246, -37.99360893992557, -46.3334261353846, -28.294505072359012, -16.102450247606324, -26.23306632120038, -27.01571419599044, -27.989055112558574, -15.196739778173608, -42.865594422692126, -22.141534858532843, -22.184457208478904, -36.76613194215622, -8.987947593283272, -22.38586636651005, -11.162347277245946, -6.494959564669466, -21.59909924014171, -20.001545758992318, -3.2122444769476335, -15.43664415976834, -19.765194308182167, -57.15055205559191, -17.990407063397136, -16.067544236536392, -9.100016512572266, -23.218578419678654, -6.540812506524904, -38.779618265010036, -51.99329867078035, -17.1476766981413, -17.621877211085543, -10.45750311867462, -20.536514648676327, -21.02543087755463, -17.209885212714724, -22.397630512701923, -15.43669626422326, -16.244158479619404, -20.30137908290371, -37.57478775889751, -30.093476810619162, -42.902730355216505, -36.55397344393329, -35.55109648526706, -39.913135295087734, -30.84306444759228, -13.652570123330186, -38.504476492108, -42.562950222818124, -51.35764597291322, -20.137168831066013, -28.599608601214516, -10.844060208005992, -25.690956669962578, -14.459400086972156, -35.70188074949308, -31.36983095300404, -7.260897870698164, -40.745584892781, -18.10860789940285, -28.02596643909953, -18.432971528089855, -4.6805338339732305, -30.363686835485197, -45.24648407759897, -32.059708706018185, -30.752491864705718, -51.558455219315086, -18.88757742290841, -18.857239791623787, -12.41768153144646, -17.74702088014621, -9.349980265555322, -18.07029275460612, -17.982413191532462, -37.13235819348556, -41.723285612943975, -13.08769437334167, -18.816423629808796, -13.94671170615024, -14.252712918830664, -25.67102241298876, -4.763626223302046, -30.692685198756205, -3.5616709598300687, -59.88653112621444, -36.29860938337061, -12.996583486052756, -1.5587961663428818, -15.24182024005476, -18.866376096122664, -19.508044805788288, -50.21306162821425, -24.744240303120506, -12.6541022190256, -44.15776611575381], "policy_predator_policy_reward": [35.46164960918057, 17.28579679569996, 28.792278738795964, 45.099030822610246, 37.99360893992557, 46.3334261353846, 28.294505072359012, 16.102450247606324, 26.23306632120038, 27.01571419599044, 27.989055112558574, 15.196739778173608, 42.865594422692126, 22.141534858532843, 22.184457208478904, 36.76613194215622, 8.987947593283272, 22.38586636651005, 11.162347277245946, 6.494959564669466, 21.59909924014171, 20.001545758992318, 3.2122444769476335, 15.43664415976834, 19.765194308182167, 57.15055205559191, 17.990407063397136, 16.067544236536392, 9.100016512572266, 23.218578419678654, 6.540812506524904, 38.779618265010036, 51.99329867078035, 17.1476766981413, 17.621877211085543, 10.45750311867462, 20.536514648676327, 21.02543087755463, 17.209885212714724, 22.397630512701923, 15.43669626422326, 16.244158479619404, 20.30137908290371, 37.57478775889751, 30.093476810619162, 42.902730355216505, 36.55397344393329, 35.55109648526706, 39.913135295087734, 30.84306444759228, 13.652570123330186, 38.504476492108, 42.562950222818124, 51.35764597291322, 20.137168831066013, 28.599608601214516, 10.844060208005992, 25.690956669962578, 14.459400086972156, 35.70188074949308, 31.36983095300404, 7.260897870698164, 40.745584892781, 18.10860789940285, 28.02596643909953, 18.432971528089855, 4.6805338339732305, 30.363686835485197, 45.24648407759897, 32.059708706018185, 30.752491864705718, 51.558455219315086, 18.88757742290841, 18.857239791623787, 12.41768153144646, 17.74702088014621, 9.349980265555322, 18.07029275460612, 17.982413191532462, 37.13235819348556, 41.723285612943975, 13.08769437334167, 18.816423629808796, 13.94671170615024, 14.252712918830664, 25.67102241298876, 4.763626223302046, 30.692685198756205, 3.5616709598300687, 59.88653112621444, 36.29860938337061, 12.996583486052756, 1.5587961663428818, 15.24182024005476, 18.866376096122664, 19.508044805788288, 50.21306162821425, 24.744240303120506, 12.6541022190256, 44.15776611575381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29339907829495304, "mean_inference_ms": 0.9411402592120937, "mean_action_processing_ms": 0.12557084389802578, "mean_env_wait_ms": 0.06618466599887884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027434825897216797, "StateBufferConnector_ms": 0.00211334228515625, "ViewRequirementAgentConnector_ms": 0.04824948310852051}, "num_episodes": 57, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.1361229561954, "num_env_steps_trained_throughput_per_sec": 685.1361229561954, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 5939.075, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5939.041, "sample_time_ms": 648.765, "learn_time_ms": 5275.879, "learn_throughput": 758.167, "synch_weights_time_ms": 13.982}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 104, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-11", "timestamp": 1723390871, "time_this_iter_s": 5.8438310623168945, "time_total_s": 615.4714813232422, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cd820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 615.4714813232422, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 29.099999999999998, "ram_util_percent": 81.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2281136609613896, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5328652097533146, "policy_loss": -0.0070807365935858495, "vf_loss": 1.5399459439019363, "vf_explained_var": 0.9609130437175433, "kl": 0.009111733535384333, "entropy": 0.4345490720743934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4298637339224416, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5166649167736372, "policy_loss": -0.0014267004162926847, "vf_loss": 1.5179717659950256, "vf_explained_var": 0.9622674719740947, "kl": 0.006392067890941178, "entropy": 0.5926175094520052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 70.65, "episode_media": {}, "episodes_this_iter": 55, "episodes_timesteps_total": 7065, "policy_reward_min": {"prey_policy": -59.88653112621444, "predator_policy": 1.5587961663428818}, "policy_reward_max": {"prey_policy": -1.5587961663428818, "predator_policy": 59.88653112621444}, "policy_reward_mean": {"prey_policy": -26.521938736270123, "predator_policy": 26.521938736270123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [63, 37, 94, 98, 81, 68, 110, 71, 72, 65, 57, 69, 104, 80, 146, 62, 111, 80, 97, 53, 30, 57, 77, 61, 69, 69, 59, 65, 91, 64, 43, 35, 60, 6, 143, 65, 71, 2, 29, 106, 60, 82, 48, 49, 122, 84, 58, 87, 84, 82, 91, 56, 106, 77, 69, 77, 82, 55, 64, 77, 53, 78, 52, 83, 80, 87, 84, 66, 49, 60, 66, 36, 50, 70, 81, 82, 76, 76, 69, 78, 83, 77, 71, 87, 57, 33, 81, 74, 46, 41, 69, 46, 56, 92, 47, 66, 120, 97, 41, 75], "policy_prey_policy_reward": [-28.599608601214516, -10.844060208005992, -25.690956669962578, -14.459400086972156, -35.70188074949308, -31.36983095300404, -7.260897870698164, -40.745584892781, -18.10860789940285, -28.02596643909953, -18.432971528089855, -4.6805338339732305, -30.363686835485197, -45.24648407759897, -32.059708706018185, -30.752491864705718, -51.558455219315086, -18.88757742290841, -18.857239791623787, -12.41768153144646, -17.74702088014621, -9.349980265555322, -18.07029275460612, -17.982413191532462, -37.13235819348556, -41.723285612943975, -13.08769437334167, -18.816423629808796, -13.94671170615024, -14.252712918830664, -25.67102241298876, -4.763626223302046, -30.692685198756205, -3.5616709598300687, -59.88653112621444, -36.29860938337061, -12.996583486052756, -1.5587961663428818, -15.24182024005476, -18.866376096122664, -19.508044805788288, -50.21306162821425, -24.744240303120506, -12.6541022190256, -44.15776611575381, -48.61377829386997, -40.793950844930436, -22.800624166181866, -23.637739258054165, -28.8782133272459, -18.483946728494967, -8.69318565893797, -31.866167380696943, -34.59582877553703, -28.900862142387812, -33.60624712666115, -22.577692563209826, -28.60332637087587, -31.003404017425, -29.65732955231177, -9.078504900270328, -33.51367507947897, -27.56562567335513, -25.91702739118879, -31.585162677399637, -42.83432039956486, -46.46706907893574, -29.110859218606432, -36.39793454633684, -16.332611549041566, -34.06925380455834, -24.50788158265448, -6.19695703060413, -19.51983859602855, -40.26104647124125, -36.13794537186679, -27.481735027878393, -18.82760064292509, -18.484358891680074, -29.622009311549224, -26.735600935102116, -43.85820862965814, -47.082053718906614, -46.781160583561494, -20.739712500873722, -7.837674956061048, -37.68355754861641, -21.41813681356991, -31.32765053790217, -26.8275492711916, -38.179784866523455, -16.026640673871654, -31.69570220680868, -44.118974090703986, -31.655099783976787, -40.439863481981874, -6.3862833580869065, -36.48244448255347, -9.000644120218723, -34.305962541720966], "policy_predator_policy_reward": [28.599608601214516, 10.844060208005992, 25.690956669962578, 14.459400086972156, 35.70188074949308, 31.36983095300404, 7.260897870698164, 40.745584892781, 18.10860789940285, 28.02596643909953, 18.432971528089855, 4.6805338339732305, 30.363686835485197, 45.24648407759897, 32.059708706018185, 30.752491864705718, 51.558455219315086, 18.88757742290841, 18.857239791623787, 12.41768153144646, 17.74702088014621, 9.349980265555322, 18.07029275460612, 17.982413191532462, 37.13235819348556, 41.723285612943975, 13.08769437334167, 18.816423629808796, 13.94671170615024, 14.252712918830664, 25.67102241298876, 4.763626223302046, 30.692685198756205, 3.5616709598300687, 59.88653112621444, 36.29860938337061, 12.996583486052756, 1.5587961663428818, 15.24182024005476, 18.866376096122664, 19.508044805788288, 50.21306162821425, 24.744240303120506, 12.6541022190256, 44.15776611575381, 48.61377829386997, 40.793950844930436, 22.800624166181866, 23.637739258054165, 28.8782133272459, 18.483946728494967, 8.69318565893797, 31.866167380696943, 34.59582877553703, 28.900862142387812, 33.60624712666115, 22.577692563209826, 28.60332637087587, 31.003404017425, 29.65732955231177, 9.078504900270328, 33.51367507947897, 27.56562567335513, 25.91702739118879, 31.585162677399637, 42.83432039956486, 46.46706907893574, 29.110859218606432, 36.39793454633684, 16.332611549041566, 34.06925380455834, 24.50788158265448, 6.19695703060413, 19.51983859602855, 40.26104647124125, 36.13794537186679, 27.481735027878393, 18.82760064292509, 18.484358891680074, 29.622009311549224, 26.735600935102116, 43.85820862965814, 47.082053718906614, 46.781160583561494, 20.739712500873722, 7.837674956061048, 37.68355754861641, 21.41813681356991, 31.32765053790217, 26.8275492711916, 38.179784866523455, 16.026640673871654, 31.69570220680868, 44.118974090703986, 31.655099783976787, 40.439863481981874, 6.3862833580869065, 36.48244448255347, 9.000644120218723, 34.305962541720966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29331075134874335, "mean_inference_ms": 0.9401857318919169, "mean_action_processing_ms": 0.12542793577993092, "mean_env_wait_ms": 0.06610685678705629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028077363967895508, "StateBufferConnector_ms": 0.0020570755004882812, "ViewRequirementAgentConnector_ms": 0.046270132064819336}, "num_episodes": 55, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.1048764239594, "num_env_steps_trained_throughput_per_sec": 699.1048764239594, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 5913.995, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5913.96, "sample_time_ms": 646.513, "learn_time_ms": 5253.137, "learn_throughput": 761.45, "synch_weights_time_ms": 13.896}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 105, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-17", "timestamp": 1723390877, "time_this_iter_s": 5.72720193862915, "time_total_s": 621.1986832618713, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13289d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 621.1986832618713, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 27.744444444444444, "ram_util_percent": 81.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1042043230185907, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4579904328255604, "policy_loss": -0.0022355180951611447, "vf_loss": 1.4602259501193962, "vf_explained_var": 0.9717327970390518, "kl": 0.004995132686648062, "entropy": 0.4251578401774168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3440323736518622, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4743194552138448, "policy_loss": -0.004196308348279369, "vf_loss": 1.478359760592381, "vf_explained_var": 0.9718404966096084, "kl": 0.008320050232593475, "entropy": 0.5817766773204008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.11, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6611, "policy_reward_min": {"prey_policy": -59.0138671218369, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 59.0138671218369}, "policy_reward_mean": {"prey_policy": -27.42621147861149, "predator_policy": 27.42621147861149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [87, 84, 66, 49, 60, 66, 36, 50, 70, 81, 82, 76, 76, 69, 78, 83, 77, 71, 87, 57, 33, 81, 74, 46, 41, 69, 46, 56, 92, 47, 66, 120, 97, 41, 75, 82, 28, 59, 106, 32, 84, 65, 30, 66, 67, 85, 99, 33, 90, 93, 70, 64, 89, 55, 52, 63, 60, 77, 81, 70, 56, 43, 99, 1, 59, 100, 13, 80, 94, 74, 69, 33, 26, 5, 89, 57, 12, 89, 101, 92, 66, 54, 78, 64, 60, 44, 57, 75, 27, 73, 73, 67, 78, 65, 70, 58, 85, 78, 90, 68], "policy_prey_policy_reward": [-42.83432039956486, -46.46706907893574, -29.110859218606432, -36.39793454633684, -16.332611549041566, -34.06925380455834, -24.50788158265448, -6.19695703060413, -19.51983859602855, -40.26104647124125, -36.13794537186679, -27.481735027878393, -18.82760064292509, -18.484358891680074, -29.622009311549224, -26.735600935102116, -43.85820862965814, -47.082053718906614, -46.781160583561494, -20.739712500873722, -7.837674956061048, -37.68355754861641, -21.41813681356991, -31.32765053790217, -26.8275492711916, -38.179784866523455, -16.026640673871654, -31.69570220680868, -44.118974090703986, -31.655099783976787, -40.439863481981874, -6.3862833580869065, -36.48244448255347, -9.000644120218723, -34.305962541720966, -43.337415121989785, -7.602708076471884, -14.025104593122776, -12.484449059865428, -17.817986337863317, -45.40497148782061, -32.88890291485162, -12.468867812530359, -50.134707286671976, -18.78619798709865, -39.88727480432296, -29.013132266332615, -17.843347116197616, -46.50584709100337, -38.70836391379285, -43.59930576674587, -11.655550164162774, -34.706265212461695, -15.343390916068348, -30.271948468543467, -32.993079669836895, -44.166759076606915, -44.43777607859634, -34.80734697101167, -32.7141966685156, -23.972496091113424, -17.423532601647395, -43.44657257480103, 0.0, -14.676037839804575, -59.0138671218369, -7.011808734456831, -37.504789631086624, -27.50823768617463, -12.880167218037808, -30.25935114915795, -26.918883092516285, -7.38025432438691, -0.6333118835689825, -45.351356460458334, -32.59252702229596, -6.683140364528929, -13.660093181351112, -2.945220443357285, -28.28161875581175, -41.87712619447127, -33.99911779925843, -39.70077671308452, -23.5865022233596, -36.04658193800059, -21.88955851051754, -14.528498031206428, -28.282948781078396, -7.993154484578605, -10.967583959892117, -15.114000195655954, -32.71056131608433, -22.47310992587298, -35.12636532549358, -25.65125626875843, -32.711753092030285, -19.00092370916948, -20.777070639050756, -45.87526541841095, -19.726705670935072], "policy_predator_policy_reward": [42.83432039956486, 46.46706907893574, 29.110859218606432, 36.39793454633684, 16.332611549041566, 34.06925380455834, 24.50788158265448, 6.19695703060413, 19.51983859602855, 40.26104647124125, 36.13794537186679, 27.481735027878393, 18.82760064292509, 18.484358891680074, 29.622009311549224, 26.735600935102116, 43.85820862965814, 47.082053718906614, 46.781160583561494, 20.739712500873722, 7.837674956061048, 37.68355754861641, 21.41813681356991, 31.32765053790217, 26.8275492711916, 38.179784866523455, 16.026640673871654, 31.69570220680868, 44.118974090703986, 31.655099783976787, 40.439863481981874, 6.3862833580869065, 36.48244448255347, 9.000644120218723, 34.305962541720966, 43.337415121989785, 7.602708076471884, 14.025104593122776, 12.484449059865428, 17.817986337863317, 45.40497148782061, 32.88890291485162, 12.468867812530359, 50.134707286671976, 18.78619798709865, 39.88727480432296, 29.013132266332615, 17.843347116197616, 46.50584709100337, 38.70836391379285, 43.59930576674587, 11.655550164162774, 34.706265212461695, 15.343390916068348, 30.271948468543467, 32.993079669836895, 44.166759076606915, 44.43777607859634, 34.80734697101167, 32.7141966685156, 23.972496091113424, 17.423532601647395, 43.44657257480103, 0.0, 14.676037839804575, 59.0138671218369, 7.011808734456831, 37.504789631086624, 27.50823768617463, 12.880167218037808, 30.25935114915795, 26.918883092516285, 7.38025432438691, 0.6333118835689825, 45.351356460458334, 32.59252702229596, 6.683140364528929, 13.660093181351112, 2.945220443357285, 28.28161875581175, 41.87712619447127, 33.99911779925843, 39.70077671308452, 23.5865022233596, 36.04658193800059, 21.88955851051754, 14.528498031206428, 28.282948781078396, 7.993154484578605, 10.967583959892117, 15.114000195655954, 32.71056131608433, 22.47310992587298, 35.12636532549358, 25.65125626875843, 32.711753092030285, 19.00092370916948, 20.777070639050756, 45.87526541841095, 19.726705670935072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29279002836020884, "mean_inference_ms": 0.9400763160059158, "mean_action_processing_ms": 0.12532721771818983, "mean_env_wait_ms": 0.06602081119211155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029741525650024414, "StateBufferConnector_ms": 0.002032756805419922, "ViewRequirementAgentConnector_ms": 0.04912889003753662}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 674.7605248336185, "num_env_steps_trained_throughput_per_sec": 674.7605248336185, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 5896.908, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5896.874, "sample_time_ms": 647.03, "learn_time_ms": 5236.109, "learn_throughput": 763.926, "synch_weights_time_ms": 13.323}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 106, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-23", "timestamp": 1723390883, "time_this_iter_s": 5.93535304069519, "time_total_s": 627.1340363025665, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cda60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 627.1340363025665, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 28.887500000000003, "ram_util_percent": 81.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.310999819760521, "cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5110711441142484, "policy_loss": -0.0034475985072883, "vf_loss": 1.51451874114573, "vf_explained_var": 0.9693683090309302, "kl": 0.0056423166542693875, "entropy": 0.39627988301217554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5073877083758513, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5339813372120261, "policy_loss": -0.005108115671221943, "vf_loss": 1.5389129921173057, "vf_explained_var": 0.9686749166498582, "kl": 0.009411364015447333, "entropy": 0.5718261608543496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 60.98, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6098, "policy_reward_min": {"prey_policy": -59.0138671218369, "predator_policy": 0.6333118835689825}, "policy_reward_max": {"prey_policy": -0.6333118835689825, "predator_policy": 59.0138671218369}, "policy_reward_mean": {"prey_policy": -23.06276544386503, "predator_policy": 23.06276544386503}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [100, 13, 80, 94, 74, 69, 33, 26, 5, 89, 57, 12, 89, 101, 92, 66, 54, 78, 64, 60, 44, 57, 75, 27, 73, 73, 67, 78, 65, 70, 58, 85, 78, 90, 68, 72, 60, 32, 86, 41, 64, 39, 55, 38, 61, 87, 59, 74, 63, 25, 41, 72, 62, 60, 109, 55, 43, 58, 73, 62, 24, 97, 60, 54, 24, 69, 74, 72, 65, 74, 30, 52, 46, 51, 59, 124, 84, 83, 60, 70, 93, 70, 45, 21, 83, 78, 41, 61, 62, 57, 15, 78, 88, 38, 12, 30, 33, 55, 34, 77], "policy_prey_policy_reward": [-59.0138671218369, -7.011808734456831, -37.504789631086624, -27.50823768617463, -12.880167218037808, -30.25935114915795, -26.918883092516285, -7.38025432438691, -0.6333118835689825, -45.351356460458334, -32.59252702229596, -6.683140364528929, -13.660093181351112, -2.945220443357285, -28.28161875581175, -41.87712619447127, -33.99911779925843, -39.70077671308452, -23.5865022233596, -36.04658193800059, -21.88955851051754, -14.528498031206428, -28.282948781078396, -7.993154484578605, -10.967583959892117, -15.114000195655954, -32.71056131608433, -22.47310992587298, -35.12636532549358, -25.65125626875843, -32.711753092030285, -19.00092370916948, -20.777070639050756, -45.87526541841095, -19.726705670935072, -29.980579757623442, -18.37803302767499, -11.752731188304827, -33.56847033260661, -5.133572760619271, -14.537939512391045, -13.4311950671479, -18.0844156007818, -13.11509982204265, -14.359949527379172, -14.10231193410737, -25.56850964566742, -24.749576340528172, -24.460631016749527, -6.404650207242072, -7.562105546774026, -17.791240217842446, -39.05276599682741, -44.08726349503746, -32.48796897319058, -29.481800563671044, -17.618520199420377, -32.23578020843732, -15.977213403869458, -33.184435009967856, -4.023460779273613, -21.21798216082102, -32.58985591898501, -9.168959796709258, -3.308791150897969, -31.309935271073844, -18.997086464465884, -47.84384721397986, -40.80797710496269, -30.270977866930437, -0.8217101999749358, -14.248650396919796, -16.77741170269565, -29.048863959468143, -7.849976278641799, -29.054419856818722, -20.79868534157436, -28.35892807065232, -33.96177623511082, -28.946012705895015, -35.09721323701332, -20.456913459083726, -17.718388825773438, -8.847479934249625, -34.67643527938536, -28.381710397611382, -11.517384305268761, -29.96157815032759, -39.341693061833325, -37.75489527969906, -1.1082542305107435, -49.13050202684672, -32.54311159846871, -6.315793205189548, -0.9376500618430765, -5.672016909861892, -14.990559394413388, -28.438961973805554, -20.567704172477097, -29.64274378514955], "policy_predator_policy_reward": [59.0138671218369, 7.011808734456831, 37.504789631086624, 27.50823768617463, 12.880167218037808, 30.25935114915795, 26.918883092516285, 7.38025432438691, 0.6333118835689825, 45.351356460458334, 32.59252702229596, 6.683140364528929, 13.660093181351112, 2.945220443357285, 28.28161875581175, 41.87712619447127, 33.99911779925843, 39.70077671308452, 23.5865022233596, 36.04658193800059, 21.88955851051754, 14.528498031206428, 28.282948781078396, 7.993154484578605, 10.967583959892117, 15.114000195655954, 32.71056131608433, 22.47310992587298, 35.12636532549358, 25.65125626875843, 32.711753092030285, 19.00092370916948, 20.777070639050756, 45.87526541841095, 19.726705670935072, 29.980579757623442, 18.37803302767499, 11.752731188304827, 33.56847033260661, 5.133572760619271, 14.537939512391045, 13.4311950671479, 18.0844156007818, 13.11509982204265, 14.359949527379172, 14.10231193410737, 25.56850964566742, 24.749576340528172, 24.460631016749527, 6.404650207242072, 7.562105546774026, 17.791240217842446, 39.05276599682741, 44.08726349503746, 32.48796897319058, 29.481800563671044, 17.618520199420377, 32.23578020843732, 15.977213403869458, 33.184435009967856, 4.023460779273613, 21.21798216082102, 32.58985591898501, 9.168959796709258, 3.308791150897969, 31.309935271073844, 18.997086464465884, 47.84384721397986, 40.80797710496269, 30.270977866930437, 0.8217101999749358, 14.248650396919796, 16.77741170269565, 29.048863959468143, 7.849976278641799, 29.054419856818722, 20.79868534157436, 28.35892807065232, 33.96177623511082, 28.946012705895015, 35.09721323701332, 20.456913459083726, 17.718388825773438, 8.847479934249625, 34.67643527938536, 28.381710397611382, 11.517384305268761, 29.96157815032759, 39.341693061833325, 37.75489527969906, 1.1082542305107435, 49.13050202684672, 32.54311159846871, 6.315793205189548, 0.9376500618430765, 5.672016909861892, 14.990559394413388, 28.438961973805554, 20.567704172477097, 29.64274378514955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29383405770112314, "mean_inference_ms": 0.9419150565331412, "mean_action_processing_ms": 0.1256957767469718, "mean_env_wait_ms": 0.06622316801805965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033518075942993164, "StateBufferConnector_ms": 0.0022928714752197266, "ViewRequirementAgentConnector_ms": 0.06120562553405762}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 635.2584378439976, "num_env_steps_trained_throughput_per_sec": 635.2584378439976, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 5899.255, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5899.221, "sample_time_ms": 666.986, "learn_time_ms": 5218.474, "learn_throughput": 766.508, "synch_weights_time_ms": 13.348}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "training_iteration": 107, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-29", "timestamp": 1723390889, "time_this_iter_s": 6.301986217498779, "time_total_s": 633.4360225200653, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13280d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 633.4360225200653, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 33.52222222222222, "ram_util_percent": 81.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9748795174683136, "cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3942376233016451, "policy_loss": -0.0045752072391527085, "vf_loss": 1.3988128235563635, "vf_explained_var": 0.9724425967161854, "kl": 0.0070809354098678706, "entropy": 0.3624972566651801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.125094680239757, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3680991354087988, "policy_loss": -0.006894109814553909, "vf_loss": 1.3748295111581683, "vf_explained_var": 0.9729857929671805, "kl": 0.00873270576634327, "entropy": 0.5926167419801156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.1, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6310, "policy_reward_min": {"prey_policy": -55.4885616226317, "predator_policy": 0.8217101999749358}, "policy_reward_max": {"prey_policy": -0.8217101999749358, "predator_policy": 55.4885616226317}, "policy_reward_mean": {"prey_policy": -25.36408862187037, "predator_policy": 25.36408862187037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [60, 54, 24, 69, 74, 72, 65, 74, 30, 52, 46, 51, 59, 124, 84, 83, 60, 70, 93, 70, 45, 21, 83, 78, 41, 61, 62, 57, 15, 78, 88, 38, 12, 30, 33, 55, 34, 77, 89, 81, 34, 76, 71, 67, 63, 78, 58, 24, 31, 72, 79, 55, 55, 69, 81, 40, 91, 84, 75, 42, 61, 90, 81, 71, 89, 39, 69, 172, 97, 84, 69, 72, 68, 94, 89, 50, 86, 83, 47, 86, 28, 75, 74, 91, 67, 63, 43, 50, 61, 49, 35, 65, 19, 62, 76, 20, 59, 42, 22, 75], "policy_prey_policy_reward": [-32.58985591898501, -9.168959796709258, -3.308791150897969, -31.309935271073844, -18.997086464465884, -47.84384721397986, -40.80797710496269, -30.270977866930437, -0.8217101999749358, -14.248650396919796, -16.77741170269565, -29.048863959468143, -7.849976278641799, -29.054419856818722, -20.79868534157436, -28.35892807065232, -33.96177623511082, -28.946012705895015, -35.09721323701332, -20.456913459083726, -17.718388825773438, -8.847479934249625, -34.67643527938536, -28.381710397611382, -11.517384305268761, -29.96157815032759, -39.341693061833325, -37.75489527969906, -1.1082542305107435, -49.13050202684672, -32.54311159846871, -6.315793205189548, -0.9376500618430765, -5.672016909861892, -14.990559394413388, -28.438961973805554, -20.567704172477097, -29.64274378514955, -39.09551612783095, -36.64472625829999, -21.914657052137173, -34.78765340604346, -14.109736975204825, -16.882755556764895, -33.29000426988265, -44.78243668584193, -15.353502065771373, -4.127461471178694, -14.866853907200955, -29.301002842935763, -50.78474545267351, -23.49484063047271, -4.942292182910175, -6.525719575951527, -29.935677045861656, -31.91362931150876, -26.6608414621549, -38.54548729215561, -43.36911323730929, -15.948427517916711, -16.86862105326284, -55.4885616226317, -24.4150445238437, -36.27508042551295, -38.07294062679623, -7.0793163909101935, -37.74640951279118, -25.161361078306594, -35.45993283616535, -17.959198774612616, -35.94160643937921, -17.90170460398829, -34.69508330071219, -44.72303923683452, -38.493599361215544, -2.7976933111708515, -51.376049664240156, -39.58331641251868, -14.691527058444725, -38.35001356794926, -10.960923676481926, -24.964504471896035, -39.19442244409582, -53.9558242365532, -30.572764904643044, -6.947578642158334, -17.514808663520895, -16.75872727114063, -20.93678939365405, -21.99793219290797, -5.3460230293182756, -31.09745229692277, -3.2404860150444046, -45.986099638379955, -49.726994285323975, -10.002618054531169, -9.289105077503724, -24.01235455471477, -13.081527323169139, -33.19989106121362], "policy_predator_policy_reward": [32.58985591898501, 9.168959796709258, 3.308791150897969, 31.309935271073844, 18.997086464465884, 47.84384721397986, 40.80797710496269, 30.270977866930437, 0.8217101999749358, 14.248650396919796, 16.77741170269565, 29.048863959468143, 7.849976278641799, 29.054419856818722, 20.79868534157436, 28.35892807065232, 33.96177623511082, 28.946012705895015, 35.09721323701332, 20.456913459083726, 17.718388825773438, 8.847479934249625, 34.67643527938536, 28.381710397611382, 11.517384305268761, 29.96157815032759, 39.341693061833325, 37.75489527969906, 1.1082542305107435, 49.13050202684672, 32.54311159846871, 6.315793205189548, 0.9376500618430765, 5.672016909861892, 14.990559394413388, 28.438961973805554, 20.567704172477097, 29.64274378514955, 39.09551612783095, 36.64472625829999, 21.914657052137173, 34.78765340604346, 14.109736975204825, 16.882755556764895, 33.29000426988265, 44.78243668584193, 15.353502065771373, 4.127461471178694, 14.866853907200955, 29.301002842935763, 50.78474545267351, 23.49484063047271, 4.942292182910175, 6.525719575951527, 29.935677045861656, 31.91362931150876, 26.6608414621549, 38.54548729215561, 43.36911323730929, 15.948427517916711, 16.86862105326284, 55.4885616226317, 24.4150445238437, 36.27508042551295, 38.07294062679623, 7.0793163909101935, 37.74640951279118, 25.161361078306594, 35.45993283616535, 17.959198774612616, 35.94160643937921, 17.90170460398829, 34.69508330071219, 44.72303923683452, 38.493599361215544, 2.7976933111708515, 51.376049664240156, 39.58331641251868, 14.691527058444725, 38.35001356794926, 10.960923676481926, 24.964504471896035, 39.19442244409582, 53.9558242365532, 30.572764904643044, 6.947578642158334, 17.514808663520895, 16.75872727114063, 20.93678939365405, 21.99793219290797, 5.3460230293182756, 31.09745229692277, 3.2404860150444046, 45.986099638379955, 49.726994285323975, 10.002618054531169, 9.289105077503724, 24.01235455471477, 13.081527323169139, 33.19989106121362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945436692304803, "mean_inference_ms": 0.9433086907201019, "mean_action_processing_ms": 0.1259481740298639, "mean_env_wait_ms": 0.06639486670937025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032875537872314453, "StateBufferConnector_ms": 0.0022428035736083984, "ViewRequirementAgentConnector_ms": 0.057149291038513184}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 652.4316776486909, "num_env_steps_trained_throughput_per_sec": 652.4316776486909, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 5909.536, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5909.499, "sample_time_ms": 674.206, "learn_time_ms": 5221.166, "learn_throughput": 766.112, "synch_weights_time_ms": 13.746}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 108, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-35", "timestamp": 1723390895, "time_this_iter_s": 6.135972738265991, "time_total_s": 639.5719952583313, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13289d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 639.5719952583313, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 34.266666666666666, "ram_util_percent": 81.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.925936792232096, "cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1224317213209967, "policy_loss": -0.002693951508263126, "vf_loss": 1.125125668508311, "vf_explained_var": 0.9712332105264068, "kl": 0.005252264055122554, "entropy": 0.4006959571192662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.962294241103033, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1237861320997278, "policy_loss": -0.006781305094045819, "vf_loss": 1.1303941806778313, "vf_explained_var": 0.9706115406006575, "kl": 0.009240453599137884, "entropy": 0.6020722307264805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.61, "episode_media": {}, "episodes_this_iter": 67, "episodes_timesteps_total": 6161, "policy_reward_min": {"prey_policy": -53.9558242365532, "predator_policy": 1.1199387052267267}, "policy_reward_max": {"prey_policy": -1.1199387052267267, "predator_policy": 53.9558242365532}, "policy_reward_mean": {"prey_policy": -23.137734880729855, "predator_policy": 23.137734880729855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [172, 97, 84, 69, 72, 68, 94, 89, 50, 86, 83, 47, 86, 28, 75, 74, 91, 67, 63, 43, 50, 61, 49, 35, 65, 19, 62, 76, 20, 59, 42, 22, 75, 50, 70, 79, 39, 73, 67, 84, 50, 38, 43, 40, 86, 74, 62, 46, 82, 59, 19, 85, 65, 33, 43, 32, 64, 51, 21, 74, 76, 68, 86, 48, 70, 120, 68, 71, 41, 74, 47, 46, 67, 57, 37, 45, 48, 51, 60, 31, 58, 70, 77, 66, 67, 89, 80, 74, 52, 18, 39, 74, 89, 65, 54, 41, 61, 75, 84, 15], "policy_prey_policy_reward": [-25.161361078306594, -35.45993283616535, -17.959198774612616, -35.94160643937921, -17.90170460398829, -34.69508330071219, -44.72303923683452, -38.493599361215544, -2.7976933111708515, -51.376049664240156, -39.58331641251868, -14.691527058444725, -38.35001356794926, -10.960923676481926, -24.964504471896035, -39.19442244409582, -53.9558242365532, -30.572764904643044, -6.947578642158334, -17.514808663520895, -16.75872727114063, -20.93678939365405, -21.99793219290797, -5.3460230293182756, -31.09745229692277, -3.2404860150444046, -45.986099638379955, -49.726994285323975, -10.002618054531169, -9.289105077503724, -24.01235455471477, -13.081527323169139, -33.19989106121362, -8.429493490670263, -37.90050547099623, -26.18740291721383, -27.00526753914271, -31.80746945511809, -16.238240462022464, -34.28239143132926, -26.458464003088107, -18.739115528240323, -23.226299348349098, -4.048935630555421, -36.77704602383487, -23.839151168489217, -20.709574198436712, -23.250930795289467, -26.869742288349237, -22.85436226058714, -12.328397936817217, -7.322313237693243, -9.565859091729218, -9.7277991731112, -25.76372756112618, -8.752158546200254, -28.547382428946527, -34.15803167310533, -12.055644642469725, -19.84616544330916, -22.441505546368646, -8.712286716900294, -48.84163767253183, -15.312014962183298, -19.204541423450145, -4.983182637605049, -41.4799943884062, -17.299132503280802, -21.60613016708691, -20.04655746320826, -24.9535229818313, -11.79748304633187, -19.569960604986832, -12.148321131561934, -7.212566305390515, -13.828283965265637, -14.811617713505049, -8.108993392681956, -27.33252689886136, -13.13455178529504, -35.59901245685156, -16.12764910953325, -34.190100002693335, -10.645698363320019, -35.69224941376435, -41.35967159949108, -51.705632861355994, -21.555204108371107, -24.10946721329902, -10.226017925864177, -19.45723187633743, -18.769665797605565, -45.70503960669077, -16.025104876988532, -26.642506904574656, -11.573765686023677, -23.66653666193711, -34.73328720493664, -19.43207176645567, -1.1199387052267267], "policy_predator_policy_reward": [25.161361078306594, 35.45993283616535, 17.959198774612616, 35.94160643937921, 17.90170460398829, 34.69508330071219, 44.72303923683452, 38.493599361215544, 2.7976933111708515, 51.376049664240156, 39.58331641251868, 14.691527058444725, 38.35001356794926, 10.960923676481926, 24.964504471896035, 39.19442244409582, 53.9558242365532, 30.572764904643044, 6.947578642158334, 17.514808663520895, 16.75872727114063, 20.93678939365405, 21.99793219290797, 5.3460230293182756, 31.09745229692277, 3.2404860150444046, 45.986099638379955, 49.726994285323975, 10.002618054531169, 9.289105077503724, 24.01235455471477, 13.081527323169139, 33.19989106121362, 8.429493490670263, 37.90050547099623, 26.18740291721383, 27.00526753914271, 31.80746945511809, 16.238240462022464, 34.28239143132926, 26.458464003088107, 18.739115528240323, 23.226299348349098, 4.048935630555421, 36.77704602383487, 23.839151168489217, 20.709574198436712, 23.250930795289467, 26.869742288349237, 22.85436226058714, 12.328397936817217, 7.322313237693243, 9.565859091729218, 9.7277991731112, 25.76372756112618, 8.752158546200254, 28.547382428946527, 34.15803167310533, 12.055644642469725, 19.84616544330916, 22.441505546368646, 8.712286716900294, 48.84163767253183, 15.312014962183298, 19.204541423450145, 4.983182637605049, 41.4799943884062, 17.299132503280802, 21.60613016708691, 20.04655746320826, 24.9535229818313, 11.79748304633187, 19.569960604986832, 12.148321131561934, 7.212566305390515, 13.828283965265637, 14.811617713505049, 8.108993392681956, 27.33252689886136, 13.13455178529504, 35.59901245685156, 16.12764910953325, 34.190100002693335, 10.645698363320019, 35.69224941376435, 41.35967159949108, 51.705632861355994, 21.555204108371107, 24.10946721329902, 10.226017925864177, 19.45723187633743, 18.769665797605565, 45.70503960669077, 16.025104876988532, 26.642506904574656, 11.573765686023677, 23.66653666193711, 34.73328720493664, 19.43207176645567, 1.1199387052267267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29428225337955216, "mean_inference_ms": 0.9427523401682982, "mean_action_processing_ms": 0.1258733913505885, "mean_env_wait_ms": 0.06640487778588967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030368566513061523, "StateBufferConnector_ms": 0.0019861459732055664, "ViewRequirementAgentConnector_ms": 0.04767334461212158}, "num_episodes": 67, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 684.4111688002924, "num_env_steps_trained_throughput_per_sec": 684.4111688002924, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 5892.815, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5892.778, "sample_time_ms": 672.958, "learn_time_ms": 5205.741, "learn_throughput": 768.382, "synch_weights_time_ms": 13.692}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "training_iteration": 109, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-41", "timestamp": 1723390901, "time_this_iter_s": 5.851797103881836, "time_total_s": 645.4237923622131, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b135d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 645.4237923622131, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 27.25, "ram_util_percent": 81.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0262268947437407, "cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3011341009909907, "policy_loss": -0.004514672359800897, "vf_loss": 1.3056487749641141, "vf_explained_var": 0.9712285714844863, "kl": 0.005629471566882863, "entropy": 0.3951635977563759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.276994377374649, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.334299175068736, "policy_loss": -0.0071191002018167636, "vf_loss": 1.341229908975462, "vf_explained_var": 0.9705084510147571, "kl": 0.010046225296781954, "entropy": 0.6284048944090803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.2, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6420, "policy_reward_min": {"prey_policy": -51.705632861355994, "predator_policy": 1.1199387052267267}, "policy_reward_max": {"prey_policy": -1.1199387052267267, "predator_policy": 51.705632861355994}, "policy_reward_mean": {"prey_policy": -24.28212207056015, "predator_policy": 24.28212207056015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [74, 76, 68, 86, 48, 70, 120, 68, 71, 41, 74, 47, 46, 67, 57, 37, 45, 48, 51, 60, 31, 58, 70, 77, 66, 67, 89, 80, 74, 52, 18, 39, 74, 89, 65, 54, 41, 61, 75, 84, 15, 46, 29, 73, 93, 20, 72, 62, 44, 107, 81, 52, 71, 86, 72, 92, 91, 65, 75, 91, 59, 44, 55, 56, 43, 58, 67, 87, 96, 51, 69, 88, 55, 57, 71, 66, 89, 40, 55, 48, 50, 50, 61, 59, 58, 83, 83, 84, 34, 71, 53, 83, 77, 47, 84, 70, 68, 81, 85, 30], "policy_prey_policy_reward": [-19.84616544330916, -22.441505546368646, -8.712286716900294, -48.84163767253183, -15.312014962183298, -19.204541423450145, -4.983182637605049, -41.4799943884062, -17.299132503280802, -21.60613016708691, -20.04655746320826, -24.9535229818313, -11.79748304633187, -19.569960604986832, -12.148321131561934, -7.212566305390515, -13.828283965265637, -14.811617713505049, -8.108993392681956, -27.33252689886136, -13.13455178529504, -35.59901245685156, -16.12764910953325, -34.190100002693335, -10.645698363320019, -35.69224941376435, -41.35967159949108, -51.705632861355994, -21.555204108371107, -24.10946721329902, -10.226017925864177, -19.45723187633743, -18.769665797605565, -45.70503960669077, -16.025104876988532, -26.642506904574656, -11.573765686023677, -23.66653666193711, -34.73328720493664, -19.43207176645567, -1.1199387052267267, -31.58080913360004, -4.953542891699006, -27.954366792532422, -21.42949466787636, -8.03962412844579, -40.71091018561929, -29.88944901207106, -32.86988682567779, -30.030090616065888, -50.785551415887184, -18.78835824045316, -27.059165321459062, -33.68221483072555, -27.567353534286752, -33.48121462184564, -38.13081990096951, -19.303331552477083, -31.11611171625696, -28.753783428178828, -17.414843350345173, -10.620973552138858, -23.828479943272754, -33.262377479266966, -11.647923854590672, -9.007652766132342, -32.23971189665143, -25.49236994862664, -34.82430043643021, -31.726709269784, -36.81453821731137, -35.78455974708226, -17.149190215936738, -18.54472135847093, -28.194925539882817, -14.717219716513252, -30.61713622094036, -19.372428033354606, -15.863572939901525, -32.712997377800754, -33.53873265260544, -10.329580802948847, -26.452714502413556, -17.085460266043697, -32.65806026505211, -38.856635439645174, -31.299373949492864, -37.266473360966565, -17.095221839949403, -22.801246000629273, -8.236420442714326, -22.684554906412806, -26.39399052335721, -15.852431992622913, -36.228288865684306, -19.89289587928934, -44.29035191139711, -41.295355223054734, -34.58711980368968, -4.397758856121863], "policy_predator_policy_reward": [19.84616544330916, 22.441505546368646, 8.712286716900294, 48.84163767253183, 15.312014962183298, 19.204541423450145, 4.983182637605049, 41.4799943884062, 17.299132503280802, 21.60613016708691, 20.04655746320826, 24.9535229818313, 11.79748304633187, 19.569960604986832, 12.148321131561934, 7.212566305390515, 13.828283965265637, 14.811617713505049, 8.108993392681956, 27.33252689886136, 13.13455178529504, 35.59901245685156, 16.12764910953325, 34.190100002693335, 10.645698363320019, 35.69224941376435, 41.35967159949108, 51.705632861355994, 21.555204108371107, 24.10946721329902, 10.226017925864177, 19.45723187633743, 18.769665797605565, 45.70503960669077, 16.025104876988532, 26.642506904574656, 11.573765686023677, 23.66653666193711, 34.73328720493664, 19.43207176645567, 1.1199387052267267, 31.58080913360004, 4.953542891699006, 27.954366792532422, 21.42949466787636, 8.03962412844579, 40.71091018561929, 29.88944901207106, 32.86988682567779, 30.030090616065888, 50.785551415887184, 18.78835824045316, 27.059165321459062, 33.68221483072555, 27.567353534286752, 33.48121462184564, 38.13081990096951, 19.303331552477083, 31.11611171625696, 28.753783428178828, 17.414843350345173, 10.620973552138858, 23.828479943272754, 33.262377479266966, 11.647923854590672, 9.007652766132342, 32.23971189665143, 25.49236994862664, 34.82430043643021, 31.726709269784, 36.81453821731137, 35.78455974708226, 17.149190215936738, 18.54472135847093, 28.194925539882817, 14.717219716513252, 30.61713622094036, 19.372428033354606, 15.863572939901525, 32.712997377800754, 33.53873265260544, 10.329580802948847, 26.452714502413556, 17.085460266043697, 32.65806026505211, 38.856635439645174, 31.299373949492864, 37.266473360966565, 17.095221839949403, 22.801246000629273, 8.236420442714326, 22.684554906412806, 26.39399052335721, 15.852431992622913, 36.228288865684306, 19.89289587928934, 44.29035191139711, 41.295355223054734, 34.58711980368968, 4.397758856121863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29367547508354724, "mean_inference_ms": 0.9419403596615215, "mean_action_processing_ms": 0.1256627747717111, "mean_env_wait_ms": 0.06631195802387294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002692699432373047, "StateBufferConnector_ms": 0.0018929243087768555, "ViewRequirementAgentConnector_ms": 0.04598653316497803}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 697.1706588387756, "num_env_steps_trained_throughput_per_sec": 697.1706588387756, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 5878.166, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5878.129, "sample_time_ms": 670.709, "learn_time_ms": 5193.687, "learn_throughput": 770.166, "synch_weights_time_ms": 13.353}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 110, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-47", "timestamp": 1723390907, "time_this_iter_s": 5.742070913314819, "time_total_s": 651.165863275528, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cda60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 651.165863275528, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 27.2875, "ram_util_percent": 81.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7565831946209074, "cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1762335165908249, "policy_loss": -0.003937204731725311, "vf_loss": 1.1801707225230833, "vf_explained_var": 0.9707545591518283, "kl": 0.0069326381191157785, "entropy": 0.372850423057874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.954267020958165, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2131872458693882, "policy_loss": -0.008028071285419476, "vf_loss": 1.2210370287299157, "vf_explained_var": 0.9694176336750389, "kl": 0.00950845132239625, "entropy": 0.6241645437354842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.12, "episode_media": {}, "episodes_this_iter": 68, "episodes_timesteps_total": 6112, "policy_reward_min": {"prey_policy": -52.857344968116394, "predator_policy": 0.8614091503252199}, "policy_reward_max": {"prey_policy": -0.8614091503252199, "predator_policy": 52.857344968116394}, "policy_reward_mean": {"prey_policy": -24.07287536751583, "predator_policy": 24.07287536751583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [96, 51, 69, 88, 55, 57, 71, 66, 89, 40, 55, 48, 50, 50, 61, 59, 58, 83, 83, 84, 34, 71, 53, 83, 77, 47, 84, 70, 68, 81, 85, 30, 52, 54, 76, 63, 63, 28, 25, 77, 80, 53, 75, 29, 44, 72, 55, 72, 46, 81, 50, 60, 69, 64, 48, 66, 79, 72, 16, 85, 118, 47, 116, 76, 74, 76, 74, 39, 35, 42, 52, 77, 58, 25, 51, 44, 74, 47, 50, 84, 96, 75, 47, 79, 67, 66, 72, 84, 52, 31, 69, 12, 30, 76, 32, 47, 47, 68, 26, 27], "policy_prey_policy_reward": [-34.82430043643021, -31.726709269784, -36.81453821731137, -35.78455974708226, -17.149190215936738, -18.54472135847093, -28.194925539882817, -14.717219716513252, -30.61713622094036, -19.372428033354606, -15.863572939901525, -32.712997377800754, -33.53873265260544, -10.329580802948847, -26.452714502413556, -17.085460266043697, -32.65806026505211, -38.856635439645174, -31.299373949492864, -37.266473360966565, -17.095221839949403, -22.801246000629273, -8.236420442714326, -22.684554906412806, -26.39399052335721, -15.852431992622913, -36.228288865684306, -19.89289587928934, -44.29035191139711, -41.295355223054734, -34.58711980368968, -4.397758856121863, -4.095589750137178, -26.929989844934408, -36.81601901201728, -45.06239527594649, -24.471748836834728, -14.597704325960805, -6.475435399468433, -39.8835141311356, -40.92025402663663, -23.14218869192533, -21.821709631494038, -17.35822379461138, -24.62803164463884, -30.591591619736082, -18.47728583883138, -19.352914755023694, -24.424909990063398, -15.801531392861072, -29.80209401675946, -26.148380380326735, -15.518187041315716, -31.66010679091539, -16.882052542639418, -15.957011640058143, -34.562883065144575, -19.353259340338155, -10.529410341834607, -24.942103210197136, -37.685364925642745, -0.8614091503252199, -42.46827218764988, -29.488217336202993, -18.116062371355987, -26.633552622301867, -32.838901541743816, -28.41682086818261, -15.017787479841083, -21.065963086346994, -29.15787295495141, -27.845603579546513, -21.788085352252498, -12.231422419296123, -1.802180097627316, -21.044551731644724, -24.08550935796978, -13.706315927603708, -31.41491553886557, -52.857344968116394, -13.340441456999534, -34.00081122186801, -9.743495550533702, -34.86036538605518, -20.3919304687069, -19.63330918932785, -30.13253748818532, -32.51177655326261, -9.540464517550067, -18.351487816167637, -25.422613780806493, -7.1176713557484135, -7.595802644956979, -26.967110408889393, -30.787359928793208, -27.23348030011493, -15.585546092474175, -23.207678254362804, -16.01541067551915, -18.5505972745075], "policy_predator_policy_reward": [34.82430043643021, 31.726709269784, 36.81453821731137, 35.78455974708226, 17.149190215936738, 18.54472135847093, 28.194925539882817, 14.717219716513252, 30.61713622094036, 19.372428033354606, 15.863572939901525, 32.712997377800754, 33.53873265260544, 10.329580802948847, 26.452714502413556, 17.085460266043697, 32.65806026505211, 38.856635439645174, 31.299373949492864, 37.266473360966565, 17.095221839949403, 22.801246000629273, 8.236420442714326, 22.684554906412806, 26.39399052335721, 15.852431992622913, 36.228288865684306, 19.89289587928934, 44.29035191139711, 41.295355223054734, 34.58711980368968, 4.397758856121863, 4.095589750137178, 26.929989844934408, 36.81601901201728, 45.06239527594649, 24.471748836834728, 14.597704325960805, 6.475435399468433, 39.8835141311356, 40.92025402663663, 23.14218869192533, 21.821709631494038, 17.35822379461138, 24.62803164463884, 30.591591619736082, 18.47728583883138, 19.352914755023694, 24.424909990063398, 15.801531392861072, 29.80209401675946, 26.148380380326735, 15.518187041315716, 31.66010679091539, 16.882052542639418, 15.957011640058143, 34.562883065144575, 19.353259340338155, 10.529410341834607, 24.942103210197136, 37.685364925642745, 0.8614091503252199, 42.46827218764988, 29.488217336202993, 18.116062371355987, 26.633552622301867, 32.838901541743816, 28.41682086818261, 15.017787479841083, 21.065963086346994, 29.15787295495141, 27.845603579546513, 21.788085352252498, 12.231422419296123, 1.802180097627316, 21.044551731644724, 24.08550935796978, 13.706315927603708, 31.41491553886557, 52.857344968116394, 13.340441456999534, 34.00081122186801, 9.743495550533702, 34.86036538605518, 20.3919304687069, 19.63330918932785, 30.13253748818532, 32.51177655326261, 9.540464517550067, 18.351487816167637, 25.422613780806493, 7.1176713557484135, 7.595802644956979, 26.967110408889393, 30.787359928793208, 27.23348030011493, 15.585546092474175, 23.207678254362804, 16.01541067551915, 18.5505972745075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2936162518387023, "mean_inference_ms": 0.9408675946719868, "mean_action_processing_ms": 0.1254642616829487, "mean_env_wait_ms": 0.06619061347430782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027648210525512695, "StateBufferConnector_ms": 0.00208890438079834, "ViewRequirementAgentConnector_ms": 0.045639872550964355}, "num_episodes": 68, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 676.1951303856463, "num_env_steps_trained_throughput_per_sec": 676.1951303856463, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 5901.704, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5901.669, "sample_time_ms": 675.408, "learn_time_ms": 5212.546, "learn_throughput": 767.379, "synch_weights_time_ms": 13.339}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 111, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-53", "timestamp": 1723390913, "time_this_iter_s": 5.92103910446167, "time_total_s": 657.0869023799896, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 657.0869023799896, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 81.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1773460391908883, "cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4999983314424754, "policy_loss": -0.0033274765599344393, "vf_loss": 1.5033258120218913, "vf_explained_var": 0.9655797241876523, "kl": 0.0047270306580472965, "entropy": 0.39943604699025553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.43872643870612, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4927366790672143, "policy_loss": -0.004487563985943173, "vf_loss": 1.4971583131079873, "vf_explained_var": 0.9659310827031732, "kl": 0.0035160832370472617, "entropy": 0.6151007800052564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.5, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6250, "policy_reward_min": {"prey_policy": -53.75441823574377, "predator_policy": 0.8614091503252199}, "policy_reward_max": {"prey_policy": -0.8614091503252199, "predator_policy": 53.75441823574377}, "policy_reward_mean": {"prey_policy": -24.82270775256326, "predator_policy": 24.82270775256326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [47, 116, 76, 74, 76, 74, 39, 35, 42, 52, 77, 58, 25, 51, 44, 74, 47, 50, 84, 96, 75, 47, 79, 67, 66, 72, 84, 52, 31, 69, 12, 30, 76, 32, 47, 47, 68, 26, 27, 79, 76, 47, 106, 58, 92, 51, 21, 53, 70, 87, 43, 81, 73, 86, 72, 79, 69, 48, 70, 45, 50, 74, 61, 88, 72, 52, 68, 78, 97, 70, 70, 46, 41, 37, 68, 74, 58, 79, 45, 55, 76, 51, 49, 85, 73, 32, 98, 48, 76, 77, 71, 21, 181, 68, 53, 55, 59, 53, 42, 49], "policy_prey_policy_reward": [-0.8614091503252199, -42.46827218764988, -29.488217336202993, -18.116062371355987, -26.633552622301867, -32.838901541743816, -28.41682086818261, -15.017787479841083, -21.065963086346994, -29.15787295495141, -27.845603579546513, -21.788085352252498, -12.231422419296123, -1.802180097627316, -21.044551731644724, -24.08550935796978, -13.706315927603708, -31.41491553886557, -52.857344968116394, -13.340441456999534, -34.00081122186801, -9.743495550533702, -34.86036538605518, -20.3919304687069, -19.63330918932785, -30.13253748818532, -32.51177655326261, -9.540464517550067, -18.351487816167637, -25.422613780806493, -7.1176713557484135, -7.595802644956979, -26.967110408889393, -30.787359928793208, -27.23348030011493, -15.585546092474175, -23.207678254362804, -16.01541067551915, -18.5505972745075, -22.868326401089217, -30.874587557822558, -9.073106023825142, -53.75441823574377, -6.62007290891694, -45.34889625599581, -38.88756158626612, -2.565008101253399, -20.888399760288642, -32.43121632075783, -40.13715764911953, -19.20465689880916, -39.776177731852606, -39.47910634498932, -34.752211775019205, -27.728855707792547, -43.576672283622, -10.154862189982254, -36.52807356002549, -39.825735381603494, -3.9614221234579725, -30.773276533317727, -16.73238059900739, -33.139981187641176, -27.43352059236998, -25.68330345633496, -15.520635572643357, -31.478444648645038, -21.641497745438993, -43.777436661760916, -39.52113106575027, -25.393817971874192, -25.67044241376269, -10.851003480044028, -13.228470031154608, -8.374272767196885, -36.98221085440484, -36.993145355429355, -30.266719685719828, -28.86196925286553, -13.534654000774239, -30.06071342356539, -38.19479237181414, -12.098512111758625, -29.513715746759118, -32.85685800058016, -14.649616564300445, -27.83353713248893, -13.939455548815385, -37.15680067285764, -34.410629438079496, -44.32914287200754, -15.184677379041464, -43.315611941758476, -16.750522412376206, -26.29032094949411, -9.318016658234106, -17.719195220323087, -21.91727958179924, -15.491448263105905, -15.114411356143346], "policy_predator_policy_reward": [0.8614091503252199, 42.46827218764988, 29.488217336202993, 18.116062371355987, 26.633552622301867, 32.838901541743816, 28.41682086818261, 15.017787479841083, 21.065963086346994, 29.15787295495141, 27.845603579546513, 21.788085352252498, 12.231422419296123, 1.802180097627316, 21.044551731644724, 24.08550935796978, 13.706315927603708, 31.41491553886557, 52.857344968116394, 13.340441456999534, 34.00081122186801, 9.743495550533702, 34.86036538605518, 20.3919304687069, 19.63330918932785, 30.13253748818532, 32.51177655326261, 9.540464517550067, 18.351487816167637, 25.422613780806493, 7.1176713557484135, 7.595802644956979, 26.967110408889393, 30.787359928793208, 27.23348030011493, 15.585546092474175, 23.207678254362804, 16.01541067551915, 18.5505972745075, 22.868326401089217, 30.874587557822558, 9.073106023825142, 53.75441823574377, 6.62007290891694, 45.34889625599581, 38.88756158626612, 2.565008101253399, 20.888399760288642, 32.43121632075783, 40.13715764911953, 19.20465689880916, 39.776177731852606, 39.47910634498932, 34.752211775019205, 27.728855707792547, 43.576672283622, 10.154862189982254, 36.52807356002549, 39.825735381603494, 3.9614221234579725, 30.773276533317727, 16.73238059900739, 33.139981187641176, 27.43352059236998, 25.68330345633496, 15.520635572643357, 31.478444648645038, 21.641497745438993, 43.777436661760916, 39.52113106575027, 25.393817971874192, 25.67044241376269, 10.851003480044028, 13.228470031154608, 8.374272767196885, 36.98221085440484, 36.993145355429355, 30.266719685719828, 28.86196925286553, 13.534654000774239, 30.06071342356539, 38.19479237181414, 12.098512111758625, 29.513715746759118, 32.85685800058016, 14.649616564300445, 27.83353713248893, 13.939455548815385, 37.15680067285764, 34.410629438079496, 44.32914287200754, 15.184677379041464, 43.315611941758476, 16.750522412376206, 26.29032094949411, 9.318016658234106, 17.719195220323087, 21.91727958179924, 15.491448263105905, 15.114411356143346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2936521691254163, "mean_inference_ms": 0.940909074519708, "mean_action_processing_ms": 0.1254885344800121, "mean_env_wait_ms": 0.06624799745523985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002698183059692383, "StateBufferConnector_ms": 0.002152562141418457, "ViewRequirementAgentConnector_ms": 0.045799851417541504}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.1735307293108, "num_env_steps_trained_throughput_per_sec": 687.1735307293108, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 5898.336, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5898.3, "sample_time_ms": 679.755, "learn_time_ms": 5204.554, "learn_throughput": 768.558, "synch_weights_time_ms": 13.57}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 112, "trial_id": "abfb9_00000", "date": "2024-08-11_11-41-59", "timestamp": 1723390919, "time_this_iter_s": 5.825920104980469, "time_total_s": 662.9128224849701, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 662.9128224849701, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 27.200000000000003, "ram_util_percent": 81.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0764993561431764, "cur_kl_coeff": 8.940696716308592e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2571357510363061, "policy_loss": -0.004515939930085248, "vf_loss": 1.261651693781217, "vf_explained_var": 0.9732905934254329, "kl": 0.008004750489246404, "entropy": 0.3844634983378152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2144765445341665, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2718870957071582, "policy_loss": -0.016632140968674016, "vf_loss": 1.2881863969067733, "vf_explained_var": 0.9726242032522957, "kl": 0.035503018560770275, "entropy": 0.5947166427349051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.36, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6536, "policy_reward_min": {"prey_policy": -46.28172015833452, "predator_policy": 1.579696164297376}, "policy_reward_max": {"prey_policy": -1.579696164297376, "predator_policy": 46.28172015833452}, "policy_reward_mean": {"prey_policy": -25.336108323739253, "predator_policy": 25.336108323739253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [61, 88, 72, 52, 68, 78, 97, 70, 70, 46, 41, 37, 68, 74, 58, 79, 45, 55, 76, 51, 49, 85, 73, 32, 98, 48, 76, 77, 71, 21, 181, 68, 53, 55, 59, 53, 42, 49, 59, 65, 77, 37, 61, 61, 83, 75, 66, 59, 66, 45, 51, 77, 26, 33, 129, 48, 60, 69, 81, 44, 56, 66, 71, 50, 65, 76, 62, 32, 64, 65, 31, 59, 68, 39, 62, 56, 69, 67, 95, 128, 77, 78, 61, 57, 87, 87, 59, 34, 72, 61, 83, 85, 67, 83, 78, 75, 56, 49, 80, 78], "policy_prey_policy_reward": [-33.139981187641176, -27.43352059236998, -25.68330345633496, -15.520635572643357, -31.478444648645038, -21.641497745438993, -43.777436661760916, -39.52113106575027, -25.393817971874192, -25.67044241376269, -10.851003480044028, -13.228470031154608, -8.374272767196885, -36.98221085440484, -36.993145355429355, -30.266719685719828, -28.86196925286553, -13.534654000774239, -30.06071342356539, -38.19479237181414, -12.098512111758625, -29.513715746759118, -32.85685800058016, -14.649616564300445, -27.83353713248893, -13.939455548815385, -37.15680067285764, -34.410629438079496, -44.32914287200754, -15.184677379041464, -43.315611941758476, -16.750522412376206, -26.29032094949411, -9.318016658234106, -17.719195220323087, -21.91727958179924, -15.491448263105905, -15.114411356143346, -29.6389584978821, -20.172602864361338, -5.846632457805329, -1.579696164297376, -8.479964458555264, -5.163901280315334, -34.80012993564989, -20.002446096309967, -16.434385715227375, -30.378170813403944, -44.173638320376405, -19.262522592954678, -7.542159577497383, -33.92593038142327, -4.666225567522838, -21.497728892006307, -25.36475438836864, -26.142061041950175, -15.043733098055254, -33.31210333295523, -40.94973047171144, -26.52076056784473, -16.78651571717274, -35.77724330720814, -37.6306870245719, -39.93447395556794, -35.7520084091059, -32.573634281030294, -34.232147590478014, -18.473873811706447, -33.48428645056543, -28.035804183057135, -14.789436401161193, -24.557865288916958, -43.32698482347483, -12.923116926713911, -21.612821722716077, -24.946250675451473, -15.718709422625992, -34.173959845619336, -15.673209030339486, -10.393313449116501, -39.77994252314121, -26.35044636116186, -15.841446988404062, -32.77752315252619, -22.793600883992433, -27.224843037507274, -26.090204153994485, -9.605353233741829, -29.21214144481906, -33.54153387118664, -37.58809491474885, -29.431124029212757, -13.461891060355118, -23.756452333647257, -46.28172015833452, -35.806028592615476, -26.844488986741055, -18.818817250906466, -37.96632163386992, -34.246364540831784], "policy_predator_policy_reward": [33.139981187641176, 27.43352059236998, 25.68330345633496, 15.520635572643357, 31.478444648645038, 21.641497745438993, 43.777436661760916, 39.52113106575027, 25.393817971874192, 25.67044241376269, 10.851003480044028, 13.228470031154608, 8.374272767196885, 36.98221085440484, 36.993145355429355, 30.266719685719828, 28.86196925286553, 13.534654000774239, 30.06071342356539, 38.19479237181414, 12.098512111758625, 29.513715746759118, 32.85685800058016, 14.649616564300445, 27.83353713248893, 13.939455548815385, 37.15680067285764, 34.410629438079496, 44.32914287200754, 15.184677379041464, 43.315611941758476, 16.750522412376206, 26.29032094949411, 9.318016658234106, 17.719195220323087, 21.91727958179924, 15.491448263105905, 15.114411356143346, 29.6389584978821, 20.172602864361338, 5.846632457805329, 1.579696164297376, 8.479964458555264, 5.163901280315334, 34.80012993564989, 20.002446096309967, 16.434385715227375, 30.378170813403944, 44.173638320376405, 19.262522592954678, 7.542159577497383, 33.92593038142327, 4.666225567522838, 21.497728892006307, 25.36475438836864, 26.142061041950175, 15.043733098055254, 33.31210333295523, 40.94973047171144, 26.52076056784473, 16.78651571717274, 35.77724330720814, 37.6306870245719, 39.93447395556794, 35.7520084091059, 32.573634281030294, 34.232147590478014, 18.473873811706447, 33.48428645056543, 28.035804183057135, 14.789436401161193, 24.557865288916958, 43.32698482347483, 12.923116926713911, 21.612821722716077, 24.946250675451473, 15.718709422625992, 34.173959845619336, 15.673209030339486, 10.393313449116501, 39.77994252314121, 26.35044636116186, 15.841446988404062, 32.77752315252619, 22.793600883992433, 27.224843037507274, 26.090204153994485, 9.605353233741829, 29.21214144481906, 33.54153387118664, 37.58809491474885, 29.431124029212757, 13.461891060355118, 23.756452333647257, 46.28172015833452, 35.806028592615476, 26.844488986741055, 18.818817250906466, 37.96632163386992, 34.246364540831784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2933353713108913, "mean_inference_ms": 0.9403616794161916, "mean_action_processing_ms": 0.12553204097964488, "mean_env_wait_ms": 0.06618353026079087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025681257247924805, "StateBufferConnector_ms": 0.0019338130950927734, "ViewRequirementAgentConnector_ms": 0.04565310478210449}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 636.7523792321883, "num_env_steps_trained_throughput_per_sec": 636.7523792321883, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 5951.573, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5951.523, "sample_time_ms": 678.744, "learn_time_ms": 5257.535, "learn_throughput": 760.813, "synch_weights_time_ms": 14.723}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "training_iteration": 113, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-05", "timestamp": 1723390925, "time_this_iter_s": 6.307363986968994, "time_total_s": 669.2201864719391, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 669.2201864719391, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 45.211111111111116, "ram_util_percent": 82.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.391835587720076, "cur_kl_coeff": 8.940696716308592e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6528149966150523, "policy_loss": -0.002665110981130662, "vf_loss": 1.6554801085963846, "vf_explained_var": 0.9664004184305668, "kl": 0.0035431564063581316, "entropy": 0.3940426241296033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.457241139188409, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6492080628871917, "policy_loss": -0.0022771521888595696, "vf_loss": 1.6514054395879307, "vf_explained_var": 0.9656334113950531, "kl": 0.0056729384394439255, "entropy": 0.5911985959236821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.84, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6684, "policy_reward_min": {"prey_policy": -60.86738629897201, "predator_policy": 3.4011844177427237}, "policy_reward_max": {"prey_policy": -3.4011844177427237, "predator_policy": 60.86738629897201}, "policy_reward_mean": {"prey_policy": -26.191329972829795, "predator_policy": 26.191329972829795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [44, 56, 66, 71, 50, 65, 76, 62, 32, 64, 65, 31, 59, 68, 39, 62, 56, 69, 67, 95, 128, 77, 78, 61, 57, 87, 87, 59, 34, 72, 61, 83, 85, 67, 83, 78, 75, 56, 49, 80, 78, 54, 95, 28, 80, 35, 43, 51, 86, 70, 90, 61, 35, 84, 96, 87, 15, 89, 74, 38, 50, 81, 49, 61, 81, 88, 81, 58, 49, 47, 100, 79, 90, 79, 92, 187, 44, 60, 76, 53, 30, 68, 54, 93, 75, 53, 57, 89, 66, 38, 73, 64, 58, 40, 79, 30, 62, 44, 61, 102], "policy_prey_policy_reward": [-26.52076056784473, -16.78651571717274, -35.77724330720814, -37.6306870245719, -39.93447395556794, -35.7520084091059, -32.573634281030294, -34.232147590478014, -18.473873811706447, -33.48428645056543, -28.035804183057135, -14.789436401161193, -24.557865288916958, -43.32698482347483, -12.923116926713911, -21.612821722716077, -24.946250675451473, -15.718709422625992, -34.173959845619336, -15.673209030339486, -10.393313449116501, -39.77994252314121, -26.35044636116186, -15.841446988404062, -32.77752315252619, -22.793600883992433, -27.224843037507274, -26.090204153994485, -9.605353233741829, -29.21214144481906, -33.54153387118664, -37.58809491474885, -29.431124029212757, -13.461891060355118, -23.756452333647257, -46.28172015833452, -35.806028592615476, -26.844488986741055, -18.818817250906466, -37.96632163386992, -34.246364540831784, -3.4011844177427237, -16.360855579415123, -7.656067681163586, -12.45272338371809, -14.457785631938197, -11.82990386992823, -15.482408568108754, -16.705956658616053, -32.92402724329773, -41.932623361594224, -24.333393024548396, -12.35489053891898, -51.230673743540294, -8.464099952226675, -34.17010797714163, -9.915107012994756, -39.95587714914877, -35.34090285690857, -8.290426515220073, -6.500152923067007, -20.821533115910043, -18.26285914342079, -32.01855373974395, -39.80022874681649, -40.759463543913206, -46.17214872719896, -35.4077984001095, -21.442804707058094, -13.412179412145536, -39.24446621526002, -34.37704951917423, -33.75612725677916, -20.058201116741213, -36.7026542753314, -31.605594888558073, -15.403198818514099, -31.341394711422357, -26.128463975645253, -17.921959175901122, -15.17154630457682, -27.133476601806045, -15.63029351227128, -36.971685749652835, -24.64634921724535, -9.873126837226305, -32.92111149479032, -24.57332661220475, -38.42538307068902, -20.87771505419031, -40.094835190636836, -29.445205532364714, -36.400799345036766, -10.23728886728979, -39.58066088675673, -11.91844310880167, -27.123014554728396, -10.154709173074002, -23.955350255601225, -60.86738629897201], "policy_predator_policy_reward": [26.52076056784473, 16.78651571717274, 35.77724330720814, 37.6306870245719, 39.93447395556794, 35.7520084091059, 32.573634281030294, 34.232147590478014, 18.473873811706447, 33.48428645056543, 28.035804183057135, 14.789436401161193, 24.557865288916958, 43.32698482347483, 12.923116926713911, 21.612821722716077, 24.946250675451473, 15.718709422625992, 34.173959845619336, 15.673209030339486, 10.393313449116501, 39.77994252314121, 26.35044636116186, 15.841446988404062, 32.77752315252619, 22.793600883992433, 27.224843037507274, 26.090204153994485, 9.605353233741829, 29.21214144481906, 33.54153387118664, 37.58809491474885, 29.431124029212757, 13.461891060355118, 23.756452333647257, 46.28172015833452, 35.806028592615476, 26.844488986741055, 18.818817250906466, 37.96632163386992, 34.246364540831784, 3.4011844177427237, 16.360855579415123, 7.656067681163586, 12.45272338371809, 14.457785631938197, 11.82990386992823, 15.482408568108754, 16.705956658616053, 32.92402724329773, 41.932623361594224, 24.333393024548396, 12.35489053891898, 51.230673743540294, 8.464099952226675, 34.17010797714163, 9.915107012994756, 39.95587714914877, 35.34090285690857, 8.290426515220073, 6.500152923067007, 20.821533115910043, 18.26285914342079, 32.01855373974395, 39.80022874681649, 40.759463543913206, 46.17214872719896, 35.4077984001095, 21.442804707058094, 13.412179412145536, 39.24446621526002, 34.37704951917423, 33.75612725677916, 20.058201116741213, 36.7026542753314, 31.605594888558073, 15.403198818514099, 31.341394711422357, 26.128463975645253, 17.921959175901122, 15.17154630457682, 27.133476601806045, 15.63029351227128, 36.971685749652835, 24.64634921724535, 9.873126837226305, 32.92111149479032, 24.57332661220475, 38.42538307068902, 20.87771505419031, 40.094835190636836, 29.445205532364714, 36.400799345036766, 10.23728886728979, 39.58066088675673, 11.91844310880167, 27.123014554728396, 10.154709173074002, 23.955350255601225, 60.86738629897201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2932613340402765, "mean_inference_ms": 0.9403951100321859, "mean_action_processing_ms": 0.1255254535029929, "mean_env_wait_ms": 0.06617512732856538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028247833251953125, "StateBufferConnector_ms": 0.0020999908447265625, "ViewRequirementAgentConnector_ms": 0.05359482765197754}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 659.0690138550025, "num_env_steps_trained_throughput_per_sec": 659.0690138550025, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 5974.666, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5974.613, "sample_time_ms": 682.456, "learn_time_ms": 5276.989, "learn_throughput": 758.008, "synch_weights_time_ms": 14.638}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 114, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-11", "timestamp": 1723390931, "time_this_iter_s": 6.073930978775024, "time_total_s": 675.2941174507141, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 675.2941174507141, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 42.87777777777777, "ram_util_percent": 83.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2597526000191768, "cur_kl_coeff": 4.470348358154296e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3850197775910298, "policy_loss": -0.0026736594025957554, "vf_loss": 1.3876934399207432, "vf_explained_var": 0.9709966303159793, "kl": 0.005044023007030122, "entropy": 0.4013633173579971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3623047952850658, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3506749187906584, "policy_loss": -0.006705858263982615, "vf_loss": 1.3572234861552714, "vf_explained_var": 0.9713460196430485, "kl": 0.011185038254805324, "entropy": 0.5466664806629221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.33, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6633, "policy_reward_min": {"prey_policy": -60.86738629897201, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 60.86738629897201}, "policy_reward_mean": {"prey_policy": -26.11671498607339, "predator_policy": 26.11671498607339}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [49, 61, 81, 88, 81, 58, 49, 47, 100, 79, 90, 79, 92, 187, 44, 60, 76, 53, 30, 68, 54, 93, 75, 53, 57, 89, 66, 38, 73, 64, 58, 40, 79, 30, 62, 44, 61, 102, 44, 84, 75, 68, 50, 78, 69, 99, 48, 71, 95, 54, 81, 83, 87, 62, 37, 65, 84, 64, 46, 71, 51, 62, 38, 33, 57, 80, 8, 142, 55, 52, 54, 83, 52, 1, 82, 62, 77, 37, 60, 72, 46, 47, 92, 95, 66, 77, 68, 71, 57, 63, 78, 44, 67, 34, 62, 82, 137, 42, 63, 59], "policy_prey_policy_reward": [-18.26285914342079, -32.01855373974395, -39.80022874681649, -40.759463543913206, -46.17214872719896, -35.4077984001095, -21.442804707058094, -13.412179412145536, -39.24446621526002, -34.37704951917423, -33.75612725677916, -20.058201116741213, -36.7026542753314, -31.605594888558073, -15.403198818514099, -31.341394711422357, -26.128463975645253, -17.921959175901122, -15.17154630457682, -27.133476601806045, -15.63029351227128, -36.971685749652835, -24.64634921724535, -9.873126837226305, -32.92111149479032, -24.57332661220475, -38.42538307068902, -20.87771505419031, -40.094835190636836, -29.445205532364714, -36.400799345036766, -10.23728886728979, -39.58066088675673, -11.91844310880167, -27.123014554728396, -10.154709173074002, -23.955350255601225, -60.86738629897201, -15.077141544763688, -24.322779114504492, -17.193782487397467, -24.98895856742623, -12.23162259223269, -27.528570408701736, -45.13600054158624, -47.502717115263835, -12.037916262455242, -22.00312774190664, -53.93371648197201, -20.935320890296225, -48.30996120456545, -49.64557750630134, -43.743532457829694, -25.809036225298158, -15.794624720493637, -30.8622555110551, -36.48825230442165, -15.292445819248073, -17.499317116022734, -17.148720644187282, -26.553219531610733, -37.93891022958902, -10.68478113355234, -5.895216306202175, -30.098214470199448, -37.390206355409155, -4.270934836943703, -28.860410752059572, -36.65908944602287, -27.552217568185394, -9.925803680356339, -21.332206358945847, -30.921429066233955, 0.0, -13.813300274178836, -16.449783915097154, -17.526043155239147, -20.18053522544495, -8.735508886982322, -23.49314236164878, -26.72743588488003, -18.535095694464253, -36.340777072316556, -36.08555764580549, -13.684926338189156, -24.722623305435107, -18.62509137277873, -27.920035186066503, -20.603710765750193, -29.569287898800418, -42.370336393016295, -22.90510895691372, -24.446250984572764, -18.958102245249126, -19.228039095357165, -40.10075310633029, -37.335474167502355, -14.139220507037853, -27.378366222853025, -10.41212091054018], "policy_predator_policy_reward": [18.26285914342079, 32.01855373974395, 39.80022874681649, 40.759463543913206, 46.17214872719896, 35.4077984001095, 21.442804707058094, 13.412179412145536, 39.24446621526002, 34.37704951917423, 33.75612725677916, 20.058201116741213, 36.7026542753314, 31.605594888558073, 15.403198818514099, 31.341394711422357, 26.128463975645253, 17.921959175901122, 15.17154630457682, 27.133476601806045, 15.63029351227128, 36.971685749652835, 24.64634921724535, 9.873126837226305, 32.92111149479032, 24.57332661220475, 38.42538307068902, 20.87771505419031, 40.094835190636836, 29.445205532364714, 36.400799345036766, 10.23728886728979, 39.58066088675673, 11.91844310880167, 27.123014554728396, 10.154709173074002, 23.955350255601225, 60.86738629897201, 15.077141544763688, 24.322779114504492, 17.193782487397467, 24.98895856742623, 12.23162259223269, 27.528570408701736, 45.13600054158624, 47.502717115263835, 12.037916262455242, 22.00312774190664, 53.93371648197201, 20.935320890296225, 48.30996120456545, 49.64557750630134, 43.743532457829694, 25.809036225298158, 15.794624720493637, 30.8622555110551, 36.48825230442165, 15.292445819248073, 17.499317116022734, 17.148720644187282, 26.553219531610733, 37.93891022958902, 10.68478113355234, 5.895216306202175, 30.098214470199448, 37.390206355409155, 4.270934836943703, 28.860410752059572, 36.65908944602287, 27.552217568185394, 9.925803680356339, 21.332206358945847, 30.921429066233955, 0.0, 13.813300274178836, 16.449783915097154, 17.526043155239147, 20.18053522544495, 8.735508886982322, 23.49314236164878, 26.72743588488003, 18.535095694464253, 36.340777072316556, 36.08555764580549, 13.684926338189156, 24.722623305435107, 18.62509137277873, 27.920035186066503, 20.603710765750193, 29.569287898800418, 42.370336393016295, 22.90510895691372, 24.446250984572764, 18.958102245249126, 19.228039095357165, 40.10075310633029, 37.335474167502355, 14.139220507037853, 27.378366222853025, 10.41212091054018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29315439278430505, "mean_inference_ms": 0.9399578096821728, "mean_action_processing_ms": 0.12546086674234144, "mean_env_wait_ms": 0.0662193679554432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029277801513671875, "StateBufferConnector_ms": 0.0021828413009643555, "ViewRequirementAgentConnector_ms": 0.05612218379974365}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.9498091077274, "num_env_steps_trained_throughput_per_sec": 681.9498091077274, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 5989.059, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5989.002, "sample_time_ms": 686.612, "learn_time_ms": 5286.555, "learn_throughput": 756.636, "synch_weights_time_ms": 15.285}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 115, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-17", "timestamp": 1723390937, "time_this_iter_s": 5.875314950942993, "time_total_s": 681.1694324016571, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 681.1694324016571, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 43.574999999999996, "ram_util_percent": 83.36250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7843649978439013, "cur_kl_coeff": 4.470348358154296e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1105848044312248, "policy_loss": -0.0063690467441726165, "vf_loss": 1.1169538534246386, "vf_explained_var": 0.9780287375673652, "kl": 0.007362174932485033, "entropy": 0.362420710362494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.847763766037921, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0824113495647907, "policy_loss": -0.007784267793370722, "vf_loss": 1.089999000200381, "vf_explained_var": 0.9780155022939047, "kl": 0.013981765417095206, "entropy": 0.6015999563038349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.4, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6440, "policy_reward_min": {"prey_policy": -53.609999902937986, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 53.609999902937986}, "policy_reward_mean": {"prey_policy": -24.6855431776464, "predator_policy": 24.6855431776464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [33, 57, 80, 8, 142, 55, 52, 54, 83, 52, 1, 82, 62, 77, 37, 60, 72, 46, 47, 92, 95, 66, 77, 68, 71, 57, 63, 78, 44, 67, 34, 62, 82, 137, 42, 63, 59, 61, 69, 77, 63, 69, 60, 57, 126, 76, 45, 69, 84, 64, 81, 52, 99, 71, 60, 49, 85, 80, 115, 77, 74, 45, 49, 18, 29, 86, 25, 78, 52, 68, 21, 86, 76, 90, 61, 78, 95, 42, 55, 50, 86, 17, 39, 86, 57, 49, 43, 70, 44, 69, 51, 100, 52, 79, 49, 64, 65, 86, 91, 19], "policy_prey_policy_reward": [-5.895216306202175, -30.098214470199448, -37.390206355409155, -4.270934836943703, -28.860410752059572, -36.65908944602287, -27.552217568185394, -9.925803680356339, -21.332206358945847, -30.921429066233955, 0.0, -13.813300274178836, -16.449783915097154, -17.526043155239147, -20.18053522544495, -8.735508886982322, -23.49314236164878, -26.72743588488003, -18.535095694464253, -36.340777072316556, -36.08555764580549, -13.684926338189156, -24.722623305435107, -18.62509137277873, -27.920035186066503, -20.603710765750193, -29.569287898800418, -42.370336393016295, -22.90510895691372, -24.446250984572764, -18.958102245249126, -19.228039095357165, -40.10075310633029, -37.335474167502355, -14.139220507037853, -27.378366222853025, -10.41212091054018, -21.967459604384114, -20.038833696457523, -13.417146702211959, -25.002629393401293, -15.567271644115353, -39.20831504206098, -32.507480110489944, -34.32076714423196, -35.1088803751312, -20.452902762335224, -36.075422443871744, -28.22089442710591, -38.82814719160112, -27.615210381827094, -23.86678024632802, -50.261099913621834, -29.43410092665453, -24.400236777895813, -21.397925687105268, -35.581553746473645, -25.24698616341078, -29.86195875332772, -44.98196992844492, -30.739105102201684, -8.454243147512939, -24.443558028445672, -10.813596254769683, -15.215345129769137, -37.74417988632352, -16.99912979319199, -32.863301219402885, -27.918595333158127, -15.310716408549348, -4.184983233797055, -53.609999902937986, -24.000832292640283, -15.311788670983162, -10.868895854029123, -25.340515169913747, -18.988999657488204, -20.721913894588315, -26.196007147667643, -35.809453071451365, -26.282920865188633, -7.447433811592793, -24.554894376835282, -12.476739798001917, -16.530034070389977, -13.161336310333974, -9.972231431625767, -13.056748156558, -28.296606382415018, -13.92108670434885, -24.685883464094474, -46.434425155672976, -26.539526685912687, -45.10174436365047, -28.187305270073708, -46.747211621170564, -34.315661816233494, -38.60169588443522, -34.74099843726291, -5.408344484524551], "policy_predator_policy_reward": [5.895216306202175, 30.098214470199448, 37.390206355409155, 4.270934836943703, 28.860410752059572, 36.65908944602287, 27.552217568185394, 9.925803680356339, 21.332206358945847, 30.921429066233955, 0.0, 13.813300274178836, 16.449783915097154, 17.526043155239147, 20.18053522544495, 8.735508886982322, 23.49314236164878, 26.72743588488003, 18.535095694464253, 36.340777072316556, 36.08555764580549, 13.684926338189156, 24.722623305435107, 18.62509137277873, 27.920035186066503, 20.603710765750193, 29.569287898800418, 42.370336393016295, 22.90510895691372, 24.446250984572764, 18.958102245249126, 19.228039095357165, 40.10075310633029, 37.335474167502355, 14.139220507037853, 27.378366222853025, 10.41212091054018, 21.967459604384114, 20.038833696457523, 13.417146702211959, 25.002629393401293, 15.567271644115353, 39.20831504206098, 32.507480110489944, 34.32076714423196, 35.1088803751312, 20.452902762335224, 36.075422443871744, 28.22089442710591, 38.82814719160112, 27.615210381827094, 23.86678024632802, 50.261099913621834, 29.43410092665453, 24.400236777895813, 21.397925687105268, 35.581553746473645, 25.24698616341078, 29.86195875332772, 44.98196992844492, 30.739105102201684, 8.454243147512939, 24.443558028445672, 10.813596254769683, 15.215345129769137, 37.74417988632352, 16.99912979319199, 32.863301219402885, 27.918595333158127, 15.310716408549348, 4.184983233797055, 53.609999902937986, 24.000832292640283, 15.311788670983162, 10.868895854029123, 25.340515169913747, 18.988999657488204, 20.721913894588315, 26.196007147667643, 35.809453071451365, 26.282920865188633, 7.447433811592793, 24.554894376835282, 12.476739798001917, 16.530034070389977, 13.161336310333974, 9.972231431625767, 13.056748156558, 28.296606382415018, 13.92108670434885, 24.685883464094474, 46.434425155672976, 26.539526685912687, 45.10174436365047, 28.187305270073708, 46.747211621170564, 34.315661816233494, 38.60169588443522, 34.74099843726291, 5.408344484524551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2931786049596725, "mean_inference_ms": 0.9394615289565637, "mean_action_processing_ms": 0.125285508101061, "mean_env_wait_ms": 0.06610567782505364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026617050170898438, "StateBufferConnector_ms": 0.0019849538803100586, "ViewRequirementAgentConnector_ms": 0.046808838844299316}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 645.1751293169734, "num_env_steps_trained_throughput_per_sec": 645.1751293169734, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 6016.243, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6016.185, "sample_time_ms": 688.23, "learn_time_ms": 5312.172, "learn_throughput": 752.988, "synch_weights_time_ms": 15.23}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 116, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-23", "timestamp": 1723390943, "time_this_iter_s": 6.20603084564209, "time_total_s": 687.3754632472992, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 687.3754632472992, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 43.86666666666667, "ram_util_percent": 83.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.107044635961453, "cur_kl_coeff": 4.470348358154296e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.632626011253645, "policy_loss": -0.0024684049174538815, "vf_loss": 1.6350944170107444, "vf_explained_var": 0.9637209789827466, "kl": 0.005369050629384667, "entropy": 0.3586551501105229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.415822164465984, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6557657034446795, "policy_loss": -0.004904809402069077, "vf_loss": 1.6605243368074298, "vf_explained_var": 0.9623320293302338, "kl": 0.010394802517207561, "entropy": 0.6180361647158861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.32, "episode_media": {}, "episodes_this_iter": 67, "episodes_timesteps_total": 6132, "policy_reward_min": {"prey_policy": -58.03358902253467, "predator_policy": 2.359509939730745}, "policy_reward_max": {"prey_policy": -2.359509939730745, "predator_policy": 58.03358902253467}, "policy_reward_mean": {"prey_policy": -24.989599943174525, "predator_policy": 24.989599943174525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [78, 52, 68, 21, 86, 76, 90, 61, 78, 95, 42, 55, 50, 86, 17, 39, 86, 57, 49, 43, 70, 44, 69, 51, 100, 52, 79, 49, 64, 65, 86, 91, 19, 87, 72, 39, 82, 18, 68, 23, 84, 70, 60, 73, 94, 37, 93, 49, 59, 78, 88, 98, 73, 80, 38, 46, 69, 78, 66, 71, 44, 50, 84, 76, 32, 60, 88, 69, 24, 62, 79, 19, 52, 74, 53, 85, 84, 54, 24, 59, 75, 33, 27, 30, 56, 72, 39, 62, 55, 53, 47, 84, 69, 72, 21, 84, 39, 82, 51, 48], "policy_prey_policy_reward": [-32.863301219402885, -27.918595333158127, -15.310716408549348, -4.184983233797055, -53.609999902937986, -24.000832292640283, -15.311788670983162, -10.868895854029123, -25.340515169913747, -18.988999657488204, -20.721913894588315, -26.196007147667643, -35.809453071451365, -26.282920865188633, -7.447433811592793, -24.554894376835282, -12.476739798001917, -16.530034070389977, -13.161336310333974, -9.972231431625767, -13.056748156558, -28.296606382415018, -13.92108670434885, -24.685883464094474, -46.434425155672976, -26.539526685912687, -45.10174436365047, -28.187305270073708, -46.747211621170564, -34.315661816233494, -38.60169588443522, -34.74099843726291, -5.408344484524551, -43.53700394961672, -18.256331697645795, -9.967062847651977, -25.067382262486703, -9.13892181439541, -18.148805149494322, -10.023715462586496, -27.21172034731594, -39.481498289543374, -19.889163978745948, -26.58311925390445, -27.636411446330158, -32.58493396176979, -58.03358902253467, -34.86154693894959, -30.229152114003362, -24.319951384899007, -47.86980413313893, -57.38336964677715, -26.06932828303981, -27.0483641797615, -13.149286629228879, -20.185328202900436, -38.0961105768196, -14.508744537402777, -31.016471107532784, -48.768763634409275, -37.59574568548473, -35.76294405619184, -18.328095847023395, -32.781695964169636, -4.135002394899322, -32.602976151160945, -23.996982984010327, -13.118828629574606, -19.666716410269196, -10.847011917278143, -34.63405587335062, -9.744676464114233, -27.21667543763705, -24.228144961766674, -31.12005410105716, -28.40652727512347, -31.412607013495247, -30.186692931854918, -12.607576395190737, -29.226359461995195, -39.67501805328457, -17.928483282724585, -2.359509939730745, -10.823796166543517, -20.190916342411704, -44.85383322814918, -13.930572695126845, -23.90669255966382, -33.14135002713986, -38.170670696202905, -13.031699280124492, -23.512058707684087, -26.327066957125748, -33.6625972632774, -9.331604240932966, -24.092938481950704, -5.764669295982415, -25.700536535384984, -13.413325374405149, -4.868573434146081], "policy_predator_policy_reward": [32.863301219402885, 27.918595333158127, 15.310716408549348, 4.184983233797055, 53.609999902937986, 24.000832292640283, 15.311788670983162, 10.868895854029123, 25.340515169913747, 18.988999657488204, 20.721913894588315, 26.196007147667643, 35.809453071451365, 26.282920865188633, 7.447433811592793, 24.554894376835282, 12.476739798001917, 16.530034070389977, 13.161336310333974, 9.972231431625767, 13.056748156558, 28.296606382415018, 13.92108670434885, 24.685883464094474, 46.434425155672976, 26.539526685912687, 45.10174436365047, 28.187305270073708, 46.747211621170564, 34.315661816233494, 38.60169588443522, 34.74099843726291, 5.408344484524551, 43.53700394961672, 18.256331697645795, 9.967062847651977, 25.067382262486703, 9.13892181439541, 18.148805149494322, 10.023715462586496, 27.21172034731594, 39.481498289543374, 19.889163978745948, 26.58311925390445, 27.636411446330158, 32.58493396176979, 58.03358902253467, 34.86154693894959, 30.229152114003362, 24.319951384899007, 47.86980413313893, 57.38336964677715, 26.06932828303981, 27.0483641797615, 13.149286629228879, 20.185328202900436, 38.0961105768196, 14.508744537402777, 31.016471107532784, 48.768763634409275, 37.59574568548473, 35.76294405619184, 18.328095847023395, 32.781695964169636, 4.135002394899322, 32.602976151160945, 23.996982984010327, 13.118828629574606, 19.666716410269196, 10.847011917278143, 34.63405587335062, 9.744676464114233, 27.21667543763705, 24.228144961766674, 31.12005410105716, 28.40652727512347, 31.412607013495247, 30.186692931854918, 12.607576395190737, 29.226359461995195, 39.67501805328457, 17.928483282724585, 2.359509939730745, 10.823796166543517, 20.190916342411704, 44.85383322814918, 13.930572695126845, 23.90669255966382, 33.14135002713986, 38.170670696202905, 13.031699280124492, 23.512058707684087, 26.327066957125748, 33.6625972632774, 9.331604240932966, 24.092938481950704, 5.764669295982415, 25.700536535384984, 13.413325374405149, 4.868573434146081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29342353222263884, "mean_inference_ms": 0.940013870772543, "mean_action_processing_ms": 0.12558598682432023, "mean_env_wait_ms": 0.06618056441677682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031195878982543945, "StateBufferConnector_ms": 0.0020720958709716797, "ViewRequirementAgentConnector_ms": 0.05019736289978027}, "num_episodes": 67, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 624.0810341883162, "num_env_steps_trained_throughput_per_sec": 624.0810341883162, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 6027.522, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6027.454, "sample_time_ms": 677.619, "learn_time_ms": 5333.119, "learn_throughput": 750.03, "synch_weights_time_ms": 16.097}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 117, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-30", "timestamp": 1723390950, "time_this_iter_s": 6.451398849487305, "time_total_s": 693.8268620967865, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b139d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 693.8268620967865, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 47.04444444444445, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1280582336088023, "cur_kl_coeff": 4.470348358154296e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3230391456745565, "policy_loss": -0.0039542299084132536, "vf_loss": 1.326993372415503, "vf_explained_var": 0.973663198389113, "kl": 0.00795712755217779, "entropy": 0.3916092371257643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2509545393288137, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3374607407177488, "policy_loss": -0.008800065991817974, "vf_loss": 1.3461195924008886, "vf_explained_var": 0.9730631132299702, "kl": 0.01004207630261373, "entropy": 0.5968440708393852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.15, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6115, "policy_reward_min": {"prey_policy": -51.17740611890649, "predator_policy": 2.359509939730745}, "policy_reward_max": {"prey_policy": -2.359509939730745, "predator_policy": 51.17740611890649}, "policy_reward_mean": {"prey_policy": -24.713725306049874, "predator_policy": 24.713725306049874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [76, 32, 60, 88, 69, 24, 62, 79, 19, 52, 74, 53, 85, 84, 54, 24, 59, 75, 33, 27, 30, 56, 72, 39, 62, 55, 53, 47, 84, 69, 72, 21, 84, 39, 82, 51, 48, 45, 62, 36, 61, 78, 95, 59, 17, 49, 79, 70, 56, 42, 85, 45, 54, 87, 77, 83, 77, 70, 72, 73, 85, 35, 84, 67, 71, 43, 60, 92, 71, 46, 64, 46, 59, 16, 75, 44, 80, 77, 36, 74, 69, 35, 54, 87, 70, 47, 82, 78, 94, 61, 97, 64, 79, 42, 47, 57, 51, 58, 66, 87], "policy_prey_policy_reward": [-32.781695964169636, -4.135002394899322, -32.602976151160945, -23.996982984010327, -13.118828629574606, -19.666716410269196, -10.847011917278143, -34.63405587335062, -9.744676464114233, -27.21667543763705, -24.228144961766674, -31.12005410105716, -28.40652727512347, -31.412607013495247, -30.186692931854918, -12.607576395190737, -29.226359461995195, -39.67501805328457, -17.928483282724585, -2.359509939730745, -10.823796166543517, -20.190916342411704, -44.85383322814918, -13.930572695126845, -23.90669255966382, -33.14135002713986, -38.170670696202905, -13.031699280124492, -23.512058707684087, -26.327066957125748, -33.6625972632774, -9.331604240932966, -24.092938481950704, -5.764669295982415, -25.700536535384984, -13.413325374405149, -4.868573434146081, -35.141235998546414, -20.98685499333599, -22.51970943244273, -20.610699934151743, -35.4369500649186, -17.021181794000686, -36.88169694741807, -8.741410025589287, -18.49176552250465, -40.73437188638918, -17.40964757638044, -15.988907095836323, -17.683812007270184, -35.970809007244014, -9.703967945518519, -25.605503364663054, -28.775123531170944, -21.186703942270885, -32.74614121610352, -36.06214640318249, -26.61921928861109, -32.85786320214727, -41.21017965599595, -41.02033221821622, -10.258811630311111, -26.758603113929027, -21.54700555037643, -35.62095183010168, -11.551862728341964, -24.730309805501953, -24.94440559396388, -13.804624625891883, -12.770942281034678, -36.75988177020417, -23.306623039715898, -26.45866602775903, -15.09681282362924, -45.28324310874226, -9.635636401972137, -27.658011582184848, -51.17740611890649, -13.869089117324526, -22.5003088981853, -30.700884046682084, -7.493116398491524, -8.611332646359037, -39.537760894461336, -36.3714911216025, -2.5607413858994104, -40.10763081292628, -50.35150629365437, -49.34090732841961, -22.68120125965056, -49.10737693225872, -22.16743148252252, -27.980140107177327, -12.249770985185268, -22.13422213739011, -19.3243998954639, -20.640726959622395, -29.65236337517545, -37.25099601045999, -29.350604500660943], "policy_predator_policy_reward": [32.781695964169636, 4.135002394899322, 32.602976151160945, 23.996982984010327, 13.118828629574606, 19.666716410269196, 10.847011917278143, 34.63405587335062, 9.744676464114233, 27.21667543763705, 24.228144961766674, 31.12005410105716, 28.40652727512347, 31.412607013495247, 30.186692931854918, 12.607576395190737, 29.226359461995195, 39.67501805328457, 17.928483282724585, 2.359509939730745, 10.823796166543517, 20.190916342411704, 44.85383322814918, 13.930572695126845, 23.90669255966382, 33.14135002713986, 38.170670696202905, 13.031699280124492, 23.512058707684087, 26.327066957125748, 33.6625972632774, 9.331604240932966, 24.092938481950704, 5.764669295982415, 25.700536535384984, 13.413325374405149, 4.868573434146081, 35.141235998546414, 20.98685499333599, 22.51970943244273, 20.610699934151743, 35.4369500649186, 17.021181794000686, 36.88169694741807, 8.741410025589287, 18.49176552250465, 40.73437188638918, 17.40964757638044, 15.988907095836323, 17.683812007270184, 35.970809007244014, 9.703967945518519, 25.605503364663054, 28.775123531170944, 21.186703942270885, 32.74614121610352, 36.06214640318249, 26.61921928861109, 32.85786320214727, 41.21017965599595, 41.02033221821622, 10.258811630311111, 26.758603113929027, 21.54700555037643, 35.62095183010168, 11.551862728341964, 24.730309805501953, 24.94440559396388, 13.804624625891883, 12.770942281034678, 36.75988177020417, 23.306623039715898, 26.45866602775903, 15.09681282362924, 45.28324310874226, 9.635636401972137, 27.658011582184848, 51.17740611890649, 13.869089117324526, 22.5003088981853, 30.700884046682084, 7.493116398491524, 8.611332646359037, 39.537760894461336, 36.3714911216025, 2.5607413858994104, 40.10763081292628, 50.35150629365437, 49.34090732841961, 22.68120125965056, 49.10737693225872, 22.16743148252252, 27.980140107177327, 12.249770985185268, 22.13422213739011, 19.3243998954639, 20.640726959622395, 29.65236337517545, 37.25099601045999, 29.350604500660943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29377997554610635, "mean_inference_ms": 0.9405047763555315, "mean_action_processing_ms": 0.12566967073388288, "mean_env_wait_ms": 0.0662437551321429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035893917083740234, "StateBufferConnector_ms": 0.002232670783996582, "ViewRequirementAgentConnector_ms": 0.05978822708129883}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 611.211077827732, "num_env_steps_trained_throughput_per_sec": 611.211077827732, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 6068.87, "restore_workers_time_ms": 0.012, "training_step_time_ms": 6068.802, "sample_time_ms": 680.32, "learn_time_ms": 5371.851, "learn_throughput": 744.622, "synch_weights_time_ms": 16.005}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 118, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-36", "timestamp": 1723390956, "time_this_iter_s": 6.551819801330566, "time_total_s": 700.3786818981171, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 700.3786818981171, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 47.489999999999995, "ram_util_percent": 83.41999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9686919750645755, "cur_kl_coeff": 4.470348358154296e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1572065472913284, "policy_loss": -0.0001403249509166926, "vf_loss": 1.1573468757793308, "vf_explained_var": 0.9768612930551172, "kl": 0.0036707401520183814, "entropy": 0.3488160030916333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1340549239267905, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.184741849762698, "policy_loss": -0.006883429024310317, "vf_loss": 1.191472796568026, "vf_explained_var": 0.9757445376987258, "kl": 0.010843630795512326, "entropy": 0.5895986040433248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.0, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 6600, "policy_reward_min": {"prey_policy": -57.73767220684974, "predator_policy": 2.5607413858994104}, "policy_reward_max": {"prey_policy": -2.5607413858994104, "predator_policy": 57.73767220684974}, "policy_reward_mean": {"prey_policy": -26.50897106417609, "predator_policy": 26.50897106417609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [72, 73, 85, 35, 84, 67, 71, 43, 60, 92, 71, 46, 64, 46, 59, 16, 75, 44, 80, 77, 36, 74, 69, 35, 54, 87, 70, 47, 82, 78, 94, 61, 97, 64, 79, 42, 47, 57, 51, 58, 66, 87, 60, 87, 47, 51, 73, 69, 42, 151, 62, 54, 80, 122, 50, 70, 60, 73, 88, 69, 98, 55, 70, 51, 38, 79, 47, 19, 64, 47, 44, 58, 54, 77, 68, 60, 38, 95, 17, 85, 81, 57, 92, 68, 81, 58, 68, 79, 63, 55, 35, 96, 85, 94, 57, 69, 94, 44, 87, 70], "policy_prey_policy_reward": [-32.85786320214727, -41.21017965599595, -41.02033221821622, -10.258811630311111, -26.758603113929027, -21.54700555037643, -35.62095183010168, -11.551862728341964, -24.730309805501953, -24.94440559396388, -13.804624625891883, -12.770942281034678, -36.75988177020417, -23.306623039715898, -26.45866602775903, -15.09681282362924, -45.28324310874226, -9.635636401972137, -27.658011582184848, -51.17740611890649, -13.869089117324526, -22.5003088981853, -30.700884046682084, -7.493116398491524, -8.611332646359037, -39.537760894461336, -36.3714911216025, -2.5607413858994104, -40.10763081292628, -50.35150629365437, -49.34090732841961, -22.68120125965056, -49.10737693225872, -22.16743148252252, -27.980140107177327, -12.249770985185268, -22.13422213739011, -19.3243998954639, -20.640726959622395, -29.65236337517545, -37.25099601045999, -29.350604500660943, -13.643368001195359, -51.04488806278502, -25.92663190913063, -20.253855191294793, -35.53781359616707, -28.79519212833006, -17.176876269148767, -54.12987146377814, -4.6465868788648255, -27.30750980817267, -18.44939521639398, -22.71789498310081, -13.660042650916912, -17.193400724340105, -15.708590956461157, -14.378608439670634, -22.59145826350328, -24.03397621193061, -46.611827005078396, -15.393302150511397, -38.57702108778857, -45.44065195159262, -16.179700661384338, -32.710869966189, -10.143625422499358, -6.8555101673328, -26.475337315316196, -25.37775922333961, -19.624297790593268, -34.40572035851537, -21.008823434175454, -20.31196914376821, -25.133542098254594, -27.33357110694898, -19.288483744413938, -42.653684313473384, -3.8783937961015518, -23.420266936848286, -42.83492708751102, -25.936925391684028, -16.4307297357423, -34.46801454350735, -39.241651721308564, -22.693354373327885, -19.76451431515014, -8.578997723879938, -36.02691635346618, -37.2957792763037, -13.168288432352805, -46.980522249826734, -47.78238021797952, -13.17201726703186, -24.184884034097763, -37.88239483338327, -57.73767220684974, -21.789783481776528, -33.79206602394769, -16.678793020671826], "policy_predator_policy_reward": [32.85786320214727, 41.21017965599595, 41.02033221821622, 10.258811630311111, 26.758603113929027, 21.54700555037643, 35.62095183010168, 11.551862728341964, 24.730309805501953, 24.94440559396388, 13.804624625891883, 12.770942281034678, 36.75988177020417, 23.306623039715898, 26.45866602775903, 15.09681282362924, 45.28324310874226, 9.635636401972137, 27.658011582184848, 51.17740611890649, 13.869089117324526, 22.5003088981853, 30.700884046682084, 7.493116398491524, 8.611332646359037, 39.537760894461336, 36.3714911216025, 2.5607413858994104, 40.10763081292628, 50.35150629365437, 49.34090732841961, 22.68120125965056, 49.10737693225872, 22.16743148252252, 27.980140107177327, 12.249770985185268, 22.13422213739011, 19.3243998954639, 20.640726959622395, 29.65236337517545, 37.25099601045999, 29.350604500660943, 13.643368001195359, 51.04488806278502, 25.92663190913063, 20.253855191294793, 35.53781359616707, 28.79519212833006, 17.176876269148767, 54.12987146377814, 4.6465868788648255, 27.30750980817267, 18.44939521639398, 22.71789498310081, 13.660042650916912, 17.193400724340105, 15.708590956461157, 14.378608439670634, 22.59145826350328, 24.03397621193061, 46.611827005078396, 15.393302150511397, 38.57702108778857, 45.44065195159262, 16.179700661384338, 32.710869966189, 10.143625422499358, 6.8555101673328, 26.475337315316196, 25.37775922333961, 19.624297790593268, 34.40572035851537, 21.008823434175454, 20.31196914376821, 25.133542098254594, 27.33357110694898, 19.288483744413938, 42.653684313473384, 3.8783937961015518, 23.420266936848286, 42.83492708751102, 25.936925391684028, 16.4307297357423, 34.46801454350735, 39.241651721308564, 22.693354373327885, 19.76451431515014, 8.578997723879938, 36.02691635346618, 37.2957792763037, 13.168288432352805, 46.980522249826734, 47.78238021797952, 13.17201726703186, 24.184884034097763, 37.88239483338327, 57.73767220684974, 21.789783481776528, 33.79206602394769, 16.678793020671826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2935784409251617, "mean_inference_ms": 0.9407864035483491, "mean_action_processing_ms": 0.1254994380632179, "mean_env_wait_ms": 0.06632427059955148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030231475830078125, "StateBufferConnector_ms": 0.00222933292388916, "ViewRequirementAgentConnector_ms": 0.05580472946166992}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 665.2839840167353, "num_env_steps_trained_throughput_per_sec": 665.2839840167353, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 6085.673, "restore_workers_time_ms": 0.012, "training_step_time_ms": 6085.605, "sample_time_ms": 683.339, "learn_time_ms": 5385.518, "learn_throughput": 742.733, "synch_weights_time_ms": 16.128}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "training_iteration": 119, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-43", "timestamp": 1723390963, "time_this_iter_s": 6.01771092414856, "time_total_s": 706.3963928222656, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cdca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 706.3963928222656, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 41.5375, "ram_util_percent": 83.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.037082664979001, "cur_kl_coeff": 2.235174179077148e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3048632568058869, "policy_loss": -0.0016890376233883824, "vf_loss": 1.3065522951384385, "vf_explained_var": 0.9765786031881968, "kl": 0.004355760318723526, "entropy": 0.35407530538116894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1128975547850133, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3019084281598527, "policy_loss": -0.010863285581581294, "vf_loss": 1.3125674169510604, "vf_explained_var": 0.9764731816326578, "kl": 0.014528078720908572, "entropy": 0.5528864525258541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.79, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6379, "policy_reward_min": {"prey_policy": -61.25595602392412, "predator_policy": -0.000735895337555359}, "policy_reward_max": {"prey_policy": 0.000735895337555359, "predator_policy": 61.25595602392412}, "policy_reward_mean": {"prey_policy": -26.839029379751754, "predator_policy": 26.839029379751754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [55, 70, 51, 38, 79, 47, 19, 64, 47, 44, 58, 54, 77, 68, 60, 38, 95, 17, 85, 81, 57, 92, 68, 81, 58, 68, 79, 63, 55, 35, 96, 85, 94, 57, 69, 94, 44, 87, 70, 64, 55, 136, 84, 78, 84, 29, 50, 80, 83, 61, 59, 80, 84, 28, 64, 51, 75, 85, 102, 23, 37, 72, 49, 42, 64, 76, 52, 81, 69, 67, 26, 26, 66, 69, 72, 34, 30, 52, 64, 68, 93, 55, 119, 68, 65, 86, 38, 95, 86, 69, 27, 57, 53, 78, 96, 1, 19, 74, 67, 63], "policy_prey_policy_reward": [-15.393302150511397, -38.57702108778857, -45.44065195159262, -16.179700661384338, -32.710869966189, -10.143625422499358, -6.8555101673328, -26.475337315316196, -25.37775922333961, -19.624297790593268, -34.40572035851537, -21.008823434175454, -20.31196914376821, -25.133542098254594, -27.33357110694898, -19.288483744413938, -42.653684313473384, -3.8783937961015518, -23.420266936848286, -42.83492708751102, -25.936925391684028, -16.4307297357423, -34.46801454350735, -39.241651721308564, -22.693354373327885, -19.76451431515014, -8.578997723879938, -36.02691635346618, -37.2957792763037, -13.168288432352805, -46.980522249826734, -47.78238021797952, -13.17201726703186, -24.184884034097763, -37.88239483338327, -57.73767220684974, -21.789783481776528, -33.79206602394769, -16.678793020671826, -37.18798620076044, -32.326977907570324, -29.50180949601292, -49.38480224385343, -30.75070042040611, -29.227514246424825, -6.122508137788341, -47.47326299863448, -48.19246358496824, -26.86943036446022, -13.040208128503268, -39.431154366791894, -33.98471992961011, -11.871925434108695, -16.716383250969077, -39.943293424803095, -35.373814635816515, -35.12295717279115, -39.523127455038875, -25.359978978445085, -6.3280272735825545, -25.586947516751533, -19.804401004041043, -24.917020895575636, -15.216238303429403, -18.99590879170849, -44.757890480989836, -29.530965634951652, -36.830051013267976, -15.6164973743496, -21.1642589171, 0.000735895337555359, -13.46559461045303, -33.56179488492936, -44.20248686767406, -38.26050162302843, -6.0080776992748595, -18.575149787897413, -20.662975770509874, -13.601033449070124, -19.09093389385163, -30.369117480479847, -26.955591150403873, -41.16212774028456, -46.222791451881385, -32.95467542459744, -28.607174695337182, -18.515746218097757, -61.25595602392412, -13.264391621790622, -29.412617169331924, -16.03807581793073, -10.737920852919899, -20.16961619753646, -14.316965964141458, -49.06273699513425, -1.3623606825619756, -6.6655217147937735, -34.57944851255288, -40.250294754962425, -17.76562627281161], "policy_predator_policy_reward": [15.393302150511397, 38.57702108778857, 45.44065195159262, 16.179700661384338, 32.710869966189, 10.143625422499358, 6.8555101673328, 26.475337315316196, 25.37775922333961, 19.624297790593268, 34.40572035851537, 21.008823434175454, 20.31196914376821, 25.133542098254594, 27.33357110694898, 19.288483744413938, 42.653684313473384, 3.8783937961015518, 23.420266936848286, 42.83492708751102, 25.936925391684028, 16.4307297357423, 34.46801454350735, 39.241651721308564, 22.693354373327885, 19.76451431515014, 8.578997723879938, 36.02691635346618, 37.2957792763037, 13.168288432352805, 46.980522249826734, 47.78238021797952, 13.17201726703186, 24.184884034097763, 37.88239483338327, 57.73767220684974, 21.789783481776528, 33.79206602394769, 16.678793020671826, 37.18798620076044, 32.326977907570324, 29.50180949601292, 49.38480224385343, 30.75070042040611, 29.227514246424825, 6.122508137788341, 47.47326299863448, 48.19246358496824, 26.86943036446022, 13.040208128503268, 39.431154366791894, 33.98471992961011, 11.871925434108695, 16.716383250969077, 39.943293424803095, 35.373814635816515, 35.12295717279115, 39.523127455038875, 25.359978978445085, 6.3280272735825545, 25.586947516751533, 19.804401004041043, 24.917020895575636, 15.216238303429403, 18.99590879170849, 44.757890480989836, 29.530965634951652, 36.830051013267976, 15.6164973743496, 21.1642589171, -0.000735895337555359, 13.46559461045303, 33.56179488492936, 44.20248686767406, 38.26050162302843, 6.0080776992748595, 18.575149787897413, 20.662975770509874, 13.601033449070124, 19.09093389385163, 30.369117480479847, 26.955591150403873, 41.16212774028456, 46.222791451881385, 32.95467542459744, 28.607174695337182, 18.515746218097757, 61.25595602392412, 13.264391621790622, 29.412617169331924, 16.03807581793073, 10.737920852919899, 20.16961619753646, 14.316965964141458, 49.06273699513425, 1.3623606825619756, 6.6655217147937735, 34.57944851255288, 40.250294754962425, 17.76562627281161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29355797563252917, "mean_inference_ms": 0.9402288037429082, "mean_action_processing_ms": 0.12538895133169758, "mean_env_wait_ms": 0.066307945939287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028094053268432617, "StateBufferConnector_ms": 0.002154707908630371, "ViewRequirementAgentConnector_ms": 0.048265933990478516}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 688.7371153382741, "num_env_steps_trained_throughput_per_sec": 688.7371153382741, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 6092.699, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6092.63, "sample_time_ms": 685.705, "learn_time_ms": 5390.197, "learn_throughput": 742.088, "synch_weights_time_ms": 16.106}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 120, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-48", "timestamp": 1723390968, "time_this_iter_s": 5.813288927078247, "time_total_s": 712.2096817493439, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e2af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 712.2096817493439, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 41.724999999999994, "ram_util_percent": 83.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0508433868487677, "cur_kl_coeff": 1.117587089538574e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1529451714207728, "policy_loss": -0.003856189526656332, "vf_loss": 1.1568013559716444, "vf_explained_var": 0.9803660514454047, "kl": 0.006569709540594259, "entropy": 0.353588388611873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0629591210434834, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1770067194476723, "policy_loss": -0.006618960219202563, "vf_loss": 1.1834954009701808, "vf_explained_var": 0.9799045037478209, "kl": 0.009264176855549285, "entropy": 0.5464592548087239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 59.2, "episode_media": {}, "episodes_this_iter": 69, "episodes_timesteps_total": 5920, "policy_reward_min": {"prey_policy": -61.25595602392412, "predator_policy": -0.000735895337555359}, "policy_reward_max": {"prey_policy": 0.000735895337555359, "predator_policy": 61.25595602392412}, "policy_reward_mean": {"prey_policy": -24.96062813169168, "predator_policy": 24.96062813169168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [67, 26, 26, 66, 69, 72, 34, 30, 52, 64, 68, 93, 55, 119, 68, 65, 86, 38, 95, 86, 69, 27, 57, 53, 78, 96, 1, 19, 74, 67, 63, 50, 57, 81, 47, 88, 86, 53, 36, 10, 73, 47, 56, 87, 56, 9, 42, 51, 46, 16, 55, 57, 46, 74, 40, 55, 143, 71, 80, 54, 42, 19, 42, 59, 11, 87, 22, 9, 48, 69, 31, 33, 63, 64, 58, 76, 88, 57, 64, 80, 97, 81, 134, 61, 47, 131, 86, 89, 48, 48, 53, 48, 28, 56, 40, 36, 82, 79, 42, 63], "policy_prey_policy_reward": [-21.1642589171, 0.000735895337555359, -13.46559461045303, -33.56179488492936, -44.20248686767406, -38.26050162302843, -6.0080776992748595, -18.575149787897413, -20.662975770509874, -13.601033449070124, -19.09093389385163, -30.369117480479847, -26.955591150403873, -41.16212774028456, -46.222791451881385, -32.95467542459744, -28.607174695337182, -18.515746218097757, -61.25595602392412, -13.264391621790622, -29.412617169331924, -16.03807581793073, -10.737920852919899, -20.16961619753646, -14.316965964141458, -49.06273699513425, -1.3623606825619756, -6.6655217147937735, -34.57944851255288, -40.250294754962425, -17.76562627281161, -39.39265954353589, -15.740083355079102, -36.42923555074537, -14.916764737015134, -52.74467902648631, -33.852150032169185, -22.56322373600348, -20.657281874862736, -4.839553097462762, -24.092760184548318, -29.39952410883264, -24.1285347561014, -19.09202861571918, -36.71641189754501, -2.6487931323029223, -11.129237154719542, -15.93938513591537, -8.412323464763078, -8.910786667837781, -27.50589561395053, -23.10296954945953, -13.318228472217859, -18.266697840499166, -7.248466102519187, -27.590878881349006, -26.735866785446625, -39.59383770833435, -52.763939637966985, -23.07840494655765, -10.515394522392842, -11.30622430345519, -22.697945645170797, -34.05250042411461, -7.949902655159866, -46.5551453078327, -6.498831750937308, -4.136064871582295, -9.250000530871858, -35.99567234699872, -25.487555140958982, -10.857749316507556, -18.08655607748111, -42.42495291312449, -21.403395168999186, -35.332733262266615, -53.79383951899571, -28.082798598835254, -40.479116703433775, -33.5008605761154, -47.424692386215725, -27.908236328359116, -17.636336217943068, -21.72905791931231, -11.059705960399446, -45.27108435285911, -45.201852845147734, -31.907391578283942, -16.834328373096767, -30.462057499784628, -12.034361014763363, -16.5058680360226, -23.634775056178203, -25.085670380201815, -20.9477051854693, -4.9317688913143884, -31.153900981883268, -52.836131222497144, -20.02016463849471, -45.99905470583534], "policy_predator_policy_reward": [21.1642589171, -0.000735895337555359, 13.46559461045303, 33.56179488492936, 44.20248686767406, 38.26050162302843, 6.0080776992748595, 18.575149787897413, 20.662975770509874, 13.601033449070124, 19.09093389385163, 30.369117480479847, 26.955591150403873, 41.16212774028456, 46.222791451881385, 32.95467542459744, 28.607174695337182, 18.515746218097757, 61.25595602392412, 13.264391621790622, 29.412617169331924, 16.03807581793073, 10.737920852919899, 20.16961619753646, 14.316965964141458, 49.06273699513425, 1.3623606825619756, 6.6655217147937735, 34.57944851255288, 40.250294754962425, 17.76562627281161, 39.39265954353589, 15.740083355079102, 36.42923555074537, 14.916764737015134, 52.74467902648631, 33.852150032169185, 22.56322373600348, 20.657281874862736, 4.839553097462762, 24.092760184548318, 29.39952410883264, 24.1285347561014, 19.09202861571918, 36.71641189754501, 2.6487931323029223, 11.129237154719542, 15.93938513591537, 8.412323464763078, 8.910786667837781, 27.50589561395053, 23.10296954945953, 13.318228472217859, 18.266697840499166, 7.248466102519187, 27.590878881349006, 26.735866785446625, 39.59383770833435, 52.763939637966985, 23.07840494655765, 10.515394522392842, 11.30622430345519, 22.697945645170797, 34.05250042411461, 7.949902655159866, 46.5551453078327, 6.498831750937308, 4.136064871582295, 9.250000530871858, 35.99567234699872, 25.487555140958982, 10.857749316507556, 18.08655607748111, 42.42495291312449, 21.403395168999186, 35.332733262266615, 53.79383951899571, 28.082798598835254, 40.479116703433775, 33.5008605761154, 47.424692386215725, 27.908236328359116, 17.636336217943068, 21.72905791931231, 11.059705960399446, 45.27108435285911, 45.201852845147734, 31.907391578283942, 16.834328373096767, 30.462057499784628, 12.034361014763363, 16.5058680360226, 23.634775056178203, 25.085670380201815, 20.9477051854693, 4.9317688913143884, 31.153900981883268, 52.836131222497144, 20.02016463849471, 45.99905470583534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29390807414827036, "mean_inference_ms": 0.9394777049180738, "mean_action_processing_ms": 0.12532711866217625, "mean_env_wait_ms": 0.0661923355052697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030469894409179688, "StateBufferConnector_ms": 0.0021550655364990234, "ViewRequirementAgentConnector_ms": 0.048902034759521484}, "num_episodes": 69, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.4324272826174, "num_env_steps_trained_throughput_per_sec": 673.4324272826174, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 6095.126, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6095.057, "sample_time_ms": 680.043, "learn_time_ms": 5398.39, "learn_throughput": 740.962, "synch_weights_time_ms": 15.995}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "training_iteration": 121, "trial_id": "abfb9_00000", "date": "2024-08-11_11-42-54", "timestamp": 1723390974, "time_this_iter_s": 5.946457862854004, "time_total_s": 718.1561396121979, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e2e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 718.1561396121979, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 41.43333333333334, "ram_util_percent": 83.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.05442920550704, "cur_kl_coeff": 1.117587089538574e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3572152741719037, "policy_loss": -0.002294622190917532, "vf_loss": 1.3595098990326127, "vf_explained_var": 0.9723747645194332, "kl": 0.004009438265480251, "entropy": 0.33893712305774293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.243095198025306, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3672201214979092, "policy_loss": -0.007273800583304061, "vf_loss": 1.3743376026550929, "vf_explained_var": 0.9713749984900156, "kl": 0.011116071558475977, "entropy": 0.5216017076745629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.89, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6289, "policy_reward_min": {"prey_policy": -57.40699174590498, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 57.40699174590498}, "policy_reward_mean": {"prey_policy": -26.861297147319615, "predator_policy": 26.861297147319615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [42, 59, 11, 87, 22, 9, 48, 69, 31, 33, 63, 64, 58, 76, 88, 57, 64, 80, 97, 81, 134, 61, 47, 131, 86, 89, 48, 48, 53, 48, 28, 56, 40, 36, 82, 79, 42, 63, 95, 120, 79, 59, 70, 41, 38, 25, 87, 55, 82, 35, 72, 65, 94, 73, 80, 53, 40, 89, 58, 68, 37, 35, 97, 64, 82, 10, 66, 50, 46, 15, 68, 81, 78, 43, 62, 43, 66, 55, 140, 138, 17, 62, 91, 77, 55, 84, 43, 71, 51, 55, 54, 70, 1, 99, 82, 50, 85, 58, 72, 48], "policy_prey_policy_reward": [-22.697945645170797, -34.05250042411461, -7.949902655159866, -46.5551453078327, -6.498831750937308, -4.136064871582295, -9.250000530871858, -35.99567234699872, -25.487555140958982, -10.857749316507556, -18.08655607748111, -42.42495291312449, -21.403395168999186, -35.332733262266615, -53.79383951899571, -28.082798598835254, -40.479116703433775, -33.5008605761154, -47.424692386215725, -27.908236328359116, -17.636336217943068, -21.72905791931231, -11.059705960399446, -45.27108435285911, -45.201852845147734, -31.907391578283942, -16.834328373096767, -30.462057499784628, -12.034361014763363, -16.5058680360226, -23.634775056178203, -25.085670380201815, -20.9477051854693, -4.9317688913143884, -31.153900981883268, -52.836131222497144, -20.02016463849471, -45.99905470583534, -38.62442486889965, -39.37685742939149, -7.184009410086869, -26.045134597737885, -34.164289810667974, -8.21650239057222, -12.549260991496354, -11.228289661211832, -31.20753854069882, -25.008353083641236, -43.35191848545594, -25.065777829774692, -31.308954013515343, -37.24418433304537, -57.40699174590498, -27.80641855849325, -46.76665323612216, -28.151462436234745, -31.981454132330114, -41.00831372981639, -21.611901358323763, -19.780948039697165, -33.87323741877079, -18.721048663542955, -36.751537987656576, -22.583175394386277, -42.480096522058815, -2.243430322853124, -7.4379046969232245, -25.790678556553594, -14.609675454321707, -8.899873155724347, -23.028179572900864, -47.32888447019117, -30.279035522383943, -4.14075698076067, -28.119775148861727, -13.551322737308686, -33.79984453643131, -14.199758031675316, -27.394988359035654, -54.78141421507155, -4.726124545250595, -11.681293654937875, -36.52180455140388, -41.94025999623814, -32.86737434386871, -24.103972001272563, -21.746694146868702, -33.75808656430611, -20.512679342081853, -32.13619793622117, -31.770212944353577, -19.687255021759835, 0.0, -44.26674960371655, -42.417147927151824, -17.798529403851013, -29.436428661688737, -45.26633825588371, -8.408864607075508, -26.80968041005246], "policy_predator_policy_reward": [22.697945645170797, 34.05250042411461, 7.949902655159866, 46.5551453078327, 6.498831750937308, 4.136064871582295, 9.250000530871858, 35.99567234699872, 25.487555140958982, 10.857749316507556, 18.08655607748111, 42.42495291312449, 21.403395168999186, 35.332733262266615, 53.79383951899571, 28.082798598835254, 40.479116703433775, 33.5008605761154, 47.424692386215725, 27.908236328359116, 17.636336217943068, 21.72905791931231, 11.059705960399446, 45.27108435285911, 45.201852845147734, 31.907391578283942, 16.834328373096767, 30.462057499784628, 12.034361014763363, 16.5058680360226, 23.634775056178203, 25.085670380201815, 20.9477051854693, 4.9317688913143884, 31.153900981883268, 52.836131222497144, 20.02016463849471, 45.99905470583534, 38.62442486889965, 39.37685742939149, 7.184009410086869, 26.045134597737885, 34.164289810667974, 8.21650239057222, 12.549260991496354, 11.228289661211832, 31.20753854069882, 25.008353083641236, 43.35191848545594, 25.065777829774692, 31.308954013515343, 37.24418433304537, 57.40699174590498, 27.80641855849325, 46.76665323612216, 28.151462436234745, 31.981454132330114, 41.00831372981639, 21.611901358323763, 19.780948039697165, 33.87323741877079, 18.721048663542955, 36.751537987656576, 22.583175394386277, 42.480096522058815, 2.243430322853124, 7.4379046969232245, 25.790678556553594, 14.609675454321707, 8.899873155724347, 23.028179572900864, 47.32888447019117, 30.279035522383943, 4.14075698076067, 28.119775148861727, 13.551322737308686, 33.79984453643131, 14.199758031675316, 27.394988359035654, 54.78141421507155, 4.726124545250595, 11.681293654937875, 36.52180455140388, 41.94025999623814, 32.86737434386871, 24.103972001272563, 21.746694146868702, 33.75808656430611, 20.512679342081853, 32.13619793622117, 31.770212944353577, 19.687255021759835, 0.0, 44.26674960371655, 42.417147927151824, 17.798529403851013, 29.436428661688737, 45.26633825588371, 8.408864607075508, 26.80968041005246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2936332627311019, "mean_inference_ms": 0.9396567083956106, "mean_action_processing_ms": 0.12534612195278083, "mean_env_wait_ms": 0.06616563786871169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030143260955810547, "StateBufferConnector_ms": 0.0020638704299926758, "ViewRequirementAgentConnector_ms": 0.048955321311950684}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.667186443181, "num_env_steps_trained_throughput_per_sec": 683.667186443181, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 6098.112, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6098.041, "sample_time_ms": 678.586, "learn_time_ms": 5402.827, "learn_throughput": 740.353, "synch_weights_time_ms": 16.042}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 122, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-00", "timestamp": 1723390980, "time_this_iter_s": 5.856088876724243, "time_total_s": 724.0122284889221, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cd430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 724.0122284889221, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 82.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.918165962956846, "cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0769264477925995, "policy_loss": -0.000902755589534839, "vf_loss": 1.0778292045618096, "vf_explained_var": 0.9779955345516403, "kl": 0.0033816626692691667, "entropy": 0.3000339160207659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.965981885790825, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0350545981898904, "policy_loss": -0.006802234831169093, "vf_loss": 1.0417174994635086, "vf_explained_var": 0.9781271352122227, "kl": 0.009908038262445018, "entropy": 0.5318103379880389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.02, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6502, "policy_reward_min": {"prey_policy": -55.69907312761725, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 55.69907312761725}, "policy_reward_mean": {"prey_policy": -25.625220609111512, "predator_policy": 25.625220609111512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [97, 64, 82, 10, 66, 50, 46, 15, 68, 81, 78, 43, 62, 43, 66, 55, 140, 138, 17, 62, 91, 77, 55, 84, 43, 71, 51, 55, 54, 70, 1, 99, 82, 50, 85, 58, 72, 48, 66, 71, 112, 55, 40, 139, 74, 95, 120, 27, 75, 41, 74, 53, 83, 73, 51, 20, 76, 65, 78, 81, 47, 44, 49, 57, 78, 52, 53, 3, 43, 77, 35, 37, 40, 66, 89, 67, 86, 52, 47, 74, 99, 83, 43, 84, 63, 65, 64, 121, 58, 67, 51, 45, 73, 64, 88, 63, 70, 79, 92, 36], "policy_prey_policy_reward": [-36.751537987656576, -22.583175394386277, -42.480096522058815, -2.243430322853124, -7.4379046969232245, -25.790678556553594, -14.609675454321707, -8.899873155724347, -23.028179572900864, -47.32888447019117, -30.279035522383943, -4.14075698076067, -28.119775148861727, -13.551322737308686, -33.79984453643131, -14.199758031675316, -27.394988359035654, -54.78141421507155, -4.726124545250595, -11.681293654937875, -36.52180455140388, -41.94025999623814, -32.86737434386871, -24.103972001272563, -21.746694146868702, -33.75808656430611, -20.512679342081853, -32.13619793622117, -31.770212944353577, -19.687255021759835, 0.0, -44.26674960371655, -42.417147927151824, -17.798529403851013, -29.436428661688737, -45.26633825588371, -8.408864607075508, -26.80968041005246, -20.335776361847707, -33.41785121602072, -20.87819413467094, -29.854636012461288, -13.44273940596982, -35.30936790693326, -17.494033721696795, -19.8117047260624, -50.02857903139939, -17.799573272949836, -24.628801618893927, -14.479942927073036, -36.41285248104425, -19.259747951575655, -24.10786419829825, -33.51068732971034, -43.03199722525423, -9.976539160083165, -11.713528816851133, -17.826958749511167, -35.01285246410446, -24.240793334440514, -23.59840456933875, -29.90128443430989, -31.439297564709758, -22.427827904908295, -28.43612856379361, -22.77244464496925, -14.775000242337597, -2.5688477942532613, -23.791273525899733, -17.180535733244984, -20.54482664768916, -18.60737470875069, -18.80661744881954, -13.40904622289903, -52.09216082149422, -20.892769088047753, -48.52158934196331, -33.85942601905511, -29.31355654948595, -32.40299359525497, -18.91571166802646, -55.69907312761725, -19.41704689801392, -31.385138934615647, -19.856263259394108, -42.897939287354234, -7.491788080536496, -22.806612095834947, -27.428874062564166, -30.628184307455598, -23.86704429418697, -19.94379991842231, -37.963561056894505, -41.40106365162789, -22.605807542815917, -31.05194930845354, -21.02621910870658, -24.890246405734324, -35.92430987524059, -6.128974976497879], "policy_predator_policy_reward": [36.751537987656576, 22.583175394386277, 42.480096522058815, 2.243430322853124, 7.4379046969232245, 25.790678556553594, 14.609675454321707, 8.899873155724347, 23.028179572900864, 47.32888447019117, 30.279035522383943, 4.14075698076067, 28.119775148861727, 13.551322737308686, 33.79984453643131, 14.199758031675316, 27.394988359035654, 54.78141421507155, 4.726124545250595, 11.681293654937875, 36.52180455140388, 41.94025999623814, 32.86737434386871, 24.103972001272563, 21.746694146868702, 33.75808656430611, 20.512679342081853, 32.13619793622117, 31.770212944353577, 19.687255021759835, 0.0, 44.26674960371655, 42.417147927151824, 17.798529403851013, 29.436428661688737, 45.26633825588371, 8.408864607075508, 26.80968041005246, 20.335776361847707, 33.41785121602072, 20.87819413467094, 29.854636012461288, 13.44273940596982, 35.30936790693326, 17.494033721696795, 19.8117047260624, 50.02857903139939, 17.799573272949836, 24.628801618893927, 14.479942927073036, 36.41285248104425, 19.259747951575655, 24.10786419829825, 33.51068732971034, 43.03199722525423, 9.976539160083165, 11.713528816851133, 17.826958749511167, 35.01285246410446, 24.240793334440514, 23.59840456933875, 29.90128443430989, 31.439297564709758, 22.427827904908295, 28.43612856379361, 22.77244464496925, 14.775000242337597, 2.5688477942532613, 23.791273525899733, 17.180535733244984, 20.54482664768916, 18.60737470875069, 18.80661744881954, 13.40904622289903, 52.09216082149422, 20.892769088047753, 48.52158934196331, 33.85942601905511, 29.31355654948595, 32.40299359525497, 18.91571166802646, 55.69907312761725, 19.41704689801392, 31.385138934615647, 19.856263259394108, 42.897939287354234, 7.491788080536496, 22.806612095834947, 27.428874062564166, 30.628184307455598, 23.86704429418697, 19.94379991842231, 37.963561056894505, 41.40106365162789, 22.605807542815917, 31.05194930845354, 21.02621910870658, 24.890246405734324, 35.92430987524059, 6.128974976497879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2933622285423454, "mean_inference_ms": 0.9390566476917112, "mean_action_processing_ms": 0.12533069151267573, "mean_env_wait_ms": 0.066141333609077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029993057250976562, "StateBufferConnector_ms": 0.00203096866607666, "ViewRequirementAgentConnector_ms": 0.04749143123626709}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.1849296103239, "num_env_steps_trained_throughput_per_sec": 677.1849296103239, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 6060.603, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6060.548, "sample_time_ms": 678.979, "learn_time_ms": 5366.193, "learn_throughput": 745.407, "synch_weights_time_ms": 14.936}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 123, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-06", "timestamp": 1723390986, "time_this_iter_s": 5.912294149398804, "time_total_s": 729.9245226383209, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 729.9245226383209, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 40.47777777777778, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.062232090656956, "cur_kl_coeff": 2.793967723846435e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3816891295214495, "policy_loss": 0.000805567171482835, "vf_loss": 1.3808835614783068, "vf_explained_var": 0.9714649017900229, "kl": 0.003214704218045957, "entropy": 0.333360901211078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1878387099752823, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3789862860615054, "policy_loss": -0.00801010550300513, "vf_loss": 1.3867308107515177, "vf_explained_var": 0.971065884642303, "kl": 0.018885717896244582, "entropy": 0.5653724046424031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.79, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6379, "policy_reward_min": {"prey_policy": -62.22142285336731, "predator_policy": 2.5688477942532613}, "policy_reward_max": {"prey_policy": -2.5688477942532613, "predator_policy": 62.22142285336731}, "policy_reward_mean": {"prey_policy": -27.832709416920423, "predator_policy": 27.832709416920423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [47, 44, 49, 57, 78, 52, 53, 3, 43, 77, 35, 37, 40, 66, 89, 67, 86, 52, 47, 74, 99, 83, 43, 84, 63, 65, 64, 121, 58, 67, 51, 45, 73, 64, 88, 63, 70, 79, 92, 36, 60, 65, 35, 58, 28, 80, 79, 70, 23, 62, 66, 35, 84, 27, 84, 63, 73, 54, 124, 68, 99, 51, 72, 50, 49, 45, 78, 92, 27, 62, 75, 45, 95, 38, 52, 67, 37, 69, 55, 43, 75, 70, 79, 74, 87, 57, 62, 92, 55, 81, 60, 61, 79, 88, 72, 76, 72, 81, 59, 56], "policy_prey_policy_reward": [-23.59840456933875, -29.90128443430989, -31.439297564709758, -22.427827904908295, -28.43612856379361, -22.77244464496925, -14.775000242337597, -2.5688477942532613, -23.791273525899733, -17.180535733244984, -20.54482664768916, -18.60737470875069, -18.80661744881954, -13.40904622289903, -52.09216082149422, -20.892769088047753, -48.52158934196331, -33.85942601905511, -29.31355654948595, -32.40299359525497, -18.91571166802646, -55.69907312761725, -19.41704689801392, -31.385138934615647, -19.856263259394108, -42.897939287354234, -7.491788080536496, -22.806612095834947, -27.428874062564166, -30.628184307455598, -23.86704429418697, -19.94379991842231, -37.963561056894505, -41.40106365162789, -22.605807542815917, -31.05194930845354, -21.02621910870658, -24.890246405734324, -35.92430987524059, -6.128974976497879, -29.729519401708757, -29.88157531795736, -21.976959499422165, -33.458292927038684, -14.96608071735608, -44.18347363787164, -53.27322374499255, -29.060057529822945, -5.742324361081172, -31.711744134241233, -29.915003337276776, -22.635827241448197, -47.06716123868163, -10.860897090372411, -17.236630323485386, -38.07904740731893, -40.63156618838475, -11.241539698754721, -43.30067268326415, -32.56109743788234, -62.22142285336731, -22.185111399870266, -14.295548101118424, -29.788293459850262, -28.13539720283886, -24.12074610904974, -35.240516000308716, -36.414393842260964, -13.236333608107671, -39.64667540989273, -20.338432021132608, -23.083057672465895, -40.090835319656264, -29.167581985734437, -23.128315885947444, -17.525107939583396, -16.002059355503587, -17.099432867545726, -27.007280902926922, -10.740016387615439, -36.47347492400226, -29.703761562281883, -30.759067870194443, -29.8793510151294, -42.03733337060202, -27.27142088282176, -32.080873263892634, -39.32475495429224, -29.34777511024124, -46.67636506820386, -19.169104219227766, -27.937171929328905, -22.267346297703487, -22.653528409173006, -28.278618269489716, -37.00911002795979, -42.517693690348864, -34.05135572603105, -24.99803945754624, -17.184530119214557], "policy_predator_policy_reward": [23.59840456933875, 29.90128443430989, 31.439297564709758, 22.427827904908295, 28.43612856379361, 22.77244464496925, 14.775000242337597, 2.5688477942532613, 23.791273525899733, 17.180535733244984, 20.54482664768916, 18.60737470875069, 18.80661744881954, 13.40904622289903, 52.09216082149422, 20.892769088047753, 48.52158934196331, 33.85942601905511, 29.31355654948595, 32.40299359525497, 18.91571166802646, 55.69907312761725, 19.41704689801392, 31.385138934615647, 19.856263259394108, 42.897939287354234, 7.491788080536496, 22.806612095834947, 27.428874062564166, 30.628184307455598, 23.86704429418697, 19.94379991842231, 37.963561056894505, 41.40106365162789, 22.605807542815917, 31.05194930845354, 21.02621910870658, 24.890246405734324, 35.92430987524059, 6.128974976497879, 29.729519401708757, 29.88157531795736, 21.976959499422165, 33.458292927038684, 14.96608071735608, 44.18347363787164, 53.27322374499255, 29.060057529822945, 5.742324361081172, 31.711744134241233, 29.915003337276776, 22.635827241448197, 47.06716123868163, 10.860897090372411, 17.236630323485386, 38.07904740731893, 40.63156618838475, 11.241539698754721, 43.30067268326415, 32.56109743788234, 62.22142285336731, 22.185111399870266, 14.295548101118424, 29.788293459850262, 28.13539720283886, 24.12074610904974, 35.240516000308716, 36.414393842260964, 13.236333608107671, 39.64667540989273, 20.338432021132608, 23.083057672465895, 40.090835319656264, 29.167581985734437, 23.128315885947444, 17.525107939583396, 16.002059355503587, 17.099432867545726, 27.007280902926922, 10.740016387615439, 36.47347492400226, 29.703761562281883, 30.759067870194443, 29.8793510151294, 42.03733337060202, 27.27142088282176, 32.080873263892634, 39.32475495429224, 29.34777511024124, 46.67636506820386, 19.169104219227766, 27.937171929328905, 22.267346297703487, 22.653528409173006, 28.278618269489716, 37.00911002795979, 42.517693690348864, 34.05135572603105, 24.99803945754624, 17.184530119214557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2931424041133575, "mean_inference_ms": 0.9382446725115073, "mean_action_processing_ms": 0.12516980816018175, "mean_env_wait_ms": 0.066103429503476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031499862670898438, "StateBufferConnector_ms": 0.002160191535949707, "ViewRequirementAgentConnector_ms": 0.05236411094665527}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 689.3889098200763, "num_env_steps_trained_throughput_per_sec": 689.3889098200763, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 6033.909, "restore_workers_time_ms": 0.012, "training_step_time_ms": 6033.855, "sample_time_ms": 679.098, "learn_time_ms": 5339.386, "learn_throughput": 749.15, "synch_weights_time_ms": 14.929}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 124, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-12", "timestamp": 1723390992, "time_this_iter_s": 5.807910203933716, "time_total_s": 735.7324328422546, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cd9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 735.7324328422546, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 41.45, "ram_util_percent": 83.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0541587743908165, "cur_kl_coeff": 1.3969838619232175e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3472621798204878, "policy_loss": -0.002753618700080551, "vf_loss": 1.350015793585529, "vf_explained_var": 0.9721642950549721, "kl": 0.004069684782468208, "entropy": 0.3235146996409943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.189880796149373, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3640734016274412, "policy_loss": -0.00277629931467042, "vf_loss": 1.3668039561559757, "vf_explained_var": 0.9719537518297633, "kl": 0.0032526309067377485, "entropy": 0.5740736026627322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 68.92, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 6892, "policy_reward_min": {"prey_policy": -62.22142285336731, "predator_policy": 1.171346837745355}, "policy_reward_max": {"prey_policy": -1.171346837745355, "predator_policy": 62.22142285336731}, "policy_reward_mean": {"prey_policy": -28.216552131484477, "predator_policy": 28.216552131484477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [73, 54, 124, 68, 99, 51, 72, 50, 49, 45, 78, 92, 27, 62, 75, 45, 95, 38, 52, 67, 37, 69, 55, 43, 75, 70, 79, 74, 87, 57, 62, 92, 55, 81, 60, 61, 79, 88, 72, 76, 72, 81, 59, 56, 102, 77, 48, 38, 77, 76, 59, 37, 66, 86, 31, 13, 84, 47, 84, 51, 54, 90, 52, 45, 74, 137, 66, 24, 37, 72, 82, 60, 118, 127, 59, 112, 62, 83, 76, 80, 82, 68, 89, 40, 87, 61, 15, 73, 56, 78, 94, 80, 88, 72, 81, 153, 75, 38, 45, 75], "policy_prey_policy_reward": [-40.63156618838475, -11.241539698754721, -43.30067268326415, -32.56109743788234, -62.22142285336731, -22.185111399870266, -14.295548101118424, -29.788293459850262, -28.13539720283886, -24.12074610904974, -35.240516000308716, -36.414393842260964, -13.236333608107671, -39.64667540989273, -20.338432021132608, -23.083057672465895, -40.090835319656264, -29.167581985734437, -23.128315885947444, -17.525107939583396, -16.002059355503587, -17.099432867545726, -27.007280902926922, -10.740016387615439, -36.47347492400226, -29.703761562281883, -30.759067870194443, -29.8793510151294, -42.03733337060202, -27.27142088282176, -32.080873263892634, -39.32475495429224, -29.34777511024124, -46.67636506820386, -19.169104219227766, -27.937171929328905, -22.267346297703487, -22.653528409173006, -28.278618269489716, -37.00911002795979, -42.517693690348864, -34.05135572603105, -24.99803945754624, -17.184530119214557, -42.2780977859637, -26.170153701980343, -25.356718915170745, -7.5774050700100535, -36.78219097003856, -34.45402572548178, -35.34928783876299, -27.946180590995407, -30.041981389062915, -45.865598271780996, -16.87118416469023, -1.171346837745355, -27.517184750502576, -21.744014448705496, -35.304842610495285, -30.224758416351598, -22.489921519379923, -17.11603109089402, -21.69969593157451, -13.20947622557797, -33.58549612754283, -26.679096690062387, -39.46766198188189, -17.749993261453668, -11.155828792656699, -5.962808129780619, -29.83560816458806, -22.996758421758354, -40.66789824684351, -8.53246735077822, -38.82257511218747, -15.720760313458248, -31.944155456313997, -26.08018284671214, -41.58391052207282, -41.36657876127741, -40.232919554607676, -19.696508177717654, -22.66175974070354, -29.509332017101123, -35.50589868655657, -33.253612571791116, -8.334418990687233, -22.62302699445272, -16.120994791851874, -35.06496013751126, -33.761072558064555, -31.273037137487368, -45.89328638997256, -32.90635065766353, -46.62930977724221, -43.095481887868225, -36.97260178305192, -10.27092430481625, -19.5486618491864, -30.15706820483345], "policy_predator_policy_reward": [40.63156618838475, 11.241539698754721, 43.30067268326415, 32.56109743788234, 62.22142285336731, 22.185111399870266, 14.295548101118424, 29.788293459850262, 28.13539720283886, 24.12074610904974, 35.240516000308716, 36.414393842260964, 13.236333608107671, 39.64667540989273, 20.338432021132608, 23.083057672465895, 40.090835319656264, 29.167581985734437, 23.128315885947444, 17.525107939583396, 16.002059355503587, 17.099432867545726, 27.007280902926922, 10.740016387615439, 36.47347492400226, 29.703761562281883, 30.759067870194443, 29.8793510151294, 42.03733337060202, 27.27142088282176, 32.080873263892634, 39.32475495429224, 29.34777511024124, 46.67636506820386, 19.169104219227766, 27.937171929328905, 22.267346297703487, 22.653528409173006, 28.278618269489716, 37.00911002795979, 42.517693690348864, 34.05135572603105, 24.99803945754624, 17.184530119214557, 42.2780977859637, 26.170153701980343, 25.356718915170745, 7.5774050700100535, 36.78219097003856, 34.45402572548178, 35.34928783876299, 27.946180590995407, 30.041981389062915, 45.865598271780996, 16.87118416469023, 1.171346837745355, 27.517184750502576, 21.744014448705496, 35.304842610495285, 30.224758416351598, 22.489921519379923, 17.11603109089402, 21.69969593157451, 13.20947622557797, 33.58549612754283, 26.679096690062387, 39.46766198188189, 17.749993261453668, 11.155828792656699, 5.962808129780619, 29.83560816458806, 22.996758421758354, 40.66789824684351, 8.53246735077822, 38.82257511218747, 15.720760313458248, 31.944155456313997, 26.08018284671214, 41.58391052207282, 41.36657876127741, 40.232919554607676, 19.696508177717654, 22.66175974070354, 29.509332017101123, 35.50589868655657, 33.253612571791116, 8.334418990687233, 22.62302699445272, 16.120994791851874, 35.06496013751126, 33.761072558064555, 31.273037137487368, 45.89328638997256, 32.90635065766353, 46.62930977724221, 43.095481887868225, 36.97260178305192, 10.27092430481625, 19.5486618491864, 30.15706820483345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29322830072292005, "mean_inference_ms": 0.9379160897006752, "mean_action_processing_ms": 0.1254087356210762, "mean_env_wait_ms": 0.06618056568192653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029964447021484375, "StateBufferConnector_ms": 0.0019832849502563477, "ViewRequirementAgentConnector_ms": 0.050338029861450195}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.6789276294561, "num_env_steps_trained_throughput_per_sec": 685.6789276294561, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 6030.721, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6030.659, "sample_time_ms": 677.547, "learn_time_ms": 5337.197, "learn_throughput": 749.457, "synch_weights_time_ms": 15.406}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 125, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-18", "timestamp": 1723390998, "time_this_iter_s": 5.8573219776153564, "time_total_s": 741.58975481987, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 741.58975481987, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 41.6125, "ram_util_percent": 83.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9801634528984624, "cur_kl_coeff": 6.984919309616087e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.17394100005428, "policy_loss": 2.1605737856589258e-06, "vf_loss": 1.1739388366540273, "vf_explained_var": 0.978853873970608, "kl": 0.0037791718893601, "entropy": 0.2846064740636696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.074723083463808, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1987507895256082, "policy_loss": -0.006383520014060196, "vf_loss": 1.2050585641836127, "vf_explained_var": 0.9775873177374402, "kl": 0.010772152307400477, "entropy": 0.5748803310096264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.7, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6970, "policy_reward_min": {"prey_policy": -62.18719715040411, "predator_policy": 3.1452671652916973}, "policy_reward_max": {"prey_policy": -3.1452671652916973, "predator_policy": 62.18719715040411}, "policy_reward_mean": {"prey_policy": -25.624696440370496, "predator_policy": 25.624696440370496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [74, 137, 66, 24, 37, 72, 82, 60, 118, 127, 59, 112, 62, 83, 76, 80, 82, 68, 89, 40, 87, 61, 15, 73, 56, 78, 94, 80, 88, 72, 81, 153, 75, 38, 45, 75, 93, 69, 29, 70, 62, 80, 32, 84, 77, 60, 78, 80, 35, 60, 87, 66, 33, 64, 69, 97, 50, 92, 72, 138, 61, 45, 138, 39, 95, 71, 39, 89, 57, 21, 49, 58, 61, 37, 67, 78, 97, 88, 69, 63, 62, 36, 48, 47, 89, 148, 61, 92, 24, 51, 65, 66, 59, 93, 15, 49, 22, 55, 93, 77], "policy_prey_policy_reward": [-33.58549612754283, -26.679096690062387, -39.46766198188189, -17.749993261453668, -11.155828792656699, -5.962808129780619, -29.83560816458806, -22.996758421758354, -40.66789824684351, -8.53246735077822, -38.82257511218747, -15.720760313458248, -31.944155456313997, -26.08018284671214, -41.58391052207282, -41.36657876127741, -40.232919554607676, -19.696508177717654, -22.66175974070354, -29.509332017101123, -35.50589868655657, -33.253612571791116, -8.334418990687233, -22.62302699445272, -16.120994791851874, -35.06496013751126, -33.761072558064555, -31.273037137487368, -45.89328638997256, -32.90635065766353, -46.62930977724221, -43.095481887868225, -36.97260178305192, -10.27092430481625, -19.5486618491864, -30.15706820483345, -37.25712694580302, -35.895342877074704, -24.639093913386173, -30.19119829167301, -34.195873608700225, -39.74754495695638, -17.721379368987108, -23.07255309364463, -19.78974627790583, -10.149052964841266, -43.780443417752075, -36.314447907986725, -9.541993150200172, -27.439402679424482, -39.164977227546956, -24.925698032003787, -17.930502156283165, -22.72086651698381, -29.60482522712978, -22.992797382396308, -9.280378797831503, -16.41026099418899, -43.1260943483281, -20.54093904912196, -27.882340195718584, -7.710850490739726, -31.78077532889548, -21.744008970276063, -18.146864065071117, -27.604897808257302, -4.104376343882017, -28.478886067027037, -4.3640588469748085, -8.230472280684399, -32.25956700732665, -15.04704331035296, -35.12794251540338, -8.744151561992803, -15.88421025960376, -37.34347404103142, -62.18719715040411, -32.151239059564915, -26.399853936092452, -25.013383558429947, -27.652656443269738, -12.66041056943072, -4.846804500902668, -26.21236755828791, -14.952550238423479, -26.372321902778385, -17.064990006974515, -39.87852734947113, -13.818487220700147, -13.325074955853387, -31.196515810089725, -26.386190518267803, -22.53439974274327, -41.56045848140593, -6.219986229420605, -6.869427843213715, -3.1452671652916973, -23.188099347404552, -33.76037330111345, -38.5235964755918], "policy_predator_policy_reward": [33.58549612754283, 26.679096690062387, 39.46766198188189, 17.749993261453668, 11.155828792656699, 5.962808129780619, 29.83560816458806, 22.996758421758354, 40.66789824684351, 8.53246735077822, 38.82257511218747, 15.720760313458248, 31.944155456313997, 26.08018284671214, 41.58391052207282, 41.36657876127741, 40.232919554607676, 19.696508177717654, 22.66175974070354, 29.509332017101123, 35.50589868655657, 33.253612571791116, 8.334418990687233, 22.62302699445272, 16.120994791851874, 35.06496013751126, 33.761072558064555, 31.273037137487368, 45.89328638997256, 32.90635065766353, 46.62930977724221, 43.095481887868225, 36.97260178305192, 10.27092430481625, 19.5486618491864, 30.15706820483345, 37.25712694580302, 35.895342877074704, 24.639093913386173, 30.19119829167301, 34.195873608700225, 39.74754495695638, 17.721379368987108, 23.07255309364463, 19.78974627790583, 10.149052964841266, 43.780443417752075, 36.314447907986725, 9.541993150200172, 27.439402679424482, 39.164977227546956, 24.925698032003787, 17.930502156283165, 22.72086651698381, 29.60482522712978, 22.992797382396308, 9.280378797831503, 16.41026099418899, 43.1260943483281, 20.54093904912196, 27.882340195718584, 7.710850490739726, 31.78077532889548, 21.744008970276063, 18.146864065071117, 27.604897808257302, 4.104376343882017, 28.478886067027037, 4.3640588469748085, 8.230472280684399, 32.25956700732665, 15.04704331035296, 35.12794251540338, 8.744151561992803, 15.88421025960376, 37.34347404103142, 62.18719715040411, 32.151239059564915, 26.399853936092452, 25.013383558429947, 27.652656443269738, 12.66041056943072, 4.846804500902668, 26.21236755828791, 14.952550238423479, 26.372321902778385, 17.064990006974515, 39.87852734947113, 13.818487220700147, 13.325074955853387, 31.196515810089725, 26.386190518267803, 22.53439974274327, 41.56045848140593, 6.219986229420605, 6.869427843213715, 3.1452671652916973, 23.188099347404552, 33.76037330111345, 38.5235964755918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29321616851471716, "mean_inference_ms": 0.9379719453746751, "mean_action_processing_ms": 0.12549393912039425, "mean_env_wait_ms": 0.06615476973458495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029125213623046875, "StateBufferConnector_ms": 0.002064228057861328, "ViewRequirementAgentConnector_ms": 0.047604918479919434}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 633.2119765009935, "num_env_steps_trained_throughput_per_sec": 633.2119765009935, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 6042.435, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6042.371, "sample_time_ms": 676.618, "learn_time_ms": 5349.9, "learn_throughput": 747.677, "synch_weights_time_ms": 15.34}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 126, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-24", "timestamp": 1723391004, "time_this_iter_s": 6.330502986907959, "time_total_s": 747.920257806778, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 747.920257806778, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 44.7, "ram_util_percent": 83.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1150159454594055, "cur_kl_coeff": 3.4924596548080437e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6594568753925463, "policy_loss": -0.0012416166112719413, "vf_loss": 1.6606984940047065, "vf_explained_var": 0.9600339150056243, "kl": 0.0046818886341280395, "entropy": 0.3211813451877485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2767614763850967, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6353069244573513, "policy_loss": -0.011320703280701613, "vf_loss": 1.6465341415877144, "vf_explained_var": 0.9605329339082043, "kl": 0.013296197238908848, "entropy": 0.6069540572042267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.36, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6636, "policy_reward_min": {"prey_policy": -62.18719715040411, "predator_policy": 3.1452671652916973}, "policy_reward_max": {"prey_policy": -3.1452671652916973, "predator_policy": 62.18719715040411}, "policy_reward_mean": {"prey_policy": -25.00425632106245, "predator_policy": 25.00425632106245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [138, 61, 45, 138, 39, 95, 71, 39, 89, 57, 21, 49, 58, 61, 37, 67, 78, 97, 88, 69, 63, 62, 36, 48, 47, 89, 148, 61, 92, 24, 51, 65, 66, 59, 93, 15, 49, 22, 55, 93, 77, 81, 89, 57, 96, 36, 48, 58, 46, 57, 75, 64, 68, 61, 55, 69, 40, 77, 61, 63, 52, 76, 93, 89, 57, 73, 79, 78, 86, 84, 41, 66, 74, 80, 49, 38, 72, 42, 73, 74, 68, 52, 64, 66, 96, 84, 41, 95, 64, 88, 81, 57, 95, 29, 45, 65, 69, 72, 69, 47], "policy_prey_policy_reward": [-20.54093904912196, -27.882340195718584, -7.710850490739726, -31.78077532889548, -21.744008970276063, -18.146864065071117, -27.604897808257302, -4.104376343882017, -28.478886067027037, -4.3640588469748085, -8.230472280684399, -32.25956700732665, -15.04704331035296, -35.12794251540338, -8.744151561992803, -15.88421025960376, -37.34347404103142, -62.18719715040411, -32.151239059564915, -26.399853936092452, -25.013383558429947, -27.652656443269738, -12.66041056943072, -4.846804500902668, -26.21236755828791, -14.952550238423479, -26.372321902778385, -17.064990006974515, -39.87852734947113, -13.818487220700147, -13.325074955853387, -31.196515810089725, -26.386190518267803, -22.53439974274327, -41.56045848140593, -6.219986229420605, -6.869427843213715, -3.1452671652916973, -23.188099347404552, -33.76037330111345, -38.5235964755918, -54.4110303205945, -36.59664348692363, -39.71060913584502, -36.58636575633743, -19.62803755503659, -23.737180369689543, -26.137737186874205, -7.732595589297971, -44.65112111819514, -29.862025215637722, -16.210511248879968, -8.947046320659256, -24.61464102988746, -12.404226620479628, -15.788899092833889, -24.2127373867658, -25.899060275359922, -34.644312027943094, -30.43170970090589, -16.549986955894802, -39.40974815651926, -39.21097396818821, -39.38084246894224, -8.251160504966734, -24.835538103910483, -33.021201322677776, -22.592950348988968, -14.896073504034915, -25.887809955845984, -8.282866302540748, -34.977510680322695, -47.76741600114927, -41.90678605854268, -21.29350570783222, -6.473230314746694, -26.88924046811889, -20.963805586058502, -34.07544585435847, -20.417697647972226, -29.254753466063498, -27.922014940183796, -5.088929421462031, -24.542222636309344, -40.65833020831086, -34.09602684225401, -15.557849374992186, -41.874675469791796, -8.463825304326207, -51.945664670724376, -11.518223517557383, -39.03699570314709, -37.62109073557445, -14.190120506772592, -32.34046442703449, -46.84317955181715, -18.36929600151315, -25.946575158343737, -17.697133647833983, -17.252943664988212], "policy_predator_policy_reward": [20.54093904912196, 27.882340195718584, 7.710850490739726, 31.78077532889548, 21.744008970276063, 18.146864065071117, 27.604897808257302, 4.104376343882017, 28.478886067027037, 4.3640588469748085, 8.230472280684399, 32.25956700732665, 15.04704331035296, 35.12794251540338, 8.744151561992803, 15.88421025960376, 37.34347404103142, 62.18719715040411, 32.151239059564915, 26.399853936092452, 25.013383558429947, 27.652656443269738, 12.66041056943072, 4.846804500902668, 26.21236755828791, 14.952550238423479, 26.372321902778385, 17.064990006974515, 39.87852734947113, 13.818487220700147, 13.325074955853387, 31.196515810089725, 26.386190518267803, 22.53439974274327, 41.56045848140593, 6.219986229420605, 6.869427843213715, 3.1452671652916973, 23.188099347404552, 33.76037330111345, 38.5235964755918, 54.4110303205945, 36.59664348692363, 39.71060913584502, 36.58636575633743, 19.62803755503659, 23.737180369689543, 26.137737186874205, 7.732595589297971, 44.65112111819514, 29.862025215637722, 16.210511248879968, 8.947046320659256, 24.61464102988746, 12.404226620479628, 15.788899092833889, 24.2127373867658, 25.899060275359922, 34.644312027943094, 30.43170970090589, 16.549986955894802, 39.40974815651926, 39.21097396818821, 39.38084246894224, 8.251160504966734, 24.835538103910483, 33.021201322677776, 22.592950348988968, 14.896073504034915, 25.887809955845984, 8.282866302540748, 34.977510680322695, 47.76741600114927, 41.90678605854268, 21.29350570783222, 6.473230314746694, 26.88924046811889, 20.963805586058502, 34.07544585435847, 20.417697647972226, 29.254753466063498, 27.922014940183796, 5.088929421462031, 24.542222636309344, 40.65833020831086, 34.09602684225401, 15.557849374992186, 41.874675469791796, 8.463825304326207, 51.945664670724376, 11.518223517557383, 39.03699570314709, 37.62109073557445, 14.190120506772592, 32.34046442703449, 46.84317955181715, 18.36929600151315, 25.946575158343737, 17.697133647833983, 17.252943664988212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29355002266354413, "mean_inference_ms": 0.9385165975020265, "mean_action_processing_ms": 0.1254257497640855, "mean_env_wait_ms": 0.06626419099726559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002801179885864258, "StateBufferConnector_ms": 0.0024709701538085938, "ViewRequirementAgentConnector_ms": 0.048120856285095215}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 664.6489098840462, "num_env_steps_trained_throughput_per_sec": 664.6489098840462, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 6003.312, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6003.258, "sample_time_ms": 673.608, "learn_time_ms": 5314.757, "learn_throughput": 752.621, "synch_weights_time_ms": 14.438}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "training_iteration": 127, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-30", "timestamp": 1723391010, "time_this_iter_s": 6.031551122665405, "time_total_s": 753.9518089294434, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 753.9518089294434, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 43.955555555555556, "ram_util_percent": 83.17777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0923008721321823, "cur_kl_coeff": 1.7462298274040218e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2791889649194976, "policy_loss": -0.0025193691243960833, "vf_loss": 1.281708331219852, "vf_explained_var": 0.97010816950351, "kl": 0.004668415523709857, "entropy": 0.3059635668061674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.223530904762447, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.262001856106023, "policy_loss": -0.005870580946308716, "vf_loss": 1.267798663675785, "vf_explained_var": 0.9704558019836743, "kl": 0.01049153352475873, "entropy": 0.6473653291041652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.3, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6430, "policy_reward_min": {"prey_policy": -52.253317754269, "predator_policy": 3.2581735919063712}, "policy_reward_max": {"prey_policy": -3.2581735919063712, "predator_policy": 52.253317754269}, "policy_reward_mean": {"prey_policy": -24.85028909949114, "predator_policy": 24.85028909949114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [57, 73, 79, 78, 86, 84, 41, 66, 74, 80, 49, 38, 72, 42, 73, 74, 68, 52, 64, 66, 96, 84, 41, 95, 64, 88, 81, 57, 95, 29, 45, 65, 69, 72, 69, 47, 78, 62, 83, 80, 61, 59, 77, 52, 72, 64, 41, 54, 53, 43, 48, 97, 76, 58, 62, 58, 49, 83, 88, 80, 40, 67, 82, 47, 93, 74, 60, 36, 14, 85, 64, 69, 13, 83, 90, 49, 13, 75, 58, 60, 76, 43, 66, 28, 74, 55, 89, 65, 61, 85, 64, 42, 72, 67, 66, 70, 39, 79, 50, 76], "policy_prey_policy_reward": [-8.251160504966734, -24.835538103910483, -33.021201322677776, -22.592950348988968, -14.896073504034915, -25.887809955845984, -8.282866302540748, -34.977510680322695, -47.76741600114927, -41.90678605854268, -21.29350570783222, -6.473230314746694, -26.88924046811889, -20.963805586058502, -34.07544585435847, -20.417697647972226, -29.254753466063498, -27.922014940183796, -5.088929421462031, -24.542222636309344, -40.65833020831086, -34.09602684225401, -15.557849374992186, -41.874675469791796, -8.463825304326207, -51.945664670724376, -11.518223517557383, -39.03699570314709, -37.62109073557445, -14.190120506772592, -32.34046442703449, -46.84317955181715, -18.36929600151315, -25.946575158343737, -17.697133647833983, -17.252943664988212, -41.09125631059246, -9.0409542134751, -26.603291696002806, -16.949618494509114, -6.373577640074643, -32.767438020937135, -40.889961354163795, -9.257359753109856, -23.67352283543079, -28.086590929777312, -12.984824361954166, -20.45216082943382, -21.09612900833998, -5.115873696656301, -25.138145217992378, -14.500278192630793, -41.42251625885804, -26.47599962752122, -40.47751021090612, -25.30444807014974, -20.960366630425593, -10.06454388413916, -48.662384521396255, -29.182903902637403, -10.609024665551601, -26.600534121800692, -52.253317754269, -3.2581735919063712, -18.595728943657846, -16.62534811591276, -23.373124976343956, -12.911702370405068, -4.217276657749098, -40.62745024691097, -13.960226105906699, -47.41814751931143, -3.9788825257083285, -45.04604453225921, -35.473567703500535, -40.87076002877924, -6.311786381580638, -18.958639352237977, -37.85119019840614, -25.393818258713402, -33.23230883358027, -11.905466806667015, -31.1092145399267, -16.44523855653064, -26.195184832762337, -12.73753462026591, -30.495424186448606, -37.56225332551656, -32.32744024848887, -28.740237856886424, -35.06274534294539, -22.53397020954016, -16.15202886389876, -29.07208772820166, -19.62720144603266, -15.403955167639143, -11.897888214782803, -32.474516270286955, -35.50815363846026, -12.887105937160998], "policy_predator_policy_reward": [8.251160504966734, 24.835538103910483, 33.021201322677776, 22.592950348988968, 14.896073504034915, 25.887809955845984, 8.282866302540748, 34.977510680322695, 47.76741600114927, 41.90678605854268, 21.29350570783222, 6.473230314746694, 26.88924046811889, 20.963805586058502, 34.07544585435847, 20.417697647972226, 29.254753466063498, 27.922014940183796, 5.088929421462031, 24.542222636309344, 40.65833020831086, 34.09602684225401, 15.557849374992186, 41.874675469791796, 8.463825304326207, 51.945664670724376, 11.518223517557383, 39.03699570314709, 37.62109073557445, 14.190120506772592, 32.34046442703449, 46.84317955181715, 18.36929600151315, 25.946575158343737, 17.697133647833983, 17.252943664988212, 41.09125631059246, 9.0409542134751, 26.603291696002806, 16.949618494509114, 6.373577640074643, 32.767438020937135, 40.889961354163795, 9.257359753109856, 23.67352283543079, 28.086590929777312, 12.984824361954166, 20.45216082943382, 21.09612900833998, 5.115873696656301, 25.138145217992378, 14.500278192630793, 41.42251625885804, 26.47599962752122, 40.47751021090612, 25.30444807014974, 20.960366630425593, 10.06454388413916, 48.662384521396255, 29.182903902637403, 10.609024665551601, 26.600534121800692, 52.253317754269, 3.2581735919063712, 18.595728943657846, 16.62534811591276, 23.373124976343956, 12.911702370405068, 4.217276657749098, 40.62745024691097, 13.960226105906699, 47.41814751931143, 3.9788825257083285, 45.04604453225921, 35.473567703500535, 40.87076002877924, 6.311786381580638, 18.958639352237977, 37.85119019840614, 25.393818258713402, 33.23230883358027, 11.905466806667015, 31.1092145399267, 16.44523855653064, 26.195184832762337, 12.73753462026591, 30.495424186448606, 37.56225332551656, 32.32744024848887, 28.740237856886424, 35.06274534294539, 22.53397020954016, 16.15202886389876, 29.07208772820166, 19.62720144603266, 15.403955167639143, 11.897888214782803, 32.474516270286955, 35.50815363846026, 12.887105937160998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29363933133095155, "mean_inference_ms": 0.9385005794190584, "mean_action_processing_ms": 0.12541117363531007, "mean_env_wait_ms": 0.06630920191148572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028846263885498047, "StateBufferConnector_ms": 0.0022546052932739258, "ViewRequirementAgentConnector_ms": 0.05079841613769531}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 654.2376501998505, "num_env_steps_trained_throughput_per_sec": 654.2376501998505, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 5960.271, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5960.219, "sample_time_ms": 668.586, "learn_time_ms": 5276.976, "learn_throughput": 758.01, "synch_weights_time_ms": 14.192}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 128, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-36", "timestamp": 1723391016, "time_this_iter_s": 6.143324136734009, "time_total_s": 760.0951330661774, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 760.0951330661774, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 43.01111111111111, "ram_util_percent": 82.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3251784468690553, "cur_kl_coeff": 8.731149137020109e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6851241785412034, "policy_loss": -0.0007352253553108313, "vf_loss": 1.6858593935146928, "vf_explained_var": 0.9611339624350269, "kl": 0.0031203717643145668, "entropy": 0.34029287165030836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3520916079481444, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6658850274980068, "policy_loss": -0.013274907076750726, "vf_loss": 1.6790469416727622, "vf_explained_var": 0.9607265543192625, "kl": 0.01607099477370705, "entropy": 0.6452492091804742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.27, "episode_media": {}, "episodes_this_iter": 53, "episodes_timesteps_total": 6527, "policy_reward_min": {"prey_policy": -52.26497135548379, "predator_policy": 3.2581735919063712}, "policy_reward_max": {"prey_policy": -3.2581735919063712, "predator_policy": 52.26497135548379}, "policy_reward_mean": {"prey_policy": -25.30378830286619, "predator_policy": 25.30378830286619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [58, 62, 58, 49, 83, 88, 80, 40, 67, 82, 47, 93, 74, 60, 36, 14, 85, 64, 69, 13, 83, 90, 49, 13, 75, 58, 60, 76, 43, 66, 28, 74, 55, 89, 65, 61, 85, 64, 42, 72, 67, 66, 70, 39, 79, 50, 76, 71, 64, 99, 57, 69, 37, 87, 29, 80, 41, 85, 96, 102, 85, 41, 68, 87, 92, 73, 62, 48, 21, 50, 77, 77, 74, 70, 81, 61, 65, 88, 63, 50, 88, 71, 61, 83, 41, 62, 43, 76, 61, 57, 70, 58, 88, 84, 51, 54, 63, 63, 91, 95], "policy_prey_policy_reward": [-26.47599962752122, -40.47751021090612, -25.30444807014974, -20.960366630425593, -10.06454388413916, -48.662384521396255, -29.182903902637403, -10.609024665551601, -26.600534121800692, -52.253317754269, -3.2581735919063712, -18.595728943657846, -16.62534811591276, -23.373124976343956, -12.911702370405068, -4.217276657749098, -40.62745024691097, -13.960226105906699, -47.41814751931143, -3.9788825257083285, -45.04604453225921, -35.473567703500535, -40.87076002877924, -6.311786381580638, -18.958639352237977, -37.85119019840614, -25.393818258713402, -33.23230883358027, -11.905466806667015, -31.1092145399267, -16.44523855653064, -26.195184832762337, -12.73753462026591, -30.495424186448606, -37.56225332551656, -32.32744024848887, -28.740237856886424, -35.06274534294539, -22.53397020954016, -16.15202886389876, -29.07208772820166, -19.62720144603266, -15.403955167639143, -11.897888214782803, -32.474516270286955, -35.50815363846026, -12.887105937160998, -36.89559418035264, -25.3198199324692, -27.4619621652728, -18.60472258222996, -19.870975496526082, -9.254712662821019, -37.14400891774959, -10.826528371967912, -25.945615999591567, -20.350604346925042, -42.31721320490324, -30.853777714193146, -27.56679371950136, -28.319026545683094, -16.48477834890339, -10.930780968086985, -28.986061547236314, -43.51151621057012, -17.9539878702137, -29.74302036519176, -19.777760281372693, -13.950447371314283, -5.37024099930061, -10.150836836365427, -21.100829639976457, -37.60235993522976, -28.201937651402396, -30.58833749192346, -28.15565617533328, -27.642887991582008, -32.75870208310623, -29.342779268133626, -40.4338764012272, -52.26497135548379, -18.067088788263277, -9.7015982945057, -20.019326037762898, -30.687215776432403, -14.18735542518855, -11.08783306803705, -22.885042408663494, -30.038709366931, -20.42701225231022, -20.051245166383158, -30.33196953481936, -37.13011439459297, -13.907012123403105, -16.321520960099658, -44.542505972201575, -38.226541362266396, -27.917112865403485, -44.02883056815184, -18.30481376495445], "policy_predator_policy_reward": [26.47599962752122, 40.47751021090612, 25.30444807014974, 20.960366630425593, 10.06454388413916, 48.662384521396255, 29.182903902637403, 10.609024665551601, 26.600534121800692, 52.253317754269, 3.2581735919063712, 18.595728943657846, 16.62534811591276, 23.373124976343956, 12.911702370405068, 4.217276657749098, 40.62745024691097, 13.960226105906699, 47.41814751931143, 3.9788825257083285, 45.04604453225921, 35.473567703500535, 40.87076002877924, 6.311786381580638, 18.958639352237977, 37.85119019840614, 25.393818258713402, 33.23230883358027, 11.905466806667015, 31.1092145399267, 16.44523855653064, 26.195184832762337, 12.73753462026591, 30.495424186448606, 37.56225332551656, 32.32744024848887, 28.740237856886424, 35.06274534294539, 22.53397020954016, 16.15202886389876, 29.07208772820166, 19.62720144603266, 15.403955167639143, 11.897888214782803, 32.474516270286955, 35.50815363846026, 12.887105937160998, 36.89559418035264, 25.3198199324692, 27.4619621652728, 18.60472258222996, 19.870975496526082, 9.254712662821019, 37.14400891774959, 10.826528371967912, 25.945615999591567, 20.350604346925042, 42.31721320490324, 30.853777714193146, 27.56679371950136, 28.319026545683094, 16.48477834890339, 10.930780968086985, 28.986061547236314, 43.51151621057012, 17.9539878702137, 29.74302036519176, 19.777760281372693, 13.950447371314283, 5.37024099930061, 10.150836836365427, 21.100829639976457, 37.60235993522976, 28.201937651402396, 30.58833749192346, 28.15565617533328, 27.642887991582008, 32.75870208310623, 29.342779268133626, 40.4338764012272, 52.26497135548379, 18.067088788263277, 9.7015982945057, 20.019326037762898, 30.687215776432403, 14.18735542518855, 11.08783306803705, 22.885042408663494, 30.038709366931, 20.42701225231022, 20.051245166383158, 30.33196953481936, 37.13011439459297, 13.907012123403105, 16.321520960099658, 44.542505972201575, 38.226541362266396, 27.917112865403485, 44.02883056815184, 18.30481376495445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2935722360972055, "mean_inference_ms": 0.9387944696317225, "mean_action_processing_ms": 0.1254166195031409, "mean_env_wait_ms": 0.06636366550008206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030940771102905273, "StateBufferConnector_ms": 0.002398848533630371, "ViewRequirementAgentConnector_ms": 0.05198800563812256}, "num_episodes": 53, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.966583874746, "num_env_steps_trained_throughput_per_sec": 677.966583874746, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 5949.024, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5948.971, "sample_time_ms": 674.671, "learn_time_ms": 5259.523, "learn_throughput": 760.525, "synch_weights_time_ms": 14.261}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 129, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-42", "timestamp": 1723391022, "time_this_iter_s": 5.90566611289978, "time_total_s": 766.0007991790771, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600fbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 766.0007991790771, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 36.3625, "ram_util_percent": 82.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7314778505514066, "cur_kl_coeff": 4.3655745685100546e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1160473734140397, "policy_loss": -0.0012105256886570715, "vf_loss": 1.1172578974626959, "vf_explained_var": 0.9741732075810432, "kl": 0.003975547906236474, "entropy": 0.28896021818121276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.873083360803624, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1015898882100978, "policy_loss": -0.008424217742867769, "vf_loss": 1.1099504477654893, "vf_explained_var": 0.9751310668264827, "kl": 0.009053787929702573, "entropy": 0.6027661266426245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.05, "episode_media": {}, "episodes_this_iter": 67, "episodes_timesteps_total": 6505, "policy_reward_min": {"prey_policy": -52.26497135548379, "predator_policy": 0.4878923247085072}, "policy_reward_max": {"prey_policy": -0.4878923247085072, "predator_policy": 52.26497135548379}, "policy_reward_mean": {"prey_policy": -23.456956974001383, "predator_policy": 23.456956974001383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [48, 21, 50, 77, 77, 74, 70, 81, 61, 65, 88, 63, 50, 88, 71, 61, 83, 41, 62, 43, 76, 61, 57, 70, 58, 88, 84, 51, 54, 63, 63, 91, 95, 136, 65, 55, 96, 35, 83, 46, 126, 76, 41, 37, 83, 22, 84, 25, 45, 85, 117, 53, 96, 52, 49, 55, 62, 27, 43, 59, 118, 65, 49, 64, 64, 57, 43, 80, 82, 144, 88, 68, 42, 75, 68, 1, 55, 87, 93, 86, 54, 79, 32, 22, 72, 77, 72, 37, 48, 84, 80, 84, 66, 63, 23, 56, 85, 42, 21, 41], "policy_prey_policy_reward": [-19.777760281372693, -13.950447371314283, -5.37024099930061, -10.150836836365427, -21.100829639976457, -37.60235993522976, -28.201937651402396, -30.58833749192346, -28.15565617533328, -27.642887991582008, -32.75870208310623, -29.342779268133626, -40.4338764012272, -52.26497135548379, -18.067088788263277, -9.7015982945057, -20.019326037762898, -30.687215776432403, -14.18735542518855, -11.08783306803705, -22.885042408663494, -30.038709366931, -20.42701225231022, -20.051245166383158, -30.33196953481936, -37.13011439459297, -13.907012123403105, -16.321520960099658, -44.542505972201575, -38.226541362266396, -27.917112865403485, -44.02883056815184, -18.30481376495445, -20.565137226778308, -14.152327780272094, -20.803670780349126, -10.789557307864943, -8.456355653503254, -25.25136333603473, -33.20287081942416, -45.78300287427055, -36.82899197248057, -30.84465563662519, -7.043814318955098, -44.169079604860954, -9.522640693781938, -18.848020444775397, -7.168847238960951, -2.2110370054731234, -40.20852245069972, -42.952155379856606, -21.011288432922846, -19.586216918283544, -6.065714399802987, -26.042260844085117, -7.286756676259278, -31.713454121888063, -8.973717341752755, -12.189544900768674, -4.028106129663212, -19.62706459678608, -38.30728584705733, -17.766291017829634, -17.813812405802718, -7.52573897177067, -21.03943407695366, -11.931570517666133, -23.642285638230803, -26.36995005027839, -32.61713225112527, -48.034459449744176, -16.324932284867185, -19.33214191106968, -44.852653957914626, -22.593216272142723, -0.4878923247085072, -21.693149115178095, -27.34314864164014, -29.626194130840897, -32.51964218464942, -33.81217919025016, -36.9489854222802, -17.493074039290175, -6.0177951784115615, -31.099577622726404, -45.413801155201845, -37.180482773632384, -17.70935801832099, -18.790393124288144, -40.399696003964536, -28.9510732207196, -15.921419789753987, -10.891881876931082, -29.464257437078782, -4.330189347788688, -25.619585792058224, -22.285509062497866, -21.70416557583416, -8.805405940480458, -12.505289279857926], "policy_predator_policy_reward": [19.777760281372693, 13.950447371314283, 5.37024099930061, 10.150836836365427, 21.100829639976457, 37.60235993522976, 28.201937651402396, 30.58833749192346, 28.15565617533328, 27.642887991582008, 32.75870208310623, 29.342779268133626, 40.4338764012272, 52.26497135548379, 18.067088788263277, 9.7015982945057, 20.019326037762898, 30.687215776432403, 14.18735542518855, 11.08783306803705, 22.885042408663494, 30.038709366931, 20.42701225231022, 20.051245166383158, 30.33196953481936, 37.13011439459297, 13.907012123403105, 16.321520960099658, 44.542505972201575, 38.226541362266396, 27.917112865403485, 44.02883056815184, 18.30481376495445, 20.565137226778308, 14.152327780272094, 20.803670780349126, 10.789557307864943, 8.456355653503254, 25.25136333603473, 33.20287081942416, 45.78300287427055, 36.82899197248057, 30.84465563662519, 7.043814318955098, 44.169079604860954, 9.522640693781938, 18.848020444775397, 7.168847238960951, 2.2110370054731234, 40.20852245069972, 42.952155379856606, 21.011288432922846, 19.586216918283544, 6.065714399802987, 26.042260844085117, 7.286756676259278, 31.713454121888063, 8.973717341752755, 12.189544900768674, 4.028106129663212, 19.62706459678608, 38.30728584705733, 17.766291017829634, 17.813812405802718, 7.52573897177067, 21.03943407695366, 11.931570517666133, 23.642285638230803, 26.36995005027839, 32.61713225112527, 48.034459449744176, 16.324932284867185, 19.33214191106968, 44.852653957914626, 22.593216272142723, 0.4878923247085072, 21.693149115178095, 27.34314864164014, 29.626194130840897, 32.51964218464942, 33.81217919025016, 36.9489854222802, 17.493074039290175, 6.0177951784115615, 31.099577622726404, 45.413801155201845, 37.180482773632384, 17.70935801832099, 18.790393124288144, 40.399696003964536, 28.9510732207196, 15.921419789753987, 10.891881876931082, 29.464257437078782, 4.330189347788688, 25.619585792058224, 22.285509062497866, 21.70416557583416, 8.805405940480458, 12.505289279857926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2937538165251666, "mean_inference_ms": 0.9386523823983368, "mean_action_processing_ms": 0.12549693149342864, "mean_env_wait_ms": 0.06637148254761405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002985835075378418, "StateBufferConnector_ms": 0.0023441314697265625, "ViewRequirementAgentConnector_ms": 0.05032217502593994}, "num_episodes": 67, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 652.8191564410363, "num_env_steps_trained_throughput_per_sec": 652.8191564410363, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 5980.979, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5980.921, "sample_time_ms": 675.558, "learn_time_ms": 5289.544, "learn_throughput": 756.209, "synch_weights_time_ms": 15.288}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 130, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-48", "timestamp": 1723391028, "time_this_iter_s": 6.133542060852051, "time_total_s": 772.1343412399292, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 772.1343412399292, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 35.34444444444445, "ram_util_percent": 83.25555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9151397490253053, "cur_kl_coeff": 2.1827872842550273e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.244550025028487, "policy_loss": -0.004363850257504964, "vf_loss": 1.2489138761535288, "vf_explained_var": 0.9713712004944682, "kl": 0.004190426326388217, "entropy": 0.28229991666351756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1264921965698402, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2623314488679171, "policy_loss": -0.009056212921859697, "vf_loss": 1.2712994597231349, "vf_explained_var": 0.9711016919463873, "kl": 0.012544750707284245, "entropy": 0.6216926911845804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.56, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6256, "policy_reward_min": {"prey_policy": -50.90530519382302, "predator_policy": 0.4878923247085072}, "policy_reward_max": {"prey_policy": -0.4878923247085072, "predator_policy": 50.90530519382302}, "policy_reward_mean": {"prey_policy": -25.026292431867915, "predator_policy": 25.026292431867915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [57, 43, 80, 82, 144, 88, 68, 42, 75, 68, 1, 55, 87, 93, 86, 54, 79, 32, 22, 72, 77, 72, 37, 48, 84, 80, 84, 66, 63, 23, 56, 85, 42, 21, 41, 97, 39, 55, 9, 79, 74, 69, 42, 81, 87, 38, 38, 78, 88, 76, 60, 91, 48, 75, 88, 82, 56, 66, 57, 75, 69, 80, 68, 55, 58, 52, 97, 61, 43, 67, 59, 56, 72, 56, 26, 23, 46, 68, 69, 66, 79, 42, 38, 54, 68, 36, 34, 95, 50, 51, 56, 63, 74, 79, 65, 42, 69, 69, 71, 75], "policy_prey_policy_reward": [-21.03943407695366, -11.931570517666133, -23.642285638230803, -26.36995005027839, -32.61713225112527, -48.034459449744176, -16.324932284867185, -19.33214191106968, -44.852653957914626, -22.593216272142723, -0.4878923247085072, -21.693149115178095, -27.34314864164014, -29.626194130840897, -32.51964218464942, -33.81217919025016, -36.9489854222802, -17.493074039290175, -6.0177951784115615, -31.099577622726404, -45.413801155201845, -37.180482773632384, -17.70935801832099, -18.790393124288144, -40.399696003964536, -28.9510732207196, -15.921419789753987, -10.891881876931082, -29.464257437078782, -4.330189347788688, -25.619585792058224, -22.285509062497866, -21.70416557583416, -8.805405940480458, -12.505289279857926, -21.97955031177721, -29.394410047468188, -25.29231825640846, -5.8230228797626715, -6.999332630309843, -46.31661632266449, -28.053188532687386, -27.12316042783431, -26.939971467959506, -20.927391438931892, -23.736726527377023, -6.961119650288223, -21.284924321068022, -39.36200929526012, -35.54025054131844, -27.136714006875753, -25.042684122024827, -34.51420220514862, -14.37357897998595, -41.15297352292638, -50.90530519382302, -36.502988863189145, -36.66233895470319, -31.373612156764874, -37.39950939538741, -13.658728295479214, -18.622777019911105, -19.72156721177098, -19.768552321879262, -25.566704370252612, -16.019150584994758, -48.35846208021707, -14.580469039017586, -24.892075723070022, -4.752477008757267, -21.880451076489855, -17.26698171679608, -25.689537444954208, -8.972481625382818, -5.021822256614272, -13.42071907230108, -29.065997282505847, -24.51489703213364, -34.35621002403289, -22.09748737336238, -18.137081752991538, -18.134023578424372, -27.86012856477669, -28.878229586253138, -15.958510446058787, -13.755881535450769, -19.70821080467757, -43.754981798726796, -34.069591171582665, -5.3416490935639, -30.724118386543154, -30.493738699552587, -42.53492742337851, -32.85571326042067, -26.657942309214224, -35.33642270360011, -36.02065671205914, -7.889967981619361, -43.70370212274716, -38.03639398490582], "policy_predator_policy_reward": [21.03943407695366, 11.931570517666133, 23.642285638230803, 26.36995005027839, 32.61713225112527, 48.034459449744176, 16.324932284867185, 19.33214191106968, 44.852653957914626, 22.593216272142723, 0.4878923247085072, 21.693149115178095, 27.34314864164014, 29.626194130840897, 32.51964218464942, 33.81217919025016, 36.9489854222802, 17.493074039290175, 6.0177951784115615, 31.099577622726404, 45.413801155201845, 37.180482773632384, 17.70935801832099, 18.790393124288144, 40.399696003964536, 28.9510732207196, 15.921419789753987, 10.891881876931082, 29.464257437078782, 4.330189347788688, 25.619585792058224, 22.285509062497866, 21.70416557583416, 8.805405940480458, 12.505289279857926, 21.97955031177721, 29.394410047468188, 25.29231825640846, 5.8230228797626715, 6.999332630309843, 46.31661632266449, 28.053188532687386, 27.12316042783431, 26.939971467959506, 20.927391438931892, 23.736726527377023, 6.961119650288223, 21.284924321068022, 39.36200929526012, 35.54025054131844, 27.136714006875753, 25.042684122024827, 34.51420220514862, 14.37357897998595, 41.15297352292638, 50.90530519382302, 36.502988863189145, 36.66233895470319, 31.373612156764874, 37.39950939538741, 13.658728295479214, 18.622777019911105, 19.72156721177098, 19.768552321879262, 25.566704370252612, 16.019150584994758, 48.35846208021707, 14.580469039017586, 24.892075723070022, 4.752477008757267, 21.880451076489855, 17.26698171679608, 25.689537444954208, 8.972481625382818, 5.021822256614272, 13.42071907230108, 29.065997282505847, 24.51489703213364, 34.35621002403289, 22.09748737336238, 18.137081752991538, 18.134023578424372, 27.86012856477669, 28.878229586253138, 15.958510446058787, 13.755881535450769, 19.70821080467757, 43.754981798726796, 34.069591171582665, 5.3416490935639, 30.724118386543154, 30.493738699552587, 42.53492742337851, 32.85571326042067, 26.657942309214224, 35.33642270360011, 36.02065671205914, 7.889967981619361, 43.70370212274716, 38.03639398490582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29398907416351816, "mean_inference_ms": 0.9385240167783923, "mean_action_processing_ms": 0.12544955802662905, "mean_env_wait_ms": 0.06639300739588777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002972722053527832, "StateBufferConnector_ms": 0.0023790597915649414, "ViewRequirementAgentConnector_ms": 0.0491483211517334}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.1953104767937, "num_env_steps_trained_throughput_per_sec": 673.1953104767937, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 5981.19, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5981.13, "sample_time_ms": 674.587, "learn_time_ms": 5290.679, "learn_throughput": 756.047, "synch_weights_time_ms": 15.335}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "training_iteration": 131, "trial_id": "abfb9_00000", "date": "2024-08-11_11-43-54", "timestamp": 1723391034, "time_this_iter_s": 5.947598934173584, "time_total_s": 778.0819401741028, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600fbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 778.0819401741028, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 33.75, "ram_util_percent": 83.38750000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1814769061282275, "cur_kl_coeff": 1.0913936421275136e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3439611645104985, "policy_loss": -0.0025131028528752116, "vf_loss": 1.3464742699017127, "vf_explained_var": 0.973076060352226, "kl": 0.0029147699712681902, "entropy": 0.32098711136107644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2873613194872937, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3196513735999664, "policy_loss": -0.005632093200498882, "vf_loss": 1.3252193773165346, "vf_explained_var": 0.9734168558691939, "kl": 0.009115267820503248, "entropy": 0.6342832320680221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.13, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6413, "policy_reward_min": {"prey_policy": -48.35846208021707, "predator_policy": 1.5004637163215864}, "policy_reward_max": {"prey_policy": -1.5004637163215864, "predator_policy": 48.35846208021707}, "policy_reward_mean": {"prey_policy": -25.435625679628142, "predator_policy": 25.435625679628142}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [75, 69, 80, 68, 55, 58, 52, 97, 61, 43, 67, 59, 56, 72, 56, 26, 23, 46, 68, 69, 66, 79, 42, 38, 54, 68, 36, 34, 95, 50, 51, 56, 63, 74, 79, 65, 42, 69, 69, 71, 75, 65, 49, 42, 86, 88, 82, 38, 46, 47, 79, 64, 54, 66, 88, 61, 80, 60, 81, 66, 69, 54, 59, 39, 95, 73, 20, 32, 74, 126, 25, 100, 34, 67, 57, 58, 78, 69, 72, 68, 71, 49, 78, 52, 51, 61, 70, 62, 85, 96, 46, 57, 75, 69, 77, 78, 125, 75, 80, 69], "policy_prey_policy_reward": [-37.39950939538741, -13.658728295479214, -18.622777019911105, -19.72156721177098, -19.768552321879262, -25.566704370252612, -16.019150584994758, -48.35846208021707, -14.580469039017586, -24.892075723070022, -4.752477008757267, -21.880451076489855, -17.26698171679608, -25.689537444954208, -8.972481625382818, -5.021822256614272, -13.42071907230108, -29.065997282505847, -24.51489703213364, -34.35621002403289, -22.09748737336238, -18.137081752991538, -18.134023578424372, -27.86012856477669, -28.878229586253138, -15.958510446058787, -13.755881535450769, -19.70821080467757, -43.754981798726796, -34.069591171582665, -5.3416490935639, -30.724118386543154, -30.493738699552587, -42.53492742337851, -32.85571326042067, -26.657942309214224, -35.33642270360011, -36.02065671205914, -7.889967981619361, -43.70370212274716, -38.03639398490582, -34.10158711561476, -28.32418021410842, -5.2808216712210445, -46.2556624141596, -36.24557535702874, -25.586301797305193, -1.5004637163215864, -25.275910290872183, -31.64641186192967, -15.690748594751426, -34.41446193952179, -32.461546432551216, -23.211457427567133, -22.473486464344997, -35.923773732290535, -46.05128820549913, -27.959297018144696, -42.987637450779935, -15.08484029853354, -24.366589727335686, -26.814470407472033, -37.7418014582352, -20.580284804405515, -28.391867390246215, -40.7953512328817, -9.887611107906062, -8.63560266523198, -28.799371128026223, -18.505947448724505, -3.6254070410556176, -45.421439390216754, -18.582715592803194, -20.332190685295718, -5.144599530478755, -28.355723945923465, -45.73124902703557, -9.390318536545799, -39.19888643676812, -28.558060543520064, -21.46472122411367, -26.66520707657844, -41.685475436396246, -11.731719919825357, -12.037143434054233, -38.04117134890217, -36.39159745226612, -22.880135245473145, -18.936684186053974, -43.69226856256377, -26.524650055494355, -23.80714524855106, -19.87034699373036, -8.35452252111904, -13.660767882841814, -29.946402715706597, -27.439494969546182, -37.471486592462206, -37.16807186863567, -30.979685253988873], "policy_predator_policy_reward": [37.39950939538741, 13.658728295479214, 18.622777019911105, 19.72156721177098, 19.768552321879262, 25.566704370252612, 16.019150584994758, 48.35846208021707, 14.580469039017586, 24.892075723070022, 4.752477008757267, 21.880451076489855, 17.26698171679608, 25.689537444954208, 8.972481625382818, 5.021822256614272, 13.42071907230108, 29.065997282505847, 24.51489703213364, 34.35621002403289, 22.09748737336238, 18.137081752991538, 18.134023578424372, 27.86012856477669, 28.878229586253138, 15.958510446058787, 13.755881535450769, 19.70821080467757, 43.754981798726796, 34.069591171582665, 5.3416490935639, 30.724118386543154, 30.493738699552587, 42.53492742337851, 32.85571326042067, 26.657942309214224, 35.33642270360011, 36.02065671205914, 7.889967981619361, 43.70370212274716, 38.03639398490582, 34.10158711561476, 28.32418021410842, 5.2808216712210445, 46.2556624141596, 36.24557535702874, 25.586301797305193, 1.5004637163215864, 25.275910290872183, 31.64641186192967, 15.690748594751426, 34.41446193952179, 32.461546432551216, 23.211457427567133, 22.473486464344997, 35.923773732290535, 46.05128820549913, 27.959297018144696, 42.987637450779935, 15.08484029853354, 24.366589727335686, 26.814470407472033, 37.7418014582352, 20.580284804405515, 28.391867390246215, 40.7953512328817, 9.887611107906062, 8.63560266523198, 28.799371128026223, 18.505947448724505, 3.6254070410556176, 45.421439390216754, 18.582715592803194, 20.332190685295718, 5.144599530478755, 28.355723945923465, 45.73124902703557, 9.390318536545799, 39.19888643676812, 28.558060543520064, 21.46472122411367, 26.66520707657844, 41.685475436396246, 11.731719919825357, 12.037143434054233, 38.04117134890217, 36.39159745226612, 22.880135245473145, 18.936684186053974, 43.69226856256377, 26.524650055494355, 23.80714524855106, 19.87034699373036, 8.35452252111904, 13.660767882841814, 29.946402715706597, 27.439494969546182, 37.471486592462206, 37.16807186863567, 30.979685253988873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2934365849968047, "mean_inference_ms": 0.9380784218951653, "mean_action_processing_ms": 0.12525314501639806, "mean_env_wait_ms": 0.06630524099900093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028117895126342773, "StateBufferConnector_ms": 0.0021708011627197266, "ViewRequirementAgentConnector_ms": 0.047113776206970215}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.332020393614, "num_env_steps_trained_throughput_per_sec": 702.332020393614, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 5965.641, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5965.582, "sample_time_ms": 672.841, "learn_time_ms": 5276.768, "learn_throughput": 758.04, "synch_weights_time_ms": 15.444}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 132, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-00", "timestamp": 1723391040, "time_this_iter_s": 5.700534820556641, "time_total_s": 783.7824749946594, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 783.7824749946594, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 27.8875, "ram_util_percent": 82.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.173187062640985, "cur_kl_coeff": 5.456968210637568e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3694785423576832, "policy_loss": -0.004643005813947335, "vf_loss": 1.374121552084883, "vf_explained_var": 0.9708779422566295, "kl": 0.006221488167300711, "entropy": 0.30904641483599943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1678569729129475, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3909118998174865, "policy_loss": -0.00905044303823767, "vf_loss": 1.3998646496484677, "vf_explained_var": 0.9703342340265712, "kl": 0.013894333416899305, "entropy": 0.6134594229981303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.11, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6611, "policy_reward_min": {"prey_policy": -57.44178947420265, "predator_policy": 2.1208354576706667}, "policy_reward_max": {"prey_policy": -2.1208354576706667, "predator_policy": 57.44178947420265}, "policy_reward_mean": {"prey_policy": -25.47165993219213, "predator_policy": 25.47165993219213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [54, 59, 39, 95, 73, 20, 32, 74, 126, 25, 100, 34, 67, 57, 58, 78, 69, 72, 68, 71, 49, 78, 52, 51, 61, 70, 62, 85, 96, 46, 57, 75, 69, 77, 78, 125, 75, 80, 69, 75, 53, 75, 39, 53, 109, 71, 101, 74, 34, 67, 75, 81, 60, 65, 67, 109, 64, 48, 67, 116, 79, 81, 51, 48, 35, 76, 87, 18, 73, 74, 78, 88, 56, 44, 95, 69, 64, 91, 75, 58, 85, 61, 50, 70, 65, 10, 58, 69, 60, 63, 55, 47, 45, 45, 71, 77, 85, 20, 89, 17], "policy_prey_policy_reward": [-26.814470407472033, -37.7418014582352, -20.580284804405515, -28.391867390246215, -40.7953512328817, -9.887611107906062, -8.63560266523198, -28.799371128026223, -18.505947448724505, -3.6254070410556176, -45.421439390216754, -18.582715592803194, -20.332190685295718, -5.144599530478755, -28.355723945923465, -45.73124902703557, -9.390318536545799, -39.19888643676812, -28.558060543520064, -21.46472122411367, -26.66520707657844, -41.685475436396246, -11.731719919825357, -12.037143434054233, -38.04117134890217, -36.39159745226612, -22.880135245473145, -18.936684186053974, -43.69226856256377, -26.524650055494355, -23.80714524855106, -19.87034699373036, -8.35452252111904, -13.660767882841814, -29.946402715706597, -27.439494969546182, -37.471486592462206, -37.16807186863567, -30.979685253988873, -35.29821600232739, -34.12321706091397, -18.019862164011275, -7.179391300046229, -19.81408370395843, -37.64694451508032, -27.028835177971608, -57.44178947420265, -23.413276655617835, -4.351547481668614, -25.523435475992905, -39.43159112487883, -34.74705834229518, -42.88489632621927, -39.961198178224876, -30.575263089247297, -20.492774220953457, -41.4905160597058, -4.205717332060613, -19.481071936964568, -13.246319901757936, -42.08827348883226, -35.183260663229774, -21.690238808792042, -24.744192901808862, -21.656447602858997, -35.10880261416471, -45.96692314871978, -2.1208354576706667, -16.98209627734066, -6.728079889312545, -44.76052197129087, -18.11925527091644, -41.90280740062293, -15.33661481973024, -23.662479315563267, -30.30978245447406, -11.859439579936968, -50.759106119562595, -12.126503919432727, -29.517182701118042, -29.572632539281745, -35.45852771142039, -37.58597303244383, -31.45048882069444, -36.63297896300476, -5.380146823197233, -30.27002884571707, -9.634479171976912, -32.15328065813685, -25.12531200580746, -17.46500072941093, -14.65193698678769, -9.016927707469662, -17.046222869467393, -9.848935435271056, -17.164375480583246, -36.6341926162304, -2.966313716346743, -45.245063589867314, -3.6417292255452285], "policy_predator_policy_reward": [26.814470407472033, 37.7418014582352, 20.580284804405515, 28.391867390246215, 40.7953512328817, 9.887611107906062, 8.63560266523198, 28.799371128026223, 18.505947448724505, 3.6254070410556176, 45.421439390216754, 18.582715592803194, 20.332190685295718, 5.144599530478755, 28.355723945923465, 45.73124902703557, 9.390318536545799, 39.19888643676812, 28.558060543520064, 21.46472122411367, 26.66520707657844, 41.685475436396246, 11.731719919825357, 12.037143434054233, 38.04117134890217, 36.39159745226612, 22.880135245473145, 18.936684186053974, 43.69226856256377, 26.524650055494355, 23.80714524855106, 19.87034699373036, 8.35452252111904, 13.660767882841814, 29.946402715706597, 27.439494969546182, 37.471486592462206, 37.16807186863567, 30.979685253988873, 35.29821600232739, 34.12321706091397, 18.019862164011275, 7.179391300046229, 19.81408370395843, 37.64694451508032, 27.028835177971608, 57.44178947420265, 23.413276655617835, 4.351547481668614, 25.523435475992905, 39.43159112487883, 34.74705834229518, 42.88489632621927, 39.961198178224876, 30.575263089247297, 20.492774220953457, 41.4905160597058, 4.205717332060613, 19.481071936964568, 13.246319901757936, 42.08827348883226, 35.183260663229774, 21.690238808792042, 24.744192901808862, 21.656447602858997, 35.10880261416471, 45.96692314871978, 2.1208354576706667, 16.98209627734066, 6.728079889312545, 44.76052197129087, 18.11925527091644, 41.90280740062293, 15.33661481973024, 23.662479315563267, 30.30978245447406, 11.859439579936968, 50.759106119562595, 12.126503919432727, 29.517182701118042, 29.572632539281745, 35.45852771142039, 37.58597303244383, 31.45048882069444, 36.63297896300476, 5.380146823197233, 30.27002884571707, 9.634479171976912, 32.15328065813685, 25.12531200580746, 17.46500072941093, 14.65193698678769, 9.016927707469662, 17.046222869467393, 9.848935435271056, 17.164375480583246, 36.6341926162304, 2.966313716346743, 45.245063589867314, 3.6417292255452285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29329064920022163, "mean_inference_ms": 0.9375911177368724, "mean_action_processing_ms": 0.12520430119753154, "mean_env_wait_ms": 0.06625141655371553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026416778564453125, "StateBufferConnector_ms": 0.001909017562866211, "ViewRequirementAgentConnector_ms": 0.04585099220275879}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.2593516128467, "num_env_steps_trained_throughput_per_sec": 681.2593516128467, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 5962.109, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5962.049, "sample_time_ms": 678.07, "learn_time_ms": 5267.961, "learn_throughput": 759.307, "synch_weights_time_ms": 15.492}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "training_iteration": 133, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-06", "timestamp": 1723391046, "time_this_iter_s": 5.87650203704834, "time_total_s": 789.6589770317078, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c4160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 789.6589770317078, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 26.41111111111111, "ram_util_percent": 81.98888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0783129477252564, "cur_kl_coeff": 5.456968210637568e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.275505371702214, "policy_loss": -0.0010364676471605585, "vf_loss": 1.2765418430169424, "vf_explained_var": 0.9710444540406267, "kl": 0.0029163494512966775, "entropy": 0.2690608545051267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2729267340153454, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.304202923923731, "policy_loss": -0.00996637352751956, "vf_loss": 1.3140826736576856, "vf_explained_var": 0.9708393909657995, "kl": 0.012318954684674406, "entropy": 0.5890570621316632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.5, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6350, "policy_reward_min": {"prey_policy": -54.729362281459025, "predator_policy": 2.1208354576706667}, "policy_reward_max": {"prey_policy": -2.1208354576706667, "predator_policy": 54.729362281459025}, "policy_reward_mean": {"prey_policy": -25.234100231217536, "predator_policy": 25.234100231217536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [48, 35, 76, 87, 18, 73, 74, 78, 88, 56, 44, 95, 69, 64, 91, 75, 58, 85, 61, 50, 70, 65, 10, 58, 69, 60, 63, 55, 47, 45, 45, 71, 77, 85, 20, 89, 17, 77, 58, 93, 46, 66, 47, 45, 36, 85, 20, 70, 83, 39, 55, 61, 78, 73, 47, 78, 74, 26, 79, 88, 49, 58, 48, 62, 63, 103, 68, 88, 70, 96, 46, 33, 86, 71, 52, 77, 24, 84, 45, 84, 121, 61, 107, 67, 71, 72, 22, 69, 57, 68, 81, 80, 46, 95, 52, 80, 45, 57, 46, 51], "policy_prey_policy_reward": [-24.744192901808862, -21.656447602858997, -35.10880261416471, -45.96692314871978, -2.1208354576706667, -16.98209627734066, -6.728079889312545, -44.76052197129087, -18.11925527091644, -41.90280740062293, -15.33661481973024, -23.662479315563267, -30.30978245447406, -11.859439579936968, -50.759106119562595, -12.126503919432727, -29.517182701118042, -29.572632539281745, -35.45852771142039, -37.58597303244383, -31.45048882069444, -36.63297896300476, -5.380146823197233, -30.27002884571707, -9.634479171976912, -32.15328065813685, -25.12531200580746, -17.46500072941093, -14.65193698678769, -9.016927707469662, -17.046222869467393, -9.848935435271056, -17.164375480583246, -36.6341926162304, -2.966313716346743, -45.245063589867314, -3.6417292255452285, -35.56515896278849, -38.821625025910905, -30.93745177054831, -14.5696795036306, -24.25455279033392, -34.831581582094366, -9.641141722564033, -8.833401192136584, -43.97683425907092, -9.231222467352813, -14.468320163391777, -44.4685529905997, -16.816765867522413, -12.718427641641716, -18.31845996354511, -33.10825965839207, -27.70148938238855, -20.81267030594688, -19.963795920834027, -20.383656445084085, -8.085341879357424, -46.05084502851134, -30.711209542238226, -4.293144224523572, -24.44041405983871, -31.588820377854795, -36.78258487791184, -48.67801521997594, -21.26618552172879, -24.06053327208488, -39.370583583863144, -23.888791973441407, -54.729362281459025, -43.06806349800859, -26.996370735825483, -32.2782177308914, -38.587129825664626, -24.045903696051987, -36.79196002317604, -10.649605248350975, -39.02602295524731, -7.926011595942195, -49.582305269563335, -18.4863352109121, -27.017690190880767, -27.887704425305746, -33.852494078331986, -15.979690009299212, -15.852773776632432, -13.737859973370659, -19.6139401898685, -32.095290178198006, -28.003967578823996, -19.852489964744393, -46.793106651572835, -28.406396736146444, -19.917436595689626, -4.329080227692982, -25.311883614218527, -19.058150967090484, -27.98237940396885, -16.152061384918813, -22.153203553613935], "policy_predator_policy_reward": [24.744192901808862, 21.656447602858997, 35.10880261416471, 45.96692314871978, 2.1208354576706667, 16.98209627734066, 6.728079889312545, 44.76052197129087, 18.11925527091644, 41.90280740062293, 15.33661481973024, 23.662479315563267, 30.30978245447406, 11.859439579936968, 50.759106119562595, 12.126503919432727, 29.517182701118042, 29.572632539281745, 35.45852771142039, 37.58597303244383, 31.45048882069444, 36.63297896300476, 5.380146823197233, 30.27002884571707, 9.634479171976912, 32.15328065813685, 25.12531200580746, 17.46500072941093, 14.65193698678769, 9.016927707469662, 17.046222869467393, 9.848935435271056, 17.164375480583246, 36.6341926162304, 2.966313716346743, 45.245063589867314, 3.6417292255452285, 35.56515896278849, 38.821625025910905, 30.93745177054831, 14.5696795036306, 24.25455279033392, 34.831581582094366, 9.641141722564033, 8.833401192136584, 43.97683425907092, 9.231222467352813, 14.468320163391777, 44.4685529905997, 16.816765867522413, 12.718427641641716, 18.31845996354511, 33.10825965839207, 27.70148938238855, 20.81267030594688, 19.963795920834027, 20.383656445084085, 8.085341879357424, 46.05084502851134, 30.711209542238226, 4.293144224523572, 24.44041405983871, 31.588820377854795, 36.78258487791184, 48.67801521997594, 21.26618552172879, 24.06053327208488, 39.370583583863144, 23.888791973441407, 54.729362281459025, 43.06806349800859, 26.996370735825483, 32.2782177308914, 38.587129825664626, 24.045903696051987, 36.79196002317604, 10.649605248350975, 39.02602295524731, 7.926011595942195, 49.582305269563335, 18.4863352109121, 27.017690190880767, 27.887704425305746, 33.852494078331986, 15.979690009299212, 15.852773776632432, 13.737859973370659, 19.6139401898685, 32.095290178198006, 28.003967578823996, 19.852489964744393, 46.793106651572835, 28.406396736146444, 19.917436595689626, 4.329080227692982, 25.311883614218527, 19.058150967090484, 27.98237940396885, 16.152061384918813, 22.153203553613935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2934062798550015, "mean_inference_ms": 0.9368142149758617, "mean_action_processing_ms": 0.1251793809761179, "mean_env_wait_ms": 0.06619788181481619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026580095291137695, "StateBufferConnector_ms": 0.0019419193267822266, "ViewRequirementAgentConnector_ms": 0.04520571231842041}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 676.9678621745556, "num_env_steps_trained_throughput_per_sec": 676.9678621745556, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 5972.755, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5972.696, "sample_time_ms": 672.581, "learn_time_ms": 5284.003, "learn_throughput": 757.002, "synch_weights_time_ms": 15.589}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 134, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-12", "timestamp": 1723391052, "time_this_iter_s": 5.914139986038208, "time_total_s": 795.573117017746, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cde50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 795.573117017746, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 29.975, "ram_util_percent": 81.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8584749289477864, "cur_kl_coeff": 2.728484105318784e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.271357309166342, "policy_loss": -0.0028848331242140074, "vf_loss": 1.274242139669756, "vf_explained_var": 0.9678226403892041, "kl": 0.005677359927662451, "entropy": 0.2961669477634132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9973277516663073, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2770988319690029, "policy_loss": -0.00847296808497049, "vf_loss": 1.2854874431466063, "vf_explained_var": 0.9672159142792225, "kl": 0.011997875691188452, "entropy": 0.5973065076395869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.54, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6554, "policy_reward_min": {"prey_policy": -54.729362281459025, "predator_policy": 2.6640408933089503}, "policy_reward_max": {"prey_policy": -2.6640408933089503, "predator_policy": 54.729362281459025}, "policy_reward_mean": {"prey_policy": -25.82962411043981, "predator_policy": 25.82962411043981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [62, 63, 103, 68, 88, 70, 96, 46, 33, 86, 71, 52, 77, 24, 84, 45, 84, 121, 61, 107, 67, 71, 72, 22, 69, 57, 68, 81, 80, 46, 95, 52, 80, 45, 57, 46, 51, 115, 22, 47, 132, 40, 90, 23, 71, 72, 53, 82, 37, 6, 19, 23, 76, 37, 74, 88, 94, 59, 93, 59, 103, 62, 86, 97, 63, 46, 63, 33, 65, 83, 78, 69, 49, 78, 110, 91, 73, 63, 84, 66, 22, 34, 36, 56, 33, 37, 24, 75, 58, 53, 64, 65, 61, 71, 99, 86, 87, 87, 80, 52], "policy_prey_policy_reward": [-36.78258487791184, -48.67801521997594, -21.26618552172879, -24.06053327208488, -39.370583583863144, -23.888791973441407, -54.729362281459025, -43.06806349800859, -26.996370735825483, -32.2782177308914, -38.587129825664626, -24.045903696051987, -36.79196002317604, -10.649605248350975, -39.02602295524731, -7.926011595942195, -49.582305269563335, -18.4863352109121, -27.017690190880767, -27.887704425305746, -33.852494078331986, -15.979690009299212, -15.852773776632432, -13.737859973370659, -19.6139401898685, -32.095290178198006, -28.003967578823996, -19.852489964744393, -46.793106651572835, -28.406396736146444, -19.917436595689626, -4.329080227692982, -25.311883614218527, -19.058150967090484, -27.98237940396885, -16.152061384918813, -22.153203553613935, -34.03775879644087, -7.025965018494469, -30.10833062993325, -39.960317985118884, -14.378464250441297, -19.91281906967164, -9.954445879390983, -38.90470414537724, -39.256691707935744, -5.862148436633116, -34.51606563004225, -18.939293447796587, -2.6640408933089503, -11.579348301780863, -15.013002209809802, -38.08368414134989, -4.670586089900365, -27.81184701932358, -42.498216054796124, -39.5108756521776, -7.639132582376933, -30.947020763850766, -11.05341318542755, -25.471634214969235, -42.144867588761734, -31.672758924512586, -35.131880951990496, -24.9734494573231, -15.01083333150216, -33.80543097591221, -19.496799737326274, -13.452750366587269, -39.537259846397895, -41.80893254126917, -3.1509154556898853, -22.132737713490602, -38.00958738762316, -35.89792669130464, -23.51426060809679, -37.21845152130991, -39.588212206877444, -44.978543858286066, -29.49366721387519, -6.524721064382135, -13.338857721796339, -20.098063140563156, -6.584203268419108, -18.790263293201168, -24.92651590104718, -17.070911809010575, -16.147454429399147, -5.402088052983818, -36.49209472854144, -34.980005643693474, -36.20141082390209, -21.860394134096808, -27.661117885931006, -12.881484472426106, -17.40592581322865, -45.517792853067604, -23.03859574720637, -36.20278041779992, -20.80707533833331], "policy_predator_policy_reward": [36.78258487791184, 48.67801521997594, 21.26618552172879, 24.06053327208488, 39.370583583863144, 23.888791973441407, 54.729362281459025, 43.06806349800859, 26.996370735825483, 32.2782177308914, 38.587129825664626, 24.045903696051987, 36.79196002317604, 10.649605248350975, 39.02602295524731, 7.926011595942195, 49.582305269563335, 18.4863352109121, 27.017690190880767, 27.887704425305746, 33.852494078331986, 15.979690009299212, 15.852773776632432, 13.737859973370659, 19.6139401898685, 32.095290178198006, 28.003967578823996, 19.852489964744393, 46.793106651572835, 28.406396736146444, 19.917436595689626, 4.329080227692982, 25.311883614218527, 19.058150967090484, 27.98237940396885, 16.152061384918813, 22.153203553613935, 34.03775879644087, 7.025965018494469, 30.10833062993325, 39.960317985118884, 14.378464250441297, 19.91281906967164, 9.954445879390983, 38.90470414537724, 39.256691707935744, 5.862148436633116, 34.51606563004225, 18.939293447796587, 2.6640408933089503, 11.579348301780863, 15.013002209809802, 38.08368414134989, 4.670586089900365, 27.81184701932358, 42.498216054796124, 39.5108756521776, 7.639132582376933, 30.947020763850766, 11.05341318542755, 25.471634214969235, 42.144867588761734, 31.672758924512586, 35.131880951990496, 24.9734494573231, 15.01083333150216, 33.80543097591221, 19.496799737326274, 13.452750366587269, 39.537259846397895, 41.80893254126917, 3.1509154556898853, 22.132737713490602, 38.00958738762316, 35.89792669130464, 23.51426060809679, 37.21845152130991, 39.588212206877444, 44.978543858286066, 29.49366721387519, 6.524721064382135, 13.338857721796339, 20.098063140563156, 6.584203268419108, 18.790263293201168, 24.92651590104718, 17.070911809010575, 16.147454429399147, 5.402088052983818, 36.49209472854144, 34.980005643693474, 36.20141082390209, 21.860394134096808, 27.661117885931006, 12.881484472426106, 17.40592581322865, 45.517792853067604, 23.03859574720637, 36.20278041779992, 20.80707533833331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29303478910822195, "mean_inference_ms": 0.9361432058084364, "mean_action_processing_ms": 0.12529928902203036, "mean_env_wait_ms": 0.06613923462755189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002703428268432617, "StateBufferConnector_ms": 0.0022867918014526367, "ViewRequirementAgentConnector_ms": 0.04512441158294678}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 722.6413538843335, "num_env_steps_trained_throughput_per_sec": 722.6413538843335, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 5942.914, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5942.868, "sample_time_ms": 672.166, "learn_time_ms": 5255.896, "learn_throughput": 761.05, "synch_weights_time_ms": 14.377}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 135, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-18", "timestamp": 1723391058, "time_this_iter_s": 5.540447950363159, "time_total_s": 801.1135649681091, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600fbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 801.1135649681091, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 27.0375, "ram_util_percent": 81.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1031198580438892, "cur_kl_coeff": 2.728484105318784e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4148307121669252, "policy_loss": -0.002842032587795984, "vf_loss": 1.4176727414752046, "vf_explained_var": 0.9669032319759329, "kl": 0.0035559697764000475, "entropy": 0.3004395678173751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2330339529862004, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.407326545442144, "policy_loss": -0.009363982758077326, "vf_loss": 1.4166190628893673, "vf_explained_var": 0.966133599045376, "kl": 0.010164299998537785, "entropy": 0.5851731379205982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.2, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6320, "policy_reward_min": {"prey_policy": -49.24258182860808, "predator_policy": 1.0210023896442424}, "policy_reward_max": {"prey_policy": -1.0210023896442424, "predator_policy": 49.24258182860808}, "policy_reward_mean": {"prey_policy": -25.049059504835423, "predator_policy": 25.049059504835423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [63, 46, 63, 33, 65, 83, 78, 69, 49, 78, 110, 91, 73, 63, 84, 66, 22, 34, 36, 56, 33, 37, 24, 75, 58, 53, 64, 65, 61, 71, 99, 86, 87, 87, 80, 52, 103, 75, 77, 80, 93, 21, 15, 74, 76, 69, 54, 70, 74, 50, 61, 73, 69, 78, 90, 84, 45, 57, 60, 65, 48, 54, 61, 49, 60, 57, 79, 17, 75, 68, 43, 78, 65, 56, 72, 94, 38, 50, 37, 82, 108, 27, 89, 42, 33, 88, 58, 87, 89, 51, 66, 40, 62, 67, 45, 80, 31, 62, 39, 66], "policy_prey_policy_reward": [-24.9734494573231, -15.01083333150216, -33.80543097591221, -19.496799737326274, -13.452750366587269, -39.537259846397895, -41.80893254126917, -3.1509154556898853, -22.132737713490602, -38.00958738762316, -35.89792669130464, -23.51426060809679, -37.21845152130991, -39.588212206877444, -44.978543858286066, -29.49366721387519, -6.524721064382135, -13.338857721796339, -20.098063140563156, -6.584203268419108, -18.790263293201168, -24.92651590104718, -17.070911809010575, -16.147454429399147, -5.402088052983818, -36.49209472854144, -34.980005643693474, -36.20141082390209, -21.860394134096808, -27.661117885931006, -12.881484472426106, -17.40592581322865, -45.517792853067604, -23.03859574720637, -36.20278041779992, -20.80707533833331, -18.207298261194982, -21.971162075953394, -16.988993655647114, -26.82307096390661, -38.492019576548046, -1.0210023896442424, -6.430839209589584, -42.4263098543667, -10.693298449234769, -29.528453419382526, -10.157746825609909, -40.59325225609626, -28.453697501828685, -34.105700905308595, -34.093315305280285, -33.752760239868564, -13.908712852636533, -32.88135155494212, -49.24258182860808, -23.648749630495125, -17.55488238248615, -33.93875112660705, -18.04048948397842, -30.8830013806906, -21.328009914070396, -26.399196661261875, -31.503805214039687, -18.317844362476382, -21.775392473156167, -20.904055076151057, -16.584017920247618, -2.110371080247801, -30.119362934022273, -44.34292122578647, -21.292653456585818, -41.98266524897535, -11.140383728390034, -19.048091254421802, -16.54079054391631, -30.980265071172248, -7.095568697990992, -3.359771745133038, -17.117500575390515, -41.99095686629492, -36.656601051328366, -7.133386447293787, -46.57987533951523, -15.730382035845171, -20.76762522006147, -26.8568370086517, -36.76382066718489, -22.604390538684118, -30.27704490767972, -27.94248597439604, -44.41561100897105, -8.794925019141724, -16.43406228291074, -38.619086723240606, -22.38764064525478, -27.990926595630675, -7.677776526195993, -44.013372023993796, -15.396782633788963, -46.09073720223737], "policy_predator_policy_reward": [24.9734494573231, 15.01083333150216, 33.80543097591221, 19.496799737326274, 13.452750366587269, 39.537259846397895, 41.80893254126917, 3.1509154556898853, 22.132737713490602, 38.00958738762316, 35.89792669130464, 23.51426060809679, 37.21845152130991, 39.588212206877444, 44.978543858286066, 29.49366721387519, 6.524721064382135, 13.338857721796339, 20.098063140563156, 6.584203268419108, 18.790263293201168, 24.92651590104718, 17.070911809010575, 16.147454429399147, 5.402088052983818, 36.49209472854144, 34.980005643693474, 36.20141082390209, 21.860394134096808, 27.661117885931006, 12.881484472426106, 17.40592581322865, 45.517792853067604, 23.03859574720637, 36.20278041779992, 20.80707533833331, 18.207298261194982, 21.971162075953394, 16.988993655647114, 26.82307096390661, 38.492019576548046, 1.0210023896442424, 6.430839209589584, 42.4263098543667, 10.693298449234769, 29.528453419382526, 10.157746825609909, 40.59325225609626, 28.453697501828685, 34.105700905308595, 34.093315305280285, 33.752760239868564, 13.908712852636533, 32.88135155494212, 49.24258182860808, 23.648749630495125, 17.55488238248615, 33.93875112660705, 18.04048948397842, 30.8830013806906, 21.328009914070396, 26.399196661261875, 31.503805214039687, 18.317844362476382, 21.775392473156167, 20.904055076151057, 16.584017920247618, 2.110371080247801, 30.119362934022273, 44.34292122578647, 21.292653456585818, 41.98266524897535, 11.140383728390034, 19.048091254421802, 16.54079054391631, 30.980265071172248, 7.095568697990992, 3.359771745133038, 17.117500575390515, 41.99095686629492, 36.656601051328366, 7.133386447293787, 46.57987533951523, 15.730382035845171, 20.76762522006147, 26.8568370086517, 36.76382066718489, 22.604390538684118, 30.27704490767972, 27.94248597439604, 44.41561100897105, 8.794925019141724, 16.43406228291074, 38.619086723240606, 22.38764064525478, 27.990926595630675, 7.677776526195993, 44.013372023993796, 15.396782633788963, 46.09073720223737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2930559650938244, "mean_inference_ms": 0.9361407665526369, "mean_action_processing_ms": 0.12530088734760386, "mean_env_wait_ms": 0.06613360619773417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025643110275268555, "StateBufferConnector_ms": 0.0019800662994384766, "ViewRequirementAgentConnector_ms": 0.046575188636779785}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.1739417361019, "num_env_steps_trained_throughput_per_sec": 677.1739417361019, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 5901.903, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5901.859, "sample_time_ms": 672.283, "learn_time_ms": 5214.542, "learn_throughput": 767.086, "synch_weights_time_ms": 14.614}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 136, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-23", "timestamp": 1723391063, "time_this_iter_s": 5.914793968200684, "time_total_s": 807.0283589363098, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d19d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 807.0283589363098, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 29.577777777777776, "ram_util_percent": 81.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.421589239748816, "cur_kl_coeff": 1.364242052659392e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4961695099559924, "policy_loss": -0.008749728339413803, "vf_loss": 1.5049192431072393, "vf_explained_var": 0.9720995627964536, "kl": 0.006304279170111122, "entropy": 0.3542675906792283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6236671283841133, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5208572945247094, "policy_loss": -0.0029670722731680145, "vf_loss": 1.523770734295249, "vf_explained_var": 0.9720016058534384, "kl": 0.007627584191960622, "entropy": 0.5936302515367667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.54, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6454, "policy_reward_min": {"prey_policy": -59.15832082348311, "predator_policy": 2.110371080247801}, "policy_reward_max": {"prey_policy": -2.110371080247801, "predator_policy": 59.15832082348311}, "policy_reward_mean": {"prey_policy": -25.548952977328444, "predator_policy": 25.548952977328444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [65, 48, 54, 61, 49, 60, 57, 79, 17, 75, 68, 43, 78, 65, 56, 72, 94, 38, 50, 37, 82, 108, 27, 89, 42, 33, 88, 58, 87, 89, 51, 66, 40, 62, 67, 45, 80, 31, 62, 39, 66, 88, 51, 75, 90, 50, 79, 49, 78, 74, 65, 73, 30, 60, 38, 54, 53, 50, 90, 65, 25, 63, 91, 63, 76, 82, 71, 72, 75, 64, 75, 30, 56, 66, 65, 85, 51, 76, 45, 65, 36, 74, 60, 117, 47, 90, 70, 76, 35, 83, 43, 81, 85, 104, 97, 66, 67, 81, 66, 90], "policy_prey_policy_reward": [-30.8830013806906, -21.328009914070396, -26.399196661261875, -31.503805214039687, -18.317844362476382, -21.775392473156167, -20.904055076151057, -16.584017920247618, -2.110371080247801, -30.119362934022273, -44.34292122578647, -21.292653456585818, -41.98266524897535, -11.140383728390034, -19.048091254421802, -16.54079054391631, -30.980265071172248, -7.095568697990992, -3.359771745133038, -17.117500575390515, -41.99095686629492, -36.656601051328366, -7.133386447293787, -46.57987533951523, -15.730382035845171, -20.76762522006147, -26.8568370086517, -36.76382066718489, -22.604390538684118, -30.27704490767972, -27.94248597439604, -44.41561100897105, -8.794925019141724, -16.43406228291074, -38.619086723240606, -22.38764064525478, -27.990926595630675, -7.677776526195993, -44.013372023993796, -15.396782633788963, -46.09073720223737, -59.15832082348311, -19.97071434242774, -20.49107134957017, -36.6194005535362, -14.9582468029092, -29.995558149759596, -37.7957953006836, -30.037974323991477, -27.745302006767478, -30.76467125136743, -31.52574544407534, -7.456757993931731, -12.788050117968657, -9.35530651416739, -14.09580414221838, -13.044424243847223, -41.320352544292106, -26.725825345762576, -24.05485677950988, -19.54668355117865, -24.59599867506483, -20.85818425058419, -3.1142473444245584, -14.924343761143184, -38.15169902110121, -35.30979527240124, -27.001432320115967, -44.8716874692214, -17.83179325409841, -33.789037855318306, -7.1134012884754, -23.904299696496608, -20.69780172506893, -32.46358104138382, -25.203886808251188, -13.031196926291614, -31.27615126634277, -20.826904310133166, -37.301885418336376, -6.5206947505248944, -30.756959257542043, -10.106351043032705, -28.28088117381959, -26.71278195092241, -48.430408973175005, -22.891463686156158, -14.004634639045417, -8.312452638672541, -40.071331261105335, -17.490138914194734, -45.06514244937207, -29.76015794302214, -54.6868053911564, -26.02454147862149, -18.21879082496319, -9.369004687762004, -35.54187790902071, -37.61496777907226, -47.36772641353519], "policy_predator_policy_reward": [30.8830013806906, 21.328009914070396, 26.399196661261875, 31.503805214039687, 18.317844362476382, 21.775392473156167, 20.904055076151057, 16.584017920247618, 2.110371080247801, 30.119362934022273, 44.34292122578647, 21.292653456585818, 41.98266524897535, 11.140383728390034, 19.048091254421802, 16.54079054391631, 30.980265071172248, 7.095568697990992, 3.359771745133038, 17.117500575390515, 41.99095686629492, 36.656601051328366, 7.133386447293787, 46.57987533951523, 15.730382035845171, 20.76762522006147, 26.8568370086517, 36.76382066718489, 22.604390538684118, 30.27704490767972, 27.94248597439604, 44.41561100897105, 8.794925019141724, 16.43406228291074, 38.619086723240606, 22.38764064525478, 27.990926595630675, 7.677776526195993, 44.013372023993796, 15.396782633788963, 46.09073720223737, 59.15832082348311, 19.97071434242774, 20.49107134957017, 36.6194005535362, 14.9582468029092, 29.995558149759596, 37.7957953006836, 30.037974323991477, 27.745302006767478, 30.76467125136743, 31.52574544407534, 7.456757993931731, 12.788050117968657, 9.35530651416739, 14.09580414221838, 13.044424243847223, 41.320352544292106, 26.725825345762576, 24.05485677950988, 19.54668355117865, 24.59599867506483, 20.85818425058419, 3.1142473444245584, 14.924343761143184, 38.15169902110121, 35.30979527240124, 27.001432320115967, 44.8716874692214, 17.83179325409841, 33.789037855318306, 7.1134012884754, 23.904299696496608, 20.69780172506893, 32.46358104138382, 25.203886808251188, 13.031196926291614, 31.27615126634277, 20.826904310133166, 37.301885418336376, 6.5206947505248944, 30.756959257542043, 10.106351043032705, 28.28088117381959, 26.71278195092241, 48.430408973175005, 22.891463686156158, 14.004634639045417, 8.312452638672541, 40.071331261105335, 17.490138914194734, 45.06514244937207, 29.76015794302214, 54.6868053911564, 26.02454147862149, 18.21879082496319, 9.369004687762004, 35.54187790902071, 37.61496777907226, 47.36772641353519]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29318175453114487, "mean_inference_ms": 0.9362884771024453, "mean_action_processing_ms": 0.12521063041353214, "mean_env_wait_ms": 0.06619621774352166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002817869186401367, "StateBufferConnector_ms": 0.002186894416809082, "ViewRequirementAgentConnector_ms": 0.05413401126861572}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.4083972468359, "num_env_steps_trained_throughput_per_sec": 673.4083972468359, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 5894.075, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5894.031, "sample_time_ms": 672.388, "learn_time_ms": 5206.642, "learn_throughput": 768.25, "synch_weights_time_ms": 14.59}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "training_iteration": 137, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-29", "timestamp": 1723391069, "time_this_iter_s": 5.944699048995972, "time_total_s": 812.9730579853058, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17de160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 812.9730579853058, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 32.775, "ram_util_percent": 80.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.061251273130377, "cur_kl_coeff": 1.364242052659392e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3672210707639654, "policy_loss": -0.000892899230044956, "vf_loss": 1.3681139693285027, "vf_explained_var": 0.9694599929576119, "kl": 0.003788469130463046, "entropy": 0.31362220326748985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.318585783491532, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3844983108341693, "policy_loss": -0.008691568480086669, "vf_loss": 1.3930687190343936, "vf_explained_var": 0.9695226735745867, "kl": 0.017231896773442057, "entropy": 0.5853768402710557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.61, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6661, "policy_reward_min": {"prey_policy": -54.6868053911564, "predator_policy": 3.1142473444245584}, "policy_reward_max": {"prey_policy": -3.1142473444245584, "predator_policy": 54.6868053911564}, "policy_reward_mean": {"prey_policy": -26.38178542412782, "predator_policy": 26.38178542412782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [25, 63, 91, 63, 76, 82, 71, 72, 75, 64, 75, 30, 56, 66, 65, 85, 51, 76, 45, 65, 36, 74, 60, 117, 47, 90, 70, 76, 35, 83, 43, 81, 85, 104, 97, 66, 67, 81, 66, 90, 69, 65, 69, 62, 59, 89, 37, 19, 72, 49, 64, 78, 43, 58, 38, 61, 62, 72, 60, 56, 73, 78, 39, 72, 58, 33, 75, 60, 60, 68, 64, 44, 21, 51, 52, 94, 92, 85, 74, 116, 97, 71, 86, 44, 102, 99, 71, 73, 83, 47, 52, 88, 45, 74, 48, 54, 56, 59, 80, 77], "policy_prey_policy_reward": [-19.54668355117865, -24.59599867506483, -20.85818425058419, -3.1142473444245584, -14.924343761143184, -38.15169902110121, -35.30979527240124, -27.001432320115967, -44.8716874692214, -17.83179325409841, -33.789037855318306, -7.1134012884754, -23.904299696496608, -20.69780172506893, -32.46358104138382, -25.203886808251188, -13.031196926291614, -31.27615126634277, -20.826904310133166, -37.301885418336376, -6.5206947505248944, -30.756959257542043, -10.106351043032705, -28.28088117381959, -26.71278195092241, -48.430408973175005, -22.891463686156158, -14.004634639045417, -8.312452638672541, -40.071331261105335, -17.490138914194734, -45.06514244937207, -29.76015794302214, -54.6868053911564, -26.02454147862149, -18.21879082496319, -9.369004687762004, -35.54187790902071, -37.61496777907226, -47.36772641353519, -33.32735306673596, -24.759121676736907, -25.823232385925067, -30.28070683274505, -16.355199889810585, -35.277155791019084, -8.08691373570775, -11.98554017988008, -27.490964036441763, -21.748629748534263, -25.068190771405433, -35.15883798200393, -21.563845845230666, -13.020903289323424, -9.032597475775567, -19.562775779110606, -29.983909401573246, -44.87458314958647, -25.913947263501854, -21.664125371287703, -25.550874299191143, -42.478174249183894, -21.6448783571583, -36.457170285512916, -15.910047211350207, -3.6714948517754276, -43.077142398608615, -34.82028308767891, -14.90219342195329, -30.207591047920353, -27.606948467726177, -28.849452239838005, -7.063338892884445, -18.488403977616574, -9.181238563536464, -53.2910956070399, -48.701776547143815, -28.429765364904647, -35.20624387048851, -22.150463162087473, -28.84720483535356, -28.503386694593168, -47.35201644484891, -16.795697609014713, -44.85761789473342, -13.544359146492608, -35.21704049447877, -30.869421563999406, -22.76212269259532, -43.19800566875893, -23.05172591151133, -42.69649325401415, -30.63242500149597, -43.44732758985132, -3.1548416169067224, -17.846214198454213, -36.18665534150275, -20.640695542796916, -26.494467122815074, -4.3725897924817145], "policy_predator_policy_reward": [19.54668355117865, 24.59599867506483, 20.85818425058419, 3.1142473444245584, 14.924343761143184, 38.15169902110121, 35.30979527240124, 27.001432320115967, 44.8716874692214, 17.83179325409841, 33.789037855318306, 7.1134012884754, 23.904299696496608, 20.69780172506893, 32.46358104138382, 25.203886808251188, 13.031196926291614, 31.27615126634277, 20.826904310133166, 37.301885418336376, 6.5206947505248944, 30.756959257542043, 10.106351043032705, 28.28088117381959, 26.71278195092241, 48.430408973175005, 22.891463686156158, 14.004634639045417, 8.312452638672541, 40.071331261105335, 17.490138914194734, 45.06514244937207, 29.76015794302214, 54.6868053911564, 26.02454147862149, 18.21879082496319, 9.369004687762004, 35.54187790902071, 37.61496777907226, 47.36772641353519, 33.32735306673596, 24.759121676736907, 25.823232385925067, 30.28070683274505, 16.355199889810585, 35.277155791019084, 8.08691373570775, 11.98554017988008, 27.490964036441763, 21.748629748534263, 25.068190771405433, 35.15883798200393, 21.563845845230666, 13.020903289323424, 9.032597475775567, 19.562775779110606, 29.983909401573246, 44.87458314958647, 25.913947263501854, 21.664125371287703, 25.550874299191143, 42.478174249183894, 21.6448783571583, 36.457170285512916, 15.910047211350207, 3.6714948517754276, 43.077142398608615, 34.82028308767891, 14.90219342195329, 30.207591047920353, 27.606948467726177, 28.849452239838005, 7.063338892884445, 18.488403977616574, 9.181238563536464, 53.2910956070399, 48.701776547143815, 28.429765364904647, 35.20624387048851, 22.150463162087473, 28.84720483535356, 28.503386694593168, 47.35201644484891, 16.795697609014713, 44.85761789473342, 13.544359146492608, 35.21704049447877, 30.869421563999406, 22.76212269259532, 43.19800566875893, 23.05172591151133, 42.69649325401415, 30.63242500149597, 43.44732758985132, 3.1548416169067224, 17.846214198454213, 36.18665534150275, 20.640695542796916, 26.494467122815074, 4.3725897924817145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29312423682377703, "mean_inference_ms": 0.9362176306091786, "mean_action_processing_ms": 0.1252870196157593, "mean_env_wait_ms": 0.06622212381800865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030444860458374023, "StateBufferConnector_ms": 0.0022096633911132812, "ViewRequirementAgentConnector_ms": 0.05341064929962158}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 678.8770707719729, "num_env_steps_trained_throughput_per_sec": 678.8770707719729, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 5871.884, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5871.842, "sample_time_ms": 670.287, "learn_time_ms": 5186.6, "learn_throughput": 771.218, "synch_weights_time_ms": 14.56}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 138, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-35", "timestamp": 1723391075, "time_this_iter_s": 5.897021770477295, "time_total_s": 818.8700797557831, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 818.8700797557831, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 29.037499999999998, "ram_util_percent": 80.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.980852335256835, "cur_kl_coeff": 6.82121026329696e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0256621529037753, "policy_loss": -0.0022295027568664714, "vf_loss": 1.027891654893756, "vf_explained_var": 0.9819737146298091, "kl": 0.004157687952402663, "entropy": 0.31770180639189977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9683461976548036, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0073277450477083, "policy_loss": -0.005546660406010536, "vf_loss": 1.012811028646926, "vf_explained_var": 0.9823742885763447, "kl": 0.009013561884532263, "entropy": 0.5364551759014528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.85, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6585, "policy_reward_min": {"prey_policy": -53.2910956070399, "predator_policy": 2.881523522491533}, "policy_reward_max": {"prey_policy": -2.881523522491533, "predator_policy": 53.2910956070399}, "policy_reward_mean": {"prey_policy": -27.43618645032666, "predator_policy": 27.43618645032666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [72, 58, 33, 75, 60, 60, 68, 64, 44, 21, 51, 52, 94, 92, 85, 74, 116, 97, 71, 86, 44, 102, 99, 71, 73, 83, 47, 52, 88, 45, 74, 48, 54, 56, 59, 80, 77, 80, 92, 69, 32, 64, 72, 63, 94, 27, 45, 81, 84, 48, 61, 57, 70, 66, 57, 93, 68, 64, 83, 28, 74, 45, 56, 57, 65, 79, 72, 75, 44, 80, 71, 58, 75, 67, 62, 33, 81, 87, 60, 61, 45, 59, 103, 71, 49, 38, 84, 76, 52, 88, 60, 77, 71, 69, 24, 56, 48, 46, 73, 71], "policy_prey_policy_reward": [-36.457170285512916, -15.910047211350207, -3.6714948517754276, -43.077142398608615, -34.82028308767891, -14.90219342195329, -30.207591047920353, -27.606948467726177, -28.849452239838005, -7.063338892884445, -18.488403977616574, -9.181238563536464, -53.2910956070399, -48.701776547143815, -28.429765364904647, -35.20624387048851, -22.150463162087473, -28.84720483535356, -28.503386694593168, -47.35201644484891, -16.795697609014713, -44.85761789473342, -13.544359146492608, -35.21704049447877, -30.869421563999406, -22.76212269259532, -43.19800566875893, -23.05172591151133, -42.69649325401415, -30.63242500149597, -43.44732758985132, -3.1548416169067224, -17.846214198454213, -36.18665534150275, -20.640695542796916, -26.494467122815074, -4.3725897924817145, -48.80215417457008, -25.693515127993393, -40.58908411654901, -12.018312726361334, -32.79441981204097, -46.763961236524906, -20.893086879151706, -45.12700523504029, -5.948280514307514, -22.897876964685096, -41.31303038546679, -41.30301693768106, -9.045920002122418, -31.78096149700541, -29.3183905187415, -16.649533193317883, -19.99820803337089, -19.985708544649686, -48.36607346817891, -40.2192073985831, -25.182732124700042, -39.61545549463451, -9.89553830390567, -16.826931867255624, -12.585798874673149, -23.46359680900634, -36.0681913878075, -40.92795537835034, -43.00494707482602, -45.42039215333967, -20.31686934094965, -16.389271116738108, -20.48357770655483, -25.894006185635995, -37.53996255652497, -37.21833385753725, -4.068463748568176, -24.878986121031666, -2.9412686145604834, -37.9293925160988, -49.74051824364632, -26.03071205499029, -39.15895226516802, -21.325711754506802, -32.08558483425835, -12.284093829812692, -24.27734508166293, -10.891698329310515, -19.30183322347834, -30.47384958147193, -40.64562882782027, -38.036324157360156, -49.6260223520114, -25.386223740052674, -24.901321982202965, -41.95950975191398, -32.82993845008757, -8.92796487503293, -2.881523522491533, -8.599714238418287, -27.992341992589495, -23.067304900749722, -14.550151629824274], "policy_predator_policy_reward": [36.457170285512916, 15.910047211350207, 3.6714948517754276, 43.077142398608615, 34.82028308767891, 14.90219342195329, 30.207591047920353, 27.606948467726177, 28.849452239838005, 7.063338892884445, 18.488403977616574, 9.181238563536464, 53.2910956070399, 48.701776547143815, 28.429765364904647, 35.20624387048851, 22.150463162087473, 28.84720483535356, 28.503386694593168, 47.35201644484891, 16.795697609014713, 44.85761789473342, 13.544359146492608, 35.21704049447877, 30.869421563999406, 22.76212269259532, 43.19800566875893, 23.05172591151133, 42.69649325401415, 30.63242500149597, 43.44732758985132, 3.1548416169067224, 17.846214198454213, 36.18665534150275, 20.640695542796916, 26.494467122815074, 4.3725897924817145, 48.80215417457008, 25.693515127993393, 40.58908411654901, 12.018312726361334, 32.79441981204097, 46.763961236524906, 20.893086879151706, 45.12700523504029, 5.948280514307514, 22.897876964685096, 41.31303038546679, 41.30301693768106, 9.045920002122418, 31.78096149700541, 29.3183905187415, 16.649533193317883, 19.99820803337089, 19.985708544649686, 48.36607346817891, 40.2192073985831, 25.182732124700042, 39.61545549463451, 9.89553830390567, 16.826931867255624, 12.585798874673149, 23.46359680900634, 36.0681913878075, 40.92795537835034, 43.00494707482602, 45.42039215333967, 20.31686934094965, 16.389271116738108, 20.48357770655483, 25.894006185635995, 37.53996255652497, 37.21833385753725, 4.068463748568176, 24.878986121031666, 2.9412686145604834, 37.9293925160988, 49.74051824364632, 26.03071205499029, 39.15895226516802, 21.325711754506802, 32.08558483425835, 12.284093829812692, 24.27734508166293, 10.891698329310515, 19.30183322347834, 30.47384958147193, 40.64562882782027, 38.036324157360156, 49.6260223520114, 25.386223740052674, 24.901321982202965, 41.95950975191398, 32.82993845008757, 8.92796487503293, 2.881523522491533, 8.599714238418287, 27.992341992589495, 23.067304900749722, 14.550151629824274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2931380863503077, "mean_inference_ms": 0.9361211427043602, "mean_action_processing_ms": 0.12529647871384458, "mean_env_wait_ms": 0.06619787772332635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002930760383605957, "StateBufferConnector_ms": 0.0021163225173950195, "ViewRequirementAgentConnector_ms": 0.049712300300598145}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 703.0730648495149, "num_env_steps_trained_throughput_per_sec": 703.0730648495149, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 5850.815, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5850.774, "sample_time_ms": 662.874, "learn_time_ms": 5173.128, "learn_throughput": 773.227, "synch_weights_time_ms": 14.432}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "training_iteration": 139, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-41", "timestamp": 1723391081, "time_this_iter_s": 5.6937291622161865, "time_total_s": 824.5638089179993, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cd8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 824.5638089179993, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 27.375, "ram_util_percent": 80.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.136351671256125, "cur_kl_coeff": 3.41060513164848e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.256879234376053, "policy_loss": -0.0024413112386052187, "vf_loss": 1.259320543706417, "vf_explained_var": 0.9726709167783459, "kl": 0.005678762747879543, "entropy": 0.324917376646772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1268902380019425, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2492677245599528, "policy_loss": -0.003989095273330652, "vf_loss": 1.253206125398477, "vf_explained_var": 0.9727263818805416, "kl": 0.007210274700053687, "entropy": 0.5249717772938312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.48, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6248, "policy_reward_min": {"prey_policy": -60.6018503277436, "predator_policy": 1.076324327515397}, "policy_reward_max": {"prey_policy": -1.076324327515397, "predator_policy": 60.6018503277436}, "policy_reward_mean": {"prey_policy": -26.082221768608665, "predator_policy": 26.082221768608665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [57, 65, 79, 72, 75, 44, 80, 71, 58, 75, 67, 62, 33, 81, 87, 60, 61, 45, 59, 103, 71, 49, 38, 84, 76, 52, 88, 60, 77, 71, 69, 24, 56, 48, 46, 73, 71, 67, 33, 89, 62, 84, 67, 57, 64, 80, 49, 68, 87, 57, 25, 58, 75, 67, 62, 63, 71, 101, 48, 19, 43, 83, 24, 51, 57, 77, 48, 51, 82, 86, 75, 76, 87, 70, 53, 86, 66, 49, 87, 71, 47, 53, 25, 39, 39, 30, 67, 43, 43, 33, 40, 76, 82, 62, 68, 110, 67, 45, 56, 61], "policy_prey_policy_reward": [-36.0681913878075, -40.92795537835034, -43.00494707482602, -45.42039215333967, -20.31686934094965, -16.389271116738108, -20.48357770655483, -25.894006185635995, -37.53996255652497, -37.21833385753725, -4.068463748568176, -24.878986121031666, -2.9412686145604834, -37.9293925160988, -49.74051824364632, -26.03071205499029, -39.15895226516802, -21.325711754506802, -32.08558483425835, -12.284093829812692, -24.27734508166293, -10.891698329310515, -19.30183322347834, -30.47384958147193, -40.64562882782027, -38.036324157360156, -49.6260223520114, -25.386223740052674, -24.901321982202965, -41.95950975191398, -32.82993845008757, -8.92796487503293, -2.881523522491533, -8.599714238418287, -27.992341992589495, -23.067304900749722, -14.550151629824274, -28.857090995873932, -7.1086974381745955, -34.1961441043028, -27.935526675137677, -33.31993539244567, -20.021839513869256, -33.24713127366601, -30.71875018426049, -9.095250600276312, -12.498899136744509, -32.54524034238597, -36.90545793611839, -19.56240812627104, -15.54247502497088, -33.577280019277204, -33.13211635901922, -43.051346485089205, -34.85560600492095, -24.477324227339054, -29.351595403292475, -60.6018503277436, -18.803679369220212, -1.076324327515397, -18.443048057235654, -47.535613936706795, -11.351468901736002, -7.995726517015964, -35.17909815337126, -31.842314222934878, -20.134588191362234, -8.834228484979178, -27.12308896450986, -45.79502141377737, -42.37631308833586, -38.25573847663899, -42.601425632897204, -26.134196083054583, -14.868516390481075, -27.83685345727581, -27.59015566076069, -23.995837587127593, -34.49714307309626, -35.46648824319043, -25.575595204751775, -7.38953192843571, -13.40663879250671, -9.274918900434015, -15.900085868928956, -21.057902938671813, -39.81909712369069, -15.468448213445699, -25.112448527687047, -10.46831692211194, -11.29011329344195, -18.297973539881127, -21.773942067793605, -24.379825398217598, -46.77287219177134, -42.26051233152255, -22.3067589519435, -16.207944209320285, -27.24378586043366, -7.820743414088847], "policy_predator_policy_reward": [36.0681913878075, 40.92795537835034, 43.00494707482602, 45.42039215333967, 20.31686934094965, 16.389271116738108, 20.48357770655483, 25.894006185635995, 37.53996255652497, 37.21833385753725, 4.068463748568176, 24.878986121031666, 2.9412686145604834, 37.9293925160988, 49.74051824364632, 26.03071205499029, 39.15895226516802, 21.325711754506802, 32.08558483425835, 12.284093829812692, 24.27734508166293, 10.891698329310515, 19.30183322347834, 30.47384958147193, 40.64562882782027, 38.036324157360156, 49.6260223520114, 25.386223740052674, 24.901321982202965, 41.95950975191398, 32.82993845008757, 8.92796487503293, 2.881523522491533, 8.599714238418287, 27.992341992589495, 23.067304900749722, 14.550151629824274, 28.857090995873932, 7.1086974381745955, 34.1961441043028, 27.935526675137677, 33.31993539244567, 20.021839513869256, 33.24713127366601, 30.71875018426049, 9.095250600276312, 12.498899136744509, 32.54524034238597, 36.90545793611839, 19.56240812627104, 15.54247502497088, 33.577280019277204, 33.13211635901922, 43.051346485089205, 34.85560600492095, 24.477324227339054, 29.351595403292475, 60.6018503277436, 18.803679369220212, 1.076324327515397, 18.443048057235654, 47.535613936706795, 11.351468901736002, 7.995726517015964, 35.17909815337126, 31.842314222934878, 20.134588191362234, 8.834228484979178, 27.12308896450986, 45.79502141377737, 42.37631308833586, 38.25573847663899, 42.601425632897204, 26.134196083054583, 14.868516390481075, 27.83685345727581, 27.59015566076069, 23.995837587127593, 34.49714307309626, 35.46648824319043, 25.575595204751775, 7.38953192843571, 13.40663879250671, 9.274918900434015, 15.900085868928956, 21.057902938671813, 39.81909712369069, 15.468448213445699, 25.112448527687047, 10.46831692211194, 11.29011329344195, 18.297973539881127, 21.773942067793605, 24.379825398217598, 46.77287219177134, 42.26051233152255, 22.3067589519435, 16.207944209320285, 27.24378586043366, 7.820743414088847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29310443841889977, "mean_inference_ms": 0.9355260517369939, "mean_action_processing_ms": 0.1252670579851989, "mean_env_wait_ms": 0.06613196755569059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002626776695251465, "StateBufferConnector_ms": 0.002253413200378418, "ViewRequirementAgentConnector_ms": 0.04497635364532471}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 706.1688189378596, "num_env_steps_trained_throughput_per_sec": 706.1688189378596, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 5804.523, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5804.488, "sample_time_ms": 656.748, "learn_time_ms": 5133.956, "learn_throughput": 779.126, "synch_weights_time_ms": 13.461}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 140, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-47", "timestamp": 1723391087, "time_this_iter_s": 5.669529914855957, "time_total_s": 830.2333388328552, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 830.2333388328552, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 25.788888888888884, "ram_util_percent": 80.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.159236926337083, "cur_kl_coeff": 3.41060513164848e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0351061639220764, "policy_loss": -0.0025509358589867284, "vf_loss": 1.0376570964232088, "vf_explained_var": 0.9829145988449455, "kl": 0.003284678772678262, "entropy": 0.3220168374944478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2194338109344245, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0548899319022893, "policy_loss": -0.007557431251916569, "vf_loss": 1.0623913068324327, "vf_explained_var": 0.9823974185933669, "kl": 0.007972831748398216, "entropy": 0.5264526513715585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 60.44, "episode_media": {}, "episodes_this_iter": 70, "episodes_timesteps_total": 6044, "policy_reward_min": {"prey_policy": -51.201864049481095, "predator_policy": 4.870341930605077}, "policy_reward_max": {"prey_policy": -4.870341930605077, "predator_policy": 51.201864049481095}, "policy_reward_mean": {"prey_policy": -23.724509716211333, "predator_policy": 23.724509716211333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [75, 76, 87, 70, 53, 86, 66, 49, 87, 71, 47, 53, 25, 39, 39, 30, 67, 43, 43, 33, 40, 76, 82, 62, 68, 110, 67, 45, 56, 61, 110, 62, 44, 34, 71, 66, 60, 67, 59, 17, 115, 28, 76, 43, 42, 39, 89, 74, 31, 33, 11, 50, 36, 89, 16, 42, 43, 90, 71, 88, 81, 59, 71, 15, 69, 71, 71, 86, 59, 72, 67, 48, 85, 82, 46, 75, 82, 48, 71, 82, 71, 49, 77, 53, 32, 61, 66, 51, 89, 49, 50, 49, 81, 71, 34, 62, 97, 36, 64, 60], "policy_prey_policy_reward": [-42.37631308833586, -38.25573847663899, -42.601425632897204, -26.134196083054583, -14.868516390481075, -27.83685345727581, -27.59015566076069, -23.995837587127593, -34.49714307309626, -35.46648824319043, -25.575595204751775, -7.38953192843571, -13.40663879250671, -9.274918900434015, -15.900085868928956, -21.057902938671813, -39.81909712369069, -15.468448213445699, -25.112448527687047, -10.46831692211194, -11.29011329344195, -18.297973539881127, -21.773942067793605, -24.379825398217598, -46.77287219177134, -42.26051233152255, -22.3067589519435, -16.207944209320285, -27.24378586043366, -7.820743414088847, -24.11360523735398, -7.798068955167294, -18.330519217217553, -9.25330110131613, -20.91232980093716, -27.72317297961507, -10.528150028982, -15.004720076725844, -10.075359148859157, -10.584427198327697, -22.284569293243823, -5.039735375774402, -47.31463118168987, -16.575109051647498, -5.142210235655855, -25.466159365714102, -46.31447636332557, -13.124688008800721, -18.902643625840824, -7.358097086599361, -6.39635378499603, -18.401943385786964, -21.64159663724102, -42.39592354484817, -8.07972193967333, -17.30994913709343, -17.886244764791122, -35.83737582248803, -14.703196838641972, -43.779675014877995, -36.32195170112371, -23.041515610824604, -43.81140431191854, -7.933173615780113, -15.658113430322013, -22.257929035450516, -30.103666630416864, -42.8367946772534, -36.62205133364705, -23.782639293165232, -33.24440310422079, -13.441194695231616, -41.57908099035108, -43.57221093346991, -18.64448799837295, -18.936771222077308, -37.45904826373127, -14.23998435950873, -34.16108414693763, -6.953285651886607, -36.75520370260326, -36.04346363468207, -42.75011022909568, -14.255219148933657, -13.97119215645782, -17.987219309398384, -17.033364725429653, -22.080924535791116, -51.201864049481095, -14.771059809638585, -18.10464464796459, -4.870341930605077, -42.205125078595216, -24.691690639195105, -7.727413612210179, -20.00197204933413, -42.357671175901565, -18.646212190868454, -27.648146491881814, -31.019263922206303], "policy_predator_policy_reward": [42.37631308833586, 38.25573847663899, 42.601425632897204, 26.134196083054583, 14.868516390481075, 27.83685345727581, 27.59015566076069, 23.995837587127593, 34.49714307309626, 35.46648824319043, 25.575595204751775, 7.38953192843571, 13.40663879250671, 9.274918900434015, 15.900085868928956, 21.057902938671813, 39.81909712369069, 15.468448213445699, 25.112448527687047, 10.46831692211194, 11.29011329344195, 18.297973539881127, 21.773942067793605, 24.379825398217598, 46.77287219177134, 42.26051233152255, 22.3067589519435, 16.207944209320285, 27.24378586043366, 7.820743414088847, 24.11360523735398, 7.798068955167294, 18.330519217217553, 9.25330110131613, 20.91232980093716, 27.72317297961507, 10.528150028982, 15.004720076725844, 10.075359148859157, 10.584427198327697, 22.284569293243823, 5.039735375774402, 47.31463118168987, 16.575109051647498, 5.142210235655855, 25.466159365714102, 46.31447636332557, 13.124688008800721, 18.902643625840824, 7.358097086599361, 6.39635378499603, 18.401943385786964, 21.64159663724102, 42.39592354484817, 8.07972193967333, 17.30994913709343, 17.886244764791122, 35.83737582248803, 14.703196838641972, 43.779675014877995, 36.32195170112371, 23.041515610824604, 43.81140431191854, 7.933173615780113, 15.658113430322013, 22.257929035450516, 30.103666630416864, 42.8367946772534, 36.62205133364705, 23.782639293165232, 33.24440310422079, 13.441194695231616, 41.57908099035108, 43.57221093346991, 18.64448799837295, 18.936771222077308, 37.45904826373127, 14.23998435950873, 34.16108414693763, 6.953285651886607, 36.75520370260326, 36.04346363468207, 42.75011022909568, 14.255219148933657, 13.97119215645782, 17.987219309398384, 17.033364725429653, 22.080924535791116, 51.201864049481095, 14.771059809638585, 18.10464464796459, 4.870341930605077, 42.205125078595216, 24.691690639195105, 7.727413612210179, 20.00197204933413, 42.357671175901565, 18.646212190868454, 27.648146491881814, 31.019263922206303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293235915613265, "mean_inference_ms": 0.9346370926778523, "mean_action_processing_ms": 0.12533539249439815, "mean_env_wait_ms": 0.06606741543474483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002878904342651367, "StateBufferConnector_ms": 0.0019577741622924805, "ViewRequirementAgentConnector_ms": 0.046363115310668945}, "num_episodes": 70, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 680.4902662995844, "num_env_steps_trained_throughput_per_sec": 680.4902662995844, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 5798.152, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5798.117, "sample_time_ms": 657.71, "learn_time_ms": 5126.62, "learn_throughput": 780.241, "synch_weights_time_ms": 13.467}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 141, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-53", "timestamp": 1723391093, "time_this_iter_s": 5.883600950241089, "time_total_s": 836.1169397830963, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cd5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 836.1169397830963, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 28.4625, "ram_util_percent": 80.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9197368559738, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0015732175981005, "policy_loss": -0.0013349604235069516, "vf_loss": 1.0029081753765543, "vf_explained_var": 0.9853387965510289, "kl": 0.0035526960614957193, "entropy": 0.33234831200291715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.988451351846258, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9821837189607322, "policy_loss": -0.007844300879514775, "vf_loss": 0.9899539673700929, "vf_explained_var": 0.9860718257725238, "kl": 0.010532716783386102, "entropy": 0.5386529676616192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.75, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6175, "policy_reward_min": {"prey_policy": -57.47356767775812, "predator_policy": 1.120496015457003}, "policy_reward_max": {"prey_policy": -1.120496015457003, "predator_policy": 57.47356767775812}, "policy_reward_mean": {"prey_policy": -26.248432453097806, "predator_policy": 26.248432453097806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [69, 71, 71, 86, 59, 72, 67, 48, 85, 82, 46, 75, 82, 48, 71, 82, 71, 49, 77, 53, 32, 61, 66, 51, 89, 49, 50, 49, 81, 71, 34, 62, 97, 36, 64, 60, 65, 80, 23, 77, 78, 85, 88, 37, 42, 80, 55, 59, 61, 44, 105, 30, 72, 76, 87, 11, 56, 70, 24, 74, 53, 35, 59, 31, 64, 36, 33, 69, 80, 52, 120, 33, 62, 99, 75, 64, 40, 69, 50, 49, 35, 72, 51, 65, 80, 62, 56, 58, 77, 99, 44, 3, 64, 76, 39, 60, 49, 39, 98, 80], "policy_prey_policy_reward": [-15.658113430322013, -22.257929035450516, -30.103666630416864, -42.8367946772534, -36.62205133364705, -23.782639293165232, -33.24440310422079, -13.441194695231616, -41.57908099035108, -43.57221093346991, -18.64448799837295, -18.936771222077308, -37.45904826373127, -14.23998435950873, -34.16108414693763, -6.953285651886607, -36.75520370260326, -36.04346363468207, -42.75011022909568, -14.255219148933657, -13.97119215645782, -17.987219309398384, -17.033364725429653, -22.080924535791116, -51.201864049481095, -14.771059809638585, -18.10464464796459, -4.870341930605077, -42.205125078595216, -24.691690639195105, -7.727413612210179, -20.00197204933413, -42.357671175901565, -18.646212190868454, -27.648146491881814, -31.019263922206303, -32.648010487155034, -35.654836665047945, -5.756522679095677, -41.83488080375013, -49.453437056824974, -43.520873493733674, -31.075435552275685, -23.460784010877113, -22.215926204577798, -44.60073891704482, -14.962812776668088, -36.02308252650314, -34.09102761692834, -14.39479900430378, -31.678479167277025, -19.625725813578917, -15.361677729957762, -38.16125571941851, -49.07300796592632, -7.108491366626393, -28.98245419597349, -38.751423189668074, -1.120496015457003, -40.99811265498128, -24.052513266115163, -21.371989691286405, -4.281259783477274, -17.34860632638645, -20.616043048585947, -7.230410399893206, -13.923953117046104, -27.696935688179185, -46.864093199677896, -23.574459869996172, -34.97430116888004, -11.030529518783736, -43.36628335831956, -57.47356767775812, -4.8987206450824745, -13.768662566643501, -21.581432209572185, -7.908386921164615, -21.006700623124235, -9.761203387221244, -17.296003892381137, -23.726032592154873, -16.23743277563155, -45.39696757165864, -43.10126483630841, -21.758085512629304, -36.47162107521473, -23.739760990546852, -31.02670671923552, -22.706000478429537, -11.692599225105909, -2.673337386138317, -38.0147174631671, -46.98222322325232, -19.442578524766184, -33.48559360694782, -14.354186625131055, -15.072716679884728, -52.89224536563469, -37.87397787840053], "policy_predator_policy_reward": [15.658113430322013, 22.257929035450516, 30.103666630416864, 42.8367946772534, 36.62205133364705, 23.782639293165232, 33.24440310422079, 13.441194695231616, 41.57908099035108, 43.57221093346991, 18.64448799837295, 18.936771222077308, 37.45904826373127, 14.23998435950873, 34.16108414693763, 6.953285651886607, 36.75520370260326, 36.04346363468207, 42.75011022909568, 14.255219148933657, 13.97119215645782, 17.987219309398384, 17.033364725429653, 22.080924535791116, 51.201864049481095, 14.771059809638585, 18.10464464796459, 4.870341930605077, 42.205125078595216, 24.691690639195105, 7.727413612210179, 20.00197204933413, 42.357671175901565, 18.646212190868454, 27.648146491881814, 31.019263922206303, 32.648010487155034, 35.654836665047945, 5.756522679095677, 41.83488080375013, 49.453437056824974, 43.520873493733674, 31.075435552275685, 23.460784010877113, 22.215926204577798, 44.60073891704482, 14.962812776668088, 36.02308252650314, 34.09102761692834, 14.39479900430378, 31.678479167277025, 19.625725813578917, 15.361677729957762, 38.16125571941851, 49.07300796592632, 7.108491366626393, 28.98245419597349, 38.751423189668074, 1.120496015457003, 40.99811265498128, 24.052513266115163, 21.371989691286405, 4.281259783477274, 17.34860632638645, 20.616043048585947, 7.230410399893206, 13.923953117046104, 27.696935688179185, 46.864093199677896, 23.574459869996172, 34.97430116888004, 11.030529518783736, 43.36628335831956, 57.47356767775812, 4.8987206450824745, 13.768662566643501, 21.581432209572185, 7.908386921164615, 21.006700623124235, 9.761203387221244, 17.296003892381137, 23.726032592154873, 16.23743277563155, 45.39696757165864, 43.10126483630841, 21.758085512629304, 36.47162107521473, 23.739760990546852, 31.02670671923552, 22.706000478429537, 11.692599225105909, 2.673337386138317, 38.0147174631671, 46.98222322325232, 19.442578524766184, 33.48559360694782, 14.354186625131055, 15.072716679884728, 52.89224536563469, 37.87397787840053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29300564777667026, "mean_inference_ms": 0.9348817593831811, "mean_action_processing_ms": 0.12516759243070075, "mean_env_wait_ms": 0.06608972246523492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002865910530090332, "StateBufferConnector_ms": 0.0020170211791992188, "ViewRequirementAgentConnector_ms": 0.047698974609375}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.6023200578617, "num_env_steps_trained_throughput_per_sec": 685.6023200578617, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 5812.049, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5812.016, "sample_time_ms": 657.648, "learn_time_ms": 5140.751, "learn_throughput": 778.096, "synch_weights_time_ms": 13.301}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 142, "trial_id": "abfb9_00000", "date": "2024-08-11_11-44-58", "timestamp": 1723391098, "time_this_iter_s": 5.839644908905029, "time_total_s": 841.9565846920013, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 841.9565846920013, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 31.112499999999997, "ram_util_percent": 80.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.878536236534516, "cur_kl_coeff": 8.5265128291212e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3324713074912629, "policy_loss": -0.0030357679517085973, "vf_loss": 1.335507071763277, "vf_explained_var": 0.963823796560367, "kl": 0.005866200132407106, "entropy": 0.32581785536992053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9461134624357026, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3589255581920345, "policy_loss": -0.0074037455953657625, "vf_loss": 1.366246685013175, "vf_explained_var": 0.9632660760854681, "kl": 0.011749665329041174, "entropy": 0.5228596878548463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 60.12, "episode_media": {}, "episodes_this_iter": 66, "episodes_timesteps_total": 6012, "policy_reward_min": {"prey_policy": -57.47356767775812, "predator_policy": 1.2266023755592927}, "policy_reward_max": {"prey_policy": -1.2266023755592927, "predator_policy": 57.47356767775812}, "policy_reward_mean": {"prey_policy": -24.531369489259582, "predator_policy": 24.531369489259582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [33, 69, 80, 52, 120, 33, 62, 99, 75, 64, 40, 69, 50, 49, 35, 72, 51, 65, 80, 62, 56, 58, 77, 99, 44, 3, 64, 76, 39, 60, 49, 39, 98, 80, 69, 79, 45, 95, 126, 37, 34, 84, 45, 26, 96, 71, 32, 77, 43, 3, 80, 61, 116, 50, 59, 48, 31, 89, 102, 64, 45, 69, 14, 18, 83, 65, 69, 45, 28, 41, 30, 56, 46, 45, 61, 15, 40, 84, 78, 77, 65, 45, 84, 58, 66, 75, 64, 65, 37, 66, 83, 46, 60, 59, 67, 46, 53, 66, 77, 57], "policy_prey_policy_reward": [-13.923953117046104, -27.696935688179185, -46.864093199677896, -23.574459869996172, -34.97430116888004, -11.030529518783736, -43.36628335831956, -57.47356767775812, -4.8987206450824745, -13.768662566643501, -21.581432209572185, -7.908386921164615, -21.006700623124235, -9.761203387221244, -17.296003892381137, -23.726032592154873, -16.23743277563155, -45.39696757165864, -43.10126483630841, -21.758085512629304, -36.47162107521473, -23.739760990546852, -31.02670671923552, -22.706000478429537, -11.692599225105909, -2.673337386138317, -38.0147174631671, -46.98222322325232, -19.442578524766184, -33.48559360694782, -14.354186625131055, -15.072716679884728, -52.89224536563469, -37.87397787840053, -13.902238487735787, -41.003761310376966, -17.034494376133573, -16.428792762874732, -11.470377001160546, -22.942057362458442, -9.096414486204225, -36.11145408665565, -6.518697718349147, -14.605666273899699, -36.45096469670242, -32.11776962236826, -12.132325584077138, -50.476990918915774, -25.215447349741382, -1.5714192673085114, -30.643866856446962, -22.502432238318743, -37.41761242405821, -29.505220787047076, -11.748828758763445, -9.745695137719464, -8.019427993485802, -39.78216931338279, -37.076789443946524, -25.60075761185491, -33.887669543100955, -40.67094543690583, -1.2266023755592927, -4.423702139600585, -23.4508973010964, -39.50609897223875, -29.674916420948506, -32.33556518695177, -10.447178068874319, -23.545982501223826, -8.053817241934574, -34.74734980432187, -11.097961702892299, -3.4043725972741345, -33.63947565521255, -7.167670123933552, -5.211847825459837, -35.53958566854644, -40.08816221528689, -43.916405740935694, -35.98941503247587, -24.220027459605962, -15.231016241763513, -37.39746106145961, -19.812678062760973, -44.44840487292812, -11.714484845389839, -19.00173015723902, -6.96711169104202, -27.51115023592613, -16.568179658518602, -32.22978644169319, -25.642068172797003, -18.558244986582427, -27.23801328654718, -27.192017170444085, -26.061221598025767, -28.486775438815766, -30.84204279746675, -25.09395894812395], "policy_predator_policy_reward": [13.923953117046104, 27.696935688179185, 46.864093199677896, 23.574459869996172, 34.97430116888004, 11.030529518783736, 43.36628335831956, 57.47356767775812, 4.8987206450824745, 13.768662566643501, 21.581432209572185, 7.908386921164615, 21.006700623124235, 9.761203387221244, 17.296003892381137, 23.726032592154873, 16.23743277563155, 45.39696757165864, 43.10126483630841, 21.758085512629304, 36.47162107521473, 23.739760990546852, 31.02670671923552, 22.706000478429537, 11.692599225105909, 2.673337386138317, 38.0147174631671, 46.98222322325232, 19.442578524766184, 33.48559360694782, 14.354186625131055, 15.072716679884728, 52.89224536563469, 37.87397787840053, 13.902238487735787, 41.003761310376966, 17.034494376133573, 16.428792762874732, 11.470377001160546, 22.942057362458442, 9.096414486204225, 36.11145408665565, 6.518697718349147, 14.605666273899699, 36.45096469670242, 32.11776962236826, 12.132325584077138, 50.476990918915774, 25.215447349741382, 1.5714192673085114, 30.643866856446962, 22.502432238318743, 37.41761242405821, 29.505220787047076, 11.748828758763445, 9.745695137719464, 8.019427993485802, 39.78216931338279, 37.076789443946524, 25.60075761185491, 33.887669543100955, 40.67094543690583, 1.2266023755592927, 4.423702139600585, 23.4508973010964, 39.50609897223875, 29.674916420948506, 32.33556518695177, 10.447178068874319, 23.545982501223826, 8.053817241934574, 34.74734980432187, 11.097961702892299, 3.4043725972741345, 33.63947565521255, 7.167670123933552, 5.211847825459837, 35.53958566854644, 40.08816221528689, 43.916405740935694, 35.98941503247587, 24.220027459605962, 15.231016241763513, 37.39746106145961, 19.812678062760973, 44.44840487292812, 11.714484845389839, 19.00173015723902, 6.96711169104202, 27.51115023592613, 16.568179658518602, 32.22978644169319, 25.642068172797003, 18.558244986582427, 27.23801328654718, 27.192017170444085, 26.061221598025767, 28.486775438815766, 30.84204279746675, 25.09395894812395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29291329263930754, "mean_inference_ms": 0.9345469406908669, "mean_action_processing_ms": 0.12500272239116708, "mean_env_wait_ms": 0.06602879499656851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026040077209472656, "StateBufferConnector_ms": 0.0024148225784301758, "ViewRequirementAgentConnector_ms": 0.04535627365112305}, "num_episodes": 66, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 664.3918886703099, "num_env_steps_trained_throughput_per_sec": 664.3918886703099, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 5826.955, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5826.922, "sample_time_ms": 656.624, "learn_time_ms": 5156.798, "learn_throughput": 775.675, "synch_weights_time_ms": 13.185}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "training_iteration": 143, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-05", "timestamp": 1723391105, "time_this_iter_s": 6.025604009628296, "time_total_s": 847.9821887016296, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 847.9821887016296, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.511111111111113, "ram_util_percent": 80.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3249089709172646, "cur_kl_coeff": 8.5265128291212e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.45235677678138, "policy_loss": -0.0008777608425589278, "vf_loss": 1.4532345390568178, "vf_explained_var": 0.9664849190041422, "kl": 0.0029028551489373943, "entropy": 0.3208301428705454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4110445121924085, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4620891271779934, "policy_loss": -0.007763979060594769, "vf_loss": 1.4697724239279826, "vf_explained_var": 0.9660983320946495, "kl": 0.011475395929618182, "entropy": 0.5204583804743985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.81, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6281, "policy_reward_min": {"prey_policy": -50.96110185998822, "predator_policy": 3.4043725972741345}, "policy_reward_max": {"prey_policy": -3.4043725972741345, "predator_policy": 50.96110185998822}, "policy_reward_mean": {"prey_policy": -25.306625207347725, "predator_policy": 25.306625207347725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [83, 65, 69, 45, 28, 41, 30, 56, 46, 45, 61, 15, 40, 84, 78, 77, 65, 45, 84, 58, 66, 75, 64, 65, 37, 66, 83, 46, 60, 59, 67, 46, 53, 66, 77, 57, 69, 40, 83, 38, 86, 66, 58, 84, 56, 24, 67, 20, 65, 54, 70, 56, 105, 58, 50, 56, 51, 27, 70, 55, 51, 123, 86, 64, 65, 71, 80, 80, 42, 42, 69, 62, 37, 89, 82, 65, 55, 68, 84, 51, 37, 73, 64, 66, 86, 41, 52, 74, 64, 93, 59, 47, 82, 67, 86, 67, 56, 125, 75, 91], "policy_prey_policy_reward": [-23.4508973010964, -39.50609897223875, -29.674916420948506, -32.33556518695177, -10.447178068874319, -23.545982501223826, -8.053817241934574, -34.74734980432187, -11.097961702892299, -3.4043725972741345, -33.63947565521255, -7.167670123933552, -5.211847825459837, -35.53958566854644, -40.08816221528689, -43.916405740935694, -35.98941503247587, -24.220027459605962, -15.231016241763513, -37.39746106145961, -19.812678062760973, -44.44840487292812, -11.714484845389839, -19.00173015723902, -6.96711169104202, -27.51115023592613, -16.568179658518602, -32.22978644169319, -25.642068172797003, -18.558244986582427, -27.23801328654718, -27.192017170444085, -26.061221598025767, -28.486775438815766, -30.84204279746675, -25.09395894812395, -23.020462557293158, -18.578523518763973, -39.195240204028245, -30.791464006826686, -31.110393736588247, -26.5146185656586, -6.238509383521109, -30.20602876175526, -25.316725900820174, -5.53758682381068, -26.31350439107439, -12.410215096885526, -24.838262067377233, -28.24566083824366, -27.329314581716574, -27.80374328115663, -50.96110185998822, -23.413599853321728, -22.671550963974205, -35.758135820060694, -19.536112780865654, -13.720220770709657, -28.914021281477456, -30.863935999212504, -17.73644880262514, -29.238277487037248, -40.11141585608026, -32.952272204700854, -15.329424737412737, -43.33166346407193, -45.51049356097131, -6.360828052520421, -20.533248588451592, -19.947286871705263, -26.662438624416964, -13.197587935637841, -20.32090825361681, -24.561326896645152, -13.218685090123085, -36.359183426053626, -11.969019119150841, -20.61713415986355, -41.52429740999973, -8.00570050776853, -9.80591145473032, -37.72623596118179, -9.739542296104508, -19.207920088466803, -47.414499608513545, -12.147256374457568, -18.409385014476694, -43.137838870510684, -25.898966871287666, -45.57938182540104, -22.864641336249935, -33.855541416063225, -25.38113432559583, -12.660957000633893, -26.885891204827985, -36.44109733516365, -31.87712054930269, -15.720252055364009, -30.3833350713401, -46.71596279438015], "policy_predator_policy_reward": [23.4508973010964, 39.50609897223875, 29.674916420948506, 32.33556518695177, 10.447178068874319, 23.545982501223826, 8.053817241934574, 34.74734980432187, 11.097961702892299, 3.4043725972741345, 33.63947565521255, 7.167670123933552, 5.211847825459837, 35.53958566854644, 40.08816221528689, 43.916405740935694, 35.98941503247587, 24.220027459605962, 15.231016241763513, 37.39746106145961, 19.812678062760973, 44.44840487292812, 11.714484845389839, 19.00173015723902, 6.96711169104202, 27.51115023592613, 16.568179658518602, 32.22978644169319, 25.642068172797003, 18.558244986582427, 27.23801328654718, 27.192017170444085, 26.061221598025767, 28.486775438815766, 30.84204279746675, 25.09395894812395, 23.020462557293158, 18.578523518763973, 39.195240204028245, 30.791464006826686, 31.110393736588247, 26.5146185656586, 6.238509383521109, 30.20602876175526, 25.316725900820174, 5.53758682381068, 26.31350439107439, 12.410215096885526, 24.838262067377233, 28.24566083824366, 27.329314581716574, 27.80374328115663, 50.96110185998822, 23.413599853321728, 22.671550963974205, 35.758135820060694, 19.536112780865654, 13.720220770709657, 28.914021281477456, 30.863935999212504, 17.73644880262514, 29.238277487037248, 40.11141585608026, 32.952272204700854, 15.329424737412737, 43.33166346407193, 45.51049356097131, 6.360828052520421, 20.533248588451592, 19.947286871705263, 26.662438624416964, 13.197587935637841, 20.32090825361681, 24.561326896645152, 13.218685090123085, 36.359183426053626, 11.969019119150841, 20.61713415986355, 41.52429740999973, 8.00570050776853, 9.80591145473032, 37.72623596118179, 9.739542296104508, 19.207920088466803, 47.414499608513545, 12.147256374457568, 18.409385014476694, 43.137838870510684, 25.898966871287666, 45.57938182540104, 22.864641336249935, 33.855541416063225, 25.38113432559583, 12.660957000633893, 26.885891204827985, 36.44109733516365, 31.87712054930269, 15.720252055364009, 30.3833350713401, 46.71596279438015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29270213265301187, "mean_inference_ms": 0.9335067118208217, "mean_action_processing_ms": 0.12498280843157311, "mean_env_wait_ms": 0.06592721605800414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026221275329589844, "StateBufferConnector_ms": 0.002291440963745117, "ViewRequirementAgentConnector_ms": 0.04423022270202637}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 695.7241774661419, "num_env_steps_trained_throughput_per_sec": 695.7241774661419, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 5811.026, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5810.993, "sample_time_ms": 655.174, "learn_time_ms": 5142.434, "learn_throughput": 777.842, "synch_weights_time_ms": 13.073}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 144, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-10", "timestamp": 1723391110, "time_this_iter_s": 5.7546398639678955, "time_total_s": 853.7368285655975, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17deb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 853.7368285655975, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 27.6, "ram_util_percent": 80.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.307151938850681, "cur_kl_coeff": 4.2632564145606e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6282633394623796, "policy_loss": -0.0017784408924247448, "vf_loss": 1.6300417768458526, "vf_explained_var": 0.9676443627104163, "kl": 0.004600413014846274, "entropy": 0.32691922918893396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.411792956913511, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6459698790063462, "policy_loss": -0.010639972372640234, "vf_loss": 1.6564958235869804, "vf_explained_var": 0.9677667298043767, "kl": 0.016216456735161994, "entropy": 0.5165582422167063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.24, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6524, "policy_reward_min": {"prey_policy": -48.575230440639594, "predator_policy": 2.979099558875494}, "policy_reward_max": {"prey_policy": -2.979099558875494, "predator_policy": 48.575230440639594}, "policy_reward_mean": {"prey_policy": -24.37128104913645, "predator_policy": 24.37128104913645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [86, 64, 65, 71, 80, 80, 42, 42, 69, 62, 37, 89, 82, 65, 55, 68, 84, 51, 37, 73, 64, 66, 86, 41, 52, 74, 64, 93, 59, 47, 82, 67, 86, 67, 56, 125, 75, 91, 84, 17, 89, 88, 72, 72, 84, 43, 90, 59, 61, 88, 75, 82, 86, 66, 66, 56, 50, 71, 48, 48, 68, 24, 58, 62, 42, 84, 81, 94, 74, 85, 39, 101, 92, 120, 80, 76, 57, 86, 62, 75, 14, 56, 32, 40, 44, 42, 21, 87, 38, 47, 95, 31, 85, 64, 55, 50, 72, 41, 8, 50], "policy_prey_policy_reward": [-40.11141585608026, -32.952272204700854, -15.329424737412737, -43.33166346407193, -45.51049356097131, -6.360828052520421, -20.533248588451592, -19.947286871705263, -26.662438624416964, -13.197587935637841, -20.32090825361681, -24.561326896645152, -13.218685090123085, -36.359183426053626, -11.969019119150841, -20.61713415986355, -41.52429740999973, -8.00570050776853, -9.80591145473032, -37.72623596118179, -9.739542296104508, -19.207920088466803, -47.414499608513545, -12.147256374457568, -18.409385014476694, -43.137838870510684, -25.898966871287666, -45.57938182540104, -22.864641336249935, -33.855541416063225, -25.38113432559583, -12.660957000633893, -26.885891204827985, -36.44109733516365, -31.87712054930269, -15.720252055364009, -30.3833350713401, -46.71596279438015, -26.233206632258714, -6.726135018293408, -22.01575603982588, -48.575230440639594, -24.438719437442376, -19.020405080618794, -38.45805957030443, -24.690715003125327, -42.92203008717957, -38.60626794243748, -30.177937610766865, -7.501792247737901, -27.614030716574177, -28.949337178873908, -26.43870847598184, -35.9921348666951, -27.158634147193748, -15.833092237353252, -21.21024712026266, -21.050136171790474, -37.38723729059691, -18.51332815582559, -18.389740261094023, -11.312044072361099, -11.287490588046163, -19.32879763041769, -10.303019604138782, -30.521488819314275, -15.246517914378797, -21.611144526194558, -36.18014040171095, -41.728328053843626, -13.402494800910702, -21.66413772542984, -33.23297197107416, -16.573581770501725, -33.632509597080656, -38.28935507744347, -16.47065981287546, -29.14036668419116, -27.646662054528804, -23.18949249959342, -2.979099558875494, -30.575675965577176, -16.444247295960825, -19.963590050709996, -16.077781546755933, -8.26127679883668, -6.016478487176238, -36.35085837705468, -24.10743055097368, -10.062466455972503, -18.578029584715317, -21.366464599378183, -15.678634388257596, -37.368271982801346, -22.91757683019183, -13.99793684912889, -47.29226508614399, -22.81599637628984, -3.283387219090298, -11.960765359604501], "policy_predator_policy_reward": [40.11141585608026, 32.952272204700854, 15.329424737412737, 43.33166346407193, 45.51049356097131, 6.360828052520421, 20.533248588451592, 19.947286871705263, 26.662438624416964, 13.197587935637841, 20.32090825361681, 24.561326896645152, 13.218685090123085, 36.359183426053626, 11.969019119150841, 20.61713415986355, 41.52429740999973, 8.00570050776853, 9.80591145473032, 37.72623596118179, 9.739542296104508, 19.207920088466803, 47.414499608513545, 12.147256374457568, 18.409385014476694, 43.137838870510684, 25.898966871287666, 45.57938182540104, 22.864641336249935, 33.855541416063225, 25.38113432559583, 12.660957000633893, 26.885891204827985, 36.44109733516365, 31.87712054930269, 15.720252055364009, 30.3833350713401, 46.71596279438015, 26.233206632258714, 6.726135018293408, 22.01575603982588, 48.575230440639594, 24.438719437442376, 19.020405080618794, 38.45805957030443, 24.690715003125327, 42.92203008717957, 38.60626794243748, 30.177937610766865, 7.501792247737901, 27.614030716574177, 28.949337178873908, 26.43870847598184, 35.9921348666951, 27.158634147193748, 15.833092237353252, 21.21024712026266, 21.050136171790474, 37.38723729059691, 18.51332815582559, 18.389740261094023, 11.312044072361099, 11.287490588046163, 19.32879763041769, 10.303019604138782, 30.521488819314275, 15.246517914378797, 21.611144526194558, 36.18014040171095, 41.728328053843626, 13.402494800910702, 21.66413772542984, 33.23297197107416, 16.573581770501725, 33.632509597080656, 38.28935507744347, 16.47065981287546, 29.14036668419116, 27.646662054528804, 23.18949249959342, 2.979099558875494, 30.575675965577176, 16.444247295960825, 19.963590050709996, 16.077781546755933, 8.26127679883668, 6.016478487176238, 36.35085837705468, 24.10743055097368, 10.062466455972503, 18.578029584715317, 21.366464599378183, 15.678634388257596, 37.368271982801346, 22.91757683019183, 13.99793684912889, 47.29226508614399, 22.81599637628984, 3.283387219090298, 11.960765359604501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2925732826606127, "mean_inference_ms": 0.9333852358103436, "mean_action_processing_ms": 0.12506876252870286, "mean_env_wait_ms": 0.0659789084321388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026415586471557617, "StateBufferConnector_ms": 0.001925826072692871, "ViewRequirementAgentConnector_ms": 0.04452812671661377}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 686.8490227275854, "num_env_steps_trained_throughput_per_sec": 686.8490227275854, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 5839.871, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5839.838, "sample_time_ms": 652.836, "learn_time_ms": 5173.671, "learn_throughput": 773.145, "synch_weights_time_ms": 13.017}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 145, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-16", "timestamp": 1723391116, "time_this_iter_s": 5.829061269760132, "time_total_s": 859.5658898353577, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 859.5658898353577, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 27.1625, "ram_util_percent": 80.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9430073901390035, "cur_kl_coeff": 2.1316282072803e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.090563269611448, "policy_loss": -0.00023012245146674103, "vf_loss": 1.0907933933349947, "vf_explained_var": 0.9787458865592877, "kl": 0.003941813322704916, "entropy": 0.305821219071125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0134518365065257, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.091871342342347, "policy_loss": -0.006464204988636387, "vf_loss": 1.0982729555418094, "vf_explained_var": 0.9796510708828767, "kl": 0.00890156655469775, "entropy": 0.503242161963135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.24, "episode_media": {}, "episodes_this_iter": 66, "episodes_timesteps_total": 6124, "policy_reward_min": {"prey_policy": -58.55886656028948, "predator_policy": 1.1197356688457467}, "policy_reward_max": {"prey_policy": -1.1197356688457467, "predator_policy": 58.55886656028948}, "policy_reward_mean": {"prey_policy": -23.674455650578757, "predator_policy": 23.674455650578757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [81, 94, 74, 85, 39, 101, 92, 120, 80, 76, 57, 86, 62, 75, 14, 56, 32, 40, 44, 42, 21, 87, 38, 47, 95, 31, 85, 64, 55, 50, 72, 41, 8, 50, 89, 95, 65, 20, 41, 68, 65, 62, 81, 68, 52, 53, 9, 53, 70, 80, 76, 71, 73, 52, 82, 54, 74, 103, 46, 79, 64, 11, 66, 88, 75, 60, 59, 71, 89, 46, 59, 90, 47, 63, 59, 55, 93, 30, 45, 2, 66, 36, 1, 99, 48, 65, 77, 41, 76, 92, 58, 19, 36, 61, 80, 52, 111, 62, 52, 45], "policy_prey_policy_reward": [-15.246517914378797, -21.611144526194558, -36.18014040171095, -41.728328053843626, -13.402494800910702, -21.66413772542984, -33.23297197107416, -16.573581770501725, -33.632509597080656, -38.28935507744347, -16.47065981287546, -29.14036668419116, -27.646662054528804, -23.18949249959342, -2.979099558875494, -30.575675965577176, -16.444247295960825, -19.963590050709996, -16.077781546755933, -8.26127679883668, -6.016478487176238, -36.35085837705468, -24.10743055097368, -10.062466455972503, -18.578029584715317, -21.366464599378183, -15.678634388257596, -37.368271982801346, -22.91757683019183, -13.99793684912889, -47.29226508614399, -22.81599637628984, -3.283387219090298, -11.960765359604501, -43.248699501508504, -13.84899318244084, -23.32718578634577, -5.844557635652741, -13.865770009423926, -19.512864559366776, -7.490581402780208, -17.397728154337383, -28.698345584118975, -15.89330682698423, -23.086533401181722, -27.180902744502657, -1.6664042877069156, -11.880970159654765, -40.993901222214895, -25.847929587451755, -42.543124442113516, -31.59375394205123, -28.90605408392111, -14.976724423478226, -6.74915727583852, -28.50639854987745, -49.32392681325528, -16.337411259464947, -27.722899873237335, -33.87723754795153, -23.190511664991696, -3.980670300554218, -23.586292977957903, -45.46604639593963, -20.72591247815084, -29.76733886418032, -14.933439542421569, -23.472686838769437, -53.644605116798374, -25.802738728788697, -6.290928317553586, -39.99664385207394, -38.96426120688574, -43.6236413273146, -20.295904352613586, -25.413734975497423, -58.55886656028948, -10.83655441672876, -33.65183530194355, -1.3509877093635965, -30.508034855248113, -15.774963799885626, -1.1197356688457467, -24.90616117459598, -9.07516950831097, -27.549338122252625, -37.11044790116567, -11.152413382726492, -29.45216796722135, -51.77524962811435, -31.30916929654063, -1.7115690558133192, -24.715490537107648, -25.8831446106136, -52.71244817317391, -7.015447859413111, -33.23024503322782, -17.474739468338214, -11.184244728664966, -25.80382484768566], "policy_predator_policy_reward": [15.246517914378797, 21.611144526194558, 36.18014040171095, 41.728328053843626, 13.402494800910702, 21.66413772542984, 33.23297197107416, 16.573581770501725, 33.632509597080656, 38.28935507744347, 16.47065981287546, 29.14036668419116, 27.646662054528804, 23.18949249959342, 2.979099558875494, 30.575675965577176, 16.444247295960825, 19.963590050709996, 16.077781546755933, 8.26127679883668, 6.016478487176238, 36.35085837705468, 24.10743055097368, 10.062466455972503, 18.578029584715317, 21.366464599378183, 15.678634388257596, 37.368271982801346, 22.91757683019183, 13.99793684912889, 47.29226508614399, 22.81599637628984, 3.283387219090298, 11.960765359604501, 43.248699501508504, 13.84899318244084, 23.32718578634577, 5.844557635652741, 13.865770009423926, 19.512864559366776, 7.490581402780208, 17.397728154337383, 28.698345584118975, 15.89330682698423, 23.086533401181722, 27.180902744502657, 1.6664042877069156, 11.880970159654765, 40.993901222214895, 25.847929587451755, 42.543124442113516, 31.59375394205123, 28.90605408392111, 14.976724423478226, 6.74915727583852, 28.50639854987745, 49.32392681325528, 16.337411259464947, 27.722899873237335, 33.87723754795153, 23.190511664991696, 3.980670300554218, 23.586292977957903, 45.46604639593963, 20.72591247815084, 29.76733886418032, 14.933439542421569, 23.472686838769437, 53.644605116798374, 25.802738728788697, 6.290928317553586, 39.99664385207394, 38.96426120688574, 43.6236413273146, 20.295904352613586, 25.413734975497423, 58.55886656028948, 10.83655441672876, 33.65183530194355, 1.3509877093635965, 30.508034855248113, 15.774963799885626, 1.1197356688457467, 24.90616117459598, 9.07516950831097, 27.549338122252625, 37.11044790116567, 11.152413382726492, 29.45216796722135, 51.77524962811435, 31.30916929654063, 1.7115690558133192, 24.715490537107648, 25.8831446106136, 52.71244817317391, 7.015447859413111, 33.23024503322782, 17.474739468338214, 11.184244728664966, 25.80382484768566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2925152192975793, "mean_inference_ms": 0.9324521506788781, "mean_action_processing_ms": 0.1250404858667243, "mean_env_wait_ms": 0.06584164192560399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025330781936645508, "StateBufferConnector_ms": 0.001989603042602539, "ViewRequirementAgentConnector_ms": 0.04443514347076416}, "num_episodes": 66, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 684.1338688024537, "num_env_steps_trained_throughput_per_sec": 684.1338688024537, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 5833.861, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5833.828, "sample_time_ms": 648.768, "learn_time_ms": 5171.786, "learn_throughput": 773.427, "synch_weights_time_ms": 12.958}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 146, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-22", "timestamp": 1723391122, "time_this_iter_s": 5.8529112339019775, "time_total_s": 865.4188010692596, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16002f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 865.4188010692596, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 30.3625, "ram_util_percent": 80.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.004346043864886, "cur_kl_coeff": 1.06581410364015e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3104632967462142, "policy_loss": -0.0012290729801558578, "vf_loss": 1.3116923668111364, "vf_explained_var": 0.9739632738754154, "kl": 0.0035176151719504434, "entropy": 0.3137788039942582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.203486428161462, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3005057531719406, "policy_loss": -0.007138634162159482, "vf_loss": 1.3075847459957004, "vf_explained_var": 0.9748111613094806, "kl": 0.008482250550727126, "entropy": 0.5125534789947171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.26, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6226, "policy_reward_min": {"prey_policy": -58.55886656028948, "predator_policy": 1.1197356688457467}, "policy_reward_max": {"prey_policy": -1.1197356688457467, "predator_policy": 58.55886656028948}, "policy_reward_mean": {"prey_policy": -26.98141631329123, "predator_policy": 26.98141631329123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [88, 75, 60, 59, 71, 89, 46, 59, 90, 47, 63, 59, 55, 93, 30, 45, 2, 66, 36, 1, 99, 48, 65, 77, 41, 76, 92, 58, 19, 36, 61, 80, 52, 111, 62, 52, 45, 74, 74, 30, 40, 60, 58, 70, 45, 71, 61, 55, 84, 26, 64, 72, 84, 153, 91, 41, 44, 77, 94, 70, 69, 73, 51, 63, 43, 80, 97, 37, 92, 64, 89, 31, 67, 67, 55, 75, 104, 67, 58, 53, 20, 84, 82, 30, 90, 30, 29, 72, 59, 30, 63, 39, 86, 51, 27, 56, 94, 50, 70, 83], "policy_prey_policy_reward": [-45.46604639593963, -20.72591247815084, -29.76733886418032, -14.933439542421569, -23.472686838769437, -53.644605116798374, -25.802738728788697, -6.290928317553586, -39.99664385207394, -38.96426120688574, -43.6236413273146, -20.295904352613586, -25.413734975497423, -58.55886656028948, -10.83655441672876, -33.65183530194355, -1.3509877093635965, -30.508034855248113, -15.774963799885626, -1.1197356688457467, -24.90616117459598, -9.07516950831097, -27.549338122252625, -37.11044790116567, -11.152413382726492, -29.45216796722135, -51.77524962811435, -31.30916929654063, -1.7115690558133192, -24.715490537107648, -25.8831446106136, -52.71244817317391, -7.015447859413111, -33.23024503322782, -17.474739468338214, -11.184244728664966, -25.80382484768566, -42.26334779472517, -24.348745832340388, -8.178646344065964, -26.547451828380506, -29.22156817609389, -36.5073304058454, -48.04711463540921, -24.418887845520572, -24.333215232557915, -19.6997893710464, -29.57063658018943, -41.05473917477669, -11.438791874362781, -23.73510010142598, -37.894543052497475, -53.94611788748165, -52.93248227340798, -43.12487900594753, -17.741673433831004, -32.44267167194177, -18.29665151388711, -52.53863575851051, -5.8347139507163055, -30.797568682866522, -15.670968523774103, -35.86512371916328, -29.461562088403426, -19.002481644522074, -27.0769776104309, -21.48748038726743, -3.1803763746872242, -56.436407311402235, -17.73253358359744, -45.755747894836695, -19.85548301531402, -30.035447036651142, -19.25516431398599, -15.507699973096075, -25.324537750873528, -9.812203273385295, -32.5496095839253, -33.76086254171422, -18.293213739621077, -7.604881192629937, -39.17335015388697, -45.10468562405771, -5.1489333926753025, -25.693590685348276, -13.035637349657542, -20.704077926106848, -35.36493241178156, -18.7311797073892, -13.83682257900682, -27.878117994250577, -26.238017457642613, -38.78511365473877, -25.433899734686904, -5.887673620755658, -29.344589815319228, -50.20912774609687, -33.878757703889015, -29.9015484221734, -32.94737975829079], "policy_predator_policy_reward": [45.46604639593963, 20.72591247815084, 29.76733886418032, 14.933439542421569, 23.472686838769437, 53.644605116798374, 25.802738728788697, 6.290928317553586, 39.99664385207394, 38.96426120688574, 43.6236413273146, 20.295904352613586, 25.413734975497423, 58.55886656028948, 10.83655441672876, 33.65183530194355, 1.3509877093635965, 30.508034855248113, 15.774963799885626, 1.1197356688457467, 24.90616117459598, 9.07516950831097, 27.549338122252625, 37.11044790116567, 11.152413382726492, 29.45216796722135, 51.77524962811435, 31.30916929654063, 1.7115690558133192, 24.715490537107648, 25.8831446106136, 52.71244817317391, 7.015447859413111, 33.23024503322782, 17.474739468338214, 11.184244728664966, 25.80382484768566, 42.26334779472517, 24.348745832340388, 8.178646344065964, 26.547451828380506, 29.22156817609389, 36.5073304058454, 48.04711463540921, 24.418887845520572, 24.333215232557915, 19.6997893710464, 29.57063658018943, 41.05473917477669, 11.438791874362781, 23.73510010142598, 37.894543052497475, 53.94611788748165, 52.93248227340798, 43.12487900594753, 17.741673433831004, 32.44267167194177, 18.29665151388711, 52.53863575851051, 5.8347139507163055, 30.797568682866522, 15.670968523774103, 35.86512371916328, 29.461562088403426, 19.002481644522074, 27.0769776104309, 21.48748038726743, 3.1803763746872242, 56.436407311402235, 17.73253358359744, 45.755747894836695, 19.85548301531402, 30.035447036651142, 19.25516431398599, 15.507699973096075, 25.324537750873528, 9.812203273385295, 32.5496095839253, 33.76086254171422, 18.293213739621077, 7.604881192629937, 39.17335015388697, 45.10468562405771, 5.1489333926753025, 25.693590685348276, 13.035637349657542, 20.704077926106848, 35.36493241178156, 18.7311797073892, 13.83682257900682, 27.878117994250577, 26.238017457642613, 38.78511365473877, 25.433899734686904, 5.887673620755658, 29.344589815319228, 50.20912774609687, 33.878757703889015, 29.9015484221734, 32.94737975829079]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2925099845104571, "mean_inference_ms": 0.9327487899130054, "mean_action_processing_ms": 0.12501251183159393, "mean_env_wait_ms": 0.06587709309606991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029790401458740234, "StateBufferConnector_ms": 0.0024644136428833008, "ViewRequirementAgentConnector_ms": 0.05087780952453613}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 615.2609898602979, "num_env_steps_trained_throughput_per_sec": 615.2609898602979, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 5889.999, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5889.965, "sample_time_ms": 650.393, "learn_time_ms": 5226.256, "learn_throughput": 765.366, "synch_weights_time_ms": 12.988}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 147, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-29", "timestamp": 1723391129, "time_this_iter_s": 6.507273197174072, "time_total_s": 871.9260742664337, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17dec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 871.9260742664337, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 34.980000000000004, "ram_util_percent": 81.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.29385637914141, "cur_kl_coeff": 5.32907051820075e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4303176722799738, "policy_loss": -3.118811970731864e-05, "vf_loss": 1.4303488626455267, "vf_explained_var": 0.972127495954434, "kl": 0.0034999729526862698, "entropy": 0.31577995760987204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4943721141666173, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4804985749845703, "policy_loss": -0.005805022549369218, "vf_loss": 1.4862575355296335, "vf_explained_var": 0.9694540583839019, "kl": 0.006550909396698046, "entropy": 0.5054393347042302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.11, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6111, "policy_reward_min": {"prey_policy": -56.436407311402235, "predator_policy": 2.052453318222194}, "policy_reward_max": {"prey_policy": -2.052453318222194, "predator_policy": 56.436407311402235}, "policy_reward_mean": {"prey_policy": -24.664335521205235, "predator_policy": 24.664335521205235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [43, 80, 97, 37, 92, 64, 89, 31, 67, 67, 55, 75, 104, 67, 58, 53, 20, 84, 82, 30, 90, 30, 29, 72, 59, 30, 63, 39, 86, 51, 27, 56, 94, 50, 70, 83, 81, 26, 70, 62, 91, 83, 65, 46, 81, 21, 16, 87, 91, 74, 46, 88, 24, 31, 63, 41, 90, 71, 57, 88, 73, 62, 62, 61, 81, 63, 74, 13, 77, 66, 58, 31, 45, 58, 74, 50, 100, 76, 73, 56, 8, 69, 87, 42, 71, 31, 42, 53, 71, 61, 40, 45, 46, 72, 74, 77, 77, 44, 73, 58], "policy_prey_policy_reward": [-19.002481644522074, -27.0769776104309, -21.48748038726743, -3.1803763746872242, -56.436407311402235, -17.73253358359744, -45.755747894836695, -19.85548301531402, -30.035447036651142, -19.25516431398599, -15.507699973096075, -25.324537750873528, -9.812203273385295, -32.5496095839253, -33.76086254171422, -18.293213739621077, -7.604881192629937, -39.17335015388697, -45.10468562405771, -5.1489333926753025, -25.693590685348276, -13.035637349657542, -20.704077926106848, -35.36493241178156, -18.7311797073892, -13.83682257900682, -27.878117994250577, -26.238017457642613, -38.78511365473877, -25.433899734686904, -5.887673620755658, -29.344589815319228, -50.20912774609687, -33.878757703889015, -29.9015484221734, -32.94737975829079, -41.93096309241844, -19.911869272209067, -29.67479600235811, -13.48840735261709, -51.05792969437029, -30.539592945665795, -30.724490246062867, -14.560466739416404, -18.30924206938294, -5.023211446749989, -7.3499119418000145, -40.40900286272636, -18.399713606191618, -31.55724698617755, -23.99419967508636, -41.94948102848017, -12.040278413012434, -21.54609605090854, -21.93966714881911, -24.77739634038142, -33.831362904415926, -26.925930924993654, -17.52171004222389, -47.628980720147894, -36.07088617847205, -17.023231056947996, -11.656130181278103, -16.573383132887464, -33.07108891237136, -44.97342011352319, -44.34371187746922, -10.25458707283408, -20.30921627577588, -32.68895359476697, -27.671649598871216, -15.996896929664624, -18.625822376480453, -5.209086364313417, -39.82475492584351, -35.8223818827625, -9.293950330081126, -30.47890648675527, -29.872064411565145, -32.25066501339798, -2.052453318222194, -11.860304456273466, -27.266856960427535, -9.035939166364582, -23.65034603706447, -21.71215807419277, -18.363812532528392, -18.38572938360646, -41.84173153727304, -18.272825731972024, -12.419382371119466, -19.791060133584352, -26.097078059933907, -27.082890192174908, -3.699257299181574, -30.770616468990294, -28.06670806272324, -28.725574094905006, -22.700709141922758, -17.566841909691085], "policy_predator_policy_reward": [19.002481644522074, 27.0769776104309, 21.48748038726743, 3.1803763746872242, 56.436407311402235, 17.73253358359744, 45.755747894836695, 19.85548301531402, 30.035447036651142, 19.25516431398599, 15.507699973096075, 25.324537750873528, 9.812203273385295, 32.5496095839253, 33.76086254171422, 18.293213739621077, 7.604881192629937, 39.17335015388697, 45.10468562405771, 5.1489333926753025, 25.693590685348276, 13.035637349657542, 20.704077926106848, 35.36493241178156, 18.7311797073892, 13.83682257900682, 27.878117994250577, 26.238017457642613, 38.78511365473877, 25.433899734686904, 5.887673620755658, 29.344589815319228, 50.20912774609687, 33.878757703889015, 29.9015484221734, 32.94737975829079, 41.93096309241844, 19.911869272209067, 29.67479600235811, 13.48840735261709, 51.05792969437029, 30.539592945665795, 30.724490246062867, 14.560466739416404, 18.30924206938294, 5.023211446749989, 7.3499119418000145, 40.40900286272636, 18.399713606191618, 31.55724698617755, 23.99419967508636, 41.94948102848017, 12.040278413012434, 21.54609605090854, 21.93966714881911, 24.77739634038142, 33.831362904415926, 26.925930924993654, 17.52171004222389, 47.628980720147894, 36.07088617847205, 17.023231056947996, 11.656130181278103, 16.573383132887464, 33.07108891237136, 44.97342011352319, 44.34371187746922, 10.25458707283408, 20.30921627577588, 32.68895359476697, 27.671649598871216, 15.996896929664624, 18.625822376480453, 5.209086364313417, 39.82475492584351, 35.8223818827625, 9.293950330081126, 30.47890648675527, 29.872064411565145, 32.25066501339798, 2.052453318222194, 11.860304456273466, 27.266856960427535, 9.035939166364582, 23.65034603706447, 21.71215807419277, 18.363812532528392, 18.38572938360646, 41.84173153727304, 18.272825731972024, 12.419382371119466, 19.791060133584352, 26.097078059933907, 27.082890192174908, 3.699257299181574, 30.770616468990294, 28.06670806272324, 28.725574094905006, 22.700709141922758, 17.566841909691085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2925479041449316, "mean_inference_ms": 0.9327890482184215, "mean_action_processing_ms": 0.12496704961910358, "mean_env_wait_ms": 0.06592256509925198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030975341796875, "StateBufferConnector_ms": 0.0024527311325073242, "ViewRequirementAgentConnector_ms": 0.051045894622802734}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 648.5648141669442, "num_env_steps_trained_throughput_per_sec": 648.5648141669442, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 5917.537, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5917.503, "sample_time_ms": 650.598, "learn_time_ms": 5253.42, "learn_throughput": 761.409, "synch_weights_time_ms": 13.16}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 148, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-35", "timestamp": 1723391135, "time_this_iter_s": 6.173203229904175, "time_total_s": 878.0992774963379, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 878.0992774963379, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 30.9375, "ram_util_percent": 81.01249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0131249758104484, "cur_kl_coeff": 2.664535259100375e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.033845072767387, "policy_loss": -0.00363438813171039, "vf_loss": 1.0374794631265103, "vf_explained_var": 0.9835154389341673, "kl": 0.006249241272901246, "entropy": 0.3078903577756137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.028142090141773, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9975377479878564, "policy_loss": -0.007033960730283676, "vf_loss": 1.0045212191840014, "vf_explained_var": 0.9840573854744434, "kl": 0.007181056818751785, "entropy": 0.49964878186583517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.1, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6210, "policy_reward_min": {"prey_policy": -62.152472699585566, "predator_policy": 2.052453318222194}, "policy_reward_max": {"prey_policy": -2.052453318222194, "predator_policy": 62.152472699585566}, "policy_reward_mean": {"prey_policy": -26.178214828024494, "predator_policy": 26.178214828024494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [63, 74, 13, 77, 66, 58, 31, 45, 58, 74, 50, 100, 76, 73, 56, 8, 69, 87, 42, 71, 31, 42, 53, 71, 61, 40, 45, 46, 72, 74, 77, 77, 44, 73, 58, 63, 77, 98, 85, 47, 79, 80, 91, 36, 62, 45, 54, 51, 42, 93, 42, 52, 81, 84, 73, 60, 43, 46, 44, 59, 42, 74, 60, 45, 62, 89, 77, 61, 58, 48, 85, 73, 67, 75, 90, 53, 42, 54, 49, 59, 77, 41, 90, 57, 96, 87, 47, 74, 46, 40, 65, 42, 90, 32, 71, 93, 72, 52, 63, 70], "policy_prey_policy_reward": [-44.97342011352319, -44.34371187746922, -10.25458707283408, -20.30921627577588, -32.68895359476697, -27.671649598871216, -15.996896929664624, -18.625822376480453, -5.209086364313417, -39.82475492584351, -35.8223818827625, -9.293950330081126, -30.47890648675527, -29.872064411565145, -32.25066501339798, -2.052453318222194, -11.860304456273466, -27.266856960427535, -9.035939166364582, -23.65034603706447, -21.71215807419277, -18.363812532528392, -18.38572938360646, -41.84173153727304, -18.272825731972024, -12.419382371119466, -19.791060133584352, -26.097078059933907, -27.082890192174908, -3.699257299181574, -30.770616468990294, -28.06670806272324, -28.725574094905006, -22.700709141922758, -17.566841909691085, -32.59696755073681, -37.233404358427585, -32.90710529395004, -42.05178924854002, -13.937082634369029, -19.9477907065642, -44.23150284652397, -43.79675316462648, -16.29355206851237, -28.249969074012814, -15.503220552665814, -22.50192072785343, -10.018070743035342, -16.27579282672935, -31.215793183074375, -25.374421384840705, -36.04358443943444, -29.229100279553624, -39.345366727348924, -10.01228449983967, -23.501084888530524, -15.777062958626416, -31.824057560605606, -21.873427181017785, -31.27427476437237, -34.18577414598068, -29.821713937053357, -20.245084736515228, -36.456412946057604, -35.42915829883493, -33.906788151494794, -12.512737048317536, -30.935603885259333, -26.32325055062176, -25.244395875573478, -21.182105163453834, -46.19182333775211, -47.4369652569992, -38.84995541484045, -47.02779460955904, -9.88414132666366, -5.842544264832135, -29.694569452046146, -24.4590762346938, -14.098625145808816, -30.742563473279546, -10.050269120764515, -32.74026581188551, -19.806303473173312, -62.152472699585566, -55.28433687079173, -10.078127059725162, -39.53855340458446, -25.476510145946087, -8.32911021949668, -45.70995223728462, -19.392437337741455, -32.320712171847916, -5.437631500331317, -24.666011118956725, -33.96385121094347, -29.95578228455756, -10.135221526281802, -40.26079855966374, -34.058330943202314], "policy_predator_policy_reward": [44.97342011352319, 44.34371187746922, 10.25458707283408, 20.30921627577588, 32.68895359476697, 27.671649598871216, 15.996896929664624, 18.625822376480453, 5.209086364313417, 39.82475492584351, 35.8223818827625, 9.293950330081126, 30.47890648675527, 29.872064411565145, 32.25066501339798, 2.052453318222194, 11.860304456273466, 27.266856960427535, 9.035939166364582, 23.65034603706447, 21.71215807419277, 18.363812532528392, 18.38572938360646, 41.84173153727304, 18.272825731972024, 12.419382371119466, 19.791060133584352, 26.097078059933907, 27.082890192174908, 3.699257299181574, 30.770616468990294, 28.06670806272324, 28.725574094905006, 22.700709141922758, 17.566841909691085, 32.59696755073681, 37.233404358427585, 32.90710529395004, 42.05178924854002, 13.937082634369029, 19.9477907065642, 44.23150284652397, 43.79675316462648, 16.29355206851237, 28.249969074012814, 15.503220552665814, 22.50192072785343, 10.018070743035342, 16.27579282672935, 31.215793183074375, 25.374421384840705, 36.04358443943444, 29.229100279553624, 39.345366727348924, 10.01228449983967, 23.501084888530524, 15.777062958626416, 31.824057560605606, 21.873427181017785, 31.27427476437237, 34.18577414598068, 29.821713937053357, 20.245084736515228, 36.456412946057604, 35.42915829883493, 33.906788151494794, 12.512737048317536, 30.935603885259333, 26.32325055062176, 25.244395875573478, 21.182105163453834, 46.19182333775211, 47.4369652569992, 38.84995541484045, 47.02779460955904, 9.88414132666366, 5.842544264832135, 29.694569452046146, 24.4590762346938, 14.098625145808816, 30.742563473279546, 10.050269120764515, 32.74026581188551, 19.806303473173312, 62.152472699585566, 55.28433687079173, 10.078127059725162, 39.53855340458446, 25.476510145946087, 8.32911021949668, 45.70995223728462, 19.392437337741455, 32.320712171847916, 5.437631500331317, 24.666011118956725, 33.96385121094347, 29.95578228455756, 10.135221526281802, 40.26079855966374, 34.058330943202314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29241656456156173, "mean_inference_ms": 0.9322980229401552, "mean_action_processing_ms": 0.12486460901102489, "mean_env_wait_ms": 0.06587511820645785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002832174301147461, "StateBufferConnector_ms": 0.0020369291305541992, "ViewRequirementAgentConnector_ms": 0.04840493202209473}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 666.9202019998444, "num_env_steps_trained_throughput_per_sec": 666.9202019998444, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1192000, "timers": {"training_iteration_time_ms": 5948.378, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5948.342, "sample_time_ms": 658.465, "learn_time_ms": 5276.232, "learn_throughput": 758.117, "synch_weights_time_ms": 13.315}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "done": false, "training_iteration": 149, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-41", "timestamp": 1723391141, "time_this_iter_s": 6.00270414352417, "time_total_s": 884.1019816398621, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 884.1019816398621, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 28.41111111111111, "ram_util_percent": 80.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1979469458262124, "cur_kl_coeff": 2.664535259100375e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5779774360979597, "policy_loss": -0.0015693261094080905, "vf_loss": 1.5795467626924315, "vf_explained_var": 0.9618561619892716, "kl": 0.0033838728045016845, "entropy": 0.29282222120091317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1577052917331456, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5532396440083782, "policy_loss": -0.0017678635173069778, "vf_loss": 1.5549817895516753, "vf_explained_var": 0.9629667291417718, "kl": 0.003658105723239357, "entropy": 0.47256354137013357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.63, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6463, "policy_reward_min": {"prey_policy": -62.152472699585566, "predator_policy": 4.683088855097165}, "policy_reward_max": {"prey_policy": -4.683088855097165, "predator_policy": 62.152472699585566}, "policy_reward_mean": {"prey_policy": -26.78989535900605, "predator_policy": 26.78989535900605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [60, 45, 62, 89, 77, 61, 58, 48, 85, 73, 67, 75, 90, 53, 42, 54, 49, 59, 77, 41, 90, 57, 96, 87, 47, 74, 46, 40, 65, 42, 90, 32, 71, 93, 72, 52, 63, 70, 48, 40, 31, 82, 95, 6, 62, 75, 85, 70, 59, 51, 69, 50, 51, 40, 65, 27, 80, 81, 36, 140, 75, 60, 44, 73, 94, 67, 81, 81, 69, 44, 89, 89, 56, 72, 57, 83, 78, 78, 74, 80, 49, 108, 42, 8, 70, 55, 76, 93, 51, 40, 70, 89, 72, 67, 63, 53, 65, 73, 59, 21], "policy_prey_policy_reward": [-20.245084736515228, -36.456412946057604, -35.42915829883493, -33.906788151494794, -12.512737048317536, -30.935603885259333, -26.32325055062176, -25.244395875573478, -21.182105163453834, -46.19182333775211, -47.4369652569992, -38.84995541484045, -47.02779460955904, -9.88414132666366, -5.842544264832135, -29.694569452046146, -24.4590762346938, -14.098625145808816, -30.742563473279546, -10.050269120764515, -32.74026581188551, -19.806303473173312, -62.152472699585566, -55.28433687079173, -10.078127059725162, -39.53855340458446, -25.476510145946087, -8.32911021949668, -45.70995223728462, -19.392437337741455, -32.320712171847916, -5.437631500331317, -24.666011118956725, -33.96385121094347, -29.95578228455756, -10.135221526281802, -40.26079855966374, -34.058330943202314, -12.406094704213192, -25.173258113950233, -11.679410659370909, -40.151455080324574, -14.16452568018618, -4.683088855097165, -23.820259553265956, -26.12936715185629, -33.358239565909045, -28.732794758034668, -39.24337045149125, -18.873353990352513, -43.6508172962556, -23.251025271201833, -21.162345058983547, -25.93120723329293, -43.50408235387913, -15.438020282815186, -33.400244140835476, -21.314487155261723, -9.683653898091503, -21.293724005202396, -45.494885208377724, -6.517837436269996, -19.824038119636505, -32.438121755488844, -24.616301065437266, -30.07713504042965, -35.0204457667531, -26.682065675454652, -13.908259712512173, -22.611535079373226, -24.853223010060724, -31.47405700430676, -30.41882841615831, -26.95316648160769, -24.571214981285095, -32.740391751874796, -17.026515337261085, -47.279358599093904, -37.59718065783538, -42.011058425657055, -20.950551373338804, -29.10955671753314, -23.410615544443957, -6.871460802653479, -15.915799798709127, -25.629912322636407, -32.47072745304817, -53.09618746741473, -32.418795779082664, -12.600630528292008, -37.75437330495141, -19.139605581123046, -18.48407342929194, -37.868009293260045, -16.42313955315875, -14.975966434342205, -39.84268678676635, -28.40491981917029, -23.61979597956239, -5.022010277714015], "policy_predator_policy_reward": [20.245084736515228, 36.456412946057604, 35.42915829883493, 33.906788151494794, 12.512737048317536, 30.935603885259333, 26.32325055062176, 25.244395875573478, 21.182105163453834, 46.19182333775211, 47.4369652569992, 38.84995541484045, 47.02779460955904, 9.88414132666366, 5.842544264832135, 29.694569452046146, 24.4590762346938, 14.098625145808816, 30.742563473279546, 10.050269120764515, 32.74026581188551, 19.806303473173312, 62.152472699585566, 55.28433687079173, 10.078127059725162, 39.53855340458446, 25.476510145946087, 8.32911021949668, 45.70995223728462, 19.392437337741455, 32.320712171847916, 5.437631500331317, 24.666011118956725, 33.96385121094347, 29.95578228455756, 10.135221526281802, 40.26079855966374, 34.058330943202314, 12.406094704213192, 25.173258113950233, 11.679410659370909, 40.151455080324574, 14.16452568018618, 4.683088855097165, 23.820259553265956, 26.12936715185629, 33.358239565909045, 28.732794758034668, 39.24337045149125, 18.873353990352513, 43.6508172962556, 23.251025271201833, 21.162345058983547, 25.93120723329293, 43.50408235387913, 15.438020282815186, 33.400244140835476, 21.314487155261723, 9.683653898091503, 21.293724005202396, 45.494885208377724, 6.517837436269996, 19.824038119636505, 32.438121755488844, 24.616301065437266, 30.07713504042965, 35.0204457667531, 26.682065675454652, 13.908259712512173, 22.611535079373226, 24.853223010060724, 31.47405700430676, 30.41882841615831, 26.95316648160769, 24.571214981285095, 32.740391751874796, 17.026515337261085, 47.279358599093904, 37.59718065783538, 42.011058425657055, 20.950551373338804, 29.10955671753314, 23.410615544443957, 6.871460802653479, 15.915799798709127, 25.629912322636407, 32.47072745304817, 53.09618746741473, 32.418795779082664, 12.600630528292008, 37.75437330495141, 19.139605581123046, 18.48407342929194, 37.868009293260045, 16.42313955315875, 14.975966434342205, 39.84268678676635, 28.40491981917029, 23.61979597956239, 5.022010277714015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29242516675884145, "mean_inference_ms": 0.9322370298222387, "mean_action_processing_ms": 0.12487796573675407, "mean_env_wait_ms": 0.06586724215714158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027256011962890625, "StateBufferConnector_ms": 0.0022052526473999023, "ViewRequirementAgentConnector_ms": 0.04830062389373779}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 670.0007999012483, "num_env_steps_trained_throughput_per_sec": 670.0007999012483, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 5978.956, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5978.919, "sample_time_ms": 659.325, "learn_time_ms": 5302.912, "learn_throughput": 754.303, "synch_weights_time_ms": 16.271}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 150, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-47", "timestamp": 1723391147, "time_this_iter_s": 5.9754438400268555, "time_total_s": 890.0774254798889, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13c49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 890.0774254798889, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 27.9625, "ram_util_percent": 80.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.000293327557544, "cur_kl_coeff": 1.3322676295501876e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.218070552373926, "policy_loss": -0.0011751322677203764, "vf_loss": 1.2192456882447005, "vf_explained_var": 0.9762378361696998, "kl": 0.0033033403700244435, "entropy": 0.28487299915092684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.996134279171626, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2060429679229856, "policy_loss": -0.0028076025346914927, "vf_loss": 1.2088280263356865, "vf_explained_var": 0.9763760183006525, "kl": 0.006413444610271313, "entropy": 0.47027185711388786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.82, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6382, "policy_reward_min": {"prey_policy": -53.09618746741473, "predator_policy": 1.0537793416141428}, "policy_reward_max": {"prey_policy": -1.0537793416141428, "predator_policy": 53.09618746741473}, "policy_reward_mean": {"prey_policy": -25.43166955860027, "predator_policy": 25.43166955860027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [94, 67, 81, 81, 69, 44, 89, 89, 56, 72, 57, 83, 78, 78, 74, 80, 49, 108, 42, 8, 70, 55, 76, 93, 51, 40, 70, 89, 72, 67, 63, 53, 65, 73, 59, 21, 86, 79, 50, 62, 54, 46, 73, 39, 113, 133, 71, 32, 52, 75, 67, 89, 74, 34, 78, 73, 75, 46, 94, 109, 24, 36, 65, 44, 92, 121, 48, 44, 47, 97, 49, 21, 64, 82, 87, 59, 65, 44, 48, 94, 31, 61, 9, 38, 61, 73, 41, 59, 96, 78, 15, 48, 39, 32, 54, 65, 77, 72, 23, 59], "policy_prey_policy_reward": [-24.616301065437266, -30.07713504042965, -35.0204457667531, -26.682065675454652, -13.908259712512173, -22.611535079373226, -24.853223010060724, -31.47405700430676, -30.41882841615831, -26.95316648160769, -24.571214981285095, -32.740391751874796, -17.026515337261085, -47.279358599093904, -37.59718065783538, -42.011058425657055, -20.950551373338804, -29.10955671753314, -23.410615544443957, -6.871460802653479, -15.915799798709127, -25.629912322636407, -32.47072745304817, -53.09618746741473, -32.418795779082664, -12.600630528292008, -37.75437330495141, -19.139605581123046, -18.48407342929194, -37.868009293260045, -16.42313955315875, -14.975966434342205, -39.84268678676635, -28.40491981917029, -23.61979597956239, -5.022010277714015, -18.92419447170331, -25.48306412797859, -16.86998636945001, -20.282714263260882, -28.388117043848354, -27.521789465574837, -43.800326667656535, -1.0537793416141428, -31.077002824814404, -47.47462089275376, -10.336936599988894, -27.008845115168683, -30.36570731106134, -25.731121188858815, -24.718043724828078, -44.63210796937205, -38.9728344229605, -10.138740484150325, -37.268160202902585, -17.631732695747424, -30.280393174389843, -27.384712627928632, -36.78178195069739, -25.28999314758152, -16.12224090862589, -13.624379791441834, -29.696731706679298, -14.969594917005349, -32.03391813902891, -29.149874391674178, -33.88865085980829, -30.44142936390829, -14.015836873145311, -23.107549055926107, -4.017914343840449, -14.224926956424008, -41.23665643102553, -17.175171319022997, -29.724636363995813, -29.313659446607453, -17.628614456318363, -20.432028981676954, -12.13736875308988, -30.54131793603722, -10.7381295714526, -8.855331026646343, -1.5485880479613303, -6.792554947546315, -42.52536456458847, -37.968040723471134, -23.536581444332807, -10.161285925440293, -46.116992229608535, -38.59996363776691, -3.6126744807313997, -33.351669879642735, -18.681037457025745, -17.455092439566428, -21.150605320008086, -38.68927443283005, -34.66470605050906, -46.79628501585056, -14.308686309529945, -24.865330024351405], "policy_predator_policy_reward": [24.616301065437266, 30.07713504042965, 35.0204457667531, 26.682065675454652, 13.908259712512173, 22.611535079373226, 24.853223010060724, 31.47405700430676, 30.41882841615831, 26.95316648160769, 24.571214981285095, 32.740391751874796, 17.026515337261085, 47.279358599093904, 37.59718065783538, 42.011058425657055, 20.950551373338804, 29.10955671753314, 23.410615544443957, 6.871460802653479, 15.915799798709127, 25.629912322636407, 32.47072745304817, 53.09618746741473, 32.418795779082664, 12.600630528292008, 37.75437330495141, 19.139605581123046, 18.48407342929194, 37.868009293260045, 16.42313955315875, 14.975966434342205, 39.84268678676635, 28.40491981917029, 23.61979597956239, 5.022010277714015, 18.92419447170331, 25.48306412797859, 16.86998636945001, 20.282714263260882, 28.388117043848354, 27.521789465574837, 43.800326667656535, 1.0537793416141428, 31.077002824814404, 47.47462089275376, 10.336936599988894, 27.008845115168683, 30.36570731106134, 25.731121188858815, 24.718043724828078, 44.63210796937205, 38.9728344229605, 10.138740484150325, 37.268160202902585, 17.631732695747424, 30.280393174389843, 27.384712627928632, 36.78178195069739, 25.28999314758152, 16.12224090862589, 13.624379791441834, 29.696731706679298, 14.969594917005349, 32.03391813902891, 29.149874391674178, 33.88865085980829, 30.44142936390829, 14.015836873145311, 23.107549055926107, 4.017914343840449, 14.224926956424008, 41.23665643102553, 17.175171319022997, 29.724636363995813, 29.313659446607453, 17.628614456318363, 20.432028981676954, 12.13736875308988, 30.54131793603722, 10.7381295714526, 8.855331026646343, 1.5485880479613303, 6.792554947546315, 42.52536456458847, 37.968040723471134, 23.536581444332807, 10.161285925440293, 46.116992229608535, 38.59996363776691, 3.6126744807313997, 33.351669879642735, 18.681037457025745, 17.455092439566428, 21.150605320008086, 38.68927443283005, 34.66470605050906, 46.79628501585056, 14.308686309529945, 24.865330024351405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29254042371041133, "mean_inference_ms": 0.9324361122659452, "mean_action_processing_ms": 0.12506342631954115, "mean_env_wait_ms": 0.06594149810833413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029115676879882812, "StateBufferConnector_ms": 0.0022237300872802734, "ViewRequirementAgentConnector_ms": 0.047363877296447754}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 667.7467544630039, "num_env_steps_trained_throughput_per_sec": 667.7467544630039, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1208000, "timers": {"training_iteration_time_ms": 5990.174, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5990.137, "sample_time_ms": 658.683, "learn_time_ms": 5314.721, "learn_throughput": 752.627, "synch_weights_time_ms": 16.319}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "done": false, "training_iteration": 151, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-53", "timestamp": 1723391153, "time_this_iter_s": 5.9961512088775635, "time_total_s": 896.0735766887665, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 896.0735766887665, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 29.08888888888889, "ram_util_percent": 80.31111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.929397367189328, "cur_kl_coeff": 6.661338147750938e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1904926111921668, "policy_loss": 6.874004611745477e-06, "vf_loss": 1.1904857365724941, "vf_explained_var": 0.9766153045619528, "kl": 0.0028515665225872034, "entropy": 0.27720429277978836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9730948500335215, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1855812293166916, "policy_loss": -0.003901450828804324, "vf_loss": 1.189457577156524, "vf_explained_var": 0.9757147525747617, "kl": 0.00714005533953154, "entropy": 0.48828062921141585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.37, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6237, "policy_reward_min": {"prey_policy": -46.79628501585056, "predator_policy": 1.5485880479613303}, "policy_reward_max": {"prey_policy": -1.5485880479613303, "predator_policy": 46.79628501585056}, "policy_reward_mean": {"prey_policy": -23.60577728400489, "predator_policy": 23.60577728400489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [65, 44, 92, 121, 48, 44, 47, 97, 49, 21, 64, 82, 87, 59, 65, 44, 48, 94, 31, 61, 9, 38, 61, 73, 41, 59, 96, 78, 15, 48, 39, 32, 54, 65, 77, 72, 23, 59, 88, 87, 78, 66, 57, 77, 80, 53, 90, 68, 31, 63, 66, 89, 54, 72, 42, 62, 71, 75, 96, 84, 68, 32, 73, 41, 57, 50, 50, 65, 78, 68, 109, 48, 42, 74, 67, 44, 32, 68, 83, 98, 84, 32, 20, 72, 53, 124, 86, 54, 54, 62, 9, 56, 88, 65, 72, 14, 61, 93, 55, 85], "policy_prey_policy_reward": [-29.696731706679298, -14.969594917005349, -32.03391813902891, -29.149874391674178, -33.88865085980829, -30.44142936390829, -14.015836873145311, -23.107549055926107, -4.017914343840449, -14.224926956424008, -41.23665643102553, -17.175171319022997, -29.724636363995813, -29.313659446607453, -17.628614456318363, -20.432028981676954, -12.13736875308988, -30.54131793603722, -10.7381295714526, -8.855331026646343, -1.5485880479613303, -6.792554947546315, -42.52536456458847, -37.968040723471134, -23.536581444332807, -10.161285925440293, -46.116992229608535, -38.59996363776691, -3.6126744807313997, -33.351669879642735, -18.681037457025745, -17.455092439566428, -21.150605320008086, -38.68927443283005, -34.66470605050906, -46.79628501585056, -14.308686309529945, -24.865330024351405, -42.97898912628901, -18.58660768827297, -17.367943859060173, -5.7185961074922975, -4.992434663261759, -11.543823168767435, -43.238922281946955, -25.608902159013923, -26.55439036671208, -26.783801728005262, -8.352045146691303, -21.015613047110833, -12.683390790498708, -30.244430036726826, -31.626185867527827, -29.180739053209567, -35.33407697491202, -31.802953078977907, -7.648434104385787, -24.874247710840294, -43.77317023704384, -44.85622977741529, -24.96756962131952, -17.322118608409568, -11.41349991832206, -16.732621627001002, -14.638643368482438, -11.916342799223404, -35.6623121417501, -16.923284068303087, -44.598189850256, -14.46063450722398, -27.198546275684688, -3.0733549382983725, -25.755048137971, -21.188400850427872, -37.96819445273036, -14.906518032623952, -21.337273426946584, -35.769971098066314, -38.05608502549863, -39.16292422273634, -41.27571542329805, -8.106641214142105, -2.5508961310884795, -29.063526628466636, -20.026012332767305, -14.016721592128643, -42.95546897137801, -31.926301495322644, -3.9890762107455364, -34.786301419244786, -3.814916746395995, -6.725932391957419, -16.514165314056694, -28.579223429106612, -30.141858606364014, -10.310705950008924, -11.433502631531569, -33.81353152434479, -26.533747252970297, -42.041949365658056], "policy_predator_policy_reward": [29.696731706679298, 14.969594917005349, 32.03391813902891, 29.149874391674178, 33.88865085980829, 30.44142936390829, 14.015836873145311, 23.107549055926107, 4.017914343840449, 14.224926956424008, 41.23665643102553, 17.175171319022997, 29.724636363995813, 29.313659446607453, 17.628614456318363, 20.432028981676954, 12.13736875308988, 30.54131793603722, 10.7381295714526, 8.855331026646343, 1.5485880479613303, 6.792554947546315, 42.52536456458847, 37.968040723471134, 23.536581444332807, 10.161285925440293, 46.116992229608535, 38.59996363776691, 3.6126744807313997, 33.351669879642735, 18.681037457025745, 17.455092439566428, 21.150605320008086, 38.68927443283005, 34.66470605050906, 46.79628501585056, 14.308686309529945, 24.865330024351405, 42.97898912628901, 18.58660768827297, 17.367943859060173, 5.7185961074922975, 4.992434663261759, 11.543823168767435, 43.238922281946955, 25.608902159013923, 26.55439036671208, 26.783801728005262, 8.352045146691303, 21.015613047110833, 12.683390790498708, 30.244430036726826, 31.626185867527827, 29.180739053209567, 35.33407697491202, 31.802953078977907, 7.648434104385787, 24.874247710840294, 43.77317023704384, 44.85622977741529, 24.96756962131952, 17.322118608409568, 11.41349991832206, 16.732621627001002, 14.638643368482438, 11.916342799223404, 35.6623121417501, 16.923284068303087, 44.598189850256, 14.46063450722398, 27.198546275684688, 3.0733549382983725, 25.755048137971, 21.188400850427872, 37.96819445273036, 14.906518032623952, 21.337273426946584, 35.769971098066314, 38.05608502549863, 39.16292422273634, 41.27571542329805, 8.106641214142105, 2.5508961310884795, 29.063526628466636, 20.026012332767305, 14.016721592128643, 42.95546897137801, 31.926301495322644, 3.9890762107455364, 34.786301419244786, 3.814916746395995, 6.725932391957419, 16.514165314056694, 28.579223429106612, 30.141858606364014, 10.310705950008924, 11.433502631531569, 33.81353152434479, 26.533747252970297, 42.041949365658056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923774369797989, "mean_inference_ms": 0.9318276897280054, "mean_action_processing_ms": 0.12492915321130832, "mean_env_wait_ms": 0.06587771555645165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028456449508666992, "StateBufferConnector_ms": 0.001954793930053711, "ViewRequirementAgentConnector_ms": 0.04597890377044678}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.4456390418859, "num_env_steps_trained_throughput_per_sec": 687.4456390418859, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 5988.61, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5988.573, "sample_time_ms": 657.497, "learn_time_ms": 5314.625, "learn_throughput": 752.64, "synch_weights_time_ms": 16.033}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 152, "trial_id": "abfb9_00000", "date": "2024-08-11_11-45-59", "timestamp": 1723391159, "time_this_iter_s": 5.8245580196380615, "time_total_s": 901.8981347084045, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600c1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 901.8981347084045, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 26.75, "ram_util_percent": 80.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.980785585877796, "cur_kl_coeff": 3.330669073875469e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1739956624185046, "policy_loss": -0.004883900562223668, "vf_loss": 1.1788795648763577, "vf_explained_var": 0.9782857287054261, "kl": 0.010918146897152156, "entropy": 0.3088567232868324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.071578586722414, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2008259070105851, "policy_loss": -0.006831559764153402, "vf_loss": 1.2076171847060322, "vf_explained_var": 0.9776751104742288, "kl": 0.011457462050152382, "entropy": 0.46909039889772736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.23, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6323, "policy_reward_min": {"prey_policy": -62.20412298171481, "predator_policy": 2.5508961310884795}, "policy_reward_max": {"prey_policy": -2.5508961310884795, "predator_policy": 62.20412298171481}, "policy_reward_mean": {"prey_policy": -24.996873735206226, "predator_policy": 24.996873735206226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [32, 73, 41, 57, 50, 50, 65, 78, 68, 109, 48, 42, 74, 67, 44, 32, 68, 83, 98, 84, 32, 20, 72, 53, 124, 86, 54, 54, 62, 9, 56, 88, 65, 72, 14, 61, 93, 55, 85, 48, 89, 30, 9, 41, 41, 127, 57, 27, 50, 49, 48, 89, 36, 59, 87, 77, 53, 56, 29, 63, 97, 80, 91, 49, 75, 62, 51, 47, 77, 93, 68, 22, 82, 76, 101, 65, 37, 51, 60, 82, 84, 79, 74, 27, 141, 93, 79, 64, 80, 64, 45, 59, 57, 58, 88, 45, 35, 72, 71, 59], "policy_prey_policy_reward": [-17.322118608409568, -11.41349991832206, -16.732621627001002, -14.638643368482438, -11.916342799223404, -35.6623121417501, -16.923284068303087, -44.598189850256, -14.46063450722398, -27.198546275684688, -3.0733549382983725, -25.755048137971, -21.188400850427872, -37.96819445273036, -14.906518032623952, -21.337273426946584, -35.769971098066314, -38.05608502549863, -39.16292422273634, -41.27571542329805, -8.106641214142105, -2.5508961310884795, -29.063526628466636, -20.026012332767305, -14.016721592128643, -42.95546897137801, -31.926301495322644, -3.9890762107455364, -34.786301419244786, -3.814916746395995, -6.725932391957419, -16.514165314056694, -28.579223429106612, -30.141858606364014, -10.310705950008924, -11.433502631531569, -33.81353152434479, -26.533747252970297, -42.041949365658056, -11.47443390301008, -22.93751054389394, -10.769635708196857, -4.063081415017667, -19.840554583140797, -36.84944542652559, -37.52503150255899, -41.01306621794259, -3.9685728733661536, -31.290787305054778, -24.31412020609331, -13.796764365293317, -26.682132514862907, -15.831477712333227, -27.481750202882026, -12.293424961809137, -33.79868775624312, -14.820206076098092, -15.745967687306772, -16.324041161304137, -38.801840497189296, -26.425274474543937, -20.545654814775826, -44.06791157138337, -11.300781313516232, -35.187449952267244, -14.487969442957283, -11.942789568662793, -10.41307103752691, -33.19266766446511, -36.455837825694275, -25.692280519652137, -5.45934196645061, -37.44082889182226, -44.890983613979294, -23.850965627899082, -38.13376768641491, -28.44076338555734, -16.8358740465148, -38.077409620710036, -44.028899129475036, -50.69029296585168, -26.216885045965974, -37.19843531822689, -10.207695334209374, -62.20412298171481, -31.63751900328955, -12.251494187123832, -23.74496582494104, -34.53342920541559, -40.09425210288048, -30.843517100143067, -10.416705044229921, -29.286605200142546, -20.411077474502434, -49.71924552117961, -23.553340563058512, -31.01233148491972, -27.80887566456032, -36.64077770661868, -18.032593036324883], "policy_predator_policy_reward": [17.322118608409568, 11.41349991832206, 16.732621627001002, 14.638643368482438, 11.916342799223404, 35.6623121417501, 16.923284068303087, 44.598189850256, 14.46063450722398, 27.198546275684688, 3.0733549382983725, 25.755048137971, 21.188400850427872, 37.96819445273036, 14.906518032623952, 21.337273426946584, 35.769971098066314, 38.05608502549863, 39.16292422273634, 41.27571542329805, 8.106641214142105, 2.5508961310884795, 29.063526628466636, 20.026012332767305, 14.016721592128643, 42.95546897137801, 31.926301495322644, 3.9890762107455364, 34.786301419244786, 3.814916746395995, 6.725932391957419, 16.514165314056694, 28.579223429106612, 30.141858606364014, 10.310705950008924, 11.433502631531569, 33.81353152434479, 26.533747252970297, 42.041949365658056, 11.47443390301008, 22.93751054389394, 10.769635708196857, 4.063081415017667, 19.840554583140797, 36.84944542652559, 37.52503150255899, 41.01306621794259, 3.9685728733661536, 31.290787305054778, 24.31412020609331, 13.796764365293317, 26.682132514862907, 15.831477712333227, 27.481750202882026, 12.293424961809137, 33.79868775624312, 14.820206076098092, 15.745967687306772, 16.324041161304137, 38.801840497189296, 26.425274474543937, 20.545654814775826, 44.06791157138337, 11.300781313516232, 35.187449952267244, 14.487969442957283, 11.942789568662793, 10.41307103752691, 33.19266766446511, 36.455837825694275, 25.692280519652137, 5.45934196645061, 37.44082889182226, 44.890983613979294, 23.850965627899082, 38.13376768641491, 28.44076338555734, 16.8358740465148, 38.077409620710036, 44.028899129475036, 50.69029296585168, 26.216885045965974, 37.19843531822689, 10.207695334209374, 62.20412298171481, 31.63751900328955, 12.251494187123832, 23.74496582494104, 34.53342920541559, 40.09425210288048, 30.843517100143067, 10.416705044229921, 29.286605200142546, 20.411077474502434, 49.71924552117961, 23.553340563058512, 31.01233148491972, 27.80887566456032, 36.64077770661868, 18.032593036324883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29216548692226807, "mean_inference_ms": 0.9312299130118069, "mean_action_processing_ms": 0.12479512690743017, "mean_env_wait_ms": 0.06583273949216624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002809762954711914, "StateBufferConnector_ms": 0.001969575881958008, "ViewRequirementAgentConnector_ms": 0.048853516578674316}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 667.1819427903522, "num_env_steps_trained_throughput_per_sec": 667.1819427903522, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 5986.092, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5986.055, "sample_time_ms": 657.026, "learn_time_ms": 5312.521, "learn_throughput": 752.938, "synch_weights_time_ms": 16.089}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 153, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-05", "timestamp": 1723391165, "time_this_iter_s": 6.001208066940308, "time_total_s": 907.8993427753448, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16002fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 907.8993427753448, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 27.544444444444444, "ram_util_percent": 80.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0198084779083727, "cur_kl_coeff": 3.330669073875469e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0859005398117005, "policy_loss": -0.003684898416395299, "vf_loss": 1.0895854318204026, "vf_explained_var": 0.9831255805989106, "kl": 0.006257079628085246, "entropy": 0.32424621159831685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.05864498578012, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1091085237450897, "policy_loss": -0.013990062395411467, "vf_loss": 1.1230411577348909, "vf_explained_var": 0.981522052983443, "kl": 0.0163356996767849, "entropy": 0.48814337216317655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.01, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6401, "policy_reward_min": {"prey_policy": -62.20412298171481, "predator_policy": 3.229740045154974}, "policy_reward_max": {"prey_policy": -3.229740045154974, "predator_policy": 62.20412298171481}, "policy_reward_mean": {"prey_policy": -28.13502679400577, "predator_policy": 28.13502679400577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [75, 62, 51, 47, 77, 93, 68, 22, 82, 76, 101, 65, 37, 51, 60, 82, 84, 79, 74, 27, 141, 93, 79, 64, 80, 64, 45, 59, 57, 58, 88, 45, 35, 72, 71, 59, 96, 38, 49, 49, 48, 24, 64, 95, 65, 68, 55, 57, 35, 71, 71, 111, 82, 42, 27, 67, 61, 55, 51, 55, 67, 77, 90, 67, 89, 23, 7, 46, 94, 39, 90, 83, 85, 35, 36, 36, 79, 67, 65, 40, 75, 48, 74, 83, 63, 52, 129, 108, 38, 81, 63, 76, 32, 63, 44, 54, 45, 76, 58, 65], "policy_prey_policy_reward": [-35.187449952267244, -14.487969442957283, -11.942789568662793, -10.41307103752691, -33.19266766446511, -36.455837825694275, -25.692280519652137, -5.45934196645061, -37.44082889182226, -44.890983613979294, -23.850965627899082, -38.13376768641491, -28.44076338555734, -16.8358740465148, -38.077409620710036, -44.028899129475036, -50.69029296585168, -26.216885045965974, -37.19843531822689, -10.207695334209374, -62.20412298171481, -31.63751900328955, -12.251494187123832, -23.74496582494104, -34.53342920541559, -40.09425210288048, -30.843517100143067, -10.416705044229921, -29.286605200142546, -20.411077474502434, -49.71924552117961, -23.553340563058512, -31.01233148491972, -27.80887566456032, -36.64077770661868, -18.032593036324883, -36.41895530674587, -22.347709850817914, -29.71940404044674, -30.550769505875287, -29.320964883678464, -22.782626976330878, -21.870046857005057, -43.824288437326636, -12.128526059126862, -27.841901800999104, -33.78880327730591, -25.54092296068743, -5.313762036894399, -29.522742016983994, -38.971764747973694, -16.749318621101008, -49.77307536720351, -19.24084039504362, -14.788862619766533, -29.091227764563904, -33.358400744809586, -12.867990393338205, -26.32318682892938, -22.36833058077938, -31.262866893527494, -40.28718623151305, -31.146360721597787, -42.54829898787461, -54.174681821071445, -13.535816659827864, -4.569206724661198, -22.05103177406623, -50.104306583065764, -13.703428631567434, -52.186913217649554, -24.48376369320553, -37.290690011805154, -18.150373941885256, -13.026827399147667, -3.229740045154974, -37.10559175896793, -7.950086078737018, -9.462582680630529, -14.811075842125753, -43.7780469488322, -20.858860784006406, -40.07505434560606, -16.623981413908957, -16.62553872756977, -25.25291960576656, -57.667485559180555, -23.02779707602353, -18.402585260159803, -38.670984972007275, -44.120987841109894, -46.947085027983036, -19.07101140862015, -24.60710018145538, -14.68535289261771, -21.81745007822207, -32.508152732991476, -41.29083168290772, -25.462776350297908, -35.38836399414725], "policy_predator_policy_reward": [35.187449952267244, 14.487969442957283, 11.942789568662793, 10.41307103752691, 33.19266766446511, 36.455837825694275, 25.692280519652137, 5.45934196645061, 37.44082889182226, 44.890983613979294, 23.850965627899082, 38.13376768641491, 28.44076338555734, 16.8358740465148, 38.077409620710036, 44.028899129475036, 50.69029296585168, 26.216885045965974, 37.19843531822689, 10.207695334209374, 62.20412298171481, 31.63751900328955, 12.251494187123832, 23.74496582494104, 34.53342920541559, 40.09425210288048, 30.843517100143067, 10.416705044229921, 29.286605200142546, 20.411077474502434, 49.71924552117961, 23.553340563058512, 31.01233148491972, 27.80887566456032, 36.64077770661868, 18.032593036324883, 36.41895530674587, 22.347709850817914, 29.71940404044674, 30.550769505875287, 29.320964883678464, 22.782626976330878, 21.870046857005057, 43.824288437326636, 12.128526059126862, 27.841901800999104, 33.78880327730591, 25.54092296068743, 5.313762036894399, 29.522742016983994, 38.971764747973694, 16.749318621101008, 49.77307536720351, 19.24084039504362, 14.788862619766533, 29.091227764563904, 33.358400744809586, 12.867990393338205, 26.32318682892938, 22.36833058077938, 31.262866893527494, 40.28718623151305, 31.146360721597787, 42.54829898787461, 54.174681821071445, 13.535816659827864, 4.569206724661198, 22.05103177406623, 50.104306583065764, 13.703428631567434, 52.186913217649554, 24.48376369320553, 37.290690011805154, 18.150373941885256, 13.026827399147667, 3.229740045154974, 37.10559175896793, 7.950086078737018, 9.462582680630529, 14.811075842125753, 43.7780469488322, 20.858860784006406, 40.07505434560606, 16.623981413908957, 16.62553872756977, 25.25291960576656, 57.667485559180555, 23.02779707602353, 18.402585260159803, 38.670984972007275, 44.120987841109894, 46.947085027983036, 19.07101140862015, 24.60710018145538, 14.68535289261771, 21.81745007822207, 32.508152732991476, 41.29083168290772, 25.462776350297908, 35.38836399414725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921382724747609, "mean_inference_ms": 0.9310802144820889, "mean_action_processing_ms": 0.12477974948131224, "mean_env_wait_ms": 0.06579688728984713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027588605880737305, "StateBufferConnector_ms": 0.002042531967163086, "ViewRequirementAgentConnector_ms": 0.04746901988983154}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 684.8745063329563, "num_env_steps_trained_throughput_per_sec": 684.8745063329563, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 5995.2, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5995.163, "sample_time_ms": 659.296, "learn_time_ms": 5319.292, "learn_throughput": 751.98, "synch_weights_time_ms": 16.089}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 154, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-10", "timestamp": 1723391170, "time_this_iter_s": 5.845715045928955, "time_total_s": 913.7450578212738, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602944c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 913.7450578212738, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 27.424999999999997, "ram_util_percent": 80.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9367553619047007, "cur_kl_coeff": 3.330669073875469e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8515252761698018, "policy_loss": -0.0017396210168953985, "vf_loss": 0.8532649000175297, "vf_explained_var": 0.9875955746819576, "kl": 0.0033579056250204074, "entropy": 0.2617137729966392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9765381132562956, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8383230675011873, "policy_loss": -0.004442948913492728, "vf_loss": 0.8427479040188094, "vf_explained_var": 0.9877614428599676, "kl": 0.005152926592267111, "entropy": 0.47994508914028605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.44, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6244, "policy_reward_min": {"prey_policy": -57.667485559180555, "predator_policy": 3.0059329915685122}, "policy_reward_max": {"prey_policy": -3.0059329915685122, "predator_policy": 57.667485559180555}, "policy_reward_mean": {"prey_policy": -27.394016116701366, "predator_policy": 27.394016116701366}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [23, 7, 46, 94, 39, 90, 83, 85, 35, 36, 36, 79, 67, 65, 40, 75, 48, 74, 83, 63, 52, 129, 108, 38, 81, 63, 76, 32, 63, 44, 54, 45, 76, 58, 65, 69, 56, 54, 76, 86, 96, 79, 69, 56, 64, 13, 23, 22, 117, 57, 70, 44, 48, 79, 59, 56, 131, 66, 57, 41, 85, 80, 40, 75, 79, 38, 76, 54, 69, 73, 81, 63, 80, 36, 67, 52, 91, 50, 77, 41, 50, 16, 69, 80, 103, 60, 82, 67, 60, 63, 64, 85, 70, 66, 54, 47, 5, 53, 54, 49], "policy_prey_policy_reward": [-13.535816659827864, -4.569206724661198, -22.05103177406623, -50.104306583065764, -13.703428631567434, -52.186913217649554, -24.48376369320553, -37.290690011805154, -18.150373941885256, -13.026827399147667, -3.229740045154974, -37.10559175896793, -7.950086078737018, -9.462582680630529, -14.811075842125753, -43.7780469488322, -20.858860784006406, -40.07505434560606, -16.623981413908957, -16.62553872756977, -25.25291960576656, -57.667485559180555, -23.02779707602353, -18.402585260159803, -38.670984972007275, -44.120987841109894, -46.947085027983036, -19.07101140862015, -24.60710018145538, -14.68535289261771, -21.81745007822207, -32.508152732991476, -41.29083168290772, -25.462776350297908, -35.38836399414725, -15.228157765475242, -32.93822574962411, -16.160330141140225, -32.28087184261454, -51.93749538503789, -38.63804798353528, -44.724023504419286, -31.104647743547847, -31.543634613022213, -30.71888360710472, -8.293927681288332, -12.571088990985029, -8.331035942319643, -44.415795044163374, -20.901658849560555, -20.80399737112111, -6.28111479873062, -29.9670609699942, -39.69531989811586, -19.992224379628937, -20.985107736536712, -36.421564357176244, -16.5654447426308, -23.970135645999942, -8.014563610990162, -47.35439453439099, -47.1582352403388, -20.315106149538913, -40.1089389240573, -19.247866552950605, -28.10338972081017, -38.089252145267764, -36.06493273897875, -30.97814467681177, -28.251647264120322, -38.445779402867686, -36.24014087235735, -35.8322135787429, -13.265170789986652, -30.392419751393536, -20.88594647563078, -51.99192945140866, -25.012402206933622, -41.93214935407966, -3.3076011833807324, -26.8794869723673, -12.067842827838136, -15.375544281660828, -49.13414283354562, -33.03290316040411, -30.646999310450465, -53.9050765594587, -29.784079953248312, -23.303777306240264, -34.331395727591584, -38.338753003474665, -37.19875256881592, -45.22475192918333, -25.20452047375379, -21.055017909988315, -9.484684618231055, -3.0059329915685122, -21.96740778388716, -13.036342636544942, -12.418377527162466], "policy_predator_policy_reward": [13.535816659827864, 4.569206724661198, 22.05103177406623, 50.104306583065764, 13.703428631567434, 52.186913217649554, 24.48376369320553, 37.290690011805154, 18.150373941885256, 13.026827399147667, 3.229740045154974, 37.10559175896793, 7.950086078737018, 9.462582680630529, 14.811075842125753, 43.7780469488322, 20.858860784006406, 40.07505434560606, 16.623981413908957, 16.62553872756977, 25.25291960576656, 57.667485559180555, 23.02779707602353, 18.402585260159803, 38.670984972007275, 44.120987841109894, 46.947085027983036, 19.07101140862015, 24.60710018145538, 14.68535289261771, 21.81745007822207, 32.508152732991476, 41.29083168290772, 25.462776350297908, 35.38836399414725, 15.228157765475242, 32.93822574962411, 16.160330141140225, 32.28087184261454, 51.93749538503789, 38.63804798353528, 44.724023504419286, 31.104647743547847, 31.543634613022213, 30.71888360710472, 8.293927681288332, 12.571088990985029, 8.331035942319643, 44.415795044163374, 20.901658849560555, 20.80399737112111, 6.28111479873062, 29.9670609699942, 39.69531989811586, 19.992224379628937, 20.985107736536712, 36.421564357176244, 16.5654447426308, 23.970135645999942, 8.014563610990162, 47.35439453439099, 47.1582352403388, 20.315106149538913, 40.1089389240573, 19.247866552950605, 28.10338972081017, 38.089252145267764, 36.06493273897875, 30.97814467681177, 28.251647264120322, 38.445779402867686, 36.24014087235735, 35.8322135787429, 13.265170789986652, 30.392419751393536, 20.88594647563078, 51.99192945140866, 25.012402206933622, 41.93214935407966, 3.3076011833807324, 26.8794869723673, 12.067842827838136, 15.375544281660828, 49.13414283354562, 33.03290316040411, 30.646999310450465, 53.9050765594587, 29.784079953248312, 23.303777306240264, 34.331395727591584, 38.338753003474665, 37.19875256881592, 45.22475192918333, 25.20452047375379, 21.055017909988315, 9.484684618231055, 3.0059329915685122, 21.96740778388716, 13.036342636544942, 12.418377527162466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29222555698076147, "mean_inference_ms": 0.9308322061347064, "mean_action_processing_ms": 0.12490545500219379, "mean_env_wait_ms": 0.06584841417517998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002694249153137207, "StateBufferConnector_ms": 0.002001643180847168, "ViewRequirementAgentConnector_ms": 0.04515731334686279}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 670.448201060419, "num_env_steps_trained_throughput_per_sec": 670.448201060419, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 6009.446, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6009.409, "sample_time_ms": 662.437, "learn_time_ms": 5330.269, "learn_throughput": 750.431, "synch_weights_time_ms": 16.217}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 155, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-16", "timestamp": 1723391176, "time_this_iter_s": 5.97144889831543, "time_total_s": 919.7165067195892, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x160294820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 919.7165067195892, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 26.924999999999997, "ram_util_percent": 80.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9156402915716173, "cur_kl_coeff": 1.6653345369377344e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9402743327276161, "policy_loss": -0.004300171765983881, "vf_loss": 0.9445745045008759, "vf_explained_var": 0.9841826504096389, "kl": 0.013730633271762261, "entropy": 0.2652967721223831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9448866351818044, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9523130943998694, "policy_loss": -0.005030749745492358, "vf_loss": 0.9573133471421897, "vf_explained_var": 0.9841799096514782, "kl": 0.008674959374808855, "entropy": 0.47676645663256445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.83, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6183, "policy_reward_min": {"prey_policy": -58.45141728555641, "predator_policy": 3.0059329915685122}, "policy_reward_max": {"prey_policy": -3.0059329915685122, "predator_policy": 58.45141728555641}, "policy_reward_mean": {"prey_policy": -26.980538750436157, "predator_policy": 26.980538750436157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [38, 76, 54, 69, 73, 81, 63, 80, 36, 67, 52, 91, 50, 77, 41, 50, 16, 69, 80, 103, 60, 82, 67, 60, 63, 64, 85, 70, 66, 54, 47, 5, 53, 54, 49, 42, 117, 64, 56, 82, 54, 72, 75, 32, 48, 76, 71, 64, 64, 41, 44, 53, 66, 38, 67, 57, 57, 55, 47, 74, 44, 61, 97, 69, 103, 49, 47, 63, 43, 65, 23, 88, 66, 79, 123, 73, 55, 79, 38, 41, 60, 39, 61, 62, 65, 47, 73, 82, 58, 120, 88, 66, 41, 33, 40, 26, 35, 86, 15, 119], "policy_prey_policy_reward": [-28.10338972081017, -38.089252145267764, -36.06493273897875, -30.97814467681177, -28.251647264120322, -38.445779402867686, -36.24014087235735, -35.8322135787429, -13.265170789986652, -30.392419751393536, -20.88594647563078, -51.99192945140866, -25.012402206933622, -41.93214935407966, -3.3076011833807324, -26.8794869723673, -12.067842827838136, -15.375544281660828, -49.13414283354562, -33.03290316040411, -30.646999310450465, -53.9050765594587, -29.784079953248312, -23.303777306240264, -34.331395727591584, -38.338753003474665, -37.19875256881592, -45.22475192918333, -25.20452047375379, -21.055017909988315, -9.484684618231055, -3.0059329915685122, -21.96740778388716, -13.036342636544942, -12.418377527162466, -18.15670059881196, -24.50036972048083, -24.6499180904536, -15.665736444443176, -52.180835271407794, -20.767866552491764, -27.666837099299425, -38.845508531316945, -11.633109043020074, -13.295934830079108, -34.9476305330046, -41.09364258241158, -42.06647871071701, -22.29266091586959, -24.622649613461906, -35.98471510903148, -26.766709176313746, -35.994852284778815, -23.339190086997323, -32.91580934678229, -34.00543240693989, -29.859097506607238, -40.784044625619536, -30.868745441023552, -26.616814562937144, -5.1198263542434885, -28.02565487898993, -18.81505477416724, -27.473873573363772, -25.866838797813237, -32.551530609218474, -5.059612254500639, -38.059794556573124, -32.19162871520211, -13.53818305078417, -4.304503393543164, -40.29961238071876, -40.464693853293106, -32.67437643775564, -58.45141728555641, -39.71241447480243, -12.377741384185114, -33.44992111647454, -17.175896607863773, -16.509876119922836, -25.215028951896034, -25.091391369654453, -12.858831243942378, -27.896921028533296, -14.748637927351723, -25.820266966025507, -24.16737770384828, -24.22114200278746, -4.550288696149019, -35.44980858129163, -26.688896768692224, -28.378810371713566, -20.400425712714128, -13.860761137304788, -25.5930162036351, -8.978037214382002, -28.886537725542574, -48.970687351584566, -6.015721292339332, -24.42863710276939], "policy_predator_policy_reward": [28.10338972081017, 38.089252145267764, 36.06493273897875, 30.97814467681177, 28.251647264120322, 38.445779402867686, 36.24014087235735, 35.8322135787429, 13.265170789986652, 30.392419751393536, 20.88594647563078, 51.99192945140866, 25.012402206933622, 41.93214935407966, 3.3076011833807324, 26.8794869723673, 12.067842827838136, 15.375544281660828, 49.13414283354562, 33.03290316040411, 30.646999310450465, 53.9050765594587, 29.784079953248312, 23.303777306240264, 34.331395727591584, 38.338753003474665, 37.19875256881592, 45.22475192918333, 25.20452047375379, 21.055017909988315, 9.484684618231055, 3.0059329915685122, 21.96740778388716, 13.036342636544942, 12.418377527162466, 18.15670059881196, 24.50036972048083, 24.6499180904536, 15.665736444443176, 52.180835271407794, 20.767866552491764, 27.666837099299425, 38.845508531316945, 11.633109043020074, 13.295934830079108, 34.9476305330046, 41.09364258241158, 42.06647871071701, 22.29266091586959, 24.622649613461906, 35.98471510903148, 26.766709176313746, 35.994852284778815, 23.339190086997323, 32.91580934678229, 34.00543240693989, 29.859097506607238, 40.784044625619536, 30.868745441023552, 26.616814562937144, 5.1198263542434885, 28.02565487898993, 18.81505477416724, 27.473873573363772, 25.866838797813237, 32.551530609218474, 5.059612254500639, 38.059794556573124, 32.19162871520211, 13.53818305078417, 4.304503393543164, 40.29961238071876, 40.464693853293106, 32.67437643775564, 58.45141728555641, 39.71241447480243, 12.377741384185114, 33.44992111647454, 17.175896607863773, 16.509876119922836, 25.215028951896034, 25.091391369654453, 12.858831243942378, 27.896921028533296, 14.748637927351723, 25.820266966025507, 24.16737770384828, 24.22114200278746, 4.550288696149019, 35.44980858129163, 26.688896768692224, 28.378810371713566, 20.400425712714128, 13.860761137304788, 25.5930162036351, 8.978037214382002, 28.886537725542574, 48.970687351584566, 6.015721292339332, 24.42863710276939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29233899209699765, "mean_inference_ms": 0.930676963697564, "mean_action_processing_ms": 0.12499235082302686, "mean_env_wait_ms": 0.06584269980182089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031785964965820312, "StateBufferConnector_ms": 0.001989006996154785, "ViewRequirementAgentConnector_ms": 0.0467991828918457}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 667.8735235724631, "num_env_steps_trained_throughput_per_sec": 667.8735235724631, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 6023.681, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6023.645, "sample_time_ms": 663.64, "learn_time_ms": 5343.526, "learn_throughput": 748.569, "synch_weights_time_ms": 15.995}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 156, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-22", "timestamp": 1723391182, "time_this_iter_s": 5.996145963668823, "time_total_s": 925.712652683258, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x160294ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 925.712652683258, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 27.000000000000004, "ram_util_percent": 80.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1040916718542575, "cur_kl_coeff": 1.6653345369377344e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.466030881150315, "policy_loss": -0.0020829793832187232, "vf_loss": 1.4681138616676133, "vf_explained_var": 0.9727727267891169, "kl": 0.0025629378633278558, "entropy": 0.2964019664252798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1769913232574862, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4827671017497779, "policy_loss": -0.005928450301871635, "vf_loss": 1.4886658051982522, "vf_explained_var": 0.9723172364756465, "kl": 0.00846272839786909, "entropy": 0.468260022594283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.41, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6341, "policy_reward_min": {"prey_policy": -58.45141728555641, "predator_policy": 0.3915136392946541}, "policy_reward_max": {"prey_policy": -0.3915136392946541, "predator_policy": 58.45141728555641}, "policy_reward_mean": {"prey_policy": -25.927490287991482, "predator_policy": 25.927490287991482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [61, 97, 69, 103, 49, 47, 63, 43, 65, 23, 88, 66, 79, 123, 73, 55, 79, 38, 41, 60, 39, 61, 62, 65, 47, 73, 82, 58, 120, 88, 66, 41, 33, 40, 26, 35, 86, 15, 119, 62, 60, 90, 55, 72, 20, 70, 88, 69, 84, 92, 62, 76, 76, 118, 75, 70, 46, 75, 100, 92, 32, 89, 96, 76, 52, 51, 26, 58, 23, 80, 69, 78, 21, 35, 57, 81, 49, 84, 82, 77, 74, 14, 79, 41, 10, 52, 68, 47, 54, 70, 125, 15, 32, 61, 67, 80, 35, 76, 43, 52], "policy_prey_policy_reward": [-28.02565487898993, -18.81505477416724, -27.473873573363772, -25.866838797813237, -32.551530609218474, -5.059612254500639, -38.059794556573124, -32.19162871520211, -13.53818305078417, -4.304503393543164, -40.29961238071876, -40.464693853293106, -32.67437643775564, -58.45141728555641, -39.71241447480243, -12.377741384185114, -33.44992111647454, -17.175896607863773, -16.509876119922836, -25.215028951896034, -25.091391369654453, -12.858831243942378, -27.896921028533296, -14.748637927351723, -25.820266966025507, -24.16737770384828, -24.22114200278746, -4.550288696149019, -35.44980858129163, -26.688896768692224, -28.378810371713566, -20.400425712714128, -13.860761137304788, -25.5930162036351, -8.978037214382002, -28.886537725542574, -48.970687351584566, -6.015721292339332, -24.42863710276939, -32.016989750609824, -27.980081897335765, -45.33225465975205, -19.85418425571986, -37.42430029311432, -15.836452113314008, -25.360123135331186, -24.698071818905667, -21.77466544105874, -35.69109365811732, -41.484699007256786, -15.34552292833334, -38.064312875623735, -9.80055334609493, -38.74237074411312, -32.51740968955065, -29.54011508386502, -20.77171477729657, -39.996977150837495, -42.360151391784974, -36.6101212993709, -19.90415202662265, -19.634260214312835, -42.50954238954494, -18.007424510808004, -21.62683468993137, -7.061325782178762, -17.328903384912515, -43.113538350588605, -7.501216696477032, -42.76091073383652, -30.44370052647847, -24.151410867389984, -12.92297223118919, -8.116938940973826, -18.459716499436375, -23.999732164538713, -25.797726215233418, -35.47061162695214, -29.8676390530521, -34.47416443428834, -39.46904524350006, -0.3915136392946541, -43.80160905345385, -9.802583708021185, -0.9346332712090157, -38.675347173151046, -33.314568518347095, -23.934724080677643, -21.21932424976702, -41.38150490899962, -47.42431537293525, -7.8912555247298934, -3.792634173931248, -9.560081529371004, -39.29918465043706, -26.995228606493562, -23.581138755709517, -46.34023465126662, -17.097749791760684, -34.26361562307429], "policy_predator_policy_reward": [28.02565487898993, 18.81505477416724, 27.473873573363772, 25.866838797813237, 32.551530609218474, 5.059612254500639, 38.059794556573124, 32.19162871520211, 13.53818305078417, 4.304503393543164, 40.29961238071876, 40.464693853293106, 32.67437643775564, 58.45141728555641, 39.71241447480243, 12.377741384185114, 33.44992111647454, 17.175896607863773, 16.509876119922836, 25.215028951896034, 25.091391369654453, 12.858831243942378, 27.896921028533296, 14.748637927351723, 25.820266966025507, 24.16737770384828, 24.22114200278746, 4.550288696149019, 35.44980858129163, 26.688896768692224, 28.378810371713566, 20.400425712714128, 13.860761137304788, 25.5930162036351, 8.978037214382002, 28.886537725542574, 48.970687351584566, 6.015721292339332, 24.42863710276939, 32.016989750609824, 27.980081897335765, 45.33225465975205, 19.85418425571986, 37.42430029311432, 15.836452113314008, 25.360123135331186, 24.698071818905667, 21.77466544105874, 35.69109365811732, 41.484699007256786, 15.34552292833334, 38.064312875623735, 9.80055334609493, 38.74237074411312, 32.51740968955065, 29.54011508386502, 20.77171477729657, 39.996977150837495, 42.360151391784974, 36.6101212993709, 19.90415202662265, 19.634260214312835, 42.50954238954494, 18.007424510808004, 21.62683468993137, 7.061325782178762, 17.328903384912515, 43.113538350588605, 7.501216696477032, 42.76091073383652, 30.44370052647847, 24.151410867389984, 12.92297223118919, 8.116938940973826, 18.459716499436375, 23.999732164538713, 25.797726215233418, 35.47061162695214, 29.8676390530521, 34.47416443428834, 39.46904524350006, 0.3915136392946541, 43.80160905345385, 9.802583708021185, 0.9346332712090157, 38.675347173151046, 33.314568518347095, 23.934724080677643, 21.21932424976702, 41.38150490899962, 47.42431537293525, 7.8912555247298934, 3.792634173931248, 9.560081529371004, 39.29918465043706, 26.995228606493562, 23.581138755709517, 46.34023465126662, 17.097749791760684, 34.26361562307429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29213552518333685, "mean_inference_ms": 0.931068255683935, "mean_action_processing_ms": 0.12493371150687402, "mean_env_wait_ms": 0.06585884295186696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033310651779174805, "StateBufferConnector_ms": 0.0020104646682739258, "ViewRequirementAgentConnector_ms": 0.04805099964141846}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 630.4916839830116, "num_env_steps_trained_throughput_per_sec": 630.4916839830116, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1256000, "timers": {"training_iteration_time_ms": 6007.976, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6007.939, "sample_time_ms": 663.253, "learn_time_ms": 5327.994, "learn_throughput": 750.752, "synch_weights_time_ms": 16.218}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "done": false, "training_iteration": 157, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-29", "timestamp": 1723391189, "time_this_iter_s": 6.349977731704712, "time_total_s": 932.0626304149628, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x160294d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 932.0626304149628, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 32.166666666666664, "ram_util_percent": 80.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7450224770233036, "cur_kl_coeff": 8.326672684688672e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9610528224613517, "policy_loss": -0.000942804325313773, "vf_loss": 0.9619956241610149, "vf_explained_var": 0.984767648205161, "kl": 0.003478726498680084, "entropy": 0.27250934722833337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9196153046563267, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9474626022701462, "policy_loss": -0.00577505956995689, "vf_loss": 0.9532089536388715, "vf_explained_var": 0.9848329491913319, "kl": 0.008166959505639445, "entropy": 0.4798095153023799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 58.36, "episode_media": {}, "episodes_this_iter": 70, "episodes_timesteps_total": 5836, "policy_reward_min": {"prey_policy": -57.563133521470334, "predator_policy": 0.03951246679003606}, "policy_reward_max": {"prey_policy": -0.03951246679003606, "predator_policy": 57.563133521470334}, "policy_reward_mean": {"prey_policy": -24.763876910065875, "predator_policy": 24.763876910065875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [69, 78, 21, 35, 57, 81, 49, 84, 82, 77, 74, 14, 79, 41, 10, 52, 68, 47, 54, 70, 125, 15, 32, 61, 67, 80, 35, 76, 43, 52, 93, 75, 93, 30, 19, 47, 30, 37, 60, 79, 62, 85, 87, 44, 87, 34, 27, 61, 58, 52, 61, 29, 51, 38, 33, 43, 39, 87, 39, 63, 42, 69, 118, 91, 49, 54, 67, 73, 46, 85, 38, 17, 43, 25, 64, 76, 74, 88, 31, 78, 46, 78, 23, 72, 74, 45, 86, 54, 76, 67, 40, 82, 68, 47, 57, 70, 72, 26, 116, 38], "policy_prey_policy_reward": [-30.44370052647847, -24.151410867389984, -12.92297223118919, -8.116938940973826, -18.459716499436375, -23.999732164538713, -25.797726215233418, -35.47061162695214, -29.8676390530521, -34.47416443428834, -39.46904524350006, -0.3915136392946541, -43.80160905345385, -9.802583708021185, -0.9346332712090157, -38.675347173151046, -33.314568518347095, -23.934724080677643, -21.21932424976702, -41.38150490899962, -47.42431537293525, -7.8912555247298934, -3.792634173931248, -9.560081529371004, -39.29918465043706, -26.995228606493562, -23.581138755709517, -46.34023465126662, -17.097749791760684, -34.26361562307429, -51.52966987481324, -43.55168579232212, -57.563133521470334, -20.000500210458313, -11.13069530925208, -5.473872992150542, -0.03951246679003606, -18.759772474258945, -27.203277409667283, -37.110344682319266, -42.749866903326776, -11.438483927687043, -54.285897160479735, -24.157534147622158, -19.875597048455877, -16.906457959091412, -9.325101802300686, -25.809034598349726, -30.021883952719147, -12.721503841035029, -15.008142476749528, -15.679721831417076, -10.169156829282336, -8.592229500494186, -19.966580072673043, -14.701051255672654, -31.324729577583227, -30.16376685545797, -12.148067617675569, -38.325709078526494, -13.712868531960154, -14.220841007017219, -32.24968237394984, -47.78863421917043, -22.34033197971413, -24.278239005391303, -35.167607218019086, -38.39798765278709, -9.587255321214986, -35.109306669429614, -15.271103542660036, -4.116227153387637, -21.451784395454556, -3.878862970072797, -12.740105316043556, -28.84773844618773, -6.178170007535102, -55.89123264018367, -21.489614966564375, -29.364571696668303, -30.42285266679794, -38.54492142535244, -9.068812035666843, -47.682537363921426, -35.34930090653758, -24.099029443597953, -29.58874183043398, -12.281571454017122, -33.24106824773746, -32.621303856802236, -18.00936721732264, -47.51236384879236, -25.089380538019473, -7.611435431351186, -33.1079761685603, -13.979064663222053, -28.011291806839072, -15.682615543558322, -35.18984941604444, -18.604155772836112], "policy_predator_policy_reward": [30.44370052647847, 24.151410867389984, 12.92297223118919, 8.116938940973826, 18.459716499436375, 23.999732164538713, 25.797726215233418, 35.47061162695214, 29.8676390530521, 34.47416443428834, 39.46904524350006, 0.3915136392946541, 43.80160905345385, 9.802583708021185, 0.9346332712090157, 38.675347173151046, 33.314568518347095, 23.934724080677643, 21.21932424976702, 41.38150490899962, 47.42431537293525, 7.8912555247298934, 3.792634173931248, 9.560081529371004, 39.29918465043706, 26.995228606493562, 23.581138755709517, 46.34023465126662, 17.097749791760684, 34.26361562307429, 51.52966987481324, 43.55168579232212, 57.563133521470334, 20.000500210458313, 11.13069530925208, 5.473872992150542, 0.03951246679003606, 18.759772474258945, 27.203277409667283, 37.110344682319266, 42.749866903326776, 11.438483927687043, 54.285897160479735, 24.157534147622158, 19.875597048455877, 16.906457959091412, 9.325101802300686, 25.809034598349726, 30.021883952719147, 12.721503841035029, 15.008142476749528, 15.679721831417076, 10.169156829282336, 8.592229500494186, 19.966580072673043, 14.701051255672654, 31.324729577583227, 30.16376685545797, 12.148067617675569, 38.325709078526494, 13.712868531960154, 14.220841007017219, 32.24968237394984, 47.78863421917043, 22.34033197971413, 24.278239005391303, 35.167607218019086, 38.39798765278709, 9.587255321214986, 35.109306669429614, 15.271103542660036, 4.116227153387637, 21.451784395454556, 3.878862970072797, 12.740105316043556, 28.84773844618773, 6.178170007535102, 55.89123264018367, 21.489614966564375, 29.364571696668303, 30.42285266679794, 38.54492142535244, 9.068812035666843, 47.682537363921426, 35.34930090653758, 24.099029443597953, 29.58874183043398, 12.281571454017122, 33.24106824773746, 32.621303856802236, 18.00936721732264, 47.51236384879236, 25.089380538019473, 7.611435431351186, 33.1079761685603, 13.979064663222053, 28.011291806839072, 15.682615543558322, 35.18984941604444, 18.604155772836112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29211897509661533, "mean_inference_ms": 0.929889158422763, "mean_action_processing_ms": 0.12491245263218258, "mean_env_wait_ms": 0.06569865140209599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027233362197875977, "StateBufferConnector_ms": 0.0019103288650512695, "ViewRequirementAgentConnector_ms": 0.04612553119659424}, "num_episodes": 70, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 662.068800047418, "num_env_steps_trained_throughput_per_sec": 662.068800047418, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 5995.396, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5995.36, "sample_time_ms": 663.568, "learn_time_ms": 5315.168, "learn_throughput": 752.563, "synch_weights_time_ms": 16.097}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 158, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-35", "timestamp": 1723391195, "time_this_iter_s": 6.046907901763916, "time_total_s": 938.1095383167267, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16002f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 938.1095383167267, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 29.15, "ram_util_percent": 80.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.425743154808879, "cur_kl_coeff": 4.163336342344336e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3286883747205138, "policy_loss": -0.0020199054900634414, "vf_loss": 1.3307082841793696, "vf_explained_var": 0.9712119733914732, "kl": 0.003719783683662096, "entropy": 0.2571259000804275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3942613588025172, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3569747785727182, "policy_loss": -0.004627073599597982, "vf_loss": 1.3615834668278695, "vf_explained_var": 0.9701557965328296, "kl": 0.005230796925035306, "entropy": 0.5214559021716316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.07, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6107, "policy_reward_min": {"prey_policy": -55.89123264018367, "predator_policy": 0.24535191546267054}, "policy_reward_max": {"prey_policy": -0.24535191546267054, "predator_policy": 55.89123264018367}, "policy_reward_mean": {"prey_policy": -22.560734446313717, "predator_policy": 22.560734446313717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [49, 54, 67, 73, 46, 85, 38, 17, 43, 25, 64, 76, 74, 88, 31, 78, 46, 78, 23, 72, 74, 45, 86, 54, 76, 67, 40, 82, 68, 47, 57, 70, 72, 26, 116, 38, 73, 61, 55, 51, 70, 88, 47, 45, 76, 55, 76, 47, 54, 60, 87, 72, 74, 59, 54, 74, 48, 69, 60, 93, 60, 33, 55, 78, 31, 109, 86, 97, 41, 71, 1, 84, 55, 58, 67, 74, 70, 55, 31, 6, 70, 66, 66, 83, 95, 62, 46, 101, 53, 37, 73, 99, 42, 62, 56, 44, 34, 51, 68, 44], "policy_prey_policy_reward": [-22.34033197971413, -24.278239005391303, -35.167607218019086, -38.39798765278709, -9.587255321214986, -35.109306669429614, -15.271103542660036, -4.116227153387637, -21.451784395454556, -3.878862970072797, -12.740105316043556, -28.84773844618773, -6.178170007535102, -55.89123264018367, -21.489614966564375, -29.364571696668303, -30.42285266679794, -38.54492142535244, -9.068812035666843, -47.682537363921426, -35.34930090653758, -24.099029443597953, -29.58874183043398, -12.281571454017122, -33.24106824773746, -32.621303856802236, -18.00936721732264, -47.51236384879236, -25.089380538019473, -7.611435431351186, -33.1079761685603, -13.979064663222053, -28.011291806839072, -15.682615543558322, -35.18984941604444, -18.604155772836112, -19.239166900404605, -16.91101031196953, -8.321053769255482, -25.62194354193187, -13.802110513465403, -17.49667370029956, -10.844356334606063, -5.1347840929607775, -41.525759435704074, -21.457654309895556, -20.994179932242606, -30.17721829406245, -14.071451957062479, -29.023325499584814, -33.62976898677226, -7.564169873125529, -23.307988103948016, -15.253056070570963, -19.223057932477026, -22.986034565306955, -24.944281441430043, -9.031384409907774, -21.27217969636616, -46.34176522147489, -14.20519520951078, -13.548251618915138, -12.187693671034975, -28.33841841102831, -12.791923668936935, -23.38139922389694, -16.002907912456514, -21.089908122777494, -18.05568263886192, -27.477601914952107, -0.24535191546267054, -48.57665382972075, -22.64071392444879, -34.48099793198306, -19.385532780878673, -28.67129798139048, -29.363567629235693, -1.6464017496046042, -13.4665640780208, -3.8096540353563757, -20.252070439350895, -27.06008704360621, -32.99596545626798, -7.145211141890815, -42.7941396540578, -14.982123071256991, -22.79162056229548, -12.58990390977134, -11.941963177031088, -23.34535667153734, -18.286216858596852, -25.994989573235245, -16.722137767104556, -26.274837305113675, -36.84100312382977, -30.999204216643772, -32.78680355597718, -22.759827949767992, -20.609017170176863, -21.553094221837508], "policy_predator_policy_reward": [22.34033197971413, 24.278239005391303, 35.167607218019086, 38.39798765278709, 9.587255321214986, 35.109306669429614, 15.271103542660036, 4.116227153387637, 21.451784395454556, 3.878862970072797, 12.740105316043556, 28.84773844618773, 6.178170007535102, 55.89123264018367, 21.489614966564375, 29.364571696668303, 30.42285266679794, 38.54492142535244, 9.068812035666843, 47.682537363921426, 35.34930090653758, 24.099029443597953, 29.58874183043398, 12.281571454017122, 33.24106824773746, 32.621303856802236, 18.00936721732264, 47.51236384879236, 25.089380538019473, 7.611435431351186, 33.1079761685603, 13.979064663222053, 28.011291806839072, 15.682615543558322, 35.18984941604444, 18.604155772836112, 19.239166900404605, 16.91101031196953, 8.321053769255482, 25.62194354193187, 13.802110513465403, 17.49667370029956, 10.844356334606063, 5.1347840929607775, 41.525759435704074, 21.457654309895556, 20.994179932242606, 30.17721829406245, 14.071451957062479, 29.023325499584814, 33.62976898677226, 7.564169873125529, 23.307988103948016, 15.253056070570963, 19.223057932477026, 22.986034565306955, 24.944281441430043, 9.031384409907774, 21.27217969636616, 46.34176522147489, 14.20519520951078, 13.548251618915138, 12.187693671034975, 28.33841841102831, 12.791923668936935, 23.38139922389694, 16.002907912456514, 21.089908122777494, 18.05568263886192, 27.477601914952107, 0.24535191546267054, 48.57665382972075, 22.64071392444879, 34.48099793198306, 19.385532780878673, 28.67129798139048, 29.363567629235693, 1.6464017496046042, 13.4665640780208, 3.8096540353563757, 20.252070439350895, 27.06008704360621, 32.99596545626798, 7.145211141890815, 42.7941396540578, 14.982123071256991, 22.79162056229548, 12.58990390977134, 11.941963177031088, 23.34535667153734, 18.286216858596852, 25.994989573235245, 16.722137767104556, 26.274837305113675, 36.84100312382977, 30.999204216643772, 32.78680355597718, 22.759827949767992, 20.609017170176863, 21.553094221837508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919827735903782, "mean_inference_ms": 0.9300066499572381, "mean_action_processing_ms": 0.1248439117644124, "mean_env_wait_ms": 0.06574946049743988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029338598251342773, "StateBufferConnector_ms": 0.0019930601119995117, "ViewRequirementAgentConnector_ms": 0.04691731929779053}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.795144516357, "num_env_steps_trained_throughput_per_sec": 672.795144516357, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 5990.159, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5990.124, "sample_time_ms": 659.42, "learn_time_ms": 5314.247, "learn_throughput": 752.694, "synch_weights_time_ms": 15.928}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 159, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-41", "timestamp": 1723391201, "time_this_iter_s": 5.9518351554870605, "time_total_s": 944.0613734722137, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16005f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 944.0613734722137, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 26.58888888888889, "ram_util_percent": 80.97777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2503845021128654, "cur_kl_coeff": 2.081668171172168e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3624932595218222, "policy_loss": -0.0008094828929946137, "vf_loss": 1.363302744552493, "vf_explained_var": 0.9723063677549362, "kl": 0.005386873459190366, "entropy": 0.2754508602588127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.218405488009254, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3320400812973578, "policy_loss": -0.007622591132045878, "vf_loss": 1.3396283203115067, "vf_explained_var": 0.9729807601620754, "kl": 0.0097694365070228, "entropy": 0.570537808847924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.62, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6362, "policy_reward_min": {"prey_policy": -50.97425043906115, "predator_policy": 0.24535191546267054}, "policy_reward_max": {"prey_policy": -0.24535191546267054, "predator_policy": 50.97425043906115}, "policy_reward_mean": {"prey_policy": -25.102913065565705, "predator_policy": 25.102913065565705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [55, 78, 31, 109, 86, 97, 41, 71, 1, 84, 55, 58, 67, 74, 70, 55, 31, 6, 70, 66, 66, 83, 95, 62, 46, 101, 53, 37, 73, 99, 42, 62, 56, 44, 34, 51, 68, 44, 93, 52, 41, 27, 96, 64, 68, 61, 65, 46, 43, 85, 74, 58, 73, 79, 58, 88, 50, 76, 81, 54, 89, 51, 72, 34, 93, 82, 43, 75, 35, 79, 42, 79, 62, 81, 73, 96, 91, 43, 85, 66, 106, 72, 64, 66, 64, 80, 74, 19, 50, 59, 74, 64, 9, 73, 70, 41, 44, 69, 67, 73], "policy_prey_policy_reward": [-12.187693671034975, -28.33841841102831, -12.791923668936935, -23.38139922389694, -16.002907912456514, -21.089908122777494, -18.05568263886192, -27.477601914952107, -0.24535191546267054, -48.57665382972075, -22.64071392444879, -34.48099793198306, -19.385532780878673, -28.67129798139048, -29.363567629235693, -1.6464017496046042, -13.4665640780208, -3.8096540353563757, -20.252070439350895, -27.06008704360621, -32.99596545626798, -7.145211141890815, -42.7941396540578, -14.982123071256991, -22.79162056229548, -12.58990390977134, -11.941963177031088, -23.34535667153734, -18.286216858596852, -25.994989573235245, -16.722137767104556, -26.274837305113675, -36.84100312382977, -30.999204216643772, -32.78680355597718, -22.759827949767992, -20.609017170176863, -21.553094221837508, -42.00271620428128, -15.15552396660015, -6.0453117366911275, -12.181884763447329, -45.72257787441828, -19.288828079025635, -28.829361997583547, -23.24274109644202, -27.007868822433323, -23.291502973087255, -17.946361714426857, -17.745478587799248, -6.687279717140033, -19.01214451678013, -22.32442502402869, -25.689457872556822, -27.85752295070537, -43.85490795752652, -39.46212153704407, -36.500563877513535, -28.215811846423797, -33.42855733207286, -20.89947737772301, -26.213422838055102, -8.464731603868053, -14.61602747673367, -25.019765089199574, -35.006554784238006, -28.530996907188708, -2.8730933919142996, -22.42490548420993, -19.293621404244703, -9.75306801889274, -45.917101040517444, -41.264815928830664, -28.84340307888842, -42.97109130196793, -50.97425043906115, -47.12432288313773, -23.432332971262632, -18.686904435089126, -28.033553330958807, -21.3083058129038, -35.645585081950685, -48.23739051621292, -37.446885966590806, -17.785340357722916, -43.748209224987775, -38.55425180808061, -4.704028331301433, -31.118488007812104, -20.713168144417562, -36.91983304499836, -46.28571414801504, -5.269369842892937, -40.86291554436801, -19.15241631059526, -26.50564822731728, -22.03295846759906, -40.092906449004545, -23.329190427994057, -18.404466318398676], "policy_predator_policy_reward": [12.187693671034975, 28.33841841102831, 12.791923668936935, 23.38139922389694, 16.002907912456514, 21.089908122777494, 18.05568263886192, 27.477601914952107, 0.24535191546267054, 48.57665382972075, 22.64071392444879, 34.48099793198306, 19.385532780878673, 28.67129798139048, 29.363567629235693, 1.6464017496046042, 13.4665640780208, 3.8096540353563757, 20.252070439350895, 27.06008704360621, 32.99596545626798, 7.145211141890815, 42.7941396540578, 14.982123071256991, 22.79162056229548, 12.58990390977134, 11.941963177031088, 23.34535667153734, 18.286216858596852, 25.994989573235245, 16.722137767104556, 26.274837305113675, 36.84100312382977, 30.999204216643772, 32.78680355597718, 22.759827949767992, 20.609017170176863, 21.553094221837508, 42.00271620428128, 15.15552396660015, 6.0453117366911275, 12.181884763447329, 45.72257787441828, 19.288828079025635, 28.829361997583547, 23.24274109644202, 27.007868822433323, 23.291502973087255, 17.946361714426857, 17.745478587799248, 6.687279717140033, 19.01214451678013, 22.32442502402869, 25.689457872556822, 27.85752295070537, 43.85490795752652, 39.46212153704407, 36.500563877513535, 28.215811846423797, 33.42855733207286, 20.89947737772301, 26.213422838055102, 8.464731603868053, 14.61602747673367, 25.019765089199574, 35.006554784238006, 28.530996907188708, 2.8730933919142996, 22.42490548420993, 19.293621404244703, 9.75306801889274, 45.917101040517444, 41.264815928830664, 28.84340307888842, 42.97109130196793, 50.97425043906115, 47.12432288313773, 23.432332971262632, 18.686904435089126, 28.033553330958807, 21.3083058129038, 35.645585081950685, 48.23739051621292, 37.446885966590806, 17.785340357722916, 43.748209224987775, 38.55425180808061, 4.704028331301433, 31.118488007812104, 20.713168144417562, 36.91983304499836, 46.28571414801504, 5.269369842892937, 40.86291554436801, 19.15241631059526, 26.50564822731728, 22.03295846759906, 40.092906449004545, 23.329190427994057, 18.404466318398676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29197053840763787, "mean_inference_ms": 0.9296392547682518, "mean_action_processing_ms": 0.1247709796601794, "mean_env_wait_ms": 0.06570980113379375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030721426010131836, "StateBufferConnector_ms": 0.002003908157348633, "ViewRequirementAgentConnector_ms": 0.04647660255432129}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 674.0773642174674, "num_env_steps_trained_throughput_per_sec": 674.0773642174674, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 5986.548, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5986.514, "sample_time_ms": 661.545, "learn_time_ms": 5311.421, "learn_throughput": 753.094, "synch_weights_time_ms": 13.101}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 160, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-47", "timestamp": 1723391207, "time_this_iter_s": 5.939694881439209, "time_total_s": 950.001068353653, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17cd940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 950.001068353653, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 26.737500000000004, "ram_util_percent": 81.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0846076839913925, "cur_kl_coeff": 2.081668171172168e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2433527193653087, "policy_loss": -0.0025109305900211138, "vf_loss": 1.245863642015805, "vf_explained_var": 0.9770774470021327, "kl": 0.0031595435728677753, "entropy": 0.26296841093959905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1567337198803824, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2359670769423245, "policy_loss": -0.004975613998249173, "vf_loss": 1.2409113752966126, "vf_explained_var": 0.9770607744033138, "kl": 0.008906705731288949, "entropy": 0.5431694814004004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.45, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6345, "policy_reward_min": {"prey_policy": -58.70670698256794, "predator_policy": 2.8730933919142996}, "policy_reward_max": {"prey_policy": -2.8730933919142996, "predator_policy": 58.70670698256794}, "policy_reward_mean": {"prey_policy": -26.169679815137552, "predator_policy": 26.169679815137552}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [34, 93, 82, 43, 75, 35, 79, 42, 79, 62, 81, 73, 96, 91, 43, 85, 66, 106, 72, 64, 66, 64, 80, 74, 19, 50, 59, 74, 64, 9, 73, 70, 41, 44, 69, 67, 73, 125, 65, 49, 70, 75, 56, 55, 61, 66, 138, 58, 80, 64, 49, 75, 86, 80, 50, 66, 54, 65, 38, 89, 57, 76, 68, 65, 87, 64, 49, 75, 44, 43, 34, 39, 46, 61, 45, 38, 79, 71, 53, 48, 37, 58, 66, 57, 86, 46, 82, 16, 86, 43, 40, 69, 63, 64, 57, 48, 84, 92, 55, 43], "policy_prey_policy_reward": [-14.61602747673367, -25.019765089199574, -35.006554784238006, -28.530996907188708, -2.8730933919142996, -22.42490548420993, -19.293621404244703, -9.75306801889274, -45.917101040517444, -41.264815928830664, -28.84340307888842, -42.97109130196793, -50.97425043906115, -47.12432288313773, -23.432332971262632, -18.686904435089126, -28.033553330958807, -21.3083058129038, -35.645585081950685, -48.23739051621292, -37.446885966590806, -17.785340357722916, -43.748209224987775, -38.55425180808061, -4.704028331301433, -31.118488007812104, -20.713168144417562, -36.91983304499836, -46.28571414801504, -5.269369842892937, -40.86291554436801, -19.15241631059526, -26.50564822731728, -22.03295846759906, -40.092906449004545, -23.329190427994057, -18.404466318398676, -39.72288295070822, -16.994781160152826, -32.418547305115275, -22.98941882261055, -24.73782589984926, -24.87033969539907, -38.515551034278865, -14.459232270010464, -36.629700190288744, -39.21677033419409, -37.797221666835306, -41.940414411739624, -33.476793616069855, -17.069929498075354, -28.974395254631652, -58.70670698256794, -28.841508246256094, -5.53525584526055, -15.73143734523741, -25.55922564941651, -17.717450240484496, -12.367643888401119, -30.781081808900048, -8.602817504286394, -44.123010250169294, -47.32252791172471, -10.53113578429947, -36.51231653832298, -8.475922207237867, -19.204824939865382, -15.92707340003153, -23.192292749751175, -34.97693769386102, -19.663891449813168, -16.380180376949376, -25.164496432218613, -10.346431402510666, -17.314425371964102, -3.8948505132395126, -49.217052751153595, -47.06691549528933, -9.133809917789208, -10.187707947610514, -12.679337621056701, -19.944405488860454, -29.974980208549606, -39.522084424302584, -42.45456388085146, -32.957108555110416, -7.036229057392713, -7.701082684575685, -37.445731843861005, -34.92538534793716, -17.21589709779622, -30.689798012717958, -4.358077799483099, -23.24740631734283, -26.64470481033783, -5.623329481942953, -4.721554280482862, -29.680951651345566, -35.97257451231474, -8.997163683423173], "policy_predator_policy_reward": [14.61602747673367, 25.019765089199574, 35.006554784238006, 28.530996907188708, 2.8730933919142996, 22.42490548420993, 19.293621404244703, 9.75306801889274, 45.917101040517444, 41.264815928830664, 28.84340307888842, 42.97109130196793, 50.97425043906115, 47.12432288313773, 23.432332971262632, 18.686904435089126, 28.033553330958807, 21.3083058129038, 35.645585081950685, 48.23739051621292, 37.446885966590806, 17.785340357722916, 43.748209224987775, 38.55425180808061, 4.704028331301433, 31.118488007812104, 20.713168144417562, 36.91983304499836, 46.28571414801504, 5.269369842892937, 40.86291554436801, 19.15241631059526, 26.50564822731728, 22.03295846759906, 40.092906449004545, 23.329190427994057, 18.404466318398676, 39.72288295070822, 16.994781160152826, 32.418547305115275, 22.98941882261055, 24.73782589984926, 24.87033969539907, 38.515551034278865, 14.459232270010464, 36.629700190288744, 39.21677033419409, 37.797221666835306, 41.940414411739624, 33.476793616069855, 17.069929498075354, 28.974395254631652, 58.70670698256794, 28.841508246256094, 5.53525584526055, 15.73143734523741, 25.55922564941651, 17.717450240484496, 12.367643888401119, 30.781081808900048, 8.602817504286394, 44.123010250169294, 47.32252791172471, 10.53113578429947, 36.51231653832298, 8.475922207237867, 19.204824939865382, 15.92707340003153, 23.192292749751175, 34.97693769386102, 19.663891449813168, 16.380180376949376, 25.164496432218613, 10.346431402510666, 17.314425371964102, 3.8948505132395126, 49.217052751153595, 47.06691549528933, 9.133809917789208, 10.187707947610514, 12.679337621056701, 19.944405488860454, 29.974980208549606, 39.522084424302584, 42.45456388085146, 32.957108555110416, 7.036229057392713, 7.701082684575685, 37.445731843861005, 34.92538534793716, 17.21589709779622, 30.689798012717958, 4.358077799483099, 23.24740631734283, 26.64470481033783, 5.623329481942953, 4.721554280482862, 29.680951651345566, 35.97257451231474, 8.997163683423173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917231326651601, "mean_inference_ms": 0.9293391430324306, "mean_action_processing_ms": 0.12460313246622068, "mean_env_wait_ms": 0.0656279069316505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002980828285217285, "StateBufferConnector_ms": 0.002116680145263672, "ViewRequirementAgentConnector_ms": 0.04822683334350586}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.4600280828711, "num_env_steps_trained_throughput_per_sec": 672.4600280828711, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1288000, "timers": {"training_iteration_time_ms": 5982.35, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5982.316, "sample_time_ms": 658.63, "learn_time_ms": 5310.094, "learn_throughput": 753.282, "synch_weights_time_ms": 13.146}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "done": false, "training_iteration": 161, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-53", "timestamp": 1723391213, "time_this_iter_s": 5.953747034072876, "time_total_s": 955.9548153877258, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17dec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 955.9548153877258, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 27.955555555555556, "ram_util_percent": 81.02222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3234941915919385, "cur_kl_coeff": 1.040834085586084e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3596250175808866, "policy_loss": -0.00017775770296187451, "vf_loss": 1.359802774526179, "vf_explained_var": 0.9768274175003171, "kl": 0.0041161070239921875, "entropy": 0.2895884431898594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.345173716793458, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3384795824686686, "policy_loss": -0.01051168823178159, "vf_loss": 1.348943928318719, "vf_explained_var": 0.9781675435602665, "kl": 0.013466568982840125, "entropy": 0.5772382468606035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.19, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6219, "policy_reward_min": {"prey_policy": -55.03586065724344, "predator_policy": 1.0401270186724787}, "policy_reward_max": {"prey_policy": -1.0401270186724787, "predator_policy": 55.03586065724344}, "policy_reward_mean": {"prey_policy": -25.6308480351487, "predator_policy": 25.6308480351487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [65, 87, 64, 49, 75, 44, 43, 34, 39, 46, 61, 45, 38, 79, 71, 53, 48, 37, 58, 66, 57, 86, 46, 82, 16, 86, 43, 40, 69, 63, 64, 57, 48, 84, 92, 55, 43, 64, 86, 91, 87, 64, 50, 35, 82, 66, 76, 76, 35, 80, 111, 24, 34, 21, 114, 67, 81, 17, 46, 96, 72, 59, 88, 29, 78, 61, 29, 66, 46, 58, 41, 57, 74, 41, 76, 86, 68, 32, 62, 73, 68, 72, 82, 56, 103, 75, 65, 63, 76, 82, 66, 45, 62, 54, 69, 77, 76, 54, 63, 79], "policy_prey_policy_reward": [-10.53113578429947, -36.51231653832298, -8.475922207237867, -19.204824939865382, -15.92707340003153, -23.192292749751175, -34.97693769386102, -19.663891449813168, -16.380180376949376, -25.164496432218613, -10.346431402510666, -17.314425371964102, -3.8948505132395126, -49.217052751153595, -47.06691549528933, -9.133809917789208, -10.187707947610514, -12.679337621056701, -19.944405488860454, -29.974980208549606, -39.522084424302584, -42.45456388085146, -32.957108555110416, -7.036229057392713, -7.701082684575685, -37.445731843861005, -34.92538534793716, -17.21589709779622, -30.689798012717958, -4.358077799483099, -23.24740631734283, -26.64470481033783, -5.623329481942953, -4.721554280482862, -29.680951651345566, -35.97257451231474, -8.997163683423173, -21.01200425327224, -24.329211127863736, -35.05225271140786, -49.15120516070791, -28.978163478782506, -24.81578015022726, -4.449542940526301, -21.224699686917752, -27.500569362821302, -37.865648361612365, -41.903122163187774, -21.11174205640634, -41.1409378326815, -23.913093270008353, -9.4064889637632, -22.113188512336098, -9.901582650929841, -44.14177788525348, -44.23817117079532, -41.37907852593628, -4.07567223318748, -18.66743093262021, -13.244110138423716, -38.78496242101215, -28.537757739781743, -48.24775444143001, -7.102521284597726, -13.028197593473456, -16.10037347258666, -8.870264811450532, -13.133456877586848, -16.131662220731286, -30.41425845422643, -29.202622854871603, -40.40085945238126, -29.15094869086658, -31.37914342473444, -33.6519415515574, -55.03586065724344, -24.31893279434584, -17.847667815437912, -33.89056905413275, -43.00505046019653, -16.474699229166887, -23.461244174929238, -45.066402721563, -26.610994266873767, -25.251216661114697, -41.69005614861404, -38.10907749161846, -28.679264107243945, -20.8333889921823, -48.022638321049115, -31.079549311670966, -1.0401270186724787, -17.544840176633294, -15.133086879084766, -29.335151497374152, -37.58344237969303, -31.43454986522219, -37.91920812384112, -23.383276464686876, -47.59967830972925], "policy_predator_policy_reward": [10.53113578429947, 36.51231653832298, 8.475922207237867, 19.204824939865382, 15.92707340003153, 23.192292749751175, 34.97693769386102, 19.663891449813168, 16.380180376949376, 25.164496432218613, 10.346431402510666, 17.314425371964102, 3.8948505132395126, 49.217052751153595, 47.06691549528933, 9.133809917789208, 10.187707947610514, 12.679337621056701, 19.944405488860454, 29.974980208549606, 39.522084424302584, 42.45456388085146, 32.957108555110416, 7.036229057392713, 7.701082684575685, 37.445731843861005, 34.92538534793716, 17.21589709779622, 30.689798012717958, 4.358077799483099, 23.24740631734283, 26.64470481033783, 5.623329481942953, 4.721554280482862, 29.680951651345566, 35.97257451231474, 8.997163683423173, 21.01200425327224, 24.329211127863736, 35.05225271140786, 49.15120516070791, 28.978163478782506, 24.81578015022726, 4.449542940526301, 21.224699686917752, 27.500569362821302, 37.865648361612365, 41.903122163187774, 21.11174205640634, 41.1409378326815, 23.913093270008353, 9.4064889637632, 22.113188512336098, 9.901582650929841, 44.14177788525348, 44.23817117079532, 41.37907852593628, 4.07567223318748, 18.66743093262021, 13.244110138423716, 38.78496242101215, 28.537757739781743, 48.24775444143001, 7.102521284597726, 13.028197593473456, 16.10037347258666, 8.870264811450532, 13.133456877586848, 16.131662220731286, 30.41425845422643, 29.202622854871603, 40.40085945238126, 29.15094869086658, 31.37914342473444, 33.6519415515574, 55.03586065724344, 24.31893279434584, 17.847667815437912, 33.89056905413275, 43.00505046019653, 16.474699229166887, 23.461244174929238, 45.066402721563, 26.610994266873767, 25.251216661114697, 41.69005614861404, 38.10907749161846, 28.679264107243945, 20.8333889921823, 48.022638321049115, 31.079549311670966, 1.0401270186724787, 17.544840176633294, 15.133086879084766, 29.335151497374152, 37.58344237969303, 31.43454986522219, 37.91920812384112, 23.383276464686876, 47.59967830972925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916188377318582, "mean_inference_ms": 0.9287506496925789, "mean_action_processing_ms": 0.12451568525380209, "mean_env_wait_ms": 0.06558400065029454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027643442153930664, "StateBufferConnector_ms": 0.001978635787963867, "ViewRequirementAgentConnector_ms": 0.0478205680847168}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 689.6076393912689, "num_env_steps_trained_throughput_per_sec": 689.6076393912689, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 5980.526, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5980.492, "sample_time_ms": 656.398, "learn_time_ms": 5310.261, "learn_throughput": 753.259, "synch_weights_time_ms": 13.386}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 162, "trial_id": "abfb9_00000", "date": "2024-08-11_11-46-59", "timestamp": 1723391219, "time_this_iter_s": 5.806518077850342, "time_total_s": 961.7613334655762, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16002f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 961.7613334655762, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 26.450000000000003, "ram_util_percent": 80.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.106608670515319, "cur_kl_coeff": 5.20417042793042e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2584329208359122, "policy_loss": -0.0009781873605485695, "vf_loss": 1.2594111091146867, "vf_explained_var": 0.9766825784618656, "kl": 0.0035524475549242153, "entropy": 0.28616050525257986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2072622081885735, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2723150617753467, "policy_loss": -0.006267197234653092, "vf_loss": 1.2785396565372744, "vf_explained_var": 0.9762511542687814, "kl": 0.01211731942828157, "entropy": 0.5870572895432512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.57, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 6657, "policy_reward_min": {"prey_policy": -56.11985170525901, "predator_policy": 1.0401270186724787}, "policy_reward_max": {"prey_policy": -1.0401270186724787, "predator_policy": 56.11985170525901}, "policy_reward_mean": {"prey_policy": -28.726842716165358, "predator_policy": 28.726842716165358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [46, 96, 72, 59, 88, 29, 78, 61, 29, 66, 46, 58, 41, 57, 74, 41, 76, 86, 68, 32, 62, 73, 68, 72, 82, 56, 103, 75, 65, 63, 76, 82, 66, 45, 62, 54, 69, 77, 76, 54, 63, 79, 73, 97, 76, 88, 20, 42, 60, 40, 70, 87, 69, 84, 49, 65, 61, 86, 73, 47, 57, 41, 43, 61, 93, 59, 67, 45, 71, 88, 68, 73, 89, 73, 93, 56, 78, 79, 79, 58, 82, 83, 129, 81, 59, 63, 61, 81, 72, 79, 97, 22, 56, 77, 25, 62, 75, 51, 51, 68], "policy_prey_policy_reward": [-18.66743093262021, -13.244110138423716, -38.78496242101215, -28.537757739781743, -48.24775444143001, -7.102521284597726, -13.028197593473456, -16.10037347258666, -8.870264811450532, -13.133456877586848, -16.131662220731286, -30.41425845422643, -29.202622854871603, -40.40085945238126, -29.15094869086658, -31.37914342473444, -33.6519415515574, -55.03586065724344, -24.31893279434584, -17.847667815437912, -33.89056905413275, -43.00505046019653, -16.474699229166887, -23.461244174929238, -45.066402721563, -26.610994266873767, -25.251216661114697, -41.69005614861404, -38.10907749161846, -28.679264107243945, -20.8333889921823, -48.022638321049115, -31.079549311670966, -1.0401270186724787, -17.544840176633294, -15.133086879084766, -29.335151497374152, -37.58344237969303, -31.43454986522219, -37.91920812384112, -23.383276464686876, -47.59967830972925, -25.86627107398582, -56.11985170525901, -50.68396921446602, -33.93503758478992, -4.615388107753823, -27.00272675067211, -10.844621929321768, -6.846384308492947, -23.13141217177992, -55.35614090788163, -23.66202902067844, -22.74897213015842, -30.65583934103717, -41.371086494444334, -25.99882457966884, -37.15498598099872, -41.495974996165444, -19.410350262974617, -35.0485963314045, -20.761976691355983, -20.745216862566792, -25.031628470610634, -50.934132651463386, -9.599735434454319, -36.08666973202379, -21.246843244122285, -21.06105266232593, -41.63203496420837, -46.13558147574361, -23.905797284812408, -27.804596103781915, -25.883982480108507, -12.148829065699932, -23.873914704576837, -43.93686289399599, -49.751767966553196, -32.58121650871409, -30.90203814944193, -37.43656762746053, -42.209684087389235, -52.77784382372626, -26.606293039228333, -32.11321798199291, -17.48456018671598, -23.731319945935798, -38.125344997493634, -37.354058802481376, -31.069392763315356, -15.381266837545121, -9.81877342894528, -24.594786075100465, -36.04709139771211, -12.213889910503642, -29.32404814841884, -38.06664903224723, -19.884194499553384, -14.376548193881806, -21.698161313742915], "policy_predator_policy_reward": [18.66743093262021, 13.244110138423716, 38.78496242101215, 28.537757739781743, 48.24775444143001, 7.102521284597726, 13.028197593473456, 16.10037347258666, 8.870264811450532, 13.133456877586848, 16.131662220731286, 30.41425845422643, 29.202622854871603, 40.40085945238126, 29.15094869086658, 31.37914342473444, 33.6519415515574, 55.03586065724344, 24.31893279434584, 17.847667815437912, 33.89056905413275, 43.00505046019653, 16.474699229166887, 23.461244174929238, 45.066402721563, 26.610994266873767, 25.251216661114697, 41.69005614861404, 38.10907749161846, 28.679264107243945, 20.8333889921823, 48.022638321049115, 31.079549311670966, 1.0401270186724787, 17.544840176633294, 15.133086879084766, 29.335151497374152, 37.58344237969303, 31.43454986522219, 37.91920812384112, 23.383276464686876, 47.59967830972925, 25.86627107398582, 56.11985170525901, 50.68396921446602, 33.93503758478992, 4.615388107753823, 27.00272675067211, 10.844621929321768, 6.846384308492947, 23.13141217177992, 55.35614090788163, 23.66202902067844, 22.74897213015842, 30.65583934103717, 41.371086494444334, 25.99882457966884, 37.15498598099872, 41.495974996165444, 19.410350262974617, 35.0485963314045, 20.761976691355983, 20.745216862566792, 25.031628470610634, 50.934132651463386, 9.599735434454319, 36.08666973202379, 21.246843244122285, 21.06105266232593, 41.63203496420837, 46.13558147574361, 23.905797284812408, 27.804596103781915, 25.883982480108507, 12.148829065699932, 23.873914704576837, 43.93686289399599, 49.751767966553196, 32.58121650871409, 30.90203814944193, 37.43656762746053, 42.209684087389235, 52.77784382372626, 26.606293039228333, 32.11321798199291, 17.48456018671598, 23.731319945935798, 38.125344997493634, 37.354058802481376, 31.069392763315356, 15.381266837545121, 9.81877342894528, 24.594786075100465, 36.04709139771211, 12.213889910503642, 29.32404814841884, 38.06664903224723, 19.884194499553384, 14.376548193881806, 21.698161313742915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2914378006384615, "mean_inference_ms": 0.9283761569904003, "mean_action_processing_ms": 0.12460418151763612, "mean_env_wait_ms": 0.06559866646969378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002600431442260742, "StateBufferConnector_ms": 0.0019642114639282227, "ViewRequirementAgentConnector_ms": 0.04764294624328613}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 642.3822721469512, "num_env_steps_trained_throughput_per_sec": 642.3822721469512, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1304000, "timers": {"training_iteration_time_ms": 6003.671, "restore_workers_time_ms": 0.011, "training_step_time_ms": 6003.638, "sample_time_ms": 657.419, "learn_time_ms": 5332.141, "learn_throughput": 750.168, "synch_weights_time_ms": 13.627}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "done": false, "training_iteration": 163, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-05", "timestamp": 1723391225, "time_this_iter_s": 6.234370946884155, "time_total_s": 967.9957044124603, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 967.9957044124603, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 36.15555555555555, "ram_util_percent": 80.97777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.258030744145314, "cur_kl_coeff": 2.60208521396521e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2711051149449, "policy_loss": -0.0038519672612892463, "vf_loss": 1.2749570860527455, "vf_explained_var": 0.9754165188719829, "kl": 0.004414149946976634, "entropy": 0.27472051087146004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3455638008192183, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2063159625977278, "policy_loss": -0.009521689719986171, "vf_loss": 1.2157810118049384, "vf_explained_var": 0.9779226194446285, "kl": 0.01611109944742403, "entropy": 0.5855680691078305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.79, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6679, "policy_reward_min": {"prey_policy": -57.02131441611938, "predator_policy": 3.86537831341124}, "policy_reward_max": {"prey_policy": -3.86537831341124, "predator_policy": 57.02131441611938}, "policy_reward_mean": {"prey_policy": -27.233511578558964, "predator_policy": 27.233511578558964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [43, 61, 93, 59, 67, 45, 71, 88, 68, 73, 89, 73, 93, 56, 78, 79, 79, 58, 82, 83, 129, 81, 59, 63, 61, 81, 72, 79, 97, 22, 56, 77, 25, 62, 75, 51, 51, 68, 55, 95, 91, 34, 75, 62, 47, 66, 63, 37, 34, 50, 79, 84, 71, 47, 60, 36, 40, 65, 44, 46, 46, 48, 82, 86, 63, 26, 69, 61, 79, 77, 48, 85, 83, 64, 38, 107, 77, 52, 91, 56, 56, 100, 57, 78, 83, 91, 73, 80, 33, 74, 59, 71, 83, 93, 96, 86, 43, 53, 32, 72], "policy_prey_policy_reward": [-20.745216862566792, -25.031628470610634, -50.934132651463386, -9.599735434454319, -36.08666973202379, -21.246843244122285, -21.06105266232593, -41.63203496420837, -46.13558147574361, -23.905797284812408, -27.804596103781915, -25.883982480108507, -12.148829065699932, -23.873914704576837, -43.93686289399599, -49.751767966553196, -32.58121650871409, -30.90203814944193, -37.43656762746053, -42.209684087389235, -52.77784382372626, -26.606293039228333, -32.11321798199291, -17.48456018671598, -23.731319945935798, -38.125344997493634, -37.354058802481376, -31.069392763315356, -15.381266837545121, -9.81877342894528, -24.594786075100465, -36.04709139771211, -12.213889910503642, -29.32404814841884, -38.06664903224723, -19.884194499553384, -14.376548193881806, -21.698161313742915, -17.408652374137223, -23.598382458082934, -35.38139491911798, -11.84515009791233, -9.675291201638215, -4.891646658707634, -14.10958272284021, -29.516991671325005, -36.510404915028566, -7.931138767404052, -18.06558417214936, -4.313426534582063, -25.182511533496825, -41.4701939520438, -40.334263381703174, -23.94541392070189, -22.278111229320253, -23.618288307568402, -17.97044913633004, -36.203038408525835, -36.32072429095788, -10.537304894942238, -12.438834077955477, -27.24897231676746, -32.89810368545531, -32.870900435718006, -29.377070234804968, -10.081518968952869, -31.545854617811784, -23.587417682734365, -32.57176439310631, -43.8182550690113, -29.145330501880323, -43.68831329394297, -22.452201898979332, -43.352036429940135, -8.358383748295475, -21.726895575118274, -21.15385361661371, -22.2954888859283, -37.95028534857972, -31.235920619513145, -19.413929146193297, -46.531238726893974, -17.294483888424793, -14.922865222415282, -37.45233812456143, -57.02131441611938, -39.32291909505133, -9.933041507314172, -18.39219449969567, -17.044067604051513, -26.910428150885707, -18.53288499990091, -38.071053368442094, -56.8242923235542, -37.955128057567116, -13.006476897336992, -3.86537831341124, -24.85747528750458, -22.008650972457048, -51.510057555896395], "policy_predator_policy_reward": [20.745216862566792, 25.031628470610634, 50.934132651463386, 9.599735434454319, 36.08666973202379, 21.246843244122285, 21.06105266232593, 41.63203496420837, 46.13558147574361, 23.905797284812408, 27.804596103781915, 25.883982480108507, 12.148829065699932, 23.873914704576837, 43.93686289399599, 49.751767966553196, 32.58121650871409, 30.90203814944193, 37.43656762746053, 42.209684087389235, 52.77784382372626, 26.606293039228333, 32.11321798199291, 17.48456018671598, 23.731319945935798, 38.125344997493634, 37.354058802481376, 31.069392763315356, 15.381266837545121, 9.81877342894528, 24.594786075100465, 36.04709139771211, 12.213889910503642, 29.32404814841884, 38.06664903224723, 19.884194499553384, 14.376548193881806, 21.698161313742915, 17.408652374137223, 23.598382458082934, 35.38139491911798, 11.84515009791233, 9.675291201638215, 4.891646658707634, 14.10958272284021, 29.516991671325005, 36.510404915028566, 7.931138767404052, 18.06558417214936, 4.313426534582063, 25.182511533496825, 41.4701939520438, 40.334263381703174, 23.94541392070189, 22.278111229320253, 23.618288307568402, 17.97044913633004, 36.203038408525835, 36.32072429095788, 10.537304894942238, 12.438834077955477, 27.24897231676746, 32.89810368545531, 32.870900435718006, 29.377070234804968, 10.081518968952869, 31.545854617811784, 23.587417682734365, 32.57176439310631, 43.8182550690113, 29.145330501880323, 43.68831329394297, 22.452201898979332, 43.352036429940135, 8.358383748295475, 21.726895575118274, 21.15385361661371, 22.2954888859283, 37.95028534857972, 31.235920619513145, 19.413929146193297, 46.531238726893974, 17.294483888424793, 14.922865222415282, 37.45233812456143, 57.02131441611938, 39.32291909505133, 9.933041507314172, 18.39219449969567, 17.044067604051513, 26.910428150885707, 18.53288499990091, 38.071053368442094, 56.8242923235542, 37.955128057567116, 13.006476897336992, 3.86537831341124, 24.85747528750458, 22.008650972457048, 51.510057555896395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29310427679803247, "mean_inference_ms": 0.9341000273788569, "mean_action_processing_ms": 0.12519927940695094, "mean_env_wait_ms": 0.06593208495763593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698587417602539, "StateBufferConnector_ms": 0.0027904510498046875, "ViewRequirementAgentConnector_ms": 0.07867586612701416}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.4953147498098, "num_env_steps_trained_throughput_per_sec": 551.4953147498098, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 6144.935, "restore_workers_time_ms": 0.012, "training_step_time_ms": 6144.849, "sample_time_ms": 764.253, "learn_time_ms": 5365.44, "learn_throughput": 745.512, "synch_weights_time_ms": 14.681}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 164, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-12", "timestamp": 1723391232, "time_this_iter_s": 7.274194955825806, "time_total_s": 975.2698993682861, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17de040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 975.2698993682861, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 48.61, "ram_util_percent": 82.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9075174966827033, "cur_kl_coeff": 1.301042606982605e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.272684110038487, "policy_loss": -0.0009675395219043518, "vf_loss": 1.2736516516034802, "vf_explained_var": 0.9732687318697572, "kl": 0.004317988640784291, "entropy": 0.2866779557894915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0338920566563803, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2559470747907957, "policy_loss": -0.005458562176985046, "vf_loss": 1.2613598690989116, "vf_explained_var": 0.973747381940484, "kl": 0.013018008014830372, "entropy": 0.5782150827969114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.45, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6645, "policy_reward_min": {"prey_policy": -57.02131441611938, "predator_policy": 0.16314934216192278}, "policy_reward_max": {"prey_policy": -0.16314934216192278, "predator_policy": 57.02131441611938}, "policy_reward_mean": {"prey_policy": -26.157527806406993, "predator_policy": 26.157527806406993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [86, 63, 26, 69, 61, 79, 77, 48, 85, 83, 64, 38, 107, 77, 52, 91, 56, 56, 100, 57, 78, 83, 91, 73, 80, 33, 74, 59, 71, 83, 93, 96, 86, 43, 53, 32, 72, 56, 56, 66, 20, 70, 29, 57, 82, 53, 90, 99, 91, 68, 65, 41, 139, 68, 47, 88, 60, 72, 105, 58, 66, 77, 68, 64, 57, 80, 75, 58, 51, 57, 42, 72, 28, 63, 82, 46, 117, 61, 46, 9, 71, 70, 53, 92, 96, 45, 36, 64, 77, 77, 114, 32, 91, 58, 55, 44, 42, 16, 47, 91], "policy_prey_policy_reward": [-32.870900435718006, -29.377070234804968, -10.081518968952869, -31.545854617811784, -23.587417682734365, -32.57176439310631, -43.8182550690113, -29.145330501880323, -43.68831329394297, -22.452201898979332, -43.352036429940135, -8.358383748295475, -21.726895575118274, -21.15385361661371, -22.2954888859283, -37.95028534857972, -31.235920619513145, -19.413929146193297, -46.531238726893974, -17.294483888424793, -14.922865222415282, -37.45233812456143, -57.02131441611938, -39.32291909505133, -9.933041507314172, -18.39219449969567, -17.044067604051513, -26.910428150885707, -18.53288499990091, -38.071053368442094, -56.8242923235542, -37.955128057567116, -13.006476897336992, -3.86537831341124, -24.85747528750458, -22.008650972457048, -51.510057555896395, -25.41603769123012, -29.59541153770382, -9.790733586741528, -12.097641110651804, -24.968402769081614, -5.67277308769245, -9.823856581067345, -45.88420731478618, -3.158986970169679, -26.26899771772378, -24.3433640725356, -37.43162762109255, -21.29519363855039, -20.520544678714124, -23.649133933278513, -50.857763905442106, -47.621881424601916, -23.839166741042934, -26.659398898786606, -28.411985412318565, -22.412295451231408, -28.49748625796363, -15.782249319542887, -37.482507372126626, -21.93020377697143, -22.20503353986341, -34.89500984341473, -40.172801508954066, -51.30061054265889, -30.004590674196674, -25.074228918177084, -27.099276693059387, -16.9147130993027, -6.782199632470351, -34.98003965059194, -15.99951546633033, -10.450343594602856, -45.93572851001033, -6.679969398631791, -19.787943137862996, -22.868124347510907, -20.51367289739956, -6.715401865400987, -24.27205260525439, -16.695787292987816, -23.24681432275102, -30.56499163861477, -35.888321912888365, -9.843984556996206, -1.9548061043876133, -28.260626496449607, -46.02981048022638, -27.063574841346593, -46.98173219602977, -0.16314934216192278, -48.74196562592379, -28.67180826358486, -31.905919852423725, -22.43465657711262, -6.19092164690909, -7.719631313479783, -28.12666943715192, -33.12279246392484], "policy_predator_policy_reward": [32.870900435718006, 29.377070234804968, 10.081518968952869, 31.545854617811784, 23.587417682734365, 32.57176439310631, 43.8182550690113, 29.145330501880323, 43.68831329394297, 22.452201898979332, 43.352036429940135, 8.358383748295475, 21.726895575118274, 21.15385361661371, 22.2954888859283, 37.95028534857972, 31.235920619513145, 19.413929146193297, 46.531238726893974, 17.294483888424793, 14.922865222415282, 37.45233812456143, 57.02131441611938, 39.32291909505133, 9.933041507314172, 18.39219449969567, 17.044067604051513, 26.910428150885707, 18.53288499990091, 38.071053368442094, 56.8242923235542, 37.955128057567116, 13.006476897336992, 3.86537831341124, 24.85747528750458, 22.008650972457048, 51.510057555896395, 25.41603769123012, 29.59541153770382, 9.790733586741528, 12.097641110651804, 24.968402769081614, 5.67277308769245, 9.823856581067345, 45.88420731478618, 3.158986970169679, 26.26899771772378, 24.3433640725356, 37.43162762109255, 21.29519363855039, 20.520544678714124, 23.649133933278513, 50.857763905442106, 47.621881424601916, 23.839166741042934, 26.659398898786606, 28.411985412318565, 22.412295451231408, 28.49748625796363, 15.782249319542887, 37.482507372126626, 21.93020377697143, 22.20503353986341, 34.89500984341473, 40.172801508954066, 51.30061054265889, 30.004590674196674, 25.074228918177084, 27.099276693059387, 16.9147130993027, 6.782199632470351, 34.98003965059194, 15.99951546633033, 10.450343594602856, 45.93572851001033, 6.679969398631791, 19.787943137862996, 22.868124347510907, 20.51367289739956, 6.715401865400987, 24.27205260525439, 16.695787292987816, 23.24681432275102, 30.56499163861477, 35.888321912888365, 9.843984556996206, 1.9548061043876133, 28.260626496449607, 46.02981048022638, 27.063574841346593, 46.98173219602977, 0.16314934216192278, 48.74196562592379, 28.67180826358486, 31.905919852423725, 22.43465657711262, 6.19092164690909, 7.719631313479783, 28.12666943715192, 33.12279246392484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940261807269993, "mean_inference_ms": 0.9378907178920602, "mean_action_processing_ms": 0.12569277336318035, "mean_env_wait_ms": 0.06618511392751339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415226936340332, "StateBufferConnector_ms": 0.002522587776184082, "ViewRequirementAgentConnector_ms": 0.06961846351623535}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 663.0850181669202, "num_env_steps_trained_throughput_per_sec": 663.0850181669202, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 6151.56, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6151.473, "sample_time_ms": 764.127, "learn_time_ms": 5372.024, "learn_throughput": 744.598, "synch_weights_time_ms": 14.806}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 165, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-18", "timestamp": 1723391238, "time_this_iter_s": 6.03805685043335, "time_total_s": 981.3079562187195, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 981.3079562187195, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 26.788888888888888, "ram_util_percent": 81.8777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.044393949583173, "cur_kl_coeff": 6.505213034913025e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4401041279857358, "policy_loss": -0.0015073330180409054, "vf_loss": 1.4416114636386435, "vf_explained_var": 0.9669180396944285, "kl": 0.003433067102208113, "entropy": 0.27638102173805235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.169593415533503, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4310453640917937, "policy_loss": -0.007493811402431068, "vf_loss": 1.4384914198269447, "vf_explained_var": 0.9666303082058827, "kl": 0.013583387299798725, "entropy": 0.5799861143653592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.48, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6148, "policy_reward_min": {"prey_policy": -60.18075803599423, "predator_policy": 0.16314934216192278}, "policy_reward_max": {"prey_policy": -0.16314934216192278, "predator_policy": 60.18075803599423}, "policy_reward_mean": {"prey_policy": -25.2980517333826, "predator_policy": 25.2980517333826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [64, 57, 80, 75, 58, 51, 57, 42, 72, 28, 63, 82, 46, 117, 61, 46, 9, 71, 70, 53, 92, 96, 45, 36, 64, 77, 77, 114, 32, 91, 58, 55, 44, 42, 16, 47, 91, 84, 28, 61, 49, 52, 80, 38, 42, 81, 89, 58, 35, 61, 91, 82, 49, 29, 48, 44, 81, 60, 78, 63, 74, 27, 111, 97, 57, 72, 94, 61, 67, 59, 59, 81, 74, 27, 70, 25, 46, 87, 77, 51, 52, 44, 71, 42, 60, 60, 79, 40, 54, 53, 52, 60, 94, 67, 36, 49, 71, 41, 62, 83], "policy_prey_policy_reward": [-34.89500984341473, -40.172801508954066, -51.30061054265889, -30.004590674196674, -25.074228918177084, -27.099276693059387, -16.9147130993027, -6.782199632470351, -34.98003965059194, -15.99951546633033, -10.450343594602856, -45.93572851001033, -6.679969398631791, -19.787943137862996, -22.868124347510907, -20.51367289739956, -6.715401865400987, -24.27205260525439, -16.695787292987816, -23.24681432275102, -30.56499163861477, -35.888321912888365, -9.843984556996206, -1.9548061043876133, -28.260626496449607, -46.02981048022638, -27.063574841346593, -46.98173219602977, -0.16314934216192278, -48.74196562592379, -28.67180826358486, -31.905919852423725, -22.43465657711262, -6.19092164690909, -7.719631313479783, -28.12666943715192, -33.12279246392484, -51.080309444553144, -11.6612444202597, -18.663367222547734, -16.685642806083127, -22.619479834634877, -33.10379777390534, -31.069940894745653, -9.885941343108268, -23.016748166839946, -22.69687381766065, -34.20826391477538, -16.154534004369957, -17.23470362497885, -21.913328483338915, -32.66818930778334, -4.186651400049315, -25.442003855728338, -25.666551562895506, -19.557024533138673, -34.985613887386016, -18.41452163685004, -47.62717195567828, -6.356900071085793, -30.187650439798325, -10.37738128910328, -38.87884177628079, -60.18075803599423, -23.112762265825, -36.44850065939853, -32.15644722791132, -39.402375098788276, -31.083807978053866, -35.857869320580946, -28.202720722819514, -23.00703231743249, -44.4736637981406, -14.265454403114239, -27.141577195923766, -7.031874624540761, -36.307924119187895, -38.35187952025612, -35.93725908079684, -15.88091580747741, -6.978345218480792, -22.727907455292428, -16.011101683820982, -17.265927601698948, -28.373364832030898, -31.429177910859845, -45.71769568346026, -10.288257609659091, -13.36596925554187, -27.581872123166416, -13.413389738905966, -13.858054436310368, -35.37021703981518, -41.66279625150449, -4.533779596136029, -17.286294018079516, -49.86824359983996, -13.19337101664887, -17.386780014361918, -36.25294185764437], "policy_predator_policy_reward": [34.89500984341473, 40.172801508954066, 51.30061054265889, 30.004590674196674, 25.074228918177084, 27.099276693059387, 16.9147130993027, 6.782199632470351, 34.98003965059194, 15.99951546633033, 10.450343594602856, 45.93572851001033, 6.679969398631791, 19.787943137862996, 22.868124347510907, 20.51367289739956, 6.715401865400987, 24.27205260525439, 16.695787292987816, 23.24681432275102, 30.56499163861477, 35.888321912888365, 9.843984556996206, 1.9548061043876133, 28.260626496449607, 46.02981048022638, 27.063574841346593, 46.98173219602977, 0.16314934216192278, 48.74196562592379, 28.67180826358486, 31.905919852423725, 22.43465657711262, 6.19092164690909, 7.719631313479783, 28.12666943715192, 33.12279246392484, 51.080309444553144, 11.6612444202597, 18.663367222547734, 16.685642806083127, 22.619479834634877, 33.10379777390534, 31.069940894745653, 9.885941343108268, 23.016748166839946, 22.69687381766065, 34.20826391477538, 16.154534004369957, 17.23470362497885, 21.913328483338915, 32.66818930778334, 4.186651400049315, 25.442003855728338, 25.666551562895506, 19.557024533138673, 34.985613887386016, 18.41452163685004, 47.62717195567828, 6.356900071085793, 30.187650439798325, 10.37738128910328, 38.87884177628079, 60.18075803599423, 23.112762265825, 36.44850065939853, 32.15644722791132, 39.402375098788276, 31.083807978053866, 35.857869320580946, 28.202720722819514, 23.00703231743249, 44.4736637981406, 14.265454403114239, 27.141577195923766, 7.031874624540761, 36.307924119187895, 38.35187952025612, 35.93725908079684, 15.88091580747741, 6.978345218480792, 22.727907455292428, 16.011101683820982, 17.265927601698948, 28.373364832030898, 31.429177910859845, 45.71769568346026, 10.288257609659091, 13.36596925554187, 27.581872123166416, 13.413389738905966, 13.858054436310368, 35.37021703981518, 41.66279625150449, 4.533779596136029, 17.286294018079516, 49.86824359983996, 13.19337101664887, 17.386780014361918, 36.25294185764437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29408203129234, "mean_inference_ms": 0.937515725388551, "mean_action_processing_ms": 0.1256499589580629, "mean_env_wait_ms": 0.06611817478103613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028423070907592773, "StateBufferConnector_ms": 0.0020465850830078125, "ViewRequirementAgentConnector_ms": 0.048049330711364746}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 626.4110963206765, "num_env_steps_trained_throughput_per_sec": 626.4110963206765, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 6191.203, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6191.115, "sample_time_ms": 770.736, "learn_time_ms": 5405.167, "learn_throughput": 740.033, "synch_weights_time_ms": 14.636}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 166, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-25", "timestamp": 1723391245, "time_this_iter_s": 6.39178991317749, "time_total_s": 987.699746131897, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17deee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 987.699746131897, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 33.62222222222222, "ram_util_percent": 82.0111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8467422869677343, "cur_kl_coeff": 3.2526065174565126e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1402742540774247, "policy_loss": -0.0004858412362712746, "vf_loss": 1.1407600953554113, "vf_explained_var": 0.9769487264876564, "kl": 0.005229119664413684, "entropy": 0.27573433915774026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.939219997636974, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0723861870045464, "policy_loss": -0.01620497746092345, "vf_loss": 1.088532423072805, "vf_explained_var": 0.9780807265390953, "kl": 0.016708175791675214, "entropy": 0.6020696757982175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.39, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6139, "policy_reward_min": {"prey_policy": -55.64492294299915, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 55.64492294299915}, "policy_reward_mean": {"prey_policy": -25.94271861992476, "predator_policy": 25.94271861992476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [57, 72, 94, 61, 67, 59, 59, 81, 74, 27, 70, 25, 46, 87, 77, 51, 52, 44, 71, 42, 60, 60, 79, 40, 54, 53, 52, 60, 94, 67, 36, 49, 71, 41, 62, 83, 91, 73, 64, 57, 83, 40, 87, 93, 42, 46, 47, 74, 75, 71, 21, 46, 58, 87, 1, 71, 85, 58, 37, 48, 82, 87, 66, 113, 82, 48, 68, 85, 68, 34, 76, 35, 63, 33, 77, 60, 56, 41, 56, 69, 21, 48, 77, 75, 64, 78, 66, 83, 69, 76, 62, 43, 70, 67, 65, 30, 67, 54, 59, 34], "policy_prey_policy_reward": [-23.112762265825, -36.44850065939853, -32.15644722791132, -39.402375098788276, -31.083807978053866, -35.857869320580946, -28.202720722819514, -23.00703231743249, -44.4736637981406, -14.265454403114239, -27.141577195923766, -7.031874624540761, -36.307924119187895, -38.35187952025612, -35.93725908079684, -15.88091580747741, -6.978345218480792, -22.727907455292428, -16.011101683820982, -17.265927601698948, -28.373364832030898, -31.429177910859845, -45.71769568346026, -10.288257609659091, -13.36596925554187, -27.581872123166416, -13.413389738905966, -13.858054436310368, -35.37021703981518, -41.66279625150449, -4.533779596136029, -17.286294018079516, -49.86824359983996, -13.19337101664887, -17.386780014361918, -36.25294185764437, -29.80465724860374, -34.711872595497304, -21.683709401914854, -6.287714177394084, -37.11663994459185, -17.763852228025907, -55.64492294299915, -47.80389580717166, -12.302845831862523, -16.003384598219938, -10.513261180153938, -26.38977474792706, -46.222000309382246, -35.759135472779825, -9.25574062283751, -31.52653076810935, -36.54115034850426, -44.99396485570553, 0.0, -12.287430677268448, -35.68318926758604, -41.22836237947219, -7.793467923958712, -9.659440023340444, -30.168105596389914, -24.647986303678376, -15.980945086312827, -38.57099861528859, -9.59084546018467, -26.319107799673002, -31.129753057923416, -9.9301318470094, -24.547125971775863, -7.6344785840255645, -40.1869498479766, -23.895580292963768, -43.229979788218536, -17.962118457528156, -48.01759989617252, -12.281769092892139, -18.383375651391084, -17.89364151558217, -27.933112753581305, -37.4064877937699, -14.976669820306146, -17.073517813399782, -20.139507915791057, -43.25839397484026, -20.26969263382362, -37.1687638767324, -44.50615955884185, -23.52635504562594, -34.54158186948679, -35.21116979417317, -6.333951679855437, -26.54483013231483, -19.28452771721408, -36.18797769349726, -30.374554588088884, -7.214396725010606, -33.7001104125189, -34.80804692998083, -24.974779493394923, -20.262286468429686], "policy_predator_policy_reward": [23.112762265825, 36.44850065939853, 32.15644722791132, 39.402375098788276, 31.083807978053866, 35.857869320580946, 28.202720722819514, 23.00703231743249, 44.4736637981406, 14.265454403114239, 27.141577195923766, 7.031874624540761, 36.307924119187895, 38.35187952025612, 35.93725908079684, 15.88091580747741, 6.978345218480792, 22.727907455292428, 16.011101683820982, 17.265927601698948, 28.373364832030898, 31.429177910859845, 45.71769568346026, 10.288257609659091, 13.36596925554187, 27.581872123166416, 13.413389738905966, 13.858054436310368, 35.37021703981518, 41.66279625150449, 4.533779596136029, 17.286294018079516, 49.86824359983996, 13.19337101664887, 17.386780014361918, 36.25294185764437, 29.80465724860374, 34.711872595497304, 21.683709401914854, 6.287714177394084, 37.11663994459185, 17.763852228025907, 55.64492294299915, 47.80389580717166, 12.302845831862523, 16.003384598219938, 10.513261180153938, 26.38977474792706, 46.222000309382246, 35.759135472779825, 9.25574062283751, 31.52653076810935, 36.54115034850426, 44.99396485570553, 0.0, 12.287430677268448, 35.68318926758604, 41.22836237947219, 7.793467923958712, 9.659440023340444, 30.168105596389914, 24.647986303678376, 15.980945086312827, 38.57099861528859, 9.59084546018467, 26.319107799673002, 31.129753057923416, 9.9301318470094, 24.547125971775863, 7.6344785840255645, 40.1869498479766, 23.895580292963768, 43.229979788218536, 17.962118457528156, 48.01759989617252, 12.281769092892139, 18.383375651391084, 17.89364151558217, 27.933112753581305, 37.4064877937699, 14.976669820306146, 17.073517813399782, 20.139507915791057, 43.25839397484026, 20.26969263382362, 37.1687638767324, 44.50615955884185, 23.52635504562594, 34.54158186948679, 35.21116979417317, 6.333951679855437, 26.54483013231483, 19.28452771721408, 36.18797769349726, 30.374554588088884, 7.214396725010606, 33.7001104125189, 34.80804692998083, 24.974779493394923, 20.262286468429686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940729529500154, "mean_inference_ms": 0.9373100011114462, "mean_action_processing_ms": 0.12557844914916985, "mean_env_wait_ms": 0.06611189246704663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002917170524597168, "StateBufferConnector_ms": 0.002119302749633789, "ViewRequirementAgentConnector_ms": 0.04668295383453369}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 643.8119994926933, "num_env_steps_trained_throughput_per_sec": 643.8119994926933, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 1336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1336000, "timers": {"training_iteration_time_ms": 6178.077, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6177.989, "sample_time_ms": 763.034, "learn_time_ms": 5399.878, "learn_throughput": 740.757, "synch_weights_time_ms": 14.502}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "done": false, "training_iteration": 167, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-31", "timestamp": 1723391251, "time_this_iter_s": 6.218217134475708, "time_total_s": 993.9179632663727, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 993.9179632663727, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 30.512500000000003, "ram_util_percent": 81.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2410269398242235, "cur_kl_coeff": 3.2526065174565126e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.166844576255729, "policy_loss": -0.003715381686924957, "vf_loss": 1.1705599568163356, "vf_explained_var": 0.9764446043098967, "kl": 0.005027630026503688, "entropy": 0.25986454494607947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3974463739742835, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2363127371296287, "policy_loss": -0.009672371338820086, "vf_loss": 1.2459543927883108, "vf_explained_var": 0.9736056274423996, "kl": 0.008737566951516037, "entropy": 0.5894370752076308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 58.43, "episode_media": {}, "episodes_this_iter": 68, "episodes_timesteps_total": 5843, "policy_reward_min": {"prey_policy": -53.72428435650591, "predator_policy": 0.6392993172589182}, "policy_reward_max": {"prey_policy": -0.6392993172589182, "predator_policy": 53.72428435650591}, "policy_reward_mean": {"prey_policy": -25.014886293444675, "predator_policy": 25.014886293444675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [68, 34, 76, 35, 63, 33, 77, 60, 56, 41, 56, 69, 21, 48, 77, 75, 64, 78, 66, 83, 69, 76, 62, 43, 70, 67, 65, 30, 67, 54, 59, 34, 31, 55, 10, 61, 39, 96, 32, 48, 57, 34, 77, 63, 71, 62, 44, 74, 70, 23, 71, 58, 46, 48, 68, 35, 46, 104, 62, 68, 83, 45, 78, 62, 53, 80, 70, 24, 53, 30, 75, 51, 45, 85, 50, 14, 47, 24, 60, 83, 60, 71, 62, 86, 79, 69, 65, 91, 74, 56, 73, 54, 62, 39, 62, 31, 36, 90, 54, 88], "policy_prey_policy_reward": [-24.547125971775863, -7.6344785840255645, -40.1869498479766, -23.895580292963768, -43.229979788218536, -17.962118457528156, -48.01759989617252, -12.281769092892139, -18.383375651391084, -17.89364151558217, -27.933112753581305, -37.4064877937699, -14.976669820306146, -17.073517813399782, -20.139507915791057, -43.25839397484026, -20.26969263382362, -37.1687638767324, -44.50615955884185, -23.52635504562594, -34.54158186948679, -35.21116979417317, -6.333951679855437, -26.54483013231483, -19.28452771721408, -36.18797769349726, -30.374554588088884, -7.214396725010606, -33.7001104125189, -34.80804692998083, -24.974779493394923, -20.262286468429686, -30.077988586324018, -23.839311151046246, -7.37923312254943, -38.143261826966196, -7.074504120572677, -53.72428435650591, -17.287433884038574, -23.139627915178302, -28.696651972950246, -12.797859020440335, -41.86987723448565, -31.765138188347816, -37.40655711509058, -31.052903423215863, -23.579177383854116, -26.162820908661867, -31.42778819431078, -4.9016445246614335, -19.624918491854157, -25.244129548213486, -34.761850140007105, -19.035359671846095, -32.39820962215527, -25.239287927006295, -21.85297955719713, -22.824311466635493, -14.725393254794355, -34.83769753172374, -17.364745827520377, -29.433707085623364, -36.48300885942536, -21.624218146072096, -7.466523114201651, -40.194118023781755, -33.49901440875502, -0.6392993172589182, -40.670915194110236, -13.81988025898209, -19.40417596553637, -22.54949217525986, -20.001559964134845, -25.140840955076015, -26.514405212738705, -3.8896364825228504, -24.00729086708399, -3.056787585864076, -39.31854221224105, -13.862928501378287, -37.66046785499919, -37.699489107580575, -17.965931700254316, -22.111742874384724, -31.263539949140544, -41.74221305544167, -27.852821953059212, -35.95174449094187, -45.36410635509777, -22.67814587608674, -45.970561064536035, -12.349697098687528, -38.53162407014292, -5.038689079259255, -13.121702673856507, -10.646978271063016, -6.499592252292534, -8.347491166419267, -8.645122751750472, -22.506183612069055], "policy_predator_policy_reward": [24.547125971775863, 7.6344785840255645, 40.1869498479766, 23.895580292963768, 43.229979788218536, 17.962118457528156, 48.01759989617252, 12.281769092892139, 18.383375651391084, 17.89364151558217, 27.933112753581305, 37.4064877937699, 14.976669820306146, 17.073517813399782, 20.139507915791057, 43.25839397484026, 20.26969263382362, 37.1687638767324, 44.50615955884185, 23.52635504562594, 34.54158186948679, 35.21116979417317, 6.333951679855437, 26.54483013231483, 19.28452771721408, 36.18797769349726, 30.374554588088884, 7.214396725010606, 33.7001104125189, 34.80804692998083, 24.974779493394923, 20.262286468429686, 30.077988586324018, 23.839311151046246, 7.37923312254943, 38.143261826966196, 7.074504120572677, 53.72428435650591, 17.287433884038574, 23.139627915178302, 28.696651972950246, 12.797859020440335, 41.86987723448565, 31.765138188347816, 37.40655711509058, 31.052903423215863, 23.579177383854116, 26.162820908661867, 31.42778819431078, 4.9016445246614335, 19.624918491854157, 25.244129548213486, 34.761850140007105, 19.035359671846095, 32.39820962215527, 25.239287927006295, 21.85297955719713, 22.824311466635493, 14.725393254794355, 34.83769753172374, 17.364745827520377, 29.433707085623364, 36.48300885942536, 21.624218146072096, 7.466523114201651, 40.194118023781755, 33.49901440875502, 0.6392993172589182, 40.670915194110236, 13.81988025898209, 19.40417596553637, 22.54949217525986, 20.001559964134845, 25.140840955076015, 26.514405212738705, 3.8896364825228504, 24.00729086708399, 3.056787585864076, 39.31854221224105, 13.862928501378287, 37.66046785499919, 37.699489107580575, 17.965931700254316, 22.111742874384724, 31.263539949140544, 41.74221305544167, 27.852821953059212, 35.95174449094187, 45.36410635509777, 22.67814587608674, 45.970561064536035, 12.349697098687528, 38.53162407014292, 5.038689079259255, 13.121702673856507, 10.646978271063016, 6.499592252292534, 8.347491166419267, 8.645122751750472, 22.506183612069055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940969672277216, "mean_inference_ms": 0.9368512347116564, "mean_action_processing_ms": 0.1256539187477193, "mean_env_wait_ms": 0.06610161474432036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026960372924804688, "StateBufferConnector_ms": 0.0020978450775146484, "ViewRequirementAgentConnector_ms": 0.04693949222564697}, "num_episodes": 68, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 664.1684037341325, "num_env_steps_trained_throughput_per_sec": 664.1684037341325, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 6176.166, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6176.08, "sample_time_ms": 763.591, "learn_time_ms": 5397.428, "learn_throughput": 741.094, "synch_weights_time_ms": 14.544}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 168, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-37", "timestamp": 1723391257, "time_this_iter_s": 6.0274577140808105, "time_total_s": 999.9454209804535, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 999.9454209804535, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 29.077777777777776, "ram_util_percent": 81.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.406192833557725, "cur_kl_coeff": 3.2526065174565126e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3538435904309154, "policy_loss": -0.002079190034904362, "vf_loss": 1.355922781676054, "vf_explained_var": 0.977124984562397, "kl": 0.004900296577842661, "entropy": 0.2920005503731469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4596837759017944, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.369849838068088, "policy_loss": -0.005301257953154466, "vf_loss": 1.3751199358453354, "vf_explained_var": 0.9764288700496156, "kl": 0.008863233170430966, "entropy": 0.5748230121408899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.61, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6261, "policy_reward_min": {"prey_policy": -64.29810283515025, "predator_policy": 0.6392993172589182}, "policy_reward_max": {"prey_policy": -0.6392993172589182, "predator_policy": 64.29810283515025}, "policy_reward_mean": {"prey_policy": -24.62870534413678, "predator_policy": 24.62870534413678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [53, 80, 70, 24, 53, 30, 75, 51, 45, 85, 50, 14, 47, 24, 60, 83, 60, 71, 62, 86, 79, 69, 65, 91, 74, 56, 73, 54, 62, 39, 62, 31, 36, 90, 54, 88, 82, 17, 77, 70, 93, 58, 29, 94, 51, 44, 51, 74, 68, 71, 78, 60, 12, 91, 70, 90, 87, 111, 71, 82, 63, 15, 93, 138, 46, 75, 53, 80, 95, 57, 75, 90, 101, 31, 68, 43, 65, 15, 83, 58, 78, 22, 70, 85, 20, 72, 69, 45, 86, 41, 77, 54, 56, 56, 52, 74, 28, 42, 70, 43], "policy_prey_policy_reward": [-7.466523114201651, -40.194118023781755, -33.49901440875502, -0.6392993172589182, -40.670915194110236, -13.81988025898209, -19.40417596553637, -22.54949217525986, -20.001559964134845, -25.140840955076015, -26.514405212738705, -3.8896364825228504, -24.00729086708399, -3.056787585864076, -39.31854221224105, -13.862928501378287, -37.66046785499919, -37.699489107580575, -17.965931700254316, -22.111742874384724, -31.263539949140544, -41.74221305544167, -27.852821953059212, -35.95174449094187, -45.36410635509777, -22.67814587608674, -45.970561064536035, -12.349697098687528, -38.53162407014292, -5.038689079259255, -13.121702673856507, -10.646978271063016, -6.499592252292534, -8.347491166419267, -8.645122751750472, -22.506183612069055, -29.95022368899004, -5.356515721375363, -8.102938512118714, -35.006751982285415, -46.25233521960675, -7.706569881927557, -4.001162613806531, -16.7155269460074, -28.329825820897724, -21.80758649643152, -29.1442530472969, -40.510875070813604, -31.84382281954962, -28.51278881928115, -45.238070473856766, -32.46761396701138, -5.134977527398203, -43.314215519404804, -14.046966230696123, -22.525978785952997, -42.909656248852464, -32.57964213781619, -15.718547037136371, -36.99264325081497, -12.25686831399041, -5.005899201054723, -46.54566415210308, -51.858658249961145, -10.109795026787436, -39.57525630945748, -22.580855625405054, -31.089504084397113, -9.663431588371173, -16.86870379853561, -32.472679720326184, -19.447569778095033, -64.29810283515025, -8.171404123928628, -37.45499948155192, -15.042425887019219, -18.77518614421991, -7.587117883675138, -38.9365237576567, -16.54026498419403, -22.36099996026242, -17.978928691517886, -35.975525095219396, -38.50919918485191, -12.73822936409927, -25.020525010433104, -44.17201766782293, -33.00245971803743, -31.000488118204952, -23.854850915325315, -23.298294395962944, -19.749625763710995, -6.440501716208134, -34.005430125772, -40.1047595040429, -34.44711821116784, -21.97751006063451, -13.262349185568864, -14.340570435075739, -16.197497028561905], "policy_predator_policy_reward": [7.466523114201651, 40.194118023781755, 33.49901440875502, 0.6392993172589182, 40.670915194110236, 13.81988025898209, 19.40417596553637, 22.54949217525986, 20.001559964134845, 25.140840955076015, 26.514405212738705, 3.8896364825228504, 24.00729086708399, 3.056787585864076, 39.31854221224105, 13.862928501378287, 37.66046785499919, 37.699489107580575, 17.965931700254316, 22.111742874384724, 31.263539949140544, 41.74221305544167, 27.852821953059212, 35.95174449094187, 45.36410635509777, 22.67814587608674, 45.970561064536035, 12.349697098687528, 38.53162407014292, 5.038689079259255, 13.121702673856507, 10.646978271063016, 6.499592252292534, 8.347491166419267, 8.645122751750472, 22.506183612069055, 29.95022368899004, 5.356515721375363, 8.102938512118714, 35.006751982285415, 46.25233521960675, 7.706569881927557, 4.001162613806531, 16.7155269460074, 28.329825820897724, 21.80758649643152, 29.1442530472969, 40.510875070813604, 31.84382281954962, 28.51278881928115, 45.238070473856766, 32.46761396701138, 5.134977527398203, 43.314215519404804, 14.046966230696123, 22.525978785952997, 42.909656248852464, 32.57964213781619, 15.718547037136371, 36.99264325081497, 12.25686831399041, 5.005899201054723, 46.54566415210308, 51.858658249961145, 10.109795026787436, 39.57525630945748, 22.580855625405054, 31.089504084397113, 9.663431588371173, 16.86870379853561, 32.472679720326184, 19.447569778095033, 64.29810283515025, 8.171404123928628, 37.45499948155192, 15.042425887019219, 18.77518614421991, 7.587117883675138, 38.9365237576567, 16.54026498419403, 22.36099996026242, 17.978928691517886, 35.975525095219396, 38.50919918485191, 12.73822936409927, 25.020525010433104, 44.17201766782293, 33.00245971803743, 31.000488118204952, 23.854850915325315, 23.298294395962944, 19.749625763710995, 6.440501716208134, 34.005430125772, 40.1047595040429, 34.44711821116784, 21.97751006063451, 13.262349185568864, 14.340570435075739, 16.197497028561905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29401069624894016, "mean_inference_ms": 0.9368360279186758, "mean_action_processing_ms": 0.12556733386552696, "mean_env_wait_ms": 0.06611869463379232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002547025680541992, "StateBufferConnector_ms": 0.0018951892852783203, "ViewRequirementAgentConnector_ms": 0.04639911651611328}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 601.7674381902374, "num_env_steps_trained_throughput_per_sec": 601.7674381902374, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 1352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1352000, "timers": {"training_iteration_time_ms": 6246.342, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6246.116, "sample_time_ms": 760.878, "learn_time_ms": 5467.551, "learn_throughput": 731.589, "synch_weights_time_ms": 16.953}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "done": false, "training_iteration": 169, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-44", "timestamp": 1723391264, "time_this_iter_s": 6.686934947967529, "time_total_s": 1006.632355928421, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x160294820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1006.632355928421, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 32.266666666666666, "ram_util_percent": 82.28888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8350315585111576, "cur_kl_coeff": 1.6263032587282563e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1269297648376475, "policy_loss": -0.0040599570056656376, "vf_loss": 1.130989720672369, "vf_explained_var": 0.9723186394199729, "kl": 0.0056451051454864025, "entropy": 0.27265211795456706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.023006501297156, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1056294307112693, "policy_loss": -0.004412031467169678, "vf_loss": 1.1100155079116425, "vf_explained_var": 0.9735182193418344, "kl": 0.007382670389401496, "entropy": 0.5879592591896653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.56, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6156, "policy_reward_min": {"prey_policy": -64.29810283515025, "predator_policy": 4.083268714051197}, "policy_reward_max": {"prey_policy": -4.083268714051197, "predator_policy": 64.29810283515025}, "policy_reward_mean": {"prey_policy": -24.92505703542611, "predator_policy": 24.92505703542611}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [75, 53, 80, 95, 57, 75, 90, 101, 31, 68, 43, 65, 15, 83, 58, 78, 22, 70, 85, 20, 72, 69, 45, 86, 41, 77, 54, 56, 56, 52, 74, 28, 42, 70, 43, 80, 43, 57, 56, 62, 48, 35, 75, 77, 69, 56, 101, 86, 41, 80, 112, 76, 89, 61, 94, 38, 76, 78, 52, 27, 82, 42, 55, 51, 70, 34, 23, 56, 61, 76, 48, 39, 95, 34, 84, 26, 39, 77, 45, 40, 85, 23, 79, 38, 85, 52, 56, 51, 74, 68, 51, 59, 86, 68, 46, 78, 88, 87, 60, 47], "policy_prey_policy_reward": [-39.57525630945748, -22.580855625405054, -31.089504084397113, -9.663431588371173, -16.86870379853561, -32.472679720326184, -19.447569778095033, -64.29810283515025, -8.171404123928628, -37.45499948155192, -15.042425887019219, -18.77518614421991, -7.587117883675138, -38.9365237576567, -16.54026498419403, -22.36099996026242, -17.978928691517886, -35.975525095219396, -38.50919918485191, -12.73822936409927, -25.020525010433104, -44.17201766782293, -33.00245971803743, -31.000488118204952, -23.854850915325315, -23.298294395962944, -19.749625763710995, -6.440501716208134, -34.005430125772, -40.1047595040429, -34.44711821116784, -21.97751006063451, -13.262349185568864, -14.340570435075739, -16.197497028561905, -25.07411747193987, -17.0243284425261, -23.336781667781665, -4.083268714051197, -31.177029253112956, -24.169954661866896, -11.349886659797033, -28.181009610128317, -39.31939829901562, -18.829321692141257, -35.323773385116844, -31.13929800067209, -24.050833890986166, -30.026560794575445, -41.173450702327784, -40.848305748340664, -27.91803879291508, -18.534097213030115, -17.264227628329593, -58.61472801298072, -10.62131589673928, -45.34410013445871, -36.33968630750623, -21.53616327136669, -12.623892089788088, -19.095532144825327, -14.089186517539494, -40.89761776310713, -34.116061108522594, -43.64350247873499, -13.571900975159883, -4.488481749877085, -19.661498480562624, -25.9799243365057, -36.61478693999976, -29.799959189143312, -8.78596369085584, -36.776391973875775, -9.546654969495425, -8.927625014855714, -7.134997694819717, -19.930790136676606, -54.963340013899334, -11.878799250324118, -21.770021247133105, -50.24795388830252, -14.006358807104265, -26.92057222698421, -6.906897809418936, -38.81824229195996, -11.657711000929199, -41.301847550110985, -25.058839026960054, -40.74834390565786, -11.505773867746736, -13.537551301559743, -17.49468184107185, -36.82624725480311, -20.83889055217257, -23.414591434199707, -23.070279457385237, -11.72426550115668, -25.59107966389471, -21.666637448499646, -8.651428540820982], "policy_predator_policy_reward": [39.57525630945748, 22.580855625405054, 31.089504084397113, 9.663431588371173, 16.86870379853561, 32.472679720326184, 19.447569778095033, 64.29810283515025, 8.171404123928628, 37.45499948155192, 15.042425887019219, 18.77518614421991, 7.587117883675138, 38.9365237576567, 16.54026498419403, 22.36099996026242, 17.978928691517886, 35.975525095219396, 38.50919918485191, 12.73822936409927, 25.020525010433104, 44.17201766782293, 33.00245971803743, 31.000488118204952, 23.854850915325315, 23.298294395962944, 19.749625763710995, 6.440501716208134, 34.005430125772, 40.1047595040429, 34.44711821116784, 21.97751006063451, 13.262349185568864, 14.340570435075739, 16.197497028561905, 25.07411747193987, 17.0243284425261, 23.336781667781665, 4.083268714051197, 31.177029253112956, 24.169954661866896, 11.349886659797033, 28.181009610128317, 39.31939829901562, 18.829321692141257, 35.323773385116844, 31.13929800067209, 24.050833890986166, 30.026560794575445, 41.173450702327784, 40.848305748340664, 27.91803879291508, 18.534097213030115, 17.264227628329593, 58.61472801298072, 10.62131589673928, 45.34410013445871, 36.33968630750623, 21.53616327136669, 12.623892089788088, 19.095532144825327, 14.089186517539494, 40.89761776310713, 34.116061108522594, 43.64350247873499, 13.571900975159883, 4.488481749877085, 19.661498480562624, 25.9799243365057, 36.61478693999976, 29.799959189143312, 8.78596369085584, 36.776391973875775, 9.546654969495425, 8.927625014855714, 7.134997694819717, 19.930790136676606, 54.963340013899334, 11.878799250324118, 21.770021247133105, 50.24795388830252, 14.006358807104265, 26.92057222698421, 6.906897809418936, 38.81824229195996, 11.657711000929199, 41.301847550110985, 25.058839026960054, 40.74834390565786, 11.505773867746736, 13.537551301559743, 17.49468184107185, 36.82624725480311, 20.83889055217257, 23.414591434199707, 23.070279457385237, 11.72426550115668, 25.59107966389471, 21.666637448499646, 8.651428540820982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29413465079773116, "mean_inference_ms": 0.93770288861675, "mean_action_processing_ms": 0.125706810753389, "mean_env_wait_ms": 0.06613419919032491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034404993057250977, "StateBufferConnector_ms": 0.002095937728881836, "ViewRequirementAgentConnector_ms": 0.05159497261047363}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 623.5719115933077, "num_env_steps_trained_throughput_per_sec": 623.5719115933077, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 6294.406, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6294.177, "sample_time_ms": 778.192, "learn_time_ms": 5498.424, "learn_throughput": 727.481, "synch_weights_time_ms": 16.786}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 170, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-50", "timestamp": 1723391270, "time_this_iter_s": 6.420594930648804, "time_total_s": 1013.0529508590698, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602f45e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1013.0529508590698, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 33.73, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.214103978375594, "cur_kl_coeff": 1.6263032587282563e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3325988144303362, "policy_loss": -0.0012781666293449235, "vf_loss": 1.3338769839455684, "vf_explained_var": 0.9729384956881404, "kl": 0.004123411877222339, "entropy": 0.2570839460163067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.34279237339894, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3428628845140338, "policy_loss": -0.006530932553869206, "vf_loss": 1.3493543068567913, "vf_explained_var": 0.9724991872906685, "kl": 0.011238689606910693, "entropy": 0.5774868123233319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.49, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6149, "policy_reward_min": {"prey_policy": -54.963340013899334, "predator_policy": 2.3093860670392723}, "policy_reward_max": {"prey_policy": -2.3093860670392723, "predator_policy": 54.963340013899334}, "policy_reward_mean": {"prey_policy": -24.290214748379693, "predator_policy": 24.290214748379693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [51, 70, 34, 23, 56, 61, 76, 48, 39, 95, 34, 84, 26, 39, 77, 45, 40, 85, 23, 79, 38, 85, 52, 56, 51, 74, 68, 51, 59, 86, 68, 46, 78, 88, 87, 60, 47, 47, 80, 69, 75, 48, 83, 56, 83, 78, 31, 67, 63, 82, 50, 69, 82, 58, 67, 36, 71, 73, 62, 72, 70, 45, 53, 48, 79, 61, 71, 25, 44, 77, 15, 91, 67, 77, 72, 43, 35, 77, 80, 50, 84, 62, 2, 49, 53, 84, 83, 63, 73, 81, 81, 55, 62, 76, 83, 38, 60, 59, 47, 93], "policy_prey_policy_reward": [-34.116061108522594, -43.64350247873499, -13.571900975159883, -4.488481749877085, -19.661498480562624, -25.9799243365057, -36.61478693999976, -29.799959189143312, -8.78596369085584, -36.776391973875775, -9.546654969495425, -8.927625014855714, -7.134997694819717, -19.930790136676606, -54.963340013899334, -11.878799250324118, -21.770021247133105, -50.24795388830252, -14.006358807104265, -26.92057222698421, -6.906897809418936, -38.81824229195996, -11.657711000929199, -41.301847550110985, -25.058839026960054, -40.74834390565786, -11.505773867746736, -13.537551301559743, -17.49468184107185, -36.82624725480311, -20.83889055217257, -23.414591434199707, -23.070279457385237, -11.72426550115668, -25.59107966389471, -21.666637448499646, -8.651428540820982, -18.809285423570692, -42.53983518700916, -30.658644977788242, -43.8992723830516, -43.65387373321811, -5.602380716482868, -43.16965374540706, -33.569884733480656, -48.10006278599549, -24.176097977675703, -19.96373531711265, -37.45939923089489, -13.087287886585624, -24.374594297449647, -18.175680107736575, -25.15674403596174, -11.961247913569922, -9.533564836287375, -25.21182262569158, -20.260253760277948, -24.081636668697854, -23.10065252795816, -32.24907832325018, -19.32720914523984, -29.546354405673473, -19.212941348854613, -12.351052338916926, -29.820961840087797, -27.560483203593645, -21.82374628952887, -10.178011918693093, -10.337424213209676, -37.25820490620254, -7.814147059876215, -25.94245833731064, -33.980778504792106, -36.22902816931552, -29.867385543552324, -29.10717166246935, -16.136440293777238, -29.236507881210542, -35.93637556271041, -11.288327849228716, -23.5675618245386, -10.581745536908315, -2.3093860670392723, -31.115508133749003, -37.82563290434089, -43.40512337733583, -28.305113695310627, -34.247146704830705, -23.328103792983303, -40.047611074487385, -12.125233735759574, -25.172842227949833, -19.63811122624068, -42.034397453662805, -10.559108090699855, -11.185168267328095, -26.433666512360624, -29.760109465934725, -16.687187699302036, -11.36412475662928], "policy_predator_policy_reward": [34.116061108522594, 43.64350247873499, 13.571900975159883, 4.488481749877085, 19.661498480562624, 25.9799243365057, 36.61478693999976, 29.799959189143312, 8.78596369085584, 36.776391973875775, 9.546654969495425, 8.927625014855714, 7.134997694819717, 19.930790136676606, 54.963340013899334, 11.878799250324118, 21.770021247133105, 50.24795388830252, 14.006358807104265, 26.92057222698421, 6.906897809418936, 38.81824229195996, 11.657711000929199, 41.301847550110985, 25.058839026960054, 40.74834390565786, 11.505773867746736, 13.537551301559743, 17.49468184107185, 36.82624725480311, 20.83889055217257, 23.414591434199707, 23.070279457385237, 11.72426550115668, 25.59107966389471, 21.666637448499646, 8.651428540820982, 18.809285423570692, 42.53983518700916, 30.658644977788242, 43.8992723830516, 43.65387373321811, 5.602380716482868, 43.16965374540706, 33.569884733480656, 48.10006278599549, 24.176097977675703, 19.96373531711265, 37.45939923089489, 13.087287886585624, 24.374594297449647, 18.175680107736575, 25.15674403596174, 11.961247913569922, 9.533564836287375, 25.21182262569158, 20.260253760277948, 24.081636668697854, 23.10065252795816, 32.24907832325018, 19.32720914523984, 29.546354405673473, 19.212941348854613, 12.351052338916926, 29.820961840087797, 27.560483203593645, 21.82374628952887, 10.178011918693093, 10.337424213209676, 37.25820490620254, 7.814147059876215, 25.94245833731064, 33.980778504792106, 36.22902816931552, 29.867385543552324, 29.10717166246935, 16.136440293777238, 29.236507881210542, 35.93637556271041, 11.288327849228716, 23.5675618245386, 10.581745536908315, 2.3093860670392723, 31.115508133749003, 37.82563290434089, 43.40512337733583, 28.305113695310627, 34.247146704830705, 23.328103792983303, 40.047611074487385, 12.125233735759574, 25.172842227949833, 19.63811122624068, 42.034397453662805, 10.559108090699855, 11.185168267328095, 26.433666512360624, 29.760109465934725, 16.687187699302036, 11.36412475662928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2941753326556727, "mean_inference_ms": 0.9378925325007816, "mean_action_processing_ms": 0.12576181166579342, "mean_env_wait_ms": 0.06613387762082015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034351348876953125, "StateBufferConnector_ms": 0.002052783966064453, "ViewRequirementAgentConnector_ms": 0.05124080181121826}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 669.0296610762582, "num_env_steps_trained_throughput_per_sec": 669.0296610762582, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 6297.456, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6297.227, "sample_time_ms": 780.446, "learn_time_ms": 5499.294, "learn_throughput": 727.366, "synch_weights_time_ms": 16.712}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 171, "trial_id": "abfb9_00000", "date": "2024-08-11_11-47-56", "timestamp": 1723391276, "time_this_iter_s": 5.984097242355347, "time_total_s": 1019.0370481014252, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1019.0370481014252, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 82.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.345396994923552, "cur_kl_coeff": 8.131516293641281e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2013438447068134, "policy_loss": -0.001390379887986152, "vf_loss": 1.2027342235669494, "vf_explained_var": 0.98153954676042, "kl": 0.004914822854069219, "entropy": 0.26836807813184954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3195963067313037, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.195099304864804, "policy_loss": -0.006819796415220481, "vf_loss": 1.201885420208176, "vf_explained_var": 0.9814775750041008, "kl": 0.009581373184321559, "entropy": 0.5579931962614259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.93, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6193, "policy_reward_min": {"prey_policy": -56.82009961907239, "predator_policy": 2.1852972160982556}, "policy_reward_max": {"prey_policy": -2.1852972160982556, "predator_policy": 56.82009961907239}, "policy_reward_mean": {"prey_policy": -24.647558154686077, "predator_policy": 24.647558154686077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [61, 71, 25, 44, 77, 15, 91, 67, 77, 72, 43, 35, 77, 80, 50, 84, 62, 2, 49, 53, 84, 83, 63, 73, 81, 81, 55, 62, 76, 83, 38, 60, 59, 47, 93, 62, 45, 74, 68, 53, 45, 53, 94, 51, 88, 48, 71, 61, 52, 54, 74, 51, 65, 56, 88, 73, 92, 67, 73, 72, 36, 16, 3, 110, 90, 78, 69, 79, 76, 69, 64, 85, 90, 62, 70, 19, 80, 31, 47, 79, 43, 83, 67, 52, 26, 62, 23, 22, 83, 77, 55, 85, 24, 77, 35, 40, 97, 67, 85, 34], "policy_prey_policy_reward": [-27.560483203593645, -21.82374628952887, -10.178011918693093, -10.337424213209676, -37.25820490620254, -7.814147059876215, -25.94245833731064, -33.980778504792106, -36.22902816931552, -29.867385543552324, -29.10717166246935, -16.136440293777238, -29.236507881210542, -35.93637556271041, -11.288327849228716, -23.5675618245386, -10.581745536908315, -2.3093860670392723, -31.115508133749003, -37.82563290434089, -43.40512337733583, -28.305113695310627, -34.247146704830705, -23.328103792983303, -40.047611074487385, -12.125233735759574, -25.172842227949833, -19.63811122624068, -42.034397453662805, -10.559108090699855, -11.185168267328095, -26.433666512360624, -29.760109465934725, -16.687187699302036, -11.36412475662928, -16.697110381457804, -20.437306204118745, -18.887973518106957, -19.839918792582314, -16.213783805673945, -22.278396803938413, -19.04684408434755, -50.430389162061616, -21.192365534778542, -26.979223311063986, -30.6385802086704, -24.272235357703476, -22.544228936985746, -13.059674775191509, -12.592064016004407, -43.31817198224043, -21.151121324717444, -28.362785904958777, -36.417368730015866, -46.51784708631022, -15.570246148424832, -23.496395767505767, -15.794551668532327, -49.187936054714434, -9.7033274278914, -14.620052434763835, -6.852184865773637, -2.1852972160982556, -18.145816476962526, -42.2415426018157, -41.967258629266254, -8.28994769552466, -55.437709577462975, -28.877551896950663, -29.788472149304543, -4.363946056127852, -46.58128739138865, -39.44755914336405, -39.54856801606676, -11.495189905414753, -10.861867587437771, -42.97009812300956, -10.298103125947106, -31.923598736362266, -52.9295960094791, -11.035808093192296, -10.181181154543893, -21.376040500729005, -37.9015434704214, -25.449437288997267, -30.186578402181567, -6.3199028339146945, -3.7370607960217312, -40.33091853682254, -20.14942634537383, -14.672078595600148, -33.79994812591728, -6.142227615060627, -35.385143588780615, -9.301745230489825, -15.615811047537612, -56.82009961907239, -24.952835758694093, -35.744025784916246, -19.809134110960464], "policy_predator_policy_reward": [27.560483203593645, 21.82374628952887, 10.178011918693093, 10.337424213209676, 37.25820490620254, 7.814147059876215, 25.94245833731064, 33.980778504792106, 36.22902816931552, 29.867385543552324, 29.10717166246935, 16.136440293777238, 29.236507881210542, 35.93637556271041, 11.288327849228716, 23.5675618245386, 10.581745536908315, 2.3093860670392723, 31.115508133749003, 37.82563290434089, 43.40512337733583, 28.305113695310627, 34.247146704830705, 23.328103792983303, 40.047611074487385, 12.125233735759574, 25.172842227949833, 19.63811122624068, 42.034397453662805, 10.559108090699855, 11.185168267328095, 26.433666512360624, 29.760109465934725, 16.687187699302036, 11.36412475662928, 16.697110381457804, 20.437306204118745, 18.887973518106957, 19.839918792582314, 16.213783805673945, 22.278396803938413, 19.04684408434755, 50.430389162061616, 21.192365534778542, 26.979223311063986, 30.6385802086704, 24.272235357703476, 22.544228936985746, 13.059674775191509, 12.592064016004407, 43.31817198224043, 21.151121324717444, 28.362785904958777, 36.417368730015866, 46.51784708631022, 15.570246148424832, 23.496395767505767, 15.794551668532327, 49.187936054714434, 9.7033274278914, 14.620052434763835, 6.852184865773637, 2.1852972160982556, 18.145816476962526, 42.2415426018157, 41.967258629266254, 8.28994769552466, 55.437709577462975, 28.877551896950663, 29.788472149304543, 4.363946056127852, 46.58128739138865, 39.44755914336405, 39.54856801606676, 11.495189905414753, 10.861867587437771, 42.97009812300956, 10.298103125947106, 31.923598736362266, 52.9295960094791, 11.035808093192296, 10.181181154543893, 21.376040500729005, 37.9015434704214, 25.449437288997267, 30.186578402181567, 6.3199028339146945, 3.7370607960217312, 40.33091853682254, 20.14942634537383, 14.672078595600148, 33.79994812591728, 6.142227615060627, 35.385143588780615, 9.301745230489825, 15.615811047537612, 56.82009961907239, 24.952835758694093, 35.744025784916246, 19.809134110960464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29415038776625396, "mean_inference_ms": 0.9376542656745247, "mean_action_processing_ms": 0.12574372219647958, "mean_env_wait_ms": 0.06614646407200629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027810335159301758, "StateBufferConnector_ms": 0.001985907554626465, "ViewRequirementAgentConnector_ms": 0.04848611354827881}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 662.086122574135, "num_env_steps_trained_throughput_per_sec": 662.086122574135, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 6321.567, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6321.338, "sample_time_ms": 785.783, "learn_time_ms": 5517.968, "learn_throughput": 724.905, "synch_weights_time_ms": 16.817}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 172, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-02", "timestamp": 1723391282, "time_this_iter_s": 6.0473949909210205, "time_total_s": 1025.0844430923462, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x160294dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1025.0844430923462, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 26.98888888888889, "ram_util_percent": 81.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.050673121338089, "cur_kl_coeff": 4.065758146820641e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.484852206489692, "policy_loss": -0.0007290428315172903, "vf_loss": 1.4855812506750226, "vf_explained_var": 0.962466425076127, "kl": 0.001932577737101345, "entropy": 0.27081463335392375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1403596363961697, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5077908076966802, "policy_loss": -0.004876288463128731, "vf_loss": 1.512628529344996, "vf_explained_var": 0.9632424416641394, "kl": 0.010969360402675007, "entropy": 0.5552858526508013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.84, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6184, "policy_reward_min": {"prey_policy": -56.82009961907239, "predator_policy": 3.7370607960217312}, "policy_reward_max": {"prey_policy": -3.7370607960217312, "predator_policy": 56.82009961907239}, "policy_reward_mean": {"prey_policy": -24.860918227130924, "predator_policy": 24.860918227130924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [78, 69, 79, 76, 69, 64, 85, 90, 62, 70, 19, 80, 31, 47, 79, 43, 83, 67, 52, 26, 62, 23, 22, 83, 77, 55, 85, 24, 77, 35, 40, 97, 67, 85, 34, 70, 11, 66, 61, 76, 61, 57, 63, 19, 81, 36, 72, 90, 88, 75, 60, 83, 50, 42, 88, 13, 76, 68, 48, 51, 31, 37, 56, 96, 44, 66, 64, 86, 60, 43, 104, 39, 31, 73, 46, 55, 80, 58, 47, 67, 36, 86, 69, 39, 67, 87, 64, 90, 83, 51, 73, 78, 41, 76, 81, 79, 85, 32, 65, 79], "policy_prey_policy_reward": [-41.967258629266254, -8.28994769552466, -55.437709577462975, -28.877551896950663, -29.788472149304543, -4.363946056127852, -46.58128739138865, -39.44755914336405, -39.54856801606676, -11.495189905414753, -10.861867587437771, -42.97009812300956, -10.298103125947106, -31.923598736362266, -52.9295960094791, -11.035808093192296, -10.181181154543893, -21.376040500729005, -37.9015434704214, -25.449437288997267, -30.186578402181567, -6.3199028339146945, -3.7370607960217312, -40.33091853682254, -20.14942634537383, -14.672078595600148, -33.79994812591728, -6.142227615060627, -35.385143588780615, -9.301745230489825, -15.615811047537612, -56.82009961907239, -24.952835758694093, -35.744025784916246, -19.809134110960464, -41.47727583683225, -6.231239281495494, -29.546984379908512, -49.13028560371237, -38.63867291244165, -20.965264425104657, -17.473095484944025, -28.162937341918813, -9.625933781083377, -47.85603652274764, -18.3839322550255, -42.627174407566294, -43.798639526508616, -48.91459251438276, -16.943109604418893, -16.41974197977092, -36.28934494808563, -5.1761990748489195, -10.727120289425622, -13.504762026739566, -6.58650358038499, -27.966642418738534, -24.286361170042372, -19.11690702887581, -17.605115170596314, -5.421615897637133, -6.726429332816186, -27.054444125912585, -44.570982478777545, -11.046998041764315, -26.636317968315968, -14.511112545605364, -26.078111707608286, -24.695487608233844, -18.193731217730175, -28.46755755510369, -19.864478428755188, -5.681945466526473, -23.168476471471116, -26.45427026264008, -16.395220811994488, -39.85438295567207, -30.17798723521096, -18.144804256710756, -36.46478818197023, -17.50334103829522, -10.566880816857333, -45.57553771768505, -19.908760071014914, -23.651692916216398, -8.609427111927367, -11.664536839407667, -50.577676876319465, -35.58254649424376, -8.993264824664001, -35.773496712615035, -35.93954975233208, -12.79906634076893, -16.6733668457306, -40.06999663103686, -21.246722242882186, -23.120062018572582, -18.852141572949705, -28.239051298352774, -19.989989532829465], "policy_predator_policy_reward": [41.967258629266254, 8.28994769552466, 55.437709577462975, 28.877551896950663, 29.788472149304543, 4.363946056127852, 46.58128739138865, 39.44755914336405, 39.54856801606676, 11.495189905414753, 10.861867587437771, 42.97009812300956, 10.298103125947106, 31.923598736362266, 52.9295960094791, 11.035808093192296, 10.181181154543893, 21.376040500729005, 37.9015434704214, 25.449437288997267, 30.186578402181567, 6.3199028339146945, 3.7370607960217312, 40.33091853682254, 20.14942634537383, 14.672078595600148, 33.79994812591728, 6.142227615060627, 35.385143588780615, 9.301745230489825, 15.615811047537612, 56.82009961907239, 24.952835758694093, 35.744025784916246, 19.809134110960464, 41.47727583683225, 6.231239281495494, 29.546984379908512, 49.13028560371237, 38.63867291244165, 20.965264425104657, 17.473095484944025, 28.162937341918813, 9.625933781083377, 47.85603652274764, 18.3839322550255, 42.627174407566294, 43.798639526508616, 48.91459251438276, 16.943109604418893, 16.41974197977092, 36.28934494808563, 5.1761990748489195, 10.727120289425622, 13.504762026739566, 6.58650358038499, 27.966642418738534, 24.286361170042372, 19.11690702887581, 17.605115170596314, 5.421615897637133, 6.726429332816186, 27.054444125912585, 44.570982478777545, 11.046998041764315, 26.636317968315968, 14.511112545605364, 26.078111707608286, 24.695487608233844, 18.193731217730175, 28.46755755510369, 19.864478428755188, 5.681945466526473, 23.168476471471116, 26.45427026264008, 16.395220811994488, 39.85438295567207, 30.17798723521096, 18.144804256710756, 36.46478818197023, 17.50334103829522, 10.566880816857333, 45.57553771768505, 19.908760071014914, 23.651692916216398, 8.609427111927367, 11.664536839407667, 50.577676876319465, 35.58254649424376, 8.993264824664001, 35.773496712615035, 35.93954975233208, 12.79906634076893, 16.6733668457306, 40.06999663103686, 21.246722242882186, 23.120062018572582, 18.852141572949705, 28.239051298352774, 19.989989532829465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29404039531421444, "mean_inference_ms": 0.9372667508342567, "mean_action_processing_ms": 0.12561758440993967, "mean_env_wait_ms": 0.06608157404442873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00271761417388916, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.046788811683654785}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 688.9748402374688, "num_env_steps_trained_throughput_per_sec": 688.9748402374688, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 1384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1384000, "timers": {"training_iteration_time_ms": 6279.457, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6279.228, "sample_time_ms": 781.161, "learn_time_ms": 5480.702, "learn_throughput": 729.833, "synch_weights_time_ms": 16.597}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "done": false, "training_iteration": 173, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-08", "timestamp": 1723391288, "time_this_iter_s": 5.811519145965576, "time_total_s": 1030.8959622383118, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602f4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1030.8959622383118, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 27.0375, "ram_util_percent": 81.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1550358763585487, "cur_kl_coeff": 2.0328790734103204e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2359481912727157, "policy_loss": -0.0010113202114249967, "vf_loss": 1.2369595121592283, "vf_explained_var": 0.9665191356092692, "kl": 0.001964856976053938, "entropy": 0.2637779047091802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.078530656049649, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2546728591434657, "policy_loss": -0.002899777081377882, "vf_loss": 1.257527379722645, "vf_explained_var": 0.9656436197459698, "kl": 0.012872803912991245, "entropy": 0.5840108909954628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.93, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6293, "policy_reward_min": {"prey_policy": -50.577676876319465, "predator_policy": 5.681945466526473}, "policy_reward_max": {"prey_policy": -5.681945466526473, "predator_policy": 50.577676876319465}, "policy_reward_mean": {"prey_policy": -23.845578129591786, "predator_policy": 23.845578129591786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [44, 66, 64, 86, 60, 43, 104, 39, 31, 73, 46, 55, 80, 58, 47, 67, 36, 86, 69, 39, 67, 87, 64, 90, 83, 51, 73, 78, 41, 76, 81, 79, 85, 32, 65, 79, 107, 42, 53, 107, 56, 66, 52, 85, 61, 58, 82, 59, 54, 90, 51, 75, 67, 92, 53, 49, 27, 46, 63, 56, 54, 57, 73, 90, 47, 53, 96, 59, 58, 51, 63, 88, 78, 56, 43, 63, 54, 51, 12, 23, 71, 11, 58, 53, 67, 51, 89, 60, 54, 42, 59, 63, 71, 63, 91, 65, 68, 52, 69, 92], "policy_prey_policy_reward": [-11.046998041764315, -26.636317968315968, -14.511112545605364, -26.078111707608286, -24.695487608233844, -18.193731217730175, -28.46755755510369, -19.864478428755188, -5.681945466526473, -23.168476471471116, -26.45427026264008, -16.395220811994488, -39.85438295567207, -30.17798723521096, -18.144804256710756, -36.46478818197023, -17.50334103829522, -10.566880816857333, -45.57553771768505, -19.908760071014914, -23.651692916216398, -8.609427111927367, -11.664536839407667, -50.577676876319465, -35.58254649424376, -8.993264824664001, -35.773496712615035, -35.93954975233208, -12.79906634076893, -16.6733668457306, -40.06999663103686, -21.246722242882186, -23.120062018572582, -18.852141572949705, -28.239051298352774, -19.989989532829465, -30.884154193626717, -28.109508445477488, -30.175341288730106, -27.547470828485316, -10.007315097184938, -24.625286912217273, -12.618809081265235, -30.943085922036524, -14.892827575430733, -23.57231543358971, -48.963403931154275, -12.646592018888137, -40.036328536950215, -26.24413977954983, -24.522051764871982, -39.897992782353036, -23.679847522935745, -38.93291732290167, -24.79324893033896, -21.29885773347604, -7.3804236926562, -26.391885153791094, -15.536096710713931, -37.397030025314656, -17.83492350921797, -30.622952899138006, -47.98088404484135, -47.39574773872373, -18.736349749326596, -24.42058249272763, -20.14261531561975, -15.164630289794532, -36.16467961830485, -7.476920293323663, -18.91941092261527, -20.88899540645544, -32.00512384868776, -29.10843573945349, -13.847697057940524, -20.70232574435983, -19.6046699255475, -16.198591887964028, -5.931224078038377, -10.04114871582817, -36.05291934926074, -8.420563838741064, -20.612368031822026, -20.240486942392675, -16.140336204287784, -30.547311746719423, -37.653742615610724, -31.174934410356723, -10.182081764056733, -15.1836404969919, -36.72568363594842, -30.578753540065318, -41.6312472232999, -11.42999492106214, -12.060880163543967, -33.183946329571256, -15.700691599080523, -13.088609636893207, -13.621088236006276, -24.870913941604954], "policy_predator_policy_reward": [11.046998041764315, 26.636317968315968, 14.511112545605364, 26.078111707608286, 24.695487608233844, 18.193731217730175, 28.46755755510369, 19.864478428755188, 5.681945466526473, 23.168476471471116, 26.45427026264008, 16.395220811994488, 39.85438295567207, 30.17798723521096, 18.144804256710756, 36.46478818197023, 17.50334103829522, 10.566880816857333, 45.57553771768505, 19.908760071014914, 23.651692916216398, 8.609427111927367, 11.664536839407667, 50.577676876319465, 35.58254649424376, 8.993264824664001, 35.773496712615035, 35.93954975233208, 12.79906634076893, 16.6733668457306, 40.06999663103686, 21.246722242882186, 23.120062018572582, 18.852141572949705, 28.239051298352774, 19.989989532829465, 30.884154193626717, 28.109508445477488, 30.175341288730106, 27.547470828485316, 10.007315097184938, 24.625286912217273, 12.618809081265235, 30.943085922036524, 14.892827575430733, 23.57231543358971, 48.963403931154275, 12.646592018888137, 40.036328536950215, 26.24413977954983, 24.522051764871982, 39.897992782353036, 23.679847522935745, 38.93291732290167, 24.79324893033896, 21.29885773347604, 7.3804236926562, 26.391885153791094, 15.536096710713931, 37.397030025314656, 17.83492350921797, 30.622952899138006, 47.98088404484135, 47.39574773872373, 18.736349749326596, 24.42058249272763, 20.14261531561975, 15.164630289794532, 36.16467961830485, 7.476920293323663, 18.91941092261527, 20.88899540645544, 32.00512384868776, 29.10843573945349, 13.847697057940524, 20.70232574435983, 19.6046699255475, 16.198591887964028, 5.931224078038377, 10.04114871582817, 36.05291934926074, 8.420563838741064, 20.612368031822026, 20.240486942392675, 16.140336204287784, 30.547311746719423, 37.653742615610724, 31.174934410356723, 10.182081764056733, 15.1836404969919, 36.72568363594842, 30.578753540065318, 41.6312472232999, 11.42999492106214, 12.060880163543967, 33.183946329571256, 15.700691599080523, 13.088609636893207, 13.621088236006276, 24.870913941604954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2938139282937499, "mean_inference_ms": 0.9367054941335182, "mean_action_processing_ms": 0.1255104772443702, "mean_env_wait_ms": 0.06608836114249496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002777695655822754, "StateBufferConnector_ms": 0.0020449161529541016, "ViewRequirementAgentConnector_ms": 0.04631686210632324}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 660.0859576104134, "num_env_steps_trained_throughput_per_sec": 660.0859576104134, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 6160.127, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6159.949, "sample_time_ms": 673.656, "learn_time_ms": 5470.152, "learn_throughput": 731.241, "synch_weights_time_ms": 15.455}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 174, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-14", "timestamp": 1723391294, "time_this_iter_s": 6.066856861114502, "time_total_s": 1036.9628190994263, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x160294430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1036.9628190994263, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 29.0625, "ram_util_percent": 81.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2158164717257023, "cur_kl_coeff": 1.0164395367051602e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4531570953006545, "policy_loss": -0.00017751442234536323, "vf_loss": 1.4533346104125182, "vf_explained_var": 0.9697214782238006, "kl": 0.0037973558665104325, "entropy": 0.2621877502339582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.352143709982435, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4856110716238617, "policy_loss": -0.007200986442330759, "vf_loss": 1.4927889632682005, "vf_explained_var": 0.9693000842506687, "kl": 0.006569263082495998, "entropy": 0.5896394591778517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 60.87, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6087, "policy_reward_min": {"prey_policy": -48.18851969218374, "predator_policy": 2.165271960449826}, "policy_reward_max": {"prey_policy": -2.165271960449826, "predator_policy": 48.18851969218374}, "policy_reward_mean": {"prey_policy": -23.31240435549677, "predator_policy": 23.31240435549677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [47, 53, 96, 59, 58, 51, 63, 88, 78, 56, 43, 63, 54, 51, 12, 23, 71, 11, 58, 53, 67, 51, 89, 60, 54, 42, 59, 63, 71, 63, 91, 65, 68, 52, 69, 92, 49, 88, 73, 80, 84, 70, 48, 45, 50, 51, 99, 48, 26, 55, 83, 63, 74, 76, 79, 36, 39, 70, 58, 52, 77, 48, 24, 69, 4, 85, 32, 89, 32, 13, 67, 54, 90, 32, 40, 61, 59, 60, 76, 43, 49, 47, 126, 83, 93, 51, 52, 45, 57, 84, 77, 44, 86, 67, 61, 88, 64, 41, 92, 85], "policy_prey_policy_reward": [-18.736349749326596, -24.42058249272763, -20.14261531561975, -15.164630289794532, -36.16467961830485, -7.476920293323663, -18.91941092261527, -20.88899540645544, -32.00512384868776, -29.10843573945349, -13.847697057940524, -20.70232574435983, -19.6046699255475, -16.198591887964028, -5.931224078038377, -10.04114871582817, -36.05291934926074, -8.420563838741064, -20.612368031822026, -20.240486942392675, -16.140336204287784, -30.547311746719423, -37.653742615610724, -31.174934410356723, -10.182081764056733, -15.1836404969919, -36.72568363594842, -30.578753540065318, -41.6312472232999, -11.42999492106214, -12.060880163543967, -33.183946329571256, -15.700691599080523, -13.088609636893207, -13.621088236006276, -24.870913941604954, -7.373122329308997, -26.324936110428293, -40.670722244241055, -24.59125540068743, -40.522705727093474, -16.692855837770097, -28.221337045677537, -32.10306006742028, -31.99466453177365, -19.669056019035402, -44.848299669449624, -19.406638719040128, -23.924279530643584, -13.495617311564022, -39.597580425546596, -14.893571652942585, -37.47122259644293, -29.53020827765218, -29.538183595550276, -18.66098101256608, -9.194568276668551, -42.84006470395569, -30.334313270083122, -15.953641088341652, -16.002686118215955, -34.49609110136628, -11.586617414962207, -4.277227067805896, -2.7873270183102425, -33.5256404512859, -16.42478923993606, -31.35005091198422, -13.124590869435327, -9.118783290459996, -32.46151815065243, -44.64535256410887, -44.358184668675, -8.7023328321102, -12.664021252325607, -32.47349710689967, -16.44148393831071, -11.496479840071064, -27.670611815582067, -20.292657015940218, -6.8680752258199185, -2.165271960449826, -31.142476141268805, -36.216782024326875, -45.56062909977157, -8.58800212980396, -20.13138254357727, -18.43105112860453, -16.717086980878552, -32.48177727935446, -34.453020194237205, -19.908204251707133, -38.83094021987007, -36.235589798041765, -17.957971342765248, -48.18851969218374, -27.747192278102293, -4.891974336533396, -36.75296608124773, -17.765099015507804], "policy_predator_policy_reward": [18.736349749326596, 24.42058249272763, 20.14261531561975, 15.164630289794532, 36.16467961830485, 7.476920293323663, 18.91941092261527, 20.88899540645544, 32.00512384868776, 29.10843573945349, 13.847697057940524, 20.70232574435983, 19.6046699255475, 16.198591887964028, 5.931224078038377, 10.04114871582817, 36.05291934926074, 8.420563838741064, 20.612368031822026, 20.240486942392675, 16.140336204287784, 30.547311746719423, 37.653742615610724, 31.174934410356723, 10.182081764056733, 15.1836404969919, 36.72568363594842, 30.578753540065318, 41.6312472232999, 11.42999492106214, 12.060880163543967, 33.183946329571256, 15.700691599080523, 13.088609636893207, 13.621088236006276, 24.870913941604954, 7.373122329308997, 26.324936110428293, 40.670722244241055, 24.59125540068743, 40.522705727093474, 16.692855837770097, 28.221337045677537, 32.10306006742028, 31.99466453177365, 19.669056019035402, 44.848299669449624, 19.406638719040128, 23.924279530643584, 13.495617311564022, 39.597580425546596, 14.893571652942585, 37.47122259644293, 29.53020827765218, 29.538183595550276, 18.66098101256608, 9.194568276668551, 42.84006470395569, 30.334313270083122, 15.953641088341652, 16.002686118215955, 34.49609110136628, 11.586617414962207, 4.277227067805896, 2.7873270183102425, 33.5256404512859, 16.42478923993606, 31.35005091198422, 13.124590869435327, 9.118783290459996, 32.46151815065243, 44.64535256410887, 44.358184668675, 8.7023328321102, 12.664021252325607, 32.47349710689967, 16.44148393831071, 11.496479840071064, 27.670611815582067, 20.292657015940218, 6.8680752258199185, 2.165271960449826, 31.142476141268805, 36.216782024326875, 45.56062909977157, 8.58800212980396, 20.13138254357727, 18.43105112860453, 16.717086980878552, 32.48177727935446, 34.453020194237205, 19.908204251707133, 38.83094021987007, 36.235589798041765, 17.957971342765248, 48.18851969218374, 27.747192278102293, 4.891974336533396, 36.75296608124773, 17.765099015507804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29374639791461205, "mean_inference_ms": 0.9362011955450638, "mean_action_processing_ms": 0.1254149849815564, "mean_env_wait_ms": 0.06604131942786085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027043819427490234, "StateBufferConnector_ms": 0.0021094083786010742, "ViewRequirementAgentConnector_ms": 0.04578959941864014}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 675.5857168594177, "num_env_steps_trained_throughput_per_sec": 675.5857168594177, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 6148.965, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6148.789, "sample_time_ms": 670.88, "learn_time_ms": 5462.258, "learn_throughput": 732.298, "synch_weights_time_ms": 15.008}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 175, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-20", "timestamp": 1723391300, "time_this_iter_s": 5.926329135894775, "time_total_s": 1042.889148235321, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e2670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1042.889148235321, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 26.1, "ram_util_percent": 81.42222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.208619582715134, "cur_kl_coeff": 5.082197683525801e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3759078849727908, "policy_loss": -0.0031089153485178637, "vf_loss": 1.3790168010940154, "vf_explained_var": 0.9685356338818868, "kl": 0.002665418934304853, "entropy": 0.2616992983035743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.29953573482732, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4007659735778968, "policy_loss": -0.0045900297208087675, "vf_loss": 1.4053191687911748, "vf_explained_var": 0.967149153413872, "kl": 0.010475591431445228, "entropy": 0.6312524153540532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.11, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6311, "policy_reward_min": {"prey_policy": -52.561396819220896, "predator_policy": 0.9755149400671562}, "policy_reward_max": {"prey_policy": -0.9755149400671562, "predator_policy": 52.561396819220896}, "policy_reward_mean": {"prey_policy": -24.236751560016536, "predator_policy": 24.236751560016536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 69, 4, 85, 32, 89, 32, 13, 67, 54, 90, 32, 40, 61, 59, 60, 76, 43, 49, 47, 126, 83, 93, 51, 52, 45, 57, 84, 77, 44, 86, 67, 61, 88, 64, 41, 92, 85, 58, 74, 77, 70, 83, 78, 91, 83, 41, 53, 27, 84, 83, 57, 63, 54, 32, 62, 71, 2, 62, 52, 73, 20, 132, 70, 79, 77, 78, 79, 32, 73, 66, 82, 41, 63, 14, 61, 51, 87, 78, 77, 73, 61, 96, 52, 58, 69, 48, 54, 53, 58, 80, 32, 59, 59, 94, 12, 144, 41, 81, 75], "policy_prey_policy_reward": [-11.586617414962207, -4.277227067805896, -2.7873270183102425, -33.5256404512859, -16.42478923993606, -31.35005091198422, -13.124590869435327, -9.118783290459996, -32.46151815065243, -44.64535256410887, -44.358184668675, -8.7023328321102, -12.664021252325607, -32.47349710689967, -16.44148393831071, -11.496479840071064, -27.670611815582067, -20.292657015940218, -6.8680752258199185, -2.165271960449826, -31.142476141268805, -36.216782024326875, -45.56062909977157, -8.58800212980396, -20.13138254357727, -18.43105112860453, -16.717086980878552, -32.48177727935446, -34.453020194237205, -19.908204251707133, -38.83094021987007, -36.235589798041765, -17.957971342765248, -48.18851969218374, -27.747192278102293, -4.891974336533396, -36.75296608124773, -17.765099015507804, -44.77332594189157, -16.648834190354442, -37.83713715443229, -39.758130524149244, -52.561396819220896, -33.01624699042923, -31.546379911695443, -26.957434473518727, -14.419088453346692, -22.297624808729154, -12.426753346927097, -41.897478522622016, -48.97495742851629, -37.81063611316508, -24.400873195184026, -30.013012303303405, -20.461242112831307, -33.98195348819964, -25.060356697874557, -2.1066688140549354, -18.363115198393643, -9.347463982645206, -34.50919089907106, -0.9755149400671562, -6.215082175650744, -11.425468793317664, -23.140176171015405, -19.92425089845238, -41.63230717657246, -29.28448051032365, -16.44352025520555, -21.29861032388054, -12.245078226394577, -40.63820877601817, -17.149020473685734, -31.860687841492187, -14.500673721565603, -32.25383066032508, -22.589419689166757, -41.789014689522986, -15.105089648479291, -43.35895405305448, -22.088449021513682, -24.31340215369648, -36.27667028214324, -33.20783595339817, -23.40064911596261, -24.260698025397822, -18.208806777035658, -14.387540152494473, -22.694734064134156, -6.293926460831137, -33.68428918588749, -11.756483599565343, -9.8069757860417, -20.77537389050961, -48.88464129035036, -4.719546239741673, -34.94508119421298, -10.492853310059248, -31.05428876684849, -16.989043164175655], "policy_predator_policy_reward": [11.586617414962207, 4.277227067805896, 2.7873270183102425, 33.5256404512859, 16.42478923993606, 31.35005091198422, 13.124590869435327, 9.118783290459996, 32.46151815065243, 44.64535256410887, 44.358184668675, 8.7023328321102, 12.664021252325607, 32.47349710689967, 16.44148393831071, 11.496479840071064, 27.670611815582067, 20.292657015940218, 6.8680752258199185, 2.165271960449826, 31.142476141268805, 36.216782024326875, 45.56062909977157, 8.58800212980396, 20.13138254357727, 18.43105112860453, 16.717086980878552, 32.48177727935446, 34.453020194237205, 19.908204251707133, 38.83094021987007, 36.235589798041765, 17.957971342765248, 48.18851969218374, 27.747192278102293, 4.891974336533396, 36.75296608124773, 17.765099015507804, 44.77332594189157, 16.648834190354442, 37.83713715443229, 39.758130524149244, 52.561396819220896, 33.01624699042923, 31.546379911695443, 26.957434473518727, 14.419088453346692, 22.297624808729154, 12.426753346927097, 41.897478522622016, 48.97495742851629, 37.81063611316508, 24.400873195184026, 30.013012303303405, 20.461242112831307, 33.98195348819964, 25.060356697874557, 2.1066688140549354, 18.363115198393643, 9.347463982645206, 34.50919089907106, 0.9755149400671562, 6.215082175650744, 11.425468793317664, 23.140176171015405, 19.92425089845238, 41.63230717657246, 29.28448051032365, 16.44352025520555, 21.29861032388054, 12.245078226394577, 40.63820877601817, 17.149020473685734, 31.860687841492187, 14.500673721565603, 32.25383066032508, 22.589419689166757, 41.789014689522986, 15.105089648479291, 43.35895405305448, 22.088449021513682, 24.31340215369648, 36.27667028214324, 33.20783595339817, 23.40064911596261, 24.260698025397822, 18.208806777035658, 14.387540152494473, 22.694734064134156, 6.293926460831137, 33.68428918588749, 11.756483599565343, 9.8069757860417, 20.77537389050961, 48.88464129035036, 4.719546239741673, 34.94508119421298, 10.492853310059248, 31.05428876684849, 16.989043164175655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29377269420153435, "mean_inference_ms": 0.9358218707850124, "mean_action_processing_ms": 0.12530539173460822, "mean_env_wait_ms": 0.0659876806321771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002798914909362793, "StateBufferConnector_ms": 0.0021479129791259766, "ViewRequirementAgentConnector_ms": 0.04714334011077881}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 653.4470847100648, "num_env_steps_trained_throughput_per_sec": 653.4470847100648, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 6122.545, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6122.366, "sample_time_ms": 665.2, "learn_time_ms": 5441.32, "learn_throughput": 735.116, "synch_weights_time_ms": 15.254}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 176, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-26", "timestamp": 1723391306, "time_this_iter_s": 6.126389026641846, "time_total_s": 1049.015537261963, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602f4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1049.015537261963, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 31.455555555555552, "ram_util_percent": 81.72222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0902774727592868, "cur_kl_coeff": 2.5410988417629005e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4788294040442755, "policy_loss": -0.0015448614554770756, "vf_loss": 1.4803742655863366, "vf_explained_var": 0.9623833840092023, "kl": 0.0031342161274845394, "entropy": 0.2577578616483758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.270404832996428, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4576587117587527, "policy_loss": -0.007260899134659364, "vf_loss": 1.4648766528815031, "vf_explained_var": 0.9635430010656516, "kl": 0.012218801246514206, "entropy": 0.5886592937633395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.46, "episode_media": {}, "episodes_this_iter": 67, "episodes_timesteps_total": 6246, "policy_reward_min": {"prey_policy": -54.84520472898434, "predator_policy": 2.139938583387835}, "policy_reward_max": {"prey_policy": -2.139938583387835, "predator_policy": 54.84520472898434}, "policy_reward_mean": {"prey_policy": -24.509367616415666, "predator_policy": 24.509367616415666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [79, 32, 73, 66, 82, 41, 63, 14, 61, 51, 87, 78, 77, 73, 61, 96, 52, 58, 69, 48, 54, 53, 58, 80, 32, 59, 59, 94, 12, 144, 41, 81, 75, 44, 69, 37, 82, 68, 74, 79, 79, 101, 37, 57, 82, 66, 86, 47, 71, 52, 79, 59, 64, 59, 49, 31, 88, 58, 39, 87, 86, 74, 78, 64, 24, 52, 58, 55, 68, 45, 51, 37, 75, 86, 53, 62, 69, 49, 83, 89, 89, 79, 31, 63, 55, 65, 48, 56, 49, 43, 73, 62, 4, 60, 15, 64, 88, 64, 50, 83], "policy_prey_policy_reward": [-29.28448051032365, -16.44352025520555, -21.29861032388054, -12.245078226394577, -40.63820877601817, -17.149020473685734, -31.860687841492187, -14.500673721565603, -32.25383066032508, -22.589419689166757, -41.789014689522986, -15.105089648479291, -43.35895405305448, -22.088449021513682, -24.31340215369648, -36.27667028214324, -33.20783595339817, -23.40064911596261, -24.260698025397822, -18.208806777035658, -14.387540152494473, -22.694734064134156, -6.293926460831137, -33.68428918588749, -11.756483599565343, -9.8069757860417, -20.77537389050961, -48.88464129035036, -4.719546239741673, -34.94508119421298, -10.492853310059248, -31.05428876684849, -16.989043164175655, -5.474454492854255, -31.923069949958943, -26.038003237579137, -32.5586579462733, -32.78432716666635, -28.91786571278438, -20.47332239335975, -29.148866070892954, -10.673107081296957, -6.146979662240486, -22.072771009256577, -39.06099201676645, -36.802493646968564, -39.76944597004138, -11.608335626788673, -49.5945673078597, -6.0371177965033445, -31.639566687657705, -23.374381600273647, -40.47579609929311, -22.998329093367587, -14.252049012459496, -27.02863164276232, -15.809884505562538, -33.61343269579411, -22.339810414959647, -27.693657249065787, -17.74400738409137, -19.071701192256782, -19.193161900688743, -15.34427926485731, -12.25977534293293, -27.92599595390578, -21.262679971089455, -31.581849444786837, -43.69166040734369, -11.829159744073392, -23.135689777589295, -19.85991701019341, -26.575681063938102, -10.597140473515998, -26.478270011723325, -32.796695819305064, -17.184246236929496, -39.292228573315114, -35.394238520530905, -54.84520472898434, -29.24535052444638, -42.75134391261778, -14.478255384959041, -22.15567756377375, -10.515489246002504, -34.82291398934512, -28.19349081375334, -23.79252846590054, -29.592392829698912, -4.491404732375187, -25.586944700527354, -20.332979173211832, -2.139938583387835, -32.61078301692617, -9.798950902640696, -35.73547357948545, -36.865683468936375, -16.703057028204285, -29.287052288647967, -20.70567522227352], "policy_predator_policy_reward": [29.28448051032365, 16.44352025520555, 21.29861032388054, 12.245078226394577, 40.63820877601817, 17.149020473685734, 31.860687841492187, 14.500673721565603, 32.25383066032508, 22.589419689166757, 41.789014689522986, 15.105089648479291, 43.35895405305448, 22.088449021513682, 24.31340215369648, 36.27667028214324, 33.20783595339817, 23.40064911596261, 24.260698025397822, 18.208806777035658, 14.387540152494473, 22.694734064134156, 6.293926460831137, 33.68428918588749, 11.756483599565343, 9.8069757860417, 20.77537389050961, 48.88464129035036, 4.719546239741673, 34.94508119421298, 10.492853310059248, 31.05428876684849, 16.989043164175655, 5.474454492854255, 31.923069949958943, 26.038003237579137, 32.5586579462733, 32.78432716666635, 28.91786571278438, 20.47332239335975, 29.148866070892954, 10.673107081296957, 6.146979662240486, 22.072771009256577, 39.06099201676645, 36.802493646968564, 39.76944597004138, 11.608335626788673, 49.5945673078597, 6.0371177965033445, 31.639566687657705, 23.374381600273647, 40.47579609929311, 22.998329093367587, 14.252049012459496, 27.02863164276232, 15.809884505562538, 33.61343269579411, 22.339810414959647, 27.693657249065787, 17.74400738409137, 19.071701192256782, 19.193161900688743, 15.34427926485731, 12.25977534293293, 27.92599595390578, 21.262679971089455, 31.581849444786837, 43.69166040734369, 11.829159744073392, 23.135689777589295, 19.85991701019341, 26.575681063938102, 10.597140473515998, 26.478270011723325, 32.796695819305064, 17.184246236929496, 39.292228573315114, 35.394238520530905, 54.84520472898434, 29.24535052444638, 42.75134391261778, 14.478255384959041, 22.15567756377375, 10.515489246002504, 34.82291398934512, 28.19349081375334, 23.79252846590054, 29.592392829698912, 4.491404732375187, 25.586944700527354, 20.332979173211832, 2.139938583387835, 32.61078301692617, 9.798950902640696, 35.73547357948545, 36.865683468936375, 16.703057028204285, 29.287052288647967, 20.70567522227352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29439845750880467, "mean_inference_ms": 0.9371486778285248, "mean_action_processing_ms": 0.12559234404538666, "mean_env_wait_ms": 0.06610289572883853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030285120010375977, "StateBufferConnector_ms": 0.0023282766342163086, "ViewRequirementAgentConnector_ms": 0.05054938793182373}, "num_episodes": 67, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 631.1085210553254, "num_env_steps_trained_throughput_per_sec": 631.1085210553254, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 6135.05, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6134.872, "sample_time_ms": 688.456, "learn_time_ms": 5430.564, "learn_throughput": 736.572, "synch_weights_time_ms": 15.263}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 177, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-32", "timestamp": 1723391312, "time_this_iter_s": 6.343651056289673, "time_total_s": 1055.3591883182526, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1055.3591883182526, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 30.588888888888885, "ram_util_percent": 81.73333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0520535891875626, "cur_kl_coeff": 1.2705494208814502e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.152155512291938, "policy_loss": -0.002817146585342319, "vf_loss": 1.1549726561953624, "vf_explained_var": 0.9764985221748551, "kl": 0.004337765173081428, "entropy": 0.2830237658073505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.263581574956576, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2030421579256654, "policy_loss": -0.007393372480631418, "vf_loss": 1.2103968270123004, "vf_explained_var": 0.9759832627450427, "kl": 0.011008270807175086, "entropy": 0.6040213668098052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.38, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6238, "policy_reward_min": {"prey_policy": -54.84520472898434, "predator_policy": 2.139938583387835}, "policy_reward_max": {"prey_policy": -2.139938583387835, "predator_policy": 54.84520472898434}, "policy_reward_mean": {"prey_policy": -25.51575488015612, "predator_policy": 25.51575488015612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [74, 78, 64, 24, 52, 58, 55, 68, 45, 51, 37, 75, 86, 53, 62, 69, 49, 83, 89, 89, 79, 31, 63, 55, 65, 48, 56, 49, 43, 73, 62, 4, 60, 15, 64, 88, 64, 50, 83, 49, 56, 65, 82, 53, 85, 50, 89, 30, 51, 56, 88, 54, 50, 86, 87, 88, 88, 83, 49, 83, 66, 42, 66, 68, 63, 70, 77, 79, 59, 77, 64, 36, 80, 55, 73, 54, 66, 18, 84, 54, 77, 90, 49, 63, 72, 67, 54, 20, 46, 53, 47, 70, 99, 54, 48, 58, 77, 30, 97, 81], "policy_prey_policy_reward": [-19.071701192256782, -19.193161900688743, -15.34427926485731, -12.25977534293293, -27.92599595390578, -21.262679971089455, -31.581849444786837, -43.69166040734369, -11.829159744073392, -23.135689777589295, -19.85991701019341, -26.575681063938102, -10.597140473515998, -26.478270011723325, -32.796695819305064, -17.184246236929496, -39.292228573315114, -35.394238520530905, -54.84520472898434, -29.24535052444638, -42.75134391261778, -14.478255384959041, -22.15567756377375, -10.515489246002504, -34.82291398934512, -28.19349081375334, -23.79252846590054, -29.592392829698912, -4.491404732375187, -25.586944700527354, -20.332979173211832, -2.139938583387835, -32.61078301692617, -9.798950902640696, -35.73547357948545, -36.865683468936375, -16.703057028204285, -29.287052288647967, -20.70567522227352, -17.086333718786523, -13.649581310249951, -23.188254702096962, -39.53335357209363, -14.875029777339332, -26.38517502893906, -28.859763530477142, -50.378086663770326, -12.98684827774883, -29.657594867730445, -8.100234480828094, -46.007480394449, -8.059945576683566, -19.308191921344935, -48.89855205849809, -30.646206276581992, -30.111276363455868, -44.81864029055413, -33.64329113288552, -19.63143237116093, -25.96987255874193, -28.51280066891243, -8.304955815655406, -37.29422147056335, -33.91279768818967, -17.124674755628917, -17.089297404855564, -43.65273373518047, -30.75414745995796, -10.935793623130946, -40.92788811373639, -31.694870687715696, -8.001803977443325, -28.843228261593254, -12.903546973732933, -11.916155379767448, -40.04270328987801, -24.92789781848385, -6.9027292668987315, -54.718113678530834, -24.097945165967836, -27.069703077520654, -40.79317302914946, -8.470944797234633, -38.697253296605254, -42.26459668224361, -41.378030431672606, -24.79333611049818, -4.3528341069822485, -28.27386972709158, -12.481941448830964, -20.365764478231, -21.53345517530555, -39.871035000805904, -17.93194704168402, -16.36522239069383, -22.258705236959273, -32.63132050600287, -8.460096380619195, -23.914825111793427, -37.189023010374264], "policy_predator_policy_reward": [19.071701192256782, 19.193161900688743, 15.34427926485731, 12.25977534293293, 27.92599595390578, 21.262679971089455, 31.581849444786837, 43.69166040734369, 11.829159744073392, 23.135689777589295, 19.85991701019341, 26.575681063938102, 10.597140473515998, 26.478270011723325, 32.796695819305064, 17.184246236929496, 39.292228573315114, 35.394238520530905, 54.84520472898434, 29.24535052444638, 42.75134391261778, 14.478255384959041, 22.15567756377375, 10.515489246002504, 34.82291398934512, 28.19349081375334, 23.79252846590054, 29.592392829698912, 4.491404732375187, 25.586944700527354, 20.332979173211832, 2.139938583387835, 32.61078301692617, 9.798950902640696, 35.73547357948545, 36.865683468936375, 16.703057028204285, 29.287052288647967, 20.70567522227352, 17.086333718786523, 13.649581310249951, 23.188254702096962, 39.53335357209363, 14.875029777339332, 26.38517502893906, 28.859763530477142, 50.378086663770326, 12.98684827774883, 29.657594867730445, 8.100234480828094, 46.007480394449, 8.059945576683566, 19.308191921344935, 48.89855205849809, 30.646206276581992, 30.111276363455868, 44.81864029055413, 33.64329113288552, 19.63143237116093, 25.96987255874193, 28.51280066891243, 8.304955815655406, 37.29422147056335, 33.91279768818967, 17.124674755628917, 17.089297404855564, 43.65273373518047, 30.75414745995796, 10.935793623130946, 40.92788811373639, 31.694870687715696, 8.001803977443325, 28.843228261593254, 12.903546973732933, 11.916155379767448, 40.04270328987801, 24.92789781848385, 6.9027292668987315, 54.718113678530834, 24.097945165967836, 27.069703077520654, 40.79317302914946, 8.470944797234633, 38.697253296605254, 42.26459668224361, 41.378030431672606, 24.79333611049818, 4.3528341069822485, 28.27386972709158, 12.481941448830964, 20.365764478231, 21.53345517530555, 39.871035000805904, 17.93194704168402, 16.36522239069383, 22.258705236959273, 32.63132050600287, 8.460096380619195, 23.914825111793427, 37.189023010374264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945739195535602, "mean_inference_ms": 0.9378156491850312, "mean_action_processing_ms": 0.12567590495621203, "mean_env_wait_ms": 0.0661755248991919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003005504608154297, "StateBufferConnector_ms": 0.002120375633239746, "ViewRequirementAgentConnector_ms": 0.054421424865722656}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.4631167511776, "num_env_steps_trained_throughput_per_sec": 699.4631167511776, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 6104.661, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6104.482, "sample_time_ms": 688.898, "learn_time_ms": 5399.802, "learn_throughput": 740.768, "synch_weights_time_ms": 15.19}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 178, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-38", "timestamp": 1723391318, "time_this_iter_s": 5.726136684417725, "time_total_s": 1061.0853250026703, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x160294430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1061.0853250026703, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 29.45, "ram_util_percent": 81.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.97539421779414, "cur_kl_coeff": 6.352747104407251e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0799176435451954, "policy_loss": -2.3746146568252394e-05, "vf_loss": 1.0799413927830757, "vf_explained_var": 0.978126288826267, "kl": 0.0029169236228473966, "entropy": 0.28791512140693765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.196849633132418, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0924612525229653, "policy_loss": -0.004605374481373777, "vf_loss": 1.0970413782944282, "vf_explained_var": 0.9777329986914992, "kl": 0.007182022305294139, "entropy": 0.5975845058138172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 59.97, "episode_media": {}, "episodes_this_iter": 66, "episodes_timesteps_total": 5997, "policy_reward_min": {"prey_policy": -54.718113678530834, "predator_policy": 1.0220516156148682}, "policy_reward_max": {"prey_policy": -1.0220516156148682, "predator_policy": 54.718113678530834}, "policy_reward_mean": {"prey_policy": -25.7531087720807, "predator_policy": 25.7531087720807}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [77, 79, 59, 77, 64, 36, 80, 55, 73, 54, 66, 18, 84, 54, 77, 90, 49, 63, 72, 67, 54, 20, 46, 53, 47, 70, 99, 54, 48, 58, 77, 30, 97, 81, 45, 76, 89, 84, 62, 95, 79, 70, 57, 38, 98, 61, 53, 91, 56, 11, 20, 74, 79, 44, 27, 5, 64, 46, 63, 52, 47, 69, 51, 66, 68, 61, 88, 28, 67, 52, 43, 59, 76, 49, 8, 58, 65, 29, 49, 77, 37, 86, 25, 69, 92, 54, 35, 97, 32, 58, 34, 54, 64, 76, 55, 63, 61, 81, 79, 68], "policy_prey_policy_reward": [-43.65273373518047, -30.75414745995796, -10.935793623130946, -40.92788811373639, -31.694870687715696, -8.001803977443325, -28.843228261593254, -12.903546973732933, -11.916155379767448, -40.04270328987801, -24.92789781848385, -6.9027292668987315, -54.718113678530834, -24.097945165967836, -27.069703077520654, -40.79317302914946, -8.470944797234633, -38.697253296605254, -42.26459668224361, -41.378030431672606, -24.79333611049818, -4.3528341069822485, -28.27386972709158, -12.481941448830964, -20.365764478231, -21.53345517530555, -39.871035000805904, -17.93194704168402, -16.36522239069383, -22.258705236959273, -32.63132050600287, -8.460096380619195, -23.914825111793427, -37.189023010374264, -28.922807986732764, -42.95681705574513, -41.84567962198628, -15.466699174630135, -33.7778938754959, -42.69731003505733, -10.763431300231971, -35.746856774850365, -28.210854394906775, -14.290690575354825, -41.76267279021833, -29.278170651724363, -25.851800036638565, -49.13947144950701, -21.00495303080282, -9.099735627602689, -10.278198587323184, -29.135574217065734, -40.127895101561144, -24.541922934908936, -17.698658409495184, -1.0220516156148682, -19.901594452788984, -15.477412381806941, -10.426844763801627, -36.22047953227968, -12.294535244992792, -33.465300247596076, -29.13581879835096, -17.238568889462094, -35.640742701523656, -36.404808843868416, -39.393440709729184, -18.14751421477187, -12.479614084442996, -18.659225538633628, -23.168310449767535, -28.556739929034897, -39.089523866772595, -9.30057832183201, -3.1492433491763516, -30.51399111931444, -23.091679789348262, -7.395117439037394, -7.1098305219178375, -43.89592772911014, -28.982058409940443, -39.58140805795293, -9.681086442513072, -22.708618454948027, -34.026453307650506, -36.558313602476154, -21.586759934548258, -45.40662930197925, -15.397748929184775, -11.920291960091728, -19.922838900744495, -22.331193447490634, -20.54005243002474, -19.535328512597435, -37.86544364357575, -26.05109615657447, -20.71317462942335, -50.51230513382937, -46.39181263737111, -22.40464067602281], "policy_predator_policy_reward": [43.65273373518047, 30.75414745995796, 10.935793623130946, 40.92788811373639, 31.694870687715696, 8.001803977443325, 28.843228261593254, 12.903546973732933, 11.916155379767448, 40.04270328987801, 24.92789781848385, 6.9027292668987315, 54.718113678530834, 24.097945165967836, 27.069703077520654, 40.79317302914946, 8.470944797234633, 38.697253296605254, 42.26459668224361, 41.378030431672606, 24.79333611049818, 4.3528341069822485, 28.27386972709158, 12.481941448830964, 20.365764478231, 21.53345517530555, 39.871035000805904, 17.93194704168402, 16.36522239069383, 22.258705236959273, 32.63132050600287, 8.460096380619195, 23.914825111793427, 37.189023010374264, 28.922807986732764, 42.95681705574513, 41.84567962198628, 15.466699174630135, 33.7778938754959, 42.69731003505733, 10.763431300231971, 35.746856774850365, 28.210854394906775, 14.290690575354825, 41.76267279021833, 29.278170651724363, 25.851800036638565, 49.13947144950701, 21.00495303080282, 9.099735627602689, 10.278198587323184, 29.135574217065734, 40.127895101561144, 24.541922934908936, 17.698658409495184, 1.0220516156148682, 19.901594452788984, 15.477412381806941, 10.426844763801627, 36.22047953227968, 12.294535244992792, 33.465300247596076, 29.13581879835096, 17.238568889462094, 35.640742701523656, 36.404808843868416, 39.393440709729184, 18.14751421477187, 12.479614084442996, 18.659225538633628, 23.168310449767535, 28.556739929034897, 39.089523866772595, 9.30057832183201, 3.1492433491763516, 30.51399111931444, 23.091679789348262, 7.395117439037394, 7.1098305219178375, 43.89592772911014, 28.982058409940443, 39.58140805795293, 9.681086442513072, 22.708618454948027, 34.026453307650506, 36.558313602476154, 21.586759934548258, 45.40662930197925, 15.397748929184775, 11.920291960091728, 19.922838900744495, 22.331193447490634, 20.54005243002474, 19.535328512597435, 37.86544364357575, 26.05109615657447, 20.71317462942335, 50.51230513382937, 46.39181263737111, 22.40464067602281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2943444130023509, "mean_inference_ms": 0.9378363229151714, "mean_action_processing_ms": 0.12565307085419022, "mean_env_wait_ms": 0.06615992231269435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029065608978271484, "StateBufferConnector_ms": 0.0020247697830200195, "ViewRequirementAgentConnector_ms": 0.052518606185913086}, "num_episodes": 66, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 680.764288369452, "num_env_steps_trained_throughput_per_sec": 680.764288369452, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 1432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1432000, "timers": {"training_iteration_time_ms": 6027.526, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6027.485, "sample_time_ms": 695.428, "learn_time_ms": 5319.024, "learn_throughput": 752.018, "synch_weights_time_ms": 12.664}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "done": false, "training_iteration": 179, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-44", "timestamp": 1723391324, "time_this_iter_s": 5.88148307800293, "time_total_s": 1066.9668080806732, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602e75e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1066.9668080806732, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 29.762500000000003, "ram_util_percent": 81.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.177942895516753, "cur_kl_coeff": 3.1763735522036256e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3719893417631586, "policy_loss": -0.002830376799101941, "vf_loss": 1.3748197157556812, "vf_explained_var": 0.9732731477667887, "kl": 0.005053951522519334, "entropy": 0.28043085159733894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3568737634768087, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3327473154291511, "policy_loss": -0.008520133403605239, "vf_loss": 1.3412333353733024, "vf_explained_var": 0.9744884061316649, "kl": 0.009704184630123909, "entropy": 0.6346730819592873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 59.74, "episode_media": {}, "episodes_this_iter": 67, "episodes_timesteps_total": 5974, "policy_reward_min": {"prey_policy": -52.23095847522872, "predator_policy": 1.070405293529621}, "policy_reward_max": {"prey_policy": -1.070405293529621, "predator_policy": 52.23095847522872}, "policy_reward_mean": {"prey_policy": -24.463869375560815, "predator_policy": 24.463869375560815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [28, 67, 52, 43, 59, 76, 49, 8, 58, 65, 29, 49, 77, 37, 86, 25, 69, 92, 54, 35, 97, 32, 58, 34, 54, 64, 76, 55, 63, 61, 81, 79, 68, 69, 85, 77, 89, 75, 43, 81, 32, 59, 36, 81, 84, 46, 69, 67, 25, 23, 22, 69, 55, 15, 39, 38, 75, 50, 71, 78, 123, 49, 35, 43, 81, 62, 30, 64, 62, 31, 66, 56, 83, 18, 77, 82, 63, 59, 100, 65, 91, 59, 70, 54, 57, 63, 56, 27, 60, 76, 83, 66, 92, 42, 67, 80, 31, 81, 100, 37], "policy_prey_policy_reward": [-18.14751421477187, -12.479614084442996, -18.659225538633628, -23.168310449767535, -28.556739929034897, -39.089523866772595, -9.30057832183201, -3.1492433491763516, -30.51399111931444, -23.091679789348262, -7.395117439037394, -7.1098305219178375, -43.89592772911014, -28.982058409940443, -39.58140805795293, -9.681086442513072, -22.708618454948027, -34.026453307650506, -36.558313602476154, -21.586759934548258, -45.40662930197925, -15.397748929184775, -11.920291960091728, -19.922838900744495, -22.331193447490634, -20.54005243002474, -19.535328512597435, -37.86544364357575, -26.05109615657447, -20.71317462942335, -50.51230513382937, -46.39181263737111, -22.40464067602281, -29.8742253113946, -37.74845176420877, -45.34346774543641, -48.26470384162175, -23.587409424700045, -28.124493623275463, -52.23095847522872, -7.03393204716328, -15.157942838882615, -19.4568844759135, -40.68415439767523, -42.00592555763897, -25.77043473196343, -24.230431289050415, -24.943226727580665, -13.864588652485875, -8.434917142501423, -3.474166482687821, -14.103762591461527, -11.78752008517646, -8.000953319479214, -9.12072821906198, -14.174318976049623, -6.8835170645884975, -24.15656522807977, -38.697271695257704, -21.548824662152686, -44.135879309971855, -16.283611317364667, -21.098116722027985, -13.333967434854944, -38.66381780210789, -16.003730273006376, -1.8680948384951512, -15.018190369950398, -24.028804717571898, -14.21202092507781, -35.35386295461313, -19.31722275631189, -27.028657403515677, -6.495633861033806, -46.79120842123521, -33.52673893336234, -31.758404933187713, -41.68094757394288, -19.551663860450777, -29.5379092700239, -33.11856835665783, -18.995815441538113, -18.787010869481023, -32.72487078896859, -10.251798174710371, -25.399129235194703, -18.118392175453618, -19.071650459900134, -24.738456924904558, -28.363722811977738, -29.210620985332284, -32.035641666265434, -40.752679253701686, -8.094865081502277, -19.230340051177336, -40.69562921505695, -1.070405293529621, -39.78852135104212, -35.63451430486636, -19.23749414389822], "policy_predator_policy_reward": [18.14751421477187, 12.479614084442996, 18.659225538633628, 23.168310449767535, 28.556739929034897, 39.089523866772595, 9.30057832183201, 3.1492433491763516, 30.51399111931444, 23.091679789348262, 7.395117439037394, 7.1098305219178375, 43.89592772911014, 28.982058409940443, 39.58140805795293, 9.681086442513072, 22.708618454948027, 34.026453307650506, 36.558313602476154, 21.586759934548258, 45.40662930197925, 15.397748929184775, 11.920291960091728, 19.922838900744495, 22.331193447490634, 20.54005243002474, 19.535328512597435, 37.86544364357575, 26.05109615657447, 20.71317462942335, 50.51230513382937, 46.39181263737111, 22.40464067602281, 29.8742253113946, 37.74845176420877, 45.34346774543641, 48.26470384162175, 23.587409424700045, 28.124493623275463, 52.23095847522872, 7.03393204716328, 15.157942838882615, 19.4568844759135, 40.68415439767523, 42.00592555763897, 25.77043473196343, 24.230431289050415, 24.943226727580665, 13.864588652485875, 8.434917142501423, 3.474166482687821, 14.103762591461527, 11.78752008517646, 8.000953319479214, 9.12072821906198, 14.174318976049623, 6.8835170645884975, 24.15656522807977, 38.697271695257704, 21.548824662152686, 44.135879309971855, 16.283611317364667, 21.098116722027985, 13.333967434854944, 38.66381780210789, 16.003730273006376, 1.8680948384951512, 15.018190369950398, 24.028804717571898, 14.21202092507781, 35.35386295461313, 19.31722275631189, 27.028657403515677, 6.495633861033806, 46.79120842123521, 33.52673893336234, 31.758404933187713, 41.68094757394288, 19.551663860450777, 29.5379092700239, 33.11856835665783, 18.995815441538113, 18.787010869481023, 32.72487078896859, 10.251798174710371, 25.399129235194703, 18.118392175453618, 19.071650459900134, 24.738456924904558, 28.363722811977738, 29.210620985332284, 32.035641666265434, 40.752679253701686, 8.094865081502277, 19.230340051177336, 40.69562921505695, 1.070405293529621, 39.78852135104212, 35.63451430486636, 19.23749414389822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2943099640781061, "mean_inference_ms": 0.9374127033596157, "mean_action_processing_ms": 0.1257000058387088, "mean_env_wait_ms": 0.066122549879701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002845168113708496, "StateBufferConnector_ms": 0.0020912885665893555, "ViewRequirementAgentConnector_ms": 0.050348877906799316}, "num_episodes": 67, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.1665506522305, "num_env_steps_trained_throughput_per_sec": 687.1665506522305, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 5968.159, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5968.121, "sample_time_ms": 677.506, "learn_time_ms": 5277.546, "learn_throughput": 757.928, "synch_weights_time_ms": 12.737}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 180, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-50", "timestamp": 1723391330, "time_this_iter_s": 5.825992822647095, "time_total_s": 1072.7928009033203, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1072.7928009033203, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 27.299999999999997, "ram_util_percent": 81.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2029309244205555, "cur_kl_coeff": 3.1763735522036256e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5231701032569012, "policy_loss": -0.001863130614704763, "vf_loss": 1.52503323238343, "vf_explained_var": 0.9656352504466971, "kl": 0.0031262270668515574, "entropy": 0.2988313241861761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.215675638243556, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.518729543251296, "policy_loss": -0.003859933708736207, "vf_loss": 1.5225628988817335, "vf_explained_var": 0.966357022151351, "kl": 0.007559853023988383, "entropy": 0.6034728410964211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.07, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6307, "policy_reward_min": {"prey_policy": -54.85391855003279, "predator_policy": 0.9940279911526138}, "policy_reward_max": {"prey_policy": -0.9940279911526138, "predator_policy": 54.85391855003279}, "policy_reward_mean": {"prey_policy": -25.031269106430884, "predator_policy": 25.031269106430884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [35, 43, 81, 62, 30, 64, 62, 31, 66, 56, 83, 18, 77, 82, 63, 59, 100, 65, 91, 59, 70, 54, 57, 63, 56, 27, 60, 76, 83, 66, 92, 42, 67, 80, 31, 81, 100, 37, 71, 40, 1, 63, 24, 59, 72, 43, 64, 51, 27, 80, 73, 59, 32, 73, 145, 22, 69, 65, 74, 59, 82, 70, 68, 72, 89, 54, 84, 78, 37, 57, 42, 84, 76, 65, 42, 59, 32, 66, 65, 61, 94, 75, 67, 75, 68, 65, 64, 31, 56, 86, 57, 49, 85, 86, 93, 51, 63, 80, 57, 87], "policy_prey_policy_reward": [-21.098116722027985, -13.333967434854944, -38.66381780210789, -16.003730273006376, -1.8680948384951512, -15.018190369950398, -24.028804717571898, -14.21202092507781, -35.35386295461313, -19.31722275631189, -27.028657403515677, -6.495633861033806, -46.79120842123521, -33.52673893336234, -31.758404933187713, -41.68094757394288, -19.551663860450777, -29.5379092700239, -33.11856835665783, -18.995815441538113, -18.787010869481023, -32.72487078896859, -10.251798174710371, -25.399129235194703, -18.118392175453618, -19.071650459900134, -24.738456924904558, -28.363722811977738, -29.210620985332284, -32.035641666265434, -40.752679253701686, -8.094865081502277, -19.230340051177336, -40.69562921505695, -1.070405293529621, -39.78852135104212, -35.63451430486636, -19.23749414389822, -37.00733932092611, -23.089638019529808, -0.9940279911526138, -31.813190243959774, -17.325649464582135, -35.92569065009166, -25.469206354353574, -21.59225166000382, -33.49895595029041, -42.37476247260607, -7.779984572477333, -22.989488297346092, -32.77680098715627, -25.760440659978737, -4.615653446249313, -26.234777353117632, -54.74473996818381, -7.718099807239009, -27.958413259912916, -20.256090123827526, -35.79636647908143, -7.099588323328131, -14.747149897682581, -45.814885570939374, -10.498578716926389, -34.66945602067131, -16.43645216558411, -20.14143618640511, -16.21861030024924, -43.92702578998524, -12.368192728779619, -22.262653084116486, -21.698786962116802, -36.88100038799315, -37.38853081064339, -19.80727179827976, -13.790363324722392, -20.700939710652424, -16.676797689427982, -29.372081399339034, -22.571310210546997, -32.865352456787576, -35.48015915128623, -9.155186855590804, -27.78823140294374, -28.95077155841817, -34.12595140194492, -9.419398266962686, -22.649446251728058, -16.146768850924964, -20.975959047285695, -47.7097370662735, -9.810025146583992, -20.696524089831833, -26.496991019252793, -37.787074778234874, -54.85391855003279, -19.310008637992127, -45.94786910350059, -16.402341259893873, -24.771670619373616, -32.40172733186084], "policy_predator_policy_reward": [21.098116722027985, 13.333967434854944, 38.66381780210789, 16.003730273006376, 1.8680948384951512, 15.018190369950398, 24.028804717571898, 14.21202092507781, 35.35386295461313, 19.31722275631189, 27.028657403515677, 6.495633861033806, 46.79120842123521, 33.52673893336234, 31.758404933187713, 41.68094757394288, 19.551663860450777, 29.5379092700239, 33.11856835665783, 18.995815441538113, 18.787010869481023, 32.72487078896859, 10.251798174710371, 25.399129235194703, 18.118392175453618, 19.071650459900134, 24.738456924904558, 28.363722811977738, 29.210620985332284, 32.035641666265434, 40.752679253701686, 8.094865081502277, 19.230340051177336, 40.69562921505695, 1.070405293529621, 39.78852135104212, 35.63451430486636, 19.23749414389822, 37.00733932092611, 23.089638019529808, 0.9940279911526138, 31.813190243959774, 17.325649464582135, 35.92569065009166, 25.469206354353574, 21.59225166000382, 33.49895595029041, 42.37476247260607, 7.779984572477333, 22.989488297346092, 32.77680098715627, 25.760440659978737, 4.615653446249313, 26.234777353117632, 54.74473996818381, 7.718099807239009, 27.958413259912916, 20.256090123827526, 35.79636647908143, 7.099588323328131, 14.747149897682581, 45.814885570939374, 10.498578716926389, 34.66945602067131, 16.43645216558411, 20.14143618640511, 16.21861030024924, 43.92702578998524, 12.368192728779619, 22.262653084116486, 21.698786962116802, 36.88100038799315, 37.38853081064339, 19.80727179827976, 13.790363324722392, 20.700939710652424, 16.676797689427982, 29.372081399339034, 22.571310210546997, 32.865352456787576, 35.48015915128623, 9.155186855590804, 27.78823140294374, 28.95077155841817, 34.12595140194492, 9.419398266962686, 22.649446251728058, 16.146768850924964, 20.975959047285695, 47.7097370662735, 9.810025146583992, 20.696524089831833, 26.496991019252793, 37.787074778234874, 54.85391855003279, 19.310008637992127, 45.94786910350059, 16.402341259893873, 24.771670619373616, 32.40172733186084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29418487129013576, "mean_inference_ms": 0.9371075353337378, "mean_action_processing_ms": 0.12563474445138356, "mean_env_wait_ms": 0.06609499210671299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002779841423034668, "StateBufferConnector_ms": 0.0021239519119262695, "ViewRequirementAgentConnector_ms": 0.04703104496002197}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 674.8913558379503, "num_env_steps_trained_throughput_per_sec": 674.8913558379503, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 1448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1448000, "timers": {"training_iteration_time_ms": 5962.966, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5962.929, "sample_time_ms": 673.684, "learn_time_ms": 5276.194, "learn_throughput": 758.122, "synch_weights_time_ms": 12.721}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "done": false, "training_iteration": 181, "trial_id": "abfb9_00000", "date": "2024-08-11_11-48-56", "timestamp": 1723391336, "time_this_iter_s": 5.93236517906189, "time_total_s": 1078.7251660823822, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602e7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1078.7251660823822, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 26.37777777777778, "ram_util_percent": 81.82222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2122375754018626, "cur_kl_coeff": 1.5881867761018128e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6253870458652575, "policy_loss": -0.000142823045704669, "vf_loss": 1.6255298658894997, "vf_explained_var": 0.9647138775015871, "kl": 0.003023884663012133, "entropy": 0.28034138252648216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.310510664929946, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6318155580510696, "policy_loss": -0.010431915831577498, "vf_loss": 1.6421884263555209, "vf_explained_var": 0.9645180165146788, "kl": 0.016796288000144464, "entropy": 0.63293417605261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.21, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6421, "policy_reward_min": {"prey_policy": -55.76908084805739, "predator_policy": 1.9716006442307998}, "policy_reward_max": {"prey_policy": -1.9716006442307998, "predator_policy": 55.76908084805739}, "policy_reward_mean": {"prey_policy": -26.21124240819072, "predator_policy": 26.21124240819072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [72, 89, 54, 84, 78, 37, 57, 42, 84, 76, 65, 42, 59, 32, 66, 65, 61, 94, 75, 67, 75, 68, 65, 64, 31, 56, 86, 57, 49, 85, 86, 93, 51, 63, 80, 57, 87, 76, 60, 80, 93, 46, 67, 86, 90, 85, 11, 94, 79, 49, 56, 73, 89, 26, 98, 53, 58, 42, 40, 35, 16, 84, 54, 70, 32, 32, 79, 60, 72, 40, 64, 74, 79, 59, 71, 93, 60, 52, 66, 30, 75, 83, 72, 58, 85, 37, 79, 66, 65, 77, 140, 21, 5, 61, 52, 96, 74, 54, 56, 40], "policy_prey_policy_reward": [-34.66945602067131, -16.43645216558411, -20.14143618640511, -16.21861030024924, -43.92702578998524, -12.368192728779619, -22.262653084116486, -21.698786962116802, -36.88100038799315, -37.38853081064339, -19.80727179827976, -13.790363324722392, -20.700939710652424, -16.676797689427982, -29.372081399339034, -22.571310210546997, -32.865352456787576, -35.48015915128623, -9.155186855590804, -27.78823140294374, -28.95077155841817, -34.12595140194492, -9.419398266962686, -22.649446251728058, -16.146768850924964, -20.975959047285695, -47.7097370662735, -9.810025146583992, -20.696524089831833, -26.496991019252793, -37.787074778234874, -54.85391855003279, -19.310008637992127, -45.94786910350059, -16.402341259893873, -24.771670619373616, -32.40172733186084, -20.660997047171644, -21.180518285147805, -39.031004974507965, -55.76908084805739, -26.235908698528924, -44.04234671594605, -41.528676597595364, -41.09549484151668, -28.553259630880085, -8.058461816707457, -16.356331600147513, -24.592912273785835, -23.788075438236934, -38.21902340048801, -19.959627227518226, -33.448363145124496, -2.421418845831586, -31.927974558276944, -15.924857363966256, -26.422053207034214, -5.836347093427177, -17.97761243114542, -26.771027337861973, -6.048325249135951, -35.04186582203969, -22.76083441248097, -37.891971903953454, -8.5102754236745, -12.829961093300724, -42.701297027274464, -30.13668920389057, -16.133692652702706, -11.37717196420766, -33.312178003024144, -22.391008476883016, -43.371803863692215, -23.32050548829968, -46.04218407823396, -43.800331307518285, -31.679269472628885, -28.575040690865944, -20.023882237645225, -5.025133499918188, -26.045635824220454, -37.62431680860463, -11.354380127346863, -26.214355849618588, -36.22899637202546, -10.952746228078036, -8.849740923611815, -25.556131779618674, -18.452995060176736, -32.881536076254655, -39.43311420089682, -14.883309156602133, -1.9716006442307998, -14.694916529425926, -34.12561272353373, -42.2993859992692, -44.05793917142349, -42.24093686199804, -27.777971948476036, -36.04780186716876], "policy_predator_policy_reward": [34.66945602067131, 16.43645216558411, 20.14143618640511, 16.21861030024924, 43.92702578998524, 12.368192728779619, 22.262653084116486, 21.698786962116802, 36.88100038799315, 37.38853081064339, 19.80727179827976, 13.790363324722392, 20.700939710652424, 16.676797689427982, 29.372081399339034, 22.571310210546997, 32.865352456787576, 35.48015915128623, 9.155186855590804, 27.78823140294374, 28.95077155841817, 34.12595140194492, 9.419398266962686, 22.649446251728058, 16.146768850924964, 20.975959047285695, 47.7097370662735, 9.810025146583992, 20.696524089831833, 26.496991019252793, 37.787074778234874, 54.85391855003279, 19.310008637992127, 45.94786910350059, 16.402341259893873, 24.771670619373616, 32.40172733186084, 20.660997047171644, 21.180518285147805, 39.031004974507965, 55.76908084805739, 26.235908698528924, 44.04234671594605, 41.528676597595364, 41.09549484151668, 28.553259630880085, 8.058461816707457, 16.356331600147513, 24.592912273785835, 23.788075438236934, 38.21902340048801, 19.959627227518226, 33.448363145124496, 2.421418845831586, 31.927974558276944, 15.924857363966256, 26.422053207034214, 5.836347093427177, 17.97761243114542, 26.771027337861973, 6.048325249135951, 35.04186582203969, 22.76083441248097, 37.891971903953454, 8.5102754236745, 12.829961093300724, 42.701297027274464, 30.13668920389057, 16.133692652702706, 11.37717196420766, 33.312178003024144, 22.391008476883016, 43.371803863692215, 23.32050548829968, 46.04218407823396, 43.800331307518285, 31.679269472628885, 28.575040690865944, 20.023882237645225, 5.025133499918188, 26.045635824220454, 37.62431680860463, 11.354380127346863, 26.214355849618588, 36.22899637202546, 10.952746228078036, 8.849740923611815, 25.556131779618674, 18.452995060176736, 32.881536076254655, 39.43311420089682, 14.883309156602133, 1.9716006442307998, 14.694916529425926, 34.12561272353373, 42.2993859992692, 44.05793917142349, 42.24093686199804, 27.777971948476036, 36.04780186716876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.294043453224525, "mean_inference_ms": 0.9368030385731316, "mean_action_processing_ms": 0.12559539288039895, "mean_env_wait_ms": 0.06610948606776977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00281679630279541, "StateBufferConnector_ms": 0.0020515918731689453, "ViewRequirementAgentConnector_ms": 0.045795559883117676}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 678.3807445699913, "num_env_steps_trained_throughput_per_sec": 678.3807445699913, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 5948.454, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5948.417, "sample_time_ms": 669.592, "learn_time_ms": 5265.61, "learn_throughput": 759.646, "synch_weights_time_ms": 12.885}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 182, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-02", "timestamp": 1723391342, "time_this_iter_s": 5.901856184005737, "time_total_s": 1084.627022266388, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1084.627022266388, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 27.275000000000002, "ram_util_percent": 81.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2499702513217925, "cur_kl_coeff": 7.940933880509064e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4486163667713603, "policy_loss": -0.002435986544636156, "vf_loss": 1.451052348377804, "vf_explained_var": 0.9673806513970097, "kl": 0.00966169476728179, "entropy": 0.2999469612569859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.410402692357699, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4636128640423218, "policy_loss": -0.010109489422029582, "vf_loss": 1.473662741171817, "vf_explained_var": 0.9666013191764553, "kl": 0.016955735327056336, "entropy": 0.6201044021795193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 62.81, "episode_media": {}, "episodes_this_iter": 65, "episodes_timesteps_total": 6281, "policy_reward_min": {"prey_policy": -52.81924326344839, "predator_policy": 1.9716006442307998}, "policy_reward_max": {"prey_policy": -1.9716006442307998, "predator_policy": 52.81924326344839}, "policy_reward_mean": {"prey_policy": -25.925259033152244, "predator_policy": 25.925259033152244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [32, 79, 60, 72, 40, 64, 74, 79, 59, 71, 93, 60, 52, 66, 30, 75, 83, 72, 58, 85, 37, 79, 66, 65, 77, 140, 21, 5, 61, 52, 96, 74, 54, 56, 40, 86, 58, 64, 86, 40, 28, 80, 47, 63, 67, 64, 57, 79, 80, 47, 37, 61, 57, 18, 77, 87, 62, 87, 67, 80, 54, 72, 46, 61, 59, 88, 23, 31, 58, 61, 26, 94, 67, 84, 83, 81, 51, 54, 59, 59, 57, 76, 69, 66, 56, 51, 60, 81, 87, 46, 57, 80, 37, 84, 79, 2, 70, 61, 75, 70], "policy_prey_policy_reward": [-12.829961093300724, -42.701297027274464, -30.13668920389057, -16.133692652702706, -11.37717196420766, -33.312178003024144, -22.391008476883016, -43.371803863692215, -23.32050548829968, -46.04218407823396, -43.800331307518285, -31.679269472628885, -28.575040690865944, -20.023882237645225, -5.025133499918188, -26.045635824220454, -37.62431680860463, -11.354380127346863, -26.214355849618588, -36.22899637202546, -10.952746228078036, -8.849740923611815, -25.556131779618674, -18.452995060176736, -32.881536076254655, -39.43311420089682, -14.883309156602133, -1.9716006442307998, -14.694916529425926, -34.12561272353373, -42.2993859992692, -44.05793917142349, -42.24093686199804, -27.777971948476036, -36.04780186716876, -27.494542743590063, -28.833933284392803, -24.274910077267293, -27.32064339793417, -12.691235441430628, -12.776596288621004, -39.34032858686286, -24.20929308452674, -34.67677150681416, -23.405778446887673, -23.929945889948435, -35.30866651041207, -28.049492873630008, -38.95073912116757, -26.341865138557782, -22.506476801026164, -39.78859592415974, -37.58621306351786, -8.837525571382713, -14.863313919545194, -42.15094942582889, -45.80135609819956, -37.34606538656317, -27.79531943264061, -32.28493843163384, -17.510818208871406, -30.599981046274777, -6.843486224578541, -30.124164608866263, -27.68671829601141, -7.043911752435569, -12.992327946802153, -3.446830375744168, -21.30155247145896, -7.918473777380118, -7.006197858237123, -11.003342659304664, -35.253261161313404, -47.62365123688808, -21.779614339963455, -14.495149750312144, -17.97440890433494, -23.375830735709883, -33.96079110802519, -23.516865599037995, -18.217071465905466, -17.510073428077888, -22.88272781201378, -45.21603099169251, -29.71050800599316, -32.403868340461415, -4.976379661841908, -52.81924326344839, -33.43685792106589, -21.620413325309627, -25.136669354165093, -36.21114501250607, -25.155910995454825, -29.25135864850336, -40.16673064947954, -2.12859459439079, -31.690982011001473, -26.981826803107914, -21.28724716503375, -15.28581614501346], "policy_predator_policy_reward": [12.829961093300724, 42.701297027274464, 30.13668920389057, 16.133692652702706, 11.37717196420766, 33.312178003024144, 22.391008476883016, 43.371803863692215, 23.32050548829968, 46.04218407823396, 43.800331307518285, 31.679269472628885, 28.575040690865944, 20.023882237645225, 5.025133499918188, 26.045635824220454, 37.62431680860463, 11.354380127346863, 26.214355849618588, 36.22899637202546, 10.952746228078036, 8.849740923611815, 25.556131779618674, 18.452995060176736, 32.881536076254655, 39.43311420089682, 14.883309156602133, 1.9716006442307998, 14.694916529425926, 34.12561272353373, 42.2993859992692, 44.05793917142349, 42.24093686199804, 27.777971948476036, 36.04780186716876, 27.494542743590063, 28.833933284392803, 24.274910077267293, 27.32064339793417, 12.691235441430628, 12.776596288621004, 39.34032858686286, 24.20929308452674, 34.67677150681416, 23.405778446887673, 23.929945889948435, 35.30866651041207, 28.049492873630008, 38.95073912116757, 26.341865138557782, 22.506476801026164, 39.78859592415974, 37.58621306351786, 8.837525571382713, 14.863313919545194, 42.15094942582889, 45.80135609819956, 37.34606538656317, 27.79531943264061, 32.28493843163384, 17.510818208871406, 30.599981046274777, 6.843486224578541, 30.124164608866263, 27.68671829601141, 7.043911752435569, 12.992327946802153, 3.446830375744168, 21.30155247145896, 7.918473777380118, 7.006197858237123, 11.003342659304664, 35.253261161313404, 47.62365123688808, 21.779614339963455, 14.495149750312144, 17.97440890433494, 23.375830735709883, 33.96079110802519, 23.516865599037995, 18.217071465905466, 17.510073428077888, 22.88272781201378, 45.21603099169251, 29.71050800599316, 32.403868340461415, 4.976379661841908, 52.81924326344839, 33.43685792106589, 21.620413325309627, 25.136669354165093, 36.21114501250607, 25.155910995454825, 29.25135864850336, 40.16673064947954, 2.12859459439079, 31.690982011001473, 26.981826803107914, 21.28724716503375, 15.28581614501346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940714799603943, "mean_inference_ms": 0.9364346812411293, "mean_action_processing_ms": 0.1255630803026397, "mean_env_wait_ms": 0.06601615990009563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00295412540435791, "StateBufferConnector_ms": 0.00205838680267334, "ViewRequirementAgentConnector_ms": 0.04639744758605957}, "num_episodes": 65, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.3171396275766, "num_env_steps_trained_throughput_per_sec": 685.3171396275766, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 5951.552, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5951.516, "sample_time_ms": 671.292, "learn_time_ms": 5267.069, "learn_throughput": 759.436, "synch_weights_time_ms": 12.827}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 183, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-08", "timestamp": 1723391348, "time_this_iter_s": 5.842212915420532, "time_total_s": 1090.4692351818085, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602bf9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1090.4692351818085, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 29.15, "ram_util_percent": 81.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1773215615501007, "cur_kl_coeff": 7.940933880509064e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4361531933303922, "policy_loss": -0.0024530161346774547, "vf_loss": 1.4386062133746842, "vf_explained_var": 0.9669886738061905, "kl": 0.005115469065827724, "entropy": 0.36720097955937187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3056196942925453, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4529964450746775, "policy_loss": -0.007649203479619852, "vf_loss": 1.460600951500237, "vf_explained_var": 0.9666401293128729, "kl": 0.012713880804630337, "entropy": 0.5971463197842241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.3, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6730, "policy_reward_min": {"prey_policy": -56.96116019777788, "predator_policy": 2.12859459439079}, "policy_reward_max": {"prey_policy": -2.12859459439079, "predator_policy": 56.96116019777788}, "policy_reward_mean": {"prey_policy": -23.979435950731414, "predator_policy": 23.979435950731414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [80, 54, 72, 46, 61, 59, 88, 23, 31, 58, 61, 26, 94, 67, 84, 83, 81, 51, 54, 59, 59, 57, 76, 69, 66, 56, 51, 60, 81, 87, 46, 57, 80, 37, 84, 79, 2, 70, 61, 75, 70, 60, 62, 171, 80, 20, 64, 94, 47, 38, 59, 96, 121, 79, 66, 56, 63, 83, 66, 61, 22, 58, 90, 89, 79, 76, 66, 87, 72, 70, 64, 33, 75, 81, 77, 59, 61, 62, 39, 115, 62, 67, 38, 46, 55, 97, 69, 67, 50, 76, 34, 78, 116, 53, 92, 88, 71, 64, 36, 155], "policy_prey_policy_reward": [-32.28493843163384, -17.510818208871406, -30.599981046274777, -6.843486224578541, -30.124164608866263, -27.68671829601141, -7.043911752435569, -12.992327946802153, -3.446830375744168, -21.30155247145896, -7.918473777380118, -7.006197858237123, -11.003342659304664, -35.253261161313404, -47.62365123688808, -21.779614339963455, -14.495149750312144, -17.97440890433494, -23.375830735709883, -33.96079110802519, -23.516865599037995, -18.217071465905466, -17.510073428077888, -22.88272781201378, -45.21603099169251, -29.71050800599316, -32.403868340461415, -4.976379661841908, -52.81924326344839, -33.43685792106589, -21.620413325309627, -25.136669354165093, -36.21114501250607, -25.155910995454825, -29.25135864850336, -40.16673064947954, -2.12859459439079, -31.690982011001473, -26.981826803107914, -21.28724716503375, -15.28581614501346, -25.731380418712483, -36.2585629311613, -32.45063063751085, -43.768772269184154, -5.154216714662564, -9.22666266809456, -56.22078832010489, -13.56348584545993, -15.691465461592825, -19.32846956588699, -22.161824114472214, -53.57859696233497, -19.035358993506165, -14.135170403672118, -18.550396928075294, -25.524221814312785, -35.57491010497152, -24.76529276248297, -21.185533649408594, -9.386899894840823, -35.98835290399468, -20.399626369239318, -28.202939945670664, -3.819817279654031, -18.00995042174182, -20.503155863974083, -24.6228735690517, -12.676711932234394, -42.56185175881924, -16.615653654333443, -14.901466689555697, -21.061293659633165, -22.731528394660135, -31.3523470590755, -16.580341757357182, -34.17410273091402, -13.62114915878265, -18.24827790028024, -45.775144723847816, -34.61468150002224, -38.76384019307953, -18.160350600882534, -18.34497473214483, -11.280350657794441, -32.16114561023403, -28.039732799756752, -10.526312051149288, -9.087996885053979, -10.416992377652202, -3.8528361267852778, -35.2316275657465, -56.96116019777788, -21.619986977216914, -42.0978925283867, -24.69950510069995, -22.989781797571254, -20.78667788825209, -13.367207071309846, -35.96954409070753], "policy_predator_policy_reward": [32.28493843163384, 17.510818208871406, 30.599981046274777, 6.843486224578541, 30.124164608866263, 27.68671829601141, 7.043911752435569, 12.992327946802153, 3.446830375744168, 21.30155247145896, 7.918473777380118, 7.006197858237123, 11.003342659304664, 35.253261161313404, 47.62365123688808, 21.779614339963455, 14.495149750312144, 17.97440890433494, 23.375830735709883, 33.96079110802519, 23.516865599037995, 18.217071465905466, 17.510073428077888, 22.88272781201378, 45.21603099169251, 29.71050800599316, 32.403868340461415, 4.976379661841908, 52.81924326344839, 33.43685792106589, 21.620413325309627, 25.136669354165093, 36.21114501250607, 25.155910995454825, 29.25135864850336, 40.16673064947954, 2.12859459439079, 31.690982011001473, 26.981826803107914, 21.28724716503375, 15.28581614501346, 25.731380418712483, 36.2585629311613, 32.45063063751085, 43.768772269184154, 5.154216714662564, 9.22666266809456, 56.22078832010489, 13.56348584545993, 15.691465461592825, 19.32846956588699, 22.161824114472214, 53.57859696233497, 19.035358993506165, 14.135170403672118, 18.550396928075294, 25.524221814312785, 35.57491010497152, 24.76529276248297, 21.185533649408594, 9.386899894840823, 35.98835290399468, 20.399626369239318, 28.202939945670664, 3.819817279654031, 18.00995042174182, 20.503155863974083, 24.6228735690517, 12.676711932234394, 42.56185175881924, 16.615653654333443, 14.901466689555697, 21.061293659633165, 22.731528394660135, 31.3523470590755, 16.580341757357182, 34.17410273091402, 13.62114915878265, 18.24827790028024, 45.775144723847816, 34.61468150002224, 38.76384019307953, 18.160350600882534, 18.34497473214483, 11.280350657794441, 32.16114561023403, 28.039732799756752, 10.526312051149288, 9.087996885053979, 10.416992377652202, 3.8528361267852778, 35.2316275657465, 56.96116019777788, 21.619986977216914, 42.0978925283867, 24.69950510069995, 22.989781797571254, 20.78667788825209, 13.367207071309846, 35.96954409070753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2938830903057198, "mean_inference_ms": 0.9362791260505383, "mean_action_processing_ms": 0.125514092225242, "mean_env_wait_ms": 0.06603344959862746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027691125869750977, "StateBufferConnector_ms": 0.001966238021850586, "ViewRequirementAgentConnector_ms": 0.0469592809677124}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 691.3733687082928, "num_env_steps_trained_throughput_per_sec": 691.3733687082928, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 5924.13, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5924.094, "sample_time_ms": 669.0, "learn_time_ms": 5241.703, "learn_throughput": 763.111, "synch_weights_time_ms": 13.045}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 184, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-13", "timestamp": 1723391353, "time_this_iter_s": 5.791332960128784, "time_total_s": 1096.2605681419373, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1096.2605681419373, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 25.6, "ram_util_percent": 81.83333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1918982315808533, "cur_kl_coeff": 7.940933880509064e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7214904878288508, "policy_loss": -0.0016491343085363042, "vf_loss": 1.723139618585507, "vf_explained_var": 0.9588609614099065, "kl": 0.00432653294066511, "entropy": 0.3567776177233706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.281093870475888, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6863472554211816, "policy_loss": -0.010140090049147451, "vf_loss": 1.6964381234099468, "vf_explained_var": 0.9591342525556683, "kl": 0.014001392023028515, "entropy": 0.6217933495839437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.14, "episode_media": {}, "episodes_this_iter": 56, "episodes_timesteps_total": 6914, "policy_reward_min": {"prey_policy": -56.96116019777788, "predator_policy": 1.4127652151202943}, "policy_reward_max": {"prey_policy": -1.4127652151202943, "predator_policy": 56.96116019777788}, "policy_reward_mean": {"prey_policy": -24.301806634170717, "predator_policy": 24.301806634170717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [63, 83, 66, 61, 22, 58, 90, 89, 79, 76, 66, 87, 72, 70, 64, 33, 75, 81, 77, 59, 61, 62, 39, 115, 62, 67, 38, 46, 55, 97, 69, 67, 50, 76, 34, 78, 116, 53, 92, 88, 71, 64, 36, 155, 80, 70, 41, 64, 31, 73, 75, 82, 27, 96, 31, 81, 84, 71, 83, 90, 17, 42, 82, 29, 80, 76, 61, 45, 91, 55, 76, 35, 79, 70, 88, 62, 105, 104, 69, 26, 56, 65, 44, 101, 73, 74, 41, 47, 115, 83, 172, 94, 91, 50, 13, 57, 85, 71, 78, 71], "policy_prey_policy_reward": [-25.524221814312785, -35.57491010497152, -24.76529276248297, -21.185533649408594, -9.386899894840823, -35.98835290399468, -20.399626369239318, -28.202939945670664, -3.819817279654031, -18.00995042174182, -20.503155863974083, -24.6228735690517, -12.676711932234394, -42.56185175881924, -16.615653654333443, -14.901466689555697, -21.061293659633165, -22.731528394660135, -31.3523470590755, -16.580341757357182, -34.17410273091402, -13.62114915878265, -18.24827790028024, -45.775144723847816, -34.61468150002224, -38.76384019307953, -18.160350600882534, -18.34497473214483, -11.280350657794441, -32.16114561023403, -28.039732799756752, -10.526312051149288, -9.087996885053979, -10.416992377652202, -3.8528361267852778, -35.2316275657465, -56.96116019777788, -21.619986977216914, -42.0978925283867, -24.69950510069995, -22.989781797571254, -20.78667788825209, -13.367207071309846, -35.96954409070753, -44.105075064398406, -33.71490732672578, -23.550307306942404, -13.03691328196986, -15.622551971914424, -23.012551348810156, -9.675630756578727, -26.49994697639686, -5.9164233023624995, -36.300980836291615, -7.019252877034703, -31.67238243150816, -41.88424722616753, -39.64645113418943, -21.233717253589177, -23.459890198945562, -3.818024454412556, -24.432749963517537, -44.71717734201944, -13.868332296152873, -9.328605077467088, -44.827041865983105, -21.239980202607416, -16.2666536602777, -36.68979215803065, -18.01498939433228, -7.927210529865285, -14.059169861456128, -51.97232347654707, -37.43885327779743, -21.146813151829196, -20.752827915339296, -39.2218918827996, -16.289086943340212, -10.616416607362199, -3.87870029337679, -14.015842596731229, -13.298971944144753, -6.624193104444796, -51.58897760027158, -14.12419062533902, -38.563395836891914, -26.40076241587727, -3.948771919435742, -48.370220667232495, -28.51576561240764, -40.332541965435794, -38.48231049352048, -42.974674860061484, -19.217407806811188, -1.4127652151202943, -24.389048890094703, -22.648234628270803, -45.019480833445456, -28.801825414760334, -21.33737058737502], "policy_predator_policy_reward": [25.524221814312785, 35.57491010497152, 24.76529276248297, 21.185533649408594, 9.386899894840823, 35.98835290399468, 20.399626369239318, 28.202939945670664, 3.819817279654031, 18.00995042174182, 20.503155863974083, 24.6228735690517, 12.676711932234394, 42.56185175881924, 16.615653654333443, 14.901466689555697, 21.061293659633165, 22.731528394660135, 31.3523470590755, 16.580341757357182, 34.17410273091402, 13.62114915878265, 18.24827790028024, 45.775144723847816, 34.61468150002224, 38.76384019307953, 18.160350600882534, 18.34497473214483, 11.280350657794441, 32.16114561023403, 28.039732799756752, 10.526312051149288, 9.087996885053979, 10.416992377652202, 3.8528361267852778, 35.2316275657465, 56.96116019777788, 21.619986977216914, 42.0978925283867, 24.69950510069995, 22.989781797571254, 20.78667788825209, 13.367207071309846, 35.96954409070753, 44.105075064398406, 33.71490732672578, 23.550307306942404, 13.03691328196986, 15.622551971914424, 23.012551348810156, 9.675630756578727, 26.49994697639686, 5.9164233023624995, 36.300980836291615, 7.019252877034703, 31.67238243150816, 41.88424722616753, 39.64645113418943, 21.233717253589177, 23.459890198945562, 3.818024454412556, 24.432749963517537, 44.71717734201944, 13.868332296152873, 9.328605077467088, 44.827041865983105, 21.239980202607416, 16.2666536602777, 36.68979215803065, 18.01498939433228, 7.927210529865285, 14.059169861456128, 51.97232347654707, 37.43885327779743, 21.146813151829196, 20.752827915339296, 39.2218918827996, 16.289086943340212, 10.616416607362199, 3.87870029337679, 14.015842596731229, 13.298971944144753, 6.624193104444796, 51.58897760027158, 14.12419062533902, 38.563395836891914, 26.40076241587727, 3.948771919435742, 48.370220667232495, 28.51576561240764, 40.332541965435794, 38.48231049352048, 42.974674860061484, 19.217407806811188, 1.4127652151202943, 24.389048890094703, 22.648234628270803, 45.019480833445456, 28.801825414760334, 21.33737058737502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2937735848129431, "mean_inference_ms": 0.9358561581617463, "mean_action_processing_ms": 0.12554990342047204, "mean_env_wait_ms": 0.06604271454131966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002730846405029297, "StateBufferConnector_ms": 0.002282381057739258, "ViewRequirementAgentConnector_ms": 0.04968535900115967}, "num_episodes": 56, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.4815198399915, "num_env_steps_trained_throughput_per_sec": 673.4815198399915, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 5925.979, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5925.943, "sample_time_ms": 670.516, "learn_time_ms": 5241.745, "learn_throughput": 763.105, "synch_weights_time_ms": 13.334}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 185, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-19", "timestamp": 1723391359, "time_this_iter_s": 5.944738149642944, "time_total_s": 1102.2053062915802, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602e7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1102.2053062915802, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 27.987499999999997, "ram_util_percent": 81.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2432872566084066, "cur_kl_coeff": 3.970466940254532e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4151914247932533, "policy_loss": -0.0025470437552333656, "vf_loss": 1.4177384668340285, "vf_explained_var": 0.9704255764062206, "kl": 0.004199643636893969, "entropy": 0.3196306723325203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.369830811396241, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.440147211464743, "policy_loss": -0.005935531894404752, "vf_loss": 1.446049463438491, "vf_explained_var": 0.9694995841011405, "kl": 0.009465437390902309, "entropy": 0.6152543928474188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 69.52, "episode_media": {}, "episodes_this_iter": 58, "episodes_timesteps_total": 6952, "policy_reward_min": {"prey_policy": -53.51326848997899, "predator_policy": 1.4127652151202943}, "policy_reward_max": {"prey_policy": -1.4127652151202943, "predator_policy": 53.51326848997899}, "policy_reward_mean": {"prey_policy": -25.215400052370768, "predator_policy": 25.215400052370768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [83, 90, 17, 42, 82, 29, 80, 76, 61, 45, 91, 55, 76, 35, 79, 70, 88, 62, 105, 104, 69, 26, 56, 65, 44, 101, 73, 74, 41, 47, 115, 83, 172, 94, 91, 50, 13, 57, 85, 71, 78, 71, 92, 154, 100, 82, 82, 59, 38, 36, 49, 64, 74, 72, 92, 39, 34, 78, 177, 85, 45, 41, 76, 61, 86, 92, 27, 84, 43, 72, 40, 65, 65, 72, 148, 72, 65, 41, 56, 37, 47, 85, 26, 52, 46, 75, 93, 90, 87, 47, 79, 67, 47, 82, 64, 77, 29, 76, 74, 68], "policy_prey_policy_reward": [-21.233717253589177, -23.459890198945562, -3.818024454412556, -24.432749963517537, -44.71717734201944, -13.868332296152873, -9.328605077467088, -44.827041865983105, -21.239980202607416, -16.2666536602777, -36.68979215803065, -18.01498939433228, -7.927210529865285, -14.059169861456128, -51.97232347654707, -37.43885327779743, -21.146813151829196, -20.752827915339296, -39.2218918827996, -16.289086943340212, -10.616416607362199, -3.87870029337679, -14.015842596731229, -13.298971944144753, -6.624193104444796, -51.58897760027158, -14.12419062533902, -38.563395836891914, -26.40076241587727, -3.948771919435742, -48.370220667232495, -28.51576561240764, -40.332541965435794, -38.48231049352048, -42.974674860061484, -19.217407806811188, -1.4127652151202943, -24.389048890094703, -22.648234628270803, -45.019480833445456, -28.801825414760334, -21.33737058737502, -40.01394741560472, -22.25918083059547, -43.476912788012385, -33.95956033479103, -16.678421174076853, -27.422436108303444, -14.072461556627257, -13.680705839361345, -30.3850828227359, -9.138221268815045, -29.53199091961081, -44.36836015868801, -31.644786760355288, -25.229295126025256, -24.018996716903207, -34.51141767270128, -29.9332288153184, -39.59420567847228, -25.381625167431842, -35.31167588831324, -42.617252285088064, -8.375833724549054, -34.1730107022256, -37.83849689136438, -12.093770864158904, -22.446991234131552, -22.37670777854078, -20.884691697095455, -11.063446736486737, -14.453023224899379, -4.2146839443137845, -21.777075222462972, -20.888566522539286, -44.161032787911935, -46.69982686378003, -11.44177073174898, -19.40900775686953, -24.392379214026416, -12.303371728649052, -43.52401690694075, -10.337424334306785, -33.967978473428, -31.808848161041023, -8.526447499188098, -53.51326848997899, -22.200643548109365, -37.72290940351351, -18.843617304419464, -16.394991056259954, -16.996308813038834, -10.908079274494321, -21.81426020550546, -37.6178162238184, -33.534244367994944, -14.142742927221825, -20.015758294116843, -26.278171862492098, -29.902024312902935], "policy_predator_policy_reward": [21.233717253589177, 23.459890198945562, 3.818024454412556, 24.432749963517537, 44.71717734201944, 13.868332296152873, 9.328605077467088, 44.827041865983105, 21.239980202607416, 16.2666536602777, 36.68979215803065, 18.01498939433228, 7.927210529865285, 14.059169861456128, 51.97232347654707, 37.43885327779743, 21.146813151829196, 20.752827915339296, 39.2218918827996, 16.289086943340212, 10.616416607362199, 3.87870029337679, 14.015842596731229, 13.298971944144753, 6.624193104444796, 51.58897760027158, 14.12419062533902, 38.563395836891914, 26.40076241587727, 3.948771919435742, 48.370220667232495, 28.51576561240764, 40.332541965435794, 38.48231049352048, 42.974674860061484, 19.217407806811188, 1.4127652151202943, 24.389048890094703, 22.648234628270803, 45.019480833445456, 28.801825414760334, 21.33737058737502, 40.01394741560472, 22.25918083059547, 43.476912788012385, 33.95956033479103, 16.678421174076853, 27.422436108303444, 14.072461556627257, 13.680705839361345, 30.3850828227359, 9.138221268815045, 29.53199091961081, 44.36836015868801, 31.644786760355288, 25.229295126025256, 24.018996716903207, 34.51141767270128, 29.9332288153184, 39.59420567847228, 25.381625167431842, 35.31167588831324, 42.617252285088064, 8.375833724549054, 34.1730107022256, 37.83849689136438, 12.093770864158904, 22.446991234131552, 22.37670777854078, 20.884691697095455, 11.063446736486737, 14.453023224899379, 4.2146839443137845, 21.777075222462972, 20.888566522539286, 44.161032787911935, 46.69982686378003, 11.44177073174898, 19.40900775686953, 24.392379214026416, 12.303371728649052, 43.52401690694075, 10.337424334306785, 33.967978473428, 31.808848161041023, 8.526447499188098, 53.51326848997899, 22.200643548109365, 37.72290940351351, 18.843617304419464, 16.394991056259954, 16.996308813038834, 10.908079274494321, 21.81426020550546, 37.6178162238184, 33.534244367994944, 14.142742927221825, 20.015758294116843, 26.278171862492098, 29.902024312902935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29370148486106556, "mean_inference_ms": 0.9356761298804591, "mean_action_processing_ms": 0.1256066422114427, "mean_env_wait_ms": 0.06608098573165484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002669215202331543, "StateBufferConnector_ms": 0.0023604631423950195, "ViewRequirementAgentConnector_ms": 0.047296881675720215}, "num_episodes": 58, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 637.1264368863698, "num_env_steps_trained_throughput_per_sec": 637.1264368863698, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 5941.66, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5941.626, "sample_time_ms": 678.035, "learn_time_ms": 5249.971, "learn_throughput": 761.909, "synch_weights_time_ms": 13.241}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 186, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-26", "timestamp": 1723391366, "time_this_iter_s": 6.288806915283203, "time_total_s": 1108.4941132068634, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602f44c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1108.4941132068634, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 34.144444444444446, "ram_util_percent": 82.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.288279394681255, "cur_kl_coeff": 1.985233470127266e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.247846434544772, "policy_loss": -0.0014706805513318008, "vf_loss": 1.2493171172526976, "vf_explained_var": 0.9783202047770222, "kl": 0.004995046538500616, "entropy": 0.3447980899984638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2714334767932693, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2769449004903435, "policy_loss": -0.005118592180709433, "vf_loss": 1.2820298372457424, "vf_explained_var": 0.977270680355529, "kl": 0.009573804042994993, "entropy": 0.6094978413855036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.11, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6411, "policy_reward_min": {"prey_policy": -53.51326848997899, "predator_policy": 4.188488256090093}, "policy_reward_max": {"prey_policy": -4.188488256090093, "predator_policy": 53.51326848997899}, "policy_reward_mean": {"prey_policy": -23.809412134639206, "predator_policy": 23.809412134639206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [76, 61, 86, 92, 27, 84, 43, 72, 40, 65, 65, 72, 148, 72, 65, 41, 56, 37, 47, 85, 26, 52, 46, 75, 93, 90, 87, 47, 79, 67, 47, 82, 64, 77, 29, 76, 74, 68, 96, 69, 71, 87, 54, 63, 59, 43, 65, 42, 75, 83, 73, 68, 94, 99, 20, 86, 57, 100, 66, 49, 92, 47, 60, 65, 53, 74, 79, 62, 58, 94, 100, 36, 75, 41, 61, 77, 51, 38, 57, 77, 67, 62, 70, 38, 36, 68, 72, 47, 42, 62, 48, 79, 51, 40, 19, 20, 86, 54, 77, 44], "policy_prey_policy_reward": [-42.617252285088064, -8.375833724549054, -34.1730107022256, -37.83849689136438, -12.093770864158904, -22.446991234131552, -22.37670777854078, -20.884691697095455, -11.063446736486737, -14.453023224899379, -4.2146839443137845, -21.777075222462972, -20.888566522539286, -44.161032787911935, -46.69982686378003, -11.44177073174898, -19.40900775686953, -24.392379214026416, -12.303371728649052, -43.52401690694075, -10.337424334306785, -33.967978473428, -31.808848161041023, -8.526447499188098, -53.51326848997899, -22.200643548109365, -37.72290940351351, -18.843617304419464, -16.394991056259954, -16.996308813038834, -10.908079274494321, -21.81426020550546, -37.6178162238184, -33.534244367994944, -14.142742927221825, -20.015758294116843, -26.278171862492098, -29.902024312902935, -26.710529856299367, -13.567374420517565, -25.789584879771027, -47.218105305507166, -9.213208528767979, -18.01874156867243, -41.86505397173816, -15.084499292790838, -28.343972668630567, -11.379633875587615, -11.034418173003072, -36.78977709398044, -21.045233749752647, -34.3636095827942, -51.068292139152646, -51.98591484333572, -6.359690843586447, -37.20192016287878, -23.386868667097172, -50.72164082622932, -15.505465215228229, -25.748884694310313, -38.04753350673139, -16.30808423248185, -25.915320449615958, -32.678105359984805, -13.36103783810453, -42.34985852633534, -43.456417268942445, -4.188488256090093, -6.5121048512421496, -28.895460612818592, -26.31615997975731, -22.660530810953155, -20.222462656049174, -13.341543232078845, -24.566629660539704, -40.526461031102606, -22.67187554452517, -14.690849699556729, -35.23967512421723, -27.547721400464532, -20.746997255437293, -8.716919248183887, -23.247392145339223, -10.705287504851242, -13.561429932080097, -37.18910303574956, -40.15819529413855, -11.533655496668068, -11.649927340774832, -11.949905722117546, -7.927046495755937, -17.36037160831866, -19.172258709921206, -14.522188152436586, -7.137034677785755, -11.376716301675494, -44.56777267771757, -10.368267395474108, -15.906748577122107, -21.584764121536573], "policy_predator_policy_reward": [42.617252285088064, 8.375833724549054, 34.1730107022256, 37.83849689136438, 12.093770864158904, 22.446991234131552, 22.37670777854078, 20.884691697095455, 11.063446736486737, 14.453023224899379, 4.2146839443137845, 21.777075222462972, 20.888566522539286, 44.161032787911935, 46.69982686378003, 11.44177073174898, 19.40900775686953, 24.392379214026416, 12.303371728649052, 43.52401690694075, 10.337424334306785, 33.967978473428, 31.808848161041023, 8.526447499188098, 53.51326848997899, 22.200643548109365, 37.72290940351351, 18.843617304419464, 16.394991056259954, 16.996308813038834, 10.908079274494321, 21.81426020550546, 37.6178162238184, 33.534244367994944, 14.142742927221825, 20.015758294116843, 26.278171862492098, 29.902024312902935, 26.710529856299367, 13.567374420517565, 25.789584879771027, 47.218105305507166, 9.213208528767979, 18.01874156867243, 41.86505397173816, 15.084499292790838, 28.343972668630567, 11.379633875587615, 11.034418173003072, 36.78977709398044, 21.045233749752647, 34.3636095827942, 51.068292139152646, 51.98591484333572, 6.359690843586447, 37.20192016287878, 23.386868667097172, 50.72164082622932, 15.505465215228229, 25.748884694310313, 38.04753350673139, 16.30808423248185, 25.915320449615958, 32.678105359984805, 13.36103783810453, 42.34985852633534, 43.456417268942445, 4.188488256090093, 6.5121048512421496, 28.895460612818592, 26.31615997975731, 22.660530810953155, 20.222462656049174, 13.341543232078845, 24.566629660539704, 40.526461031102606, 22.67187554452517, 14.690849699556729, 35.23967512421723, 27.547721400464532, 20.746997255437293, 8.716919248183887, 23.247392145339223, 10.705287504851242, 13.561429932080097, 37.18910303574956, 40.15819529413855, 11.533655496668068, 11.649927340774832, 11.949905722117546, 7.927046495755937, 17.36037160831866, 19.172258709921206, 14.522188152436586, 7.137034677785755, 11.376716301675494, 44.56777267771757, 10.368267395474108, 15.906748577122107, 21.584764121536573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29369555857078355, "mean_inference_ms": 0.9356095859578253, "mean_action_processing_ms": 0.12559143184209515, "mean_env_wait_ms": 0.06605795114112338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003248929977416992, "StateBufferConnector_ms": 0.002010941505432129, "ViewRequirementAgentConnector_ms": 0.04680764675140381}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 626.7701489700304, "num_env_steps_trained_throughput_per_sec": 626.7701489700304, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 1496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1496000, "timers": {"training_iteration_time_ms": 5946.048, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5946.012, "sample_time_ms": 654.058, "learn_time_ms": 5278.428, "learn_throughput": 757.801, "synch_weights_time_ms": 13.144}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "done": false, "training_iteration": 187, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-32", "timestamp": 1723391372, "time_this_iter_s": 6.387763977050781, "time_total_s": 1114.8818771839142, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e39d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1114.8818771839142, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 30.08888888888889, "ram_util_percent": 81.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3095641339818638, "cur_kl_coeff": 9.92616735063633e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.658536987689634, "policy_loss": -0.0015693482557253447, "vf_loss": 1.6601063345869382, "vf_explained_var": 0.9585878573358059, "kl": 0.004129617992153389, "entropy": 0.3410489848504464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4516839599857727, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6577199514955283, "policy_loss": -0.00408203931923102, "vf_loss": 1.6617575996244947, "vf_explained_var": 0.9593344944218795, "kl": 0.012625334648044495, "entropy": 0.5660501254412035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.06, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6406, "policy_reward_min": {"prey_policy": -49.07880928569525, "predator_policy": 4.188488256090093}, "policy_reward_max": {"prey_policy": -4.188488256090093, "predator_policy": 49.07880928569525}, "policy_reward_mean": {"prey_policy": -24.08892685464892, "predator_policy": 24.08892685464892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [49, 92, 47, 60, 65, 53, 74, 79, 62, 58, 94, 100, 36, 75, 41, 61, 77, 51, 38, 57, 77, 67, 62, 70, 38, 36, 68, 72, 47, 42, 62, 48, 79, 51, 40, 19, 20, 86, 54, 77, 44, 61, 85, 86, 52, 77, 77, 45, 92, 69, 54, 82, 69, 45, 21, 107, 65, 79, 49, 52, 77, 79, 50, 76, 52, 34, 93, 47, 45, 70, 78, 86, 55, 67, 56, 94, 65, 48, 76, 57, 62, 85, 82, 51, 48, 66, 77, 40, 63, 78, 88, 82, 84, 65, 76, 92, 76, 49, 80, 62], "policy_prey_policy_reward": [-25.748884694310313, -38.04753350673139, -16.30808423248185, -25.915320449615958, -32.678105359984805, -13.36103783810453, -42.34985852633534, -43.456417268942445, -4.188488256090093, -6.5121048512421496, -28.895460612818592, -26.31615997975731, -22.660530810953155, -20.222462656049174, -13.341543232078845, -24.566629660539704, -40.526461031102606, -22.67187554452517, -14.690849699556729, -35.23967512421723, -27.547721400464532, -20.746997255437293, -8.716919248183887, -23.247392145339223, -10.705287504851242, -13.561429932080097, -37.18910303574956, -40.15819529413855, -11.533655496668068, -11.649927340774832, -11.949905722117546, -7.927046495755937, -17.36037160831866, -19.172258709921206, -14.522188152436586, -7.137034677785755, -11.376716301675494, -44.56777267771757, -10.368267395474108, -15.906748577122107, -21.584764121536573, -7.055006161586789, -39.67629133720655, -45.41621332865369, -27.688943602670776, -41.8896813889461, -30.101271968401257, -27.723707420796757, -34.74883762193807, -42.67515384744947, -34.16350724125465, -28.77435848274746, -17.980198745179994, -14.392201369869833, -10.190114463585598, -8.097129338015433, -45.62086768160963, -13.434694407375076, -35.35150007893918, -11.099216631865499, -27.412285691197443, -11.286843076732769, -13.234297223622576, -45.726227384525856, -18.59231914358882, -14.643146105457088, -14.03717961886651, -18.526212779532113, -11.001838168051387, -32.23355049231862, -42.56022278896488, -36.27068667411935, -14.465786551782953, -19.25559756756489, -22.707573543555135, -23.639204952840633, -22.529992363404606, -28.805633159737106, -34.91017840283768, -33.405322269388165, -26.44052729195399, -46.27967419808247, -38.45999193013996, -10.18204144121044, -15.795292656904303, -28.031316246285378, -49.07880928569525, -12.07908875235921, -18.262485168119284, -30.296708406535792, -42.448991000233335, -7.323975052652784, -25.026727901378848, -35.50777785378427, -28.33288873883652, -43.82324785543582, -11.47580077969786, -15.24306176720238, -8.460054977601633, -30.394044655615986], "policy_predator_policy_reward": [25.748884694310313, 38.04753350673139, 16.30808423248185, 25.915320449615958, 32.678105359984805, 13.36103783810453, 42.34985852633534, 43.456417268942445, 4.188488256090093, 6.5121048512421496, 28.895460612818592, 26.31615997975731, 22.660530810953155, 20.222462656049174, 13.341543232078845, 24.566629660539704, 40.526461031102606, 22.67187554452517, 14.690849699556729, 35.23967512421723, 27.547721400464532, 20.746997255437293, 8.716919248183887, 23.247392145339223, 10.705287504851242, 13.561429932080097, 37.18910303574956, 40.15819529413855, 11.533655496668068, 11.649927340774832, 11.949905722117546, 7.927046495755937, 17.36037160831866, 19.172258709921206, 14.522188152436586, 7.137034677785755, 11.376716301675494, 44.56777267771757, 10.368267395474108, 15.906748577122107, 21.584764121536573, 7.055006161586789, 39.67629133720655, 45.41621332865369, 27.688943602670776, 41.8896813889461, 30.101271968401257, 27.723707420796757, 34.74883762193807, 42.67515384744947, 34.16350724125465, 28.77435848274746, 17.980198745179994, 14.392201369869833, 10.190114463585598, 8.097129338015433, 45.62086768160963, 13.434694407375076, 35.35150007893918, 11.099216631865499, 27.412285691197443, 11.286843076732769, 13.234297223622576, 45.726227384525856, 18.59231914358882, 14.643146105457088, 14.03717961886651, 18.526212779532113, 11.001838168051387, 32.23355049231862, 42.56022278896488, 36.27068667411935, 14.465786551782953, 19.25559756756489, 22.707573543555135, 23.639204952840633, 22.529992363404606, 28.805633159737106, 34.91017840283768, 33.405322269388165, 26.44052729195399, 46.27967419808247, 38.45999193013996, 10.18204144121044, 15.795292656904303, 28.031316246285378, 49.07880928569525, 12.07908875235921, 18.262485168119284, 30.296708406535792, 42.448991000233335, 7.323975052652784, 25.026727901378848, 35.50777785378427, 28.33288873883652, 43.82324785543582, 11.47580077969786, 15.24306176720238, 8.460054977601633, 30.394044655615986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293726164764122, "mean_inference_ms": 0.9355118031263203, "mean_action_processing_ms": 0.12559053534398348, "mean_env_wait_ms": 0.06603119773308098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028815269470214844, "StateBufferConnector_ms": 0.0021365880966186523, "ViewRequirementAgentConnector_ms": 0.05027127265930176}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 627.2649030045666, "num_env_steps_trained_throughput_per_sec": 627.2649030045666, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 6011.87, "restore_workers_time_ms": 0.012, "training_step_time_ms": 6011.833, "sample_time_ms": 662.733, "learn_time_ms": 5335.492, "learn_throughput": 749.697, "synch_weights_time_ms": 13.155}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 188, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-39", "timestamp": 1723391379, "time_this_iter_s": 6.387237071990967, "time_total_s": 1121.2691142559052, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e3d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1121.2691142559052, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 32.766666666666666, "ram_util_percent": 81.75555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1342348276327052, "cur_kl_coeff": 4.963083675318165e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5038335705331216, "policy_loss": -0.0031589005443189914, "vf_loss": 1.5069924645746748, "vf_explained_var": 0.9578240512559811, "kl": 0.003582161034777583, "entropy": 0.3248277424369007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2587046870340903, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.46746571076413, "policy_loss": -0.004873344935185741, "vf_loss": 1.4723085969065626, "vf_explained_var": 0.9641124422972401, "kl": 0.008662979629941408, "entropy": 0.5717601962387562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.72, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6572, "policy_reward_min": {"prey_policy": -54.424431194164754, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 54.424431194164754}, "policy_reward_mean": {"prey_policy": -26.13120139984433, "predator_policy": 26.13120139984433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [50, 76, 52, 34, 93, 47, 45, 70, 78, 86, 55, 67, 56, 94, 65, 48, 76, 57, 62, 85, 82, 51, 48, 66, 77, 40, 63, 78, 88, 82, 84, 65, 76, 92, 76, 49, 80, 62, 56, 67, 74, 62, 52, 67, 77, 66, 88, 86, 40, 1, 49, 41, 61, 80, 66, 78, 49, 61, 27, 93, 72, 37, 55, 82, 79, 62, 52, 18, 80, 89, 25, 68, 53, 48, 90, 66, 74, 69, 60, 59, 57, 64, 90, 92, 68, 65, 71, 83, 71, 80, 85, 59, 54, 51, 84, 86, 62, 56, 78, 82], "policy_prey_policy_reward": [-13.234297223622576, -45.726227384525856, -18.59231914358882, -14.643146105457088, -14.03717961886651, -18.526212779532113, -11.001838168051387, -32.23355049231862, -42.56022278896488, -36.27068667411935, -14.465786551782953, -19.25559756756489, -22.707573543555135, -23.639204952840633, -22.529992363404606, -28.805633159737106, -34.91017840283768, -33.405322269388165, -26.44052729195399, -46.27967419808247, -38.45999193013996, -10.18204144121044, -15.795292656904303, -28.031316246285378, -49.07880928569525, -12.07908875235921, -18.262485168119284, -30.296708406535792, -42.448991000233335, -7.323975052652784, -25.026727901378848, -35.50777785378427, -28.33288873883652, -43.82324785543582, -11.47580077969786, -15.24306176720238, -8.460054977601633, -30.394044655615986, -31.67915504090618, -20.947816438724793, -35.79318621138884, -24.10222771649483, -15.598655916644372, -9.009458985723208, -15.267166314735931, -35.664944630207884, -21.29802092514998, -29.422159655659655, -23.14208237352341, 0.0, -25.13534599960654, -5.651718186144626, -35.374152439111356, -26.119839937230154, -26.755233624853123, -32.40223870932273, -21.695685431724268, -33.50161151755864, -12.260714732758647, -37.74577107665335, -38.57074379796182, -13.951804388341468, -21.51609620383245, -45.05129707227552, -34.31559979981977, -44.10435226016304, -27.192467582430954, -4.711975398600313, -29.790866441103244, -34.51439460284225, -11.336615572660204, -23.729482685966364, -20.387726761957413, -24.2893255358179, -40.850840082611484, -17.557562193149003, -40.36921966408538, -21.17266157204838, -30.438122877320804, -22.330618977157766, -33.394469570530056, -33.35850886159727, -41.29624565090759, -54.424431194164754, -33.19238248669456, -41.01333786485044, -17.716184203914107, -33.76030158080919, -6.844031775749022, -37.44140327255767, -34.014796241957846, -4.758669601742118, -10.759086859663872, -31.211396854598103, -24.057311684965004, -32.40589958607942, -21.577121871568355, -19.45767280904822, -48.250279401349786, -19.950174127533558], "policy_predator_policy_reward": [13.234297223622576, 45.726227384525856, 18.59231914358882, 14.643146105457088, 14.03717961886651, 18.526212779532113, 11.001838168051387, 32.23355049231862, 42.56022278896488, 36.27068667411935, 14.465786551782953, 19.25559756756489, 22.707573543555135, 23.639204952840633, 22.529992363404606, 28.805633159737106, 34.91017840283768, 33.405322269388165, 26.44052729195399, 46.27967419808247, 38.45999193013996, 10.18204144121044, 15.795292656904303, 28.031316246285378, 49.07880928569525, 12.07908875235921, 18.262485168119284, 30.296708406535792, 42.448991000233335, 7.323975052652784, 25.026727901378848, 35.50777785378427, 28.33288873883652, 43.82324785543582, 11.47580077969786, 15.24306176720238, 8.460054977601633, 30.394044655615986, 31.67915504090618, 20.947816438724793, 35.79318621138884, 24.10222771649483, 15.598655916644372, 9.009458985723208, 15.267166314735931, 35.664944630207884, 21.29802092514998, 29.422159655659655, 23.14208237352341, 0.0, 25.13534599960654, 5.651718186144626, 35.374152439111356, 26.119839937230154, 26.755233624853123, 32.40223870932273, 21.695685431724268, 33.50161151755864, 12.260714732758647, 37.74577107665335, 38.57074379796182, 13.951804388341468, 21.51609620383245, 45.05129707227552, 34.31559979981977, 44.10435226016304, 27.192467582430954, 4.711975398600313, 29.790866441103244, 34.51439460284225, 11.336615572660204, 23.729482685966364, 20.387726761957413, 24.2893255358179, 40.850840082611484, 17.557562193149003, 40.36921966408538, 21.17266157204838, 30.438122877320804, 22.330618977157766, 33.394469570530056, 33.35850886159727, 41.29624565090759, 54.424431194164754, 33.19238248669456, 41.01333786485044, 17.716184203914107, 33.76030158080919, 6.844031775749022, 37.44140327255767, 34.014796241957846, 4.758669601742118, 10.759086859663872, 31.211396854598103, 24.057311684965004, 32.40589958607942, 21.577121871568355, 19.45767280904822, 48.250279401349786, 19.950174127533558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2936183337691231, "mean_inference_ms": 0.9355148957302559, "mean_action_processing_ms": 0.1255983582782825, "mean_env_wait_ms": 0.06601119397322597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029772520065307617, "StateBufferConnector_ms": 0.002087116241455078, "ViewRequirementAgentConnector_ms": 0.05020332336425781}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 660.8308534278156, "num_env_steps_trained_throughput_per_sec": 660.8308534278156, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 6029.596, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6029.555, "sample_time_ms": 660.799, "learn_time_ms": 5355.154, "learn_throughput": 746.944, "synch_weights_time_ms": 13.15}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 189, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-45", "timestamp": 1723391385, "time_this_iter_s": 6.057088851928711, "time_total_s": 1127.3262031078339, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602f45e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1127.3262031078339, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 27.433333333333337, "ram_util_percent": 82.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1900071439643702, "cur_kl_coeff": 2.4815418376590825e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1771996831831832, "policy_loss": -0.0026116636489556793, "vf_loss": 1.1798113484556476, "vf_explained_var": 0.9802952942748865, "kl": 0.0037821369618654993, "entropy": 0.334006558979551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.241989873473843, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2112746825441718, "policy_loss": -0.008371067633076261, "vf_loss": 1.2196018142625689, "vf_explained_var": 0.97905429850022, "kl": 0.012498344976350021, "entropy": 0.606342303690811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.4, "episode_media": {}, "episodes_this_iter": 64, "episodes_timesteps_total": 6440, "policy_reward_min": {"prey_policy": -54.424431194164754, "predator_policy": 2.3936669486586655}, "policy_reward_max": {"prey_policy": -2.3936669486586655, "predator_policy": 54.424431194164754}, "policy_reward_mean": {"prey_policy": -26.491610003814813, "predator_policy": 26.491610003814813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [79, 62, 52, 18, 80, 89, 25, 68, 53, 48, 90, 66, 74, 69, 60, 59, 57, 64, 90, 92, 68, 65, 71, 83, 71, 80, 85, 59, 54, 51, 84, 86, 62, 56, 78, 82, 59, 62, 44, 37, 56, 44, 57, 49, 61, 91, 53, 81, 30, 85, 73, 76, 74, 74, 81, 80, 66, 64, 46, 71, 93, 77, 41, 54, 65, 59, 32, 82, 61, 80, 52, 12, 81, 66, 25, 85, 57, 76, 53, 63, 77, 52, 66, 29, 51, 77, 91, 92, 68, 39, 53, 56, 55, 64, 73, 57, 60, 73, 80, 69], "policy_prey_policy_reward": [-34.31559979981977, -44.10435226016304, -27.192467582430954, -4.711975398600313, -29.790866441103244, -34.51439460284225, -11.336615572660204, -23.729482685966364, -20.387726761957413, -24.2893255358179, -40.850840082611484, -17.557562193149003, -40.36921966408538, -21.17266157204838, -30.438122877320804, -22.330618977157766, -33.394469570530056, -33.35850886159727, -41.29624565090759, -54.424431194164754, -33.19238248669456, -41.01333786485044, -17.716184203914107, -33.76030158080919, -6.844031775749022, -37.44140327255767, -34.014796241957846, -4.758669601742118, -10.759086859663872, -31.211396854598103, -24.057311684965004, -32.40589958607942, -21.577121871568355, -19.45767280904822, -48.250279401349786, -19.950174127533558, -36.562706686102494, -25.190027693708217, -11.948851560967375, -3.3876304265654404, -13.580700331919704, -30.379482769728696, -15.11562822355306, -16.46074391458561, -19.289874034221747, -36.01940018780696, -43.55341038709256, -42.90992864000913, -21.942559594151284, -48.666445295475995, -28.95129672734297, -39.3217869051095, -17.404049297586607, -33.31665918017386, -25.790729013016882, -10.4670198095901, -6.196798176129547, -28.461730256257333, -20.99861765136042, -30.731333215568064, -41.012271473791564, -38.60071472394381, -13.269547364577749, -19.411301593954775, -31.030678615465174, -26.77981947893862, -4.935872502751324, -32.440144494513916, -16.64255364877686, -22.199043985190634, -27.651040895450766, -2.3936669486586655, -13.747774432971777, -35.9574609657295, -8.10121254022606, -41.19124882348974, -28.205851182161155, -32.826693741971184, -20.719079860044552, -43.393206703261995, -30.408823407718398, -27.882809482163907, -14.01728397842606, -7.363725345245731, -6.4901089246877195, -34.680217295959444, -32.0944345789235, -52.21627898463426, -48.42800737011298, -4.982766967979084, -29.668164003191077, -33.17345907524052, -15.419924298276356, -25.891935347130662, -31.13282285889066, -38.87755053188808, -6.816268768733505, -44.00335415678041, -30.65407178019932, -21.826861763390177], "policy_predator_policy_reward": [34.31559979981977, 44.10435226016304, 27.192467582430954, 4.711975398600313, 29.790866441103244, 34.51439460284225, 11.336615572660204, 23.729482685966364, 20.387726761957413, 24.2893255358179, 40.850840082611484, 17.557562193149003, 40.36921966408538, 21.17266157204838, 30.438122877320804, 22.330618977157766, 33.394469570530056, 33.35850886159727, 41.29624565090759, 54.424431194164754, 33.19238248669456, 41.01333786485044, 17.716184203914107, 33.76030158080919, 6.844031775749022, 37.44140327255767, 34.014796241957846, 4.758669601742118, 10.759086859663872, 31.211396854598103, 24.057311684965004, 32.40589958607942, 21.577121871568355, 19.45767280904822, 48.250279401349786, 19.950174127533558, 36.562706686102494, 25.190027693708217, 11.948851560967375, 3.3876304265654404, 13.580700331919704, 30.379482769728696, 15.11562822355306, 16.46074391458561, 19.289874034221747, 36.01940018780696, 43.55341038709256, 42.90992864000913, 21.942559594151284, 48.666445295475995, 28.95129672734297, 39.3217869051095, 17.404049297586607, 33.31665918017386, 25.790729013016882, 10.4670198095901, 6.196798176129547, 28.461730256257333, 20.99861765136042, 30.731333215568064, 41.012271473791564, 38.60071472394381, 13.269547364577749, 19.411301593954775, 31.030678615465174, 26.77981947893862, 4.935872502751324, 32.440144494513916, 16.64255364877686, 22.199043985190634, 27.651040895450766, 2.3936669486586655, 13.747774432971777, 35.9574609657295, 8.10121254022606, 41.19124882348974, 28.205851182161155, 32.826693741971184, 20.719079860044552, 43.393206703261995, 30.408823407718398, 27.882809482163907, 14.01728397842606, 7.363725345245731, 6.4901089246877195, 34.680217295959444, 32.0944345789235, 52.21627898463426, 48.42800737011298, 4.982766967979084, 29.668164003191077, 33.17345907524052, 15.419924298276356, 25.891935347130662, 31.13282285889066, 38.87755053188808, 6.816268768733505, 44.00335415678041, 30.65407178019932, 21.826861763390177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29363931128945303, "mean_inference_ms": 0.935257467516102, "mean_action_processing_ms": 0.12554471614830903, "mean_env_wait_ms": 0.06594900967563916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00300443172454834, "StateBufferConnector_ms": 0.0020558834075927734, "ViewRequirementAgentConnector_ms": 0.048741936683654785}, "num_episodes": 64, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.5403317569039, "num_env_steps_trained_throughput_per_sec": 672.5403317569039, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 6042.256, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6042.214, "sample_time_ms": 671.118, "learn_time_ms": 5356.996, "learn_throughput": 746.687, "synch_weights_time_ms": 13.644}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 190, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-51", "timestamp": 1723391391, "time_this_iter_s": 5.956565856933594, "time_total_s": 1133.2827689647675, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602f4820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1133.2827689647675, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 27.8125, "ram_util_percent": 82.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.454804269472758, "cur_kl_coeff": 1.2407709188295412e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5454077245046696, "policy_loss": -0.0038289392551329607, "vf_loss": 1.5492366621270777, "vf_explained_var": 0.9625916300962368, "kl": 0.004747863855994675, "entropy": 0.29845563643611966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4218202563623588, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.566305922716856, "policy_loss": -0.003996370390692997, "vf_loss": 1.5702697730312745, "vf_explained_var": 0.9621076778198282, "kl": 0.009249552673356405, "entropy": 0.6405708568170667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 65.98, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 6598, "policy_reward_min": {"prey_policy": -53.98422770737202, "predator_policy": 2.3936669486586655}, "policy_reward_max": {"prey_policy": -2.3936669486586655, "predator_policy": 53.98422770737202}, "policy_reward_mean": {"prey_policy": -25.669663375554816, "predator_policy": 25.669663375554816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [93, 77, 41, 54, 65, 59, 32, 82, 61, 80, 52, 12, 81, 66, 25, 85, 57, 76, 53, 63, 77, 52, 66, 29, 51, 77, 91, 92, 68, 39, 53, 56, 55, 64, 73, 57, 60, 73, 80, 69, 81, 60, 61, 88, 74, 89, 58, 81, 90, 47, 87, 52, 76, 57, 56, 98, 38, 83, 70, 54, 67, 70, 59, 64, 76, 67, 6, 74, 81, 61, 134, 59, 58, 83, 90, 55, 67, 83, 87, 53, 88, 55, 53, 76, 62, 78, 96, 64, 79, 63, 46, 20, 96, 78, 66, 69, 58, 28, 81, 52], "policy_prey_policy_reward": [-41.012271473791564, -38.60071472394381, -13.269547364577749, -19.411301593954775, -31.030678615465174, -26.77981947893862, -4.935872502751324, -32.440144494513916, -16.64255364877686, -22.199043985190634, -27.651040895450766, -2.3936669486586655, -13.747774432971777, -35.9574609657295, -8.10121254022606, -41.19124882348974, -28.205851182161155, -32.826693741971184, -20.719079860044552, -43.393206703261995, -30.408823407718398, -27.882809482163907, -14.01728397842606, -7.363725345245731, -6.4901089246877195, -34.680217295959444, -32.0944345789235, -52.21627898463426, -48.42800737011298, -4.982766967979084, -29.668164003191077, -33.17345907524052, -15.419924298276356, -25.891935347130662, -31.13282285889066, -38.87755053188808, -6.816268768733505, -44.00335415678041, -30.65407178019932, -21.826861763390177, -32.10299326600774, -24.060579465090946, -33.30440679544294, -44.38272529214911, -35.935774580219125, -35.572104295742115, -27.07697586933205, -18.039495428229362, -14.451191785605644, -21.089343181954195, -41.9716870500006, -22.643125628250143, -32.67211254694534, -13.559897691979815, -12.185703141020566, -26.04309425408508, -8.094650267559107, -30.727393123571, -29.341676253857813, -11.68707013528155, -21.456189923372325, -33.91056924714147, -31.091726312080716, -27.29052720346705, -9.02350808658092, -30.27554168257072, -3.166634575070555, -11.082611422100747, -32.25281555532478, -33.85646415250132, -28.361198607181404, -29.49874280000202, -7.667420243922305, -38.100289026269, -39.106910693096886, -17.699235252428302, -45.29892616152399, -26.130553871033076, -50.79568078114617, -14.501670857219198, -33.01911695164595, -8.627233955214065, -15.143568559952584, -6.686186492758207, -22.176967671692438, -38.14246142714533, -53.98422770737202, -26.14435067422898, -44.04156811374187, -22.153412821048633, -22.277193830135097, -4.421593555448504, -51.85057735531131, -13.261447326193892, -8.293815114393544, -33.19463460925208, -16.352158870366466, -17.622300501213388, -25.326463616975357, -22.199788999592673], "policy_predator_policy_reward": [41.012271473791564, 38.60071472394381, 13.269547364577749, 19.411301593954775, 31.030678615465174, 26.77981947893862, 4.935872502751324, 32.440144494513916, 16.64255364877686, 22.199043985190634, 27.651040895450766, 2.3936669486586655, 13.747774432971777, 35.9574609657295, 8.10121254022606, 41.19124882348974, 28.205851182161155, 32.826693741971184, 20.719079860044552, 43.393206703261995, 30.408823407718398, 27.882809482163907, 14.01728397842606, 7.363725345245731, 6.4901089246877195, 34.680217295959444, 32.0944345789235, 52.21627898463426, 48.42800737011298, 4.982766967979084, 29.668164003191077, 33.17345907524052, 15.419924298276356, 25.891935347130662, 31.13282285889066, 38.87755053188808, 6.816268768733505, 44.00335415678041, 30.65407178019932, 21.826861763390177, 32.10299326600774, 24.060579465090946, 33.30440679544294, 44.38272529214911, 35.935774580219125, 35.572104295742115, 27.07697586933205, 18.039495428229362, 14.451191785605644, 21.089343181954195, 41.9716870500006, 22.643125628250143, 32.67211254694534, 13.559897691979815, 12.185703141020566, 26.04309425408508, 8.094650267559107, 30.727393123571, 29.341676253857813, 11.68707013528155, 21.456189923372325, 33.91056924714147, 31.091726312080716, 27.29052720346705, 9.02350808658092, 30.27554168257072, 3.166634575070555, 11.082611422100747, 32.25281555532478, 33.85646415250132, 28.361198607181404, 29.49874280000202, 7.667420243922305, 38.100289026269, 39.106910693096886, 17.699235252428302, 45.29892616152399, 26.130553871033076, 50.79568078114617, 14.501670857219198, 33.01911695164595, 8.627233955214065, 15.143568559952584, 6.686186492758207, 22.176967671692438, 38.14246142714533, 53.98422770737202, 26.14435067422898, 44.04156811374187, 22.153412821048633, 22.277193830135097, 4.421593555448504, 51.85057735531131, 13.261447326193892, 8.293815114393544, 33.19463460925208, 16.352158870366466, 17.622300501213388, 25.326463616975357, 22.199788999592673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29361548236964435, "mean_inference_ms": 0.9354779956818341, "mean_action_processing_ms": 0.12565332433442694, "mean_env_wait_ms": 0.06603204130339518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027920007705688477, "StateBufferConnector_ms": 0.0021485090255737305, "ViewRequirementAgentConnector_ms": 0.04763185977935791}, "num_episodes": 60, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 689.3357148260163, "num_env_steps_trained_throughput_per_sec": 689.3357148260163, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 1528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1528000, "timers": {"training_iteration_time_ms": 6029.837, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6029.795, "sample_time_ms": 673.633, "learn_time_ms": 5341.961, "learn_throughput": 748.789, "synch_weights_time_ms": 13.74}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "done": false, "training_iteration": 191, "trial_id": "abfb9_00000", "date": "2024-08-11_11-49-56", "timestamp": 1723391396, "time_this_iter_s": 5.808289051055908, "time_total_s": 1139.0910580158234, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1600e3d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1139.0910580158234, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 27.675, "ram_util_percent": 82.01249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1770160529762506, "cur_kl_coeff": 6.203854594147706e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3942843757957841, "policy_loss": -0.003139729963974484, "vf_loss": 1.3974241038473945, "vf_explained_var": 0.9695326145738363, "kl": 0.0046076537569337645, "entropy": 0.2723670057952404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3386113036423923, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4443572732930383, "policy_loss": -0.005009470533210939, "vf_loss": 1.4493209132303795, "vf_explained_var": 0.9688832112898429, "kl": 0.013035823454608226, "entropy": 0.6062553795675437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 67.8, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6780, "policy_reward_min": {"prey_policy": -53.98422770737202, "predator_policy": 0.12168069110053092}, "policy_reward_max": {"prey_policy": -0.12168069110053092, "predator_policy": 53.98422770737202}, "policy_reward_mean": {"prey_policy": -23.409517658717828, "predator_policy": 23.409517658717828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [54, 67, 70, 59, 64, 76, 67, 6, 74, 81, 61, 134, 59, 58, 83, 90, 55, 67, 83, 87, 53, 88, 55, 53, 76, 62, 78, 96, 64, 79, 63, 46, 20, 96, 78, 66, 69, 58, 28, 81, 52, 48, 41, 84, 43, 79, 64, 74, 78, 93, 73, 91, 31, 48, 19, 36, 54, 64, 69, 58, 55, 48, 71, 94, 59, 164, 80, 172, 85, 54, 76, 64, 68, 77, 69, 76, 44, 50, 79, 2, 69, 76, 69, 79, 66, 80, 66, 71, 83, 70, 52, 142, 84, 72, 52, 63, 52, 79, 46, 19], "policy_prey_policy_reward": [-11.68707013528155, -21.456189923372325, -33.91056924714147, -31.091726312080716, -27.29052720346705, -9.02350808658092, -30.27554168257072, -3.166634575070555, -11.082611422100747, -32.25281555532478, -33.85646415250132, -28.361198607181404, -29.49874280000202, -7.667420243922305, -38.100289026269, -39.106910693096886, -17.699235252428302, -45.29892616152399, -26.130553871033076, -50.79568078114617, -14.501670857219198, -33.01911695164595, -8.627233955214065, -15.143568559952584, -6.686186492758207, -22.176967671692438, -38.14246142714533, -53.98422770737202, -26.14435067422898, -44.04156811374187, -22.153412821048633, -22.277193830135097, -4.421593555448504, -51.85057735531131, -13.261447326193892, -8.293815114393544, -33.19463460925208, -16.352158870366466, -17.622300501213388, -25.326463616975357, -22.199788999592673, -9.701864773573831, -12.747159603382219, -19.608117991670248, -16.1963104009867, -13.152286081517502, -23.826296289023606, -24.818971977704205, -34.10332131955215, -43.64927393773012, -29.537049195460973, -29.443268675982708, -9.709479928096941, -29.535368343866935, -7.813572488436249, -4.551662845470281, -20.560057683618446, -16.91635875360845, -22.609585252463802, -5.55671137513215, -9.935211481233981, -8.944997593015241, -44.332941813221744, -48.052108628816754, -23.83706709699619, -18.962175644954, -20.57164969167105, -21.21417735099479, -26.765515213697558, -17.274586929505354, -18.608663022063013, -4.93858475809506, -14.301749093361822, -43.97535655116171, -40.572324364497774, -23.158641832560956, -19.709608600933503, -1.8347547854463522, -33.406166089958525, -0.12168069110053092, -13.67884312500459, -39.312729404392144, -13.754009197405408, -36.04500573702416, -23.451479655648566, -46.25032247810961, -20.40999459429917, -21.188602994848058, -35.62210094924086, -29.724057720499214, -17.70968695318043, -16.84341391259221, -41.74231439233956, -30.20352821423307, -19.070940458476063, -29.968654931589203, -12.28544626419553, -34.4117553782813, -12.153491893940188, -5.397354722923993], "policy_predator_policy_reward": [11.68707013528155, 21.456189923372325, 33.91056924714147, 31.091726312080716, 27.29052720346705, 9.02350808658092, 30.27554168257072, 3.166634575070555, 11.082611422100747, 32.25281555532478, 33.85646415250132, 28.361198607181404, 29.49874280000202, 7.667420243922305, 38.100289026269, 39.106910693096886, 17.699235252428302, 45.29892616152399, 26.130553871033076, 50.79568078114617, 14.501670857219198, 33.01911695164595, 8.627233955214065, 15.143568559952584, 6.686186492758207, 22.176967671692438, 38.14246142714533, 53.98422770737202, 26.14435067422898, 44.04156811374187, 22.153412821048633, 22.277193830135097, 4.421593555448504, 51.85057735531131, 13.261447326193892, 8.293815114393544, 33.19463460925208, 16.352158870366466, 17.622300501213388, 25.326463616975357, 22.199788999592673, 9.701864773573831, 12.747159603382219, 19.608117991670248, 16.1963104009867, 13.152286081517502, 23.826296289023606, 24.818971977704205, 34.10332131955215, 43.64927393773012, 29.537049195460973, 29.443268675982708, 9.709479928096941, 29.535368343866935, 7.813572488436249, 4.551662845470281, 20.560057683618446, 16.91635875360845, 22.609585252463802, 5.55671137513215, 9.935211481233981, 8.944997593015241, 44.332941813221744, 48.052108628816754, 23.83706709699619, 18.962175644954, 20.57164969167105, 21.21417735099479, 26.765515213697558, 17.274586929505354, 18.608663022063013, 4.93858475809506, 14.301749093361822, 43.97535655116171, 40.572324364497774, 23.158641832560956, 19.709608600933503, 1.8347547854463522, 33.406166089958525, 0.12168069110053092, 13.67884312500459, 39.312729404392144, 13.754009197405408, 36.04500573702416, 23.451479655648566, 46.25032247810961, 20.40999459429917, 21.188602994848058, 35.62210094924086, 29.724057720499214, 17.70968695318043, 16.84341391259221, 41.74231439233956, 30.20352821423307, 19.070940458476063, 29.968654931589203, 12.28544626419553, 34.4117553782813, 12.153491893940188, 5.397354722923993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2936806183893145, "mean_inference_ms": 0.9349214705653373, "mean_action_processing_ms": 0.12562898729227762, "mean_env_wait_ms": 0.06601391621110336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028007030487060547, "StateBufferConnector_ms": 0.0022513866424560547, "ViewRequirementAgentConnector_ms": 0.04864609241485596}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 628.1163371641061, "num_env_steps_trained_throughput_per_sec": 628.1163371641061, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 6077.022, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6076.98, "sample_time_ms": 678.723, "learn_time_ms": 5384.06, "learn_throughput": 742.934, "synch_weights_time_ms": 13.725}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 192, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-03", "timestamp": 1723391403, "time_this_iter_s": 6.4251251220703125, "time_total_s": 1145.5161831378937, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13d1040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1145.5161831378937, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 33.08888888888889, "ram_util_percent": 82.31111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3694388854006925, "cur_kl_coeff": 3.101927297073853e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4694134064950048, "policy_loss": -0.003201343529508449, "vf_loss": 1.4726147501418987, "vf_explained_var": 0.9691731135050455, "kl": 0.0032039748246556125, "entropy": 0.28692665410538515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.486991326759259, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5510373116781315, "policy_loss": -0.0033718113976647147, "vf_loss": 1.5543914855768284, "vf_explained_var": 0.9668417668590943, "kl": 0.0050153917246254474, "entropy": 0.6043945550918579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.44, "episode_media": {}, "episodes_this_iter": 68, "episodes_timesteps_total": 6144, "policy_reward_min": {"prey_policy": -56.96929422199081, "predator_policy": 0.12168069110053092}, "policy_reward_max": {"prey_policy": -0.12168069110053092, "predator_policy": 56.96929422199081}, "policy_reward_mean": {"prey_policy": -23.653738438701193, "predator_policy": 23.653738438701193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [85, 54, 76, 64, 68, 77, 69, 76, 44, 50, 79, 2, 69, 76, 69, 79, 66, 80, 66, 71, 83, 70, 52, 142, 84, 72, 52, 63, 52, 79, 46, 19, 19, 75, 72, 88, 84, 57, 49, 37, 67, 75, 52, 80, 65, 39, 34, 79, 78, 46, 66, 89, 80, 51, 88, 83, 73, 75, 75, 67, 77, 8, 61, 56, 40, 38, 54, 11, 6, 43, 55, 72, 69, 78, 38, 64, 74, 19, 1, 48, 39, 77, 55, 22, 83, 87, 98, 34, 66, 84, 36, 74, 57, 54, 77, 84, 67, 41, 82, 38], "policy_prey_policy_reward": [-26.765515213697558, -17.274586929505354, -18.608663022063013, -4.93858475809506, -14.301749093361822, -43.97535655116171, -40.572324364497774, -23.158641832560956, -19.709608600933503, -1.8347547854463522, -33.406166089958525, -0.12168069110053092, -13.67884312500459, -39.312729404392144, -13.754009197405408, -36.04500573702416, -23.451479655648566, -46.25032247810961, -20.40999459429917, -21.188602994848058, -35.62210094924086, -29.724057720499214, -17.70968695318043, -16.84341391259221, -41.74231439233956, -30.20352821423307, -19.070940458476063, -29.968654931589203, -12.28544626419553, -34.4117553782813, -12.153491893940188, -5.397354722923993, -10.395668606314707, -28.140052310972372, -14.334260884969902, -56.96929422199081, -12.496489983687571, -11.416651118694881, -17.83738714763577, -16.479500491703817, -45.348787606340956, -39.98483101030843, -24.013544465106367, -30.38823642151527, -28.815014958424722, -10.480158650114133, -20.101002593837197, -39.57027130069561, -12.291309020481828, -20.897546972863914, -34.94502065626938, -40.72757085992327, -31.23584870606913, -24.5395067359318, -17.573519241112564, -17.28714273064266, -7.271972579562666, -43.84980544686926, -45.46610607918275, -14.18995990113211, -44.46474390588067, -6.000090743254835, -27.111466581224644, -16.841630791794223, -6.524581666391634, -14.617743165861993, -30.494988389608242, -0.9537170329673459, -2.5973926203223896, -28.76361511520181, -14.674306372003942, -33.9167985441664, -25.576071039929406, -24.723049704113382, -7.12866897405305, -25.443692688727534, -18.043234975481358, -4.008623579930722, -1.4063330863253296, -33.18591525367629, -18.769166910769314, -32.93757726618363, -35.37052808809817, -6.979403713151557, -41.595993300292626, -31.31977063024635, -51.34628896046497, -5.211108224672918, -34.78366706775623, -37.98788443642408, -11.124384980947056, -15.826457058209947, -28.664915134670093, -33.186269959248634, -19.33878812862687, -37.952997895061856, -19.600823645832524, -31.55404200553133, -25.65661235470072, -18.752674265355775], "policy_predator_policy_reward": [26.765515213697558, 17.274586929505354, 18.608663022063013, 4.93858475809506, 14.301749093361822, 43.97535655116171, 40.572324364497774, 23.158641832560956, 19.709608600933503, 1.8347547854463522, 33.406166089958525, 0.12168069110053092, 13.67884312500459, 39.312729404392144, 13.754009197405408, 36.04500573702416, 23.451479655648566, 46.25032247810961, 20.40999459429917, 21.188602994848058, 35.62210094924086, 29.724057720499214, 17.70968695318043, 16.84341391259221, 41.74231439233956, 30.20352821423307, 19.070940458476063, 29.968654931589203, 12.28544626419553, 34.4117553782813, 12.153491893940188, 5.397354722923993, 10.395668606314707, 28.140052310972372, 14.334260884969902, 56.96929422199081, 12.496489983687571, 11.416651118694881, 17.83738714763577, 16.479500491703817, 45.348787606340956, 39.98483101030843, 24.013544465106367, 30.38823642151527, 28.815014958424722, 10.480158650114133, 20.101002593837197, 39.57027130069561, 12.291309020481828, 20.897546972863914, 34.94502065626938, 40.72757085992327, 31.23584870606913, 24.5395067359318, 17.573519241112564, 17.28714273064266, 7.271972579562666, 43.84980544686926, 45.46610607918275, 14.18995990113211, 44.46474390588067, 6.000090743254835, 27.111466581224644, 16.841630791794223, 6.524581666391634, 14.617743165861993, 30.494988389608242, 0.9537170329673459, 2.5973926203223896, 28.76361511520181, 14.674306372003942, 33.9167985441664, 25.576071039929406, 24.723049704113382, 7.12866897405305, 25.443692688727534, 18.043234975481358, 4.008623579930722, 1.4063330863253296, 33.18591525367629, 18.769166910769314, 32.93757726618363, 35.37052808809817, 6.979403713151557, 41.595993300292626, 31.31977063024635, 51.34628896046497, 5.211108224672918, 34.78366706775623, 37.98788443642408, 11.124384980947056, 15.826457058209947, 28.664915134670093, 33.186269959248634, 19.33878812862687, 37.952997895061856, 19.600823645832524, 31.55404200553133, 25.65661235470072, 18.752674265355775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293616716152111, "mean_inference_ms": 0.9346635190104086, "mean_action_processing_ms": 0.1254759947074531, "mean_env_wait_ms": 0.06597312412103302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028537511825561523, "StateBufferConnector_ms": 0.0021849870681762695, "ViewRequirementAgentConnector_ms": 0.04878711700439453}, "num_episodes": 68, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 665.0009552552117, "num_env_steps_trained_throughput_per_sec": 665.0009552552117, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 1544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1544000, "timers": {"training_iteration_time_ms": 6094.854, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6094.81, "sample_time_ms": 686.541, "learn_time_ms": 5393.953, "learn_throughput": 741.571, "synch_weights_time_ms": 13.836}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "done": false, "training_iteration": 193, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-09", "timestamp": 1723391409, "time_this_iter_s": 6.020392894744873, "time_total_s": 1151.5365760326385, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602f45e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1151.5365760326385, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 29.06666666666667, "ram_util_percent": 82.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.10128760188818, "cur_kl_coeff": 1.5509636485369265e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2497737433761358, "policy_loss": -0.0003407648963426861, "vf_loss": 1.2501145077869296, "vf_explained_var": 0.9752792240430911, "kl": 0.0021292935785903002, "entropy": 0.2807686569634825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1953118848303954, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2388160654964546, "policy_loss": -0.008767525049916004, "vf_loss": 1.2475288570548098, "vf_explained_var": 0.9755687012647589, "kl": 0.015569385868793202, "entropy": 0.616157690466692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 60.74, "episode_media": {}, "episodes_this_iter": 62, "episodes_timesteps_total": 6074, "policy_reward_min": {"prey_policy": -51.34628896046497, "predator_policy": 0.9537170329673459}, "policy_reward_max": {"prey_policy": -0.9537170329673459, "predator_policy": 51.34628896046497}, "policy_reward_mean": {"prey_policy": -23.9843408615654, "predator_policy": 23.9843408615654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [61, 56, 40, 38, 54, 11, 6, 43, 55, 72, 69, 78, 38, 64, 74, 19, 1, 48, 39, 77, 55, 22, 83, 87, 98, 34, 66, 84, 36, 74, 57, 54, 77, 84, 67, 41, 82, 38, 87, 73, 78, 78, 72, 54, 60, 36, 64, 62, 145, 80, 91, 72, 73, 2, 75, 23, 63, 77, 47, 31, 79, 84, 43, 73, 93, 91, 31, 61, 53, 47, 88, 85, 51, 74, 54, 77, 60, 45, 68, 85, 67, 58, 94, 55, 61, 35, 54, 70, 1, 95, 74, 57, 69, 39, 64, 68, 50, 81, 44, 71], "policy_prey_policy_reward": [-27.111466581224644, -16.841630791794223, -6.524581666391634, -14.617743165861993, -30.494988389608242, -0.9537170329673459, -2.5973926203223896, -28.76361511520181, -14.674306372003942, -33.9167985441664, -25.576071039929406, -24.723049704113382, -7.12866897405305, -25.443692688727534, -18.043234975481358, -4.008623579930722, -1.4063330863253296, -33.18591525367629, -18.769166910769314, -32.93757726618363, -35.37052808809817, -6.979403713151557, -41.595993300292626, -31.31977063024635, -51.34628896046497, -5.211108224672918, -34.78366706775623, -37.98788443642408, -11.124384980947056, -15.826457058209947, -28.664915134670093, -33.186269959248634, -19.33878812862687, -37.952997895061856, -19.600823645832524, -31.55404200553133, -25.65661235470072, -18.752674265355775, -17.95375337082793, -43.68344132970177, -35.35557322620224, -5.0781770780832485, -23.77919552981329, -20.614738048215564, -20.3665705446819, -18.004099119456377, -32.05492754797515, -25.68948299525224, -33.2244074521203, -11.823997761137408, -38.29824788314429, -44.40540707189144, -25.610540474441926, -2.3065026053636766, -40.116144419414496, -5.539294195377315, -17.871221596479316, -29.489013819650168, -7.513606690258561, -10.322312479303132, -36.22067467550071, -28.48015976619063, -21.445368732245985, -36.6208254833957, -23.65484176904838, -21.900030526324887, -5.0829951003154985, -25.633253215946375, -33.108889242284775, -12.824985240176876, -27.92414077493984, -43.86355119235285, -14.83238182470485, -41.76217919298513, -6.242280502850966, -44.15532300000587, -10.841716828063015, -18.15751903233313, -24.937740400622893, -29.291378611500512, -20.02304242515403, -30.542285039935354, -42.185382970968156, -38.50005600532442, -26.16697275644959, -14.286313024146663, -14.924630884697692, -47.69216371387533, -1.2034800288444536, -46.40756465513647, -29.99272746317861, -19.851556472356933, -29.821203348117447, -10.962249778007934, -44.99016737974086, -36.57427972547456, -18.738077539361555, -32.920730451371334, -7.512368612258234, -15.086759923535842], "policy_predator_policy_reward": [27.111466581224644, 16.841630791794223, 6.524581666391634, 14.617743165861993, 30.494988389608242, 0.9537170329673459, 2.5973926203223896, 28.76361511520181, 14.674306372003942, 33.9167985441664, 25.576071039929406, 24.723049704113382, 7.12866897405305, 25.443692688727534, 18.043234975481358, 4.008623579930722, 1.4063330863253296, 33.18591525367629, 18.769166910769314, 32.93757726618363, 35.37052808809817, 6.979403713151557, 41.595993300292626, 31.31977063024635, 51.34628896046497, 5.211108224672918, 34.78366706775623, 37.98788443642408, 11.124384980947056, 15.826457058209947, 28.664915134670093, 33.186269959248634, 19.33878812862687, 37.952997895061856, 19.600823645832524, 31.55404200553133, 25.65661235470072, 18.752674265355775, 17.95375337082793, 43.68344132970177, 35.35557322620224, 5.0781770780832485, 23.77919552981329, 20.614738048215564, 20.3665705446819, 18.004099119456377, 32.05492754797515, 25.68948299525224, 33.2244074521203, 11.823997761137408, 38.29824788314429, 44.40540707189144, 25.610540474441926, 2.3065026053636766, 40.116144419414496, 5.539294195377315, 17.871221596479316, 29.489013819650168, 7.513606690258561, 10.322312479303132, 36.22067467550071, 28.48015976619063, 21.445368732245985, 36.6208254833957, 23.65484176904838, 21.900030526324887, 5.0829951003154985, 25.633253215946375, 33.108889242284775, 12.824985240176876, 27.92414077493984, 43.86355119235285, 14.83238182470485, 41.76217919298513, 6.242280502850966, 44.15532300000587, 10.841716828063015, 18.15751903233313, 24.937740400622893, 29.291378611500512, 20.02304242515403, 30.542285039935354, 42.185382970968156, 38.50005600532442, 26.16697275644959, 14.286313024146663, 14.924630884697692, 47.69216371387533, 1.2034800288444536, 46.40756465513647, 29.99272746317861, 19.851556472356933, 29.821203348117447, 10.962249778007934, 44.99016737974086, 36.57427972547456, 18.738077539361555, 32.920730451371334, 7.512368612258234, 15.086759923535842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293550311082079, "mean_inference_ms": 0.9350968547657348, "mean_action_processing_ms": 0.12548965061283984, "mean_env_wait_ms": 0.0659739405023127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029135942459106445, "StateBufferConnector_ms": 0.0020335912704467773, "ViewRequirementAgentConnector_ms": 0.04863858222961426}, "num_episodes": 62, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 664.297920933054, "num_env_steps_trained_throughput_per_sec": 664.297920933054, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 6118.435, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6118.391, "sample_time_ms": 695.264, "learn_time_ms": 5408.883, "learn_throughput": 739.524, "synch_weights_time_ms": 13.793}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 194, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-15", "timestamp": 1723391415, "time_this_iter_s": 6.026899099349976, "time_total_s": 1157.5634751319885, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602e7310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1157.5634751319885, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 27.8125, "ram_util_percent": 82.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1506425574421884, "cur_kl_coeff": 7.754818242684633e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4743933066104848, "policy_loss": -0.0009837680277996696, "vf_loss": 1.4753770732010405, "vf_explained_var": 0.9690730506554246, "kl": 0.0028179152637852313, "entropy": 0.30702545802729825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.229252860446771, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4685865928108492, "policy_loss": -0.004694156363499739, "vf_loss": 1.4732393749058246, "vf_explained_var": 0.9691096222649018, "kl": 0.011769388633546344, "entropy": 0.627278826199472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.66, "episode_media": {}, "episodes_this_iter": 61, "episodes_timesteps_total": 6366, "policy_reward_min": {"prey_policy": -58.15366103819654, "predator_policy": 1.2034800288444536}, "policy_reward_max": {"prey_policy": -1.2034800288444536, "predator_policy": 58.15366103819654}, "policy_reward_mean": {"prey_policy": -25.644040899303974, "predator_policy": 25.644040899303974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [84, 43, 73, 93, 91, 31, 61, 53, 47, 88, 85, 51, 74, 54, 77, 60, 45, 68, 85, 67, 58, 94, 55, 61, 35, 54, 70, 1, 95, 74, 57, 69, 39, 64, 68, 50, 81, 44, 71, 130, 89, 81, 37, 46, 61, 34, 64, 84, 95, 72, 70, 47, 79, 34, 85, 71, 70, 77, 49, 46, 84, 96, 59, 65, 37, 64, 45, 70, 82, 67, 62, 58, 56, 36, 70, 73, 66, 87, 31, 45, 92, 52, 34, 37, 97, 61, 83, 92, 20, 55, 68, 41, 47, 82, 66, 67, 54, 80, 66, 28], "policy_prey_policy_reward": [-28.48015976619063, -21.445368732245985, -36.6208254833957, -23.65484176904838, -21.900030526324887, -5.0829951003154985, -25.633253215946375, -33.108889242284775, -12.824985240176876, -27.92414077493984, -43.86355119235285, -14.83238182470485, -41.76217919298513, -6.242280502850966, -44.15532300000587, -10.841716828063015, -18.15751903233313, -24.937740400622893, -29.291378611500512, -20.02304242515403, -30.542285039935354, -42.185382970968156, -38.50005600532442, -26.16697275644959, -14.286313024146663, -14.924630884697692, -47.69216371387533, -1.2034800288444536, -46.40756465513647, -29.99272746317861, -19.851556472356933, -29.821203348117447, -10.962249778007934, -44.99016737974086, -36.57427972547456, -18.738077539361555, -32.920730451371334, -7.512368612258234, -15.086759923535842, -9.914772973222068, -33.68739425572382, -49.56885396992223, -14.26302737161929, -32.588754817574234, -44.25582972970539, -16.769840207353383, -25.341416020880096, -37.02912562410314, -58.15366103819654, -30.520536053009494, -32.96290824491686, -26.029749647450345, -28.161847630466596, -19.15050378051759, -23.188628787583998, -41.175399129840784, -19.474739920312334, -15.356900674588083, -20.701010774149175, -3.6187318001949698, -35.41400505460271, -44.408834216390744, -29.327591364567756, -24.621934852840464, -9.23667316394433, -28.09032868996204, -16.186071232743203, -14.432993919681254, -11.414094425530878, -32.188187373973065, -7.972962620750781, -45.15624289978709, -35.17606358561593, -10.000380116492977, -36.27849562778155, -44.89068464030905, -25.488557691473044, -23.24320769436568, -13.688978170375433, -24.834994066013298, -38.51522976055962, -18.19052112851691, -19.696184746290818, -25.5919868745699, -41.85514992697026, -35.630997762611074, -19.954370343077038, -32.95071168063697, -6.921085230951323, -20.950944677011073, -34.8769765497458, -24.52947808453367, -18.421516769790234, -9.738982377154029, -20.36804455945525, -8.320479895773296, -22.773458503906138, -49.20049655170708, -11.531291197657584, -11.279696816723527], "policy_predator_policy_reward": [28.48015976619063, 21.445368732245985, 36.6208254833957, 23.65484176904838, 21.900030526324887, 5.0829951003154985, 25.633253215946375, 33.108889242284775, 12.824985240176876, 27.92414077493984, 43.86355119235285, 14.83238182470485, 41.76217919298513, 6.242280502850966, 44.15532300000587, 10.841716828063015, 18.15751903233313, 24.937740400622893, 29.291378611500512, 20.02304242515403, 30.542285039935354, 42.185382970968156, 38.50005600532442, 26.16697275644959, 14.286313024146663, 14.924630884697692, 47.69216371387533, 1.2034800288444536, 46.40756465513647, 29.99272746317861, 19.851556472356933, 29.821203348117447, 10.962249778007934, 44.99016737974086, 36.57427972547456, 18.738077539361555, 32.920730451371334, 7.512368612258234, 15.086759923535842, 9.914772973222068, 33.68739425572382, 49.56885396992223, 14.26302737161929, 32.588754817574234, 44.25582972970539, 16.769840207353383, 25.341416020880096, 37.02912562410314, 58.15366103819654, 30.520536053009494, 32.96290824491686, 26.029749647450345, 28.161847630466596, 19.15050378051759, 23.188628787583998, 41.175399129840784, 19.474739920312334, 15.356900674588083, 20.701010774149175, 3.6187318001949698, 35.41400505460271, 44.408834216390744, 29.327591364567756, 24.621934852840464, 9.23667316394433, 28.09032868996204, 16.186071232743203, 14.432993919681254, 11.414094425530878, 32.188187373973065, 7.972962620750781, 45.15624289978709, 35.17606358561593, 10.000380116492977, 36.27849562778155, 44.89068464030905, 25.488557691473044, 23.24320769436568, 13.688978170375433, 24.834994066013298, 38.51522976055962, 18.19052112851691, 19.696184746290818, 25.5919868745699, 41.85514992697026, 35.630997762611074, 19.954370343077038, 32.95071168063697, 6.921085230951323, 20.950944677011073, 34.8769765497458, 24.52947808453367, 18.421516769790234, 9.738982377154029, 20.36804455945525, 8.320479895773296, 22.773458503906138, 49.20049655170708, 11.531291197657584, 11.279696816723527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2935232036862917, "mean_inference_ms": 0.9350376225127812, "mean_action_processing_ms": 0.12555574799047084, "mean_env_wait_ms": 0.06599075230204372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026895999908447266, "StateBufferConnector_ms": 0.0019344091415405273, "ViewRequirementAgentConnector_ms": 0.046228766441345215}, "num_episodes": 61, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 667.560768256778, "num_env_steps_trained_throughput_per_sec": 667.560768256778, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 6123.702, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6123.658, "sample_time_ms": 694.54, "learn_time_ms": 5414.872, "learn_throughput": 738.706, "synch_weights_time_ms": 13.798}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 195, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-21", "timestamp": 1723391421, "time_this_iter_s": 5.997543811798096, "time_total_s": 1163.5610189437866, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16030faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1163.5610189437866, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 29.866666666666667, "ram_util_percent": 82.34444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0771145657325785, "cur_kl_coeff": 3.8774091213423164e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2602138208846252, "policy_loss": -0.00021591689680159712, "vf_loss": 1.2604297396416466, "vf_explained_var": 0.9727067147071163, "kl": 0.0024375624636949187, "entropy": 0.284658894672369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.037397520802915, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2275254288688302, "policy_loss": -0.005171463805163512, "vf_loss": 1.2326657333100834, "vf_explained_var": 0.972935298892359, "kl": 0.008863616575141947, "entropy": 0.6039706093569597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 61.55, "episode_media": {}, "episodes_this_iter": 66, "episodes_timesteps_total": 6155, "policy_reward_min": {"prey_policy": -51.33463632650599, "predator_policy": 0.829086767051244}, "policy_reward_max": {"prey_policy": -0.829086767051244, "predator_policy": 51.33463632650599}, "policy_reward_mean": {"prey_policy": -23.61645657585841, "predator_policy": 23.61645657585841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [45, 70, 82, 67, 62, 58, 56, 36, 70, 73, 66, 87, 31, 45, 92, 52, 34, 37, 97, 61, 83, 92, 20, 55, 68, 41, 47, 82, 66, 67, 54, 80, 66, 28, 148, 88, 55, 67, 40, 65, 46, 63, 68, 13, 77, 84, 76, 1, 62, 77, 87, 61, 59, 60, 26, 80, 49, 44, 69, 34, 73, 20, 65, 47, 63, 48, 60, 76, 45, 58, 69, 71, 48, 65, 31, 56, 64, 63, 85, 57, 107, 56, 65, 80, 72, 32, 70, 48, 31, 82, 80, 69, 45, 80, 2, 57, 123, 64, 81, 78], "policy_prey_policy_reward": [-16.186071232743203, -14.432993919681254, -11.414094425530878, -32.188187373973065, -7.972962620750781, -45.15624289978709, -35.17606358561593, -10.000380116492977, -36.27849562778155, -44.89068464030905, -25.488557691473044, -23.24320769436568, -13.688978170375433, -24.834994066013298, -38.51522976055962, -18.19052112851691, -19.696184746290818, -25.5919868745699, -41.85514992697026, -35.630997762611074, -19.954370343077038, -32.95071168063697, -6.921085230951323, -20.950944677011073, -34.8769765497458, -24.52947808453367, -18.421516769790234, -9.738982377154029, -20.36804455945525, -8.320479895773296, -22.773458503906138, -49.20049655170708, -11.531291197657584, -11.279696816723527, -15.91186949654167, -39.888184048190574, -5.755361650852187, -35.18063912322938, -18.879185327859886, -13.214670999011384, -22.252923584332088, -35.42862331469745, -21.393249837582996, -6.77301652240732, -29.444431332447927, -29.379312246984664, -42.50261781149093, -1.5774955324774647, -20.011961071845807, -27.664824317898333, -43.0843056021307, -34.68308410161656, -6.082262857054285, -17.784562416500275, -4.975061569644872, -9.537972098266874, -16.369043411596714, -21.66559833485555, -19.80327823590542, -9.170479066674243, -36.81422165039199, -2.1597742053959887, -15.017105657605635, -22.18835918326842, -25.690528498789387, -18.597421143251935, -39.39878092139971, -45.11489580712469, -13.957497373312973, -14.340516322400475, -22.459158561545905, -21.21305871793746, -3.5996427572040277, -18.24534542402192, -12.160939776440872, -18.037555947717227, -31.271699148518344, -38.54609506861874, -25.875358809762666, -34.63012658052476, -51.33463632650599, -33.53675418419881, -16.06929814927866, -31.813443768168774, -29.35755493525506, -27.12401446811867, -15.289338101083503, -9.303183568688626, -7.723919943573639, -19.74885786386198, -40.69500833967501, -30.142219475922044, -19.561131648478213, -48.15230056017721, -0.829086767051244, -38.30685787841803, -20.35378321745494, -18.199583643169316, -37.76398978574512, -46.35908199115275], "policy_predator_policy_reward": [16.186071232743203, 14.432993919681254, 11.414094425530878, 32.188187373973065, 7.972962620750781, 45.15624289978709, 35.17606358561593, 10.000380116492977, 36.27849562778155, 44.89068464030905, 25.488557691473044, 23.24320769436568, 13.688978170375433, 24.834994066013298, 38.51522976055962, 18.19052112851691, 19.696184746290818, 25.5919868745699, 41.85514992697026, 35.630997762611074, 19.954370343077038, 32.95071168063697, 6.921085230951323, 20.950944677011073, 34.8769765497458, 24.52947808453367, 18.421516769790234, 9.738982377154029, 20.36804455945525, 8.320479895773296, 22.773458503906138, 49.20049655170708, 11.531291197657584, 11.279696816723527, 15.91186949654167, 39.888184048190574, 5.755361650852187, 35.18063912322938, 18.879185327859886, 13.214670999011384, 22.252923584332088, 35.42862331469745, 21.393249837582996, 6.77301652240732, 29.444431332447927, 29.379312246984664, 42.50261781149093, 1.5774955324774647, 20.011961071845807, 27.664824317898333, 43.0843056021307, 34.68308410161656, 6.082262857054285, 17.784562416500275, 4.975061569644872, 9.537972098266874, 16.369043411596714, 21.66559833485555, 19.80327823590542, 9.170479066674243, 36.81422165039199, 2.1597742053959887, 15.017105657605635, 22.18835918326842, 25.690528498789387, 18.597421143251935, 39.39878092139971, 45.11489580712469, 13.957497373312973, 14.340516322400475, 22.459158561545905, 21.21305871793746, 3.5996427572040277, 18.24534542402192, 12.160939776440872, 18.037555947717227, 31.271699148518344, 38.54609506861874, 25.875358809762666, 34.63012658052476, 51.33463632650599, 33.53675418419881, 16.06929814927866, 31.813443768168774, 29.35755493525506, 27.12401446811867, 15.289338101083503, 9.303183568688626, 7.723919943573639, 19.74885786386198, 40.69500833967501, 30.142219475922044, 19.561131648478213, 48.15230056017721, 0.829086767051244, 38.30685787841803, 20.35378321745494, 18.199583643169316, 37.76398978574512, 46.35908199115275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29372761430541383, "mean_inference_ms": 0.9348245381631854, "mean_action_processing_ms": 0.1255926422934351, "mean_env_wait_ms": 0.06594836189290111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032056570053100586, "StateBufferConnector_ms": 0.002286076545715332, "ViewRequirementAgentConnector_ms": 0.05488276481628418}, "num_episodes": 66, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 605.072124808359, "num_env_steps_trained_throughput_per_sec": 605.072124808359, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 6156.962, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6156.917, "sample_time_ms": 701.422, "learn_time_ms": 5440.049, "learn_throughput": 735.287, "synch_weights_time_ms": 14.942}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 196, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-28", "timestamp": 1723391428, "time_this_iter_s": 6.669398784637451, "time_total_s": 1170.230417728424, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16030fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1170.230417728424, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 32.544444444444444, "ram_util_percent": 82.28888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.155539464019239, "cur_kl_coeff": 1.9387045606711582e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2896675331828495, "policy_loss": -0.004425827331093994, "vf_loss": 1.294093365718921, "vf_explained_var": 0.973148012223343, "kl": 0.005414960087240013, "entropy": 0.2975412090308964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1669609803706407, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3084787905837099, "policy_loss": -0.00825980880035786, "vf_loss": 1.3166895198325317, "vf_explained_var": 0.9724382596711317, "kl": 0.013960167521324488, "entropy": 0.6375526835521063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 63.43, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6343, "policy_reward_min": {"prey_policy": -51.33463632650599, "predator_policy": 0.829086767051244}, "policy_reward_max": {"prey_policy": -0.829086767051244, "predator_policy": 51.33463632650599}, "policy_reward_mean": {"prey_policy": -25.341158222602207, "predator_policy": 25.341158222602207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [47, 63, 48, 60, 76, 45, 58, 69, 71, 48, 65, 31, 56, 64, 63, 85, 57, 107, 56, 65, 80, 72, 32, 70, 48, 31, 82, 80, 69, 45, 80, 2, 57, 123, 64, 81, 78, 29, 27, 1, 10, 57, 55, 86, 82, 43, 57, 71, 65, 95, 75, 67, 54, 87, 61, 37, 56, 60, 82, 93, 35, 78, 58, 64, 60, 75, 78, 88, 78, 61, 71, 94, 81, 62, 99, 72, 54, 34, 47, 54, 77, 67, 58, 31, 62, 56, 63, 72, 73, 81, 80, 41, 87, 40, 97, 67, 61, 60, 58, 91], "policy_prey_policy_reward": [-22.18835918326842, -25.690528498789387, -18.597421143251935, -39.39878092139971, -45.11489580712469, -13.957497373312973, -14.340516322400475, -22.459158561545905, -21.21305871793746, -3.5996427572040277, -18.24534542402192, -12.160939776440872, -18.037555947717227, -31.271699148518344, -38.54609506861874, -25.875358809762666, -34.63012658052476, -51.33463632650599, -33.53675418419881, -16.06929814927866, -31.813443768168774, -29.35755493525506, -27.12401446811867, -15.289338101083503, -9.303183568688626, -7.723919943573639, -19.74885786386198, -40.69500833967501, -30.142219475922044, -19.561131648478213, -48.15230056017721, -0.829086767051244, -38.30685787841803, -20.35378321745494, -18.199583643169316, -37.76398978574512, -46.35908199115275, -16.467395649574556, -6.967406600798837, -1.3810246856358004, -2.072681376866913, -11.18369125142741, -18.507293781819765, -38.59605908642401, -42.818207106518834, -5.621545904915919, -36.07239014679798, -25.604517575641758, -31.64655441521089, -13.623704783194828, -37.219740270981944, -10.353527875732338, -12.649212736340719, -38.69501863874227, -22.68118330887521, -6.23313699127943, -11.400868491552117, -34.36211921962828, -33.76862753357568, -4.919055817450555, -10.10227436088305, -24.452580208519148, -42.61976610016391, -40.00562597137124, -6.534897634832529, -31.234601677612265, -46.975880132237954, -44.09809592840689, -29.28786157479491, -31.241135906947335, -41.78782969877752, -22.093049518856066, -38.69007697605008, -30.455784942371384, -39.0440472188741, -10.64333482365283, -24.054906965459697, -22.71103110145803, -25.931626745354816, -30.10659441115373, -42.17350325716619, -36.75938271806683, -24.571175547090316, -8.144310416388873, -12.835411419923364, -13.867249878773338, -23.266143905159755, -37.45126421263983, -41.40327987745089, -7.929270697561469, -19.287046320056817, -28.36300059217027, -36.73538755002939, -11.038429306782383, -28.21083216573862, -26.669594333615752, -31.975897066789823, -44.263380387669976, -23.359321177712744, -33.904951624853325], "policy_predator_policy_reward": [22.18835918326842, 25.690528498789387, 18.597421143251935, 39.39878092139971, 45.11489580712469, 13.957497373312973, 14.340516322400475, 22.459158561545905, 21.21305871793746, 3.5996427572040277, 18.24534542402192, 12.160939776440872, 18.037555947717227, 31.271699148518344, 38.54609506861874, 25.875358809762666, 34.63012658052476, 51.33463632650599, 33.53675418419881, 16.06929814927866, 31.813443768168774, 29.35755493525506, 27.12401446811867, 15.289338101083503, 9.303183568688626, 7.723919943573639, 19.74885786386198, 40.69500833967501, 30.142219475922044, 19.561131648478213, 48.15230056017721, 0.829086767051244, 38.30685787841803, 20.35378321745494, 18.199583643169316, 37.76398978574512, 46.35908199115275, 16.467395649574556, 6.967406600798837, 1.3810246856358004, 2.072681376866913, 11.18369125142741, 18.507293781819765, 38.59605908642401, 42.818207106518834, 5.621545904915919, 36.07239014679798, 25.604517575641758, 31.64655441521089, 13.623704783194828, 37.219740270981944, 10.353527875732338, 12.649212736340719, 38.69501863874227, 22.68118330887521, 6.23313699127943, 11.400868491552117, 34.36211921962828, 33.76862753357568, 4.919055817450555, 10.10227436088305, 24.452580208519148, 42.61976610016391, 40.00562597137124, 6.534897634832529, 31.234601677612265, 46.975880132237954, 44.09809592840689, 29.28786157479491, 31.241135906947335, 41.78782969877752, 22.093049518856066, 38.69007697605008, 30.455784942371384, 39.0440472188741, 10.64333482365283, 24.054906965459697, 22.71103110145803, 25.931626745354816, 30.10659441115373, 42.17350325716619, 36.75938271806683, 24.571175547090316, 8.144310416388873, 12.835411419923364, 13.867249878773338, 23.266143905159755, 37.45126421263983, 41.40327987745089, 7.929270697561469, 19.287046320056817, 28.36300059217027, 36.73538755002939, 11.038429306782383, 28.21083216573862, 26.669594333615752, 31.975897066789823, 44.263380387669976, 23.359321177712744, 33.904951624853325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2937404763552279, "mean_inference_ms": 0.9350798619891243, "mean_action_processing_ms": 0.12559088608576205, "mean_env_wait_ms": 0.06597415914685836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859180450439453, "StateBufferConnector_ms": 0.0022945404052734375, "ViewRequirementAgentConnector_ms": 0.052010178565979004}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 636.4242891311496, "num_env_steps_trained_throughput_per_sec": 636.4242891311496, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 1576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1576000, "timers": {"training_iteration_time_ms": 6147.281, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6147.237, "sample_time_ms": 702.254, "learn_time_ms": 5429.515, "learn_throughput": 736.714, "synch_weights_time_ms": 14.961}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "done": false, "training_iteration": 197, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-34", "timestamp": 1723391434, "time_this_iter_s": 6.295969724655151, "time_total_s": 1176.5263874530792, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602e78b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1176.5263874530792, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 28.699999999999996, "ram_util_percent": 82.11111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.185285716379682, "cur_kl_coeff": 1.9387045606711582e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1684684161717693, "policy_loss": -0.0023504421512673917, "vf_loss": 1.1708188580349088, "vf_explained_var": 0.9734351382901271, "kl": 0.004943311710483841, "entropy": 0.28847892112098633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.186583313345909, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1861852387587228, "policy_loss": -0.007224476484892269, "vf_loss": 1.1933709176878133, "vf_explained_var": 0.9723598464702566, "kl": 0.011034818865169696, "entropy": 0.6079086683069667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 64.01, "episode_media": {}, "episodes_this_iter": 63, "episodes_timesteps_total": 6401, "policy_reward_min": {"prey_policy": -46.975880132237954, "predator_policy": 0.6102048256193525}, "policy_reward_max": {"prey_policy": -0.6102048256193525, "predator_policy": 46.975880132237954}, "policy_reward_mean": {"prey_policy": -24.57529637676297, "predator_policy": 24.57529637676297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [64, 60, 75, 78, 88, 78, 61, 71, 94, 81, 62, 99, 72, 54, 34, 47, 54, 77, 67, 58, 31, 62, 56, 63, 72, 73, 81, 80, 41, 87, 40, 97, 67, 61, 60, 58, 91, 79, 31, 62, 51, 58, 34, 50, 45, 50, 81, 72, 88, 62, 78, 29, 51, 60, 1, 82, 86, 49, 77, 46, 67, 59, 40, 40, 57, 93, 72, 74, 68, 77, 71, 70, 71, 87, 68, 13, 95, 37, 88, 67, 48, 156, 44, 53, 24, 77, 51, 26, 53, 84, 57, 64, 90, 36, 46, 91, 59, 84, 69, 59], "policy_prey_policy_reward": [-40.00562597137124, -6.534897634832529, -31.234601677612265, -46.975880132237954, -44.09809592840689, -29.28786157479491, -31.241135906947335, -41.78782969877752, -22.093049518856066, -38.69007697605008, -30.455784942371384, -39.0440472188741, -10.64333482365283, -24.054906965459697, -22.71103110145803, -25.931626745354816, -30.10659441115373, -42.17350325716619, -36.75938271806683, -24.571175547090316, -8.144310416388873, -12.835411419923364, -13.867249878773338, -23.266143905159755, -37.45126421263983, -41.40327987745089, -7.929270697561469, -19.287046320056817, -28.36300059217027, -36.73538755002939, -11.038429306782383, -28.21083216573862, -26.669594333615752, -31.975897066789823, -44.263380387669976, -23.359321177712744, -33.904951624853325, -26.801216028898743, -10.498923822374323, -33.852186102982685, -11.561521738731244, -31.94675036385388, -15.208036278323922, -19.070965688308274, -15.381857195324343, -9.123704068183892, -42.50588920002629, -33.36204071189304, -31.114525657101503, -33.79119853507203, -30.610146244549558, -12.511468100861773, -7.370256446284722, -22.320949771004454, -0.6102048256193525, -21.1216286759731, -37.40748193259177, -27.146128981773938, -11.001486426279877, -8.199135159416116, -45.538251837406335, -24.796544696347524, -14.346766363754641, -14.70633414927929, -20.635743285129553, -22.73128183079958, -19.645943954785395, -40.74423397409806, -38.8496489844609, -32.018246011708456, -12.231973534872713, -21.669998366035525, -36.43647619616585, -18.70991800168831, -9.567304421486488, -6.521659112072042, -41.9288603469176, -8.156817040457106, -36.46165146087777, -30.282455168218654, -18.540684040290614, -38.878168444604015, -20.402086569771026, -27.138816497988106, -8.597984883446887, -27.424374035735468, -21.388724111754684, -1.2951003624725153, -17.64109347263495, -34.315635735683195, -10.232610700896574, -22.400413277169882, -46.5637753827696, -10.870509137789764, -24.661505357384527, -15.652495870943397, -22.254791774925657, -14.279939097629077, -26.547457466375523, -12.84044708019012], "policy_predator_policy_reward": [40.00562597137124, 6.534897634832529, 31.234601677612265, 46.975880132237954, 44.09809592840689, 29.28786157479491, 31.241135906947335, 41.78782969877752, 22.093049518856066, 38.69007697605008, 30.455784942371384, 39.0440472188741, 10.64333482365283, 24.054906965459697, 22.71103110145803, 25.931626745354816, 30.10659441115373, 42.17350325716619, 36.75938271806683, 24.571175547090316, 8.144310416388873, 12.835411419923364, 13.867249878773338, 23.266143905159755, 37.45126421263983, 41.40327987745089, 7.929270697561469, 19.287046320056817, 28.36300059217027, 36.73538755002939, 11.038429306782383, 28.21083216573862, 26.669594333615752, 31.975897066789823, 44.263380387669976, 23.359321177712744, 33.904951624853325, 26.801216028898743, 10.498923822374323, 33.852186102982685, 11.561521738731244, 31.94675036385388, 15.208036278323922, 19.070965688308274, 15.381857195324343, 9.123704068183892, 42.50588920002629, 33.36204071189304, 31.114525657101503, 33.79119853507203, 30.610146244549558, 12.511468100861773, 7.370256446284722, 22.320949771004454, 0.6102048256193525, 21.1216286759731, 37.40748193259177, 27.146128981773938, 11.001486426279877, 8.199135159416116, 45.538251837406335, 24.796544696347524, 14.346766363754641, 14.70633414927929, 20.635743285129553, 22.73128183079958, 19.645943954785395, 40.74423397409806, 38.8496489844609, 32.018246011708456, 12.231973534872713, 21.669998366035525, 36.43647619616585, 18.70991800168831, 9.567304421486488, 6.521659112072042, 41.9288603469176, 8.156817040457106, 36.46165146087777, 30.282455168218654, 18.540684040290614, 38.878168444604015, 20.402086569771026, 27.138816497988106, 8.597984883446887, 27.424374035735468, 21.388724111754684, 1.2951003624725153, 17.64109347263495, 34.315635735683195, 10.232610700896574, 22.400413277169882, 46.5637753827696, 10.870509137789764, 24.661505357384527, 15.652495870943397, 22.254791774925657, 14.279939097629077, 26.547457466375523, 12.84044708019012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29365659066203675, "mean_inference_ms": 0.9345938010511703, "mean_action_processing_ms": 0.12552736210627163, "mean_env_wait_ms": 0.06593178563525166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027486085891723633, "StateBufferConnector_ms": 0.001994013786315918, "ViewRequirementAgentConnector_ms": 0.04697418212890625}, "num_episodes": 63, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.487865180318, "num_env_steps_trained_throughput_per_sec": 677.487865180318, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 6100.009, "restore_workers_time_ms": 0.015, "training_step_time_ms": 6099.966, "sample_time_ms": 688.682, "learn_time_ms": 5395.732, "learn_throughput": 741.327, "synch_weights_time_ms": 15.112}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 198, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-40", "timestamp": 1723391440, "time_this_iter_s": 5.9102699756622314, "time_total_s": 1182.4366574287415, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16030fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1182.4366574287415, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 28.533333333333328, "ram_util_percent": 81.76666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3971450253079336, "cur_kl_coeff": 9.693522803355791e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5576989838853479, "policy_loss": -0.0016855560626330166, "vf_loss": 1.5593845379228393, "vf_explained_var": 0.9690316179767251, "kl": 0.0039272132653155245, "entropy": 0.29067732899760207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4334366830686727, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5517201943943897, "policy_loss": -0.006644553127989639, "vf_loss": 1.5583207359537483, "vf_explained_var": 0.9695251557355126, "kl": 0.012518796669392174, "entropy": 0.6262740600233276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 66.48, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 6648, "policy_reward_min": {"prey_policy": -56.351136804537155, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 56.351136804537155}, "policy_reward_mean": {"prey_policy": -23.347323337906133, "predator_policy": 23.347323337906133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [46, 67, 59, 40, 40, 57, 93, 72, 74, 68, 77, 71, 70, 71, 87, 68, 13, 95, 37, 88, 67, 48, 156, 44, 53, 24, 77, 51, 26, 53, 84, 57, 64, 90, 36, 46, 91, 59, 84, 69, 59, 166, 43, 44, 79, 79, 49, 77, 26, 49, 80, 72, 80, 96, 89, 93, 71, 44, 35, 37, 65, 55, 82, 69, 59, 133, 76, 67, 32, 49, 81, 58, 83, 45, 80, 89, 23, 1, 53, 86, 55, 78, 78, 96, 48, 59, 58, 52, 90, 99, 62, 83, 71, 71, 79, 46, 72, 74, 76, 75], "policy_prey_policy_reward": [-8.199135159416116, -45.538251837406335, -24.796544696347524, -14.346766363754641, -14.70633414927929, -20.635743285129553, -22.73128183079958, -19.645943954785395, -40.74423397409806, -38.8496489844609, -32.018246011708456, -12.231973534872713, -21.669998366035525, -36.43647619616585, -18.70991800168831, -9.567304421486488, -6.521659112072042, -41.9288603469176, -8.156817040457106, -36.46165146087777, -30.282455168218654, -18.540684040290614, -38.878168444604015, -20.402086569771026, -27.138816497988106, -8.597984883446887, -27.424374035735468, -21.388724111754684, -1.2951003624725153, -17.64109347263495, -34.315635735683195, -10.232610700896574, -22.400413277169882, -46.5637753827696, -10.870509137789764, -24.661505357384527, -15.652495870943397, -22.254791774925657, -14.279939097629077, -26.547457466375523, -12.84044708019012, -54.06640094556459, -25.708331847399325, -22.207157490004587, -37.36465709638009, -17.67472328278735, -34.64434756712999, -34.95587044637648, -10.750773362290094, -23.1684404561775, -12.569698623368588, -34.58938490911718, -8.121280243476015, -30.648267315051125, -29.316359672096226, -46.65498497742489, -41.392288991340905, -20.579407856456093, -16.01807393833257, -21.150667251066704, -6.835577273662259, -11.602576136195339, -45.9322923102784, -27.408761946799814, -15.21914501495359, -34.21814740152814, -23.73978828695554, -13.26435069874741, -17.26928925860221, -14.523017688702744, -17.793203362844245, -16.664212829596654, -28.3672606684215, -17.11470320257954, -30.806512441577446, -15.633454434932515, -6.069125607570671, 0.0, -7.427785541944678, -6.521421097243838, -28.805257993999682, -38.1646772667858, -27.981373407603833, -56.351136804537155, -8.50860459153902, -2.0525917407425642, -22.058658355456686, -26.747950075876684, -32.19130419648519, -30.409528622431452, -9.928960882356265, -37.54300728734045, -27.05187424130048, -31.979095232392467, -48.8693304460264, -6.709167552337228, -4.019708331069109, -27.969976806619403, -30.134031525558246, -33.15849975874515], "policy_predator_policy_reward": [8.199135159416116, 45.538251837406335, 24.796544696347524, 14.346766363754641, 14.70633414927929, 20.635743285129553, 22.73128183079958, 19.645943954785395, 40.74423397409806, 38.8496489844609, 32.018246011708456, 12.231973534872713, 21.669998366035525, 36.43647619616585, 18.70991800168831, 9.567304421486488, 6.521659112072042, 41.9288603469176, 8.156817040457106, 36.46165146087777, 30.282455168218654, 18.540684040290614, 38.878168444604015, 20.402086569771026, 27.138816497988106, 8.597984883446887, 27.424374035735468, 21.388724111754684, 1.2951003624725153, 17.64109347263495, 34.315635735683195, 10.232610700896574, 22.400413277169882, 46.5637753827696, 10.870509137789764, 24.661505357384527, 15.652495870943397, 22.254791774925657, 14.279939097629077, 26.547457466375523, 12.84044708019012, 54.06640094556459, 25.708331847399325, 22.207157490004587, 37.36465709638009, 17.67472328278735, 34.64434756712999, 34.95587044637648, 10.750773362290094, 23.1684404561775, 12.569698623368588, 34.58938490911718, 8.121280243476015, 30.648267315051125, 29.316359672096226, 46.65498497742489, 41.392288991340905, 20.579407856456093, 16.01807393833257, 21.150667251066704, 6.835577273662259, 11.602576136195339, 45.9322923102784, 27.408761946799814, 15.21914501495359, 34.21814740152814, 23.73978828695554, 13.26435069874741, 17.26928925860221, 14.523017688702744, 17.793203362844245, 16.664212829596654, 28.3672606684215, 17.11470320257954, 30.806512441577446, 15.633454434932515, 6.069125607570671, 0.0, 7.427785541944678, 6.521421097243838, 28.805257993999682, 38.1646772667858, 27.981373407603833, 56.351136804537155, 8.50860459153902, 2.0525917407425642, 22.058658355456686, 26.747950075876684, 32.19130419648519, 30.409528622431452, 9.928960882356265, 37.54300728734045, 27.05187424130048, 31.979095232392467, 48.8693304460264, 6.709167552337228, 4.019708331069109, 27.969976806619403, 30.134031525558246, 33.15849975874515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293603809489189, "mean_inference_ms": 0.9346133501921493, "mean_action_processing_ms": 0.1254827562902736, "mean_env_wait_ms": 0.06601420929071161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003003358840942383, "StateBufferConnector_ms": 0.001987934112548828, "ViewRequirementAgentConnector_ms": 0.046904802322387695}, "num_episodes": 59, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 649.8674522975077, "num_env_steps_trained_throughput_per_sec": 649.8674522975077, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 1592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1592000, "timers": {"training_iteration_time_ms": 6110.218, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6110.179, "sample_time_ms": 692.049, "learn_time_ms": 5402.505, "learn_throughput": 740.397, "synch_weights_time_ms": 15.19}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "done": false, "training_iteration": 199, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-46", "timestamp": 1723391446, "time_this_iter_s": 6.160535097122192, "time_total_s": 1188.5971925258636, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1602e7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1188.5971925258636, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 27.5625, "ram_util_percent": 81.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0383587551613647, "cur_kl_coeff": 4.8467614016778955e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2980292405001819, "policy_loss": -0.0010481594421435148, "vf_loss": 1.2990773979574441, "vf_explained_var": 0.9744969092930357, "kl": 0.0033446275069293724, "entropy": 0.29290279059981306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.201675819978118, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3042469810694457, "policy_loss": -0.005598751459911, "vf_loss": 1.3098162746677795, "vf_explained_var": 0.9743107171729207, "kl": 0.008377426221511542, "entropy": 0.6177144576484959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 60.88, "episode_media": {}, "episodes_this_iter": 68, "episodes_timesteps_total": 6088, "policy_reward_min": {"prey_policy": -56.351136804537155, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 56.351136804537155}, "policy_reward_mean": {"prey_policy": -23.774126813280937, "predator_policy": 23.774126813280937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [32, 49, 81, 58, 83, 45, 80, 89, 23, 1, 53, 86, 55, 78, 78, 96, 48, 59, 58, 52, 90, 99, 62, 83, 71, 71, 79, 46, 72, 74, 76, 75, 81, 69, 63, 81, 102, 72, 82, 49, 64, 52, 83, 75, 47, 27, 76, 42, 58, 75, 54, 27, 24, 81, 33, 31, 22, 71, 66, 71, 63, 73, 66, 62, 83, 66, 52, 60, 31, 65, 21, 35, 18, 40, 47, 5, 62, 71, 50, 49, 70, 79, 85, 92, 36, 26, 67, 53, 54, 26, 80, 75, 71, 60, 61, 62, 72, 55, 95, 70], "policy_prey_policy_reward": [-17.26928925860221, -14.523017688702744, -17.793203362844245, -16.664212829596654, -28.3672606684215, -17.11470320257954, -30.806512441577446, -15.633454434932515, -6.069125607570671, 0.0, -7.427785541944678, -6.521421097243838, -28.805257993999682, -38.1646772667858, -27.981373407603833, -56.351136804537155, -8.50860459153902, -2.0525917407425642, -22.058658355456686, -26.747950075876684, -32.19130419648519, -30.409528622431452, -9.928960882356265, -37.54300728734045, -27.05187424130048, -31.979095232392467, -48.8693304460264, -6.709167552337228, -4.019708331069109, -27.969976806619403, -30.134031525558246, -33.15849975874515, -34.42911388840648, -23.562460157035492, -42.975527798360666, -20.028345748279705, -28.209397177192237, -36.01847736749698, -14.848517796969382, -9.024421669439038, -5.592466528066403, -28.26924596570898, -50.604711832052736, -37.31686084395868, -7.10811272795922, -3.1722561656366652, -34.10926816132247, -19.422090030633356, -21.715498465110816, -22.983353413542165, -20.93039937037844, -10.30574343447223, -1.6911421653571415, -40.05298723490889, -14.510165762749665, -4.239991992579991, -15.17522445766629, -24.81536179607635, -21.024297983229634, -28.20528801955366, -5.906615120346638, -41.62599244086317, -27.79391291359759, -4.051940813704954, -34.46919373107374, -38.213365271858464, -21.319003350486224, -24.00905776796451, -15.845739900456426, -42.9572157673114, -11.966223201965857, -17.064241053846214, -12.00867439914684, -17.376544632842943, -23.089290539247383, -2.61844345723065, -23.26517995900739, -35.568294332965195, -32.004180693200574, -37.545713089568835, -5.378801472857797, -36.458712995023305, -46.53635874635397, -46.96584297269896, -15.23780423215301, -22.104490101598643, -16.62345681287502, -15.075562816210054, -25.968247549428746, -12.25128210351216, -50.48870265779813, -42.404244102064965, -37.880606702941854, -30.58314740021372, -39.81730471215964, -34.97082724730791, -44.92936759216707, -13.402912496876665, -14.748760315280334, -27.721976654523402], "policy_predator_policy_reward": [17.26928925860221, 14.523017688702744, 17.793203362844245, 16.664212829596654, 28.3672606684215, 17.11470320257954, 30.806512441577446, 15.633454434932515, 6.069125607570671, 0.0, 7.427785541944678, 6.521421097243838, 28.805257993999682, 38.1646772667858, 27.981373407603833, 56.351136804537155, 8.50860459153902, 2.0525917407425642, 22.058658355456686, 26.747950075876684, 32.19130419648519, 30.409528622431452, 9.928960882356265, 37.54300728734045, 27.05187424130048, 31.979095232392467, 48.8693304460264, 6.709167552337228, 4.019708331069109, 27.969976806619403, 30.134031525558246, 33.15849975874515, 34.42911388840648, 23.562460157035492, 42.975527798360666, 20.028345748279705, 28.209397177192237, 36.01847736749698, 14.848517796969382, 9.024421669439038, 5.592466528066403, 28.26924596570898, 50.604711832052736, 37.31686084395868, 7.10811272795922, 3.1722561656366652, 34.10926816132247, 19.422090030633356, 21.715498465110816, 22.983353413542165, 20.93039937037844, 10.30574343447223, 1.6911421653571415, 40.05298723490889, 14.510165762749665, 4.239991992579991, 15.17522445766629, 24.81536179607635, 21.024297983229634, 28.20528801955366, 5.906615120346638, 41.62599244086317, 27.79391291359759, 4.051940813704954, 34.46919373107374, 38.213365271858464, 21.319003350486224, 24.00905776796451, 15.845739900456426, 42.9572157673114, 11.966223201965857, 17.064241053846214, 12.00867439914684, 17.376544632842943, 23.089290539247383, 2.61844345723065, 23.26517995900739, 35.568294332965195, 32.004180693200574, 37.545713089568835, 5.378801472857797, 36.458712995023305, 46.53635874635397, 46.96584297269896, 15.23780423215301, 22.104490101598643, 16.62345681287502, 15.075562816210054, 25.968247549428746, 12.25128210351216, 50.48870265779813, 42.404244102064965, 37.880606702941854, 30.58314740021372, 39.81730471215964, 34.97082724730791, 44.92936759216707, 13.402912496876665, 14.748760315280334, 27.721976654523402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29360032943938663, "mean_inference_ms": 0.9341400667875328, "mean_action_processing_ms": 0.12544154279940312, "mean_env_wait_ms": 0.06596421105076936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030715465545654297, "StateBufferConnector_ms": 0.0020380020141601562, "ViewRequirementAgentConnector_ms": 0.047031283378601074}, "num_episodes": 68, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 663.3247422874023, "num_env_steps_trained_throughput_per_sec": 663.3247422874023, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 6118.48, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6118.442, "sample_time_ms": 683.973, "learn_time_ms": 5419.352, "learn_throughput": 738.096, "synch_weights_time_ms": 14.688}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 200, "trial_id": "abfb9_00000", "date": "2024-08-11_11-50-52", "timestamp": 1723391452, "time_this_iter_s": 6.035364151000977, "time_total_s": 1194.6325566768646, "pid": 78832, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17de040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1194.6325566768646, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 27.600000000000005, "ram_util_percent": 81.8111111111111}}
