{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2840836639205615, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.898829409480095, "policy_loss": -0.00595931427621205, "vf_loss": 6.9028690924247105, "vf_explained_var": 0.004445799750586351, "kl": 0.00959808417092211, "entropy": 1.5992654163390398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2546307773950198, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.902351121604442, "policy_loss": -0.001831669641736274, "vf_loss": 6.90346923917532, "vf_explained_var": 0.0036253631735841435, "kl": 0.0035677263899856287, "entropy": 1.6059778074423472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 365.6666666666667, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 3291, "policy_reward_min": {"prey_policy": -16.00956913628452, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 16.00956913628452}, "policy_reward_mean": {"prey_policy": 6.513110712100012, "predator_policy": -6.513110712100012}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3826400093695848, "mean_inference_ms": 1.3496240038791225, "mean_action_processing_ms": 0.15780813604317814, "mean_env_wait_ms": 0.2737944456201596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004393524593777127, "StateBufferConnector_ms": 0.0020477506849500868, "ViewRequirementAgentConnector_ms": 0.08182128270467122}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 717.3940744534029, "num_env_steps_trained_throughput_per_sec": 717.3940744534029, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 5575.744, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5575.703, "sample_time_ms": 1012.653, "learn_time_ms": 4551.939, "learn_throughput": 878.746, "synch_weights_time_ms": 10.708}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-16-39", "timestamp": 1723385799, "time_this_iter_s": 5.593000173568726, "time_total_s": 5.593000173568726, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fd785e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5.593000173568726, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.833333333333336, "ram_util_percent": 83.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.507118036597967, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.979735801617305, "policy_loss": -0.00701754551215951, "vf_loss": 6.984533853828907, "vf_explained_var": 0.010005846743782361, "kl": 0.01109759813149524, "entropy": 1.5833712708204986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5199825855903328, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.984737730026245, "policy_loss": -0.005437395832025989, "vf_loss": 6.989063704013825, "vf_explained_var": 0.009465786317984263, "kl": 0.011114069548622041, "entropy": 1.6013667179892461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.55555555555554, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 6652, "policy_reward_min": {"prey_policy": -23.108068865887624, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 23.108068865887624}, "policy_reward_mean": {"prey_policy": 0.37110217674280765, "predator_policy": -0.37110217674280765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3714057653450423, "mean_inference_ms": 1.2805912078316355, "mean_action_processing_ms": 0.15340633870996107, "mean_env_wait_ms": 0.26184281140341764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004655122756958008, "StateBufferConnector_ms": 0.0021861659155951608, "ViewRequirementAgentConnector_ms": 0.08710953924391004}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.9624602316779, "num_env_steps_trained_throughput_per_sec": 800.9624602316779, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 5284.871, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5284.835, "sample_time_ms": 916.204, "learn_time_ms": 4357.541, "learn_throughput": 917.949, "synch_weights_time_ms": 10.739}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-16-46", "timestamp": 1723385806, "time_this_iter_s": 4.996516942977905, "time_total_s": 10.58951711654663, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe10430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.58951711654663, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.544444444444448, "ram_util_percent": 83.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.188396263541654, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.371592257420222, "policy_loss": -0.0031793581855405744, "vf_loss": 7.373230305810769, "vf_explained_var": -0.008029777618745963, "kl": 0.007706647133076139, "entropy": 1.5951620003829399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1740346206119283, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.382084374626477, "policy_loss": -0.005311956529718979, "vf_loss": 7.38584713836511, "vf_explained_var": -0.008291373029351234, "kl": 0.01549203174046907, "entropy": 1.5776121832430363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.37931034482756, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 10625, "policy_reward_min": {"prey_policy": -23.108068865887624, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 23.108068865887624}, "policy_reward_mean": {"prey_policy": 0.32972495627721476, "predator_policy": -0.32972495627721476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35629808678085756, "mean_inference_ms": 1.214764579806565, "mean_action_processing_ms": 0.14829327995358382, "mean_env_wait_ms": 0.24886452371131987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042755028297161235, "StateBufferConnector_ms": 0.0021313798838648304, "ViewRequirementAgentConnector_ms": 0.07116383519665949}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 831.745095942448, "num_env_steps_trained_throughput_per_sec": 831.745095942448, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 5126.305, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5126.269, "sample_time_ms": 853.584, "learn_time_ms": 4261.696, "learn_throughput": 938.593, "synch_weights_time_ms": 10.645}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-16-51", "timestamp": 1723385811, "time_this_iter_s": 4.811619758605957, "time_total_s": 15.401136875152588, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fd64ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15.401136875152588, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.885714285714286, "ram_util_percent": 83.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4526652687384436, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.846055613458157, "policy_loss": -0.014347925000765826, "vf_loss": 6.855751938124498, "vf_explained_var": 0.05562542869398991, "kl": 0.023258023677709534, "entropy": 1.5873566639920076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.606764097775643, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.854649285475413, "policy_loss": -0.007482967075581352, "vf_loss": 6.8603422691424685, "vf_explained_var": 0.056178427984317145, "kl": 0.017899679524748847, "entropy": 1.5333787397791943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 362.525, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 14501, "policy_reward_min": {"prey_policy": -24.563109354570834, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 24.563109354570834}, "policy_reward_mean": {"prey_policy": 3.2081299133297856, "predator_policy": -3.2081299133297856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34495497023799265, "mean_inference_ms": 1.1739514682097245, "mean_action_processing_ms": 0.145168155319848, "mean_env_wait_ms": 0.24111832484027246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093050956726074, "StateBufferConnector_ms": 0.002073347568511963, "ViewRequirementAgentConnector_ms": 0.06436467170715332}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 818.873210412661, "num_env_steps_trained_throughput_per_sec": 818.873210412661, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 5065.922, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5065.886, "sample_time_ms": 822.372, "learn_time_ms": 4232.732, "learn_throughput": 945.016, "synch_weights_time_ms": 10.448}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-16-56", "timestamp": 1723385816, "time_this_iter_s": 4.887092113494873, "time_total_s": 20.28822898864746, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe10820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.28822898864746, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.785714285714285, "ram_util_percent": 83.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4729750867933036, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.600549276173115, "policy_loss": -0.008652680348313879, "vf_loss": 6.605861993134022, "vf_explained_var": -0.07558526769280434, "kl": 0.011133214305720951, "entropy": 1.565309724956751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.428248439201464, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.619683904449145, "policy_loss": -0.0004105167795690553, "vf_loss": 6.619339527189732, "vf_explained_var": -0.07694701167444389, "kl": 0.007549241796125348, "entropy": 1.5162810667107502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.40816326530614, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 18101, "policy_reward_min": {"prey_policy": -24.563109354570834, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 24.563109354570834}, "policy_reward_mean": {"prey_policy": 3.585000399728383, "predator_policy": -3.585000399728383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34027360910246296, "mean_inference_ms": 1.1551152173446373, "mean_action_processing_ms": 0.14361443763230936, "mean_env_wait_ms": 0.2393263457836255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004073551722935268, "StateBufferConnector_ms": 0.0023766439788195553, "ViewRequirementAgentConnector_ms": 0.06978511810302734}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 794.9342440489204, "num_env_steps_trained_throughput_per_sec": 794.9342440489204, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 5059.111, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5059.077, "sample_time_ms": 827.481, "learn_time_ms": 4220.794, "learn_throughput": 947.689, "synch_weights_time_ms": 10.467}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-01", "timestamp": 1723385821, "time_this_iter_s": 5.034569978713989, "time_total_s": 25.32279896736145, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe10940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.32279896736145, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.42857142857143, "ram_util_percent": 82.8142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6399601492720346, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.889297706882159, "policy_loss": -0.002116732526337728, "vf_loss": 6.889605904618899, "vf_explained_var": 0.13502082222451767, "kl": 0.006028483320374415, "entropy": 1.5577494664738576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5066260076438387, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.9143265068531035, "policy_loss": -0.002764088114296707, "vf_loss": 6.916252112885316, "vf_explained_var": 0.13146324548870325, "kl": 0.008384912115410642, "entropy": 1.545008751625816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 371.6, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 22296, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": 0.12900845478351672, "predator_policy": -0.12900845478351672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3360939544854031, "mean_inference_ms": 1.1393557038113957, "mean_action_processing_ms": 0.1425395581586496, "mean_env_wait_ms": 0.23800004621007004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004020333290100098, "StateBufferConnector_ms": 0.0023134549458821616, "ViewRequirementAgentConnector_ms": 0.06537715593973796}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 704.7093654194238, "num_env_steps_trained_throughput_per_sec": 704.7093654194238, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 5161.944, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5161.908, "sample_time_ms": 827.969, "learn_time_ms": 4320.27, "learn_throughput": 925.868, "synch_weights_time_ms": 12.81}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-07", "timestamp": 1723385827, "time_this_iter_s": 5.758156061172485, "time_total_s": 31.080955028533936, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21faca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.080955028533936, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 51.43333333333333, "ram_util_percent": 82.57777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.807264245658492, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.40337896173199, "policy_loss": -0.004829870505879323, "vf_loss": 5.406032147010167, "vf_explained_var": 0.23153666201978923, "kl": 0.0072556028916045, "entropy": 1.5219879494359096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8558296032560366, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.397214234620333, "policy_loss": -0.007171275345414566, "vf_loss": 5.402703657746315, "vf_explained_var": 0.2300249914949139, "kl": 0.01681858459374156, "entropy": 1.571406891196966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 361.63013698630135, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 26399, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": -3.3327182198130947, "predator_policy": 3.3327182198130947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3365016510161676, "mean_inference_ms": 1.1438876281458585, "mean_action_processing_ms": 0.14362084098616681, "mean_env_wait_ms": 0.24162225560410974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039489301916671125, "StateBufferConnector_ms": 0.0023438505930443334, "ViewRequirementAgentConnector_ms": 0.06512844399230121}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 701.0040729329003, "num_env_steps_trained_throughput_per_sec": 701.0040729329003, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 5239.682, "restore_workers_time_ms": 0.018, "training_step_time_ms": 5239.64, "sample_time_ms": 898.789, "learn_time_ms": 4327.402, "learn_throughput": 924.342, "synch_weights_time_ms": 12.658}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-13", "timestamp": 1723385833, "time_this_iter_s": 5.708673000335693, "time_total_s": 36.78962802886963, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe10820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.78962802886963, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.1625, "ram_util_percent": 81.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7046923599516353, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.9508429281413555, "policy_loss": 0.00011542956296276922, "vf_loss": 4.95027308439215, "vf_explained_var": 0.11854946352541447, "kl": 0.0015147262192459394, "entropy": 1.4865884322673082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5565434166230263, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.934313535690308, "policy_loss": -0.010230604267659753, "vf_loss": 4.942455662290255, "vf_explained_var": 0.11791992485523224, "kl": 0.020884734373069903, "entropy": 1.5216915864497422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 353.48837209302326, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 30400, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": -5.20524150017895, "predator_policy": 5.20524150017895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3352265485296354, "mean_inference_ms": 1.1420654729916646, "mean_action_processing_ms": 0.1437768237775259, "mean_env_wait_ms": 0.24254599115355174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037714492442996, "StateBufferConnector_ms": 0.002300600672877112, "ViewRequirementAgentConnector_ms": 0.062232100686361626}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.4682124336323, "num_env_steps_trained_throughput_per_sec": 797.4682124336323, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 5211.708, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5211.666, "sample_time_ms": 871.708, "learn_time_ms": 4326.827, "learn_throughput": 924.465, "synch_weights_time_ms": 12.392}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-18", "timestamp": 1723385838, "time_this_iter_s": 5.019943952560425, "time_total_s": 41.809571981430054, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.809571981430054, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.82857142857143, "ram_util_percent": 80.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2486972008521358, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.555346340437731, "policy_loss": -0.0068398179976308406, "vf_loss": 6.56068571805954, "vf_explained_var": 0.07661041244864464, "kl": 0.010002952314533313, "entropy": 1.4494998771697283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2631204350230596, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.525979198018709, "policy_loss": -0.013185805783238417, "vf_loss": 6.536465234061082, "vf_explained_var": 0.07513814009726047, "kl": 0.017998541728583797, "entropy": 1.4638868787636359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 347.04040404040404, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34357, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -43.75377979897358}, "policy_reward_max": {"prey_policy": 43.75377979897358, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": -4.787669662131686, "predator_policy": 4.787669662131686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400], "policy_prey_policy_reward": [13.094653096541247, 0.1261709027741169, -16.00956913628452, 2.640164332581378, -0.10916445261538321, 10.719777380246848, -12.542867139117266, 16.945051625800108, 43.75377979897358, -20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644], "policy_predator_policy_reward": [-13.094653096541247, -0.1261709027741169, 16.00956913628452, -2.640164332581378, 0.10916445261538321, -10.719777380246848, 12.542867139117266, -16.945051625800108, -43.75377979897358, 20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33396790546110633, "mean_inference_ms": 1.1384114934751386, "mean_action_processing_ms": 0.14376232466803973, "mean_env_wait_ms": 0.24287737864485948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003727638360225793, "StateBufferConnector_ms": 0.002470883456143466, "ViewRequirementAgentConnector_ms": 0.061730905012650925}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 808.3393218025489, "num_env_steps_trained_throughput_per_sec": 808.3393218025489, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 5182.454, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5182.413, "sample_time_ms": 855.467, "learn_time_ms": 4314.182, "learn_throughput": 927.175, "synch_weights_time_ms": 12.075}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-23", "timestamp": 1723385843, "time_this_iter_s": 4.951014995574951, "time_total_s": 46.760586977005005, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46.760586977005005, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 32.55714285714286, "ram_util_percent": 80.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5318987179237107, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.653056453665098, "policy_loss": -0.0007776835375504258, "vf_loss": 6.653215239942074, "vf_explained_var": 0.019551513157784937, "kl": 0.004125925373743425, "entropy": 1.4653911905984083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.517489153301964, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.650210393965244, "policy_loss": -0.002726379254939578, "vf_loss": 6.651662027339141, "vf_explained_var": 0.016496853219966093, "kl": 0.008498392410660952, "entropy": 1.4260394414265951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 347.35, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34735, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -41.46772580629442}, "policy_reward_max": {"prey_policy": 41.46772580629442, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": -3.5846126738762663, "predator_policy": 3.5846126738762663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 161, 400, 400, 400, 400, 400, 400, 94, 279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-20.361814460114434, -8.137013150347197, -6.676316534243309, -20.181288447539078, 32.79449668202218, -23.108068865887624, -1.396648310864034, -10.48662770621254, 5.615123565656468, 4.967864432271099, -16.78801343708081, -14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597], "policy_predator_policy_reward": [20.361814460114434, 8.137013150347197, 6.676316534243309, 20.181288447539078, -32.79449668202218, 23.108068865887624, 1.396648310864034, 10.48662770621254, -5.615123565656468, -4.967864432271099, 16.78801343708081, 14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3282952122470528, "mean_inference_ms": 1.1151608897824932, "mean_action_processing_ms": 0.1423101185741022, "mean_env_wait_ms": 0.23993636151477665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036058425903320312, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.05929136276245117}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 784.4467858107714, "num_env_steps_trained_throughput_per_sec": 784.4467858107714, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 5174.123, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5174.083, "sample_time_ms": 843.421, "learn_time_ms": 4318.132, "learn_throughput": 926.326, "synch_weights_time_ms": 11.876}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-28", "timestamp": 1723385848, "time_this_iter_s": 5.101724863052368, "time_total_s": 51.86231184005737, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.86231184005737, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.05714285714286, "ram_util_percent": 80.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4945369138382376, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.448561798036098, "policy_loss": -0.003477759933108852, "vf_loss": 5.451608855525652, "vf_explained_var": 0.006582214372853438, "kl": 0.005742859163206604, "entropy": 1.4279593928406635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.468563379906118, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.457651171833277, "policy_loss": -0.003408207061875146, "vf_loss": 5.459322505195936, "vf_explained_var": 0.0022482537974913915, "kl": 0.011579167845495893, "entropy": 1.3904471026112637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 352.8, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35280, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -57.80186797360228}, "policy_reward_max": {"prey_policy": 57.80186797360228, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": 0.6310321396535075, "predator_policy": -0.6310321396535075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [279, 400, 400, 400, 400, 400, 400, 400, 400, 322, 400, 400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-14.662486388129583, 14.35660603788833, -10.595471816519646, 28.981826951822377, -19.573890257988438, -1.8669827554448126, 10.25991726692181, -8.054557536910833, 15.857372053839192, -7.920202383506364, 41.46772580629442, 40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633], "policy_predator_policy_reward": [14.662486388129583, -14.35660603788833, 10.595471816519646, -28.981826951822377, 19.573890257988438, 1.8669827554448126, -10.25991726692181, 8.054557536910833, -15.857372053839192, 7.920202383506364, -41.46772580629442, -40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32414136948020206, "mean_inference_ms": 1.1033761407003568, "mean_action_processing_ms": 0.14161337947450497, "mean_env_wait_ms": 0.23948163037730213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341641902923584, "StateBufferConnector_ms": 0.0024509429931640625, "ViewRequirementAgentConnector_ms": 0.055329322814941406}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.0467623325669, "num_env_steps_trained_throughput_per_sec": 811.0467623325669, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 5109.739, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5109.701, "sample_time_ms": 815.22, "learn_time_ms": 4281.952, "learn_throughput": 934.153, "synch_weights_time_ms": 11.881}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-33", "timestamp": 1723385853, "time_this_iter_s": 4.9345972537994385, "time_total_s": 56.79690909385681, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56.79690909385681, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.214285714285715, "ram_util_percent": 80.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3386278103416165, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.542941349744797, "policy_loss": -0.009464970585152816, "vf_loss": 5.550392154852549, "vf_explained_var": 0.010864423774182796, "kl": 0.026855514264103632, "entropy": 1.3467986114323138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3563699446928998, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.559978228559097, "policy_loss": -0.005371854177792556, "vf_loss": 5.563720483829578, "vf_explained_var": 0.004329876167078813, "kl": 0.010863919979001293, "entropy": 1.4340603033701578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 351.1, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35110, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -58.359354501881}, "policy_reward_max": {"prey_policy": 58.359354501881, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": 2.8162649205717396, "predator_policy": -2.8162649205717396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 139, 400, 215, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31], "policy_prey_policy_reward": [40.82280045957498, 26.068614102734575, 7.76653549609243, 25.76740330206773, -24.563109354570834, 2.594685263552332, -13.645874808919835, 19.834745484499745, 0.5698494333330046, 2.495419065294218, 15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276], "policy_predator_policy_reward": [-40.82280045957498, -26.068614102734575, -7.76653549609243, -25.76740330206773, 24.563109354570834, -2.594685263552332, 13.645874808919835, -19.834745484499745, -0.5698494333330046, -2.495419065294218, -15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3225466211833091, "mean_inference_ms": 1.0995138109805864, "mean_action_processing_ms": 0.1415594242654425, "mean_env_wait_ms": 0.24004099830822218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003337860107421875, "StateBufferConnector_ms": 0.0024493932723999023, "ViewRequirementAgentConnector_ms": 0.05787527561187744}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 817.9201227454286, "num_env_steps_trained_throughput_per_sec": 817.9201227454286, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 5099.385, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5099.346, "sample_time_ms": 804.535, "learn_time_ms": 4282.347, "learn_throughput": 934.067, "synch_weights_time_ms": 11.813}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-38", "timestamp": 1723385858, "time_this_iter_s": 4.894411087036133, "time_total_s": 61.691320180892944, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.691320180892944, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 32.01428571428571, "ram_util_percent": 80.97142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4293819575260083, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.972870168089867, "policy_loss": -0.0011249203045736067, "vf_loss": 5.973561674356461, "vf_explained_var": -0.0031967271119356156, "kl": 0.0038524723749965555, "entropy": 1.3304935518652201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3947522993199528, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9799142390489575, "policy_loss": -0.006116086870315484, "vf_loss": 5.9836021656791365, "vf_explained_var": -0.01629840930302938, "kl": 0.016187677539225016, "entropy": 1.3837466675788164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 355.56, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35556, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": 5.943690863955867, "predator_policy": -5.943690863955867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [15.377495804950179, -5.878006329409612, 4.712753636543681, -1.9220218459435472, -9.403275859569248, 41.33921120123105, 5.150641797923978, -4.532394417521324, -12.102975574338219, 26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577], "policy_predator_policy_reward": [-15.377495804950179, 5.878006329409612, -4.712753636543681, 1.9220218459435472, 9.403275859569248, -41.33921120123105, -5.150641797923978, 4.532394417521324, 12.102975574338219, -26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32297267515605393, "mean_inference_ms": 1.0998656203669794, "mean_action_processing_ms": 0.14187719161544907, "mean_env_wait_ms": 0.24108446797117866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032613277435302734, "StateBufferConnector_ms": 0.0024878978729248047, "ViewRequirementAgentConnector_ms": 0.05820107460021973}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 817.7964089953035, "num_env_steps_trained_throughput_per_sec": 817.7964089953035, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 5107.587, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5107.549, "sample_time_ms": 813.591, "learn_time_ms": 4281.58, "learn_throughput": 934.235, "synch_weights_time_ms": 11.726}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-42", "timestamp": 1723385862, "time_this_iter_s": 4.894088268280029, "time_total_s": 66.58540844917297, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.58540844917297, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.900000000000006, "ram_util_percent": 81.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4336603308096527, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.814436158786218, "policy_loss": -0.008207784304249798, "vf_loss": 4.82165234486262, "vf_explained_var": 0.01591836630056302, "kl": 0.01762830639306431, "entropy": 1.325535224750638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3472116185662648, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.824040855218967, "policy_loss": -0.0015870780329957294, "vf_loss": 4.824818309148153, "vf_explained_var": 0.006970200004676978, "kl": 0.005397558254441145, "entropy": 1.342530872176091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 355.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35591, "policy_reward_min": {"prey_policy": -46.250339867082786, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 46.250339867082786}, "policy_reward_mean": {"prey_policy": 8.807875831465397, "predator_policy": -8.807875831465397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 391, 400, 309, 400, 400, 400, 330, 400, 400, 400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [26.95973167042606, -29.219071210876024, -23.7892752725403, -46.250339867082786, -19.80969238903269, -15.480331012219516, 2.36907717395108, -34.30615681411518, -12.25824552970034, -4.037233474151871, -23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902], "policy_predator_policy_reward": [-26.95973167042606, 29.219071210876024, 23.7892752725403, 46.250339867082786, 19.80969238903269, 15.480331012219516, -2.36907717395108, 34.30615681411518, 12.25824552970034, 4.037233474151871, 23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3227204747081928, "mean_inference_ms": 1.0992152305844427, "mean_action_processing_ms": 0.14211513050816038, "mean_env_wait_ms": 0.24095977896635304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031584501266479492, "StateBufferConnector_ms": 0.003589034080505371, "ViewRequirementAgentConnector_ms": 0.05374562740325928}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.4050829348867, "num_env_steps_trained_throughput_per_sec": 799.4050829348867, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 5119.483, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5119.446, "sample_time_ms": 820.571, "learn_time_ms": 4286.505, "learn_throughput": 933.161, "synch_weights_time_ms": 11.719}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-47", "timestamp": 1723385867, "time_this_iter_s": 5.0064098834991455, "time_total_s": 71.59181833267212, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.59181833267212, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.975, "ram_util_percent": 81.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5128745163480442, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6144843103984994, "policy_loss": -0.0025425190535315776, "vf_loss": 3.616338967035214, "vf_explained_var": 0.04064611165473859, "kl": 0.01222886141072867, "entropy": 1.2218435024221739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4589542246889322, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6124373356501263, "policy_loss": -0.0016787655981412779, "vf_loss": 3.61304491981864, "vf_explained_var": 0.029515657077232995, "kl": 0.007141232644939726, "entropy": 1.3358835053940614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 354.53, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35453, "policy_reward_min": {"prey_policy": -38.31907045777801, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 38.31907045777801}, "policy_reward_mean": {"prey_policy": 12.287959554591133, "predator_policy": -12.287959554591133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 331, 400, 400, 400, 332, 193, 22, 400, 283, 390, 351, 201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-23.454100645981356, -9.066044888032193, -20.757702531713953, -11.849844847629853, -18.282955375457146, -36.7016408483932, -31.385248711304524, -5.077780817453375, -1.5182496249695472, -4.601977632942949, -31.477907891396168, -30.37321968473319, -26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403], "policy_predator_policy_reward": [23.454100645981356, 9.066044888032193, 20.757702531713953, 11.849844847629853, 18.282955375457146, 36.7016408483932, 31.385248711304524, 5.077780817453375, 1.5182496249695472, 4.601977632942949, 31.477907891396168, 30.37321968473319, 26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3225417160597456, "mean_inference_ms": 1.0978363391018278, "mean_action_processing_ms": 0.14212900894606115, "mean_env_wait_ms": 0.24055647845763764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003054022789001465, "StateBufferConnector_ms": 0.003599405288696289, "ViewRequirementAgentConnector_ms": 0.053972601890563965}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 829.1875806034384, "num_env_steps_trained_throughput_per_sec": 829.1875806034384, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 5098.697, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5098.659, "sample_time_ms": 811.769, "learn_time_ms": 4274.622, "learn_throughput": 935.755, "synch_weights_time_ms": 11.622}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-52", "timestamp": 1723385872, "time_this_iter_s": 4.826474905014038, "time_total_s": 76.41829323768616, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.41829323768616, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.13333333333333, "ram_util_percent": 81.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.348208474072938, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.767041573425134, "policy_loss": -0.006554751850004929, "vf_loss": 3.772723446538051, "vf_explained_var": 0.03797720316797495, "kl": 0.015517843578141463, "entropy": 1.179688530912002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3090798899220923, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.772342803825935, "policy_loss": -0.006928753285319544, "vf_loss": 3.778418497244517, "vf_explained_var": 0.02634660539527734, "kl": 0.005687031710480311, "entropy": 1.333112304409345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.51, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36351, "policy_reward_min": {"prey_policy": -38.31907045777801, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 38.31907045777801}, "policy_reward_mean": {"prey_policy": 17.70623551846764, "predator_policy": -17.70623551846764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [201, 400, 182, 400, 400, 1, 400, 400, 236, 323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-26.482263833359475, -7.985044985148637, -11.471153297786545, 5.077512302310867, -24.216098085321843, -0.07899957146665326, -22.82058033626648, -31.528432704219, -33.436298183618575, -21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923], "policy_predator_policy_reward": [26.482263833359475, 7.985044985148637, 11.471153297786545, -5.077512302310867, 24.216098085321843, 0.07899957146665326, 22.82058033626648, 31.528432704219, 33.436298183618575, 21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3191843677610779, "mean_inference_ms": 1.084891214378652, "mean_action_processing_ms": 0.14075687642287474, "mean_env_wait_ms": 0.23644597779847665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002963423728942871, "StateBufferConnector_ms": 0.0036014318466186523, "ViewRequirementAgentConnector_ms": 0.052094340324401855}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.5586408504015, "num_env_steps_trained_throughput_per_sec": 791.5586408504015, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 5036.419, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5036.382, "sample_time_ms": 811.255, "learn_time_ms": 4214.652, "learn_throughput": 949.07, "synch_weights_time_ms": 10.148}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-17-57", "timestamp": 1723385877, "time_this_iter_s": 5.05598521232605, "time_total_s": 81.4742784500122, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21fad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 81.4742784500122, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.65, "ram_util_percent": 81.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5816911873407662, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.193913451458017, "policy_loss": -0.001631725913224121, "vf_loss": 3.195108621070782, "vf_explained_var": 0.036040629570682846, "kl": 0.007760863612484552, "entropy": 1.0701672454054156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4367686359677463, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1931842871010305, "policy_loss": -3.0731948694059e-05, "vf_loss": 3.19304464807113, "vf_explained_var": 0.026049822258452576, "kl": 0.001135823487714501, "entropy": 1.324057270338138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 373.31, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37331, "policy_reward_min": {"prey_policy": -38.31907045777801, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 38.31907045777801}, "policy_reward_mean": {"prey_policy": 21.60211129807441, "predator_policy": -21.60211129807441}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [323, 343, 400, 400, 116, 400, 400, 57, 400, 400, 400, 400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-21.449504261066398, -37.12604198346593, -5.046795617445881, -8.20413243961324, -6.076769805925424, 10.32278941057481, -6.6121687075096, -9.470919414957024, -38.31907045777801, 18.16674207877844, 16.33372173898878, 1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367], "policy_predator_policy_reward": [21.449504261066398, 37.12604198346593, 5.046795617445881, 8.20413243961324, 6.076769805925424, -10.32278941057481, 6.6121687075096, 9.470919414957024, 38.31907045777801, -18.16674207877844, -16.33372173898878, -1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31760004206132275, "mean_inference_ms": 1.077794143959205, "mean_action_processing_ms": 0.14005868686057465, "mean_env_wait_ms": 0.2339922254340429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002951979637145996, "StateBufferConnector_ms": 0.003592371940612793, "ViewRequirementAgentConnector_ms": 0.052117347717285156}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 826.0504509098132, "num_env_steps_trained_throughput_per_sec": 826.0504509098132, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 4950.04, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4950.009, "sample_time_ms": 755.2, "learn_time_ms": 4184.452, "learn_throughput": 955.92, "synch_weights_time_ms": 10.038}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-02", "timestamp": 1723385882, "time_this_iter_s": 4.845251083374023, "time_total_s": 86.31952953338623, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 86.31952953338623, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.28333333333334, "ram_util_percent": 81.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2224289271980524, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.233637610077858, "policy_loss": -0.009649224962049629, "vf_loss": 4.241987375666698, "vf_explained_var": -0.05497376347581546, "kl": 0.02310128314355787, "entropy": 0.9784078752001126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2607013215931753, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.237717663993438, "policy_loss": -0.003174104373950589, "vf_loss": 4.239825828373432, "vf_explained_var": -0.05907010460893313, "kl": 0.01421281295885122, "entropy": 1.3058813000718752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.61, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37761, "policy_reward_min": {"prey_policy": -34.74271306057371, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 34.74271306057371}, "policy_reward_mean": {"prey_policy": 25.469471954033235, "predator_policy": -25.469471954033235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 265, 400, 12, 400, 23, 400, 400, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69], "policy_prey_policy_reward": [1.9569319761515587, -27.930499626115953, -12.944738929240117, -2.36246257562098, 14.12982346490891, -4.024265721566694, 14.425589227738644, 17.742983736484113, 28.87860871120789, -6.344604096527034, 23.787761767707124, 21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367, 18.37970243791159, 36.622388381844544, 24.519247151314076, 29.011371384574154, 26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156], "policy_predator_policy_reward": [-1.9569319761515587, 27.930499626115953, 12.944738929240117, 2.36246257562098, -14.12982346490891, 4.024265721566694, -14.425589227738644, -17.742983736484113, -28.87860871120789, 6.344604096527034, -23.787761767707124, -21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367, -18.37970243791159, -36.622388381844544, -24.519247151314076, -29.011371384574154, -26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31624724500732454, "mean_inference_ms": 1.0694806341905587, "mean_action_processing_ms": 0.13935729994839763, "mean_env_wait_ms": 0.23161065050128243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889871597290039, "StateBufferConnector_ms": 0.003512740135192871, "ViewRequirementAgentConnector_ms": 0.05238044261932373}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 769.7724169643415, "num_env_steps_trained_throughput_per_sec": 769.7724169643415, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 4968.086, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4968.055, "sample_time_ms": 763.864, "learn_time_ms": 4193.736, "learn_throughput": 953.803, "synch_weights_time_ms": 10.14}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-07", "timestamp": 1723385887, "time_this_iter_s": 5.200797080993652, "time_total_s": 91.52032661437988, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fdbeee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 91.52032661437988, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.7875, "ram_util_percent": 81.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7604864576986681, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6846317219237488, "policy_loss": -0.00547428726349608, "vf_loss": 3.689703979094823, "vf_explained_var": -0.04144592719773452, "kl": 0.004764743101514803, "entropy": 1.055340249526004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9098271952786793, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6891270947953063, "policy_loss": -0.003365194810127529, "vf_loss": 3.692024329304695, "vf_explained_var": -0.041252279902497926, "kl": 0.006239678449308595, "entropy": 1.3270854368805884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.81, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38681, "policy_reward_min": {"prey_policy": -34.74271306057371, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 34.74271306057371}, "policy_reward_mean": {"prey_policy": 26.763844788944343, "predator_policy": -26.763844788944343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [21.130819957190727, -4.739087229533737, 34.39881378183137, 28.69837293105719, 41.467579794152364, -10.885223781259597, 17.459434617435996, 23.169713175430438, 43.96845560850721, 24.94156761920066, 38.84158199134215, 19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367, 18.37970243791159, 36.622388381844544, 24.519247151314076, 29.011371384574154, 26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156, 7.439089859846021, 23.924352188592394, 23.306919769087607, 43.28466063298158, -29.765311592060424, 20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384], "policy_predator_policy_reward": [-21.130819957190727, 4.739087229533737, -34.39881378183137, -28.69837293105719, -41.467579794152364, 10.885223781259597, -17.459434617435996, -23.169713175430438, -43.96845560850721, -24.94156761920066, -38.84158199134215, -19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367, -18.37970243791159, -36.622388381844544, -24.519247151314076, -29.011371384574154, -26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156, -7.439089859846021, -23.924352188592394, -23.306919769087607, -43.28466063298158, 29.765311592060424, -20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31504821084645707, "mean_inference_ms": 1.0630532306347735, "mean_action_processing_ms": 0.13883281255002433, "mean_env_wait_ms": 0.22996018402868612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002893686294555664, "StateBufferConnector_ms": 0.0034122467041015625, "ViewRequirementAgentConnector_ms": 0.053115248680114746}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.752693125834, "num_env_steps_trained_throughput_per_sec": 777.752693125834, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 4987.546, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4987.516, "sample_time_ms": 786.385, "learn_time_ms": 4190.718, "learn_throughput": 954.49, "synch_weights_time_ms": 10.098}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-13", "timestamp": 1723385893, "time_this_iter_s": 5.14574122428894, "time_total_s": 96.66606783866882, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.66606783866882, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.371428571428574, "ram_util_percent": 81.95714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8195842021144927, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.844980930785338, "policy_loss": -0.005341671429535685, "vf_loss": 3.849974609911442, "vf_explained_var": -0.025664486363530158, "kl": 0.008248692589714519, "entropy": 0.9940833145752549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9885289404386034, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.847920024394989, "policy_loss": -0.005897769870352931, "vf_loss": 3.8527485348284243, "vf_explained_var": -0.027109013373653092, "kl": 0.01425657891804319, "entropy": 1.3664981762568156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 381.17, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38117, "policy_reward_min": {"prey_policy": -34.74271306057371, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 34.74271306057371}, "policy_reward_mean": {"prey_policy": 26.474862599457584, "predator_policy": -26.474862599457584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 183, 400, 400, 400, 400, 53, 400, 400], "policy_prey_policy_reward": [19.38992114805671, 52.99525575169641, 30.83460825741819, 57.80186797360228, 26.712644728571693, 21.69112424937633, 45.90120652245007, 35.41562129608091, -5.427517207469059, 58.359354501881, 18.280195878212147, 13.313117708202604, 31.91107795807074, 6.265592024976975, 34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367, 18.37970243791159, 36.622388381844544, 24.519247151314076, 29.011371384574154, 26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156, 7.439089859846021, 23.924352188592394, 23.306919769087607, 43.28466063298158, -29.765311592060424, 20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384, 34.26817481250532, 23.178350541524743, 34.970931331831785, -12.495787642710091, 38.72748580565371, 31.133373170841466, 10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615], "policy_predator_policy_reward": [-19.38992114805671, -52.99525575169641, -30.83460825741819, -57.80186797360228, -26.712644728571693, -21.69112424937633, -45.90120652245007, -35.41562129608091, 5.427517207469059, -58.359354501881, -18.280195878212147, -13.313117708202604, -31.91107795807074, -6.265592024976975, -34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367, -18.37970243791159, -36.622388381844544, -24.519247151314076, -29.011371384574154, -26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156, -7.439089859846021, -23.924352188592394, -23.306919769087607, -43.28466063298158, 29.765311592060424, -20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384, -34.26817481250532, -23.178350541524743, -34.970931331831785, 12.495787642710091, -38.72748580565371, -31.133373170841466, -10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31430019559886807, "mean_inference_ms": 1.058783208860408, "mean_action_processing_ms": 0.1383741726840543, "mean_env_wait_ms": 0.22813034386117928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028455257415771484, "StateBufferConnector_ms": 0.003397226333618164, "ViewRequirementAgentConnector_ms": 0.052037835121154785}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.9409896538202, "num_env_steps_trained_throughput_per_sec": 797.9409896538202, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 4978.923, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4978.892, "sample_time_ms": 787.787, "learn_time_ms": 4180.761, "learn_throughput": 956.764, "synch_weights_time_ms": 10.031}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-18", "timestamp": 1723385898, "time_this_iter_s": 5.015672922134399, "time_total_s": 101.68174076080322, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.68174076080322, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.98571428571429, "ram_util_percent": 81.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1487979653291405, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.633099448184172, "policy_loss": -0.004263479894628593, "vf_loss": 4.63709797958533, "vf_explained_var": -0.0012153491377830505, "kl": 0.0062799009062816736, "entropy": 1.0473083033536872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2482075062580407, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.629253235459328, "policy_loss": -0.003388153543831625, "vf_loss": 4.631809894740582, "vf_explained_var": -0.004026133194565773, "kl": 0.01108666426837254, "entropy": 1.3399919881174962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 368.29, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 36829, "policy_reward_min": {"prey_policy": -34.74271306057371, "predator_policy": -61.100049636346576}, "policy_reward_max": {"prey_policy": 61.100049636346576, "predator_policy": 34.74271306057371}, "policy_reward_mean": {"prey_policy": 24.768366478898965, "predator_policy": -24.768366478898965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 183, 400, 400, 400, 400, 53, 400, 400, 400, 156, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 76, 70], "policy_prey_policy_reward": [34.6678789963208, 34.020238149176265, -5.93363075781276, 43.6010867689251, 31.66450174250769, 53.29417740654666, 61.100049636346576, 25.18180037659446, 24.679363738422815, 32.00816362483711, 26.33205067779361, 49.95695117162127, 52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367, 18.37970243791159, 36.622388381844544, 24.519247151314076, 29.011371384574154, 26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156, 7.439089859846021, 23.924352188592394, 23.306919769087607, 43.28466063298158, -29.765311592060424, 20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384, 34.26817481250532, 23.178350541524743, 34.970931331831785, -12.495787642710091, 38.72748580565371, 31.133373170841466, 10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615, 52.71271495003962, -13.457412193062218, 23.48804792443027, 24.31610020681628, 30.113833751856646, 18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495], "policy_predator_policy_reward": [-34.6678789963208, -34.020238149176265, 5.93363075781276, -43.6010867689251, -31.66450174250769, -53.29417740654666, -61.100049636346576, -25.18180037659446, -24.679363738422815, -32.00816362483711, -26.33205067779361, -49.95695117162127, -52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367, -18.37970243791159, -36.622388381844544, -24.519247151314076, -29.011371384574154, -26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156, -7.439089859846021, -23.924352188592394, -23.306919769087607, -43.28466063298158, 29.765311592060424, -20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384, -34.26817481250532, -23.178350541524743, -34.970931331831785, 12.495787642710091, -38.72748580565371, -31.133373170841466, -10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615, -52.71271495003962, 13.457412193062218, -23.48804792443027, -24.31610020681628, -30.113833751856646, -18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31307988932579633, "mean_inference_ms": 1.0547654592087266, "mean_action_processing_ms": 0.13779617713094822, "mean_env_wait_ms": 0.22623714982275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002826213836669922, "StateBufferConnector_ms": 0.0034096240997314453, "ViewRequirementAgentConnector_ms": 0.05189502239227295}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.9671355298765, "num_env_steps_trained_throughput_per_sec": 804.9671355298765, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 4982.648, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4982.617, "sample_time_ms": 785.518, "learn_time_ms": 4186.861, "learn_throughput": 955.37, "synch_weights_time_ms": 9.926}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-23", "timestamp": 1723385903, "time_this_iter_s": 4.971738815307617, "time_total_s": 106.65347957611084, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.65347957611084, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.075000000000003, "ram_util_percent": 81.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1852064743793258, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.560096271584431, "policy_loss": -0.003161954687675461, "vf_loss": 4.563021289308866, "vf_explained_var": -0.011249603144824505, "kl": 0.005616103759161462, "entropy": 1.1221865636607011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2412649290946622, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.5661943010985855, "policy_loss": -0.006646712011327812, "vf_loss": 4.5711833747724695, "vf_explained_var": -0.013696624649067719, "kl": 0.02210166846426352, "entropy": 1.260360595335563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 367.7, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36770, "policy_reward_min": {"prey_policy": -34.74271306057371, "predator_policy": -52.71271495003962}, "policy_reward_max": {"prey_policy": 52.71271495003962, "predator_policy": 34.74271306057371}, "policy_reward_mean": {"prey_policy": 21.80995940322388, "predator_policy": -21.80995940322388}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 92, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 183, 400, 400, 400, 400, 53, 400, 400, 400, 156, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 76, 70, 400, 400, 298, 400, 400, 400, 400, 400, 210, 264, 400, 400], "policy_prey_policy_reward": [52.63551763847577, 44.68338973522697, 28.283453023484363, 32.43348284566344, 22.81537986501114, 39.91057538013262, 45.674503574430524, 30.901197839372877, 33.331093440307754, 41.1268494611902, 2.1967326102757596, 35.15670968340385, 6.229986637748823, 36.77421412473915, -34.74271306057371, 22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367, 18.37970243791159, 36.622388381844544, 24.519247151314076, 29.011371384574154, 26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156, 7.439089859846021, 23.924352188592394, 23.306919769087607, 43.28466063298158, -29.765311592060424, 20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384, 34.26817481250532, 23.178350541524743, 34.970931331831785, -12.495787642710091, 38.72748580565371, 31.133373170841466, 10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615, 52.71271495003962, -13.457412193062218, 23.48804792443027, 24.31610020681628, 30.113833751856646, 18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495, 7.6843904868603445, 25.853898331635953, -23.215247618637136, 33.95692213296597, 47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617], "policy_predator_policy_reward": [-52.63551763847577, -44.68338973522697, -28.283453023484363, -32.43348284566344, -22.81537986501114, -39.91057538013262, -45.674503574430524, -30.901197839372877, -33.331093440307754, -41.1268494611902, -2.1967326102757596, -35.15670968340385, -6.229986637748823, -36.77421412473915, 34.74271306057371, -22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367, -18.37970243791159, -36.622388381844544, -24.519247151314076, -29.011371384574154, -26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156, -7.439089859846021, -23.924352188592394, -23.306919769087607, -43.28466063298158, 29.765311592060424, -20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384, -34.26817481250532, -23.178350541524743, -34.970931331831785, 12.495787642710091, -38.72748580565371, -31.133373170841466, -10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615, -52.71271495003962, 13.457412193062218, -23.48804792443027, -24.31610020681628, -30.113833751856646, -18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495, -7.6843904868603445, -25.853898331635953, 23.215247618637136, -33.95692213296597, -47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31239013174711394, "mean_inference_ms": 1.0510250075681857, "mean_action_processing_ms": 0.13741312422826574, "mean_env_wait_ms": 0.22510390850466291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028051137924194336, "StateBufferConnector_ms": 0.0033712387084960938, "ViewRequirementAgentConnector_ms": 0.04932260513305664}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.127331699685, "num_env_steps_trained_throughput_per_sec": 749.127331699685, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5027.557, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5027.526, "sample_time_ms": 785.498, "learn_time_ms": 4231.352, "learn_throughput": 945.324, "synch_weights_time_ms": 10.356}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-28", "timestamp": 1723385908, "time_this_iter_s": 5.344144821166992, "time_total_s": 111.99762439727783, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe10940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.99762439727783, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.07142857142857, "ram_util_percent": 81.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6349776775576175, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9903770034511883, "policy_loss": -0.0015885983608313835, "vf_loss": 3.9917024036248523, "vf_explained_var": 0.08960385962078969, "kl": 0.0062388183776992704, "entropy": 0.9306808244436979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7351868501864374, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9992355441053706, "policy_loss": -0.0025766268195487403, "vf_loss": 4.001118740191062, "vf_explained_var": 0.09060864007721345, "kl": 0.006163836970712807, "entropy": 1.2538862721373638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 349.24, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 34924, "policy_reward_min": {"prey_policy": -33.11722656104032, "predator_policy": -52.71271495003962}, "policy_reward_max": {"prey_policy": 52.71271495003962, "predator_policy": 33.11722656104032}, "policy_reward_mean": {"prey_policy": 18.261020287671066, "predator_policy": -18.261020287671066}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 183, 400, 400, 400, 400, 53, 400, 400, 400, 156, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 76, 70, 400, 400, 298, 400, 400, 400, 400, 400, 210, 264, 400, 400, 400, 400, 119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400], "policy_prey_policy_reward": [22.21134979627449, 24.333994143714534, 41.77964895333527, 32.61399779582834, 25.632914902485403, 30.981981784720034, 37.23017259732374, 24.930651869651463, 36.53144180552359, 37.02520162412514, 21.60291335410307, 41.739459048477705, 10.76293848112369, 21.6777356102443, 21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367, 18.37970243791159, 36.622388381844544, 24.519247151314076, 29.011371384574154, 26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156, 7.439089859846021, 23.924352188592394, 23.306919769087607, 43.28466063298158, -29.765311592060424, 20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384, 34.26817481250532, 23.178350541524743, 34.970931331831785, -12.495787642710091, 38.72748580565371, 31.133373170841466, 10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615, 52.71271495003962, -13.457412193062218, 23.48804792443027, 24.31610020681628, 30.113833751856646, 18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495, 7.6843904868603445, 25.853898331635953, -23.215247618637136, 33.95692213296597, 47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617, 33.688117965854985, 23.64118525526871, -4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645], "policy_predator_policy_reward": [-22.21134979627449, -24.333994143714534, -41.77964895333527, -32.61399779582834, -25.632914902485403, -30.981981784720034, -37.23017259732374, -24.930651869651463, -36.53144180552359, -37.02520162412514, -21.60291335410307, -41.739459048477705, -10.76293848112369, -21.6777356102443, -21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367, -18.37970243791159, -36.622388381844544, -24.519247151314076, -29.011371384574154, -26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156, -7.439089859846021, -23.924352188592394, -23.306919769087607, -43.28466063298158, 29.765311592060424, -20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384, -34.26817481250532, -23.178350541524743, -34.970931331831785, 12.495787642710091, -38.72748580565371, -31.133373170841466, -10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615, -52.71271495003962, 13.457412193062218, -23.48804792443027, -24.31610020681628, -30.113833751856646, -18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495, -7.6843904868603445, -25.853898331635953, 23.215247618637136, -33.95692213296597, -47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617, -33.688117965854985, -23.64118525526871, 4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3116918380934415, "mean_inference_ms": 1.0472319326555921, "mean_action_processing_ms": 0.13695051737749364, "mean_env_wait_ms": 0.22403707299710754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028638839721679688, "StateBufferConnector_ms": 0.0021440982818603516, "ViewRequirementAgentConnector_ms": 0.050463080406188965}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 787.230042154765, "num_env_steps_trained_throughput_per_sec": 787.230042154765, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 5046.55, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5046.516, "sample_time_ms": 780.757, "learn_time_ms": 4255.077, "learn_throughput": 940.053, "synch_weights_time_ms": 10.366}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-33", "timestamp": 1723385913, "time_this_iter_s": 5.0839009284973145, "time_total_s": 117.08152532577515, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 117.08152532577515, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.642857142857146, "ram_util_percent": 81.61428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6338513279644151, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.211544323464235, "policy_loss": -0.004585802659615486, "vf_loss": 4.215762330840032, "vf_explained_var": 0.09492835352818171, "kl": 0.008718069226215637, "entropy": 1.0395821810389558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6362341788907846, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.212943739195665, "policy_loss": -0.000997380112433651, "vf_loss": 4.213602741559346, "vf_explained_var": 0.09384168162941933, "kl": 0.003007606971824705, "entropy": 1.2487962792317073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 333.38, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 33338, "policy_reward_min": {"prey_policy": -35.15919255209618, "predator_policy": -52.71271495003962}, "policy_reward_max": {"prey_policy": 52.71271495003962, "predator_policy": 35.15919255209618}, "policy_reward_mean": {"prey_policy": 14.717315021138948, "predator_policy": -14.717315021138948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 183, 400, 400, 400, 400, 53, 400, 400, 400, 156, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 76, 70, 400, 400, 298, 400, 400, 400, 400, 400, 210, 264, 400, 400, 400, 400, 119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400], "policy_prey_policy_reward": [21.46266888699854, 11.670927750095522, 21.664830075256923, 20.734980934389206, 37.133428741583394, 16.24137304201294, 28.979134805260685, 31.137124178299835, 33.87120630268998, 31.601446839326293, 5.577858572207006, 31.369665850031367, 18.37970243791159, 36.622388381844544, 24.519247151314076, 29.011371384574154, 26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156, 7.439089859846021, 23.924352188592394, 23.306919769087607, 43.28466063298158, -29.765311592060424, 20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384, 34.26817481250532, 23.178350541524743, 34.970931331831785, -12.495787642710091, 38.72748580565371, 31.133373170841466, 10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615, 52.71271495003962, -13.457412193062218, 23.48804792443027, 24.31610020681628, 30.113833751856646, 18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495, 7.6843904868603445, 25.853898331635953, -23.215247618637136, 33.95692213296597, 47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617, 33.688117965854985, 23.64118525526871, -4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292], "policy_predator_policy_reward": [-21.46266888699854, -11.670927750095522, -21.664830075256923, -20.734980934389206, -37.133428741583394, -16.24137304201294, -28.979134805260685, -31.137124178299835, -33.87120630268998, -31.601446839326293, -5.577858572207006, -31.369665850031367, -18.37970243791159, -36.622388381844544, -24.519247151314076, -29.011371384574154, -26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156, -7.439089859846021, -23.924352188592394, -23.306919769087607, -43.28466063298158, 29.765311592060424, -20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384, -34.26817481250532, -23.178350541524743, -34.970931331831785, 12.495787642710091, -38.72748580565371, -31.133373170841466, -10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615, -52.71271495003962, 13.457412193062218, -23.48804792443027, -24.31610020681628, -30.113833751856646, -18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495, -7.6843904868603445, -25.853898331635953, 23.215247618637136, -33.95692213296597, -47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617, -33.688117965854985, -23.64118525526871, 4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.310932002987983, "mean_inference_ms": 1.0439020885847783, "mean_action_processing_ms": 0.13657580313624823, "mean_env_wait_ms": 0.22335140599558806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028612613677978516, "StateBufferConnector_ms": 0.0021522045135498047, "ViewRequirementAgentConnector_ms": 0.05050456523895264}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.0566452698431, "num_env_steps_trained_throughput_per_sec": 804.0566452698431, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 5043.655, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5043.621, "sample_time_ms": 774.831, "learn_time_ms": 4258.109, "learn_throughput": 939.384, "synch_weights_time_ms": 10.363}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-38", "timestamp": 1723385918, "time_this_iter_s": 4.97734522819519, "time_total_s": 122.05887055397034, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe109d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 122.05887055397034, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.285714285714285, "ram_util_percent": 81.47142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.932337124676754, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.862937838584185, "policy_loss": -0.0026431052239786366, "vf_loss": 4.865264828503132, "vf_explained_var": 0.13578246993323168, "kl": 0.007492700100129619, "entropy": 1.0616401659945647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.033346870075911, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.873040128250917, "policy_loss": -0.003294194973326133, "vf_loss": 4.875758781284094, "vf_explained_var": 0.13714353311806918, "kl": 0.010231890328108761, "entropy": 1.2821966800838709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 311.4, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 31140, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -52.71271495003962}, "policy_reward_max": {"prey_policy": 52.71271495003962, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 9.364496502941138, "predator_policy": -9.364496502941138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 69, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 183, 400, 400, 400, 400, 53, 400, 400, 400, 156, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 76, 70, 400, 400, 298, 400, 400, 400, 400, 400, 210, 264, 400, 400, 400, 400, 119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233], "policy_prey_policy_reward": [26.660375572294235, 39.61463449431912, 43.29868657753712, 20.7847425184017, 40.40969912617789, 39.486260858802815, -19.533192366715156, 7.439089859846021, 23.924352188592394, 23.306919769087607, 43.28466063298158, -29.765311592060424, 20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384, 34.26817481250532, 23.178350541524743, 34.970931331831785, -12.495787642710091, 38.72748580565371, 31.133373170841466, 10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615, 52.71271495003962, -13.457412193062218, 23.48804792443027, 24.31610020681628, 30.113833751856646, 18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495, 7.6843904868603445, 25.853898331635953, -23.215247618637136, 33.95692213296597, 47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617, 33.688117965854985, 23.64118525526871, -4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333], "policy_predator_policy_reward": [-26.660375572294235, -39.61463449431912, -43.29868657753712, -20.7847425184017, -40.40969912617789, -39.486260858802815, 19.533192366715156, -7.439089859846021, -23.924352188592394, -23.306919769087607, -43.28466063298158, 29.765311592060424, -20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384, -34.26817481250532, -23.178350541524743, -34.970931331831785, 12.495787642710091, -38.72748580565371, -31.133373170841466, -10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615, -52.71271495003962, 13.457412193062218, -23.48804792443027, -24.31610020681628, -30.113833751856646, -18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495, -7.6843904868603445, -25.853898331635953, 23.215247618637136, -33.95692213296597, -47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617, -33.688117965854985, -23.64118525526871, 4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3103966237412152, "mean_inference_ms": 1.04030180479748, "mean_action_processing_ms": 0.13625103647272105, "mean_env_wait_ms": 0.22242147567607234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029401779174804688, "StateBufferConnector_ms": 0.002125382423400879, "ViewRequirementAgentConnector_ms": 0.05113983154296875}, "num_episodes": 16, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 810.4379704598994, "num_env_steps_trained_throughput_per_sec": 810.4379704598994, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 5054.815, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5054.782, "sample_time_ms": 769.871, "learn_time_ms": 4274.224, "learn_throughput": 935.842, "synch_weights_time_ms": 10.37}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-43", "timestamp": 1723385923, "time_this_iter_s": 4.938347101211548, "time_total_s": 126.99721765518188, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe10940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.99721765518188, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.7875, "ram_util_percent": 81.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0429580572992565, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8841879166662694, "policy_loss": -0.0024424762314689966, "vf_loss": 3.8864012358089286, "vf_explained_var": -0.00917824823409319, "kl": 0.005431945755215869, "entropy": 1.0209280940393606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1742368871966997, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8838895983994006, "policy_loss": -0.004274680853510896, "vf_loss": 3.8874423995614054, "vf_explained_var": -0.008420876910289128, "kl": 0.012833464609633156, "entropy": 1.2399970951179664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 303.75, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 30375, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -52.71271495003962}, "policy_reward_max": {"prey_policy": 52.71271495003962, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 6.120589493988899, "predator_policy": -6.120589493988899}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 183, 400, 400, 400, 400, 53, 400, 400, 400, 156, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 76, 70, 400, 400, 298, 400, 400, 400, 400, 400, 210, 264, 400, 400, 400, 400, 119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400], "policy_prey_policy_reward": [20.56575260483725, 8.093810011463919, 43.999030419582034, 24.1151827159861, 30.194782151244933, -18.405857335322384, 34.26817481250532, 23.178350541524743, 34.970931331831785, -12.495787642710091, 38.72748580565371, 31.133373170841466, 10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615, 52.71271495003962, -13.457412193062218, 23.48804792443027, 24.31610020681628, 30.113833751856646, 18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495, 7.6843904868603445, 25.853898331635953, -23.215247618637136, 33.95692213296597, 47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617, 33.688117965854985, 23.64118525526871, -4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904], "policy_predator_policy_reward": [-20.56575260483725, -8.093810011463919, -43.999030419582034, -24.1151827159861, -30.194782151244933, 18.405857335322384, -34.26817481250532, -23.178350541524743, -34.970931331831785, 12.495787642710091, -38.72748580565371, -31.133373170841466, -10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615, -52.71271495003962, 13.457412193062218, -23.48804792443027, -24.31610020681628, -30.113833751856646, -18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495, -7.6843904868603445, -25.853898331635953, 23.215247618637136, -33.95692213296597, -47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617, -33.688117965854985, -23.64118525526871, 4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30983626745110393, "mean_inference_ms": 1.037348032374593, "mean_action_processing_ms": 0.13593774670652106, "mean_env_wait_ms": 0.22177234336385454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002934575080871582, "StateBufferConnector_ms": 0.0021195411682128906, "ViewRequirementAgentConnector_ms": 0.0491030216217041}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.2407660825822, "num_env_steps_trained_throughput_per_sec": 797.2407660825822, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 5051.214, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5051.181, "sample_time_ms": 763.618, "learn_time_ms": 4276.917, "learn_throughput": 935.253, "synch_weights_time_ms": 10.326}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-48", "timestamp": 1723385928, "time_this_iter_s": 5.019856929779053, "time_total_s": 132.01707458496094, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.01707458496094, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 31.457142857142856, "ram_util_percent": 81.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8493188473396003, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.952086835851272, "policy_loss": -0.001004781177713691, "vf_loss": 4.952896532167991, "vf_explained_var": 0.010106639874478181, "kl": 0.004624559076462887, "entropy": 1.0153037839879593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8918925935712954, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.951244165748358, "policy_loss": -0.0054481579504984745, "vf_loss": 4.95604848737518, "vf_explained_var": 0.012671485046545665, "kl": 0.011445958150161206, "entropy": 1.2225879856695732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 299.29, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 29929, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 5.696107933360936, "predator_policy": -5.696107933360936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 53, 400, 400, 400, 156, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 76, 70, 400, 400, 298, 400, 400, 400, 400, 400, 210, 264, 400, 400, 400, 400, 119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400], "policy_prey_policy_reward": [10.48706089927554, 37.22232072307235, -12.17350909304736, 38.9558556860308, 5.279553281700615, 52.71271495003962, -13.457412193062218, 23.48804792443027, 24.31610020681628, 30.113833751856646, 18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495, 7.6843904868603445, 25.853898331635953, -23.215247618637136, 33.95692213296597, 47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617, 33.688117965854985, 23.64118525526871, -4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317], "policy_predator_policy_reward": [-10.48706089927554, -37.22232072307235, 12.17350909304736, -38.9558556860308, -5.279553281700615, -52.71271495003962, 13.457412193062218, -23.48804792443027, -24.31610020681628, -30.113833751856646, -18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495, -7.6843904868603445, -25.853898331635953, 23.215247618637136, -33.95692213296597, -47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617, -33.688117965854985, -23.64118525526871, 4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30893231612182886, "mean_inference_ms": 1.0342542590801163, "mean_action_processing_ms": 0.13559762296104863, "mean_env_wait_ms": 0.22098747897683368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002974987030029297, "StateBufferConnector_ms": 0.0021550655364990234, "ViewRequirementAgentConnector_ms": 0.05104053020477295}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.7577171268694, "num_env_steps_trained_throughput_per_sec": 813.7577171268694, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 5058.529, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5058.496, "sample_time_ms": 765.563, "learn_time_ms": 4282.405, "learn_throughput": 934.055, "synch_weights_time_ms": 10.205}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-53", "timestamp": 1723385933, "time_this_iter_s": 4.917954921722412, "time_total_s": 136.93502950668335, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe109d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 136.93502950668335, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.714285714285715, "ram_util_percent": 81.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4833014509019753, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.921876121064027, "policy_loss": -0.0023266057311654245, "vf_loss": 3.92409253641963, "vf_explained_var": 0.04956983818362157, "kl": 0.005223361072194215, "entropy": 0.9720072402929266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4656523565451303, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9075488328933714, "policy_loss": -0.0017720901778375264, "vf_loss": 3.9087865643203257, "vf_explained_var": 0.05180356024454037, "kl": 0.009499632193116761, "entropy": 1.2079707325746616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 300.1, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 30010, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 5.767781942140378, "predator_policy": -5.767781942140378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 10, 400, 400, 400, 400, 400, 76, 70, 400, 400, 298, 400, 400, 400, 400, 400, 210, 264, 400, 400, 400, 400, 119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400], "policy_prey_policy_reward": [18.500908633373864, -1.9994151122768082, 37.25215688141197, 45.47049286200559, -15.873515918830925, 27.104823722074066, 37.58165814955772, -2.3346366947750754, -20.081298427355495, 7.6843904868603445, 25.853898331635953, -23.215247618637136, 33.95692213296597, 47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617, 33.688117965854985, 23.64118525526871, -4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737], "policy_predator_policy_reward": [-18.500908633373864, 1.9994151122768082, -37.25215688141197, -45.47049286200559, 15.873515918830925, -27.104823722074066, -37.58165814955772, 2.3346366947750754, 20.081298427355495, -7.6843904868603445, -25.853898331635953, 23.215247618637136, -33.95692213296597, -47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617, -33.688117965854985, -23.64118525526871, 4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30850358478394385, "mean_inference_ms": 1.0317122851255207, "mean_action_processing_ms": 0.1353413932031245, "mean_env_wait_ms": 0.2207416819087852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003023982048034668, "StateBufferConnector_ms": 0.0021512508392333984, "ViewRequirementAgentConnector_ms": 0.05124032497406006}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 790.9595016222546, "num_env_steps_trained_throughput_per_sec": 790.9595016222546, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 5044.61, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5044.577, "sample_time_ms": 766.24, "learn_time_ms": 4268.041, "learn_throughput": 937.198, "synch_weights_time_ms": 9.977}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-18-58", "timestamp": 1723385938, "time_this_iter_s": 5.059694051742554, "time_total_s": 141.9947235584259, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.9947235584259, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 81.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.412055149115622, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0771029651165005, "policy_loss": -0.00571530939390262, "vf_loss": 5.0825820530454315, "vf_explained_var": 0.14251841567456722, "kl": 0.011197798585338155, "entropy": 1.1065322415282328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.448862394100676, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.09086915999651, "policy_loss": -0.005220095662419529, "vf_loss": 5.095370301355918, "vf_explained_var": 0.14534111203004915, "kl": 0.01278164137453117, "entropy": 1.3445556983351707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 304.68, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 30468, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 4.584084235767484, "predator_policy": -4.584084235767484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 210, 264, 400, 400, 400, 400, 119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53], "policy_prey_policy_reward": [47.520710881824236, -9.3624917951084, 35.74742056513573, 9.72800694388367, -20.54590847973341, -31.80151478228523, 19.935240990257693, 19.230496306971617, 33.688117965854985, 23.64118525526871, -4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277], "policy_predator_policy_reward": [-47.520710881824236, 9.3624917951084, -35.74742056513573, -9.72800694388367, 20.54590847973341, 31.80151478228523, -19.935240990257693, -19.230496306971617, -33.688117965854985, -23.64118525526871, 4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3079386447834199, "mean_inference_ms": 1.029368833941164, "mean_action_processing_ms": 0.13508718443010131, "mean_env_wait_ms": 0.22015245298733346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030628442764282227, "StateBufferConnector_ms": 0.0021491050720214844, "ViewRequirementAgentConnector_ms": 0.052141427993774414}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 812.6338156035212, "num_env_steps_trained_throughput_per_sec": 812.6338156035212, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 5022.534, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5022.501, "sample_time_ms": 746.071, "learn_time_ms": 4266.067, "learn_throughput": 937.632, "synch_weights_time_ms": 10.04}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 29, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-03", "timestamp": 1723385943, "time_this_iter_s": 4.924835681915283, "time_total_s": 146.9195592403412, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.9195592403412, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.357142857142858, "ram_util_percent": 81.12857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.448954516462982, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.466847672810157, "policy_loss": -0.005676431779526562, "vf_loss": 4.472328963627418, "vf_explained_var": 0.3163006800537308, "kl": 0.009251188000880536, "entropy": 1.0369781196738284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.565427651939293, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.468922245005767, "policy_loss": -0.004912375001003966, "vf_loss": 4.473155339807272, "vf_explained_var": 0.3131740527227521, "kl": 0.012076084887270555, "entropy": 1.4190421162794034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 307.94, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 30794, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 4.770956838113034, "predator_policy": -4.770956838113034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [119, 119, 87, 93, 400, 400, 143, 160, 176, 149, 400, 400, 400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-4.84300286304418, -12.204299163644581, -14.851252990436722, -33.11722656104032, 0.6698087838938847, -2.638323409494844, -4.965591829055128, -9.49328396995111, -13.00493172603745, -5.514041995572006, 33.13274965665807, 31.48996865006289, 40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372], "policy_predator_policy_reward": [4.84300286304418, 12.204299163644581, 14.851252990436722, 33.11722656104032, -0.6698087838938847, 2.638323409494844, 4.965591829055128, 9.49328396995111, 13.00493172603745, 5.514041995572006, -33.13274965665807, -31.48996865006289, -40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3075168302723758, "mean_inference_ms": 1.0280561828393298, "mean_action_processing_ms": 0.1349097286257489, "mean_env_wait_ms": 0.2199433402460269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031605958938598633, "StateBufferConnector_ms": 0.002166271209716797, "ViewRequirementAgentConnector_ms": 0.05254662036895752}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 755.6147256726447, "num_env_steps_trained_throughput_per_sec": 755.6147256726447, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 5050.615, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5050.581, "sample_time_ms": 750.304, "learn_time_ms": 4289.834, "learn_throughput": 932.437, "synch_weights_time_ms": 10.116}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 30, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-08", "timestamp": 1723385948, "time_this_iter_s": 5.3061699867248535, "time_total_s": 152.22572922706604, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.22572922706604, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 36.84285714285715, "ram_util_percent": 81.45714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.277075357021143, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.71661360412836, "policy_loss": -0.010144920777141428, "vf_loss": 5.726457456250985, "vf_explained_var": 0.2667642493421833, "kl": 0.014272353341480542, "entropy": 1.0496892277772227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.340855631077041, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.720528424779574, "policy_loss": -0.002413556244088492, "vf_loss": 5.722260261575381, "vf_explained_var": 0.2674324575190743, "kl": 0.012119538235529656, "entropy": 1.4820335108786822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 326.3, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 32630, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 5.054375456613127, "predator_policy": -5.054375456613127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 109, 400, 229, 400, 400, 36, 400, 113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400], "policy_prey_policy_reward": [40.526585440145645, 23.91847002855735, -33.0968268477899, 36.166520046569445, -21.33196298423582, 10.93378548118286, 34.33456685771603, -3.9467405269745206, 21.746231761374375, -35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862], "policy_predator_policy_reward": [-40.526585440145645, -23.91847002855735, 33.0968268477899, -36.166520046569445, 21.33196298423582, -10.93378548118286, -34.33456685771603, 3.9467405269745206, -21.746231761374375, 35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.306792095728621, "mean_inference_ms": 1.02684805166934, "mean_action_processing_ms": 0.13472946390114815, "mean_env_wait_ms": 0.21941876433425336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003194451332092285, "StateBufferConnector_ms": 0.002156972885131836, "ViewRequirementAgentConnector_ms": 0.05272114276885986}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.5446019309827, "num_env_steps_trained_throughput_per_sec": 775.5446019309827, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 5069.467, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5069.433, "sample_time_ms": 768.938, "learn_time_ms": 4290.073, "learn_throughput": 932.385, "synch_weights_time_ms": 10.099}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 31, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-14", "timestamp": 1723385954, "time_this_iter_s": 5.160547971725464, "time_total_s": 157.3862771987915, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 157.3862771987915, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 31.5, "ram_util_percent": 81.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.458734299149364, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.819313976913691, "policy_loss": -0.004643529507059914, "vf_loss": 4.823771594961484, "vf_explained_var": 0.3794326455021898, "kl": 0.00881281761779178, "entropy": 0.9481296435619394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5756738034697872, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.843990599612395, "policy_loss": -0.008401336448150687, "vf_loss": 4.851088927189509, "vf_explained_var": 0.374078757626315, "kl": 0.023164609571636536, "entropy": 1.4898655359943709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 334.56, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 33456, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 4.496302851046267, "predator_policy": -4.496302851046267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [113, 70, 400, 400, 257, 400, 225, 400, 400, 313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-35.15919255209618, -11.723791508866093, 22.48483254229737, 13.865449777182192, -24.10035114759118, 20.59288418639292, -39.16686062314042, 8.51803836814183, 26.592520731437386, -19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667], "policy_predator_policy_reward": [35.15919255209618, 11.723791508866093, -22.48483254229737, -13.865449777182192, 24.10035114759118, -20.59288418639292, 39.16686062314042, -8.51803836814183, -26.592520731437386, 19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3064247722911391, "mean_inference_ms": 1.0262151379401638, "mean_action_processing_ms": 0.13462781317880257, "mean_env_wait_ms": 0.2190347689400161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003185272216796875, "StateBufferConnector_ms": 0.002152681350708008, "ViewRequirementAgentConnector_ms": 0.05177581310272217}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.4397335451065, "num_env_steps_trained_throughput_per_sec": 795.4397335451065, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 5038.378, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5038.346, "sample_time_ms": 771.413, "learn_time_ms": 4257.024, "learn_throughput": 939.623, "synch_weights_time_ms": 9.597}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 32, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-19", "timestamp": 1723385959, "time_this_iter_s": 5.031657934188843, "time_total_s": 162.41793513298035, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 162.41793513298035, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 31.614285714285717, "ram_util_percent": 81.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9110501520646115, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.163308418790499, "policy_loss": -0.0051212061109254135, "vf_loss": 4.168240987261137, "vf_explained_var": 0.5427142058809599, "kl": 0.008943254423695151, "entropy": 1.0640852621446053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8792987178390224, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.15054063051939, "policy_loss": -0.016419974679592997, "vf_loss": 4.164936881760756, "vf_explained_var": 0.54168005126218, "kl": 0.023985048409629475, "entropy": 1.4355480436235666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 34391, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 4.857367124382199, "predator_policy": -4.857367124382199}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [313, 400, 400, 400, 107, 217, 108, 118, 400, 94, 110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-19.278662280450543, 39.34082115473144, 11.399970868801688, 19.034353386893798, -37.4526844415203, -5.267818182823028, -31.02865765046046, -19.246856590481286, 5.725091627272029, -14.669797416088116, -11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763], "policy_predator_policy_reward": [19.278662280450543, -39.34082115473144, -11.399970868801688, -19.034353386893798, 37.4526844415203, 5.267818182823028, 31.02865765046046, 19.246856590481286, -5.725091627272029, 14.669797416088116, 11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3062857994378265, "mean_inference_ms": 1.0247843667820067, "mean_action_processing_ms": 0.13452618652616546, "mean_env_wait_ms": 0.21895153503227988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003161191940307617, "StateBufferConnector_ms": 0.0020955801010131836, "ViewRequirementAgentConnector_ms": 0.0510944128036499}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 815.5705517535732, "num_env_steps_trained_throughput_per_sec": 815.5705517535732, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 5020.721, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5020.69, "sample_time_ms": 764.281, "learn_time_ms": 4246.475, "learn_throughput": 941.958, "synch_weights_time_ms": 9.619}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 33, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-24", "timestamp": 1723385964, "time_this_iter_s": 4.907155990600586, "time_total_s": 167.32509112358093, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 167.32509112358093, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 30.442857142857147, "ram_util_percent": 81.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.744873812235892, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.371658173948527, "policy_loss": -0.001418682620836383, "vf_loss": 5.372794653723637, "vf_explained_var": 0.618894716228048, "kl": 0.013378631220055108, "entropy": 1.2082006252060333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.615504986513406, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.353000846505165, "policy_loss": -0.006768435936343546, "vf_loss": 5.357378087441126, "vf_explained_var": 0.619348683146139, "kl": 0.01889327723544424, "entropy": 1.4072613393266995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 358.34, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35834, "policy_reward_min": {"prey_policy": -45.62145703494764, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 45.62145703494764}, "policy_reward_mean": {"prey_policy": 7.653975083280891, "predator_policy": -7.653975083280891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [110, 277, 233, 188, 400, 400, 400, 249, 189, 160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-11.89639904917721, -45.62145703494764, -22.286099354174333, -17.731225707867747, 10.761343121006789, 22.19333430256202, 26.393335011739573, -21.036221242401695, -20.81674717470568, -38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704], "policy_predator_policy_reward": [11.89639904917721, 45.62145703494764, 22.286099354174333, 17.731225707867747, -10.761343121006789, -22.19333430256202, -26.393335011739573, 21.036221242401695, 20.81674717470568, 38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30578068844812184, "mean_inference_ms": 1.0238324787061241, "mean_action_processing_ms": 0.13426999851950477, "mean_env_wait_ms": 0.21856138509395748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003124713897705078, "StateBufferConnector_ms": 0.002084493637084961, "ViewRequirementAgentConnector_ms": 0.05076301097869873}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 762.5257917835529, "num_env_steps_trained_throughput_per_sec": 762.5257917835529, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 5047.816, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5047.784, "sample_time_ms": 762.379, "learn_time_ms": 4274.94, "learn_throughput": 935.686, "synch_weights_time_ms": 10.131}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 34, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-29", "timestamp": 1723385969, "time_this_iter_s": 5.249699115753174, "time_total_s": 172.5747902393341, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.5747902393341, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 35.81428571428571, "ram_util_percent": 81.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.519558769185096, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5585851532096664, "policy_loss": -0.004060837307527739, "vf_loss": 1.5623835572352012, "vf_explained_var": 0.8962829984724522, "kl": 0.01244141515873682, "entropy": 1.2634072377036014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7759801746346056, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6230954142908256, "policy_loss": -0.005245019916037564, "vf_loss": 1.6268037668739757, "vf_explained_var": 0.8942663400123517, "kl": 0.0121415942995176, "entropy": 1.3514435190707446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.88, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36988, "policy_reward_min": {"prey_policy": -38.87458134431503, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 38.87458134431503}, "policy_reward_mean": {"prey_policy": 10.77527425931806, "predator_policy": -10.77527425931806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [160, 273, 93, 241, 400, 400, 400, 400, 162, 400, 400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-38.87458134431503, -27.378294711327655, -9.451337268784783, -36.9192194937967, 15.770176974142998, 31.60965427778904, 25.12648300746758, 22.895235272392537, -30.809848617247454, 44.78939328451361, 22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559], "policy_predator_policy_reward": [38.87458134431503, 27.378294711327655, 9.451337268784783, 36.9192194937967, -15.770176974142998, -31.60965427778904, -25.12648300746758, -22.895235272392537, 30.809848617247454, -44.78939328451361, -22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30541314225064176, "mean_inference_ms": 1.0226641339323546, "mean_action_processing_ms": 0.13412537569114424, "mean_env_wait_ms": 0.21830916995448457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030927658081054688, "StateBufferConnector_ms": 0.0020759105682373047, "ViewRequirementAgentConnector_ms": 0.05018126964569092}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 758.6737972131792, "num_env_steps_trained_throughput_per_sec": 758.6737972131792, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 5081.493, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5081.459, "sample_time_ms": 770.406, "learn_time_ms": 4300.616, "learn_throughput": 930.099, "synch_weights_time_ms": 10.101}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 35, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-34", "timestamp": 1723385974, "time_this_iter_s": 5.275281190872192, "time_total_s": 177.8500714302063, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.8500714302063, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 33.0375, "ram_util_percent": 81.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0344556836100915, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.195551521020631, "policy_loss": -0.008582157140578299, "vf_loss": 1.2037265709601344, "vf_explained_var": 0.40912562229981025, "kl": 0.01929960106807774, "entropy": 1.253253758326173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9861083056467277, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1980603566082815, "policy_loss": -0.0100439300610257, "vf_loss": 1.2067929959855974, "vf_explained_var": 0.40077446264525257, "kl": 0.010360821985101154, "entropy": 1.3085551078120867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.11, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37711, "policy_reward_min": {"prey_policy": -30.26217066031002, "predator_policy": -57.7973422103317}, "policy_reward_max": {"prey_policy": 57.7973422103317, "predator_policy": 30.26217066031002}, "policy_reward_mean": {"prey_policy": 12.055446693726692, "predator_policy": -12.055446693726692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 200, 400, 175, 400, 400, 400, 400, 400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400], "policy_prey_policy_reward": [22.6983706455338, 44.52100760546168, 53.750605415452526, -18.478844642287743, -1.658604383370509, -14.084529329381443, 9.350462055776049, 57.7973422103317, 41.5795296981057, 13.744494010041414, 33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615], "policy_predator_policy_reward": [-22.6983706455338, -44.52100760546168, -53.750605415452526, 18.478844642287743, 1.658604383370509, 14.084529329381443, -9.350462055776049, -57.7973422103317, -41.5795296981057, -13.744494010041414, -33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3049356918763413, "mean_inference_ms": 1.0207289539716833, "mean_action_processing_ms": 0.13388472105482066, "mean_env_wait_ms": 0.21806287532444152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003095388412475586, "StateBufferConnector_ms": 0.002030611038208008, "ViewRequirementAgentConnector_ms": 0.04882216453552246}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 812.6089006386384, "num_env_steps_trained_throughput_per_sec": 812.6089006386384, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 5072.004, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5071.97, "sample_time_ms": 766.121, "learn_time_ms": 4295.396, "learn_throughput": 931.23, "synch_weights_time_ms": 10.116}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 36, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-39", "timestamp": 1723385979, "time_this_iter_s": 4.9249231815338135, "time_total_s": 182.7749946117401, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.7749946117401, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 31.78571428571429, "ram_util_percent": 81.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.184836575450997, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2241526040559014, "policy_loss": -0.017200078684739613, "vf_loss": 2.2407241221517324, "vf_explained_var": 0.8948702140400807, "kl": 0.029798423536191283, "entropy": 1.2684557696183523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.185847573696325, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.228629657750328, "policy_loss": -0.0035309427296548773, "vf_loss": 2.2305020990471047, "vf_explained_var": 0.8966753379752238, "kl": 0.013104144568083835, "entropy": 1.2466153495013714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 381.36, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38136, "policy_reward_min": {"prey_policy": -30.26217066031002, "predator_policy": -46.65840513020737}, "policy_reward_max": {"prey_policy": 46.65840513020737, "predator_policy": 30.26217066031002}, "policy_reward_mean": {"prey_policy": 11.717209455817406, "predator_policy": -11.717209455817406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 23, 400, 400, 400, 267, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [33.98213699983649, -5.687069850443775, 19.014072177727748, 26.936139447678386, 29.861481979101185, -26.94412919100622, 24.966906613808547, 46.65840513020737, 14.751441962027776, -4.269505034222682, 11.051734779601311, -13.479991932482005, 6.784718271630574, -4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426], "policy_predator_policy_reward": [-33.98213699983649, 5.687069850443775, -19.014072177727748, -26.936139447678386, -29.861481979101185, 26.94412919100622, -24.966906613808547, -46.65840513020737, -14.751441962027776, 4.269505034222682, -11.051734779601311, 13.479991932482005, -6.784718271630574, 4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3047001993633718, "mean_inference_ms": 1.0195740407392517, "mean_action_processing_ms": 0.1337437711657466, "mean_env_wait_ms": 0.21787625828718074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030792951583862305, "StateBufferConnector_ms": 0.0020377635955810547, "ViewRequirementAgentConnector_ms": 0.048676252365112305}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.6716272796332, "num_env_steps_trained_throughput_per_sec": 802.6716272796332, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 5078.793, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5078.759, "sample_time_ms": 770.805, "learn_time_ms": 4297.44, "learn_throughput": 930.787, "synch_weights_time_ms": 10.179}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 37, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-44", "timestamp": 1723385984, "time_this_iter_s": 4.986133098602295, "time_total_s": 187.7611277103424, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 187.7611277103424, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.571428571428573, "ram_util_percent": 81.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.065641452465206, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.760459575553735, "policy_loss": -0.020735706712002866, "vf_loss": 4.780507169663906, "vf_explained_var": 0.7474427602564295, "kl": 0.021746991209335112, "entropy": 1.2885608244687319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.007818530903508, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.787771683682998, "policy_loss": -0.0022363967097286754, "vf_loss": 4.789062060415745, "vf_explained_var": 0.7490992228190104, "kl": 0.0074747286840709986, "entropy": 1.2727758751561244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.87, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38987, "policy_reward_min": {"prey_policy": -30.26217066031002, "predator_policy": -46.012591552996156}, "policy_reward_max": {"prey_policy": 46.012591552996156, "predator_policy": 30.26217066031002}, "policy_reward_mean": {"prey_policy": 11.902853976953645, "predator_policy": -11.902853976953645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-4.122641624029313, 34.93690980861871, -9.660011834680834, 5.921649500513304, 23.273865087760655, 1.7299534985966716, 4.0385157796193525, -19.42527147223277, 20.871757215933442, 9.50437443882754, 4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055], "policy_predator_policy_reward": [4.122641624029313, -34.93690980861871, 9.660011834680834, -5.921649500513304, -23.273865087760655, -1.7299534985966716, -4.0385157796193525, 19.42527147223277, -20.871757215933442, -9.50437443882754, -4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30420134964566625, "mean_inference_ms": 1.0180123906090517, "mean_action_processing_ms": 0.13357556246499003, "mean_env_wait_ms": 0.21732512845589994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003044605255126953, "StateBufferConnector_ms": 0.0020388364791870117, "ViewRequirementAgentConnector_ms": 0.0480881929397583}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.8814403784454, "num_env_steps_trained_throughput_per_sec": 800.8814403784454, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 5072.528, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5072.494, "sample_time_ms": 768.547, "learn_time_ms": 4293.249, "learn_throughput": 931.695, "synch_weights_time_ms": 10.358}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 38, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-49", "timestamp": 1723385989, "time_this_iter_s": 4.997700929641724, "time_total_s": 192.75882863998413, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.75882863998413, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.642857142857142, "ram_util_percent": 81.32857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.247411326101671, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2336919769644736, "policy_loss": -0.00833190203848062, "vf_loss": 3.24090457384785, "vf_explained_var": 0.7857667562241356, "kl": 0.02358321454102281, "entropy": 1.2939296989391247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.43489984938254, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2296774531404178, "policy_loss": -0.005148477097585176, "vf_loss": 3.2335799468060333, "vf_explained_var": 0.7867255343745152, "kl": 0.009844918801390889, "entropy": 1.1770694199949503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.34, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39334, "policy_reward_min": {"prey_policy": -30.26217066031002, "predator_policy": -46.012591552996156}, "policy_reward_max": {"prey_policy": 46.012591552996156, "predator_policy": 30.26217066031002}, "policy_reward_mean": {"prey_policy": 12.1593070676992, "predator_policy": -12.1593070676992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [4.9301682459299485, 46.012591552996156, 32.91463935886793, 28.451827227314734, -9.708214867559128, 5.992558495561312, 18.436084345866007, -10.937261927113372, -11.109060385931937, 3.90923215274562, -5.701628624750704, 12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892], "policy_predator_policy_reward": [-4.9301682459299485, -46.012591552996156, -32.91463935886793, -28.451827227314734, 9.708214867559128, -5.992558495561312, -18.436084345866007, 10.937261927113372, 11.109060385931937, -3.90923215274562, 5.701628624750704, -12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30392993803196366, "mean_inference_ms": 1.0168136334546856, "mean_action_processing_ms": 0.133457132377847, "mean_env_wait_ms": 0.21712492375885284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030214786529541016, "StateBufferConnector_ms": 0.002035856246948242, "ViewRequirementAgentConnector_ms": 0.04776966571807861}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 815.754195327948, "num_env_steps_trained_throughput_per_sec": 815.754195327948, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 5070.645, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5070.611, "sample_time_ms": 769.803, "learn_time_ms": 4290.132, "learn_throughput": 932.372, "synch_weights_time_ms": 10.337}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 39, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-54", "timestamp": 1723385994, "time_this_iter_s": 4.906023979187012, "time_total_s": 197.66485261917114, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.66485261917114, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.942857142857143, "ram_util_percent": 81.32857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.190907952220489, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.055187899122635, "policy_loss": -0.012323070103108572, "vf_loss": 4.065904854238033, "vf_explained_var": 0.782312361896038, "kl": 0.022560463011462664, "entropy": 1.3125938744594654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.049704644146065, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.098273692031701, "policy_loss": -0.0043865017102992475, "vf_loss": 4.1016839223603405, "vf_explained_var": 0.7812855552881957, "kl": 0.007713702421461823, "entropy": 1.1846362377206485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.34, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39334, "policy_reward_min": {"prey_policy": -30.26217066031002, "predator_policy": -45.22112699940757}, "policy_reward_max": {"prey_policy": 45.22112699940757, "predator_policy": 30.26217066031002}, "policy_reward_mean": {"prey_policy": 11.330941740492522, "predator_policy": -11.330941740492522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.880998259968393, 6.472243030071773, -3.3613618102905534, 2.175802917254984, -17.221436395092642, -30.26217066031002, -7.649600052662194, 27.183110095648228, 15.686305905696862, -4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756], "policy_predator_policy_reward": [-12.880998259968393, -6.472243030071773, 3.3613618102905534, -2.175802917254984, 17.221436395092642, 30.26217066031002, 7.649600052662194, -27.183110095648228, -15.686305905696862, 4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30353800813154186, "mean_inference_ms": 1.0153305520111628, "mean_action_processing_ms": 0.1333030505981147, "mean_env_wait_ms": 0.21671977821127208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029604434967041016, "StateBufferConnector_ms": 0.0020461082458496094, "ViewRequirementAgentConnector_ms": 0.047986745834350586}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 793.2171797556297, "num_env_steps_trained_throughput_per_sec": 793.2171797556297, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 5045.549, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5045.515, "sample_time_ms": 766.107, "learn_time_ms": 4268.704, "learn_throughput": 937.053, "synch_weights_time_ms": 10.361}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 40, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-19-59", "timestamp": 1723385999, "time_this_iter_s": 5.046683311462402, "time_total_s": 202.71153593063354, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 202.71153593063354, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 32.94285714285714, "ram_util_percent": 81.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4399342587217685, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.928426476319631, "policy_loss": -0.019728600381252667, "vf_loss": 3.945055801173051, "vf_explained_var": 0.7823725801582138, "kl": 0.02902285000988181, "entropy": 1.3504977734138568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.281639568647369, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9563913645843667, "policy_loss": -0.0012436343184769308, "vf_loss": 3.957341767599185, "vf_explained_var": 0.7815155725926161, "kl": 0.00231682110654063, "entropy": 1.2138967343916496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.52, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39652, "policy_reward_min": {"prey_policy": -27.76025176703272, "predator_policy": -45.22112699940757}, "policy_reward_max": {"prey_policy": 45.22112699940757, "predator_policy": 27.76025176703272}, "policy_reward_mean": {"prey_policy": 11.452572218833692, "predator_policy": -11.452572218833692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-4.2283975014365645, 5.06709247586085, 15.765523741087232, 3.0678632127531102, -2.538635997335632, 10.672229632453163, -3.0255426837553863, 27.762413443863547, 0.9008223763691667, 7.43984041693132, 9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755], "policy_predator_policy_reward": [4.2283975014365645, -5.06709247586085, -15.765523741087232, -3.0678632127531102, 2.538635997335632, -10.672229632453163, 3.0255426837553863, -27.762413443863547, -0.9008223763691667, -7.43984041693132, -9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3031662178035494, "mean_inference_ms": 1.0138678705305388, "mean_action_processing_ms": 0.13312286878882948, "mean_env_wait_ms": 0.2162639700043577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00288236141204834, "StateBufferConnector_ms": 0.0020085573196411133, "ViewRequirementAgentConnector_ms": 0.04772984981536865}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 819.3727564239374, "num_env_steps_trained_throughput_per_sec": 819.3727564239374, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 5017.961, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5017.927, "sample_time_ms": 751.052, "learn_time_ms": 4256.154, "learn_throughput": 939.816, "synch_weights_time_ms": 10.374}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 41, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-04", "timestamp": 1723386004, "time_this_iter_s": 4.884403944015503, "time_total_s": 207.59593987464905, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe729d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.59593987464905, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.785714285714285, "ram_util_percent": 81.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.419537715986371, "cur_kl_coeff": 0.16018066406250003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3620477226873238, "policy_loss": -0.009463433015480405, "vf_loss": 3.3691164876023927, "vf_explained_var": 0.6488131813084086, "kl": 0.014949775532112852, "entropy": 1.3609443907936414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.380293740145862, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4306574559460086, "policy_loss": -0.0018158649135633217, "vf_loss": 3.432285210490227, "vf_explained_var": 0.6474273847416043, "kl": 0.0029725861962138, "entropy": 1.2510355512301128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.36, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39336, "policy_reward_min": {"prey_policy": -44.20592202729376, "predator_policy": -45.22112699940757}, "policy_reward_max": {"prey_policy": 45.22112699940757, "predator_policy": 44.20592202729376}, "policy_reward_mean": {"prey_policy": 9.794885654260323, "predator_policy": -9.794885654260323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400], "policy_prey_policy_reward": [9.102101215450087, -8.709333762009333, 13.917536290026572, 7.643817023643141, -13.258569550351151, -3.448402672453394, 15.762616086289906, -10.4396479401763, 14.731085488575662, 35.55838611497216, 6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106], "policy_predator_policy_reward": [-9.102101215450087, 8.709333762009333, -13.917536290026572, -7.643817023643141, 13.258569550351151, 3.448402672453394, -15.762616086289906, 10.4396479401763, -14.731085488575662, -35.55838611497216, -6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30280791510637717, "mean_inference_ms": 1.0122659208337494, "mean_action_processing_ms": 0.13296697394329215, "mean_env_wait_ms": 0.2158682613578268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028668642044067383, "StateBufferConnector_ms": 0.0021287202835083008, "ViewRequirementAgentConnector_ms": 0.047894835472106934}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 771.479616039212, "num_env_steps_trained_throughput_per_sec": 771.479616039212, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 5033.579, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5033.545, "sample_time_ms": 750.124, "learn_time_ms": 4272.7, "learn_throughput": 936.176, "synch_weights_time_ms": 10.373}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 42, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-09", "timestamp": 1723386009, "time_this_iter_s": 5.187462091445923, "time_total_s": 212.78340196609497, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.78340196609497, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.9375, "ram_util_percent": 81.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6651521214284, "cur_kl_coeff": 0.16018066406250003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.552754086628556, "policy_loss": -0.0043325211377426365, "vf_loss": 2.5561238090197245, "vf_explained_var": 0.8675448941687743, "kl": 0.006010698252859, "entropy": 1.353640645245711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.823124019584308, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.599393926312526, "policy_loss": -0.005693822541797999, "vf_loss": 2.6048181160042683, "vf_explained_var": 0.8659190384671092, "kl": 0.008521805145956097, "entropy": 1.2929152653863032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.36, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39336, "policy_reward_min": {"prey_policy": -44.20592202729376, "predator_policy": -45.22112699940757}, "policy_reward_max": {"prey_policy": 45.22112699940757, "predator_policy": 44.20592202729376}, "policy_reward_mean": {"prey_policy": 8.537776319900312, "predator_policy": -8.537776319900312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [6.211817489803625, 43.620925005561894, 11.56557620447083, 13.707402048353945, 16.870636838929567, 38.71765503359457, 9.825685202855105, 37.40738693862704, 31.53807869902203, 40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284], "policy_predator_policy_reward": [-6.211817489803625, -43.620925005561894, -11.56557620447083, -13.707402048353945, -16.870636838929567, -38.71765503359457, -9.825685202855105, -37.40738693862704, -31.53807869902203, -40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3025207722825965, "mean_inference_ms": 1.0110883921707066, "mean_action_processing_ms": 0.13279809773531281, "mean_env_wait_ms": 0.21557880570487492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029474496841430664, "StateBufferConnector_ms": 0.00229489803314209, "ViewRequirementAgentConnector_ms": 0.049286842346191406}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 786.7659575625491, "num_env_steps_trained_throughput_per_sec": 786.7659575625491, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 5051.535, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5051.501, "sample_time_ms": 760.866, "learn_time_ms": 4279.907, "learn_throughput": 934.6, "synch_weights_time_ms": 10.382}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 43, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-14", "timestamp": 1723386014, "time_this_iter_s": 5.087002992630005, "time_total_s": 217.87040495872498, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.87040495872498, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 32.1, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7132678393274547, "cur_kl_coeff": 0.16018066406250003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5041351178040108, "policy_loss": -0.015189023971712838, "vf_loss": 2.5158013214667636, "vf_explained_var": 0.8314389503871401, "kl": 0.021992838924854204, "entropy": 1.4173471249639988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.567472641915083, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.549999039247632, "policy_loss": -0.013115243192199462, "vf_loss": 2.5622279018163683, "vf_explained_var": 0.8300858048101266, "kl": 0.028013921493730245, "entropy": 1.3233887078861395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.36, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39336, "policy_reward_min": {"prey_policy": -44.20592202729376, "predator_policy": -45.22112699940757}, "policy_reward_max": {"prey_policy": 45.22112699940757, "predator_policy": 44.20592202729376}, "policy_reward_mean": {"prey_policy": 5.488680602374618, "predator_policy": -5.488680602374618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [40.47509555917704, 22.781466793742485, 45.22112699940757, 13.3090418219656, 5.962082298872321, 27.02189818207852, 37.05177675580786, 8.729213365677559, 34.375630520271194, 9.40162743173498, 3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665], "policy_predator_policy_reward": [-40.47509555917704, -22.781466793742485, -45.22112699940757, -13.3090418219656, -5.962082298872321, -27.02189818207852, -37.05177675580786, -8.729213365677559, -34.375630520271194, -9.40162743173498, -3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3022885121452634, "mean_inference_ms": 1.010344776206032, "mean_action_processing_ms": 0.1327410711545841, "mean_env_wait_ms": 0.2153391603630434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002947092056274414, "StateBufferConnector_ms": 0.002290487289428711, "ViewRequirementAgentConnector_ms": 0.049782752990722656}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.3958156244468, "num_env_steps_trained_throughput_per_sec": 803.3958156244468, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 5024.849, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5024.817, "sample_time_ms": 761.471, "learn_time_ms": 4253.117, "learn_throughput": 940.487, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 44, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-19", "timestamp": 1723386019, "time_this_iter_s": 4.981443643569946, "time_total_s": 222.85184860229492, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe654c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.85184860229492, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.771428571428572, "ram_util_percent": 81.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6617901562092205, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4153082937002184, "policy_loss": -0.00797117191881019, "vf_loss": 3.420165791362524, "vf_explained_var": 0.7917339116334915, "kl": 0.012958947788614238, "entropy": 1.3869143839925528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.570253334287554, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3967383399605753, "policy_loss": -0.006016697968880181, "vf_loss": 3.402284525334835, "vf_explained_var": 0.7928696410730481, "kl": 0.009913574472402435, "entropy": 1.320906264334917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 391.15, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39115, "policy_reward_min": {"prey_policy": -44.20592202729376, "predator_policy": -37.74744382799649}, "policy_reward_max": {"prey_policy": 37.74744382799649, "predator_policy": 44.20592202729376}, "policy_reward_mean": {"prey_policy": 1.6197239007150361, "predator_policy": -1.6197239007150361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400], "policy_prey_policy_reward": [3.4788372213001466, 21.50255339068853, 33.277032467420895, -0.9933887201502358, -27.76025176703272, 37.74744382799649, 17.53667672752817, -3.7912562780599615, 9.887582279332435, 4.873883899381475, 19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144], "policy_predator_policy_reward": [-3.4788372213001466, -21.50255339068853, -33.277032467420895, 0.9933887201502358, 27.76025176703272, -37.74744382799649, -17.53667672752817, 3.7912562780599615, -9.887582279332435, -4.873883899381475, -19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3019782773318247, "mean_inference_ms": 1.0093976553312212, "mean_action_processing_ms": 0.13260330680870638, "mean_env_wait_ms": 0.21499965158314166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029706954956054688, "StateBufferConnector_ms": 0.0023140907287597656, "ViewRequirementAgentConnector_ms": 0.05058324337005615}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.4825111951002, "num_env_steps_trained_throughput_per_sec": 785.4825111951002, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 5006.854, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5006.823, "sample_time_ms": 756.725, "learn_time_ms": 4239.884, "learn_throughput": 943.422, "synch_weights_time_ms": 9.887}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 45, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-24", "timestamp": 1723386024, "time_this_iter_s": 5.095158100128174, "time_total_s": 227.9470067024231, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.9470067024231, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.485714285714288, "ram_util_percent": 81.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5097158797395727, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3056232397754988, "policy_loss": -0.003498797998569595, "vf_loss": 3.307498880351583, "vf_explained_var": 0.5227847896516323, "kl": 0.006755565177641917, "entropy": 1.4003248361249765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.572440340090543, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3079072176168363, "policy_loss": -0.005804045366918823, "vf_loss": 3.313290142143766, "vf_explained_var": 0.5198203623915713, "kl": 0.008873055195010724, "entropy": 1.3505116357157627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 394.63, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39463, "policy_reward_min": {"prey_policy": -44.20592202729376, "predator_policy": -34.92820062422469}, "policy_reward_max": {"prey_policy": 34.92820062422469, "predator_policy": 44.20592202729376}, "policy_reward_mean": {"prey_policy": -0.5706240508300234, "predator_policy": 0.5706240508300234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [19.849058508382516, 3.484609055746809, 34.92820062422469, 25.326054273946887, 5.027808333153693, 26.295076030233638, 13.393365489388302, 32.33047100094426, 27.254048630026944, 26.007464602549884, 14.589203326486423, 1.7202438126036412, 9.088209860652661, 18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878], "policy_predator_policy_reward": [-19.849058508382516, -3.484609055746809, -34.92820062422469, -25.326054273946887, -5.027808333153693, -26.295076030233638, -13.393365489388302, -32.33047100094426, -27.254048630026944, -26.007464602549884, -14.589203326486423, -1.7202438126036412, -9.088209860652661, -18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30168769545123386, "mean_inference_ms": 1.0086611366259655, "mean_action_processing_ms": 0.1325097761956083, "mean_env_wait_ms": 0.21478085670124705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002965688705444336, "StateBufferConnector_ms": 0.0023239850997924805, "ViewRequirementAgentConnector_ms": 0.051726341247558594}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 717.687669786645, "num_env_steps_trained_throughput_per_sec": 717.687669786645, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 5071.958, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5071.927, "sample_time_ms": 762.007, "learn_time_ms": 4299.697, "learn_throughput": 930.298, "synch_weights_time_ms": 9.886}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 46, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-30", "timestamp": 1723386030, "time_this_iter_s": 5.632281064987183, "time_total_s": 233.57928776741028, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21faaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.57928776741028, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 34.98888888888889, "ram_util_percent": 81.57777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1657650197856126, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.278122395773729, "policy_loss": -0.006184915752965025, "vf_loss": 4.28221463089188, "vf_explained_var": 0.3800980780894558, "kl": 0.008709710062371319, "entropy": 1.4138631815711658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.149953462711225, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2806994358698525, "policy_loss": -0.0024880150594981387, "vf_loss": 4.282932614535094, "vf_explained_var": 0.3828533820807934, "kl": 0.0053695857041331585, "entropy": 1.4003848916540542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 387.68, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38768, "policy_reward_min": {"prey_policy": -44.20592202729376, "predator_policy": -25.009128905153645}, "policy_reward_max": {"prey_policy": 25.009128905153645, "predator_policy": 44.20592202729376}, "policy_reward_mean": {"prey_policy": -4.566338485536849, "predator_policy": 4.566338485536849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400], "policy_prey_policy_reward": [18.091283691107154, 22.647108666989283, 7.503465134517768, 10.580432350177205, 11.490759699689981, 16.54212021494405, 19.59939462972342, -2.922941152380055, 13.13475816940942, 3.021364696829238, -2.172618776504322, 21.875429619047296, -6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477], "policy_predator_policy_reward": [-18.091283691107154, -22.647108666989283, -7.503465134517768, -10.580432350177205, -11.490759699689981, -16.54212021494405, -19.59939462972342, 2.922941152380055, -13.13475816940942, -3.021364696829238, 2.172618776504322, -21.875429619047296, 6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30136703576416507, "mean_inference_ms": 1.0081688304453662, "mean_action_processing_ms": 0.13247345685913842, "mean_env_wait_ms": 0.21459628812833237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030961036682128906, "StateBufferConnector_ms": 0.0024050474166870117, "ViewRequirementAgentConnector_ms": 0.05245804786682129}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.3502374923846, "num_env_steps_trained_throughput_per_sec": 710.3502374923846, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 5136.73, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5136.683, "sample_time_ms": 769.317, "learn_time_ms": 4355.381, "learn_throughput": 918.404, "synch_weights_time_ms": 11.598}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 47, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-36", "timestamp": 1723386036, "time_this_iter_s": 5.636396169662476, "time_total_s": 239.21568393707275, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.21568393707275, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 39.2875, "ram_util_percent": 81.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5746946604611973, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.409342370430628, "policy_loss": -0.003988945227562605, "vf_loss": 6.412058879435063, "vf_explained_var": -0.50566506596903, "kl": 0.005295870401964416, "entropy": 1.3854678918917973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.481707945248733, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.413533722857634, "policy_loss": -0.00356347579654539, "vf_loss": 6.416284283002217, "vf_explained_var": -0.5154703725129366, "kl": 0.017128235098822938, "entropy": 1.4374335628002881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 379.03, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37903, "policy_reward_min": {"prey_policy": -44.20592202729376, "predator_policy": -25.009128905153645}, "policy_reward_max": {"prey_policy": 25.009128905153645, "predator_policy": 44.20592202729376}, "policy_reward_mean": {"prey_policy": -7.403196963667614, "predator_policy": 7.403196963667614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359], "policy_prey_policy_reward": [-6.304104303084976, 19.237963120693127, 23.942818081433323, 6.442307150381183, 23.88124858004989, -10.344756864771892, -1.3047242502254228, -14.671178754400614, 25.009128905153645, -8.782943969184537, -18.015605381673595, -6.813400891502177, 12.243045958721371, 6.295840040580824, 0.02262531283365732, 15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167], "policy_predator_policy_reward": [6.304104303084976, -19.237963120693127, -23.942818081433323, -6.442307150381183, -23.88124858004989, 10.344756864771892, 1.3047242502254228, 14.671178754400614, -25.009128905153645, 8.782943969184537, 18.015605381673595, 6.813400891502177, -12.243045958721371, -6.295840040580824, -0.02262531283365732, -15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30114127948003955, "mean_inference_ms": 1.0075284479187876, "mean_action_processing_ms": 0.13240658076621606, "mean_env_wait_ms": 0.2146180577183492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003139019012451172, "StateBufferConnector_ms": 0.0023878812789916992, "ViewRequirementAgentConnector_ms": 0.05186307430267334}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 766.1571241671396, "num_env_steps_trained_throughput_per_sec": 766.1571241671396, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 5159.369, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5159.318, "sample_time_ms": 768.773, "learn_time_ms": 4378.668, "learn_throughput": 913.52, "synch_weights_time_ms": 11.492}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 48, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-41", "timestamp": 1723386041, "time_this_iter_s": 5.2241480350494385, "time_total_s": 244.4398319721222, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.4398319721222, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 31.857142857142858, "ram_util_percent": 81.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2666396147571506, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.844859966635704, "policy_loss": -0.006057549967954401, "vf_loss": 6.848555058737596, "vf_explained_var": -0.36718014484892286, "kl": 0.009832587699384306, "entropy": 1.390237421542406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2259865957933167, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.849425788720449, "policy_loss": -0.007910483149074329, "vf_loss": 6.85652121057113, "vf_explained_var": -0.36296245536456506, "kl": 0.017173498385256256, "entropy": 1.399596980214119, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.78, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 36378, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -34.39010145632283}, "policy_reward_max": {"prey_policy": 34.39010145632283, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": -8.608686052298133, "predator_policy": 8.608686052298133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400], "policy_prey_policy_reward": [15.580817140059992, 10.790798742895756, 20.664991337114717, -17.608077086813537, 5.45636366382022, -5.599784774880781, -15.958259337106398, 24.54280079331292, 4.958907708215953, -0.6081931397335971, 2.2181899604724755, -5.798393775102387, 10.08615609012114, -11.569483798698478, -9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251], "policy_predator_policy_reward": [-15.580817140059992, -10.790798742895756, -20.664991337114717, 17.608077086813537, -5.45636366382022, 5.599784774880781, 15.958259337106398, -24.54280079331292, -4.958907708215953, 0.6081931397335971, -2.2181899604724755, 5.798393775102387, -10.08615609012114, 11.569483798698478, 9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3006714044056825, "mean_inference_ms": 1.0067741822569745, "mean_action_processing_ms": 0.1323387269912679, "mean_env_wait_ms": 0.21466855923494868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031701326370239258, "StateBufferConnector_ms": 0.002398252487182617, "ViewRequirementAgentConnector_ms": 0.05241572856903076}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.0535882911889, "num_env_steps_trained_throughput_per_sec": 799.0535882911889, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 5169.617, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5169.567, "sample_time_ms": 772.077, "learn_time_ms": 4385.658, "learn_throughput": 912.064, "synch_weights_time_ms": 11.449}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 49, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-46", "timestamp": 1723386046, "time_this_iter_s": 5.00879693031311, "time_total_s": 249.4486289024353, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.4486289024353, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 31.18571428571429, "ram_util_percent": 81.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7016996474005284, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9836790099740025, "policy_loss": -0.005224278272362426, "vf_loss": 5.9870111430684725, "vf_explained_var": -0.22202219379444918, "kl": 0.00787503183638631, "entropy": 1.4005191966891288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6620021796474855, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.006843186418215, "policy_loss": -0.0031863640239559268, "vf_loss": 6.009587123493353, "vf_explained_var": -0.2256958033889532, "kl": 0.009321266927393112, "entropy": 1.4127156232794127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 352.17, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 35217, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -34.39010145632283}, "policy_reward_max": {"prey_policy": 34.39010145632283, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": -10.585480897039645, "predator_policy": 10.585480897039645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267], "policy_prey_policy_reward": [-9.528914411472634, 16.04468199218743, -29.906518980356676, -44.20592202729376, -42.399558102786905, 14.313159086257382, -1.9206534134014106, -13.482080682439701, 8.191320339855952, -15.237658715282603, -3.1464940502395535, -12.542554295500146, 0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297], "policy_predator_policy_reward": [9.528914411472634, -16.04468199218743, 29.906518980356676, 44.20592202729376, 42.399558102786905, -14.313159086257382, 1.9206534134014106, 13.482080682439701, -8.191320339855952, 15.237658715282603, 3.1464940502395535, 12.542554295500146, -0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30044889981781625, "mean_inference_ms": 1.006584112216124, "mean_action_processing_ms": 0.13227950884758233, "mean_env_wait_ms": 0.21471502627948827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00319826602935791, "StateBufferConnector_ms": 0.0024181604385375977, "ViewRequirementAgentConnector_ms": 0.05466592311859131}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 773.9426099673317, "num_env_steps_trained_throughput_per_sec": 773.9426099673317, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 5182.176, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5182.126, "sample_time_ms": 775.105, "learn_time_ms": 4395.26, "learn_throughput": 910.071, "synch_weights_time_ms": 11.388}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 50, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-51", "timestamp": 1723386051, "time_this_iter_s": 5.171450853347778, "time_total_s": 254.62007975578308, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.62007975578308, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.887500000000003, "ram_util_percent": 81.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1224505758533874, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.171506677567959, "policy_loss": -0.002437087857591299, "vf_loss": 5.172834308197101, "vf_explained_var": -0.06633208052565655, "kl": 0.004617560027515447, "entropy": 1.435560475786527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.076291183227052, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.174024051676194, "policy_loss": -0.01033073302921063, "vf_loss": 5.183647095412016, "vf_explained_var": -0.05730745767553647, "kl": 0.014910787123930418, "entropy": 1.4373220846056938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.14, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34314, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -34.39010145632283}, "policy_reward_max": {"prey_policy": 34.39010145632283, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": -10.71146847954418, "predator_policy": 10.71146847954418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400], "policy_prey_policy_reward": [0.36076890515112225, -38.70092693298889, -3.6746855739693736, -1.0545855886559217, 14.435551452035284, -23.0267435391581, -10.365757010277704, 5.559437994952905, -12.919909791679821, 6.749000017968939, -33.20590105759831, -25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767], "policy_predator_policy_reward": [-0.36076890515112225, 38.70092693298889, 3.6746855739693736, 1.0545855886559217, -14.435551452035284, 23.0267435391581, 10.365757010277704, -5.559437994952905, 12.919909791679821, -6.749000017968939, 33.20590105759831, 25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30048117351233733, "mean_inference_ms": 1.0067611159866068, "mean_action_processing_ms": 0.13231864857626288, "mean_env_wait_ms": 0.21486969714932339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003207683563232422, "StateBufferConnector_ms": 0.002184748649597168, "ViewRequirementAgentConnector_ms": 0.05484509468078613}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.4653448597021, "num_env_steps_trained_throughput_per_sec": 775.4653448597021, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 5209.817, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5209.767, "sample_time_ms": 785.984, "learn_time_ms": 4412.075, "learn_throughput": 906.603, "synch_weights_time_ms": 11.338}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 51, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-20-56", "timestamp": 1723386056, "time_this_iter_s": 5.16074800491333, "time_total_s": 259.7808277606964, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fd64dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.7808277606964, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 33.528571428571425, "ram_util_percent": 81.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8384204057976605, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.350747894247373, "policy_loss": -0.00602087471052073, "vf_loss": 4.355642977605263, "vf_explained_var": -0.12762210660924514, "kl": 0.009371024322532989, "entropy": 1.2763477178911369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.779935696814209, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.317288474490245, "policy_loss": -0.006216430482163559, "vf_loss": 4.322431407868862, "vf_explained_var": -0.11112703916927179, "kl": 0.02261806042320722, "entropy": 1.11276310843726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 340.48, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34048, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -42.04891153726292}, "policy_reward_max": {"prey_policy": 42.04891153726292, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": -9.159110300885624, "predator_policy": 9.159110300885624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400], "policy_prey_policy_reward": [-25.312981301387254, 12.47492501368238, -15.396478617853665, -5.59795463094402, -9.283751294825066, -19.359024456258062, -18.01610293002982, -6.058907528266376, -30.938074493610294, -0.9242369408992328, -40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292], "policy_predator_policy_reward": [25.312981301387254, -12.47492501368238, 15.396478617853665, 5.59795463094402, 9.283751294825066, 19.359024456258062, 18.01610293002982, 6.058907528266376, 30.938074493610294, 0.9242369408992328, 40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30041272058445706, "mean_inference_ms": 1.0070932407227386, "mean_action_processing_ms": 0.1323387520540965, "mean_env_wait_ms": 0.2150419257222962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032215118408203125, "StateBufferConnector_ms": 0.0021991729736328125, "ViewRequirementAgentConnector_ms": 0.056267738342285156}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.7859317156501, "num_env_steps_trained_throughput_per_sec": 781.7859317156501, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 5202.982, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5202.932, "sample_time_ms": 796.391, "learn_time_ms": 4394.809, "learn_throughput": 910.165, "synch_weights_time_ms": 11.363}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 52, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-02", "timestamp": 1723386062, "time_this_iter_s": 5.1190571784973145, "time_total_s": 264.8998849391937, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.8998849391937, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 32.300000000000004, "ram_util_percent": 81.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5369735850797346, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5435745030641557, "policy_loss": -0.00543223496642895, "vf_loss": 3.5473589474956193, "vf_explained_var": -0.14047620464116334, "kl": 0.013716176122920299, "entropy": 1.2931343208998443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.480196148560693, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5445033542811872, "policy_loss": -0.005076556486649982, "vf_loss": 3.5486346368988353, "vf_explained_var": -0.12539600301533937, "kl": 0.013277760447014857, "entropy": 1.0814823584631086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 336.91, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33691, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -42.04891153726292}, "policy_reward_max": {"prey_policy": 42.04891153726292, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": -6.335473450251676, "predator_policy": 6.335473450251676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [179, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-40.71712738057871, -28.647362304333022, 16.97583152252144, -5.532021366630637, -13.813705964362608, -42.969242121175014, -6.154106796287966, -16.56385454353057, 10.14070528210691, -22.39364604722472, 0.6576225191322305, -6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004], "policy_predator_policy_reward": [40.71712738057871, 28.647362304333022, -16.97583152252144, 5.532021366630637, 13.813705964362608, 42.969242121175014, 6.154106796287966, 16.56385454353057, -10.14070528210691, 22.39364604722472, -0.6576225191322305, 6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30041245790968163, "mean_inference_ms": 1.0073351885234454, "mean_action_processing_ms": 0.13237548845825317, "mean_env_wait_ms": 0.2152519680927316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003220200538635254, "StateBufferConnector_ms": 0.002347707748413086, "ViewRequirementAgentConnector_ms": 0.05601680278778076}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.6280583049869, "num_env_steps_trained_throughput_per_sec": 803.6280583049869, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 5192.314, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5192.264, "sample_time_ms": 788.244, "learn_time_ms": 4392.29, "learn_throughput": 910.687, "synch_weights_time_ms": 11.358}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "training_iteration": 53, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-07", "timestamp": 1723386067, "time_this_iter_s": 4.9804160594940186, "time_total_s": 269.88030099868774, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.88030099868774, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.72857142857143, "ram_util_percent": 81.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0508241639782985, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1449512728800375, "policy_loss": -0.008941570383224946, "vf_loss": 3.152777270724376, "vf_explained_var": -0.09314341396093369, "kl": 0.009285925583113416, "entropy": 1.2754816754410665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0173218665644526, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1519890992591777, "policy_loss": -0.007026811144169187, "vf_loss": 3.1581879516442615, "vf_explained_var": -0.0789561233172814, "kl": 0.011630088353180312, "entropy": 0.9846874710172415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 335.54, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 33554, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": -1.8552639862046416, "predator_policy": 1.8552639862046416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 101, 400, 400, 400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-6.643378796259556, -20.00405427186878, -17.095096432512236, -43.71318971618902, -11.463498787940658, 0.06015268835925269, -11.810588820667633, -24.232876919667863, -1.0119121193518197, -31.649614115691676, -15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979], "policy_predator_policy_reward": [6.643378796259556, 20.00405427186878, 17.095096432512236, 43.71318971618902, 11.463498787940658, -0.06015268835925269, 11.810588820667633, 24.232876919667863, 1.0119121193518197, 31.649614115691676, 15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3005858493065876, "mean_inference_ms": 1.0081777865067716, "mean_action_processing_ms": 0.13249803758379572, "mean_env_wait_ms": 0.2156354318279571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040433406829833984, "StateBufferConnector_ms": 0.0024166107177734375, "ViewRequirementAgentConnector_ms": 0.05795931816101074}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 762.3348803090122, "num_env_steps_trained_throughput_per_sec": 762.3348803090122, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 5219.131, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5219.081, "sample_time_ms": 808.621, "learn_time_ms": 4398.732, "learn_throughput": 909.353, "synch_weights_time_ms": 11.355}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 54, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-12", "timestamp": 1723386072, "time_this_iter_s": 5.250952959060669, "time_total_s": 275.1312539577484, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fd64dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.1312539577484, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 35.900000000000006, "ram_util_percent": 81.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1659361174330116, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.883130269373457, "policy_loss": -0.0070276435794464, "vf_loss": 2.8891714671005806, "vf_explained_var": -0.02717244972785314, "kl": 0.00821113190761203, "entropy": 1.2934765043358007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.084159993364786, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.88688245502611, "policy_loss": -0.006178307140362449, "vf_loss": 2.8925215577085814, "vf_explained_var": -0.022054285742342472, "kl": 0.007574119004498395, "entropy": 0.9136300513520836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 338.53, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33853, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": 2.2780109744984385, "predator_policy": -2.2780109744984385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 4, 400, 265, 400, 273, 123, 115, 400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-15.627184538669056, 5.5979240394574195, -6.015606592754862, -2.80475062332522, -0.5113879833888477, -18.600981346461356, 14.66954139204308, -34.6858032144716, -22.232587514783063, -20.418185685394405, -22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747], "policy_predator_policy_reward": [15.627184538669056, -5.5979240394574195, 6.015606592754862, 2.80475062332522, 0.5113879833888477, 18.600981346461356, -14.66954139204308, 34.6858032144716, 22.232587514783063, 20.418185685394405, 22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30067595142923464, "mean_inference_ms": 1.009013930118746, "mean_action_processing_ms": 0.13255804094049803, "mean_env_wait_ms": 0.21576201999631497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003951311111450195, "StateBufferConnector_ms": 0.0023804903030395508, "ViewRequirementAgentConnector_ms": 0.05793118476867676}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.5432524121184, "num_env_steps_trained_throughput_per_sec": 780.5432524121184, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 5222.353, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5222.303, "sample_time_ms": 812.138, "learn_time_ms": 4398.443, "learn_throughput": 909.413, "synch_weights_time_ms": 11.353}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 55, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-17", "timestamp": 1723386077, "time_this_iter_s": 5.127149820327759, "time_total_s": 280.2584037780762, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 280.2584037780762, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 32.82857142857143, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.271092214481905, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.411617529888948, "policy_loss": -0.0040789256900704155, "vf_loss": 3.4151212385545175, "vf_explained_var": 0.07837122678756714, "kl": 0.004788074936949253, "entropy": 1.3354480142394702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.128042274015024, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4138845294713973, "policy_loss": -0.006407688995386707, "vf_loss": 3.418935474132498, "vf_explained_var": 0.07198653016239405, "kl": 0.019057784845984232, "entropy": 0.8209610113874077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 350.73, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35073, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": 5.050459421011753, "predator_policy": -5.050459421011753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 359, 400, 400, 400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-22.747854549899095, -9.544880113494107, -10.953337152048514, -26.386627600031296, 12.875609330960778, 14.47269619962865, -20.742880615575167, -28.884503632287824, 30.8584948169409, 9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576], "policy_predator_policy_reward": [22.747854549899095, 9.544880113494107, 10.953337152048514, 26.386627600031296, -12.875609330960778, -14.47269619962865, 20.742880615575167, 28.884503632287824, -30.8584948169409, -9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30085972383368814, "mean_inference_ms": 1.0097795495859228, "mean_action_processing_ms": 0.13262463285892134, "mean_env_wait_ms": 0.21587276707249609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003895998001098633, "StateBufferConnector_ms": 0.002371668815612793, "ViewRequirementAgentConnector_ms": 0.05842995643615723}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.1000671259447, "num_env_steps_trained_throughput_per_sec": 801.1000671259447, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 5164.321, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5164.271, "sample_time_ms": 814.953, "learn_time_ms": 4337.572, "learn_throughput": 922.175, "synch_weights_time_ms": 11.387}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-22", "timestamp": 1723386082, "time_this_iter_s": 4.995594024658203, "time_total_s": 285.2539978027344, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe10940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 285.2539978027344, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 32.75714285714286, "ram_util_percent": 81.84285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4676490875271457, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.458694011718035, "policy_loss": -0.00397635101932489, "vf_loss": 3.462219405422608, "vf_explained_var": 0.08754344129314025, "kl": 0.007507376670526015, "entropy": 1.3681476552039384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.426807457751905, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.50237885688742, "policy_loss": -0.005587224602156008, "vf_loss": 3.5071951317290466, "vf_explained_var": 0.06828102885435025, "kl": 0.01082942967797181, "entropy": 0.7524108761921525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 351.14, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35114, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": 7.961477499668623, "predator_policy": -7.961477499668623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 168, 400, 400, 400, 45, 80, 400, 276, 150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.562469343728502, -15.826372132507391, -33.331944035135905, 17.593486363278526, 34.39010145632283, -10.343647325808828, -8.307986799188765, -20.204652967944558, 5.0535668046417115, -12.282279104599871, -25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957], "policy_predator_policy_reward": [-9.562469343728502, 15.826372132507391, 33.331944035135905, -17.593486363278526, -34.39010145632283, 10.343647325808828, 8.307986799188765, 20.204652967944558, -5.0535668046417115, 12.282279104599871, 25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3010628747387846, "mean_inference_ms": 1.0101955889863354, "mean_action_processing_ms": 0.1326468366298497, "mean_env_wait_ms": 0.2160987397380596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004049062728881836, "StateBufferConnector_ms": 0.002398371696472168, "ViewRequirementAgentConnector_ms": 0.06008803844451904}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 761.8195851726216, "num_env_steps_trained_throughput_per_sec": 761.8195851726216, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 5126.272, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5126.238, "sample_time_ms": 803.555, "learn_time_ms": 4312.673, "learn_throughput": 927.499, "synch_weights_time_ms": 9.703}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 57, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-27", "timestamp": 1723386087, "time_this_iter_s": 5.253710031509399, "time_total_s": 290.5077078342438, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe723a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.5077078342438, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 32.5625, "ram_util_percent": 81.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9076540568843483, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.056364475935697, "policy_loss": -0.008907295590809857, "vf_loss": 4.064421237508456, "vf_explained_var": 0.11540461691717306, "kl": 0.014159226146114616, "entropy": 1.3438372420767943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.80336216793706, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.08262478535374, "policy_loss": -0.0023492838600456404, "vf_loss": 4.084734576692184, "vf_explained_var": 0.09961078322182099, "kl": 0.003364341316891417, "entropy": 0.7243838320796688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 361.45, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36145, "policy_reward_min": {"prey_policy": -46.32869770696424, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 46.32869770696424}, "policy_reward_mean": {"prey_policy": 9.334937971487475, "predator_policy": -9.334937971487475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [150, 156, 400, 273, 400, 301, 244, 175, 279, 371, 400, 400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-25.192066024735663, -46.32869770696424, 33.53338481621251, -33.916054237695406, 19.32398729098582, -30.45517911759658, -21.091190425242985, -11.864594802090512, -33.79755143307429, -28.94753506598868, 7.871036915037706, 17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138], "policy_predator_policy_reward": [25.192066024735663, 46.32869770696424, -33.53338481621251, 33.916054237695406, -19.32398729098582, 30.45517911759658, 21.091190425242985, 11.864594802090512, 33.79755143307429, 28.94753506598868, -7.871036915037706, -17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3013096479847075, "mean_inference_ms": 1.0110701348116078, "mean_action_processing_ms": 0.13274851801910986, "mean_env_wait_ms": 0.21630543303769376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004053711891174316, "StateBufferConnector_ms": 0.0023899078369140625, "ViewRequirementAgentConnector_ms": 0.059621453285217285}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.332076613902, "num_env_steps_trained_throughput_per_sec": 795.332076613902, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 5107.118, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5107.086, "sample_time_ms": 809.945, "learn_time_ms": 4287.147, "learn_throughput": 933.021, "synch_weights_time_ms": 9.681}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 58, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-32", "timestamp": 1723386092, "time_this_iter_s": 5.0319719314575195, "time_total_s": 295.5396797657013, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.5396797657013, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.185714285714276, "ram_util_percent": 81.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9080611039573947, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8180068326493104, "policy_loss": -0.007532519982002365, "vf_loss": 3.8241605875392755, "vf_explained_var": 0.24035944491624833, "kl": 0.02295374943864535, "entropy": 1.3764987882226705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6639471693895755, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.876323465506236, "policy_loss": -0.0046215683784491075, "vf_loss": 3.880648621171713, "vf_explained_var": 0.2275674598912398, "kl": 0.008327054146150878, "entropy": 0.6937854352096716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 370.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37000, "policy_reward_min": {"prey_policy": -45.44734189253895, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 45.44734189253895}, "policy_reward_mean": {"prey_policy": 12.472447007697422, "predator_policy": -12.472447007697422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 340, 400, 400, 189, 267, 213, 86, 387, 400, 400, 225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [17.55167503866578, -21.247085592569697, -29.768745526046146, 26.019643067106447, -2.626208589637412, -17.574848472327297, -7.739026397593608, -13.420836778780043, -6.586602053033037, -35.81243429518095, -1.2741121015761152, -33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255], "policy_predator_policy_reward": [-17.55167503866578, 21.247085592569697, 29.768745526046146, -26.019643067106447, 2.626208589637412, 17.574848472327297, 7.739026397593608, 13.420836778780043, 6.586602053033037, 35.81243429518095, 1.2741121015761152, 33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3015828181471162, "mean_inference_ms": 1.0118703945591487, "mean_action_processing_ms": 0.13279651920592936, "mean_env_wait_ms": 0.21651457671763516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004066824913024902, "StateBufferConnector_ms": 0.0023981332778930664, "ViewRequirementAgentConnector_ms": 0.05736207962036133}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 793.3289164974494, "num_env_steps_trained_throughput_per_sec": 793.3289164974494, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 5110.73, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5110.699, "sample_time_ms": 803.406, "learn_time_ms": 4297.253, "learn_throughput": 930.827, "synch_weights_time_ms": 9.723}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "training_iteration": 59, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-37", "timestamp": 1723386097, "time_this_iter_s": 5.045486688613892, "time_total_s": 300.5851664543152, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.5851664543152, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 32.01428571428571, "ram_util_percent": 81.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9923227321356536, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.828899674862623, "policy_loss": -0.007814797746201899, "vf_loss": 4.835689461231231, "vf_explained_var": 0.27225682729234296, "kl": 0.011376089054888218, "entropy": 1.3797406904399394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0101960278426607, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.851905232916276, "policy_loss": -0.0024479641559688996, "vf_loss": 4.854163606464863, "vf_explained_var": 0.27209207974374294, "kl": 0.00532648201700228, "entropy": 0.6544057335704565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 379.18, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37918, "policy_reward_min": {"prey_policy": -45.44734189253895, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 45.44734189253895}, "policy_reward_mean": {"prey_policy": 14.933733934375212, "predator_policy": -14.933733934375212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [225, 400, 400, 170, 290, 210, 400, 400, 400, 400, 294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-33.595337339156956, 1.2750613381336624, 6.307500151054427, -35.36442706636477, -6.29127767241177, -36.39010141902412, 22.471642123006767, -5.695730270745978, 31.01841574770004, 36.08920514146094, -45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713], "policy_predator_policy_reward": [33.595337339156956, -1.2750613381336624, -6.307500151054427, 35.36442706636477, 6.29127767241177, 36.39010141902412, -22.471642123006767, 5.695730270745978, -31.01841574770004, -36.08920514146094, 45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30176593863478673, "mean_inference_ms": 1.0122517753757616, "mean_action_processing_ms": 0.13286143855672575, "mean_env_wait_ms": 0.21670588986513814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004112601280212402, "StateBufferConnector_ms": 0.0024105310440063477, "ViewRequirementAgentConnector_ms": 0.05749404430389404}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 779.9834381759157, "num_env_steps_trained_throughput_per_sec": 779.9834381759157, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 5106.727, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5106.696, "sample_time_ms": 799.935, "learn_time_ms": 4296.49, "learn_throughput": 930.992, "synch_weights_time_ms": 9.95}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 60, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-42", "timestamp": 1723386102, "time_this_iter_s": 5.133100986480713, "time_total_s": 305.7182674407959, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.7182674407959, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.942857142857143, "ram_util_percent": 81.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2907625677064063, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0585822126517694, "policy_loss": -0.007220898799520607, "vf_loss": 3.064531622454524, "vf_explained_var": 0.5577934255202611, "kl": 0.014111819285662807, "entropy": 1.3584585549930732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.162323553736011, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0587791034330922, "policy_loss": -0.005328260418415691, "vf_loss": 3.063852364073197, "vf_explained_var": 0.5542458013941844, "kl": 0.007164304352390215, "entropy": 0.6396979639927546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.23, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38623, "policy_reward_min": {"prey_policy": -45.44734189253895, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 45.44734189253895}, "policy_reward_mean": {"prey_policy": 15.815774465064983, "predator_policy": -15.815774465064983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [294, 400, 400, 400, 240, 400, 400, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-45.44734189253895, 8.146066883531539, 18.856496649757787, 6.214018423573471, -23.750196719807, -4.44426579538969, -3.6435129631687824, 42.04891153726292, 16.179995781602422, 22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223], "policy_predator_policy_reward": [45.44734189253895, -8.146066883531539, -18.856496649757787, -6.214018423573471, 23.750196719807, 4.44426579538969, 3.6435129631687824, -42.04891153726292, -16.179995781602422, -22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3018088289579778, "mean_inference_ms": 1.0123866054746349, "mean_action_processing_ms": 0.13285912335799824, "mean_env_wait_ms": 0.2168109756831864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004206418991088867, "StateBufferConnector_ms": 0.0024524927139282227, "ViewRequirementAgentConnector_ms": 0.05641162395477295}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 787.8615748275246, "num_env_steps_trained_throughput_per_sec": 787.8615748275246, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 5098.611, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5098.58, "sample_time_ms": 786.419, "learn_time_ms": 4301.881, "learn_throughput": 929.826, "synch_weights_time_ms": 9.96}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "training_iteration": 61, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-48", "timestamp": 1723386108, "time_this_iter_s": 5.079952955245972, "time_total_s": 310.79822039604187, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 310.79822039604187, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 35.77142857142857, "ram_util_percent": 81.87142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4003605142235758, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.26034093995889, "policy_loss": -0.005077153859989873, "vf_loss": 3.264062689244747, "vf_explained_var": 0.5718074997266134, "kl": 0.015043211346639992, "entropy": 1.3917176598062118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.375921365028868, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.272174180795749, "policy_loss": -0.008234026545687811, "vf_loss": 3.280206057180961, "vf_explained_var": 0.5640781317527096, "kl": 0.0056791293882260206, "entropy": 0.6300668824464083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.89, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38889, "policy_reward_min": {"prey_policy": -25.821097091001132, "predator_policy": -44.46859237500777}, "policy_reward_max": {"prey_policy": 44.46859237500777, "predator_policy": 25.821097091001132}, "policy_reward_mean": {"prey_policy": 15.306510917690858, "predator_policy": -15.306510917690858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [22.428151054178105, 12.733231541851879, 10.794757443708903, -5.603102908046889, 4.994725573226923, 28.346380791610212, 28.31797003705766, 13.104764413554001, 32.65422415426004, 41.283870680293624, 44.46859237500777, 36.89957950659286, -22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223, -0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769], "policy_predator_policy_reward": [-22.428151054178105, -12.733231541851879, -10.794757443708903, 5.603102908046889, -4.994725573226923, -28.346380791610212, -28.31797003705766, -13.104764413554001, -32.65422415426004, -41.283870680293624, -44.46859237500777, -36.89957950659286, 22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223, 0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3020308973321842, "mean_inference_ms": 1.0128040491939196, "mean_action_processing_ms": 0.13288580937379996, "mean_env_wait_ms": 0.21712481003076856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041964054107666016, "StateBufferConnector_ms": 0.0024385452270507812, "ViewRequirementAgentConnector_ms": 0.05457735061645508}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 737.2908721603219, "num_env_steps_trained_throughput_per_sec": 737.2908721603219, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 5129.489, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5129.457, "sample_time_ms": 811.216, "learn_time_ms": 4307.93, "learn_throughput": 928.52, "synch_weights_time_ms": 9.979}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 62, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-53", "timestamp": 1723386113, "time_this_iter_s": 5.429017782211304, "time_total_s": 316.2272381782532, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.2272381782532, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.55, "ram_util_percent": 82.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4324557760419947, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2792163434127968, "policy_loss": -0.009034098839523115, "vf_loss": 3.2864962513248126, "vf_explained_var": 0.6255403527989983, "kl": 0.01946911116719934, "entropy": 1.3911076984057824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.274247059350212, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.334943267703056, "policy_loss": -0.0054821611255950605, "vf_loss": 3.3402393711109957, "vf_explained_var": 0.6170156025638183, "kl": 0.005227060764277745, "entropy": 0.6735118846719463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.46, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 39246, "policy_reward_min": {"prey_policy": -25.821097091001132, "predator_policy": -44.3851465829552}, "policy_reward_max": {"prey_policy": 44.3851465829552, "predator_policy": 25.821097091001132}, "policy_reward_mean": {"prey_policy": 13.489433555891077, "predator_policy": -13.489433555891077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-22.543821154510844, 31.189706144395828, 30.414373985746487, 32.5464020299834, 24.005329657875425, 26.991256849253695, 23.53074954776279, 30.21799958193979, 43.76087376618478, 25.970592962564787, 44.3851465829552, 29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223, -0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769, -10.18719993975008, 13.834035964524588, 6.378363190893346, -17.37185975528176, -2.9966125000322137, 34.34388044187456, 2.6842542231707966, 20.17612960322125, 1.5474372689056715, 15.564030089711636, 4.61027402972973, 20.132675866349608], "policy_predator_policy_reward": [22.543821154510844, -31.189706144395828, -30.414373985746487, -32.5464020299834, -24.005329657875425, -26.991256849253695, -23.53074954776279, -30.21799958193979, -43.76087376618478, -25.970592962564787, -44.3851465829552, -29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223, 0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769, 10.18719993975008, -13.834035964524588, -6.378363190893346, 17.37185975528176, 2.9966125000322137, -34.34388044187456, -2.6842542231707966, -20.17612960322125, -1.5474372689056715, -15.564030089711636, -4.61027402972973, -20.132675866349608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30202025784114284, "mean_inference_ms": 1.0136692429617147, "mean_action_processing_ms": 0.1329117282377583, "mean_env_wait_ms": 0.21743068363267082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004185080528259277, "StateBufferConnector_ms": 0.002267599105834961, "ViewRequirementAgentConnector_ms": 0.053172945976257324}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.0068568485879, "num_env_steps_trained_throughput_per_sec": 785.0068568485879, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 5141.296, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5141.265, "sample_time_ms": 815.613, "learn_time_ms": 4315.402, "learn_throughput": 926.913, "synch_weights_time_ms": 9.921}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 63, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-21-58", "timestamp": 1723386118, "time_this_iter_s": 5.098300933837891, "time_total_s": 321.32553911209106, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.32553911209106, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 31.47142857142857, "ram_util_percent": 82.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1129847783284883, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.326190269490083, "policy_loss": -0.005362782221588229, "vf_loss": 4.330517641703287, "vf_explained_var": -0.5299905459086101, "kl": 0.011491541557577988, "entropy": 1.3300426583737135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.943534045604368, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.384088093042374, "policy_loss": -0.001562414599902695, "vf_loss": 4.385512747615576, "vf_explained_var": -0.535679392889142, "kl": 0.0038699305427792024, "entropy": 0.7204829655587673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.17, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38617, "policy_reward_min": {"prey_policy": -40.80901666588005, "predator_policy": -41.707820935097516}, "policy_reward_max": {"prey_policy": 41.707820935097516, "predator_policy": 40.80901666588005}, "policy_reward_mean": {"prey_policy": 10.059340556812508, "predator_policy": -10.059340556812508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 323, 400, 102, 400, 400, 400, 400, 400, 30, 158, 400], "policy_prey_policy_reward": [29.67301006343768, 27.610487858202656, 5.239479081649122, 31.789487143205655, 13.893507226055352, 20.760428531693858, 2.6804255625688747, 13.037981001617048, 25.892787548759024, 21.902035301235347, 7.121737589164638, 30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223, -0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769, -10.18719993975008, 13.834035964524588, 6.378363190893346, -17.37185975528176, -2.9966125000322137, 34.34388044187456, 2.6842542231707966, 20.17612960322125, 1.5474372689056715, 15.564030089711636, 4.61027402972973, 20.132675866349608, -40.80901666588005, 4.407305731678711, -26.606076556559948, -13.963267351587952, 6.444997202251255, -17.251799802323283, 21.0449759172095, 22.717564629027258, -16.416555752247817, -12.58615410421311, 20.477336798939866], "policy_predator_policy_reward": [-29.67301006343768, -27.610487858202656, -5.239479081649122, -31.789487143205655, -13.893507226055352, -20.760428531693858, -2.6804255625688747, -13.037981001617048, -25.892787548759024, -21.902035301235347, -7.121737589164638, -30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223, 0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769, 10.18719993975008, -13.834035964524588, -6.378363190893346, 17.37185975528176, 2.9966125000322137, -34.34388044187456, -2.6842542231707966, -20.17612960322125, -1.5474372689056715, -15.564030089711636, -4.61027402972973, -20.132675866349608, 40.80901666588005, -4.407305731678711, 26.606076556559948, 13.963267351587952, -6.444997202251255, 17.251799802323283, -21.0449759172095, -22.717564629027258, 16.416555752247817, 12.58615410421311, -20.477336798939866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30222928248074504, "mean_inference_ms": 1.013872267444219, "mean_action_processing_ms": 0.13291390619626664, "mean_env_wait_ms": 0.21776778792317356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004027962684631348, "StateBufferConnector_ms": 0.0022699832916259766, "ViewRequirementAgentConnector_ms": 0.05624282360076904}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.9394124732324, "num_env_steps_trained_throughput_per_sec": 785.9394124732324, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 5125.537, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5125.506, "sample_time_ms": 804.865, "learn_time_ms": 4310.433, "learn_throughput": 927.981, "synch_weights_time_ms": 9.881}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 64, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-03", "timestamp": 1723386123, "time_this_iter_s": 5.092113018035889, "time_total_s": 326.41765213012695, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fdbedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.41765213012695, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 32.614285714285714, "ram_util_percent": 82.34285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2046063747877875, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3761700404187045, "policy_loss": -0.007815748633341476, "vf_loss": 3.3830286941180625, "vf_explained_var": -0.005519799888134003, "kl": 0.010622395723114924, "entropy": 1.2409449887772401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0501785869710147, "cur_kl_coeff": 0.017797851562499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4331376110514005, "policy_loss": -0.001559566926637975, "vf_loss": 3.4346407130360603, "vf_explained_var": -0.025460062610606352, "kl": 0.0031732922310006443, "entropy": 0.7985901351397237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 380.19, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38019, "policy_reward_min": {"prey_policy": -40.80901666588005, "predator_policy": -43.354970253815765}, "policy_reward_max": {"prey_policy": 43.354970253815765, "predator_policy": 40.80901666588005}, "policy_reward_mean": {"prey_policy": 9.96388398212259, "predator_policy": -9.96388398212259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 323, 400, 102, 400, 400, 400, 400, 400, 30, 158, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 90, 400], "policy_prey_policy_reward": [30.16690085626025, 39.16665538489586, 22.58535798702498, 16.491371466785324, 5.142975902703618, -4.891980454862576, 11.335463252659082, 12.36180713386868, 34.99506261724322, 30.428034791876584, 16.386826893968866, 35.480435091413675, 36.21032013925009, 27.67501129933141, 25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223, -0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769, -10.18719993975008, 13.834035964524588, 6.378363190893346, -17.37185975528176, -2.9966125000322137, 34.34388044187456, 2.6842542231707966, 20.17612960322125, 1.5474372689056715, 15.564030089711636, 4.61027402972973, 20.132675866349608, -40.80901666588005, 4.407305731678711, -26.606076556559948, -13.963267351587952, 6.444997202251255, -17.251799802323283, 21.0449759172095, 22.717564629027258, -16.416555752247817, -12.58615410421311, 20.477336798939866, 27.003099174082912, 43.354970253815765, -34.05406700302991, 21.358792586509512, 35.123964617109394, 9.964562554936077, 34.181709231988265, 35.09564865524885, 14.69323501868023, -13.164708595048047, 16.498502944304523], "policy_predator_policy_reward": [-30.16690085626025, -39.16665538489586, -22.58535798702498, -16.491371466785324, -5.142975902703618, 4.891980454862576, -11.335463252659082, -12.36180713386868, -34.99506261724322, -30.428034791876584, -16.386826893968866, -35.480435091413675, -36.21032013925009, -27.67501129933141, -25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223, 0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769, 10.18719993975008, -13.834035964524588, -6.378363190893346, 17.37185975528176, 2.9966125000322137, -34.34388044187456, -2.6842542231707966, -20.17612960322125, -1.5474372689056715, -15.564030089711636, -4.61027402972973, -20.132675866349608, 40.80901666588005, -4.407305731678711, 26.606076556559948, 13.963267351587952, -6.444997202251255, 17.251799802323283, -21.0449759172095, -22.717564629027258, 16.416555752247817, 12.58615410421311, -20.477336798939866, -27.003099174082912, -43.354970253815765, 34.05406700302991, -21.358792586509512, -35.123964617109394, -9.964562554936077, -34.181709231988265, -35.09564865524885, -14.69323501868023, 13.164708595048047, -16.498502944304523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3023292038481472, "mean_inference_ms": 1.0142963241783833, "mean_action_processing_ms": 0.13300572656818976, "mean_env_wait_ms": 0.21803546870885998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040891170501708984, "StateBufferConnector_ms": 0.00232541561126709, "ViewRequirementAgentConnector_ms": 0.056328654289245605}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 732.3618397991651, "num_env_steps_trained_throughput_per_sec": 732.3618397991651, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 5159.252, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5159.22, "sample_time_ms": 805.969, "learn_time_ms": 4342.975, "learn_throughput": 921.028, "synch_weights_time_ms": 9.94}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 65, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-09", "timestamp": 1723386129, "time_this_iter_s": 5.464409828186035, "time_total_s": 331.882061958313, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 331.882061958313, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 32.6375, "ram_util_percent": 82.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0866607998187345, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.03442421456178, "policy_loss": -0.002689881270634942, "vf_loss": 4.036291328072548, "vf_explained_var": -0.3835518628358841, "kl": 0.009131634738420758, "entropy": 1.198189384986957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.900926151840637, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.055932425335049, "policy_loss": -0.004407148428920967, "vf_loss": 4.060265316193303, "vf_explained_var": -0.39528256598860023, "kl": 0.008345485277976501, "entropy": 0.8211833843340476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 364.44, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 36444, "policy_reward_min": {"prey_policy": -40.80901666588005, "predator_policy": -43.354970253815765}, "policy_reward_max": {"prey_policy": 43.354970253815765, "predator_policy": 40.80901666588005}, "policy_reward_mean": {"prey_policy": 8.370080783152764, "predator_policy": -8.370080783152764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 323, 400, 102, 400, 400, 400, 400, 400, 30, 158, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 90, 400, 400, 99, 400, 400, 400, 295, 185, 400, 7, 400, 400, 59, 400, 180], "policy_prey_policy_reward": [25.17556333026957, -24.523706324232478, 11.20090916561206, 26.717617633301884, 24.178180195270905, 33.853434148729875, 10.17728044479442, -14.157396247278768, 19.7026271350025, 12.397315421320215, 4.102527212151138, -2.583307797376854, 31.188262499548202, 8.556453604961298, 41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223, -0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769, -10.18719993975008, 13.834035964524588, 6.378363190893346, -17.37185975528176, -2.9966125000322137, 34.34388044187456, 2.6842542231707966, 20.17612960322125, 1.5474372689056715, 15.564030089711636, 4.61027402972973, 20.132675866349608, -40.80901666588005, 4.407305731678711, -26.606076556559948, -13.963267351587952, 6.444997202251255, -17.251799802323283, 21.0449759172095, 22.717564629027258, -16.416555752247817, -12.58615410421311, 20.477336798939866, 27.003099174082912, 43.354970253815765, -34.05406700302991, 21.358792586509512, 35.123964617109394, 9.964562554936077, 34.181709231988265, 35.09564865524885, 14.69323501868023, -13.164708595048047, 16.498502944304523, 23.943824347789562, -7.553358061218319, 37.8631747036485, 26.753682181790094, 34.43380005022739, -6.285279458987439, -19.908196510924405, 27.467622523711697, -2.2002091050635855, 32.17981492567091, 14.731993075482219, -5.38506096336818, 38.129435597246136, -40.017320840568374], "policy_predator_policy_reward": [-25.17556333026957, 24.523706324232478, -11.20090916561206, -26.717617633301884, -24.178180195270905, -33.853434148729875, -10.17728044479442, 14.157396247278768, -19.7026271350025, -12.397315421320215, -4.102527212151138, 2.583307797376854, -31.188262499548202, -8.556453604961298, -41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223, 0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769, 10.18719993975008, -13.834035964524588, -6.378363190893346, 17.37185975528176, 2.9966125000322137, -34.34388044187456, -2.6842542231707966, -20.17612960322125, -1.5474372689056715, -15.564030089711636, -4.61027402972973, -20.132675866349608, 40.80901666588005, -4.407305731678711, 26.606076556559948, 13.963267351587952, -6.444997202251255, 17.251799802323283, -21.0449759172095, -22.717564629027258, 16.416555752247817, 12.58615410421311, -20.477336798939866, -27.003099174082912, -43.354970253815765, 34.05406700302991, -21.358792586509512, -35.123964617109394, -9.964562554936077, -34.181709231988265, -35.09564865524885, -14.69323501868023, 13.164708595048047, -16.498502944304523, -23.943824347789562, 7.553358061218319, -37.8631747036485, -26.753682181790094, -34.43380005022739, 6.285279458987439, 19.908196510924405, -27.467622523711697, 2.2002091050635855, -32.17981492567091, -14.731993075482219, 5.38506096336818, -38.129435597246136, 40.017320840568374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30227953141671754, "mean_inference_ms": 1.0145827184258065, "mean_action_processing_ms": 0.1329618022447748, "mean_env_wait_ms": 0.21842527883010254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003945112228393555, "StateBufferConnector_ms": 0.0022972822189331055, "ViewRequirementAgentConnector_ms": 0.05494964122772217}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.0768516746381, "num_env_steps_trained_throughput_per_sec": 781.0768516746381, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 5172.053, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5172.019, "sample_time_ms": 804.043, "learn_time_ms": 4357.513, "learn_throughput": 917.955, "synch_weights_time_ms": 10.126}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 66, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-14", "timestamp": 1723386134, "time_this_iter_s": 5.123888969421387, "time_total_s": 337.0059509277344, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.0059509277344, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 32.72857142857143, "ram_util_percent": 82.25714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0211920257036886, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6572206258773803, "policy_loss": -0.0028947185613408997, "vf_loss": 3.6592057339847086, "vf_explained_var": -0.2913756642490625, "kl": 0.01009541186835392, "entropy": 1.1318278049429258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9247375952700776, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6783037083844343, "policy_loss": -0.0013329671332030558, "vf_loss": 3.6795973678429923, "vf_explained_var": -0.3147566055878997, "kl": 0.0044172904361677945, "entropy": 0.8426091345647971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 349.84, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 34984, "policy_reward_min": {"prey_policy": -53.74864182668459, "predator_policy": -43.354970253815765}, "policy_reward_max": {"prey_policy": 43.354970253815765, "predator_policy": 53.74864182668459}, "policy_reward_mean": {"prey_policy": 7.049117911199164, "predator_policy": -7.049117911199164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 323, 400, 102, 400, 400, 400, 400, 400, 30, 158, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 90, 400, 400, 99, 400, 400, 400, 295, 185, 400, 7, 400, 400, 59, 400, 180, 400, 400, 147, 141, 97, 400, 400, 400, 88, 400, 400, 67, 400, 400], "policy_prey_policy_reward": [41.707820935097516, 2.409972057603497, -3.252131400807969, 16.085357568312, 12.328860472067767, 23.84449108120903, 30.266437048970406, -17.66577223974255, 33.354123397804116, 8.982225742804353, 14.409043502355448, 25.147938507556464, 22.532225283969577, -14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223, -0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769, -10.18719993975008, 13.834035964524588, 6.378363190893346, -17.37185975528176, -2.9966125000322137, 34.34388044187456, 2.6842542231707966, 20.17612960322125, 1.5474372689056715, 15.564030089711636, 4.61027402972973, 20.132675866349608, -40.80901666588005, 4.407305731678711, -26.606076556559948, -13.963267351587952, 6.444997202251255, -17.251799802323283, 21.0449759172095, 22.717564629027258, -16.416555752247817, -12.58615410421311, 20.477336798939866, 27.003099174082912, 43.354970253815765, -34.05406700302991, 21.358792586509512, 35.123964617109394, 9.964562554936077, 34.181709231988265, 35.09564865524885, 14.69323501868023, -13.164708595048047, 16.498502944304523, 23.943824347789562, -7.553358061218319, 37.8631747036485, 26.753682181790094, 34.43380005022739, -6.285279458987439, -19.908196510924405, 27.467622523711697, -2.2002091050635855, 32.17981492567091, 14.731993075482219, -5.38506096336818, 38.129435597246136, -40.017320840568374, 19.59413620127142, 20.78602859513511, -17.692579888198264, -53.74864182668459, -19.985242649595016, 28.003694438622276, 19.61271906698589, 30.643667263799294, -30.2649707221708, 11.315828382809016, 8.970074853911605, -26.709786333953982, 23.312341008595116, 20.052204836186835], "policy_predator_policy_reward": [-41.707820935097516, -2.409972057603497, 3.252131400807969, -16.085357568312, -12.328860472067767, -23.84449108120903, -30.266437048970406, 17.66577223974255, -33.354123397804116, -8.982225742804353, -14.409043502355448, -25.147938507556464, -22.532225283969577, 14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223, 0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769, 10.18719993975008, -13.834035964524588, -6.378363190893346, 17.37185975528176, 2.9966125000322137, -34.34388044187456, -2.6842542231707966, -20.17612960322125, -1.5474372689056715, -15.564030089711636, -4.61027402972973, -20.132675866349608, 40.80901666588005, -4.407305731678711, 26.606076556559948, 13.963267351587952, -6.444997202251255, 17.251799802323283, -21.0449759172095, -22.717564629027258, 16.416555752247817, 12.58615410421311, -20.477336798939866, -27.003099174082912, -43.354970253815765, 34.05406700302991, -21.358792586509512, -35.123964617109394, -9.964562554936077, -34.181709231988265, -35.09564865524885, -14.69323501868023, 13.164708595048047, -16.498502944304523, -23.943824347789562, 7.553358061218319, -37.8631747036485, -26.753682181790094, -34.43380005022739, 6.285279458987439, 19.908196510924405, -27.467622523711697, 2.2002091050635855, -32.17981492567091, -14.731993075482219, 5.38506096336818, -38.129435597246136, 40.017320840568374, -19.59413620127142, -20.78602859513511, 17.692579888198264, 53.74864182668459, 19.985242649595016, -28.003694438622276, -19.61271906698589, -30.643667263799294, 30.2649707221708, -11.315828382809016, -8.970074853911605, 26.709786333953982, -23.312341008595116, -20.052204836186835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3023729950223563, "mean_inference_ms": 1.0146076743994308, "mean_action_processing_ms": 0.13303389700589646, "mean_env_wait_ms": 0.21869973151972072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039119720458984375, "StateBufferConnector_ms": 0.0022852420806884766, "ViewRequirementAgentConnector_ms": 0.054677605628967285}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 756.2823662439423, "num_env_steps_trained_throughput_per_sec": 756.2823662439423, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 5175.897, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5175.863, "sample_time_ms": 797.914, "learn_time_ms": 4367.569, "learn_throughput": 915.841, "synch_weights_time_ms": 10.044}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "training_iteration": 67, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-19", "timestamp": 1723386139, "time_this_iter_s": 5.293559789657593, "time_total_s": 342.29951071739197, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.29951071739197, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 32.45, "ram_util_percent": 82.01249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.754921525189032, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.359046345452468, "policy_loss": -0.007338183596827245, "vf_loss": 4.365192525585493, "vf_explained_var": -0.23346890565007924, "kl": 0.0132297854545542, "entropy": 1.0824993009368578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.730971969664097, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.366374343633652, "policy_loss": -0.0020154651754031266, "vf_loss": 4.3683444735904535, "vf_explained_var": -0.255398070688049, "kl": 0.01018925773105862, "entropy": 0.8611834724744161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 340.14, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34014, "policy_reward_min": {"prey_policy": -53.74864182668459, "predator_policy": -43.354970253815765}, "policy_reward_max": {"prey_policy": 43.354970253815765, "predator_policy": 53.74864182668459}, "policy_reward_mean": {"prey_policy": 4.868567368089629, "predator_policy": -4.868567368089629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 323, 400, 102, 400, 400, 400, 400, 400, 30, 158, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 90, 400, 400, 99, 400, 400, 400, 295, 185, 400, 7, 400, 400, 59, 400, 180, 400, 400, 147, 141, 97, 400, 400, 400, 88, 400, 400, 67, 400, 400, 400, 173, 83, 400, 400, 400, 400, 107, 146, 400, 400, 125, 400], "policy_prey_policy_reward": [-14.750674302424013, 7.325805488173895, -7.651891193512878, 8.547342623156972, 39.31567736063613, 16.43829455628713, 0.8675993940784963, -0.5241373051861693, 18.06048270033138, 13.327309026493669, -6.455045566737802, -3.7446347643909483, 31.7717398343179, 12.326132800710973, -10.899405228754055, 13.298962911765223, -0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769, -10.18719993975008, 13.834035964524588, 6.378363190893346, -17.37185975528176, -2.9966125000322137, 34.34388044187456, 2.6842542231707966, 20.17612960322125, 1.5474372689056715, 15.564030089711636, 4.61027402972973, 20.132675866349608, -40.80901666588005, 4.407305731678711, -26.606076556559948, -13.963267351587952, 6.444997202251255, -17.251799802323283, 21.0449759172095, 22.717564629027258, -16.416555752247817, -12.58615410421311, 20.477336798939866, 27.003099174082912, 43.354970253815765, -34.05406700302991, 21.358792586509512, 35.123964617109394, 9.964562554936077, 34.181709231988265, 35.09564865524885, 14.69323501868023, -13.164708595048047, 16.498502944304523, 23.943824347789562, -7.553358061218319, 37.8631747036485, 26.753682181790094, 34.43380005022739, -6.285279458987439, -19.908196510924405, 27.467622523711697, -2.2002091050635855, 32.17981492567091, 14.731993075482219, -5.38506096336818, 38.129435597246136, -40.017320840568374, 19.59413620127142, 20.78602859513511, -17.692579888198264, -53.74864182668459, -19.985242649595016, 28.003694438622276, 19.61271906698589, 30.643667263799294, -30.2649707221708, 11.315828382809016, 8.970074853911605, -26.709786333953982, 23.312341008595116, 20.052204836186835, 17.96992607366772, -36.60744788159116, -29.73559330553684, 19.43161407081613, -2.240982891504835, 28.286028372806257, 9.029596307649193, -40.23086711230746, -34.87444274878143, 19.07458154725352, 13.650816663207223, -7.326653629299102, 35.66896217986718], "policy_predator_policy_reward": [14.750674302424013, -7.325805488173895, 7.651891193512878, -8.547342623156972, -39.31567736063613, -16.43829455628713, -0.8675993940784963, 0.5241373051861693, -18.06048270033138, -13.327309026493669, 6.455045566737802, 3.7446347643909483, -31.7717398343179, -12.326132800710973, 10.899405228754055, -13.298962911765223, 0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769, 10.18719993975008, -13.834035964524588, -6.378363190893346, 17.37185975528176, 2.9966125000322137, -34.34388044187456, -2.6842542231707966, -20.17612960322125, -1.5474372689056715, -15.564030089711636, -4.61027402972973, -20.132675866349608, 40.80901666588005, -4.407305731678711, 26.606076556559948, 13.963267351587952, -6.444997202251255, 17.251799802323283, -21.0449759172095, -22.717564629027258, 16.416555752247817, 12.58615410421311, -20.477336798939866, -27.003099174082912, -43.354970253815765, 34.05406700302991, -21.358792586509512, -35.123964617109394, -9.964562554936077, -34.181709231988265, -35.09564865524885, -14.69323501868023, 13.164708595048047, -16.498502944304523, -23.943824347789562, 7.553358061218319, -37.8631747036485, -26.753682181790094, -34.43380005022739, 6.285279458987439, 19.908196510924405, -27.467622523711697, 2.2002091050635855, -32.17981492567091, -14.731993075482219, 5.38506096336818, -38.129435597246136, 40.017320840568374, -19.59413620127142, -20.78602859513511, 17.692579888198264, 53.74864182668459, 19.985242649595016, -28.003694438622276, -19.61271906698589, -30.643667263799294, 30.2649707221708, -11.315828382809016, -8.970074853911605, 26.709786333953982, -23.312341008595116, -20.052204836186835, -17.96992607366772, 36.60744788159116, 29.73559330553684, -19.43161407081613, 2.240982891504835, -28.286028372806257, -9.029596307649193, 40.23086711230746, 34.87444274878143, -19.07458154725352, -13.650816663207223, 7.326653629299102, -35.66896217986718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30215835668224467, "mean_inference_ms": 1.0145550233175102, "mean_action_processing_ms": 0.1330190196725219, "mean_env_wait_ms": 0.2188614079213222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039670467376708984, "StateBufferConnector_ms": 0.0024341344833374023, "ViewRequirementAgentConnector_ms": 0.0572892427444458}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 794.3814747151589, "num_env_steps_trained_throughput_per_sec": 794.3814747151589, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 5176.499, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5176.466, "sample_time_ms": 788.701, "learn_time_ms": 4377.417, "learn_throughput": 913.781, "synch_weights_time_ms": 10.022}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 68, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-24", "timestamp": 1723386144, "time_this_iter_s": 5.038153886795044, "time_total_s": 347.337664604187, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.337664604187, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 30.014285714285716, "ram_util_percent": 81.91428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6643541457441944, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.364377778023481, "policy_loss": -0.004648486959437529, "vf_loss": 4.36814596876502, "vf_explained_var": -0.803712552661697, "kl": 0.009769895996594806, "entropy": 1.0973422434180975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.525487192347646, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.364233206957579, "policy_loss": -0.002557912680398052, "vf_loss": 4.366747684031725, "vf_explained_var": -0.8621230330318213, "kl": 0.009762541623026524, "entropy": 0.8048922281712294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 321.12, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 32112, "policy_reward_min": {"prey_policy": -53.74864182668459, "predator_policy": -43.354970253815765}, "policy_reward_max": {"prey_policy": 43.354970253815765, "predator_policy": 53.74864182668459}, "policy_reward_mean": {"prey_policy": 3.311557514190403, "predator_policy": -3.311557514190403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 323, 400, 102, 400, 400, 400, 400, 400, 30, 158, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 90, 400, 400, 99, 400, 400, 400, 295, 185, 400, 7, 400, 400, 59, 400, 180, 400, 400, 147, 141, 97, 400, 400, 400, 88, 400, 400, 67, 400, 400, 400, 173, 83, 400, 400, 400, 400, 107, 146, 400, 400, 125, 400, 400, 88, 400, 99, 400, 118, 400, 152, 136, 400, 194, 182, 400, 400, 329, 400], "policy_prey_policy_reward": [-0.881676471464699, -15.193096893864109, -25.821097091001132, 19.757245956042844, -0.0546941445175122, 5.533089900455476, -23.314801294181212, -18.936126421775935, 22.14497362771769, -10.18719993975008, 13.834035964524588, 6.378363190893346, -17.37185975528176, -2.9966125000322137, 34.34388044187456, 2.6842542231707966, 20.17612960322125, 1.5474372689056715, 15.564030089711636, 4.61027402972973, 20.132675866349608, -40.80901666588005, 4.407305731678711, -26.606076556559948, -13.963267351587952, 6.444997202251255, -17.251799802323283, 21.0449759172095, 22.717564629027258, -16.416555752247817, -12.58615410421311, 20.477336798939866, 27.003099174082912, 43.354970253815765, -34.05406700302991, 21.358792586509512, 35.123964617109394, 9.964562554936077, 34.181709231988265, 35.09564865524885, 14.69323501868023, -13.164708595048047, 16.498502944304523, 23.943824347789562, -7.553358061218319, 37.8631747036485, 26.753682181790094, 34.43380005022739, -6.285279458987439, -19.908196510924405, 27.467622523711697, -2.2002091050635855, 32.17981492567091, 14.731993075482219, -5.38506096336818, 38.129435597246136, -40.017320840568374, 19.59413620127142, 20.78602859513511, -17.692579888198264, -53.74864182668459, -19.985242649595016, 28.003694438622276, 19.61271906698589, 30.643667263799294, -30.2649707221708, 11.315828382809016, 8.970074853911605, -26.709786333953982, 23.312341008595116, 20.052204836186835, 17.96992607366772, -36.60744788159116, -29.73559330553684, 19.43161407081613, -2.240982891504835, 28.286028372806257, 9.029596307649193, -40.23086711230746, -34.87444274878143, 19.07458154725352, 13.650816663207223, -7.326653629299102, 35.66896217986718, 18.44367955566532, -40.7165579006479, 7.505681248545837, -35.56518446258236, 34.31810324530612, -38.37279195442295, 38.7376716140905, -21.174880518214895, -21.46396880694534, 32.20971039564132, -21.9389301016435, -21.136288385596167, 22.88583374786505, 11.158328381361834, -25.05917859451231, 21.721345481112657], "policy_predator_policy_reward": [0.881676471464699, 15.193096893864109, 25.821097091001132, -19.757245956042844, 0.0546941445175122, -5.533089900455476, 23.314801294181212, 18.936126421775935, -22.14497362771769, 10.18719993975008, -13.834035964524588, -6.378363190893346, 17.37185975528176, 2.9966125000322137, -34.34388044187456, -2.6842542231707966, -20.17612960322125, -1.5474372689056715, -15.564030089711636, -4.61027402972973, -20.132675866349608, 40.80901666588005, -4.407305731678711, 26.606076556559948, 13.963267351587952, -6.444997202251255, 17.251799802323283, -21.0449759172095, -22.717564629027258, 16.416555752247817, 12.58615410421311, -20.477336798939866, -27.003099174082912, -43.354970253815765, 34.05406700302991, -21.358792586509512, -35.123964617109394, -9.964562554936077, -34.181709231988265, -35.09564865524885, -14.69323501868023, 13.164708595048047, -16.498502944304523, -23.943824347789562, 7.553358061218319, -37.8631747036485, -26.753682181790094, -34.43380005022739, 6.285279458987439, 19.908196510924405, -27.467622523711697, 2.2002091050635855, -32.17981492567091, -14.731993075482219, 5.38506096336818, -38.129435597246136, 40.017320840568374, -19.59413620127142, -20.78602859513511, 17.692579888198264, 53.74864182668459, 19.985242649595016, -28.003694438622276, -19.61271906698589, -30.643667263799294, 30.2649707221708, -11.315828382809016, -8.970074853911605, 26.709786333953982, -23.312341008595116, -20.052204836186835, -17.96992607366772, 36.60744788159116, 29.73559330553684, -19.43161407081613, 2.240982891504835, -28.286028372806257, -9.029596307649193, 40.23086711230746, 34.87444274878143, -19.07458154725352, -13.650816663207223, 7.326653629299102, -35.66896217986718, -18.44367955566532, 40.7165579006479, -7.505681248545837, 35.56518446258236, -34.31810324530612, 38.37279195442295, -38.7376716140905, 21.174880518214895, 21.46396880694534, -32.20971039564132, 21.9389301016435, 21.136288385596167, -22.88583374786505, -11.158328381361834, 25.05917859451231, -21.721345481112657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3022035716528604, "mean_inference_ms": 1.0145814236277908, "mean_action_processing_ms": 0.13302152609611384, "mean_env_wait_ms": 0.21921042581827602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00380706787109375, "StateBufferConnector_ms": 0.002400636672973633, "ViewRequirementAgentConnector_ms": 0.055948734283447266}, "num_episodes": 16, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.0798027834048, "num_env_steps_trained_throughput_per_sec": 749.0798027834048, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 5206.283, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5206.25, "sample_time_ms": 788.288, "learn_time_ms": 4407.567, "learn_throughput": 907.53, "synch_weights_time_ms": 10.067}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 69, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-30", "timestamp": 1723386150, "time_this_iter_s": 5.345140218734741, "time_total_s": 352.68280482292175, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 352.68280482292175, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 31.975, "ram_util_percent": 82.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8845792133671542, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.756790267924468, "policy_loss": -0.008526532737596427, "vf_loss": 6.764214262366295, "vf_explained_var": -0.5058830377956232, "kl": 0.012236574345984045, "entropy": 1.015525992338856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8481384575366975, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.816763298213482, "policy_loss": -0.0044992775850308435, "vf_loss": 6.821222750345866, "vf_explained_var": -0.5783698921402295, "kl": 0.00894887582157935, "entropy": 0.9263834111392498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 285.47, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 28547, "policy_reward_min": {"prey_policy": -53.74864182668459, "predator_policy": -43.354970253815765}, "policy_reward_max": {"prey_policy": 43.354970253815765, "predator_policy": 53.74864182668459}, "policy_reward_mean": {"prey_policy": 1.1113652874073432, "predator_policy": -1.1113652874073432}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 323, 400, 102, 400, 400, 400, 400, 400, 30, 158, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 90, 400, 400, 99, 400, 400, 400, 295, 185, 400, 7, 400, 400, 59, 400, 180, 400, 400, 147, 141, 97, 400, 400, 400, 88, 400, 400, 67, 400, 400, 400, 173, 83, 400, 400, 400, 400, 107, 146, 400, 400, 125, 400, 400, 88, 400, 99, 400, 118, 400, 152, 136, 400, 194, 182, 400, 400, 329, 400, 400, 400, 153, 188, 400, 285, 236, 46, 188, 400, 61, 4, 127, 156, 148, 400, 211, 400, 216, 16], "policy_prey_policy_reward": [20.132675866349608, -40.80901666588005, 4.407305731678711, -26.606076556559948, -13.963267351587952, 6.444997202251255, -17.251799802323283, 21.0449759172095, 22.717564629027258, -16.416555752247817, -12.58615410421311, 20.477336798939866, 27.003099174082912, 43.354970253815765, -34.05406700302991, 21.358792586509512, 35.123964617109394, 9.964562554936077, 34.181709231988265, 35.09564865524885, 14.69323501868023, -13.164708595048047, 16.498502944304523, 23.943824347789562, -7.553358061218319, 37.8631747036485, 26.753682181790094, 34.43380005022739, -6.285279458987439, -19.908196510924405, 27.467622523711697, -2.2002091050635855, 32.17981492567091, 14.731993075482219, -5.38506096336818, 38.129435597246136, -40.017320840568374, 19.59413620127142, 20.78602859513511, -17.692579888198264, -53.74864182668459, -19.985242649595016, 28.003694438622276, 19.61271906698589, 30.643667263799294, -30.2649707221708, 11.315828382809016, 8.970074853911605, -26.709786333953982, 23.312341008595116, 20.052204836186835, 17.96992607366772, -36.60744788159116, -29.73559330553684, 19.43161407081613, -2.240982891504835, 28.286028372806257, 9.029596307649193, -40.23086711230746, -34.87444274878143, 19.07458154725352, 13.650816663207223, -7.326653629299102, 35.66896217986718, 18.44367955566532, -40.7165579006479, 7.505681248545837, -35.56518446258236, 34.31810324530612, -38.37279195442295, 38.7376716140905, -21.174880518214895, -21.46396880694534, 32.20971039564132, -21.9389301016435, -21.136288385596167, 22.88583374786505, 11.158328381361834, -25.05917859451231, 21.721345481112657, 25.95549231975804, 20.35019379822145, -24.534241211281604, -11.730113417878442, 9.063643171656231, -33.59053240294476, -8.082123570736735, -3.541863062446916, -37.7853204498731, 10.579409452500784, -12.101508207409204, -1.9473712654056528, -29.28218539914868, -35.04484543072271, -13.07093678087405, 0.957256413839012, -25.16819368114915, 19.564308910295534, -35.95602359855306, -2.8377184817739813], "policy_predator_policy_reward": [-20.132675866349608, 40.80901666588005, -4.407305731678711, 26.606076556559948, 13.963267351587952, -6.444997202251255, 17.251799802323283, -21.0449759172095, -22.717564629027258, 16.416555752247817, 12.58615410421311, -20.477336798939866, -27.003099174082912, -43.354970253815765, 34.05406700302991, -21.358792586509512, -35.123964617109394, -9.964562554936077, -34.181709231988265, -35.09564865524885, -14.69323501868023, 13.164708595048047, -16.498502944304523, -23.943824347789562, 7.553358061218319, -37.8631747036485, -26.753682181790094, -34.43380005022739, 6.285279458987439, 19.908196510924405, -27.467622523711697, 2.2002091050635855, -32.17981492567091, -14.731993075482219, 5.38506096336818, -38.129435597246136, 40.017320840568374, -19.59413620127142, -20.78602859513511, 17.692579888198264, 53.74864182668459, 19.985242649595016, -28.003694438622276, -19.61271906698589, -30.643667263799294, 30.2649707221708, -11.315828382809016, -8.970074853911605, 26.709786333953982, -23.312341008595116, -20.052204836186835, -17.96992607366772, 36.60744788159116, 29.73559330553684, -19.43161407081613, 2.240982891504835, -28.286028372806257, -9.029596307649193, 40.23086711230746, 34.87444274878143, -19.07458154725352, -13.650816663207223, 7.326653629299102, -35.66896217986718, -18.44367955566532, 40.7165579006479, -7.505681248545837, 35.56518446258236, -34.31810324530612, 38.37279195442295, -38.7376716140905, 21.174880518214895, 21.46396880694534, -32.20971039564132, 21.9389301016435, 21.136288385596167, -22.88583374786505, -11.158328381361834, 25.05917859451231, -21.721345481112657, -25.95549231975804, -20.35019379822145, 24.534241211281604, 11.730113417878442, -9.063643171656231, 33.59053240294476, 8.082123570736735, 3.541863062446916, 37.7853204498731, -10.579409452500784, 12.101508207409204, 1.9473712654056528, 29.28218539914868, 35.04484543072271, 13.07093678087405, -0.957256413839012, 25.16819368114915, -19.564308910295534, 35.95602359855306, 2.8377184817739813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3022362984952013, "mean_inference_ms": 1.0141599160007175, "mean_action_processing_ms": 0.13296378820363342, "mean_env_wait_ms": 0.21920971754902058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003794550895690918, "StateBufferConnector_ms": 0.002436995506286621, "ViewRequirementAgentConnector_ms": 0.056449294090270996}, "num_episodes": 20, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 768.7804642005034, "num_env_steps_trained_throughput_per_sec": 768.7804642005034, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 5213.756, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5213.723, "sample_time_ms": 794.167, "learn_time_ms": 4409.388, "learn_throughput": 907.155, "synch_weights_time_ms": 9.844}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 70, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-35", "timestamp": 1723386155, "time_this_iter_s": 5.206048011779785, "time_total_s": 357.88885283470154, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 357.88885283470154, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 34.199999999999996, "ram_util_percent": 82.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8463127908607324, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.107117214302222, "policy_loss": -0.0037294985425736136, "vf_loss": 7.110244431098303, "vf_explained_var": -0.3270085492481788, "kl": 0.006684434209339831, "entropy": 1.0298744055132072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.774772326524059, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.118754714230696, "policy_loss": -0.001569815970530423, "vf_loss": 7.1202965090672174, "vf_explained_var": -0.30294866176942986, "kl": 0.006299959921265192, "entropy": 0.9757713350777825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 258.54, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 25854, "policy_reward_min": {"prey_policy": -53.74864182668459, "predator_policy": -38.7376716140905}, "policy_reward_max": {"prey_policy": 38.7376716140905, "predator_policy": 53.74864182668459}, "policy_reward_mean": {"prey_policy": -4.033845087319581, "predator_policy": 4.033845087319581}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 90, 400, 400, 99, 400, 400, 400, 295, 185, 400, 7, 400, 400, 59, 400, 180, 400, 400, 147, 141, 97, 400, 400, 400, 88, 400, 400, 67, 400, 400, 400, 173, 83, 400, 400, 400, 400, 107, 146, 400, 400, 125, 400, 400, 88, 400, 99, 400, 118, 400, 152, 136, 400, 194, 182, 400, 400, 329, 400, 400, 400, 153, 188, 400, 285, 236, 46, 188, 400, 61, 4, 127, 156, 148, 400, 211, 400, 216, 16, 210, 130, 22, 136, 91, 67, 87, 400, 400, 137, 135, 153, 400, 122, 357, 243, 133, 354, 175, 280], "policy_prey_policy_reward": [14.69323501868023, -13.164708595048047, 16.498502944304523, 23.943824347789562, -7.553358061218319, 37.8631747036485, 26.753682181790094, 34.43380005022739, -6.285279458987439, -19.908196510924405, 27.467622523711697, -2.2002091050635855, 32.17981492567091, 14.731993075482219, -5.38506096336818, 38.129435597246136, -40.017320840568374, 19.59413620127142, 20.78602859513511, -17.692579888198264, -53.74864182668459, -19.985242649595016, 28.003694438622276, 19.61271906698589, 30.643667263799294, -30.2649707221708, 11.315828382809016, 8.970074853911605, -26.709786333953982, 23.312341008595116, 20.052204836186835, 17.96992607366772, -36.60744788159116, -29.73559330553684, 19.43161407081613, -2.240982891504835, 28.286028372806257, 9.029596307649193, -40.23086711230746, -34.87444274878143, 19.07458154725352, 13.650816663207223, -7.326653629299102, 35.66896217986718, 18.44367955566532, -40.7165579006479, 7.505681248545837, -35.56518446258236, 34.31810324530612, -38.37279195442295, 38.7376716140905, -21.174880518214895, -21.46396880694534, 32.20971039564132, -21.9389301016435, -21.136288385596167, 22.88583374786505, 11.158328381361834, -25.05917859451231, 21.721345481112657, 25.95549231975804, 20.35019379822145, -24.534241211281604, -11.730113417878442, 9.063643171656231, -33.59053240294476, -8.082123570736735, -3.541863062446916, -37.7853204498731, 10.579409452500784, -12.101508207409204, -1.9473712654056528, -29.28218539914868, -35.04484543072271, -13.07093678087405, 0.957256413839012, -25.16819368114915, 19.564308910295534, -35.95602359855306, -2.8377184817739813, -44.65563247433503, -25.012499240502024, -1.7306568746515718, -13.454745586528475, -30.777001171442752, -25.94801687305094, -14.300474148494132, 7.922080508074011, 23.37814532476718, -44.33851720832028, -17.999079363871868, -29.253967027299034, 16.98813935534386, -31.406160349167102, -19.410089827612886, -44.16432429486419, -20.038214028361217, -21.880242136063263, -27.754468644467515, -11.064647428540361], "policy_predator_policy_reward": [-14.69323501868023, 13.164708595048047, -16.498502944304523, -23.943824347789562, 7.553358061218319, -37.8631747036485, -26.753682181790094, -34.43380005022739, 6.285279458987439, 19.908196510924405, -27.467622523711697, 2.2002091050635855, -32.17981492567091, -14.731993075482219, 5.38506096336818, -38.129435597246136, 40.017320840568374, -19.59413620127142, -20.78602859513511, 17.692579888198264, 53.74864182668459, 19.985242649595016, -28.003694438622276, -19.61271906698589, -30.643667263799294, 30.2649707221708, -11.315828382809016, -8.970074853911605, 26.709786333953982, -23.312341008595116, -20.052204836186835, -17.96992607366772, 36.60744788159116, 29.73559330553684, -19.43161407081613, 2.240982891504835, -28.286028372806257, -9.029596307649193, 40.23086711230746, 34.87444274878143, -19.07458154725352, -13.650816663207223, 7.326653629299102, -35.66896217986718, -18.44367955566532, 40.7165579006479, -7.505681248545837, 35.56518446258236, -34.31810324530612, 38.37279195442295, -38.7376716140905, 21.174880518214895, 21.46396880694534, -32.20971039564132, 21.9389301016435, 21.136288385596167, -22.88583374786505, -11.158328381361834, 25.05917859451231, -21.721345481112657, -25.95549231975804, -20.35019379822145, 24.534241211281604, 11.730113417878442, -9.063643171656231, 33.59053240294476, 8.082123570736735, 3.541863062446916, 37.7853204498731, -10.579409452500784, 12.101508207409204, 1.9473712654056528, 29.28218539914868, 35.04484543072271, 13.07093678087405, -0.957256413839012, 25.16819368114915, -19.564308910295534, 35.95602359855306, 2.8377184817739813, 44.65563247433503, 25.012499240502024, 1.7306568746515718, 13.454745586528475, 30.777001171442752, 25.94801687305094, 14.300474148494132, -7.922080508074011, -23.37814532476718, 44.33851720832028, 17.999079363871868, 29.253967027299034, -16.98813935534386, 31.406160349167102, 19.410089827612886, 44.16432429486419, 20.038214028361217, 21.880242136063263, 27.754468644467515, 11.064647428540361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30198951973262955, "mean_inference_ms": 1.013587611317683, "mean_action_processing_ms": 0.13288119981007004, "mean_env_wait_ms": 0.21897557316435864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003254413604736328, "StateBufferConnector_ms": 0.0023120641708374023, "ViewRequirementAgentConnector_ms": 0.052440524101257324}, "num_episodes": 20, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 753.9821966858377, "num_env_steps_trained_throughput_per_sec": 753.9821966858377, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 5236.57, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5236.537, "sample_time_ms": 798.91, "learn_time_ms": 4427.39, "learn_throughput": 903.467, "synch_weights_time_ms": 9.911}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "training_iteration": 71, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-40", "timestamp": 1723386160, "time_this_iter_s": 5.307929039001465, "time_total_s": 363.196781873703, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.196781873703, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 31.425000000000004, "ram_util_percent": 82.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3481064833079777, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.585471144815286, "policy_loss": -0.003557521056791302, "vf_loss": 6.588370780150096, "vf_explained_var": -0.13472061982999245, "kl": 0.00730119080416826, "entropy": 0.9915712578222156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.276227243275692, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.678139779965083, "policy_loss": -0.002421035338678242, "vf_loss": 6.6805338303248085, "vf_explained_var": -0.09925937547037998, "kl": 0.006068603440287683, "entropy": 0.9128550384193659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 251.71, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 25171, "policy_reward_min": {"prey_policy": -53.74864182668459, "predator_policy": -38.7376716140905}, "policy_reward_max": {"prey_policy": 38.7376716140905, "predator_policy": 53.74864182668459}, "policy_reward_mean": {"prey_policy": -8.903607721287111, "predator_policy": 8.903607721287111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [59, 400, 180, 400, 400, 147, 141, 97, 400, 400, 400, 88, 400, 400, 67, 400, 400, 400, 173, 83, 400, 400, 400, 400, 107, 146, 400, 400, 125, 400, 400, 88, 400, 99, 400, 118, 400, 152, 136, 400, 194, 182, 400, 400, 329, 400, 400, 400, 153, 188, 400, 285, 236, 46, 188, 400, 61, 4, 127, 156, 148, 400, 211, 400, 216, 16, 210, 130, 22, 136, 91, 67, 87, 400, 400, 137, 135, 153, 400, 122, 357, 243, 133, 354, 175, 280, 116, 400, 400, 116, 125, 114, 245, 111, 281, 400, 400, 400, 388, 97], "policy_prey_policy_reward": [-5.38506096336818, 38.129435597246136, -40.017320840568374, 19.59413620127142, 20.78602859513511, -17.692579888198264, -53.74864182668459, -19.985242649595016, 28.003694438622276, 19.61271906698589, 30.643667263799294, -30.2649707221708, 11.315828382809016, 8.970074853911605, -26.709786333953982, 23.312341008595116, 20.052204836186835, 17.96992607366772, -36.60744788159116, -29.73559330553684, 19.43161407081613, -2.240982891504835, 28.286028372806257, 9.029596307649193, -40.23086711230746, -34.87444274878143, 19.07458154725352, 13.650816663207223, -7.326653629299102, 35.66896217986718, 18.44367955566532, -40.7165579006479, 7.505681248545837, -35.56518446258236, 34.31810324530612, -38.37279195442295, 38.7376716140905, -21.174880518214895, -21.46396880694534, 32.20971039564132, -21.9389301016435, -21.136288385596167, 22.88583374786505, 11.158328381361834, -25.05917859451231, 21.721345481112657, 25.95549231975804, 20.35019379822145, -24.534241211281604, -11.730113417878442, 9.063643171656231, -33.59053240294476, -8.082123570736735, -3.541863062446916, -37.7853204498731, 10.579409452500784, -12.101508207409204, -1.9473712654056528, -29.28218539914868, -35.04484543072271, -13.07093678087405, 0.957256413839012, -25.16819368114915, 19.564308910295534, -35.95602359855306, -2.8377184817739813, -44.65563247433503, -25.012499240502024, -1.7306568746515718, -13.454745586528475, -30.777001171442752, -25.94801687305094, -14.300474148494132, 7.922080508074011, 23.37814532476718, -44.33851720832028, -17.999079363871868, -29.253967027299034, 16.98813935534386, -31.406160349167102, -19.410089827612886, -44.16432429486419, -20.038214028361217, -21.880242136063263, -27.754468644467515, -11.064647428540361, -28.427213686519313, -11.2354612554117, -23.70794076527219, -27.440360720121753, -15.894037840543337, -35.08281855360691, -45.34432677311104, -35.88726934092659, -35.797782724489224, 2.9270479032262635, -0.31646089153702306, 9.611779841379395, -31.743772107113465, -29.18374844264275], "policy_predator_policy_reward": [5.38506096336818, -38.129435597246136, 40.017320840568374, -19.59413620127142, -20.78602859513511, 17.692579888198264, 53.74864182668459, 19.985242649595016, -28.003694438622276, -19.61271906698589, -30.643667263799294, 30.2649707221708, -11.315828382809016, -8.970074853911605, 26.709786333953982, -23.312341008595116, -20.052204836186835, -17.96992607366772, 36.60744788159116, 29.73559330553684, -19.43161407081613, 2.240982891504835, -28.286028372806257, -9.029596307649193, 40.23086711230746, 34.87444274878143, -19.07458154725352, -13.650816663207223, 7.326653629299102, -35.66896217986718, -18.44367955566532, 40.7165579006479, -7.505681248545837, 35.56518446258236, -34.31810324530612, 38.37279195442295, -38.7376716140905, 21.174880518214895, 21.46396880694534, -32.20971039564132, 21.9389301016435, 21.136288385596167, -22.88583374786505, -11.158328381361834, 25.05917859451231, -21.721345481112657, -25.95549231975804, -20.35019379822145, 24.534241211281604, 11.730113417878442, -9.063643171656231, 33.59053240294476, 8.082123570736735, 3.541863062446916, 37.7853204498731, -10.579409452500784, 12.101508207409204, 1.9473712654056528, 29.28218539914868, 35.04484543072271, 13.07093678087405, -0.957256413839012, 25.16819368114915, -19.564308910295534, 35.95602359855306, 2.8377184817739813, 44.65563247433503, 25.012499240502024, 1.7306568746515718, 13.454745586528475, 30.777001171442752, 25.94801687305094, 14.300474148494132, -7.922080508074011, -23.37814532476718, 44.33851720832028, 17.999079363871868, 29.253967027299034, -16.98813935534386, 31.406160349167102, 19.410089827612886, 44.16432429486419, 20.038214028361217, 21.880242136063263, 27.754468644467515, 11.064647428540361, 28.427213686519313, 11.2354612554117, 23.70794076527219, 27.440360720121753, 15.894037840543337, 35.08281855360691, 45.34432677311104, 35.88726934092659, 35.797782724489224, -2.9270479032262635, 0.31646089153702306, -9.611779841379395, 31.743772107113465, 29.18374844264275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3018650285236819, "mean_inference_ms": 1.0124807219979586, "mean_action_processing_ms": 0.1327665244556922, "mean_env_wait_ms": 0.21895728451703736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003211498260498047, "StateBufferConnector_ms": 0.0022906064987182617, "ViewRequirementAgentConnector_ms": 0.05115461349487305}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 725.0321013910005, "num_env_steps_trained_throughput_per_sec": 725.0321013910005, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 5245.742, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5245.71, "sample_time_ms": 764.035, "learn_time_ms": 4471.45, "learn_throughput": 894.564, "synch_weights_time_ms": 9.906}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 72, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-46", "timestamp": 1723386166, "time_this_iter_s": 5.519794940948486, "time_total_s": 368.7165768146515, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.7165768146515, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 37.142857142857146, "ram_util_percent": 83.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1155787360854448, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.420639255642891, "policy_loss": -0.002210343209299026, "vf_loss": 7.422390769422054, "vf_explained_var": -0.01661137379705906, "kl": 0.00509234095154198, "entropy": 0.9474496962502599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.950235076310734, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.411337320506573, "policy_loss": -0.0015904550600680523, "vf_loss": 7.412908127407233, "vf_explained_var": 0.007469580757121245, "kl": 0.004420806675975492, "entropy": 0.8942255991821487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 253.02, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 25302, "policy_reward_min": {"prey_policy": -45.34432677311104, "predator_policy": -38.7376716140905}, "policy_reward_max": {"prey_policy": 38.7376716140905, "predator_policy": 45.34432677311104}, "policy_reward_mean": {"prey_policy": -11.298235824767616, "predator_policy": 11.298235824767616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 173, 83, 400, 400, 400, 400, 107, 146, 400, 400, 125, 400, 400, 88, 400, 99, 400, 118, 400, 152, 136, 400, 194, 182, 400, 400, 329, 400, 400, 400, 153, 188, 400, 285, 236, 46, 188, 400, 61, 4, 127, 156, 148, 400, 211, 400, 216, 16, 210, 130, 22, 136, 91, 67, 87, 400, 400, 137, 135, 153, 400, 122, 357, 243, 133, 354, 175, 280, 116, 400, 400, 116, 125, 114, 245, 111, 281, 400, 400, 400, 388, 97, 331, 400, 400, 400, 400, 400, 130, 400, 172, 400, 186, 62, 143, 140, 146], "policy_prey_policy_reward": [23.312341008595116, 20.052204836186835, 17.96992607366772, -36.60744788159116, -29.73559330553684, 19.43161407081613, -2.240982891504835, 28.286028372806257, 9.029596307649193, -40.23086711230746, -34.87444274878143, 19.07458154725352, 13.650816663207223, -7.326653629299102, 35.66896217986718, 18.44367955566532, -40.7165579006479, 7.505681248545837, -35.56518446258236, 34.31810324530612, -38.37279195442295, 38.7376716140905, -21.174880518214895, -21.46396880694534, 32.20971039564132, -21.9389301016435, -21.136288385596167, 22.88583374786505, 11.158328381361834, -25.05917859451231, 21.721345481112657, 25.95549231975804, 20.35019379822145, -24.534241211281604, -11.730113417878442, 9.063643171656231, -33.59053240294476, -8.082123570736735, -3.541863062446916, -37.7853204498731, 10.579409452500784, -12.101508207409204, -1.9473712654056528, -29.28218539914868, -35.04484543072271, -13.07093678087405, 0.957256413839012, -25.16819368114915, 19.564308910295534, -35.95602359855306, -2.8377184817739813, -44.65563247433503, -25.012499240502024, -1.7306568746515718, -13.454745586528475, -30.777001171442752, -25.94801687305094, -14.300474148494132, 7.922080508074011, 23.37814532476718, -44.33851720832028, -17.999079363871868, -29.253967027299034, 16.98813935534386, -31.406160349167102, -19.410089827612886, -44.16432429486419, -20.038214028361217, -21.880242136063263, -27.754468644467515, -11.064647428540361, -28.427213686519313, -11.2354612554117, -23.70794076527219, -27.440360720121753, -15.894037840543337, -35.08281855360691, -45.34432677311104, -35.88726934092659, -35.797782724489224, 2.9270479032262635, -0.31646089153702306, 9.611779841379395, -31.743772107113465, -29.18374844264275, -35.25814437968285, 3.854627626056221, -22.2865418559034, 28.090651408148783, -25.39091429137539, -17.887812946680846, -30.837692918519142, 11.229153905950028, -38.52836523448191, -20.001346468489153, -43.670727378417766, -2.13833252950276, -14.196598282360418, -28.034311234450797, -21.154474593099582], "policy_predator_policy_reward": [-23.312341008595116, -20.052204836186835, -17.96992607366772, 36.60744788159116, 29.73559330553684, -19.43161407081613, 2.240982891504835, -28.286028372806257, -9.029596307649193, 40.23086711230746, 34.87444274878143, -19.07458154725352, -13.650816663207223, 7.326653629299102, -35.66896217986718, -18.44367955566532, 40.7165579006479, -7.505681248545837, 35.56518446258236, -34.31810324530612, 38.37279195442295, -38.7376716140905, 21.174880518214895, 21.46396880694534, -32.20971039564132, 21.9389301016435, 21.136288385596167, -22.88583374786505, -11.158328381361834, 25.05917859451231, -21.721345481112657, -25.95549231975804, -20.35019379822145, 24.534241211281604, 11.730113417878442, -9.063643171656231, 33.59053240294476, 8.082123570736735, 3.541863062446916, 37.7853204498731, -10.579409452500784, 12.101508207409204, 1.9473712654056528, 29.28218539914868, 35.04484543072271, 13.07093678087405, -0.957256413839012, 25.16819368114915, -19.564308910295534, 35.95602359855306, 2.8377184817739813, 44.65563247433503, 25.012499240502024, 1.7306568746515718, 13.454745586528475, 30.777001171442752, 25.94801687305094, 14.300474148494132, -7.922080508074011, -23.37814532476718, 44.33851720832028, 17.999079363871868, 29.253967027299034, -16.98813935534386, 31.406160349167102, 19.410089827612886, 44.16432429486419, 20.038214028361217, 21.880242136063263, 27.754468644467515, 11.064647428540361, 28.427213686519313, 11.2354612554117, 23.70794076527219, 27.440360720121753, 15.894037840543337, 35.08281855360691, 45.34432677311104, 35.88726934092659, 35.797782724489224, -2.9270479032262635, 0.31646089153702306, -9.611779841379395, 31.743772107113465, 29.18374844264275, 35.25814437968285, -3.854627626056221, 22.2865418559034, -28.090651408148783, 25.39091429137539, 17.887812946680846, 30.837692918519142, -11.229153905950028, 38.52836523448191, 20.001346468489153, 43.670727378417766, 2.13833252950276, 14.196598282360418, 28.034311234450797, 21.154474593099582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3015308462490849, "mean_inference_ms": 1.011873281061964, "mean_action_processing_ms": 0.13259622925059442, "mean_env_wait_ms": 0.21899809753134733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033358335494995117, "StateBufferConnector_ms": 0.0023131370544433594, "ViewRequirementAgentConnector_ms": 0.0529475212097168}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 748.6652091898152, "num_env_steps_trained_throughput_per_sec": 748.6652091898152, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 5270.477, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5270.444, "sample_time_ms": 778.905, "learn_time_ms": 4481.227, "learn_throughput": 892.613, "synch_weights_time_ms": 9.991}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "training_iteration": 73, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-51", "timestamp": 1723386171, "time_this_iter_s": 5.347040176391602, "time_total_s": 374.0636169910431, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 374.0636169910431, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 31.9, "ram_util_percent": 83.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.62392948117728, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.438274443646272, "policy_loss": -0.005587241887891044, "vf_loss": 6.443258725106716, "vf_explained_var": 0.0519881056000789, "kl": 0.006692205621804703, "entropy": 0.9670012030750513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5371088419420023, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.407997463146845, "policy_loss": -0.004232286450860556, "vf_loss": 6.412214089930058, "vf_explained_var": 0.058266732034583886, "kl": 0.007037054066429555, "entropy": 0.9192417720332742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 239.01, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 23901, "policy_reward_min": {"prey_policy": -50.59404800138334, "predator_policy": -38.7376716140905}, "policy_reward_max": {"prey_policy": 38.7376716140905, "predator_policy": 50.59404800138334}, "policy_reward_mean": {"prey_policy": -15.87368630269579, "predator_policy": 15.87368630269579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [99, 400, 118, 400, 152, 136, 400, 194, 182, 400, 400, 329, 400, 400, 400, 153, 188, 400, 285, 236, 46, 188, 400, 61, 4, 127, 156, 148, 400, 211, 400, 216, 16, 210, 130, 22, 136, 91, 67, 87, 400, 400, 137, 135, 153, 400, 122, 357, 243, 133, 354, 175, 280, 116, 400, 400, 116, 125, 114, 245, 111, 281, 400, 400, 400, 388, 97, 331, 400, 400, 400, 400, 400, 130, 400, 172, 400, 186, 62, 143, 140, 146, 135, 153, 76, 199, 400, 383, 153, 48, 400, 400, 148, 220, 103, 278, 219, 167, 239, 400], "policy_prey_policy_reward": [-35.56518446258236, 34.31810324530612, -38.37279195442295, 38.7376716140905, -21.174880518214895, -21.46396880694534, 32.20971039564132, -21.9389301016435, -21.136288385596167, 22.88583374786505, 11.158328381361834, -25.05917859451231, 21.721345481112657, 25.95549231975804, 20.35019379822145, -24.534241211281604, -11.730113417878442, 9.063643171656231, -33.59053240294476, -8.082123570736735, -3.541863062446916, -37.7853204498731, 10.579409452500784, -12.101508207409204, -1.9473712654056528, -29.28218539914868, -35.04484543072271, -13.07093678087405, 0.957256413839012, -25.16819368114915, 19.564308910295534, -35.95602359855306, -2.8377184817739813, -44.65563247433503, -25.012499240502024, -1.7306568746515718, -13.454745586528475, -30.777001171442752, -25.94801687305094, -14.300474148494132, 7.922080508074011, 23.37814532476718, -44.33851720832028, -17.999079363871868, -29.253967027299034, 16.98813935534386, -31.406160349167102, -19.410089827612886, -44.16432429486419, -20.038214028361217, -21.880242136063263, -27.754468644467515, -11.064647428540361, -28.427213686519313, -11.2354612554117, -23.70794076527219, -27.440360720121753, -15.894037840543337, -35.08281855360691, -45.34432677311104, -35.88726934092659, -35.797782724489224, 2.9270479032262635, -0.31646089153702306, 9.611779841379395, -31.743772107113465, -29.18374844264275, -35.25814437968285, 3.854627626056221, -22.2865418559034, 28.090651408148783, -25.39091429137539, -17.887812946680846, -30.837692918519142, 11.229153905950028, -38.52836523448191, -20.001346468489153, -43.670727378417766, -2.13833252950276, -14.196598282360418, -28.034311234450797, -21.154474593099582, -14.571901750085331, -29.462874941038557, -25.60390515822801, -25.80691424973866, -35.60800682761573, -39.822867994436145, -29.33267047368226, -6.517088488029509, -2.9641019083940847, -10.817465562557828, -25.55182524394395, -6.893760330846501, -31.790947815662122, -31.64735788931646, -18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126], "policy_predator_policy_reward": [35.56518446258236, -34.31810324530612, 38.37279195442295, -38.7376716140905, 21.174880518214895, 21.46396880694534, -32.20971039564132, 21.9389301016435, 21.136288385596167, -22.88583374786505, -11.158328381361834, 25.05917859451231, -21.721345481112657, -25.95549231975804, -20.35019379822145, 24.534241211281604, 11.730113417878442, -9.063643171656231, 33.59053240294476, 8.082123570736735, 3.541863062446916, 37.7853204498731, -10.579409452500784, 12.101508207409204, 1.9473712654056528, 29.28218539914868, 35.04484543072271, 13.07093678087405, -0.957256413839012, 25.16819368114915, -19.564308910295534, 35.95602359855306, 2.8377184817739813, 44.65563247433503, 25.012499240502024, 1.7306568746515718, 13.454745586528475, 30.777001171442752, 25.94801687305094, 14.300474148494132, -7.922080508074011, -23.37814532476718, 44.33851720832028, 17.999079363871868, 29.253967027299034, -16.98813935534386, 31.406160349167102, 19.410089827612886, 44.16432429486419, 20.038214028361217, 21.880242136063263, 27.754468644467515, 11.064647428540361, 28.427213686519313, 11.2354612554117, 23.70794076527219, 27.440360720121753, 15.894037840543337, 35.08281855360691, 45.34432677311104, 35.88726934092659, 35.797782724489224, -2.9270479032262635, 0.31646089153702306, -9.611779841379395, 31.743772107113465, 29.18374844264275, 35.25814437968285, -3.854627626056221, 22.2865418559034, -28.090651408148783, 25.39091429137539, 17.887812946680846, 30.837692918519142, -11.229153905950028, 38.52836523448191, 20.001346468489153, 43.670727378417766, 2.13833252950276, 14.196598282360418, 28.034311234450797, 21.154474593099582, 14.571901750085331, 29.462874941038557, 25.60390515822801, 25.80691424973866, 35.60800682761573, 39.822867994436145, 29.33267047368226, 6.517088488029509, 2.9641019083940847, 10.817465562557828, 25.55182524394395, 6.893760330846501, 31.790947815662122, 31.64735788931646, 18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30149915012822825, "mean_inference_ms": 1.0115960242486672, "mean_action_processing_ms": 0.13247445392028143, "mean_env_wait_ms": 0.22035752174002848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003390192985534668, "StateBufferConnector_ms": 0.00211942195892334, "ViewRequirementAgentConnector_ms": 0.05198705196380615}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.4483357212648, "num_env_steps_trained_throughput_per_sec": 711.4483357212648, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 5323.766, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5323.731, "sample_time_ms": 815.282, "learn_time_ms": 4498.028, "learn_throughput": 889.279, "synch_weights_time_ms": 10.083}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 74, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-22-57", "timestamp": 1723386177, "time_this_iter_s": 5.6469340324401855, "time_total_s": 379.7105510234833, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 379.7105510234833, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 35.387499999999996, "ram_util_percent": 82.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.04715140859286, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.318202452361584, "policy_loss": -0.005510573196806945, "vf_loss": 4.322929314275583, "vf_explained_var": 0.31973492335528136, "kl": 0.008698100446521275, "entropy": 0.9103421642134587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9925973493916294, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.435219490528107, "policy_loss": -0.003972912237319785, "vf_loss": 4.439163996279239, "vf_explained_var": 0.30791509089370567, "kl": 0.012766551196197684, "entropy": 0.8323274781927467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 231.91, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 23191, "policy_reward_min": {"prey_policy": -50.59404800138334, "predator_policy": -28.090651408148783}, "policy_reward_max": {"prey_policy": 28.090651408148783, "predator_policy": 50.59404800138334}, "policy_reward_mean": {"prey_policy": -19.083326090697128, "predator_policy": 19.083326090697128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [153, 188, 400, 285, 236, 46, 188, 400, 61, 4, 127, 156, 148, 400, 211, 400, 216, 16, 210, 130, 22, 136, 91, 67, 87, 400, 400, 137, 135, 153, 400, 122, 357, 243, 133, 354, 175, 280, 116, 400, 400, 116, 125, 114, 245, 111, 281, 400, 400, 400, 388, 97, 331, 400, 400, 400, 400, 400, 130, 400, 172, 400, 186, 62, 143, 140, 146, 135, 153, 76, 199, 400, 383, 153, 48, 400, 400, 148, 220, 103, 278, 219, 167, 239, 400, 22, 400, 400, 400, 109, 85, 400, 400, 400, 133, 175, 400, 271, 51, 54], "policy_prey_policy_reward": [-24.534241211281604, -11.730113417878442, 9.063643171656231, -33.59053240294476, -8.082123570736735, -3.541863062446916, -37.7853204498731, 10.579409452500784, -12.101508207409204, -1.9473712654056528, -29.28218539914868, -35.04484543072271, -13.07093678087405, 0.957256413839012, -25.16819368114915, 19.564308910295534, -35.95602359855306, -2.8377184817739813, -44.65563247433503, -25.012499240502024, -1.7306568746515718, -13.454745586528475, -30.777001171442752, -25.94801687305094, -14.300474148494132, 7.922080508074011, 23.37814532476718, -44.33851720832028, -17.999079363871868, -29.253967027299034, 16.98813935534386, -31.406160349167102, -19.410089827612886, -44.16432429486419, -20.038214028361217, -21.880242136063263, -27.754468644467515, -11.064647428540361, -28.427213686519313, -11.2354612554117, -23.70794076527219, -27.440360720121753, -15.894037840543337, -35.08281855360691, -45.34432677311104, -35.88726934092659, -35.797782724489224, 2.9270479032262635, -0.31646089153702306, 9.611779841379395, -31.743772107113465, -29.18374844264275, -35.25814437968285, 3.854627626056221, -22.2865418559034, 28.090651408148783, -25.39091429137539, -17.887812946680846, -30.837692918519142, 11.229153905950028, -38.52836523448191, -20.001346468489153, -43.670727378417766, -2.13833252950276, -14.196598282360418, -28.034311234450797, -21.154474593099582, -14.571901750085331, -29.462874941038557, -25.60390515822801, -25.80691424973866, -35.60800682761573, -39.822867994436145, -29.33267047368226, -6.517088488029509, -2.9641019083940847, -10.817465562557828, -25.55182524394395, -6.893760330846501, -31.790947815662122, -31.64735788931646, -18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126, -7.618653675320859, -3.169737410534445, -32.793365493867924, -34.215098742562574, -15.129882977654516, -35.38445353336096, -32.10956271505144, -28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235], "policy_predator_policy_reward": [24.534241211281604, 11.730113417878442, -9.063643171656231, 33.59053240294476, 8.082123570736735, 3.541863062446916, 37.7853204498731, -10.579409452500784, 12.101508207409204, 1.9473712654056528, 29.28218539914868, 35.04484543072271, 13.07093678087405, -0.957256413839012, 25.16819368114915, -19.564308910295534, 35.95602359855306, 2.8377184817739813, 44.65563247433503, 25.012499240502024, 1.7306568746515718, 13.454745586528475, 30.777001171442752, 25.94801687305094, 14.300474148494132, -7.922080508074011, -23.37814532476718, 44.33851720832028, 17.999079363871868, 29.253967027299034, -16.98813935534386, 31.406160349167102, 19.410089827612886, 44.16432429486419, 20.038214028361217, 21.880242136063263, 27.754468644467515, 11.064647428540361, 28.427213686519313, 11.2354612554117, 23.70794076527219, 27.440360720121753, 15.894037840543337, 35.08281855360691, 45.34432677311104, 35.88726934092659, 35.797782724489224, -2.9270479032262635, 0.31646089153702306, -9.611779841379395, 31.743772107113465, 29.18374844264275, 35.25814437968285, -3.854627626056221, 22.2865418559034, -28.090651408148783, 25.39091429137539, 17.887812946680846, 30.837692918519142, -11.229153905950028, 38.52836523448191, 20.001346468489153, 43.670727378417766, 2.13833252950276, 14.196598282360418, 28.034311234450797, 21.154474593099582, 14.571901750085331, 29.462874941038557, 25.60390515822801, 25.80691424973866, 35.60800682761573, 39.822867994436145, 29.33267047368226, 6.517088488029509, 2.9641019083940847, 10.817465562557828, 25.55182524394395, 6.893760330846501, 31.790947815662122, 31.64735788931646, 18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126, 7.618653675320859, 3.169737410534445, 32.793365493867924, 34.215098742562574, 15.129882977654516, 35.38445353336096, 32.10956271505144, 28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.301602896328161, "mean_inference_ms": 1.0116473910182935, "mean_action_processing_ms": 0.13241225845172275, "mean_env_wait_ms": 0.22194634710716415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036350488662719727, "StateBufferConnector_ms": 0.002148747444152832, "ViewRequirementAgentConnector_ms": 0.05402088165283203}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 740.5529838379051, "num_env_steps_trained_throughput_per_sec": 740.5529838379051, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 5317.725, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5317.691, "sample_time_ms": 841.367, "learn_time_ms": 4465.904, "learn_throughput": 895.675, "synch_weights_time_ms": 10.086}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 75, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-02", "timestamp": 1723386182, "time_this_iter_s": 5.4041290283203125, "time_total_s": 385.1146800518036, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 385.1146800518036, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 33.4125, "ram_util_percent": 82.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.621330472516517, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9561244028309983, "policy_loss": -0.004914483645310005, "vf_loss": 3.960516259074211, "vf_explained_var": 0.4634215202803413, "kl": 0.0058004183491682255, "entropy": 0.8990485280752182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.579978079131494, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.00250593945384, "policy_loss": -0.0058188997376419135, "vf_loss": 4.008307018131018, "vf_explained_var": 0.4534762235979239, "kl": 0.008014375774890265, "entropy": 0.8216654328629375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 246.41, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 24641, "policy_reward_min": {"prey_policy": -57.26377254944312, "predator_policy": -28.090651408148783}, "policy_reward_max": {"prey_policy": 28.090651408148783, "predator_policy": 57.26377254944312}, "policy_reward_mean": {"prey_policy": -20.563664696773966, "predator_policy": 20.563664696773966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 211, 400, 216, 16, 210, 130, 22, 136, 91, 67, 87, 400, 400, 137, 135, 153, 400, 122, 357, 243, 133, 354, 175, 280, 116, 400, 400, 116, 125, 114, 245, 111, 281, 400, 400, 400, 388, 97, 331, 400, 400, 400, 400, 400, 130, 400, 172, 400, 186, 62, 143, 140, 146, 135, 153, 76, 199, 400, 383, 153, 48, 400, 400, 148, 220, 103, 278, 219, 167, 239, 400, 22, 400, 400, 400, 109, 85, 400, 400, 400, 133, 175, 400, 271, 51, 54, 400, 381, 260, 116, 125, 400, 400, 344, 400, 208, 375, 400, 33], "policy_prey_policy_reward": [0.957256413839012, -25.16819368114915, 19.564308910295534, -35.95602359855306, -2.8377184817739813, -44.65563247433503, -25.012499240502024, -1.7306568746515718, -13.454745586528475, -30.777001171442752, -25.94801687305094, -14.300474148494132, 7.922080508074011, 23.37814532476718, -44.33851720832028, -17.999079363871868, -29.253967027299034, 16.98813935534386, -31.406160349167102, -19.410089827612886, -44.16432429486419, -20.038214028361217, -21.880242136063263, -27.754468644467515, -11.064647428540361, -28.427213686519313, -11.2354612554117, -23.70794076527219, -27.440360720121753, -15.894037840543337, -35.08281855360691, -45.34432677311104, -35.88726934092659, -35.797782724489224, 2.9270479032262635, -0.31646089153702306, 9.611779841379395, -31.743772107113465, -29.18374844264275, -35.25814437968285, 3.854627626056221, -22.2865418559034, 28.090651408148783, -25.39091429137539, -17.887812946680846, -30.837692918519142, 11.229153905950028, -38.52836523448191, -20.001346468489153, -43.670727378417766, -2.13833252950276, -14.196598282360418, -28.034311234450797, -21.154474593099582, -14.571901750085331, -29.462874941038557, -25.60390515822801, -25.80691424973866, -35.60800682761573, -39.822867994436145, -29.33267047368226, -6.517088488029509, -2.9641019083940847, -10.817465562557828, -25.55182524394395, -6.893760330846501, -31.790947815662122, -31.64735788931646, -18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126, -7.618653675320859, -3.169737410534445, -32.793365493867924, -34.215098742562574, -15.129882977654516, -35.38445353336096, -32.10956271505144, -28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235, -30.442395616775343, -57.26377254944312, -27.45738175544247, -33.98546235934697, -33.422568661660925, -24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292], "policy_predator_policy_reward": [-0.957256413839012, 25.16819368114915, -19.564308910295534, 35.95602359855306, 2.8377184817739813, 44.65563247433503, 25.012499240502024, 1.7306568746515718, 13.454745586528475, 30.777001171442752, 25.94801687305094, 14.300474148494132, -7.922080508074011, -23.37814532476718, 44.33851720832028, 17.999079363871868, 29.253967027299034, -16.98813935534386, 31.406160349167102, 19.410089827612886, 44.16432429486419, 20.038214028361217, 21.880242136063263, 27.754468644467515, 11.064647428540361, 28.427213686519313, 11.2354612554117, 23.70794076527219, 27.440360720121753, 15.894037840543337, 35.08281855360691, 45.34432677311104, 35.88726934092659, 35.797782724489224, -2.9270479032262635, 0.31646089153702306, -9.611779841379395, 31.743772107113465, 29.18374844264275, 35.25814437968285, -3.854627626056221, 22.2865418559034, -28.090651408148783, 25.39091429137539, 17.887812946680846, 30.837692918519142, -11.229153905950028, 38.52836523448191, 20.001346468489153, 43.670727378417766, 2.13833252950276, 14.196598282360418, 28.034311234450797, 21.154474593099582, 14.571901750085331, 29.462874941038557, 25.60390515822801, 25.80691424973866, 35.60800682761573, 39.822867994436145, 29.33267047368226, 6.517088488029509, 2.9641019083940847, 10.817465562557828, 25.55182524394395, 6.893760330846501, 31.790947815662122, 31.64735788931646, 18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126, 7.618653675320859, 3.169737410534445, 32.793365493867924, 34.215098742562574, 15.129882977654516, 35.38445353336096, 32.10956271505144, 28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235, 30.442395616775343, 57.26377254944312, 27.45738175544247, 33.98546235934697, 33.422568661660925, 24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30163011237021115, "mean_inference_ms": 1.0117624012282103, "mean_action_processing_ms": 0.13242260395588662, "mean_env_wait_ms": 0.22319275050255924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036247968673706055, "StateBufferConnector_ms": 0.002181410789489746, "ViewRequirementAgentConnector_ms": 0.0544050931930542}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.4829175259903, "num_env_steps_trained_throughput_per_sec": 781.4829175259903, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 5317.458, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5317.425, "sample_time_ms": 835.5, "learn_time_ms": 4471.418, "learn_throughput": 894.571, "synch_weights_time_ms": 10.166}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 76, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-07", "timestamp": 1723386187, "time_this_iter_s": 5.122221946716309, "time_total_s": 390.2369019985199, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.2369019985199, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.142857142857142, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1020336422448356, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.816505073507627, "policy_loss": -0.0042562241365279386, "vf_loss": 3.820081639289856, "vf_explained_var": 0.48801895094414555, "kl": 0.007543156949625203, "entropy": 0.9136645363022884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.979763510574897, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.845298885802428, "policy_loss": -0.0024930270231076673, "vf_loss": 3.84777948881189, "vf_explained_var": 0.4804712460686763, "kl": 0.00558041526152427, "entropy": 0.7180130381137133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 263.87, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 26387, "policy_reward_min": {"prey_policy": -57.26377254944312, "predator_policy": -28.090651408148783}, "policy_reward_max": {"prey_policy": 28.090651408148783, "predator_policy": 57.26377254944312}, "policy_reward_mean": {"prey_policy": -21.149472150200737, "predator_policy": 21.149472150200737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 122, 357, 243, 133, 354, 175, 280, 116, 400, 400, 116, 125, 114, 245, 111, 281, 400, 400, 400, 388, 97, 331, 400, 400, 400, 400, 400, 130, 400, 172, 400, 186, 62, 143, 140, 146, 135, 153, 76, 199, 400, 383, 153, 48, 400, 400, 148, 220, 103, 278, 219, 167, 239, 400, 22, 400, 400, 400, 109, 85, 400, 400, 400, 133, 175, 400, 271, 51, 54, 400, 381, 260, 116, 125, 400, 400, 344, 400, 208, 375, 400, 33, 173, 320, 145, 282, 88, 267, 373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250], "policy_prey_policy_reward": [16.98813935534386, -31.406160349167102, -19.410089827612886, -44.16432429486419, -20.038214028361217, -21.880242136063263, -27.754468644467515, -11.064647428540361, -28.427213686519313, -11.2354612554117, -23.70794076527219, -27.440360720121753, -15.894037840543337, -35.08281855360691, -45.34432677311104, -35.88726934092659, -35.797782724489224, 2.9270479032262635, -0.31646089153702306, 9.611779841379395, -31.743772107113465, -29.18374844264275, -35.25814437968285, 3.854627626056221, -22.2865418559034, 28.090651408148783, -25.39091429137539, -17.887812946680846, -30.837692918519142, 11.229153905950028, -38.52836523448191, -20.001346468489153, -43.670727378417766, -2.13833252950276, -14.196598282360418, -28.034311234450797, -21.154474593099582, -14.571901750085331, -29.462874941038557, -25.60390515822801, -25.80691424973866, -35.60800682761573, -39.822867994436145, -29.33267047368226, -6.517088488029509, -2.9641019083940847, -10.817465562557828, -25.55182524394395, -6.893760330846501, -31.790947815662122, -31.64735788931646, -18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126, -7.618653675320859, -3.169737410534445, -32.793365493867924, -34.215098742562574, -15.129882977654516, -35.38445353336096, -32.10956271505144, -28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235, -30.442395616775343, -57.26377254944312, -27.45738175544247, -33.98546235934697, -33.422568661660925, -24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292, -31.909715547752178, -22.187548626081497, -42.75460341607386, -18.55395411331563, -14.876689239137441, -22.550703132043914, -19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855], "policy_predator_policy_reward": [-16.98813935534386, 31.406160349167102, 19.410089827612886, 44.16432429486419, 20.038214028361217, 21.880242136063263, 27.754468644467515, 11.064647428540361, 28.427213686519313, 11.2354612554117, 23.70794076527219, 27.440360720121753, 15.894037840543337, 35.08281855360691, 45.34432677311104, 35.88726934092659, 35.797782724489224, -2.9270479032262635, 0.31646089153702306, -9.611779841379395, 31.743772107113465, 29.18374844264275, 35.25814437968285, -3.854627626056221, 22.2865418559034, -28.090651408148783, 25.39091429137539, 17.887812946680846, 30.837692918519142, -11.229153905950028, 38.52836523448191, 20.001346468489153, 43.670727378417766, 2.13833252950276, 14.196598282360418, 28.034311234450797, 21.154474593099582, 14.571901750085331, 29.462874941038557, 25.60390515822801, 25.80691424973866, 35.60800682761573, 39.822867994436145, 29.33267047368226, 6.517088488029509, 2.9641019083940847, 10.817465562557828, 25.55182524394395, 6.893760330846501, 31.790947815662122, 31.64735788931646, 18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126, 7.618653675320859, 3.169737410534445, 32.793365493867924, 34.215098742562574, 15.129882977654516, 35.38445353336096, 32.10956271505144, 28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235, 30.442395616775343, 57.26377254944312, 27.45738175544247, 33.98546235934697, 33.422568661660925, 24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292, 31.909715547752178, 22.187548626081497, 42.75460341607386, 18.55395411331563, 14.876689239137441, 22.550703132043914, 19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3020568387048875, "mean_inference_ms": 1.0124683948418536, "mean_action_processing_ms": 0.13244589773230062, "mean_env_wait_ms": 0.22506567400962535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710031509399414, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.05797851085662842}, "num_episodes": 17, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 720.8768348135244, "num_env_steps_trained_throughput_per_sec": 720.8768348135244, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 5343.435, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5343.401, "sample_time_ms": 868.384, "learn_time_ms": 4464.48, "learn_throughput": 895.961, "synch_weights_time_ms": 10.193}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "training_iteration": 77, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-13", "timestamp": 1723386193, "time_this_iter_s": 5.5519349575042725, "time_total_s": 395.78883695602417, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 395.78883695602417, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 35.3375, "ram_util_percent": 83.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.020513158105314, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7215634269018967, "policy_loss": -0.0008534374370356091, "vf_loss": 3.7220151143769424, "vf_explained_var": 0.5783859472100933, "kl": 0.0044590226849199385, "entropy": 0.9121290317426125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.920785835633675, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7277830893794697, "policy_loss": -0.0058609066003555196, "vf_loss": 3.7336280673742293, "vf_explained_var": 0.5682352771982551, "kl": 0.0071525382300950515, "entropy": 0.7143201809376478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 266.47, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 26647, "policy_reward_min": {"prey_policy": -57.26377254944312, "predator_policy": -28.090651408148783}, "policy_reward_max": {"prey_policy": 28.090651408148783, "predator_policy": 57.26377254944312}, "policy_reward_mean": {"prey_policy": -20.445076541566547, "predator_policy": 20.445076541566547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [245, 111, 281, 400, 400, 400, 388, 97, 331, 400, 400, 400, 400, 400, 130, 400, 172, 400, 186, 62, 143, 140, 146, 135, 153, 76, 199, 400, 383, 153, 48, 400, 400, 148, 220, 103, 278, 219, 167, 239, 400, 22, 400, 400, 400, 109, 85, 400, 400, 400, 133, 175, 400, 271, 51, 54, 400, 381, 260, 116, 125, 400, 400, 344, 400, 208, 375, 400, 33, 173, 320, 145, 282, 88, 267, 373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250, 249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15], "policy_prey_policy_reward": [-45.34432677311104, -35.88726934092659, -35.797782724489224, 2.9270479032262635, -0.31646089153702306, 9.611779841379395, -31.743772107113465, -29.18374844264275, -35.25814437968285, 3.854627626056221, -22.2865418559034, 28.090651408148783, -25.39091429137539, -17.887812946680846, -30.837692918519142, 11.229153905950028, -38.52836523448191, -20.001346468489153, -43.670727378417766, -2.13833252950276, -14.196598282360418, -28.034311234450797, -21.154474593099582, -14.571901750085331, -29.462874941038557, -25.60390515822801, -25.80691424973866, -35.60800682761573, -39.822867994436145, -29.33267047368226, -6.517088488029509, -2.9641019083940847, -10.817465562557828, -25.55182524394395, -6.893760330846501, -31.790947815662122, -31.64735788931646, -18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126, -7.618653675320859, -3.169737410534445, -32.793365493867924, -34.215098742562574, -15.129882977654516, -35.38445353336096, -32.10956271505144, -28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235, -30.442395616775343, -57.26377254944312, -27.45738175544247, -33.98546235934697, -33.422568661660925, -24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292, -31.909715547752178, -22.187548626081497, -42.75460341607386, -18.55395411331563, -14.876689239137441, -22.550703132043914, -19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855, -26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951], "policy_predator_policy_reward": [45.34432677311104, 35.88726934092659, 35.797782724489224, -2.9270479032262635, 0.31646089153702306, -9.611779841379395, 31.743772107113465, 29.18374844264275, 35.25814437968285, -3.854627626056221, 22.2865418559034, -28.090651408148783, 25.39091429137539, 17.887812946680846, 30.837692918519142, -11.229153905950028, 38.52836523448191, 20.001346468489153, 43.670727378417766, 2.13833252950276, 14.196598282360418, 28.034311234450797, 21.154474593099582, 14.571901750085331, 29.462874941038557, 25.60390515822801, 25.80691424973866, 35.60800682761573, 39.822867994436145, 29.33267047368226, 6.517088488029509, 2.9641019083940847, 10.817465562557828, 25.55182524394395, 6.893760330846501, 31.790947815662122, 31.64735788931646, 18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126, 7.618653675320859, 3.169737410534445, 32.793365493867924, 34.215098742562574, 15.129882977654516, 35.38445353336096, 32.10956271505144, 28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235, 30.442395616775343, 57.26377254944312, 27.45738175544247, 33.98546235934697, 33.422568661660925, 24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292, 31.909715547752178, 22.187548626081497, 42.75460341607386, 18.55395411331563, 14.876689239137441, 22.550703132043914, 19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855, 26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3023888210982047, "mean_inference_ms": 1.0136448296685914, "mean_action_processing_ms": 0.1324837967430729, "mean_env_wait_ms": 0.2265833688489027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035011768341064453, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.05775332450866699}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.1710300227477, "num_env_steps_trained_throughput_per_sec": 774.1710300227477, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 5356.58, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5356.546, "sample_time_ms": 870.715, "learn_time_ms": 4475.279, "learn_throughput": 893.799, "synch_weights_time_ms": 10.208}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 78, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-18", "timestamp": 1723386198, "time_this_iter_s": 5.169605016708374, "time_total_s": 400.95844197273254, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 400.95844197273254, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.128571428571426, "ram_util_percent": 82.87142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.991167401770751, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.878808526446422, "policy_loss": -0.0027664367965674805, "vf_loss": 3.881299384931723, "vf_explained_var": 0.41395752200235925, "kl": 0.006116771570311149, "entropy": 0.8877352838094036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9270095550144712, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8847571992625793, "policy_loss": -0.004656816852608851, "vf_loss": 3.889397592097521, "vf_explained_var": 0.40744470873226724, "kl": 0.007376206388401338, "entropy": 0.6443703471993406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 266.58, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 26658, "policy_reward_min": {"prey_policy": -57.26377254944312, "predator_policy": -13.918787110527827}, "policy_reward_max": {"prey_policy": 13.918787110527827, "predator_policy": 57.26377254944312}, "policy_reward_mean": {"prey_policy": -20.371200779046692, "predator_policy": 20.371200779046692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 130, 400, 172, 400, 186, 62, 143, 140, 146, 135, 153, 76, 199, 400, 383, 153, 48, 400, 400, 148, 220, 103, 278, 219, 167, 239, 400, 22, 400, 400, 400, 109, 85, 400, 400, 400, 133, 175, 400, 271, 51, 54, 400, 381, 260, 116, 125, 400, 400, 344, 400, 208, 375, 400, 33, 173, 320, 145, 282, 88, 267, 373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250, 249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217], "policy_prey_policy_reward": [-17.887812946680846, -30.837692918519142, 11.229153905950028, -38.52836523448191, -20.001346468489153, -43.670727378417766, -2.13833252950276, -14.196598282360418, -28.034311234450797, -21.154474593099582, -14.571901750085331, -29.462874941038557, -25.60390515822801, -25.80691424973866, -35.60800682761573, -39.822867994436145, -29.33267047368226, -6.517088488029509, -2.9641019083940847, -10.817465562557828, -25.55182524394395, -6.893760330846501, -31.790947815662122, -31.64735788931646, -18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126, -7.618653675320859, -3.169737410534445, -32.793365493867924, -34.215098742562574, -15.129882977654516, -35.38445353336096, -32.10956271505144, -28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235, -30.442395616775343, -57.26377254944312, -27.45738175544247, -33.98546235934697, -33.422568661660925, -24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292, -31.909715547752178, -22.187548626081497, -42.75460341607386, -18.55395411331563, -14.876689239137441, -22.550703132043914, -19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855, -26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547], "policy_predator_policy_reward": [17.887812946680846, 30.837692918519142, -11.229153905950028, 38.52836523448191, 20.001346468489153, 43.670727378417766, 2.13833252950276, 14.196598282360418, 28.034311234450797, 21.154474593099582, 14.571901750085331, 29.462874941038557, 25.60390515822801, 25.80691424973866, 35.60800682761573, 39.822867994436145, 29.33267047368226, 6.517088488029509, 2.9641019083940847, 10.817465562557828, 25.55182524394395, 6.893760330846501, 31.790947815662122, 31.64735788931646, 18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126, 7.618653675320859, 3.169737410534445, 32.793365493867924, 34.215098742562574, 15.129882977654516, 35.38445353336096, 32.10956271505144, 28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235, 30.442395616775343, 57.26377254944312, 27.45738175544247, 33.98546235934697, 33.422568661660925, 24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292, 31.909715547752178, 22.187548626081497, 42.75460341607386, 18.55395411331563, 14.876689239137441, 22.550703132043914, 19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855, 26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3026688790408116, "mean_inference_ms": 1.0146262128311612, "mean_action_processing_ms": 0.13259005317881478, "mean_env_wait_ms": 0.2278367425608746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003572821617126465, "StateBufferConnector_ms": 0.0022640228271484375, "ViewRequirementAgentConnector_ms": 0.0582963228225708}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.4217787618722, "num_env_steps_trained_throughput_per_sec": 777.4217787618722, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 5337.113, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5337.079, "sample_time_ms": 876.352, "learn_time_ms": 4450.291, "learn_throughput": 898.818, "synch_weights_time_ms": 10.096}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "training_iteration": 79, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-23", "timestamp": 1723386203, "time_this_iter_s": 5.148035287857056, "time_total_s": 406.1064772605896, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22459d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 406.1064772605896, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 31.899999999999995, "ram_util_percent": 83.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8652191795408726, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.750943417598804, "policy_loss": -0.006692877924312294, "vf_loss": 4.757179697354634, "vf_explained_var": 0.14433883695552746, "kl": 0.010135256715338544, "entropy": 0.9225770991295577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7942606870085003, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.76595959191521, "policy_loss": -0.004664766314575294, "vf_loss": 4.770611633360386, "vf_explained_var": 0.14781576953828335, "kl": 0.005712792507336483, "entropy": 0.624981860195597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 279.13, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 27913, "policy_reward_min": {"prey_policy": -57.26377254944312, "predator_policy": -14.318387960283726}, "policy_reward_max": {"prey_policy": 14.318387960283726, "predator_policy": 57.26377254944312}, "policy_reward_mean": {"prey_policy": -20.45507277429951, "predator_policy": 20.45507277429951}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [76, 199, 400, 383, 153, 48, 400, 400, 148, 220, 103, 278, 219, 167, 239, 400, 22, 400, 400, 400, 109, 85, 400, 400, 400, 133, 175, 400, 271, 51, 54, 400, 381, 260, 116, 125, 400, 400, 344, 400, 208, 375, 400, 33, 173, 320, 145, 282, 88, 267, 373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250, 249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400], "policy_prey_policy_reward": [-25.60390515822801, -25.80691424973866, -35.60800682761573, -39.822867994436145, -29.33267047368226, -6.517088488029509, -2.9641019083940847, -10.817465562557828, -25.55182524394395, -6.893760330846501, -31.790947815662122, -31.64735788931646, -18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126, -7.618653675320859, -3.169737410534445, -32.793365493867924, -34.215098742562574, -15.129882977654516, -35.38445353336096, -32.10956271505144, -28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235, -30.442395616775343, -57.26377254944312, -27.45738175544247, -33.98546235934697, -33.422568661660925, -24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292, -31.909715547752178, -22.187548626081497, -42.75460341607386, -18.55395411331563, -14.876689239137441, -22.550703132043914, -19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855, -26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513], "policy_predator_policy_reward": [25.60390515822801, 25.80691424973866, 35.60800682761573, 39.822867994436145, 29.33267047368226, 6.517088488029509, 2.9641019083940847, 10.817465562557828, 25.55182524394395, 6.893760330846501, 31.790947815662122, 31.64735788931646, 18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126, 7.618653675320859, 3.169737410534445, 32.793365493867924, 34.215098742562574, 15.129882977654516, 35.38445353336096, 32.10956271505144, 28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235, 30.442395616775343, 57.26377254944312, 27.45738175544247, 33.98546235934697, 33.422568661660925, 24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292, 31.909715547752178, 22.187548626081497, 42.75460341607386, 18.55395411331563, 14.876689239137441, 22.550703132043914, 19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855, 26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3030627396759322, "mean_inference_ms": 1.0153122685171814, "mean_action_processing_ms": 0.13265447640667258, "mean_env_wait_ms": 0.22873078032353475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034710168838500977, "StateBufferConnector_ms": 0.002263307571411133, "ViewRequirementAgentConnector_ms": 0.05615639686584473}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 731.8559574912194, "num_env_steps_trained_throughput_per_sec": 731.8559574912194, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 5363.367, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5363.327, "sample_time_ms": 879.699, "learn_time_ms": 4472.405, "learn_throughput": 894.373, "synch_weights_time_ms": 10.821}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 80, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-29", "timestamp": 1723386209, "time_this_iter_s": 5.518620014190674, "time_total_s": 411.6250972747803, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.6250972747803, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 35.0, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.01668592877686, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.5244360941151776, "policy_loss": -0.008672491158601284, "vf_loss": 4.532422966261705, "vf_explained_var": 0.1694034496943156, "kl": 0.015219175002272323, "entropy": 0.8910300702477495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9357522630132733, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.574938477327426, "policy_loss": -0.003943479288379118, "vf_loss": 4.578869861612717, "vf_explained_var": 0.16812800796081623, "kl": 0.005447089118458569, "entropy": 0.5899508003145456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 285.15, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 28515, "policy_reward_min": {"prey_policy": -57.26377254944312, "predator_policy": -14.318387960283726}, "policy_reward_max": {"prey_policy": 14.318387960283726, "predator_policy": 57.26377254944312}, "policy_reward_mean": {"prey_policy": -19.246945369143678, "predator_policy": 19.246945369143678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [219, 167, 239, 400, 22, 400, 400, 400, 109, 85, 400, 400, 400, 133, 175, 400, 271, 51, 54, 400, 381, 260, 116, 125, 400, 400, 344, 400, 208, 375, 400, 33, 173, 320, 145, 282, 88, 267, 373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250, 249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400], "policy_prey_policy_reward": [-18.500073956446023, -38.02484948798028, -50.59404800138334, -13.34150131884126, -7.618653675320859, -3.169737410534445, -32.793365493867924, -34.215098742562574, -15.129882977654516, -35.38445353336096, -32.10956271505144, -28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235, -30.442395616775343, -57.26377254944312, -27.45738175544247, -33.98546235934697, -33.422568661660925, -24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292, -31.909715547752178, -22.187548626081497, -42.75460341607386, -18.55395411331563, -14.876689239137441, -22.550703132043914, -19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855, -26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564], "policy_predator_policy_reward": [18.500073956446023, 38.02484948798028, 50.59404800138334, 13.34150131884126, 7.618653675320859, 3.169737410534445, 32.793365493867924, 34.215098742562574, 15.129882977654516, 35.38445353336096, 32.10956271505144, 28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235, 30.442395616775343, 57.26377254944312, 27.45738175544247, 33.98546235934697, 33.422568661660925, 24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292, 31.909715547752178, 22.187548626081497, 42.75460341607386, 18.55395411331563, 14.876689239137441, 22.550703132043914, 19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855, 26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3034192029088756, "mean_inference_ms": 1.0158601562061684, "mean_action_processing_ms": 0.1328130635479668, "mean_env_wait_ms": 0.22902137527491173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034017562866210938, "StateBufferConnector_ms": 0.0022554397583007812, "ViewRequirementAgentConnector_ms": 0.05613052845001221}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 783.0477045263981, "num_env_steps_trained_throughput_per_sec": 783.0477045263981, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 5343.676, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5343.634, "sample_time_ms": 880.261, "learn_time_ms": 4452.198, "learn_throughput": 898.433, "synch_weights_time_ms": 10.771}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 81, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-34", "timestamp": 1723386214, "time_this_iter_s": 5.1108620166778564, "time_total_s": 416.73595929145813, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22450d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 416.73595929145813, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 30.9, "ram_util_percent": 82.76249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0688949385657907, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1416493443151317, "policy_loss": -0.005521029611797227, "vf_loss": 3.146786223600308, "vf_explained_var": 0.4549582054838538, "kl": 0.00852700868573559, "entropy": 0.9039737161869804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9850498464579385, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.163101316615939, "policy_loss": -0.004297603530964504, "vf_loss": 3.167388228823741, "vf_explained_var": 0.4374198251714309, "kl": 0.004807421008540134, "entropy": 0.642265393709143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 293.19, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 29319, "policy_reward_min": {"prey_policy": -57.26377254944312, "predator_policy": -14.561520977692123}, "policy_reward_max": {"prey_policy": 14.561520977692123, "predator_policy": 57.26377254944312}, "policy_reward_mean": {"prey_policy": -17.37708808494063, "predator_policy": 17.37708808494063}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 133, 175, 400, 271, 51, 54, 400, 381, 260, 116, 125, 400, 400, 344, 400, 208, 375, 400, 33, 173, 320, 145, 282, 88, 267, 373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250, 249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400], "policy_prey_policy_reward": [-28.888613107000765, -5.970935840586449, -42.372103939399985, -8.007949123812864, -8.197923711813772, -20.153963029475044, -18.662495443136386, -5.6637838971162235, -30.442395616775343, -57.26377254944312, -27.45738175544247, -33.98546235934697, -33.422568661660925, -24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292, -31.909715547752178, -22.187548626081497, -42.75460341607386, -18.55395411331563, -14.876689239137441, -22.550703132043914, -19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855, -26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537], "policy_predator_policy_reward": [28.888613107000765, 5.970935840586449, 42.372103939399985, 8.007949123812864, 8.197923711813772, 20.153963029475044, 18.662495443136386, 5.6637838971162235, 30.442395616775343, 57.26377254944312, 27.45738175544247, 33.98546235934697, 33.422568661660925, 24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292, 31.909715547752178, 22.187548626081497, 42.75460341607386, 18.55395411331563, 14.876689239137441, 22.550703132043914, 19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855, 26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30364494975966405, "mean_inference_ms": 1.0162395287977686, "mean_action_processing_ms": 0.13283117022202182, "mean_env_wait_ms": 0.2291257343950516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033186674118041992, "StateBufferConnector_ms": 0.002246856689453125, "ViewRequirementAgentConnector_ms": 0.053841233253479004}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 769.5040883592322, "num_env_steps_trained_throughput_per_sec": 769.5040883592322, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 5311.792, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5311.749, "sample_time_ms": 881.133, "learn_time_ms": 4419.43, "learn_throughput": 905.094, "synch_weights_time_ms": 10.787}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 82, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-39", "timestamp": 1723386219, "time_this_iter_s": 5.201107978820801, "time_total_s": 421.93706727027893, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 421.93706727027893, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 31.385714285714293, "ram_util_percent": 82.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8030329548132915, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.364372193068266, "policy_loss": -0.0025802806795885164, "vf_loss": 4.366687448571126, "vf_explained_var": 0.10799290978660187, "kl": 0.005882649060786721, "entropy": 0.9095910963912804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8045584966118136, "cur_kl_coeff": 0.0011123657226562499, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.369031990567843, "policy_loss": -0.005807611180838042, "vf_loss": 4.374830390512943, "vf_explained_var": 0.10812603166947762, "kl": 0.008296899326273314, "entropy": 0.7533143742009998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 302.42, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 30242, "policy_reward_min": {"prey_policy": -49.95323212334323, "predator_policy": -14.561520977692123}, "policy_reward_max": {"prey_policy": 14.561520977692123, "predator_policy": 49.95323212334323}, "policy_reward_mean": {"prey_policy": -16.454592254118175, "predator_policy": 16.454592254118175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 344, 400, 208, 375, 400, 33, 173, 320, 145, 282, 88, 267, 373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250, 249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232], "policy_prey_policy_reward": [-24.573159861249707, -18.79694754264795, -5.004729389604725, -21.809284653132654, -25.68690380245831, -48.37892494140887, -3.227189246164439, -9.053128802913292, -31.909715547752178, -22.187548626081497, -42.75460341607386, -18.55395411331563, -14.876689239137441, -22.550703132043914, -19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855, -26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845], "policy_predator_policy_reward": [24.573159861249707, 18.79694754264795, 5.004729389604725, 21.809284653132654, 25.68690380245831, 48.37892494140887, 3.227189246164439, 9.053128802913292, 31.909715547752178, 22.187548626081497, 42.75460341607386, 18.55395411331563, 14.876689239137441, 22.550703132043914, 19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855, 26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30380639281018096, "mean_inference_ms": 1.0166011094145138, "mean_action_processing_ms": 0.13288830387884773, "mean_env_wait_ms": 0.22893394516396925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003080606460571289, "StateBufferConnector_ms": 0.0022345781326293945, "ViewRequirementAgentConnector_ms": 0.05413639545440674}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.3873336165756, "num_env_steps_trained_throughput_per_sec": 791.3873336165756, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 5282.95, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5282.906, "sample_time_ms": 864.413, "learn_time_ms": 4407.394, "learn_throughput": 907.566, "synch_weights_time_ms": 10.7}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "training_iteration": 83, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-44", "timestamp": 1723386224, "time_this_iter_s": 5.0572991371154785, "time_total_s": 426.9943664073944, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 426.9943664073944, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.342857142857145, "ram_util_percent": 82.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.764518474042416, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.306814120958249, "policy_loss": -0.0032858176869922317, "vf_loss": 3.3096252573033174, "vf_explained_var": 0.1431432203700145, "kl": 0.010536595606551942, "entropy": 0.9336917781581481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7375480885306995, "cur_kl_coeff": 0.0011123657226562499, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.297039464985331, "policy_loss": -0.002734366493920485, "vf_loss": 3.299768847723802, "vf_explained_var": 0.13731582878778378, "kl": 0.004476781589040621, "entropy": 0.6859944492578507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 306.87, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 30687, "policy_reward_min": {"prey_policy": -49.95323212334323, "predator_policy": -14.561520977692123}, "policy_reward_max": {"prey_policy": 14.561520977692123, "predator_policy": 49.95323212334323}, "policy_reward_mean": {"prey_policy": -15.947794655658809, "predator_policy": 15.947794655658809}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [373, 400, 400, 400, 148, 400, 400, 400, 400, 111, 250, 249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42], "policy_prey_policy_reward": [-19.628849727767275, -11.967419964779067, 13.918787110527827, 3.0078609116339265, -33.90231768832447, -2.2214247800732743, -15.551993610909221, -15.188986596608355, -13.09963382183141, -34.19852009897851, -36.52576757415855, -26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955], "policy_predator_policy_reward": [19.628849727767275, 11.967419964779067, -13.918787110527827, -3.0078609116339265, 33.90231768832447, 2.2214247800732743, 15.551993610909221, 15.188986596608355, 13.09963382183141, 34.19852009897851, 36.52576757415855, 26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3038383124130628, "mean_inference_ms": 1.0170040178930635, "mean_action_processing_ms": 0.13279945490272868, "mean_env_wait_ms": 0.22889714873431552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031081438064575195, "StateBufferConnector_ms": 0.0024706125259399414, "ViewRequirementAgentConnector_ms": 0.05450880527496338}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 771.9162831520133, "num_env_steps_trained_throughput_per_sec": 771.9162831520133, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 5238.907, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5238.865, "sample_time_ms": 825.553, "learn_time_ms": 4402.278, "learn_throughput": 908.62, "synch_weights_time_ms": 10.643}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 84, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-49", "timestamp": 1723386229, "time_this_iter_s": 5.185567855834961, "time_total_s": 432.17993426322937, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.17993426322937, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.9, "ram_util_percent": 82.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.119126829008261, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.982742031166951, "policy_loss": -0.0016683545649963587, "vf_loss": 2.984140823657314, "vf_explained_var": -0.05749208920945724, "kl": 0.005983680680455102, "entropy": 0.9157785379017392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.127685042843223, "cur_kl_coeff": 0.0005561828613281249, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.015690790240963, "policy_loss": -0.005478176654044849, "vf_loss": 3.021166318655014, "vf_explained_var": -0.03890627486010392, "kl": 0.004773162379886213, "entropy": 0.699363732834657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 310.76, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31076, "policy_reward_min": {"prey_policy": -49.95323212334323, "predator_policy": -14.561520977692123}, "policy_reward_max": {"prey_policy": 14.561520977692123, "predator_policy": 49.95323212334323}, "policy_reward_mean": {"prey_policy": -14.593660020417936, "predator_policy": 14.593660020417936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [249, 142, 400, 400, 284, 271, 231, 400, 400, 400, 154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-26.016506311785115, -25.60363929330135, 12.569510595097636, -9.952751307085634, -18.70666113165761, -49.95323212334323, -17.31853498448123, -17.85676514140915, -10.427722619559265, 0.18664304024994216, -29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468], "policy_predator_policy_reward": [26.016506311785115, 25.60363929330135, -12.569510595097636, 9.952751307085634, 18.70666113165761, 49.95323212334323, 17.31853498448123, 17.85676514140915, 10.427722619559265, -0.18664304024994216, 29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3038694192086618, "mean_inference_ms": 1.016428559271404, "mean_action_processing_ms": 0.13283955061598723, "mean_env_wait_ms": 0.22863240607080537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00303041934967041, "StateBufferConnector_ms": 0.002446889877319336, "ViewRequirementAgentConnector_ms": 0.05133652687072754}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 796.0259661399386, "num_env_steps_trained_throughput_per_sec": 796.0259661399386, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 5201.266, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5201.224, "sample_time_ms": 795.064, "learn_time_ms": 4395.179, "learn_throughput": 910.088, "synch_weights_time_ms": 10.592}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 85, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-23-54", "timestamp": 1723386234, "time_this_iter_s": 5.027580976486206, "time_total_s": 437.2075152397156, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe5c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.2075152397156, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 28.875, "ram_util_percent": 82.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9954015889515477, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4896482640256483, "policy_loss": -0.011137861542374594, "vf_loss": 2.4999528182049593, "vf_explained_var": 0.21467574642350276, "kl": 0.01849699863671456, "entropy": 0.8551817112912734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1649737719446422, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.551611591006319, "policy_loss": -0.004667232928962524, "vf_loss": 2.5562763972207905, "vf_explained_var": 0.2137136334553361, "kl": 0.008762706625467074, "entropy": 0.7715905382608373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 316.4, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 31640, "policy_reward_min": {"prey_policy": -48.492580676718845, "predator_policy": -14.561520977692123}, "policy_reward_max": {"prey_policy": 14.561520977692123, "predator_policy": 48.492580676718845}, "policy_reward_mean": {"prey_policy": -13.695411853886743, "predator_policy": 13.695411853886743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [154, 112, 137, 15, 400, 105, 400, 400, 400, 160, 400, 400, 332, 250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-29.447225843696767, -18.001251317249316, -18.91677301563139, -0.633369857936951, -21.31423959472957, -14.0229740828878, -19.816023542377778, -9.590436667096405, -10.493747486157464, -19.887680498164173, -3.505537595350951, -1.327037577233206, -41.92782877875042, -20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512], "policy_predator_policy_reward": [29.447225843696767, 18.001251317249316, 18.91677301563139, 0.633369857936951, 21.31423959472957, 14.0229740828878, 19.816023542377778, 9.590436667096405, 10.493747486157464, 19.887680498164173, 3.505537595350951, 1.327037577233206, 41.92782877875042, 20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3038074301515963, "mean_inference_ms": 1.0162685916139313, "mean_action_processing_ms": 0.1328018385451631, "mean_env_wait_ms": 0.22850566080884654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003046274185180664, "StateBufferConnector_ms": 0.0024794340133666992, "ViewRequirementAgentConnector_ms": 0.051239848136901855}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 772.046185962856, "num_env_steps_trained_throughput_per_sec": 772.046185962856, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 5207.523, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5207.481, "sample_time_ms": 799.723, "learn_time_ms": 4397.091, "learn_throughput": 909.692, "synch_weights_time_ms": 10.284}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 86, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-00", "timestamp": 1723386240, "time_this_iter_s": 5.183558702468872, "time_total_s": 442.39107394218445, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe62ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 442.39107394218445, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 30.928571428571427, "ram_util_percent": 82.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.22860103007406, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.507002198447784, "policy_loss": -0.0017774416116784172, "vf_loss": 3.508383096754551, "vf_explained_var": 0.1142419155066212, "kl": 0.00880201037785657, "entropy": 0.9013504608844717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1688802100718023, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5428940390547115, "policy_loss": -0.001428966876604439, "vf_loss": 3.5443210850159326, "vf_explained_var": 0.1145922003313899, "kl": 0.006889566184349721, "entropy": 0.7964519826695323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 329.22, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 32922, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -19.80218979484496}, "policy_reward_max": {"prey_policy": 19.80218979484496, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -12.904098116907091, "predator_policy": 12.904098116907091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [250, 400, 400, 217, 400, 400, 400, 400, 400, 400, 162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-20.7562629099098, -10.470889549342434, -4.185756728899829, -32.03886276508547, -29.553571921196003, -38.21056351687895, -21.472767945424096, 14.318387960283726, -23.639021971602233, -36.228527703760754, -9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265], "policy_predator_policy_reward": [20.7562629099098, 10.470889549342434, 4.185756728899829, 32.03886276508547, 29.553571921196003, 38.21056351687895, 21.472767945424096, -14.318387960283726, 23.639021971602233, 36.228527703760754, 9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30414443923008727, "mean_inference_ms": 1.015835727150745, "mean_action_processing_ms": 0.1328378844652655, "mean_env_wait_ms": 0.2284713805629789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031080245971679688, "StateBufferConnector_ms": 0.002534627914428711, "ViewRequirementAgentConnector_ms": 0.05313408374786377}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.1405692899353, "num_env_steps_trained_throughput_per_sec": 730.1405692899353, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 5200.483, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5200.438, "sample_time_ms": 797.088, "learn_time_ms": 4392.14, "learn_throughput": 910.718, "synch_weights_time_ms": 10.821}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 87, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-05", "timestamp": 1723386245, "time_this_iter_s": 5.482218027114868, "time_total_s": 447.8732919692993, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 447.8732919692993, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.9125, "ram_util_percent": 82.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.448715515807271, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8793550549695888, "policy_loss": -0.00020291690210190913, "vf_loss": 2.87937240327398, "vf_explained_var": 0.19953591867039602, "kl": 0.00411913861757335, "entropy": 0.8600191326191028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4436171534471214, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.881123049557209, "policy_loss": -0.0033012428699294104, "vf_loss": 2.884421202292045, "vf_explained_var": 0.2077408242970705, "kl": 0.01110042917333347, "entropy": 0.8927748732889692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 326.44, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 32644, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -19.80218979484496}, "policy_reward_max": {"prey_policy": 19.80218979484496, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -11.611439094534665, "predator_policy": 11.611439094534665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [162, 334, 400, 12, 14, 400, 400, 400, 37, 400, 171, 400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400], "policy_prey_policy_reward": [-9.265295740782316, -45.43782168508788, -19.424334752236014, -4.5337415440275395, -7.7792767458504954, -36.41594832989513, -17.312015545619964, 5.5097969913285265, -7.598592421340555, -11.642391876666139, -27.391245374155194, 6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766], "policy_predator_policy_reward": [9.265295740782316, 45.43782168508788, 19.424334752236014, 4.5337415440275395, 7.7792767458504954, 36.41594832989513, 17.312015545619964, -5.5097969913285265, 7.598592421340555, 11.642391876666139, 27.391245374155194, -6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30419690872664307, "mean_inference_ms": 1.0156205307639579, "mean_action_processing_ms": 0.13283472279179803, "mean_env_wait_ms": 0.22834527198692112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030155181884765625, "StateBufferConnector_ms": 0.002477288246154785, "ViewRequirementAgentConnector_ms": 0.0523068904876709}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.4276847042219, "num_env_steps_trained_throughput_per_sec": 742.4276847042219, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 5222.575, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5222.526, "sample_time_ms": 796.234, "learn_time_ms": 4414.901, "learn_throughput": 906.023, "synch_weights_time_ms": 10.988}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 88, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-11", "timestamp": 1723386251, "time_this_iter_s": 5.391236066818237, "time_total_s": 453.26452803611755, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe510d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 453.26452803611755, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 36.98571428571429, "ram_util_percent": 82.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9421295460623997, "cur_kl_coeff": 0.022525405883789058, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6055468847354253, "policy_loss": -0.0008794852411180425, "vf_loss": 2.6063280468185743, "vf_explained_var": 0.1258574585740765, "kl": 0.004365415721430575, "entropy": 0.9175357936571041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.904404795045654, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.620660014202197, "policy_loss": -0.003168907939592221, "vf_loss": 2.6238246546437343, "vf_explained_var": 0.12867559430499872, "kl": 0.015345039822697974, "entropy": 1.0142454995463293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 338.92, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 33892, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -19.80218979484496}, "policy_reward_max": {"prey_policy": 19.80218979484496, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -10.472160096544224, "predator_policy": 10.472160096544224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 170, 152, 201, 279, 400, 174, 400, 400, 114, 400, 400, 309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400], "policy_prey_policy_reward": [6.694909327305773, -3.3518807280150433, -42.09321940902161, -14.982940585863464, -39.533196117921676, -13.19832041113365, 13.354924724234564, -18.632809794055298, 14.561520977692123, 14.416930029975703, -15.609492257822243, -35.51403766439443, 8.429745886142001, -9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721], "policy_predator_policy_reward": [-6.694909327305773, 3.3518807280150433, 42.09321940902161, 14.982940585863464, 39.533196117921676, 13.19832041113365, -13.354924724234564, 18.632809794055298, -14.561520977692123, -14.416930029975703, 15.609492257822243, 35.51403766439443, -8.429745886142001, 9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30435905183601675, "mean_inference_ms": 1.015254741517907, "mean_action_processing_ms": 0.13279868044822835, "mean_env_wait_ms": 0.22834920250578603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00296783447265625, "StateBufferConnector_ms": 0.0024646520614624023, "ViewRequirementAgentConnector_ms": 0.05197489261627197}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 761.0035537687198, "num_env_steps_trained_throughput_per_sec": 761.0035537687198, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 5233.679, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5233.626, "sample_time_ms": 795.107, "learn_time_ms": 4427.057, "learn_throughput": 903.535, "synch_weights_time_ms": 11.059}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "training_iteration": 89, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-16", "timestamp": 1723386256, "time_this_iter_s": 5.259091854095459, "time_total_s": 458.523619890213, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 458.523619890213, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 31.0875, "ram_util_percent": 82.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.068055303581059, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3482154697179793, "policy_loss": -0.0052004343645724775, "vf_loss": 2.353244740019242, "vf_explained_var": 0.17834476853410403, "kl": 0.015196706544173884, "entropy": 0.9716201840589443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.962792347247402, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.354128188515703, "policy_loss": -0.0038898516135911147, "vf_loss": 2.358013809969028, "vf_explained_var": 0.18321634437888862, "kl": 0.01521724330707631, "entropy": 1.0208703265835841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.41, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34341, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -19.80218979484496}, "policy_reward_max": {"prey_policy": 19.80218979484496, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -9.42864767667565, "predator_policy": 9.42864767667565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [309, 248, 400, 400, 400, 400, 400, 400, 137, 400, 198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400], "policy_prey_policy_reward": [-9.791334195306074, -26.992107432459363, -3.3298955854820846, -20.593495559575054, -0.8405232974143537, 1.1313896992553794, 2.7308043038264724, -8.982379438936718, -35.24986794683058, -19.248209943789096, -43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966], "policy_predator_policy_reward": [9.791334195306074, 26.992107432459363, 3.3298955854820846, 20.593495559575054, 0.8405232974143537, -1.1313896992553794, -2.7308043038264724, 8.982379438936718, 35.24986794683058, 19.248209943789096, 43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30457460336560954, "mean_inference_ms": 1.0151992797467604, "mean_action_processing_ms": 0.13277971595943583, "mean_env_wait_ms": 0.22826293271029363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029556751251220703, "StateBufferConnector_ms": 0.0024483203887939453, "ViewRequirementAgentConnector_ms": 0.05560648441314697}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 790.7568468848249, "num_env_steps_trained_throughput_per_sec": 790.7568468848249, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 5192.964, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5192.917, "sample_time_ms": 784.113, "learn_time_ms": 4398.01, "learn_throughput": 909.502, "synch_weights_time_ms": 10.453}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 90, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-21", "timestamp": 1723386261, "time_this_iter_s": 5.061429023742676, "time_total_s": 463.5850489139557, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 463.5850489139557, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 31.214285714285715, "ram_util_percent": 82.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.232642584045728, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5552972895403703, "policy_loss": -0.004153370715600128, "vf_loss": 3.5593655802309514, "vf_explained_var": 0.015072133081654707, "kl": 0.007553784379313203, "entropy": 0.9801912635564805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.192210271023214, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.527540077144901, "policy_loss": -0.0016447912249229072, "vf_loss": 3.529182112465302, "vf_explained_var": 0.01798587224135796, "kl": 0.009932909400592996, "entropy": 0.9332176292936007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 342.45, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34245, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -19.80218979484496}, "policy_reward_max": {"prey_policy": 19.80218979484496, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -8.89337237652434, "predator_policy": 8.89337237652434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [198, 400, 307, 400, 400, 15, 400, 232, 400, 400, 400, 400, 400, 400, 400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400], "policy_prey_policy_reward": [-43.575331223425835, 1.4491747331606177, -31.928228757400966, -4.724196048453258, -14.47066751589503, -5.918618513244025, -20.961054624312936, -48.492580676718845, 5.742682813108836, -14.005886709339137, -3.173944940068367, -31.68027528902755, -46.554276455432515, -4.209516195193039, -6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175], "policy_predator_policy_reward": [43.575331223425835, -1.4491747331606177, 31.928228757400966, 4.724196048453258, 14.47066751589503, 5.918618513244025, 20.961054624312936, 48.492580676718845, -5.742682813108836, 14.005886709339137, 3.173944940068367, 31.68027528902755, 46.554276455432515, 4.209516195193039, 6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3045674464161639, "mean_inference_ms": 1.0151493900384467, "mean_action_processing_ms": 0.13272617631047195, "mean_env_wait_ms": 0.22817566312846524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029866695404052734, "StateBufferConnector_ms": 0.002817869186401367, "ViewRequirementAgentConnector_ms": 0.05640232563018799}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 766.7288651855101, "num_env_steps_trained_throughput_per_sec": 766.7288651855101, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 5203.835, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5203.79, "sample_time_ms": 783.451, "learn_time_ms": 4409.517, "learn_throughput": 907.129, "synch_weights_time_ms": 10.482}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "training_iteration": 91, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-26", "timestamp": 1723386266, "time_this_iter_s": 5.219736099243164, "time_total_s": 468.80478501319885, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.80478501319885, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 36.94285714285714, "ram_util_percent": 82.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3791095627471806, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0055349665383497, "policy_loss": -0.0035537734928463276, "vf_loss": 3.0088738492379585, "vf_explained_var": 0.12603051581730446, "kl": 0.01908042604915057, "entropy": 1.0044230812539656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.503551696240902, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9921542695413033, "policy_loss": -0.004202072134891447, "vf_loss": 2.9963518464316925, "vf_explained_var": 0.13113477950294813, "kl": 0.01617907468054902, "entropy": 1.0067431363587578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 340.33, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 34033, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -19.80218979484496}, "policy_reward_max": {"prey_policy": 19.80218979484496, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -6.737297674583649, "predator_policy": 6.737297674583649}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 123, 240, 400, 37, 238, 42, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400], "policy_prey_policy_reward": [-6.621577277829882, -19.230894192335196, -25.960106982704488, -30.858457835168927, -29.716946429885645, -5.008790901086916, -43.562269346894944, -3.843462726189955, -0.4751942577779573, 12.19235354241087, 0.8478573526172912, 3.422240715428501, -31.62024313511145, -4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375], "policy_predator_policy_reward": [6.621577277829882, 19.230894192335196, 25.960106982704488, 30.858457835168927, 29.716946429885645, 5.008790901086916, 43.562269346894944, 3.843462726189955, 0.4751942577779573, -12.19235354241087, -0.8478573526172912, -3.422240715428501, 31.62024313511145, 4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3048295373897605, "mean_inference_ms": 1.0150852459621473, "mean_action_processing_ms": 0.13279210288898713, "mean_env_wait_ms": 0.22833752559538806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002971053123474121, "StateBufferConnector_ms": 0.0025594234466552734, "ViewRequirementAgentConnector_ms": 0.055652499198913574}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 725.3349934933832, "num_env_steps_trained_throughput_per_sec": 725.3349934933832, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 5235.49, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5235.442, "sample_time_ms": 813.931, "learn_time_ms": 4409.967, "learn_throughput": 907.036, "synch_weights_time_ms": 11.184}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 92, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-32", "timestamp": 1723386272, "time_this_iter_s": 5.5336761474609375, "time_total_s": 474.3384611606598, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe655e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.3384611606598, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 46.975, "ram_util_percent": 83.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.149457893334329, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0294891533752284, "policy_loss": -0.004484784128241396, "vf_loss": 3.0338744796812533, "vf_explained_var": 0.33109898380935193, "kl": 0.008829236119226836, "entropy": 0.9660838453720013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4801636826246978, "cur_kl_coeff": 0.00027809143066406247, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0106461102763813, "policy_loss": -0.00977985579665983, "vf_loss": 3.020416506379843, "vf_explained_var": 0.3307367176438371, "kl": 0.034017582799057776, "entropy": 1.0806391237924495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 336.08, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 33608, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -30.798448882568803}, "policy_reward_max": {"prey_policy": 30.798448882568803, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -5.098580039063154, "predator_policy": 5.098580039063154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [71, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400], "policy_prey_policy_reward": [-4.042469277541143, 1.2768213063828924, 14.340580062819885, -10.823698343067583, 5.040803887221891, -20.103854170564468, -21.391707708100007, -18.722628622384022, 3.787710581040134, 1.0637747268699087, -14.68224467818495, -2.738400758598168, -3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614], "policy_predator_policy_reward": [4.042469277541143, -1.2768213063828924, -14.340580062819885, 10.823698343067583, -5.040803887221891, 20.103854170564468, 21.391707708100007, 18.722628622384022, -3.787710581040134, -1.0637747268699087, 14.68224467818495, 2.738400758598168, 3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3051017674624449, "mean_inference_ms": 1.014717269382506, "mean_action_processing_ms": 0.1328180585617671, "mean_env_wait_ms": 0.22848601758759315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029436349868774414, "StateBufferConnector_ms": 0.002560138702392578, "ViewRequirementAgentConnector_ms": 0.05511355400085449}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.531839408686, "num_env_steps_trained_throughput_per_sec": 775.531839408686, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 5245.824, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5245.773, "sample_time_ms": 818.581, "learn_time_ms": 4415.593, "learn_throughput": 905.881, "synch_weights_time_ms": 11.234}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 93, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-37", "timestamp": 1723386277, "time_this_iter_s": 5.161370277404785, "time_total_s": 479.4998314380646, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe82dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 479.4998314380646, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 33.5, "ram_util_percent": 83.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2169721612085898, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.435456528017919, "policy_loss": -0.005587442718873111, "vf_loss": 4.440922514349222, "vf_explained_var": -0.008509202487766742, "kl": 0.010784173927928957, "entropy": 0.9196773082638781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.309136266199251, "cur_kl_coeff": 0.0004171371459960936, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.397400849064192, "policy_loss": -0.004683295670353497, "vf_loss": 4.402074554562569, "vf_explained_var": -0.03901426314065854, "kl": 0.02302364618930734, "entropy": 1.1075776364654302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 334.02, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 33402, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -30.798448882568803}, "policy_reward_max": {"prey_policy": 30.798448882568803, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -4.526533120745531, "predator_policy": 4.526533120745531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 223, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400], "policy_prey_policy_reward": [-3.2011801476106285, -7.281784964875889, -20.328161797950315, 10.239780745638512, -11.121092928413784, 10.756788505590954, 19.80218979484496, -29.004794778955414, -14.877676788607156, -7.346496387190097, -31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833], "policy_predator_policy_reward": [3.2011801476106285, 7.281784964875889, 20.328161797950315, -10.239780745638512, 11.121092928413784, -10.756788505590954, -19.80218979484496, 29.004794778955414, 14.877676788607156, 7.346496387190097, 31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30527116300657864, "mean_inference_ms": 1.0147883216547509, "mean_action_processing_ms": 0.13282434107877156, "mean_env_wait_ms": 0.22860705954108845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029047727584838867, "StateBufferConnector_ms": 0.002517223358154297, "ViewRequirementAgentConnector_ms": 0.05410420894622803}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.3408819454839, "num_env_steps_trained_throughput_per_sec": 775.3408819454839, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 5243.535, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5243.485, "sample_time_ms": 813.405, "learn_time_ms": 4418.561, "learn_throughput": 905.272, "synch_weights_time_ms": 11.163}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 94, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-42", "timestamp": 1723386282, "time_this_iter_s": 5.161508798599243, "time_total_s": 484.6613402366638, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 484.6613402366638, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 83.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3012698779503507, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.414871288090944, "policy_loss": -0.006462694504928853, "vf_loss": 3.4212030816823242, "vf_explained_var": 0.2668103566393256, "kl": 0.01162269480921072, "entropy": 0.9390378899872303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3707749671613176, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.322184455394745, "policy_loss": -0.005059447302483022, "vf_loss": 3.3272310089319945, "vf_explained_var": 0.23200209699571134, "kl": 0.020606517079596858, "entropy": 1.0700708615904053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 334.34, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33434, "policy_reward_min": {"prey_policy": -51.89352914069482, "predator_policy": -36.898837325560606}, "policy_reward_max": {"prey_policy": 36.898837325560606, "predator_policy": 51.89352914069482}, "policy_reward_mean": {"prey_policy": -2.6719460921476093, "predator_policy": 2.6719460921476093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 74, 400, 400, 400, 400, 400, 400, 400, 285, 400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400], "policy_prey_policy_reward": [-31.811753649102428, -5.338903362239172, -5.768515835932611, -51.89352914069482, -7.131922254429902, 1.5060479570659346, 2.476906708766265, -15.097206460071554, -9.227172276939687, -7.247111033183749, -20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504], "policy_predator_policy_reward": [31.811753649102428, 5.338903362239172, 5.768515835932611, 51.89352914069482, 7.131922254429902, -1.5060479570659346, -2.476906708766265, 15.097206460071554, 9.227172276939687, 7.247111033183749, 20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054277919441818, "mean_inference_ms": 1.0148588299392707, "mean_action_processing_ms": 0.1328520424495152, "mean_env_wait_ms": 0.22868081039982108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002954840660095215, "StateBufferConnector_ms": 0.0026625394821166992, "ViewRequirementAgentConnector_ms": 0.05305790901184082}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.2842017888204, "num_env_steps_trained_throughput_per_sec": 789.2842017888204, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 5247.828, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5247.777, "sample_time_ms": 822.291, "learn_time_ms": 4413.947, "learn_throughput": 906.218, "synch_weights_time_ms": 11.178}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 95, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-47", "timestamp": 1723386287, "time_this_iter_s": 5.070510625839233, "time_total_s": 489.73185086250305, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 489.73185086250305, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.71428571428572, "ram_util_percent": 82.87142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9483946546912194, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.155090476075808, "policy_loss": -0.005174150835470451, "vf_loss": 2.1601847102244696, "vf_explained_var": 0.13312964756041765, "kl": 0.007095890725754267, "entropy": 0.9131288686146338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9459628601248067, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.109572870408495, "policy_loss": -0.0014837365059065632, "vf_loss": 2.111045468598604, "vf_explained_var": 0.025950329626599947, "kl": 0.01186795934750675, "entropy": 1.065986695451041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 338.75, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33875, "policy_reward_min": {"prey_policy": -44.77558830434505, "predator_policy": -36.898837325560606}, "policy_reward_max": {"prey_policy": 36.898837325560606, "predator_policy": 44.77558830434505}, "policy_reward_mean": {"prey_policy": -0.4302714014671778, "predator_policy": 0.4302714014671778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 69, 235, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-20.485829428550304, -7.982200761849207, -30.44913039172376, 10.827492520423899, 18.148490500536255, -9.915491152912786, -1.5437763303020766, 1.9378610521513124, -4.6071058418695685, -3.972094970322548, 5.2823414706846705, 0.7956658482973538, 7.671655041481987, 6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011], "policy_predator_policy_reward": [20.485829428550304, 7.982200761849207, 30.44913039172376, -10.827492520423899, -18.148490500536255, 9.915491152912786, 1.5437763303020766, -1.9378610521513124, 4.6071058418695685, 3.972094970322548, -5.2823414706846705, -0.7956658482973538, -7.671655041481987, -6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3053692054453444, "mean_inference_ms": 1.0149575344076487, "mean_action_processing_ms": 0.13281876571127849, "mean_env_wait_ms": 0.22872061279587222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003007650375366211, "StateBufferConnector_ms": 0.002617955207824707, "ViewRequirementAgentConnector_ms": 0.05384671688079834}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 779.4932313845944, "num_env_steps_trained_throughput_per_sec": 779.4932313845944, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 5242.877, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5242.828, "sample_time_ms": 822.289, "learn_time_ms": 4408.982, "learn_throughput": 907.239, "synch_weights_time_ms": 11.193}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 96, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-52", "timestamp": 1723386292, "time_this_iter_s": 5.134279012680054, "time_total_s": 494.8661298751831, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 494.8661298751831, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 30.87142857142857, "ram_util_percent": 82.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9265413269400598, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3863364228357873, "policy_loss": -0.006446204637177289, "vf_loss": 2.3926635863880317, "vf_explained_var": 0.43882125336676836, "kl": 0.010569111785233383, "entropy": 0.8551928052057822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.135246551161011, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2164740957319737, "policy_loss": -0.0020115747252323975, "vf_loss": 2.2184741678337256, "vf_explained_var": 0.3976714339728157, "kl": 0.012255922013709597, "entropy": 0.9860108238334457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 332.88, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 33288, "policy_reward_min": {"prey_policy": -44.77558830434505, "predator_policy": -36.898837325560606}, "policy_reward_max": {"prey_policy": 36.898837325560606, "predator_policy": 44.77558830434505}, "policy_reward_mean": {"prey_policy": -0.42271540949269826, "predator_policy": 0.42271540949269826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 255, 123, 400, 400, 400, 400, 400, 170, 400, 400, 198, 44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400], "policy_prey_policy_reward": [6.719314601423488, -16.15858931033078, -44.77558830434505, -24.911605334199265, 4.655178521739721, -17.661086284233164, -4.447293161116274, -9.050300886958073, -4.542255345041817, 19.6970568780587, 16.643747874027937, -11.266842560730804, -6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076], "policy_predator_policy_reward": [-6.719314601423488, 16.15858931033078, 44.77558830434505, 24.911605334199265, -4.655178521739721, 17.661086284233164, 4.447293161116274, 9.050300886958073, 4.542255345041817, -19.6970568780587, -16.643747874027937, 11.266842560730804, 6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30543242196321996, "mean_inference_ms": 1.014739914526632, "mean_action_processing_ms": 0.13275069234765716, "mean_env_wait_ms": 0.22885192325153286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003149271011352539, "StateBufferConnector_ms": 0.002626657485961914, "ViewRequirementAgentConnector_ms": 0.05396139621734619}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.1034144514749, "num_env_steps_trained_throughput_per_sec": 798.1034144514749, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 5196.224, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5196.18, "sample_time_ms": 796.723, "learn_time_ms": 4388.466, "learn_throughput": 911.48, "synch_weights_time_ms": 10.628}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "training_iteration": 97, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-24-57", "timestamp": 1723386297, "time_this_iter_s": 5.014535188674927, "time_total_s": 499.88066506385803, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe655e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 499.88066506385803, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.3, "ram_util_percent": 82.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.682958427692453, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.382683661207557, "policy_loss": -0.003824040963081643, "vf_loss": 2.3864203806966544, "vf_explained_var": 0.6251103322332104, "kl": 0.007752766934581817, "entropy": 0.8306205300614238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6735980003451307, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3847759601970515, "policy_loss": -0.006748952839673924, "vf_loss": 2.391507346803943, "vf_explained_var": 0.6028185994674762, "kl": 0.018709522470843995, "entropy": 1.1161869945004583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 337.51, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 33751, "policy_reward_min": {"prey_policy": -42.26220791093162, "predator_policy": -36.898837325560606}, "policy_reward_max": {"prey_policy": 36.898837325560606, "predator_policy": 42.26220791093162}, "policy_reward_mean": {"prey_policy": 1.1924309144835303, "predator_policy": -1.1924309144835303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [44, 400, 400, 400, 327, 400, 400, 223, 400, 400, 400, 216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229], "policy_prey_policy_reward": [-6.24518766695495, 14.388588763509546, -8.139633709049683, -1.2561311453079753, -14.602466696087172, 5.375179903863966, -6.739597876500618, -25.150205424391537, 4.759424952887148, -13.742540288944426, -13.961525406478977, -16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365], "policy_predator_policy_reward": [6.24518766695495, -14.388588763509546, 8.139633709049683, 1.2561311453079753, 14.602466696087172, -5.375179903863966, 6.739597876500618, 25.150205424391537, -4.759424952887148, 13.742540288944426, 13.961525406478977, 16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054023217748879, "mean_inference_ms": 1.0150988578699305, "mean_action_processing_ms": 0.13278885877794835, "mean_env_wait_ms": 0.22894317606392217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032014846801757812, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.050592780113220215}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.1989973488392, "num_env_steps_trained_throughput_per_sec": 777.1989973488392, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 5172.12, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5172.078, "sample_time_ms": 804.251, "learn_time_ms": 4356.733, "learn_throughput": 918.119, "synch_weights_time_ms": 10.733}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 98, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-03", "timestamp": 1723386303, "time_this_iter_s": 5.149405002593994, "time_total_s": 505.030070066452, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe51430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 505.030070066452, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.9125, "ram_util_percent": 82.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9685488835598033, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.077500608190894, "policy_loss": -0.0042339711064414585, "vf_loss": 2.08162116445601, "vf_explained_var": 0.5778332582985362, "kl": 0.010069592049888361, "entropy": 0.815801424967746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8248604950184624, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.153184954697887, "policy_loss": -0.003100198558240663, "vf_loss": 2.1562723765770593, "vf_explained_var": 0.5490208602820833, "kl": 0.013602272617162814, "entropy": 0.9964402340352535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 339.74, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 33974, "policy_reward_min": {"prey_policy": -42.26220791093162, "predator_policy": -36.898837325560606}, "policy_reward_max": {"prey_policy": 36.898837325560606, "predator_policy": 42.26220791093162}, "policy_reward_mean": {"prey_policy": 2.4115725861769493, "predator_policy": -2.4115725861769493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [216, 400, 400, 159, 400, 400, 298, 400, 400, 201, 400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400], "policy_prey_policy_reward": [-16.84629334786509, 16.294052325606657, 5.476875197686454, -13.072067075863245, -4.6562124377168175, -0.6829173313793753, -7.371370896743838, 6.611724544600996, -3.641669131350376, -18.1166842212969, 13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542], "policy_predator_policy_reward": [16.84629334786509, -16.294052325606657, -5.476875197686454, 13.072067075863245, 4.6562124377168175, 0.6829173313793753, 7.371370896743838, -6.611724544600996, 3.641669131350376, 18.1166842212969, -13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30539571070403715, "mean_inference_ms": 1.0151662780186255, "mean_action_processing_ms": 0.13279479690338036, "mean_env_wait_ms": 0.22898248525539736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034198760986328125, "StateBufferConnector_ms": 0.0027191638946533203, "ViewRequirementAgentConnector_ms": 0.05078136920928955}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.3689709735637, "num_env_steps_trained_throughput_per_sec": 777.3689709735637, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 5161.051, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5161.013, "sample_time_ms": 799.324, "learn_time_ms": 4350.416, "learn_throughput": 919.452, "synch_weights_time_ms": 10.897}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 99, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-08", "timestamp": 1723386308, "time_this_iter_s": 5.150727033615112, "time_total_s": 510.18079710006714, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 510.18079710006714, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 32.01428571428571, "ram_util_percent": 82.55714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6060313504810133, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8308594942092897, "policy_loss": -0.004948442709185959, "vf_loss": 2.8356830631693204, "vf_explained_var": 0.6032365624482433, "kl": 0.011086426054191497, "entropy": 0.9106288734202583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.754510997235775, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8591601538161435, "policy_loss": -0.005924531551621233, "vf_loss": 2.865074477220575, "vf_explained_var": 0.6024652399122715, "kl": 0.010874051833101661, "entropy": 0.9370435005053878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 341.3, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34130, "policy_reward_min": {"prey_policy": -42.26220791093162, "predator_policy": -42.11241740552283}, "policy_reward_max": {"prey_policy": 42.11241740552283, "predator_policy": 42.26220791093162}, "policy_reward_mean": {"prey_policy": 4.357093701292702, "predator_policy": -4.357093701292702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 2, 400, 381, 58, 400, 400, 400, 28, 100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400], "policy_prey_policy_reward": [13.672351500715255, 0.2956063530053541, -4.146611274496401, -1.1344702043556465, 7.404785296113825, -34.847407744592836, -3.527516343648175, -13.09361540267151, 11.682545647926375, 16.997313684291655, -3.0899832308775204, -19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741], "policy_predator_policy_reward": [-13.672351500715255, -0.2956063530053541, 4.146611274496401, 1.1344702043556465, -7.404785296113825, 34.847407744592836, 3.527516343648175, 13.09361540267151, -11.682545647926375, -16.997313684291655, 3.0899832308775204, 19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30541442096583044, "mean_inference_ms": 1.0154845664168746, "mean_action_processing_ms": 0.1327919343798226, "mean_env_wait_ms": 0.2291597431708734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003552556037902832, "StateBufferConnector_ms": 0.0025998353958129883, "ViewRequirementAgentConnector_ms": 0.051666975021362305}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 747.8844019275261, "num_env_steps_trained_throughput_per_sec": 747.8844019275261, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 5190.05, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5190.011, "sample_time_ms": 827.223, "learn_time_ms": 4351.648, "learn_throughput": 919.192, "synch_weights_time_ms": 10.761}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 100, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-13", "timestamp": 1723386313, "time_this_iter_s": 5.351073980331421, "time_total_s": 515.5318710803986, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe51310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 515.5318710803986, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 34.325, "ram_util_percent": 82.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.904383286088705, "cur_kl_coeff": 0.011262702941894529, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0648881403108437, "policy_loss": -0.005135152971585437, "vf_loss": 2.0695125044633946, "vf_explained_var": 0.2502899215867122, "kl": 0.04535206190109022, "entropy": 0.943841754210492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9358355893443027, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.050261488929391, "policy_loss": -0.006544069277394252, "vf_loss": 2.0567952836553256, "vf_explained_var": 0.2583496739466985, "kl": 0.01094927186761916, "entropy": 0.8064961966748039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 352.61, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35261, "policy_reward_min": {"prey_policy": -42.26220791093162, "predator_policy": -42.11241740552283}, "policy_reward_max": {"prey_policy": 42.11241740552283, "predator_policy": 42.26220791093162}, "policy_reward_mean": {"prey_policy": 6.1496513224639076, "predator_policy": -6.1496513224639076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [100, 400, 256, 102, 400, 91, 400, 78, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-19.49411627269097, -0.5655967192649314, -8.452766730623933, -9.77016813727405, -1.6465535915587743, -9.606064574746815, 30.798448882568803, -15.946320262389285, -1.0743004177645332, 15.86990846672191, -10.583529018870614, 26.74097400925935, 1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492], "policy_predator_policy_reward": [19.49411627269097, 0.5655967192649314, 8.452766730623933, 9.77016813727405, 1.6465535915587743, 9.606064574746815, -30.798448882568803, 15.946320262389285, 1.0743004177645332, -15.86990846672191, 10.583529018870614, -26.74097400925935, -1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30548233069304187, "mean_inference_ms": 1.0154435060233415, "mean_action_processing_ms": 0.13283904344271671, "mean_env_wait_ms": 0.22913181986983763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003576040267944336, "StateBufferConnector_ms": 0.00310671329498291, "ViewRequirementAgentConnector_ms": 0.05178964138031006}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.0060940719242, "num_env_steps_trained_throughput_per_sec": 774.0060940719242, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 5185.144, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5185.106, "sample_time_ms": 821.814, "learn_time_ms": 4352.163, "learn_throughput": 919.083, "synch_weights_time_ms": 10.748}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "training_iteration": 101, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-18", "timestamp": 1723386318, "time_this_iter_s": 5.170641899108887, "time_total_s": 520.7025129795074, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 520.7025129795074, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 32.05714285714286, "ram_util_percent": 82.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4631827416519325, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6759079470299185, "policy_loss": -0.0010814719000336482, "vf_loss": 1.6767038251894215, "vf_explained_var": 0.4745280538375179, "kl": 0.01690504769420789, "entropy": 0.9134564481675624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.621575497618566, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.646872714969019, "policy_loss": -0.003820976957770957, "vf_loss": 1.6506817604725559, "vf_explained_var": 0.46318010749916233, "kl": 0.01271163085869027, "entropy": 0.8633080585549275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 360.14, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36014, "policy_reward_min": {"prey_policy": -42.26220791093162, "predator_policy": -42.11241740552283}, "policy_reward_max": {"prey_policy": 42.11241740552283, "predator_policy": 42.26220791093162}, "policy_reward_mean": {"prey_policy": 5.848690978595458, "predator_policy": -5.848690978595458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 120, 400, 153, 400, 133, 400, 400, 400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255], "policy_prey_policy_reward": [1.2765124867414812, 25.006264059992, 18.58033609733676, 10.984640547359525, 4.711358887529119, -30.6498806704681, -18.500681396751755, -42.26220791093162, 18.51481085715048, -15.56339675211273, -8.629351377447833, -8.96630427122642, 24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849], "policy_predator_policy_reward": [-1.2765124867414812, -25.006264059992, -18.58033609733676, -10.984640547359525, -4.711358887529119, 30.6498806704681, 18.500681396751755, 42.26220791093162, -18.51481085715048, 15.56339675211273, 8.629351377447833, 8.96630427122642, -24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054452183121795, "mean_inference_ms": 1.015704334342708, "mean_action_processing_ms": 0.1328587402014178, "mean_env_wait_ms": 0.22915512489825254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036126375198364258, "StateBufferConnector_ms": 0.0031174421310424805, "ViewRequirementAgentConnector_ms": 0.05281484127044678}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.6807191643188, "num_env_steps_trained_throughput_per_sec": 795.6807191643188, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 5136.389, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5136.353, "sample_time_ms": 799.331, "learn_time_ms": 4326.446, "learn_throughput": 924.546, "synch_weights_time_ms": 10.215}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 102, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-23", "timestamp": 1723386323, "time_this_iter_s": 5.02974796295166, "time_total_s": 525.7322609424591, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 525.7322609424591, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 32.95714285714286, "ram_util_percent": 82.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3676104099179307, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.417651341545085, "policy_loss": -0.0045413553108422395, "vf_loss": 1.4219105620558063, "vf_explained_var": 0.4478493775551518, "kl": 0.016700103147944775, "entropy": 1.105447263394793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3671448013124365, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4600237770937383, "policy_loss": -0.00509690114025337, "vf_loss": 1.4651057930042346, "vf_explained_var": 0.4525622715552648, "kl": 0.015859161102998624, "entropy": 0.9848118029534817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 356.85, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35685, "policy_reward_min": {"prey_policy": -37.55154141737024, "predator_policy": -42.11241740552283}, "policy_reward_max": {"prey_policy": 42.11241740552283, "predator_policy": 37.55154141737024}, "policy_reward_mean": {"prey_policy": 6.914664613652256, "predator_policy": -6.914664613652256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 255, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400], "policy_prey_policy_reward": [24.380282070972374, 8.949203591660574, 36.898837325560606, 0.5866314864008899, 11.607861212171855, -7.88720710647628, 36.03899480936841, 34.13251319904679, -2.644538205215504, 25.031549010273757, 22.641116933215162, -6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964], "policy_predator_policy_reward": [-24.380282070972374, -8.949203591660574, -36.898837325560606, -0.5866314864008899, -11.607861212171855, 7.88720710647628, -36.03899480936841, -34.13251319904679, 2.644538205215504, -25.031549010273757, -22.641116933215162, 6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30548553944302265, "mean_inference_ms": 1.0157855729983836, "mean_action_processing_ms": 0.132836522534698, "mean_env_wait_ms": 0.22922553763032333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00360715389251709, "StateBufferConnector_ms": 0.0031239986419677734, "ViewRequirementAgentConnector_ms": 0.053159236907958984}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 746.1417226743844, "num_env_steps_trained_throughput_per_sec": 746.1417226743844, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 5156.704, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5156.671, "sample_time_ms": 796.12, "learn_time_ms": 4349.949, "learn_throughput": 919.551, "synch_weights_time_ms": 10.236}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "training_iteration": 103, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-29", "timestamp": 1723386329, "time_this_iter_s": 5.392531156539917, "time_total_s": 531.124792098999, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 531.124792098999, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 33.2375, "ram_util_percent": 82.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9182839738205075, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.730348083252708, "policy_loss": -0.004273971738681818, "vf_loss": 1.7343086391687392, "vf_explained_var": 0.37080188977221645, "kl": 0.01855169212855046, "entropy": 1.0504433256263535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9078928000914555, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7427571199834346, "policy_loss": -0.003488377727626357, "vf_loss": 1.7462359957396985, "vf_explained_var": 0.36517458787808815, "kl": 0.010127478785949103, "entropy": 0.9193088010574381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 356.32, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35632, "policy_reward_min": {"prey_policy": -37.55154141737024, "predator_policy": -43.769130068467625}, "policy_reward_max": {"prey_policy": 43.769130068467625, "predator_policy": 37.55154141737024}, "policy_reward_mean": {"prey_policy": 6.737934001411161, "predator_policy": -6.737934001411161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400], "policy_prey_policy_reward": [-6.189652684213492, 18.941872369386076, 25.512144668252514, -7.183713470814062, -13.717796187022081, -13.937250952747853, 30.61808030820238, 12.917959726749011, 19.02965560164417, -17.950140960252178, -4.636392453100214, -18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061], "policy_predator_policy_reward": [6.189652684213492, -18.941872369386076, -25.512144668252514, 7.183713470814062, 13.717796187022081, 13.937250952747853, -30.61808030820238, -12.917959726749011, -19.02965560164417, 17.950140960252178, 4.636392453100214, 18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054474284785717, "mean_inference_ms": 1.0161503960010625, "mean_action_processing_ms": 0.13282573925579924, "mean_env_wait_ms": 0.2292102281279848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003571152687072754, "StateBufferConnector_ms": 0.0030083656311035156, "ViewRequirementAgentConnector_ms": 0.051850080490112305}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.5301950386498, "num_env_steps_trained_throughput_per_sec": 729.5301950386498, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 5189.105, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5189.063, "sample_time_ms": 810.877, "learn_time_ms": 4365.35, "learn_throughput": 916.307, "synch_weights_time_ms": 11.912}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 104, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-34", "timestamp": 1723386334, "time_this_iter_s": 5.489991903305054, "time_total_s": 536.6147840023041, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.6147840023041, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 37.6, "ram_util_percent": 82.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2698158380265037, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.715793083794415, "policy_loss": -0.0068289224453716695, "vf_loss": 1.7222489150551459, "vf_explained_var": 0.651985539868474, "kl": 0.022084610837577165, "entropy": 1.0772936382641396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.253464585201194, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7073738304898143, "policy_loss": -0.005351982898719143, "vf_loss": 1.712716980961462, "vf_explained_var": 0.6587301531185706, "kl": 0.009408908529533494, "entropy": 0.9179147206867735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 352.33, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35233, "policy_reward_min": {"prey_policy": -37.55154141737024, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 37.55154141737024}, "policy_reward_mean": {"prey_policy": 7.644598540350323, "predator_policy": -7.644598540350323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [288, 400, 400, 400, 11, 400, 191, 27, 400, 400, 400, 400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-18.57448159189309, 34.21624879808139, 11.14068392275513, 14.917259651791777, -0.9978098657370089, 10.954408742480638, -30.116798774800067, -8.525237550947102, -17.41871708115618, -25.575201685374076, 0.6545267821875527, 18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003], "policy_predator_policy_reward": [18.57448159189309, -34.21624879808139, -11.14068392275513, -14.917259651791777, 0.9978098657370089, -10.954408742480638, 30.116798774800067, 8.525237550947102, 17.41871708115618, 25.575201685374076, -0.6545267821875527, -18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054782527909712, "mean_inference_ms": 1.0165664367683684, "mean_action_processing_ms": 0.13290434230755818, "mean_env_wait_ms": 0.22918867702390588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033963918685913086, "StateBufferConnector_ms": 0.003019094467163086, "ViewRequirementAgentConnector_ms": 0.05250847339630127}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 783.6534343028302, "num_env_steps_trained_throughput_per_sec": 783.6534343028302, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 5192.747, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5192.704, "sample_time_ms": 802.595, "learn_time_ms": 4377.199, "learn_throughput": 913.826, "synch_weights_time_ms": 11.99}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 105, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-39", "timestamp": 1723386339, "time_this_iter_s": 5.123186111450195, "time_total_s": 541.7379701137543, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 541.7379701137543, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 33.05714285714286, "ram_util_percent": 82.34285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2619395991787314, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7091754191865522, "policy_loss": -0.004778414587538767, "vf_loss": 2.713504718616605, "vf_explained_var": 0.34285966275880736, "kl": 0.017722598855649262, "entropy": 1.0535860245426496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2089208729875582, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7222554025550685, "policy_loss": -0.001481910844934949, "vf_loss": 2.7237306709090867, "vf_explained_var": 0.3471945498138666, "kl": 0.0070642892856747075, "entropy": 0.8788898146400849, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 357.3, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35730, "policy_reward_min": {"prey_policy": -37.55154141737024, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 37.55154141737024}, "policy_reward_mean": {"prey_policy": 9.19187328953861, "predator_policy": -9.19187328953861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 268, 312, 400, 400, 400, 400, 400, 400, 400, 229, 124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400], "policy_prey_policy_reward": [18.84434448121128, -17.51883610955291, -14.343973463314295, 23.100230251116344, 25.46404164426614, 6.601091301050495, 3.3693518366179447, 18.363426900872483, 18.71318575318744, 22.5068096875214, -29.337829979246365, -15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986], "policy_predator_policy_reward": [-18.84434448121128, 17.51883610955291, 14.343973463314295, -23.100230251116344, -25.46404164426614, -6.601091301050495, -3.3693518366179447, -18.363426900872483, -18.71318575318744, -22.5068096875214, 29.337829979246365, 15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30560933451099426, "mean_inference_ms": 1.0164786588870505, "mean_action_processing_ms": 0.13296556593055886, "mean_env_wait_ms": 0.22924401410165338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033507347106933594, "StateBufferConnector_ms": 0.0030122995376586914, "ViewRequirementAgentConnector_ms": 0.05253612995147705}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 765.5426031042839, "num_env_steps_trained_throughput_per_sec": 765.5426031042839, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 5202.098, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5202.055, "sample_time_ms": 799.287, "learn_time_ms": 4389.828, "learn_throughput": 911.197, "synch_weights_time_ms": 12.02}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 106, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-45", "timestamp": 1723386345, "time_this_iter_s": 5.233520984649658, "time_total_s": 546.9714910984039, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 546.9714910984039, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 33.51428571428571, "ram_util_percent": 82.17142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8473753071700534, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.850950981552402, "policy_loss": -0.005196778792984939, "vf_loss": 2.8556762053320806, "vf_explained_var": 0.33857478853315115, "kl": 0.018607509280181237, "entropy": 0.9824278062830368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.871596067212522, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7748335442195335, "policy_loss": -0.0031683912173321007, "vf_loss": 2.7779930222779514, "vf_explained_var": 0.3470049780483047, "kl": 0.009505907520552052, "entropy": 0.8233258640393615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 358.05, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35805, "policy_reward_min": {"prey_policy": -37.55154141737024, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 37.55154141737024}, "policy_reward_mean": {"prey_policy": 9.440424499964566, "predator_policy": -9.440424499964566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [124, 400, 400, 400, 400, 400, 400, 400, 400, 293, 400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-15.853103791457633, 14.041743700199547, 7.82201361863509, 5.295127512121951, 4.506412591311019, -12.5529706424348, 20.016320947006363, 4.613896062907472, 20.154168666763663, -16.19748018415105, 24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487], "policy_predator_policy_reward": [15.853103791457633, -14.041743700199547, -7.82201361863509, -5.295127512121951, -4.506412591311019, 12.5529706424348, -20.016320947006363, -4.613896062907472, -20.154168666763663, 16.19748018415105, -24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3055729510147348, "mean_inference_ms": 1.0165451713132034, "mean_action_processing_ms": 0.13294570409287887, "mean_env_wait_ms": 0.22918836775396062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033135414123535156, "StateBufferConnector_ms": 0.0030622482299804688, "ViewRequirementAgentConnector_ms": 0.052919983863830566}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 788.2888389942773, "num_env_steps_trained_throughput_per_sec": 788.2888389942773, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 5208.338, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5208.294, "sample_time_ms": 796.312, "learn_time_ms": 4399.031, "learn_throughput": 909.291, "synch_weights_time_ms": 12.031}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "training_iteration": 107, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-50", "timestamp": 1723386350, "time_this_iter_s": 5.077899694442749, "time_total_s": 552.0493907928467, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.0493907928467, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 34.17142857142857, "ram_util_percent": 82.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1824743727222087, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5762091524899007, "policy_loss": -0.006148374645999865, "vf_loss": 3.5821182534098623, "vf_explained_var": 0.08051644979665677, "kl": 0.009442145042207062, "entropy": 0.6762847503026327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.145373638160527, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.459184823061029, "policy_loss": -0.004196592155009663, "vf_loss": 3.4633727935453256, "vf_explained_var": 0.09397117172678311, "kl": 0.009185877031716805, "entropy": 0.6111929375678301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 358.72, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35872, "policy_reward_min": {"prey_policy": -37.55154141737024, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 37.55154141737024}, "policy_reward_mean": {"prey_policy": 8.73078994204256, "predator_policy": -8.73078994204256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 214, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [24.753944094985542, 17.418728439246074, -14.324370307752844, 42.11241740552283, 24.594902746450344, 21.599485704773336, 27.082279588579347, -6.12057818216711, 33.023814611714684, 20.676413660279866, -7.515544529392741, 7.012054101628088, 29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912], "policy_predator_policy_reward": [-24.753944094985542, -17.418728439246074, 14.324370307752844, -42.11241740552283, -24.594902746450344, -21.599485704773336, -27.082279588579347, 6.12057818216711, -33.023814611714684, -20.676413660279866, 7.515544529392741, -7.012054101628088, -29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30556708536081695, "mean_inference_ms": 1.0166940524426658, "mean_action_processing_ms": 0.13294403331518162, "mean_env_wait_ms": 0.22922153109398608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003075242042541504, "StateBufferConnector_ms": 0.0030133724212646484, "ViewRequirementAgentConnector_ms": 0.05214345455169678}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.2049250962167, "num_env_steps_trained_throughput_per_sec": 775.2049250962167, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 5209.662, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5209.618, "sample_time_ms": 792.326, "learn_time_ms": 4404.683, "learn_throughput": 908.124, "synch_weights_time_ms": 11.701}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 108, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-25-55", "timestamp": 1723386355, "time_this_iter_s": 5.162806987762451, "time_total_s": 557.2121977806091, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fdbedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 557.2121977806091, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 31.0875, "ram_util_percent": 82.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.863088127722343, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.830654027064641, "policy_loss": -0.002685857225151267, "vf_loss": 3.8330742662151653, "vf_explained_var": 0.186217223914961, "kl": 0.010481700232251612, "entropy": 0.6754318212469419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8829645408317446, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8070831346015135, "policy_loss": -0.0014308987864448377, "vf_loss": 3.8085066998998323, "vf_explained_var": 0.21951572851588327, "kl": 0.007819367951133936, "entropy": 0.641749300993979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 359.11, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35911, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": 5.474323941183744, "predator_policy": -5.474323941183744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [29.592007069548984, 25.500541434420878, 19.579930360704996, 15.224391284160419, 25.918286441089094, 23.846427088361573, 28.40258197481457, -9.793051245011943, 2.972659485921973, 1.2129324028923492, 21.94185610080581, 7.021541204735378, -9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884], "policy_predator_policy_reward": [-29.592007069548984, -25.500541434420878, -19.579930360704996, -15.224391284160419, -25.918286441089094, -23.846427088361573, -28.40258197481457, 9.793051245011943, -2.972659485921973, -1.2129324028923492, -21.94185610080581, -7.021541204735378, 9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3055610179861571, "mean_inference_ms": 1.0162810720968343, "mean_action_processing_ms": 0.1329043418574575, "mean_env_wait_ms": 0.22910933836737649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030002593994140625, "StateBufferConnector_ms": 0.002810359001159668, "ViewRequirementAgentConnector_ms": 0.05121457576751709}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.982935140606, "num_env_steps_trained_throughput_per_sec": 777.982935140606, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 5209.257, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5209.212, "sample_time_ms": 804.357, "learn_time_ms": 4392.437, "learn_throughput": 910.656, "synch_weights_time_ms": 11.525}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "training_iteration": 109, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-00", "timestamp": 1723386360, "time_this_iter_s": 5.144283056259155, "time_total_s": 562.3564808368683, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 562.3564808368683, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 32.171428571428564, "ram_util_percent": 82.6857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.785993255612751, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0753361088534197, "policy_loss": -0.0053713295666966586, "vf_loss": 3.0805439171691735, "vf_explained_var": 0.12264532906313737, "kl": 0.0064525814249269805, "entropy": 0.7367676216488083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7481863580644132, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9856819830834866, "policy_loss": -0.005000867775621979, "vf_loss": 2.990673944974939, "vf_explained_var": 0.17742434131602447, "kl": 0.00949432651928003, "entropy": 0.5744098735352358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 359.11, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35911, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": 2.5396411327810138, "predator_policy": -2.5396411327810138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 138, 400, 396, 400, 191, 400, 400, 400, 255, 175, 400, 400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-9.447206348504656, -30.283855559484437, 12.32283867718278, -33.31059216451315, -27.601382807065107, -32.17563387813279, 23.023538014362124, 16.449350942026243, 31.741966743885854, -13.508539678776849, -11.083362555625746, 32.24400119520148, 11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011], "policy_predator_policy_reward": [9.447206348504656, 30.283855559484437, -12.32283867718278, 33.31059216451315, 27.601382807065107, 32.17563387813279, -23.023538014362124, -16.449350942026243, -31.741966743885854, 13.508539678776849, 11.083362555625746, -32.24400119520148, -11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30544725213694707, "mean_inference_ms": 1.0163479294628108, "mean_action_processing_ms": 0.13285147473325845, "mean_env_wait_ms": 0.22905544860611265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003304004669189453, "StateBufferConnector_ms": 0.002274036407470703, "ViewRequirementAgentConnector_ms": 0.05037343502044678}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 796.7608339699455, "num_env_steps_trained_throughput_per_sec": 796.7608339699455, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 5176.447, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5176.403, "sample_time_ms": 782.642, "learn_time_ms": 4381.32, "learn_throughput": 912.967, "synch_weights_time_ms": 11.555}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 110, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-05", "timestamp": 1723386365, "time_this_iter_s": 5.0231239795684814, "time_total_s": 567.3796048164368, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21fab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 567.3796048164368, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 30.94285714285714, "ram_util_percent": 82.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7321694233765204, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.487758421649535, "policy_loss": -0.003959316853191315, "vf_loss": 4.491527899851402, "vf_explained_var": 0.23630823902785777, "kl": 0.007491931004026268, "entropy": 0.7540171071887016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.766520950384438, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.516728909810384, "policy_loss": -0.0027142596321937163, "vf_loss": 4.519436168919007, "vf_explained_var": 0.2385270280142625, "kl": 0.007439992323399284, "entropy": 0.4706643250460426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 359.19, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35919, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": 0.7792360543498222, "predator_policy": -0.7792360543498222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 74, 210, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400], "policy_prey_policy_reward": [11.48971295878583, -37.55154141737024, -24.72419324024375, 16.03775562251854, 28.39475035419943, 41.277615078509264, 5.417046284116033, -6.99222568743497, -3.3510716143148365, 9.94097708450964, 15.733566164722482, 10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366], "policy_predator_policy_reward": [-11.48971295878583, 37.55154141737024, 24.72419324024375, -16.03775562251854, -28.39475035419943, -41.277615078509264, -5.417046284116033, 6.99222568743497, 3.3510716143148365, -9.94097708450964, -15.733566164722482, -10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054014290115135, "mean_inference_ms": 1.0162456920270186, "mean_action_processing_ms": 0.13282448965847182, "mean_env_wait_ms": 0.2289063697450728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688216209411621, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.051337599754333496}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 725.9799553876629, "num_env_steps_trained_throughput_per_sec": 725.9799553876629, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 5210.634, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5210.59, "sample_time_ms": 788.657, "learn_time_ms": 4409.474, "learn_throughput": 907.138, "synch_weights_time_ms": 11.568}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 111, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-11", "timestamp": 1723386371, "time_this_iter_s": 5.514991998672485, "time_total_s": 572.8945968151093, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 572.8945968151093, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 34.95, "ram_util_percent": 82.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1601500170926253, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8857833847403525, "policy_loss": -0.0032114836348531147, "vf_loss": 5.88883392761151, "vf_explained_var": 0.07242223713546991, "kl": 0.0063518792658637776, "entropy": 0.8556357957422733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9753016317884127, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.792621755351623, "policy_loss": -0.0026388261726727554, "vf_loss": 5.795256035278241, "vf_explained_var": 0.07268573654194672, "kl": 0.004844570134749423, "entropy": 0.5440795417564611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 361.56, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36156, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": -1.04098201647499, "predator_policy": 1.04098201647499}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 202, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.718172457155624, 20.546432930357554, 19.900960474959994, 11.249124877765674, 43.769130068467625, 8.523765955837092, 21.362789811147817, 29.158343251017563, -21.124352519538267, 12.224249630976061, 3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807], "policy_predator_policy_reward": [-10.718172457155624, -20.546432930357554, -19.900960474959994, -11.249124877765674, -43.769130068467625, -8.523765955837092, -21.362789811147817, -29.158343251017563, 21.124352519538267, -12.224249630976061, -3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30537171834665755, "mean_inference_ms": 1.015993648953437, "mean_action_processing_ms": 0.1328513078751105, "mean_env_wait_ms": 0.22876539019086034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.0022705793380737305, "ViewRequirementAgentConnector_ms": 0.05190932750701904}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.3452989549784, "num_env_steps_trained_throughput_per_sec": 801.3452989549784, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 5207.08, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5207.037, "sample_time_ms": 780.821, "learn_time_ms": 4413.984, "learn_throughput": 906.211, "synch_weights_time_ms": 11.345}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 112, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-16", "timestamp": 1723386376, "time_this_iter_s": 4.994369029998779, "time_total_s": 577.888965845108, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.888965845108, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 30.82857142857143, "ram_util_percent": 82.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.858725311917563, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.936322825898727, "policy_loss": -0.007464451400543718, "vf_loss": 3.9434356920421125, "vf_explained_var": 0.009401742617289226, "kl": 0.013873886896145871, "entropy": 0.6824552601824204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7166799089250464, "cur_kl_coeff": 0.00046927928924560535, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9773671818276246, "policy_loss": -0.0015693863373599016, "vf_loss": 3.9789342996974786, "vf_explained_var": -0.009738345257937908, "kl": 0.00481939730284501, "entropy": 0.4913865824540456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 362.14, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36214, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -43.95469289569262}, "policy_reward_max": {"prey_policy": 43.95469289569262, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": -3.285782726054199, "predator_policy": 3.285782726054199}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400], "policy_prey_policy_reward": [3.6735268408635093, 5.915718289396899, 0.0, -8.056866707546963, -4.855189401054879, 29.974315202515115, 28.327510176477716, -6.49722752004196, 24.625791752598406, 43.95469289569262, 17.00894833110003, 35.06096248527676, 25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058], "policy_predator_policy_reward": [-3.6735268408635093, -5.915718289396899, 0.0, 8.056866707546963, 4.855189401054879, -29.974315202515115, -28.327510176477716, 6.49722752004196, -24.625791752598406, -43.95469289569262, -17.00894833110003, -35.06096248527676, -25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30527222001513143, "mean_inference_ms": 1.0155441388181152, "mean_action_processing_ms": 0.13281238820277488, "mean_env_wait_ms": 0.22865697048575165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036399364471435547, "StateBufferConnector_ms": 0.00223541259765625, "ViewRequirementAgentConnector_ms": 0.05184054374694824}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 794.8161805758182, "num_env_steps_trained_throughput_per_sec": 794.8161805758182, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 5174.25, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5174.207, "sample_time_ms": 774.045, "learn_time_ms": 4387.902, "learn_throughput": 911.597, "synch_weights_time_ms": 11.382}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "training_iteration": 113, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-21", "timestamp": 1723386381, "time_this_iter_s": 5.036046266555786, "time_total_s": 582.9250121116638, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe51310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 582.9250121116638, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 30.614285714285717, "ram_util_percent": 82.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3931781177719436, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.610979543129603, "policy_loss": -0.0025877414111164397, "vf_loss": 4.613388415674368, "vf_explained_var": 0.3171303707485398, "kl": 0.0070587990749289885, "entropy": 0.7769636963804563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.532758538238704, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.665818080554406, "policy_loss": -0.001579283268074505, "vf_loss": 4.6673962143560255, "vf_explained_var": 0.32013661389549575, "kl": 0.005001146759830888, "entropy": 0.5094573083954553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.22, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36322, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -42.866421404537405}, "policy_reward_max": {"prey_policy": 42.866421404537405, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": -5.337135174544467, "predator_policy": 5.337135174544467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 131, 400, 400, 400, 83, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.762921194144962, 31.670527081686377, -16.078915716263197, 42.866421404537405, 27.35166099254275, 22.58521229308183, -24.500355524597726, 0.7829207325776526, -32.52106365253624, 12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384], "policy_predator_policy_reward": [-25.762921194144962, -31.670527081686377, 16.078915716263197, -42.866421404537405, -27.35166099254275, -22.58521229308183, 24.500355524597726, -0.7829207325776526, 32.52106365253624, -12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30510724025398944, "mean_inference_ms": 1.0149002428491058, "mean_action_processing_ms": 0.13273460359827324, "mean_env_wait_ms": 0.2284871765980283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037311315536499023, "StateBufferConnector_ms": 0.0022237300872802734, "ViewRequirementAgentConnector_ms": 0.05141878128051758}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.0545948478898, "num_env_steps_trained_throughput_per_sec": 802.0545948478898, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 5124.667, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5124.631, "sample_time_ms": 758.463, "learn_time_ms": 4356.053, "learn_throughput": 918.263, "synch_weights_time_ms": 9.794}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 114, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-26", "timestamp": 1723386386, "time_this_iter_s": 4.98987078666687, "time_total_s": 587.9148828983307, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 587.9148828983307, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 31.500000000000004, "ram_util_percent": 82.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1467430691545206, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1043355920662483, "policy_loss": -0.005325597489233284, "vf_loss": 3.1094918784995875, "vf_explained_var": 0.30134352600822845, "kl": 0.006681490824137352, "entropy": 0.7302975375205278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2034404285872977, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.062144236390789, "policy_loss": -0.0018761887088961278, "vf_loss": 3.064019707341989, "vf_explained_var": 0.32491285701592765, "kl": 0.003056339247894104, "entropy": 0.4344197848501305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.98, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36698, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -35.803253344837636}, "policy_reward_max": {"prey_policy": 35.803253344837636, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": -6.7049268257426, "predator_policy": 6.7049268257426}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400], "policy_prey_policy_reward": [12.422064975766986, -2.4388880753378928, -29.919464409480923, 10.808394877409484, 25.8340570747642, 31.680430589819117, 15.15145007514404, 0.6834800558548366, -3.044363027490867, 0.1859901120678522, 31.368307258390843, 20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508], "policy_predator_policy_reward": [-12.422064975766986, 2.4388880753378928, 29.919464409480923, -10.808394877409484, -25.8340570747642, -31.680430589819117, -15.15145007514404, -0.6834800558548366, 3.044363027490867, -0.1859901120678522, -31.368307258390843, -20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3048710307682668, "mean_inference_ms": 1.0149172353139193, "mean_action_processing_ms": 0.13268567662545622, "mean_env_wait_ms": 0.22829427446783712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003870368003845215, "StateBufferConnector_ms": 0.002232789993286133, "ViewRequirementAgentConnector_ms": 0.0514986515045166}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.6515847564556, "num_env_steps_trained_throughput_per_sec": 711.6515847564556, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 5176.33, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5176.231, "sample_time_ms": 757.43, "learn_time_ms": 4407.642, "learn_throughput": 907.515, "synch_weights_time_ms": 10.597}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 115, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-31", "timestamp": 1723386391, "time_this_iter_s": 5.6838719844818115, "time_total_s": 593.5987548828125, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 593.5987548828125, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 38.55, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3116946520283816, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9913104409972826, "policy_loss": -0.003490497763171637, "vf_loss": 3.9946020781993865, "vf_explained_var": 0.23290565218776466, "kl": 0.007847044436112682, "entropy": 0.7020817095413804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1740987348991134, "cur_kl_coeff": 0.00011731982231140134, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.005465257912874, "policy_loss": -0.004424283812356104, "vf_loss": 4.009888993451993, "vf_explained_var": 0.2460384439677, "kl": 0.004826513044513502, "entropy": 0.4546597497227291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.98, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36698, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -35.803253344837636}, "policy_reward_max": {"prey_policy": 35.803253344837636, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": -8.114865620987032, "predator_policy": 8.114865620987032}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 84, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.30756881518487, -5.864661567258693, -21.42808338989822, 11.9903725707033, 22.038994970988185, -24.437434215581423, 5.423972877273677, -4.47314777700899, 0.5033496867898712, 0.3999374292151501, -23.270627896521912, 4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062], "policy_predator_policy_reward": [-20.30756881518487, 5.864661567258693, 21.42808338989822, -11.9903725707033, -22.038994970988185, 24.437434215581423, -5.423972877273677, 4.47314777700899, -0.5033496867898712, -0.3999374292151501, 23.270627896521912, -4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3048545334668535, "mean_inference_ms": 1.0144531148793803, "mean_action_processing_ms": 0.13266804811113572, "mean_env_wait_ms": 0.22820031421884926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042171478271484375, "StateBufferConnector_ms": 0.0024712085723876953, "ViewRequirementAgentConnector_ms": 0.054265737533569336}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 763.5021804152858, "num_env_steps_trained_throughput_per_sec": 763.5021804152858, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 5177.728, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5177.627, "sample_time_ms": 767.217, "learn_time_ms": 4399.308, "learn_throughput": 909.234, "synch_weights_time_ms": 10.542}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 116, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-37", "timestamp": 1723386397, "time_this_iter_s": 5.2416770458221436, "time_total_s": 598.8404319286346, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe51310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 598.8404319286346, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 36.95, "ram_util_percent": 83.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.477382653268675, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.389722242206335, "policy_loss": -0.006451756855919181, "vf_loss": 3.396000729004542, "vf_explained_var": 0.4532393934826056, "kl": 0.006837293101282802, "entropy": 0.755273990953962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3429192285984755, "cur_kl_coeff": 5.865991115570067e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3761303449670472, "policy_loss": -0.0027067903594191495, "vf_loss": 3.378836872180303, "vf_explained_var": 0.4580827221895258, "kl": 0.004686564699549968, "entropy": 0.5556821087064843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 362.94, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36294, "policy_reward_min": {"prey_policy": -58.52140323069996, "predator_policy": -35.803253344837636}, "policy_reward_max": {"prey_policy": 35.803253344837636, "predator_policy": 58.52140323069996}, "policy_reward_mean": {"prey_policy": -7.794577470674216, "predator_policy": 7.794577470674216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 206, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400], "policy_prey_policy_reward": [4.03897557411795, -18.941599268051363, -34.17004374103166, -20.45429306702483, -58.52140323069996, -11.38886541649202, 20.58985985546766, -20.471321987451226, 7.39558666683838, -2.1964429134888768, -1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965], "policy_predator_policy_reward": [-4.03897557411795, 18.941599268051363, 34.17004374103166, 20.45429306702483, 58.52140323069996, 11.38886541649202, -20.58985985546766, 20.471321987451226, -7.39558666683838, 2.1964429134888768, 1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30477225984582396, "mean_inference_ms": 1.0140227962784538, "mean_action_processing_ms": 0.1326237371687732, "mean_env_wait_ms": 0.228041212608494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004261493682861328, "StateBufferConnector_ms": 0.002475738525390625, "ViewRequirementAgentConnector_ms": 0.05585312843322754}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.5747323938145, "num_env_steps_trained_throughput_per_sec": 795.5747323938145, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 5173.081, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5172.981, "sample_time_ms": 769.234, "learn_time_ms": 4392.654, "learn_throughput": 910.611, "synch_weights_time_ms": 10.54}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 117, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-42", "timestamp": 1723386402, "time_this_iter_s": 5.030618190765381, "time_total_s": 603.8710501194, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22641f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.8710501194, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 31.657142857142862, "ram_util_percent": 82.82857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9223669902731975, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.569421547402938, "policy_loss": -0.004831071846031894, "vf_loss": 4.574038534859816, "vf_explained_var": 0.15148152969777584, "kl": 0.008447618374557235, "entropy": 0.7638002690548699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.820218788056324, "cur_kl_coeff": 2.9329955577850334e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.486776936550935, "policy_loss": -0.002851392274654548, "vf_loss": 4.489628231277068, "vf_explained_var": 0.15551029108464717, "kl": 0.004875349871422341, "entropy": 0.4348166296258569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 365.36, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36536, "policy_reward_min": {"prey_policy": -51.45967017097125, "predator_policy": -35.803253344837636}, "policy_reward_max": {"prey_policy": 35.803253344837636, "predator_policy": 51.45967017097125}, "policy_reward_mean": {"prey_policy": -6.346820581104001, "predator_policy": 6.346820581104001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400], "policy_prey_policy_reward": [-1.8673711167158302, 0.6538658925175884, 3.6734138175557582, -6.463955207007903, -20.245944203550497, 3.6503130822200216, -12.454543635203759, 0.2348618952511341, -5.5649948867335794, -9.607334346301366, -9.9900516303755, -19.93150103492486, -20.974078506613328, -4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355], "policy_predator_policy_reward": [1.8673711167158302, -0.6538658925175884, -3.6734138175557582, 6.463955207007903, 20.245944203550497, -3.6503130822200216, 12.454543635203759, -0.2348618952511341, 5.5649948867335794, 9.607334346301366, 9.9900516303755, 19.93150103492486, 20.974078506613328, 4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30461893633848297, "mean_inference_ms": 1.0140537935865526, "mean_action_processing_ms": 0.13259550678164436, "mean_env_wait_ms": 0.22790427897617563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004205107688903809, "StateBufferConnector_ms": 0.002434849739074707, "ViewRequirementAgentConnector_ms": 0.05493426322937012}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 792.6971687746634, "num_env_steps_trained_throughput_per_sec": 792.6971687746634, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 5161.694, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5161.595, "sample_time_ms": 764.823, "learn_time_ms": 4385.654, "learn_throughput": 912.065, "synch_weights_time_ms": 10.567}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 118, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-47", "timestamp": 1723386407, "time_this_iter_s": 5.048907041549683, "time_total_s": 608.9199571609497, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 608.9199571609497, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 31.97142857142857, "ram_util_percent": 82.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.006278724533816, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.649569279203813, "policy_loss": -0.00652074957761215, "vf_loss": 4.655900175621112, "vf_explained_var": 0.2075851634144783, "kl": 0.007492444389702086, "entropy": 0.8061054193725189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.901562494256844, "cur_kl_coeff": 1.4664977788925167e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.5516051332155865, "policy_loss": -0.0036213753376311314, "vf_loss": 4.555226512004932, "vf_explained_var": 0.20699232791860897, "kl": 0.004893633853466991, "entropy": 0.3880220487403373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 358.3, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 35830, "policy_reward_min": {"prey_policy": -51.45967017097125, "predator_policy": -35.803253344837636}, "policy_reward_max": {"prey_policy": 35.803253344837636, "predator_policy": 51.45967017097125}, "policy_reward_mean": {"prey_policy": -6.460750292160211, "predator_policy": 6.460750292160211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 365, 400, 400, 226, 116, 290, 327, 239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-4.374362582145011, -9.726570073168634, -21.992123395696517, -5.297254033873056, -7.676792546864469, -14.415271105064704, -27.680086006739533, -23.160488899708408, -34.31077487971609, -49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025], "policy_predator_policy_reward": [4.374362582145011, 9.726570073168634, 21.992123395696517, 5.297254033873056, 7.676792546864469, 14.415271105064704, 27.680086006739533, 23.160488899708408, 34.31077487971609, 49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3044576315117153, "mean_inference_ms": 1.013563045464851, "mean_action_processing_ms": 0.132486836991479, "mean_env_wait_ms": 0.22779219407994003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00382840633392334, "StateBufferConnector_ms": 0.002363920211791992, "ViewRequirementAgentConnector_ms": 0.0541074275970459}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.6182131428891, "num_env_steps_trained_throughput_per_sec": 805.6182131428891, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 5144.057, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5143.958, "sample_time_ms": 753.536, "learn_time_ms": 4379.339, "learn_throughput": 913.38, "synch_weights_time_ms": 10.53}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "training_iteration": 119, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-52", "timestamp": 1723386412, "time_this_iter_s": 4.967687129974365, "time_total_s": 613.8876442909241, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe51430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 613.8876442909241, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 29.942857142857143, "ram_util_percent": 82.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9942988825341064, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9730472611884275, "policy_loss": -0.004658758544974262, "vf_loss": 3.9774970330297945, "vf_explained_var": 0.2547812315945824, "kl": 0.008246201577596984, "entropy": 0.8509598252053062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8946457881480456, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9569474165638288, "policy_loss": -0.0017116335584432818, "vf_loss": 3.9586590501169363, "vf_explained_var": 0.2501137757052978, "kl": 0.005390232140125562, "entropy": 0.37041761465370654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 359.22, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35922, "policy_reward_min": {"prey_policy": -51.45967017097125, "predator_policy": -35.803253344837636}, "policy_reward_max": {"prey_policy": 35.803253344837636, "predator_policy": 51.45967017097125}, "policy_reward_mean": {"prey_policy": -5.331055338966797, "predator_policy": 5.331055338966797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [239, 400, 400, 400, 284, 400, 231, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76], "policy_prey_policy_reward": [-49.60516011643911, 1.9722184542859473, 1.8726851932615176, -27.649767852840366, -44.65933673385971, 21.03862378985226, -32.53972854625695, -14.488071439200333, -24.355075367660106, -3.5635924635950005, -42.149323711174254, -3.3835873060693444, 16.883292538988552, -8.204095276392732, 9.071479020883807, -17.93595128307259, -16.902240613242174, 12.792836736932603, 6.635130840684397, -2.8085323908147757, -5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708], "policy_predator_policy_reward": [49.60516011643911, -1.9722184542859473, -1.8726851932615176, 27.649767852840366, 44.65933673385971, -21.03862378985226, 32.53972854625695, 14.488071439200333, 24.355075367660106, 3.5635924635950005, 42.149323711174254, 3.3835873060693444, -16.883292538988552, 8.204095276392732, -9.071479020883807, 17.93595128307259, 16.902240613242174, -12.792836736932603, -6.635130840684397, 2.8085323908147757, 5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3043201069344353, "mean_inference_ms": 1.0129372979410178, "mean_action_processing_ms": 0.13244345404045524, "mean_env_wait_ms": 0.22760009830549996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003377079963684082, "StateBufferConnector_ms": 0.0023369789123535156, "ViewRequirementAgentConnector_ms": 0.05251049995422363}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 788.4677004043659, "num_env_steps_trained_throughput_per_sec": 788.4677004043659, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 5149.337, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5149.239, "sample_time_ms": 744.335, "learn_time_ms": 4393.856, "learn_throughput": 910.362, "synch_weights_time_ms": 10.488}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 120, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-26-57", "timestamp": 1723386417, "time_this_iter_s": 5.0756731033325195, "time_total_s": 618.9633173942566, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fdbedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.9633173942566, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 30.67142857142857, "ram_util_percent": 82.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.557913399239381, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.752389022211234, "policy_loss": -0.003515925009075242, "vf_loss": 4.755627253403266, "vf_explained_var": -0.1462546773875753, "kl": 0.010958453593719658, "entropy": 0.8371357300008336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.591377337370068, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7267486838003, "policy_loss": -0.001552103622816503, "vf_loss": 4.728300790737072, "vf_explained_var": -0.16843425817787647, "kl": 0.005105836442010229, "entropy": 0.5481022351421416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.79, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 34379, "policy_reward_min": {"prey_policy": -51.45967017097125, "predator_policy": -35.803253344837636}, "policy_reward_max": {"prey_policy": 35.803253344837636, "predator_policy": 51.45967017097125}, "policy_reward_mean": {"prey_policy": -6.447719902261794, "predator_policy": 6.447719902261794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 260, 400, 400, 400, 400, 400, 235, 400, 400, 274, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400], "policy_prey_policy_reward": [-5.614732514682544, -4.72084946117768, 18.571317469563, -32.1130420462882, -26.055390757676058, 35.803253344837636, -7.112723267050843, -26.24208296105075, 11.98253672917232, -28.997033012031913, -51.45967017097125, 24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384], "policy_predator_policy_reward": [5.614732514682544, 4.72084946117768, -18.571317469563, 32.1130420462882, 26.055390757676058, -35.803253344837636, 7.112723267050843, 26.24208296105075, -11.98253672917232, 28.997033012031913, 51.45967017097125, -24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30401012738176203, "mean_inference_ms": 1.0120763611273027, "mean_action_processing_ms": 0.13236845743376152, "mean_env_wait_ms": 0.22719448307576176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003425121307373047, "StateBufferConnector_ms": 0.0023348331451416016, "ViewRequirementAgentConnector_ms": 0.053171396255493164}, "num_episodes": 20, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 783.240868652753, "num_env_steps_trained_throughput_per_sec": 783.240868652753, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 5109.056, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5108.959, "sample_time_ms": 741.027, "learn_time_ms": 4356.886, "learn_throughput": 918.087, "synch_weights_time_ms": 10.485}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "training_iteration": 121, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-02", "timestamp": 1723386422, "time_this_iter_s": 5.11150598526001, "time_total_s": 624.0748233795166, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe51550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 624.0748233795166, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 29.25, "ram_util_percent": 81.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.897987142764032, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9276701773206395, "policy_loss": -0.006283462523424532, "vf_loss": 3.9335899961491427, "vf_explained_var": 0.2305744493380189, "kl": 0.01434995857300424, "entropy": 0.9665934012581905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9046130252381164, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.893081213533878, "policy_loss": -0.003329248944161615, "vf_loss": 3.896410453071197, "vf_explained_var": 0.23371328034748634, "kl": 0.00681502912604724, "entropy": 0.538155213991801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 339.81, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 33981, "policy_reward_min": {"prey_policy": -46.37501438183541, "predator_policy": -33.16592296919368}, "policy_reward_max": {"prey_policy": 33.16592296919368, "predator_policy": 46.37501438183541}, "policy_reward_mean": {"prey_policy": -5.771961552891428, "predator_policy": 5.771961552891428}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [24.06608173466811, -2.7608450100929183, 0.09745861432155323, 4.740928645832444, -1.1903899249933332, 5.069422773609384, 1.7609198272039457, -15.19918547957112, -14.896452229418665, 1.717419015215647, -3.4319263447152615, -44.88407068935442, -1.7988521675713258, 1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918], "policy_predator_policy_reward": [-24.06608173466811, 2.7608450100929183, -0.09745861432155323, -4.740928645832444, 1.1903899249933332, -5.069422773609384, -1.7609198272039457, 15.19918547957112, 14.896452229418665, -1.717419015215647, 3.4319263447152615, 44.88407068935442, 1.7988521675713258, -1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3038430625619223, "mean_inference_ms": 1.0118579253845672, "mean_action_processing_ms": 0.13231401117417635, "mean_env_wait_ms": 0.22699636541417978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034600496292114258, "StateBufferConnector_ms": 0.0023546218872070312, "ViewRequirementAgentConnector_ms": 0.05239403247833252}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 796.8956003255939, "num_env_steps_trained_throughput_per_sec": 796.8956003255939, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 5111.845, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5111.745, "sample_time_ms": 740.729, "learn_time_ms": 4359.974, "learn_throughput": 917.437, "synch_weights_time_ms": 10.469}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 122, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-07", "timestamp": 1723386427, "time_this_iter_s": 5.0224199295043945, "time_total_s": 629.097243309021, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2245040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 629.097243309021, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 32.15714285714285, "ram_util_percent": 81.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7909699864064654, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7520979593197503, "policy_loss": -0.0053734470968872, "vf_loss": 3.7572683557868003, "vf_explained_var": 0.24770681926359733, "kl": 0.008012795933439608, "entropy": 0.954496870872875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.796766455968221, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7713577094177406, "policy_loss": -0.0035888636508995355, "vf_loss": 3.7749465686579544, "vf_explained_var": 0.24354841982324918, "kl": 0.006487100491532529, "entropy": 0.5876780407503247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 332.96, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 33296, "policy_reward_min": {"prey_policy": -46.37501438183541, "predator_policy": -33.16592296919368}, "policy_reward_max": {"prey_policy": 33.16592296919368, "predator_policy": 46.37501438183541}, "policy_reward_mean": {"prey_policy": -5.6910630005189295, "predator_policy": 5.6910630005189295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400], "policy_prey_policy_reward": [1.9120348532930862, 15.960276900278508, -14.098021067346703, -1.8897324035397727, 12.89806201848701, 3.357551866862263, 9.5640776551055, -46.37501438183541, -19.22148303460109, 9.43864794568437, 14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654], "policy_predator_policy_reward": [-1.9120348532930862, -15.960276900278508, 14.098021067346703, 1.8897324035397727, -12.89806201848701, -3.357551866862263, -9.5640776551055, 46.37501438183541, 19.22148303460109, -9.43864794568437, -14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30368333824519994, "mean_inference_ms": 1.0113735270085944, "mean_action_processing_ms": 0.13228462784926387, "mean_env_wait_ms": 0.22679430180503604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033676624298095703, "StateBufferConnector_ms": 0.002353668212890625, "ViewRequirementAgentConnector_ms": 0.052426815032958984}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.2440239472708, "num_env_steps_trained_throughput_per_sec": 785.2440239472708, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 5117.98, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5117.88, "sample_time_ms": 750.52, "learn_time_ms": 4356.436, "learn_throughput": 918.182, "synch_weights_time_ms": 10.355}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 123, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-12", "timestamp": 1723386432, "time_this_iter_s": 5.096740961074829, "time_total_s": 634.1939842700958, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 634.1939842700958, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 30.585714285714285, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.806880279754599, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.045371629297733, "policy_loss": -0.007712204157238982, "vf_loss": 4.052775589625041, "vf_explained_var": 0.36666514774163567, "kl": 0.012164152751989406, "entropy": 1.0043227380762498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.80230371269087, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.004777815689644, "policy_loss": -0.0024476105648015317, "vf_loss": 4.007225423057874, "vf_explained_var": 0.3811474978923798, "kl": 0.005459140661975918, "entropy": 0.7001479351893067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 336.12, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33612, "policy_reward_min": {"prey_policy": -43.56609106579809, "predator_policy": -33.16592296919368}, "policy_reward_max": {"prey_policy": 33.16592296919368, "predator_policy": 43.56609106579809}, "policy_reward_mean": {"prey_policy": -6.266741272502905, "predator_policy": 6.266741272502905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [14.5142077235908, -2.2250686731694813, -14.225647666773062, -8.963484449038134, -15.44196465412282, 5.63560183741108, -12.8281398822003, 33.16592296919368, 15.28387200599013, 20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342], "policy_predator_policy_reward": [-14.5142077235908, 2.2250686731694813, 14.225647666773062, 8.963484449038134, 15.44196465412282, -5.63560183741108, 12.8281398822003, -33.16592296919368, -15.28387200599013, -20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3034721359065473, "mean_inference_ms": 1.0110074004097047, "mean_action_processing_ms": 0.13220587905205916, "mean_env_wait_ms": 0.22658264019810498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006438851356506348, "StateBufferConnector_ms": 0.0020439624786376953, "ViewRequirementAgentConnector_ms": 0.049515485763549805}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.9474497114987, "num_env_steps_trained_throughput_per_sec": 802.9474497114987, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 5117.424, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5117.326, "sample_time_ms": 751.6, "learn_time_ms": 4354.923, "learn_throughput": 918.501, "synch_weights_time_ms": 10.237}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 124, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-17", "timestamp": 1723386437, "time_this_iter_s": 4.98429012298584, "time_total_s": 639.1782743930817, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21fab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 639.1782743930817, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 29.97142857142857, "ram_util_percent": 81.72857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.935066005711754, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.739629976451397, "policy_loss": -0.005806330350848535, "vf_loss": 3.7450054148832956, "vf_explained_var": 0.5228002338359753, "kl": 0.017004226322550327, "entropy": 0.9243311516319712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8571820560221872, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7114309072494507, "policy_loss": -0.0024580198965850285, "vf_loss": 3.7138889285425347, "vf_explained_var": 0.5303935802852114, "kl": 0.005773022372120068, "entropy": 0.5504970202532907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 339.63, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 33963, "policy_reward_min": {"prey_policy": -43.56609106579809, "predator_policy": -29.854415849427355}, "policy_reward_max": {"prey_policy": 29.854415849427355, "predator_policy": 43.56609106579809}, "policy_reward_mean": {"prey_policy": -6.834219093834935, "predator_policy": 6.834219093834935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.34525465118832, -18.40184889019461, -21.50708295797762, 7.2182328264057105, 8.712693078511965, -19.6669803767953, 9.154799113556258, -6.172759690348492, 7.738235414271593, -6.139929798551822, -25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491], "policy_predator_policy_reward": [-20.34525465118832, 18.40184889019461, 21.50708295797762, -7.2182328264057105, -8.712693078511965, 19.6669803767953, -9.154799113556258, 6.172759690348492, -7.738235414271593, 6.139929798551822, 25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30340423200778316, "mean_inference_ms": 1.0105270740923167, "mean_action_processing_ms": 0.1321765657075076, "mean_env_wait_ms": 0.2264444683389559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064193010330200195, "StateBufferConnector_ms": 0.002036571502685547, "ViewRequirementAgentConnector_ms": 0.04873049259185791}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.3621194329876, "num_env_steps_trained_throughput_per_sec": 799.3621194329876, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 5055.73, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5055.696, "sample_time_ms": 751.633, "learn_time_ms": 4294.395, "learn_throughput": 931.447, "synch_weights_time_ms": 9.34}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 125, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-22", "timestamp": 1723386442, "time_this_iter_s": 5.006532907485962, "time_total_s": 644.1848073005676, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2264790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 644.1848073005676, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 29.7, "ram_util_percent": 81.67142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5702359175309537, "cur_kl_coeff": 0.025341081619262688, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.614360360304515, "policy_loss": -0.010606005633599125, "vf_loss": 4.62409478376309, "vf_explained_var": 0.18561237826943397, "kl": 0.034395190357997055, "entropy": 1.0372352074831723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.35274822867165, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.754120426625013, "policy_loss": -0.003744059787277365, "vf_loss": 4.757864484439294, "vf_explained_var": 0.2002983152245482, "kl": 0.013449712057068967, "entropy": 0.6118024005244176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 339.24, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33924, "policy_reward_min": {"prey_policy": -45.60068028671987, "predator_policy": -29.854415849427355}, "policy_reward_max": {"prey_policy": 29.854415849427355, "predator_policy": 45.60068028671987}, "policy_reward_mean": {"prey_policy": -7.883058817447669, "predator_policy": 7.883058817447669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [132, 400, 400, 379, 400, 256, 400, 400, 400, 181, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400], "policy_prey_policy_reward": [-25.871360656044878, 12.453366828134468, 21.108556995047113, -11.802202249490643, 29.854415849427355, -35.66563480858993, -6.459897847750263, 11.946544056154835, 23.604470963236366, -27.790689784775275, -22.93659223073582, -22.276498115479125, 8.527982821778021, -8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028], "policy_predator_policy_reward": [25.871360656044878, -12.453366828134468, -21.108556995047113, 11.802202249490643, -29.854415849427355, 35.66563480858993, 6.459897847750263, -11.946544056154835, -23.604470963236366, 27.790689784775275, 22.93659223073582, 22.276498115479125, -8.527982821778021, 8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3032870084224248, "mean_inference_ms": 1.0100637691907677, "mean_action_processing_ms": 0.132130513481245, "mean_env_wait_ms": 0.22625920269931296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00642240047454834, "StateBufferConnector_ms": 0.0020399093627929688, "ViewRequirementAgentConnector_ms": 0.04927504062652588}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 766.252582592374, "num_env_steps_trained_throughput_per_sec": 766.252582592374, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 5053.847, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5053.816, "sample_time_ms": 745.45, "learn_time_ms": 4298.677, "learn_throughput": 930.519, "synch_weights_time_ms": 9.361}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 126, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-27", "timestamp": 1723386447, "time_this_iter_s": 5.2231738567352295, "time_total_s": 649.4079811573029, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 649.4079811573029, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 30.962500000000002, "ram_util_percent": 81.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.105549540867408, "cur_kl_coeff": 0.03801162242889404, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.216231954097748, "policy_loss": -0.011205314594553784, "vf_loss": 5.226764173060656, "vf_explained_var": 0.24129838173588117, "kl": 0.017707795667943407, "entropy": 1.148589061945677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.057966220068435, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.206739288568497, "policy_loss": -0.002238583669774622, "vf_loss": 5.208977865427732, "vf_explained_var": 0.24931691102683545, "kl": 0.006374451475088705, "entropy": 0.5443890546758969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 341.38, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34138, "policy_reward_min": {"prey_policy": -45.60068028671987, "predator_policy": -29.729387313882995}, "policy_reward_max": {"prey_policy": 29.729387313882995, "predator_policy": 45.60068028671987}, "policy_reward_mean": {"prey_policy": -7.996878323120272, "predator_policy": 7.996878323120272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400], "policy_prey_policy_reward": [-8.079349506816353, 1.0733842051502887, 17.123358287875455, -24.685449868591174, -24.66191915696025, 19.182852162880618, 6.248234115075265, -25.637410954602387, 11.518619128436857, 1.125853837065037, -11.530391761612204, 9.981719907375282, -22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924], "policy_predator_policy_reward": [8.079349506816353, -1.0733842051502887, -17.123358287875455, 24.685449868591174, 24.66191915696025, -19.182852162880618, -6.248234115075265, 25.637410954602387, -11.518619128436857, -1.125853837065037, 11.530391761612204, -9.981719907375282, 22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3031267341545279, "mean_inference_ms": 1.0094641564404936, "mean_action_processing_ms": 0.13206450806665865, "mean_env_wait_ms": 0.2261108668638656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065805912017822266, "StateBufferConnector_ms": 0.0020799636840820312, "ViewRequirementAgentConnector_ms": 0.05093705654144287}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 772.5203805630351, "num_env_steps_trained_throughput_per_sec": 772.5203805630351, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 5068.853, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5068.815, "sample_time_ms": 751.29, "learn_time_ms": 4307.055, "learn_throughput": 928.709, "synch_weights_time_ms": 10.124}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "training_iteration": 127, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-33", "timestamp": 1723386453, "time_this_iter_s": 5.182622909545898, "time_total_s": 654.5906040668488, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 654.5906040668488, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 33.2, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4873286195099356, "cur_kl_coeff": 0.03801162242889404, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6642818190157413, "policy_loss": -0.008327345169285157, "vf_loss": 3.6720998314519724, "vf_explained_var": 0.4919285424053669, "kl": 0.013399292770163029, "entropy": 1.0963712359468143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5166085871246953, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6614051597813764, "policy_loss": -0.0006222140276804566, "vf_loss": 3.6620273746550085, "vf_explained_var": 0.5118221998214721, "kl": 0.0024173028184357142, "entropy": 0.4941546378346781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 331.15, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 33115, "policy_reward_min": {"prey_policy": -45.60068028671987, "predator_policy": -29.729387313882995}, "policy_reward_max": {"prey_policy": 29.729387313882995, "predator_policy": 45.60068028671987}, "policy_reward_mean": {"prey_policy": -9.533227715245856, "predator_policy": 9.533227715245856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [140, 76, 400, 152, 143, 400, 253, 10, 23, 400, 400, 304, 265, 400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400], "policy_prey_policy_reward": [-22.868050926732767, -23.685653711520708, -28.76179973582412, -38.743389887494246, -22.90240739886936, -42.39631100027418, -22.171995444443596, -1.86304638100669, -18.744297443836107, -9.63637195798784, 12.692848235801527, -39.61005445839225, -22.34294720055498, 11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637], "policy_predator_policy_reward": [22.868050926732767, 23.685653711520708, 28.76179973582412, 38.743389887494246, 22.90240739886936, 42.39631100027418, 22.171995444443596, 1.86304638100669, 18.744297443836107, 9.63637195798784, -12.692848235801527, 39.61005445839225, 22.34294720055498, -11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30313655429216874, "mean_inference_ms": 1.0087722205967817, "mean_action_processing_ms": 0.13206542987012368, "mean_env_wait_ms": 0.22595698818038515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684541702270508, "StateBufferConnector_ms": 0.002118825912475586, "ViewRequirementAgentConnector_ms": 0.05240797996520996}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 718.9821705688136, "num_env_steps_trained_throughput_per_sec": 718.9821705688136, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 5120.589, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5120.551, "sample_time_ms": 751.693, "learn_time_ms": 4358.324, "learn_throughput": 917.784, "synch_weights_time_ms": 10.184}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 128, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-38", "timestamp": 1723386458, "time_this_iter_s": 5.5662147998809814, "time_total_s": 660.1568188667297, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21fab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 660.1568188667297, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 37.25, "ram_util_percent": 81.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.584139842291673, "cur_kl_coeff": 0.03801162242889404, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2409663915634157, "policy_loss": -0.005826005347140987, "vf_loss": 3.246230699370305, "vf_explained_var": 0.6956767784431577, "kl": 0.014776836679028757, "entropy": 1.1230789584418137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.489549596173068, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0880108659466106, "policy_loss": -0.00640192186231919, "vf_loss": 3.0944127867619198, "vf_explained_var": 0.7121027652795117, "kl": 0.007384373500245175, "entropy": 0.47119579029579955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 346.22, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34622, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -29.729387313882995}, "policy_reward_max": {"prey_policy": 29.729387313882995, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -8.732990143156977, "predator_policy": 8.732990143156977}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 158, 400, 400, 71, 256, 400, 400, 400, 239, 128, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35], "policy_prey_policy_reward": [11.508767642974956, -37.87165561714353, -6.068580716436735, 5.356494892186912, -30.047775436478943, -18.900181382736776, -14.770059494872598, -2.860552230290981, -1.5113378395485384, -31.4450820510205, -43.56609106579809, -2.708053742553246, 6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276], "policy_predator_policy_reward": [-11.508767642974956, 37.87165561714353, 6.068580716436735, -5.356494892186912, 30.047775436478943, 18.900181382736776, 14.770059494872598, 2.860552230290981, 1.5113378395485384, 31.4450820510205, 43.56609106579809, 2.708053742553246, -6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30312715665890483, "mean_inference_ms": 1.0086765446227544, "mean_action_processing_ms": 0.13199210612139894, "mean_env_wait_ms": 0.2260586196099599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006685495376586914, "StateBufferConnector_ms": 0.002150893211364746, "ViewRequirementAgentConnector_ms": 0.05320847034454346}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.0478750082642, "num_env_steps_trained_throughput_per_sec": 774.0478750082642, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 5140.84, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5140.801, "sample_time_ms": 762.783, "learn_time_ms": 4367.162, "learn_throughput": 915.927, "synch_weights_time_ms": 10.499}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 129, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-43", "timestamp": 1723386463, "time_this_iter_s": 5.170521974563599, "time_total_s": 665.3273408412933, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 665.3273408412933, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 33.75714285714287, "ram_util_percent": 82.08571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9214694397524, "cur_kl_coeff": 0.03801162242889404, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5743906438350677, "policy_loss": -0.008905938322034975, "vf_loss": 3.5825704768300057, "vf_explained_var": 0.3440942476813992, "kl": 0.019101856231307578, "entropy": 1.147235774497191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.87027644328773, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5564371240635713, "policy_loss": -0.003110019834518122, "vf_loss": 3.559547158082326, "vf_explained_var": 0.4039719220250845, "kl": 0.006441461568618409, "entropy": 0.43609384999920925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 352.05, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35205, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -29.729387313882995}, "policy_reward_max": {"prey_policy": 29.729387313882995, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -8.940217686156712, "predator_policy": 8.940217686156712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45], "policy_prey_policy_reward": [6.6344072495889534, 9.588554965873058, 6.03816896492933, -11.183419129207845, 7.061500724420366, 7.257944707504585, -4.019196009878254, 7.958683675821918, 1.2310698846270434, 29.729387313882995, 5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607], "policy_predator_policy_reward": [-6.6344072495889534, -9.588554965873058, -6.03816896492933, 11.183419129207845, -7.061500724420366, -7.257944707504585, 4.019196009878254, -7.958683675821918, -1.2310698846270434, -29.729387313882995, -5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3030309459921982, "mean_inference_ms": 1.0084659046048756, "mean_action_processing_ms": 0.13193540438952195, "mean_env_wait_ms": 0.2260624141232247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067331790924072266, "StateBufferConnector_ms": 0.002158522605895996, "ViewRequirementAgentConnector_ms": 0.05397343635559082}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 793.1231712416304, "num_env_steps_trained_throughput_per_sec": 793.1231712416304, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 5137.863, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5137.823, "sample_time_ms": 765.797, "learn_time_ms": 4361.186, "learn_throughput": 917.182, "synch_weights_time_ms": 10.486}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 130, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-48", "timestamp": 1723386468, "time_this_iter_s": 5.0463547706604, "time_total_s": 670.3736956119537, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2264790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 670.3736956119537, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 30.771428571428572, "ram_util_percent": 81.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2285291202987234, "cur_kl_coeff": 0.03801162242889404, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.279574165989955, "policy_loss": -0.011360042470187182, "vf_loss": 4.290157679965099, "vf_explained_var": 0.6308454111218452, "kl": 0.02042845317703268, "entropy": 1.2145076295981805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2182975435319046, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2616697584589325, "policy_loss": -0.006513058000564342, "vf_loss": 4.26818283299605, "vf_explained_var": 0.6306184011201064, "kl": 0.0056325520342395425, "entropy": 0.33309714378168187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 347.54, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34754, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -19.925374783155775}, "policy_reward_max": {"prey_policy": 19.925374783155775, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -11.089684942991394, "predator_policy": 11.089684942991394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 304, 400, 52, 56, 400, 400, 293, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57], "policy_prey_policy_reward": [5.869150675421743, -18.290586092151713, 2.1489047785399755, -23.041293026776287, -6.519327712803174, 4.7776513314359335, 13.769544494134227, -37.00857574533411, 15.718622486737996, -17.256794517714077, -9.74738986761654, -14.740147689878306, -30.268207666782487, 11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693], "policy_predator_policy_reward": [-5.869150675421743, 18.290586092151713, -2.1489047785399755, 23.041293026776287, 6.519327712803174, -4.7776513314359335, -13.769544494134227, 37.00857574533411, -15.718622486737996, 17.256794517714077, 9.74738986761654, 14.740147689878306, 30.268207666782487, -11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30300425394553265, "mean_inference_ms": 1.008447992753342, "mean_action_processing_ms": 0.13192300229675494, "mean_env_wait_ms": 0.2260776553275493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006690025329589844, "StateBufferConnector_ms": 0.002150416374206543, "ViewRequirementAgentConnector_ms": 0.05433535575866699}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.461558143121, "num_env_steps_trained_throughput_per_sec": 801.461558143121, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 5126.252, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5126.212, "sample_time_ms": 770.595, "learn_time_ms": 4344.753, "learn_throughput": 920.651, "synch_weights_time_ms": 10.518}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "training_iteration": 131, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-53", "timestamp": 1723386473, "time_this_iter_s": 4.993546962738037, "time_total_s": 675.3672425746918, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe72310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 675.3672425746918, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 31.687500000000004, "ram_util_percent": 82.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2018399076846737, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.294819205502669, "policy_loss": -0.004551621798843068, "vf_loss": 5.29891248991092, "vf_explained_var": 0.30616168553630513, "kl": 0.008038570798951409, "entropy": 1.1755267607669035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.233321645235022, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.383198244373004, "policy_loss": -0.0009398999745220256, "vf_loss": 5.38413814753294, "vf_explained_var": 0.28950831896315016, "kl": 0.002939292293461599, "entropy": 0.31233397565471627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 347.51, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34751, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -19.925374783155775}, "policy_reward_max": {"prey_policy": 19.925374783155775, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -12.177175261397458, "predator_policy": 12.177175261397458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400], "policy_prey_policy_reward": [11.712349180575181, -0.6425280789639487, 2.318870796358233, -18.105635753757856, -32.145039445725395, -21.66478412548025, 0.17864223663055512, 17.335053701014342, 3.4592315602320287, 14.22464447894776, -5.843285171921551, -5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269], "policy_predator_policy_reward": [-11.712349180575181, 0.6425280789639487, -2.318870796358233, 18.105635753757856, 32.145039445725395, 21.66478412548025, -0.17864223663055512, -17.335053701014342, -3.4592315602320287, -14.22464447894776, 5.843285171921551, 5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3030748773530669, "mean_inference_ms": 1.0081924452908468, "mean_action_processing_ms": 0.13195053858686356, "mean_env_wait_ms": 0.22597704428969626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006645560264587402, "StateBufferConnector_ms": 0.00215756893157959, "ViewRequirementAgentConnector_ms": 0.05417740345001221}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 808.1727433631047, "num_env_steps_trained_throughput_per_sec": 808.1727433631047, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 5119.247, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5119.209, "sample_time_ms": 770.267, "learn_time_ms": 4338.036, "learn_throughput": 922.076, "synch_weights_time_ms": 10.572}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 132, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-27-58", "timestamp": 1723386478, "time_this_iter_s": 4.952142238616943, "time_total_s": 680.3193848133087, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2264700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 680.3193848133087, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 30.342857142857145, "ram_util_percent": 81.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.532473713407914, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1159733213484286, "policy_loss": -0.011254995696557064, "vf_loss": 3.1262056266268092, "vf_explained_var": 0.8053082644939422, "kl": 0.01793659374476008, "entropy": 1.1776741019139687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.538702019924919, "cur_kl_coeff": 1.833122223615646e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2012919752548137, "policy_loss": -0.011462687173479934, "vf_loss": 3.212754664445917, "vf_explained_var": 0.7950358875716727, "kl": 0.013464159557977536, "entropy": 0.3267628480990728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 345.4, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34540, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -19.925374783155775}, "policy_reward_max": {"prey_policy": 19.925374783155775, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -13.111838947909186, "predator_policy": 13.111838947909186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 206, 400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308], "policy_prey_policy_reward": [-5.593641412088584, -12.115258849025963, -3.677039017912911, -13.771938779626812, -12.632292817866478, -5.882902913058491, -15.334630396043483, 17.260954604896458, -11.990133203204316, 19.925374783155775, 5.670434597215481, -44.965847937454605, -24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175], "policy_predator_policy_reward": [5.593641412088584, 12.115258849025963, 3.677039017912911, 13.771938779626812, 12.632292817866478, 5.882902913058491, 15.334630396043483, -17.260954604896458, 11.990133203204316, -19.925374783155775, -5.670434597215481, 44.965847937454605, 24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3029492611643941, "mean_inference_ms": 1.0082311411290197, "mean_action_processing_ms": 0.13191908215810189, "mean_env_wait_ms": 0.2258884491286041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033086538314819336, "StateBufferConnector_ms": 0.002177596092224121, "ViewRequirementAgentConnector_ms": 0.055696725845336914}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 787.9795055636686, "num_env_steps_trained_throughput_per_sec": 787.9795055636686, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 5117.479, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5117.44, "sample_time_ms": 769.055, "learn_time_ms": 4337.42, "learn_throughput": 922.207, "synch_weights_time_ms": 10.626}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "training_iteration": 133, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-04", "timestamp": 1723386484, "time_this_iter_s": 5.079086780548096, "time_total_s": 685.3984715938568, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe51b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 685.3984715938568, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 30.485714285714288, "ram_util_percent": 82.1857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8126013089592257, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7081544158359367, "policy_loss": -0.005961863668441462, "vf_loss": 3.7135358177125455, "vf_explained_var": -0.8161254607141017, "kl": 0.010180387557306148, "entropy": 1.204754905651013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.783134396870931, "cur_kl_coeff": 1.833122223615646e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.585588369021813, "policy_loss": -0.004580658836008903, "vf_loss": 3.5901690244674684, "vf_explained_var": -0.40768655464053155, "kl": 0.006912049740040181, "entropy": 0.33179813288152216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.86, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34386, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -14.362236402896677, "predator_policy": 14.362236402896677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 186, 400, 400, 400, 400, 400, 400, 400, 205, 12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400], "policy_prey_policy_reward": [-24.344489062727597, -45.60068028671987, -7.140815923837209, -17.083526166488028, -17.53005434847958, -7.930498675951558, 3.8124236278917465, 1.6262775072586564, -5.725400371038393, -28.15489791915714, -9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134], "policy_predator_policy_reward": [24.344489062727597, 45.60068028671987, 7.140815923837209, 17.083526166488028, 17.53005434847958, 7.930498675951558, -3.8124236278917465, -1.6262775072586564, 5.725400371038393, 28.15489791915714, 9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30283080050201283, "mean_inference_ms": 1.0083208886430972, "mean_action_processing_ms": 0.13190595839786418, "mean_env_wait_ms": 0.22581465107793242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033479928970336914, "StateBufferConnector_ms": 0.00217592716217041, "ViewRequirementAgentConnector_ms": 0.05670356750488281}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.4184959116485, "num_env_steps_trained_throughput_per_sec": 804.4184959116485, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 5116.568, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5116.529, "sample_time_ms": 766.743, "learn_time_ms": 4338.777, "learn_throughput": 921.919, "synch_weights_time_ms": 10.668}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 134, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-09", "timestamp": 1723386489, "time_this_iter_s": 4.975276947021484, "time_total_s": 690.3737485408783, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a222e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 690.3737485408783, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 31.314285714285713, "ram_util_percent": 82.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.844731690424184, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.242904793471098, "policy_loss": -0.008221627765063506, "vf_loss": 4.250388252735138, "vf_explained_var": 0.3795052442078789, "kl": 0.012946451406137083, "entropy": 1.2317380271852016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.905924914777279, "cur_kl_coeff": 1.833122223615646e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.950474101801713, "policy_loss": -0.0007587357681283417, "vf_loss": 3.9512328272064527, "vf_explained_var": 0.4261911688372493, "kl": 0.002712906400543395, "entropy": 0.44058413375169037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 344.05, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34405, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -14.007945329153848, "predator_policy": 14.007945329153848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [12, 400, 400, 202, 400, 400, 400, 400, 400, 175, 240, 189, 135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400], "policy_prey_policy_reward": [-9.779868554710715, 3.4050678764386753, 8.628008291294961, -21.455409941781028, 6.226764836055374, -3.8593834425430504, 14.047482368373924, -4.0976385628821, -6.053673026166315, -18.36143569926527, -37.19595145826715, -30.252375319660107, -10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763], "policy_predator_policy_reward": [9.779868554710715, -3.4050678764386753, -8.628008291294961, 21.455409941781028, -6.226764836055374, 3.8593834425430504, -14.047482368373924, 4.0976385628821, 6.053673026166315, 18.36143569926527, 37.19595145826715, 30.252375319660107, 10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30317215480083193, "mean_inference_ms": 1.0089754794242765, "mean_action_processing_ms": 0.13206884306524547, "mean_env_wait_ms": 0.2259487057364927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00343477725982666, "StateBufferConnector_ms": 0.0022281408309936523, "ViewRequirementAgentConnector_ms": 0.10176074504852295}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 610.8617073432264, "num_env_steps_trained_throughput_per_sec": 610.8617073432264, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 5270.981, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5270.943, "sample_time_ms": 855.067, "learn_time_ms": 4404.773, "learn_throughput": 908.106, "synch_weights_time_ms": 10.745}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 135, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-15", "timestamp": 1723386495, "time_this_iter_s": 6.553057909011841, "time_total_s": 696.9268064498901, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 696.9268064498901, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 52.21111111111111, "ram_util_percent": 83.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8252852808063227, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6223099395632743, "policy_loss": -0.00981419626356607, "vf_loss": 2.631051483998696, "vf_explained_var": 0.6826833233858148, "kl": 0.018812598426597365, "entropy": 1.1206721269836029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.778602511063218, "cur_kl_coeff": 9.16561111807823e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.613969689110915, "policy_loss": -0.002533152080529059, "vf_loss": 2.616502837464213, "vf_explained_var": 0.6580007748678327, "kl": 0.004406200821703009, "entropy": 0.29146115511345366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 350.53, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35053, "policy_reward_min": {"prey_policy": -47.175741590024856, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.175741590024856}, "policy_reward_mean": {"prey_policy": -14.952511767779392, "predator_policy": 14.952511767779392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [135, 400, 400, 400, 238, 400, 400, 400, 400, 104, 334, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400], "policy_prey_policy_reward": [-10.084560007664502, -2.625039499932072, -19.732881527812637, -35.22028214377421, -18.569766455631132, -5.801166159304984, 6.019331043078637, -7.46623103559633, -33.4814196330452, -14.344385787514646, -47.175741590024856, -11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546], "policy_predator_policy_reward": [10.084560007664502, 2.625039499932072, 19.732881527812637, 35.22028214377421, 18.569766455631132, 5.801166159304984, -6.019331043078637, 7.46623103559633, 33.4814196330452, 14.344385787514646, 47.175741590024856, 11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3035115862188011, "mean_inference_ms": 1.0099368344097563, "mean_action_processing_ms": 0.13218684848661877, "mean_env_wait_ms": 0.22624854213850262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034619569778442383, "StateBufferConnector_ms": 0.002339482307434082, "ViewRequirementAgentConnector_ms": 0.10154974460601807}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 727.1545223990788, "num_env_steps_trained_throughput_per_sec": 727.1545223990788, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 5299.05, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5299.012, "sample_time_ms": 870.691, "learn_time_ms": 4417.222, "learn_throughput": 905.546, "synch_weights_time_ms": 10.746}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 136, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-21", "timestamp": 1723386501, "time_this_iter_s": 5.503604888916016, "time_total_s": 702.4304113388062, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 702.4304113388062, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 37.475, "ram_util_percent": 82.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0394954780737558, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.389481058095892, "policy_loss": -0.0018317422332377949, "vf_loss": 3.391109807168444, "vf_explained_var": 0.6134130623191595, "kl": 0.0035601559640135766, "entropy": 1.15912687232097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8920869966968894, "cur_kl_coeff": 4.582805559039115e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.448541071017583, "policy_loss": -0.003272327185065175, "vf_loss": 3.451813407242298, "vf_explained_var": 0.5746564054240783, "kl": 0.00423969769983181, "entropy": 0.4036658242344856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 353.12, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35312, "policy_reward_min": {"prey_policy": -44.858036084137645, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 44.858036084137645}, "policy_reward_mean": {"prey_policy": -15.336371000483853, "predator_policy": 15.336371000483853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380], "policy_prey_policy_reward": [-11.167242139392144, 2.304423491039813, 10.864254470084937, -16.24839601076937, -3.5088790173892974, -26.043404635740266, -27.561818981207487, -20.786050470070364, -6.394828762622276, -32.60962793247939, -31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164], "policy_predator_policy_reward": [11.167242139392144, -2.304423491039813, -10.864254470084937, 16.24839601076937, 3.5088790173892974, 26.043404635740266, 27.561818981207487, 20.786050470070364, 6.394828762622276, 32.60962793247939, 31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.303856187220115, "mean_inference_ms": 1.0111035679420062, "mean_action_processing_ms": 0.13233380149591076, "mean_env_wait_ms": 0.22648884366051927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035033226013183594, "StateBufferConnector_ms": 0.00244903564453125, "ViewRequirementAgentConnector_ms": 0.1027231216430664}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 637.6517144579403, "num_env_steps_trained_throughput_per_sec": 637.6517144579403, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 5408.565, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5408.532, "sample_time_ms": 886.15, "learn_time_ms": 4511.999, "learn_throughput": 886.525, "synch_weights_time_ms": 10.041}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "training_iteration": 137, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-27", "timestamp": 1723386507, "time_this_iter_s": 6.294412851333618, "time_total_s": 708.7248241901398, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 708.7248241901398, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 49.53333333333333, "ram_util_percent": 82.57777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.067744493857026, "cur_kl_coeff": 0.02850871682167054, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.878905985256036, "policy_loss": -0.007319457867803673, "vf_loss": 3.885628691067298, "vf_explained_var": 0.5524936025962234, "kl": 0.02093227649264513, "entropy": 1.1781784642487765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9690722928072018, "cur_kl_coeff": 2.2914027795195574e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.899498898535967, "policy_loss": -0.0031096059659224315, "vf_loss": 3.902608513087034, "vf_explained_var": 0.5402793360874056, "kl": 0.0044507447376864444, "entropy": 0.3365920100050668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 348.22, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34822, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -16.444037163433492, "predator_policy": 16.444037163433492}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 24, 400, 400, 170, 45, 400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400], "policy_prey_policy_reward": [-31.577680086796946, 6.287152195882992, -18.2907524896535, -6.14856900931267, -20.242504534265272, -33.15589169176241, -4.200699969587881, -5.277004475923764, -1.7041400395257043, -29.699005313681116, -16.98813799458607, -17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866], "policy_predator_policy_reward": [31.577680086796946, -6.287152195882992, 18.2907524896535, 6.14856900931267, 20.242504534265272, 33.15589169176241, 4.200699969587881, 5.277004475923764, 1.7041400395257043, 29.699005313681116, 16.98813799458607, 17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3042501069561997, "mean_inference_ms": 1.0117418643018872, "mean_action_processing_ms": 0.13250357879514013, "mean_env_wait_ms": 0.22663804559725215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035315752029418945, "StateBufferConnector_ms": 0.003072500228881836, "ViewRequirementAgentConnector_ms": 0.10292363166809082}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 763.3925735694935, "num_env_steps_trained_throughput_per_sec": 763.3925735694935, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 5376.2, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5376.165, "sample_time_ms": 904.025, "learn_time_ms": 4461.77, "learn_throughput": 896.505, "synch_weights_time_ms": 10.026}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 138, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-32", "timestamp": 1723386512, "time_this_iter_s": 5.242524862289429, "time_total_s": 713.9673490524292, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 713.9673490524292, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 34.65714285714286, "ram_util_percent": 78.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2952821806073187, "cur_kl_coeff": 0.04276307523250579, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.070049345990022, "policy_loss": -0.012831422935414593, "vf_loss": 5.081702296684186, "vf_explained_var": -0.19518298413604498, "kl": 0.0275574845621699, "entropy": 1.218588480601708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.296688769819836, "cur_kl_coeff": 1.1457013897597787e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.539262943466505, "policy_loss": -0.002988884883719341, "vf_loss": 4.5422518240908785, "vf_explained_var": 0.061819814580182236, "kl": 0.007222307421322575, "entropy": 0.2904525542476525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 349.43, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34943, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -17.144951293194712, "predator_policy": 17.144951293194712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 393, 371, 328, 400, 400, 400, 400, 57, 400, 207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216], "policy_prey_policy_reward": [-17.793367024220846, -7.37998180377847, -44.858036084137645, -15.860708976391141, -19.1028090454456, 2.014877127767349, -5.118599323506853, -22.177512223229193, 3.272358316757476, -27.645844299720693, 4.731373223191049, -14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407], "policy_predator_policy_reward": [17.793367024220846, 7.37998180377847, 44.858036084137645, 15.860708976391141, 19.1028090454456, -2.014877127767349, 5.118599323506853, 22.177512223229193, -3.272358316757476, 27.645844299720693, -4.731373223191049, 14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3046550740695755, "mean_inference_ms": 1.012378356424353, "mean_action_processing_ms": 0.1326563355698778, "mean_env_wait_ms": 0.22681736260099225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525376319885254, "StateBufferConnector_ms": 0.0030319690704345703, "ViewRequirementAgentConnector_ms": 0.10216522216796875}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 779.1630418891458, "num_env_steps_trained_throughput_per_sec": 779.1630418891458, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 5372.808, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5372.773, "sample_time_ms": 896.025, "learn_time_ms": 4466.686, "learn_throughput": 895.519, "synch_weights_time_ms": 9.725}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "training_iteration": 139, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-37", "timestamp": 1723386517, "time_this_iter_s": 5.136293888092041, "time_total_s": 719.1036429405212, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 719.1036429405212, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 36.98571428571429, "ram_util_percent": 78.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1265366598963737, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4409125534196696, "policy_loss": -0.007857571480174859, "vf_loss": 3.447740961362918, "vf_explained_var": 0.5117402617509167, "kl": 0.01604438059731243, "entropy": 1.1581817146390676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8807566728132468, "cur_kl_coeff": 1.1457013897597787e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6631336783369384, "policy_loss": -0.00017861874900214995, "vf_loss": 3.6633122963209948, "vf_explained_var": 0.20668894859651724, "kl": 0.0034848817384492315, "entropy": 0.3123416845686734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 353.87, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35387, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -16.428104778339033, "predator_policy": 16.428104778339033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [207, 368, 400, 226, 202, 400, 400, 400, 351, 220, 328, 400, 400, 400, 400, 370, 400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-14.000250221752479, -22.910623340452382, -13.01255507167157, -34.525152355444156, -35.99369931440351, -11.629455588601584, -4.883874529247228, -19.91707378486351, -35.165753213674684, -14.564922869978387, -13.025173095880676, -8.440320230614269, -10.446127569719282, -8.228163576050786, -3.9196685088088774, -20.321086414194475, 11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654], "policy_predator_policy_reward": [14.000250221752479, 22.910623340452382, 13.01255507167157, 34.525152355444156, 35.99369931440351, 11.629455588601584, 4.883874529247228, 19.91707378486351, 35.165753213674684, 14.564922869978387, 13.025173095880676, 8.440320230614269, 10.446127569719282, 8.228163576050786, 3.9196685088088774, 20.321086414194475, -11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3050722716727604, "mean_inference_ms": 1.013383927832865, "mean_action_processing_ms": 0.13281588633639646, "mean_env_wait_ms": 0.22705032542136488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035562515258789062, "StateBufferConnector_ms": 0.0030754804611206055, "ViewRequirementAgentConnector_ms": 0.10257112979888916}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 772.5785440519517, "num_env_steps_trained_throughput_per_sec": 772.5785440519517, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 5386.219, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5386.184, "sample_time_ms": 900.259, "learn_time_ms": 4475.863, "learn_throughput": 893.682, "synch_weights_time_ms": 9.725}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 140, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-43", "timestamp": 1723386523, "time_this_iter_s": 5.180402994155884, "time_total_s": 724.2840459346771, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 724.2840459346771, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 31.537499999999998, "ram_util_percent": 78.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7086641383046905, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.060194510469834, "policy_loss": -0.006187439670369107, "vf_loss": 4.065823459376891, "vf_explained_var": 0.1475653439760208, "kl": 0.00870676406047265, "entropy": 1.1453948942323526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8600140549242496, "cur_kl_coeff": 5.7285069487988934e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.334315741310517, "policy_loss": -0.0029324174468153314, "vf_loss": 4.337248153736194, "vf_explained_var": 0.04422378297895193, "kl": 0.003200575191159298, "entropy": 0.3134661511828502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 348.09, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 34809, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -15.751142679498804, "predator_policy": 15.751142679498804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 353, 358, 400, 400, 400, 308, 400, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400], "policy_prey_policy_reward": [11.813712023351371, -25.876958200384806, -22.107452356448995, -0.24544452722766863, -19.399214109147827, 4.930834198270523, -28.839280232903175, -8.956106237150411, -28.42406613992753, -11.149045174914011, -21.94644624383003, -5.9398559466769, -31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575], "policy_predator_policy_reward": [-11.813712023351371, 25.876958200384806, 22.107452356448995, 0.24544452722766863, 19.399214109147827, -4.930834198270523, 28.839280232903175, 8.956106237150411, 28.42406613992753, 11.149045174914011, 21.94644624383003, 5.9398559466769, 31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3055103188765842, "mean_inference_ms": 1.01513161042792, "mean_action_processing_ms": 0.13305783110195402, "mean_env_wait_ms": 0.22742172355441548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00353395938873291, "StateBufferConnector_ms": 0.0030785799026489258, "ViewRequirementAgentConnector_ms": 0.10226571559906006}, "num_episodes": 16, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 747.5861392888733, "num_env_steps_trained_throughput_per_sec": 747.5861392888733, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 5422.186, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5422.151, "sample_time_ms": 894.133, "learn_time_ms": 4517.712, "learn_throughput": 885.404, "synch_weights_time_ms": 9.954}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 141, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-48", "timestamp": 1723386528, "time_this_iter_s": 5.3533618450164795, "time_total_s": 729.6374077796936, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21fab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 729.6374077796936, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 32.871428571428574, "ram_util_percent": 78.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0402895433828236, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.138985979432861, "policy_loss": -0.005705001757693632, "vf_loss": 3.1439850529034934, "vf_explained_var": 0.5837359232828021, "kl": 0.01100520872204832, "entropy": 1.1934848386794328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.214221564990779, "cur_kl_coeff": 2.8642534743994467e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.160795665408174, "policy_loss": -0.0027713357383618133, "vf_loss": 3.1635670084506273, "vf_explained_var": 0.5263024163121979, "kl": 0.004827564073018526, "entropy": 0.2859346784340839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.67, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34367, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -16.128861020741134}, "policy_reward_max": {"prey_policy": 16.128861020741134, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -16.656940533452786, "predator_policy": 16.656940533452786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 97, 355, 400, 400, 400, 98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400], "policy_prey_policy_reward": [-31.011241966783516, -25.12436529843114, -8.097638729637005, -32.20961265594468, -13.826845062039396, -37.590304405169356, 16.128861020741134, -4.949197754785658, -12.931440433802539, -23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057], "policy_predator_policy_reward": [31.011241966783516, 25.12436529843114, 8.097638729637005, 32.20961265594468, 13.826845062039396, 37.590304405169356, -16.128861020741134, 4.949197754785658, 12.931440433802539, 23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30591047839167024, "mean_inference_ms": 1.0160900437628042, "mean_action_processing_ms": 0.1332386882784645, "mean_env_wait_ms": 0.22768912581633252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003426194190979004, "StateBufferConnector_ms": 0.0031642913818359375, "ViewRequirementAgentConnector_ms": 0.09883415699005127}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.9333549102222, "num_env_steps_trained_throughput_per_sec": 789.9333549102222, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 5433.615, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5433.578, "sample_time_ms": 894.84, "learn_time_ms": 4528.522, "learn_throughput": 883.29, "synch_weights_time_ms": 9.864}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 142, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-53", "timestamp": 1723386533, "time_this_iter_s": 5.067150831222534, "time_total_s": 734.7045586109161, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe65ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 734.7045586109161, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 31.4875, "ram_util_percent": 78.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.039407635604342, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.984320250650247, "policy_loss": -0.004008434552815743, "vf_loss": 3.9879265457391737, "vf_explained_var": 0.43519344739615917, "kl": 0.006269464348976328, "entropy": 1.246425499394536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.046751231017212, "cur_kl_coeff": 1.4321267371997234e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.070234113931656, "policy_loss": -0.001045890043315012, "vf_loss": 4.071279991666476, "vf_explained_var": 0.34016390548398096, "kl": 0.003799854257187481, "entropy": 0.3129777910963943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.22, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 34322, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -14.379432881014978}, "policy_reward_max": {"prey_policy": 14.379432881014978, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -16.50281801443128, "predator_policy": 16.50281801443128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [98, 400, 400, 312, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400], "policy_prey_policy_reward": [-23.253100291650963, -28.581366202531918, -7.480981233958488, -31.654745349985543, 14.379432881014978, 11.018361192641017, -20.27414641599737, -8.915370635909763, -27.092939275389185, -19.13923474253521, -8.926212131946258, -15.537640658753968, -3.7166395669890875, -16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535], "policy_predator_policy_reward": [23.253100291650963, 28.581366202531918, 7.480981233958488, 31.654745349985543, -14.379432881014978, -11.018361192641017, 20.27414641599737, 8.915370635909763, 27.092939275389185, 19.13923474253521, 8.926212131946258, 15.537640658753968, 3.7166395669890875, 16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3061947218176997, "mean_inference_ms": 1.0164344297953765, "mean_action_processing_ms": 0.13333352314124572, "mean_env_wait_ms": 0.2278734462150538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033818483352661133, "StateBufferConnector_ms": 0.0031551122665405273, "ViewRequirementAgentConnector_ms": 0.09928727149963379}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 808.6092716508526, "num_env_steps_trained_throughput_per_sec": 808.6092716508526, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 5420.665, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5420.628, "sample_time_ms": 888.56, "learn_time_ms": 4521.864, "learn_throughput": 884.591, "synch_weights_time_ms": 9.854}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "training_iteration": 143, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-28-58", "timestamp": 1723386538, "time_this_iter_s": 4.949432849884033, "time_total_s": 739.6539914608002, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 739.6539914608002, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.428571428571427, "ram_util_percent": 77.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.295902384320895, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.485578939815363, "policy_loss": -0.003002515939685206, "vf_loss": 4.487937357773384, "vf_explained_var": 0.1740072734033068, "kl": 0.010041013869034467, "entropy": 1.2267114234467347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3529231200615564, "cur_kl_coeff": 7.160633685998617e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.645293528089921, "policy_loss": -0.005401627548174777, "vf_loss": 4.650695154319207, "vf_explained_var": 0.14911393622557323, "kl": 0.0070054445563590955, "entropy": 0.3147162907756865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 342.31, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34231, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -22.372747847546226}, "policy_reward_max": {"prey_policy": 22.372747847546226, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -17.117591125679862, "predator_policy": 17.117591125679862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 204, 400, 400, 105, 400, 207, 271, 400, 400, 400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329], "policy_prey_policy_reward": [-16.83141286517663, -18.635142926881993, -14.909134483526286, -8.585893094894882, -15.251952940215467, -30.349189882602914, -14.22966392675546, -7.003884241920108, -42.305632455226124, 0.8932425683227976, -7.941127126604606, -38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267], "policy_predator_policy_reward": [16.83141286517663, 18.635142926881993, 14.909134483526286, 8.585893094894882, 15.251952940215467, 30.349189882602914, 14.22966392675546, 7.003884241920108, 42.305632455226124, -0.8932425683227976, 7.941127126604606, 38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30611887512272135, "mean_inference_ms": 1.0168131750688083, "mean_action_processing_ms": 0.1333610173914275, "mean_env_wait_ms": 0.22782986988492293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003246903419494629, "StateBufferConnector_ms": 0.0031141042709350586, "ViewRequirementAgentConnector_ms": 0.05430161952972412}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.8802038180319, "num_env_steps_trained_throughput_per_sec": 777.8802038180319, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 5437.629, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5437.592, "sample_time_ms": 899.689, "learn_time_ms": 4527.685, "learn_throughput": 883.454, "synch_weights_time_ms": 9.871}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 144, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-03", "timestamp": 1723386543, "time_this_iter_s": 5.144749879837036, "time_total_s": 744.7987413406372, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fd64ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 744.7987413406372, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 32.01428571428571, "ram_util_percent": 77.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.19863700196147, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.779808869709571, "policy_loss": -0.0037200645689154043, "vf_loss": 3.7828410702447095, "vf_explained_var": 0.021324939280748367, "kl": 0.010723545352716598, "entropy": 1.152910241484642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.292949571274221, "cur_kl_coeff": 7.160633685998617e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8089971763392287, "policy_loss": -0.0012631178396986797, "vf_loss": 3.81026029959321, "vf_explained_var": 0.0020507379124561948, "kl": 0.003308322656604278, "entropy": 0.26894898201959827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 344.54, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34454, "policy_reward_min": {"prey_policy": -47.88887558573801, "predator_policy": -22.372747847546226}, "policy_reward_max": {"prey_policy": 22.372747847546226, "predator_policy": 47.88887558573801}, "policy_reward_mean": {"prey_policy": -16.95292750520876, "predator_policy": 16.95292750520876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 397, 400, 400, 215, 380, 400, 400, 201, 349, 123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400], "policy_prey_policy_reward": [-38.985289285292346, -28.872711527927756, -37.499674823240824, -12.74712531604277, -6.5707193263720995, -10.001770101866033, -35.833374431498164, -10.430262323995812, -17.476706962257854, -37.06954581880643, -47.88887558573801, -19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306], "policy_predator_policy_reward": [38.985289285292346, 28.872711527927756, 37.499674823240824, 12.74712531604277, 6.5707193263720995, 10.001770101866033, 35.833374431498164, 10.430262323995812, 17.476706962257854, 37.06954581880643, 47.88887558573801, 19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.306130876553001, "mean_inference_ms": 1.0166854190592745, "mean_action_processing_ms": 0.13339097555831517, "mean_env_wait_ms": 0.22773514111483364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031241178512573242, "StateBufferConnector_ms": 0.002892613410949707, "ViewRequirementAgentConnector_ms": 0.05294084548950195}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 790.5163385330266, "num_env_steps_trained_throughput_per_sec": 790.5163385330266, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 5288.815, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5288.778, "sample_time_ms": 813.155, "learn_time_ms": 4465.536, "learn_throughput": 895.749, "synch_weights_time_ms": 9.76}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 145, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-08", "timestamp": 1723386548, "time_this_iter_s": 5.062626123428345, "time_total_s": 749.8613674640656, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a21fab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 749.8613674640656, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 30.171428571428574, "ram_util_percent": 77.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8348427983621756, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.455516234661142, "policy_loss": -0.006337386363641903, "vf_loss": 3.460875689735015, "vf_explained_var": 0.18579170710096757, "kl": 0.015245901164421271, "entropy": 1.197677318006754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.744177814014256, "cur_kl_coeff": 3.5803168429993084e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.481875368952751, "policy_loss": -0.0017245104817751175, "vf_loss": 3.4835998766124248, "vf_explained_var": 0.19943463498105604, "kl": 0.004327711167460802, "entropy": 0.30894577835376064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 342.23, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34223, "policy_reward_min": {"prey_policy": -44.42254665424802, "predator_policy": -22.372747847546226}, "policy_reward_max": {"prey_policy": 22.372747847546226, "predator_policy": 44.42254665424802}, "policy_reward_mean": {"prey_policy": -15.411915656332162, "predator_policy": 15.411915656332162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [123, 400, 400, 400, 72, 400, 243, 338, 400, 296, 400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400], "policy_prey_policy_reward": [-19.3849115183232, -27.91469521660466, -30.77384146805707, -3.8618465959836445, -20.067989811163685, -27.049510982578866, -41.09453464892241, -40.18865221227876, -15.405887889316656, -17.853879969373548, -21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353], "policy_predator_policy_reward": [19.3849115183232, 27.91469521660466, 30.77384146805707, 3.8618465959836445, 20.067989811163685, 27.049510982578866, 41.09453464892241, 40.18865221227876, 15.405887889316656, 17.853879969373548, 21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3059870986867462, "mean_inference_ms": 1.0165546055810777, "mean_action_processing_ms": 0.1334089981964807, "mean_env_wait_ms": 0.22765130839418046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030639171600341797, "StateBufferConnector_ms": 0.002913951873779297, "ViewRequirementAgentConnector_ms": 0.053055644035339355}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.607442279013, "num_env_steps_trained_throughput_per_sec": 795.607442279013, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 5241.486, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5241.45, "sample_time_ms": 799.179, "learn_time_ms": 4432.21, "learn_throughput": 902.484, "synch_weights_time_ms": 9.735}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 146, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-13", "timestamp": 1723386553, "time_this_iter_s": 5.030272006988525, "time_total_s": 754.8916394710541, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 754.8916394710541, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 31.01428571428571, "ram_util_percent": 77.97142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.716763975347082, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.116558721785744, "policy_loss": -0.00675498407217674, "vf_loss": 3.1223053256670634, "vf_explained_var": -0.04822260675330957, "kl": 0.015720304366175646, "entropy": 1.1333335941036542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.538568844397863, "cur_kl_coeff": 1.7901584214996542e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1083656935642163, "policy_loss": -0.0017040107304637786, "vf_loss": 3.1100697020689645, "vf_explained_var": -0.043914147093892096, "kl": 0.001703485696466522, "entropy": 0.18587034873198718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 349.82, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34982, "policy_reward_min": {"prey_policy": -44.42254665424802, "predator_policy": -23.060508343367026}, "policy_reward_max": {"prey_policy": 23.060508343367026, "predator_policy": 44.42254665424802}, "policy_reward_mean": {"prey_policy": -13.600810473106932, "predator_policy": 13.600810473106932}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 67, 216, 400, 400, 400, 400, 400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-21.748352723024016, -20.69522602939695, 6.765228704473323, -31.491993844298623, -33.12645737905396, -6.700803558177283, -9.548086835965407, -10.853524527118488, -28.682858521360473, -4.605434748934101, 3.245207026480628, 8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026], "policy_predator_policy_reward": [21.748352723024016, 20.69522602939695, -6.765228704473323, 31.491993844298623, 33.12645737905396, 6.700803558177283, 9.548086835965407, 10.853524527118488, 28.682858521360473, 4.605434748934101, -3.245207026480628, -8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3059432883876083, "mean_inference_ms": 1.0164522518689842, "mean_action_processing_ms": 0.1334056894688651, "mean_env_wait_ms": 0.22750160554441423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030325651168823242, "StateBufferConnector_ms": 0.0022901296615600586, "ViewRequirementAgentConnector_ms": 0.052173495292663574}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 792.2561722180394, "num_env_steps_trained_throughput_per_sec": 792.2561722180394, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 5119.071, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5119.036, "sample_time_ms": 777.217, "learn_time_ms": 4331.828, "learn_throughput": 923.398, "synch_weights_time_ms": 9.675}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 147, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-18", "timestamp": 1723386558, "time_this_iter_s": 5.051554203033447, "time_total_s": 759.9431936740875, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 759.9431936740875, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 28.6, "ram_util_percent": 77.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.029494127941628, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.02472010863324, "policy_loss": -0.0051643838155238575, "vf_loss": 3.029017485429843, "vf_explained_var": -0.0009978810946146648, "kl": 0.013516396341642773, "entropy": 1.1085486050695181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9957299674550693, "cur_kl_coeff": 8.950792107498271e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0601889242728553, "policy_loss": -0.0005623651942490445, "vf_loss": 3.060751297324896, "vf_explained_var": -0.013628012376526992, "kl": 0.0016250733570415097, "entropy": 0.21681671716893713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 348.39, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34839, "policy_reward_min": {"prey_policy": -44.42254665424802, "predator_policy": -23.060508343367026}, "policy_reward_max": {"prey_policy": 23.060508343367026, "predator_policy": 44.42254665424802}, "policy_reward_mean": {"prey_policy": -12.453820045664884, "predator_policy": 12.453820045664884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 393, 400, 400, 400, 400, 400, 226, 400, 400, 400, 400, 173, 232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [8.115567645047516, -19.40273245450293, 4.05590099411862, -9.717743371568066, -0.763504738840318, 1.0538231895552315, -20.678299120024654, -20.569372383613334, -19.41750816151015, -20.948606402128924, -6.865053174361449, -29.547996983485945, -10.833811240079726, -7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165], "policy_predator_policy_reward": [-8.115567645047516, 19.40273245450293, -4.05590099411862, 9.717743371568066, 0.763504738840318, -1.0538231895552315, 20.678299120024654, 20.569372383613334, 19.41750816151015, 20.948606402128924, 6.865053174361449, 29.547996983485945, 10.833811240079726, 7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3059272557042833, "mean_inference_ms": 1.0160222245480475, "mean_action_processing_ms": 0.13336903208687179, "mean_env_wait_ms": 0.2275156714073246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030046701431274414, "StateBufferConnector_ms": 0.0022939443588256836, "ViewRequirementAgentConnector_ms": 0.060364484786987305}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 764.5972993478607, "num_env_steps_trained_throughput_per_sec": 764.5972993478607, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 5118.244, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5118.212, "sample_time_ms": 762.507, "learn_time_ms": 4345.68, "learn_throughput": 920.454, "synch_weights_time_ms": 9.713}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 148, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-24", "timestamp": 1723386564, "time_this_iter_s": 5.23418116569519, "time_total_s": 765.1773748397827, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2264790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 765.1773748397827, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 33.857142857142854, "ram_util_percent": 78.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.680287457505862, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8793937106927237, "policy_loss": -0.0034953903644539728, "vf_loss": 3.8820270476241907, "vf_explained_var": 0.013970140181481839, "kl": 0.013439160684662946, "entropy": 1.0727849560479323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.627262235370775, "cur_kl_coeff": 4.4753960537491355e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9849916393558185, "policy_loss": -0.0006399088587689523, "vf_loss": 3.985631540417671, "vf_explained_var": 0.004587034446497758, "kl": 0.0025984498739761125, "entropy": 0.21450611726225663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 345.15, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34515, "policy_reward_min": {"prey_policy": -44.42254665424802, "predator_policy": -29.000542630231912}, "policy_reward_max": {"prey_policy": 29.000542630231912, "predator_policy": 44.42254665424802}, "policy_reward_mean": {"prey_policy": -11.824912512622996, "predator_policy": 11.824912512622996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [232, 154, 169, 400, 308, 400, 400, 400, 32, 400, 400, 241, 400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400], "policy_prey_policy_reward": [-7.3847593219312495, -11.98616876112646, -11.94226823741226, -15.182679481095715, -26.6954586968482, 3.9620167697088338, 1.6898237252324755, -22.27899622213001, -4.884886353780773, -0.4019648767716575, -13.883312016850045, -44.42254665424802, -24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718], "policy_predator_policy_reward": [7.3847593219312495, 11.98616876112646, 11.94226823741226, 15.182679481095715, 26.6954586968482, -3.9620167697088338, -1.6898237252324755, 22.27899622213001, 4.884886353780773, 0.4019648767716575, 13.883312016850045, 44.42254665424802, 24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30562399405257573, "mean_inference_ms": 1.0157469059639699, "mean_action_processing_ms": 0.13328019523719245, "mean_env_wait_ms": 0.22735994506962168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002985358238220215, "StateBufferConnector_ms": 0.002320528030395508, "ViewRequirementAgentConnector_ms": 0.05996501445770264}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 752.9873717246178, "num_env_steps_trained_throughput_per_sec": 752.9873717246178, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1192000, "timers": {"training_iteration_time_ms": 5136.09, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5136.058, "sample_time_ms": 765.368, "learn_time_ms": 4360.567, "learn_throughput": 917.312, "synch_weights_time_ms": 9.81}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "done": false, "training_iteration": 149, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-29", "timestamp": 1723386569, "time_this_iter_s": 5.315076112747192, "time_total_s": 770.4924509525299, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 770.4924509525299, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 33.8375, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6635874250903724, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5823665007948877, "policy_loss": -0.0044683044199094486, "vf_loss": 3.5862708732485773, "vf_explained_var": 0.015229539386928082, "kl": 0.008791613201183823, "entropy": 1.1240346226841211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6637516373147565, "cur_kl_coeff": 2.2376980268745677e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6161899606386823, "policy_loss": -0.0016669635757959138, "vf_loss": 3.617856935411692, "vf_explained_var": 0.05007074481497208, "kl": 0.005251733147658985, "entropy": 0.3152321317543586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 346.05, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34605, "policy_reward_min": {"prey_policy": -43.77649962483622, "predator_policy": -29.000542630231912}, "policy_reward_max": {"prey_policy": 29.000542630231912, "predator_policy": 43.77649962483622}, "policy_reward_mean": {"prey_policy": -11.00216060364946, "predator_policy": 11.00216060364946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 246, 400, 400, 400, 400, 90, 400, 400, 400, 400, 400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153], "policy_prey_policy_reward": [-24.163714757979648, -39.686439225033226, -12.722278090485286, -1.1014071167525543, -19.03461664240878, -13.001681727520717, -5.184097762568714, -19.087464565015637, -34.15765899812851, -20.273890785397057, -22.237511186847378, -13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546], "policy_predator_policy_reward": [24.163714757979648, 39.686439225033226, 12.722278090485286, 1.1014071167525543, 19.03461664240878, 13.001681727520717, 5.184097762568714, 19.087464565015637, 34.15765899812851, 20.273890785397057, 22.237511186847378, 13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3057666475999066, "mean_inference_ms": 1.0152117997546284, "mean_action_processing_ms": 0.1332289883366381, "mean_env_wait_ms": 0.22736928742760498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030857324600219727, "StateBufferConnector_ms": 0.0023213624954223633, "ViewRequirementAgentConnector_ms": 0.0602269172668457}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 766.4617434662684, "num_env_steps_trained_throughput_per_sec": 766.4617434662684, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 5140.222, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5140.189, "sample_time_ms": 762.583, "learn_time_ms": 4367.467, "learn_throughput": 915.863, "synch_weights_time_ms": 9.822}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 150, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-34", "timestamp": 1723386574, "time_this_iter_s": 5.22146201133728, "time_total_s": 775.7139129638672, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2264700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 775.7139129638672, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 33.01428571428572, "ram_util_percent": 77.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.117613649678727, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.285977201660474, "policy_loss": -0.005720897387800505, "vf_loss": 4.290943339218696, "vf_explained_var": 0.004541459865868092, "kl": 0.011766607561055053, "entropy": 1.0952527767668168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0356455420454345, "cur_kl_coeff": 2.2376980268745677e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.268699550131957, "policy_loss": -0.0007091457819721352, "vf_loss": 4.269408695648114, "vf_explained_var": 0.02606203587104877, "kl": 0.0015428136992320014, "entropy": 0.25279307512876886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 350.08, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35008, "policy_reward_min": {"prey_policy": -43.77649962483622, "predator_policy": -29.000542630231912}, "policy_reward_max": {"prey_policy": 29.000542630231912, "predator_policy": 43.77649962483622}, "policy_reward_mean": {"prey_policy": -10.608447160255459, "predator_policy": 10.608447160255459}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 200, 400, 367, 240, 400, 400, 400, 400, 400, 400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400], "policy_prey_policy_reward": [-13.953974263497564, -22.007146828533465, -24.09527705794205, 2.077465259776197, -15.649487943197919, -5.662037494851571, -26.97518188003206, -5.696381988575535, -16.988500582136588, -4.0909189077065555, -14.740655246575148, 22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887], "policy_predator_policy_reward": [13.953974263497564, 22.007146828533465, 24.09527705794205, -2.077465259776197, 15.649487943197919, 5.662037494851571, 26.97518188003206, 5.696381988575535, 16.988500582136588, 4.0909189077065555, 14.740655246575148, -22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3056944706350401, "mean_inference_ms": 1.0150806102351766, "mean_action_processing_ms": 0.13317672157044, "mean_env_wait_ms": 0.22730594831121412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003047347068786621, "StateBufferConnector_ms": 0.002184152603149414, "ViewRequirementAgentConnector_ms": 0.05972146987915039}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.1051947547762, "num_env_steps_trained_throughput_per_sec": 805.1051947547762, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1208000, "timers": {"training_iteration_time_ms": 5101.996, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5101.964, "sample_time_ms": 760.92, "learn_time_ms": 4331.179, "learn_throughput": 923.536, "synch_weights_time_ms": 9.564}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "done": false, "training_iteration": 151, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-39", "timestamp": 1723386579, "time_this_iter_s": 4.970928907394409, "time_total_s": 780.6848418712616, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22069d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 780.6848418712616, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 31.585714285714282, "ram_util_percent": 77.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4706955599288145, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5850292768950265, "policy_loss": -0.0016496097853329653, "vf_loss": 2.5862774146099885, "vf_explained_var": 0.046840759739279744, "kl": 0.006258769588401787, "entropy": 1.1474195051938296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4268285179821154, "cur_kl_coeff": 1.1188490134372839e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.576594499250253, "policy_loss": -0.0002854652499081567, "vf_loss": 2.5768799733370544, "vf_explained_var": 0.008073720522224903, "kl": 0.0026902451481994106, "entropy": 0.2517714484905203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 352.88, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35288, "policy_reward_min": {"prey_policy": -43.77649962483622, "predator_policy": -29.000542630231912}, "policy_reward_max": {"prey_policy": 29.000542630231912, "predator_policy": 43.77649962483622}, "policy_reward_mean": {"prey_policy": -9.430074490299866, "predator_policy": 9.430074490299866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 319, 400, 400, 338, 400, 386, 104, 400, 329, 400, 164, 400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400], "policy_prey_policy_reward": [22.372747847546226, -8.14681258269411, -10.27146884084084, -36.68175653888853, -43.77649962483622, -39.317400960042555, -43.36698210883286, -7.104932343425851, -12.614364302784587, -15.924349365632267, -12.792972720195039, -16.884621493760868, -9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642], "policy_predator_policy_reward": [-22.372747847546226, 8.14681258269411, 10.27146884084084, 36.68175653888853, 43.77649962483622, 39.317400960042555, 43.36698210883286, 7.104932343425851, 12.614364302784587, 15.924349365632267, 12.792972720195039, 16.884621493760868, 9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054892902176338, "mean_inference_ms": 1.0149656971554741, "mean_action_processing_ms": 0.13316122955354848, "mean_env_wait_ms": 0.22722258206568186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003002643585205078, "StateBufferConnector_ms": 0.0021761655807495117, "ViewRequirementAgentConnector_ms": 0.0579991340637207}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 783.7292850688997, "num_env_steps_trained_throughput_per_sec": 783.7292850688997, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 5106.003, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5105.973, "sample_time_ms": 764.785, "learn_time_ms": 4331.266, "learn_throughput": 923.518, "synch_weights_time_ms": 9.622}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 152, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-44", "timestamp": 1723386584, "time_this_iter_s": 5.106372117996216, "time_total_s": 785.7912139892578, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 785.7912139892578, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 31.214285714285715, "ram_util_percent": 78.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8627713474134606, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.963056143373251, "policy_loss": -0.004485752809947978, "vf_loss": 3.96689311042428, "vf_explained_var": -0.02623410156617562, "kl": 0.010114266192607054, "entropy": 1.0096249866609772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.981088743669291, "cur_kl_coeff": 5.5942450671864194e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9061368234455585, "policy_loss": 0.0011989737484933963, "vf_loss": 3.904937840004762, "vf_explained_var": -0.0915816600744923, "kl": 0.0011104748286916294, "entropy": 0.20216876526052754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 356.26, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35626, "policy_reward_min": {"prey_policy": -41.26637812732587, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.26637812732587}, "policy_reward_mean": {"prey_policy": -6.893232272973284, "predator_policy": 6.893232272973284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 334, 400, 112, 400, 400, 400, 400, 212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400], "policy_prey_policy_reward": [-9.646198215811403, 1.0501268217332473, -19.089427867929988, -39.90409363308177, -24.57827284699418, -9.02735733146037, -8.419681030135983, 1.9837843933871984, -21.374715404122306, -31.239206765022175, -15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316], "policy_predator_policy_reward": [9.646198215811403, -1.0501268217332473, 19.089427867929988, 39.90409363308177, 24.57827284699418, 9.02735733146037, 8.419681030135983, -1.9837843933871984, 21.374715404122306, 31.239206765022175, 15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30529680359631345, "mean_inference_ms": 1.0147218512753782, "mean_action_processing_ms": 0.13313534514190045, "mean_env_wait_ms": 0.22706112740242165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029715299606323242, "StateBufferConnector_ms": 0.002146124839782715, "ViewRequirementAgentConnector_ms": 0.05723226070404053}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.8075785321373, "num_env_steps_trained_throughput_per_sec": 749.8075785321373, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 5144.797, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5144.766, "sample_time_ms": 768.752, "learn_time_ms": 4365.924, "learn_throughput": 916.186, "synch_weights_time_ms": 9.782}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 153, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-50", "timestamp": 1723386590, "time_this_iter_s": 5.338234901428223, "time_total_s": 791.129448890686, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 791.129448890686, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 36.1375, "ram_util_percent": 78.13749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.957670669009288, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.80294663036863, "policy_loss": -0.0032292665064839335, "vf_loss": 2.805862756818533, "vf_explained_var": 0.0009617924690246582, "kl": 0.004881772295718179, "entropy": 0.9479154865567883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.073128377335767, "cur_kl_coeff": 2.7971225335932097e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.769088528677821, "policy_loss": -0.001318937290731507, "vf_loss": 2.7704074675838153, "vf_explained_var": 0.16650969572365285, "kl": 0.0020706663182015936, "entropy": 0.11640511415122698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 357.27, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35727, "policy_reward_min": {"prey_policy": -41.26637812732587, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.26637812732587}, "policy_reward_mean": {"prey_policy": -6.567610735424996, "predator_policy": 6.567610735424996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [212, 400, 400, 400, 79, 400, 328, 292, 400, 400, 359, 400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-15.021031857373295, -38.50151343328484, -11.253376155337811, 12.941401590375666, -17.073831451207692, 9.250291366071476, -10.16045739680651, -19.622028586445683, -15.823595100598766, 7.228477174251353, -39.102718701042484, -13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443], "policy_predator_policy_reward": [15.021031857373295, 38.50151343328484, 11.253376155337811, -12.941401590375666, 17.073831451207692, -9.250291366071476, 10.16045739680651, 19.622028586445683, 15.823595100598766, -7.228477174251353, 39.102718701042484, 13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.305249050879741, "mean_inference_ms": 1.0144728492917168, "mean_action_processing_ms": 0.13308395537487472, "mean_env_wait_ms": 0.22704119151671687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029604434967041016, "StateBufferConnector_ms": 0.002130270004272461, "ViewRequirementAgentConnector_ms": 0.056824326515197754}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 784.3010907006799, "num_env_steps_trained_throughput_per_sec": 784.3010907006799, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 5140.588, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5140.557, "sample_time_ms": 763.074, "learn_time_ms": 4367.364, "learn_throughput": 915.884, "synch_weights_time_ms": 9.803}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 154, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-29-55", "timestamp": 1723386595, "time_this_iter_s": 5.10285210609436, "time_total_s": 796.2323009967804, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22069d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 796.2323009967804, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 31.32857142857143, "ram_util_percent": 78.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3111842956393955, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8893463651339215, "policy_loss": -0.006764738309478465, "vf_loss": 3.895776603122552, "vf_explained_var": 0.18422144999106724, "kl": 0.010429516075564244, "entropy": 1.0231870381782453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2103552028536795, "cur_kl_coeff": 1.3985612667966048e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.688713099807501, "policy_loss": -0.0009401068678319764, "vf_loss": 3.6896531929572425, "vf_explained_var": 0.2347080913061897, "kl": 0.003104031915862798, "entropy": 0.16790803967354198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 359.25, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35925, "policy_reward_min": {"prey_policy": -41.26637812732587, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.26637812732587}, "policy_reward_mean": {"prey_policy": -5.905571825079364, "predator_policy": 5.905571825079364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 272, 400, 400, 400, 400, 400, 400, 400, 351, 400, 400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400], "policy_prey_policy_reward": [-13.32861138029503, -14.094957581180186, 0.023784885432156955, 2.144698093986875, 3.3298033161770952, 4.360553376060954, -30.785329012004667, 1.907036669418619, 23.060508343367026, -16.859677752274344, 16.082046347326468, 18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696], "policy_predator_policy_reward": [13.32861138029503, 14.094957581180186, -0.023784885432156955, -2.144698093986875, -3.3298033161770952, -4.360553376060954, 30.785329012004667, -1.907036669418619, -23.060508343367026, 16.859677752274344, -16.082046347326468, -18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3051083590100702, "mean_inference_ms": 1.0141419670400011, "mean_action_processing_ms": 0.13308258631764308, "mean_env_wait_ms": 0.22694962406558866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002933025360107422, "StateBufferConnector_ms": 0.002106904983520508, "ViewRequirementAgentConnector_ms": 0.05603682994842529}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.2658062667548, "num_env_steps_trained_throughput_per_sec": 802.2658062667548, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 5133.178, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5133.145, "sample_time_ms": 756.913, "learn_time_ms": 4366.085, "learn_throughput": 916.153, "synch_weights_time_ms": 9.832}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 155, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-00", "timestamp": 1723386600, "time_this_iter_s": 4.988475799560547, "time_total_s": 801.2207767963409, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a9280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 801.2207767963409, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 35.08571428571428, "ram_util_percent": 78.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3353376209114987, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.289936604971687, "policy_loss": -0.006565263042284641, "vf_loss": 3.296049289156993, "vf_explained_var": 0.18630594226221245, "kl": 0.014111338230541774, "entropy": 1.1122109567125638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3242863192533454, "cur_kl_coeff": 6.992806333983024e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4426099114120006, "policy_loss": 0.0009868427155500588, "vf_loss": 3.441623068600893, "vf_explained_var": 0.07960342007378737, "kl": 0.0025055381083375155, "entropy": 0.2160477363038808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 356.9, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35690, "policy_reward_min": {"prey_policy": -41.26637812732587, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.26637812732587}, "policy_reward_mean": {"prey_policy": -7.347562542720924, "predator_policy": 7.347562542720924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 111, 221, 257, 400, 400, 400, 400, 400, 400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400], "policy_prey_policy_reward": [18.224983414296716, -12.235888591463874, -24.458607640859405, -19.510989239363997, -3.2367607557181657, -14.813229308557151, -6.213418431368815, 13.84427057667881, 6.434011689133165, 1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528], "policy_predator_policy_reward": [-18.224983414296716, 12.235888591463874, 24.458607640859405, 19.510989239363997, 3.2367607557181657, 14.813229308557151, 6.213418431368815, -13.84427057667881, -6.434011689133165, -1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3049564737633528, "mean_inference_ms": 1.0138978279867796, "mean_action_processing_ms": 0.1330236580787087, "mean_env_wait_ms": 0.22686683008762773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002909064292907715, "StateBufferConnector_ms": 0.002235889434814453, "ViewRequirementAgentConnector_ms": 0.0562213659286499}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.0464670635014, "num_env_steps_trained_throughput_per_sec": 797.0464670635014, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 5132.27, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5132.238, "sample_time_ms": 753.765, "learn_time_ms": 4368.274, "learn_throughput": 915.693, "synch_weights_time_ms": 9.883}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 156, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-05", "timestamp": 1723386605, "time_this_iter_s": 5.021305084228516, "time_total_s": 806.2420818805695, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 806.2420818805695, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 30.9625, "ram_util_percent": 78.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4118840572113793, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8130000598728655, "policy_loss": -0.00738376428829118, "vf_loss": 2.8197201689084372, "vf_explained_var": 0.185420302922527, "kl": 0.020692405475725883, "entropy": 0.9987760203580062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.489597541404267, "cur_kl_coeff": 3.496403166991512e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.747349134956797, "policy_loss": -0.002347231862222543, "vf_loss": 2.7496963664889336, "vf_explained_var": 0.181523958966136, "kl": 0.0028388751275206475, "entropy": 0.15679845404811205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.01, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36301, "policy_reward_min": {"prey_policy": -41.26637812732587, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.26637812732587}, "policy_reward_mean": {"prey_policy": -8.055936370668757, "predator_policy": 8.055936370668757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 235, 400, 400, 400, 400, 128, 105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.3121167882088365, -4.303263205763502, -28.280002601172214, 11.46006640174064, -22.658748476157967, 5.435129320645284, -14.159974116228085, 1.1837388313708104, 2.897395719466978, -22.62513805238993, -20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259], "policy_predator_policy_reward": [-1.3121167882088365, 4.303263205763502, 28.280002601172214, -11.46006640174064, 22.658748476157967, -5.435129320645284, 14.159974116228085, -1.1837388313708104, -2.897395719466978, 22.62513805238993, 20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3048272140873204, "mean_inference_ms": 1.0137603196979916, "mean_action_processing_ms": 0.1330364469888754, "mean_env_wait_ms": 0.2266847840874746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028957128524780273, "StateBufferConnector_ms": 0.0022280216217041016, "ViewRequirementAgentConnector_ms": 0.047751665115356445}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.2802311505187, "num_env_steps_trained_throughput_per_sec": 802.2802311505187, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1256000, "timers": {"training_iteration_time_ms": 5125.962, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5125.929, "sample_time_ms": 747.086, "learn_time_ms": 4368.634, "learn_throughput": 915.618, "synch_weights_time_ms": 9.894}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "done": false, "training_iteration": 157, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-10", "timestamp": 1723386610, "time_this_iter_s": 4.988520860671997, "time_total_s": 811.2306027412415, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 811.2306027412415, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 29.81428571428572, "ram_util_percent": 78.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2524961962364616, "cur_kl_coeff": 0.04810845963656903, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4084567135820785, "policy_loss": -0.005489684614925257, "vf_loss": 3.4134485573818285, "vf_explained_var": 0.2278363970418771, "kl": 0.010347961909667592, "entropy": 1.0483388635640343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2210568747172754, "cur_kl_coeff": 1.748201583495756e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.416063731412093, "policy_loss": -0.0013575011643600495, "vf_loss": 3.4174212463200093, "vf_explained_var": 0.2224945738290747, "kl": 0.006432693714492972, "entropy": 0.2771544000444313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 367.38, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36738, "policy_reward_min": {"prey_policy": -41.26637812732587, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.26637812732587}, "policy_reward_mean": {"prey_policy": -7.732526513274388, "predator_policy": 7.732526513274388}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [105, 400, 400, 173, 400, 38, 400, 178, 400, 400, 400, 400, 400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-20.111269150988775, 29.000542630231912, -21.779176986168718, -8.360839222148206, 27.287391890968234, -18.366935652573286, 2.5488130689296042, -23.817180839994194, -4.77414981652638, 12.571404665541365, 7.197000439192966, -28.22709823138504, 20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457], "policy_predator_policy_reward": [20.111269150988775, -29.000542630231912, 21.779176986168718, 8.360839222148206, -27.287391890968234, 18.366935652573286, -2.5488130689296042, 23.817180839994194, 4.77414981652638, -12.571404665541365, -7.197000439192966, 28.22709823138504, -20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30480390701349674, "mean_inference_ms": 1.013315086478815, "mean_action_processing_ms": 0.13298856179003857, "mean_env_wait_ms": 0.22668151655094476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002867579460144043, "StateBufferConnector_ms": 0.0022252798080444336, "ViewRequirementAgentConnector_ms": 0.04748845100402832}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.3256192083568, "num_env_steps_trained_throughput_per_sec": 802.3256192083568, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 5101.361, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5101.329, "sample_time_ms": 743.433, "learn_time_ms": 4347.759, "learn_throughput": 920.014, "synch_weights_time_ms": 9.819}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 158, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-15", "timestamp": 1723386615, "time_this_iter_s": 4.9880688190460205, "time_total_s": 816.2186715602875, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 816.2186715602875, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 30.685714285714283, "ram_util_percent": 78.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3427974369376896, "cur_kl_coeff": 0.04810845963656903, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.572657066086928, "policy_loss": -0.00699949778742545, "vf_loss": 3.5791238149007163, "vf_explained_var": -0.030537505882481733, "kl": 0.011074046617930332, "entropy": 0.8489284101252754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.140054824327429, "cur_kl_coeff": 1.748201583495756e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5655472688376904, "policy_loss": -0.001539423402088384, "vf_loss": 3.567086703454455, "vf_explained_var": -0.05084468169758717, "kl": 0.0031631682692900395, "entropy": 0.1536094558580468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 371.94, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37194, "policy_reward_min": {"prey_policy": -41.26637812732587, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.26637812732587}, "policy_reward_mean": {"prey_policy": -7.752946683480091, "predator_policy": 7.752946683480091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 284, 153, 400, 385, 400, 400, 400, 400, 354, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.3101390614474, -34.28427038564684, -23.220284207705546, -21.74383013713358, -14.465142486055285, -41.26637812732587, -17.841999272556247, -5.900478135917794, -2.1009852023159326, -24.87073019501259, 2.212761403269351, 9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544], "policy_predator_policy_reward": [-20.3101390614474, 34.28427038564684, 23.220284207705546, 21.74383013713358, 14.465142486055285, 41.26637812732587, 17.841999272556247, 5.900478135917794, 2.1009852023159326, 24.87073019501259, -2.212761403269351, -9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30463548640481597, "mean_inference_ms": 1.012884530886568, "mean_action_processing_ms": 0.1329127700304796, "mean_env_wait_ms": 0.2265665209166087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028295516967773438, "StateBufferConnector_ms": 0.002158045768737793, "ViewRequirementAgentConnector_ms": 0.04732620716094971}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.8892836845871, "num_env_steps_trained_throughput_per_sec": 789.8892836845871, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 5076.544, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5076.512, "sample_time_ms": 739.495, "learn_time_ms": 4326.962, "learn_throughput": 924.436, "synch_weights_time_ms": 9.739}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 159, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-20", "timestamp": 1723386620, "time_this_iter_s": 5.066778898239136, "time_total_s": 821.2854504585266, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 821.2854504585266, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 31.414285714285715, "ram_util_percent": 78.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0076985568429033, "cur_kl_coeff": 0.04810845963656903, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9576802656054495, "policy_loss": -0.010737065123491145, "vf_loss": 2.9673584724466004, "vf_explained_var": 0.1441852134341995, "kl": 0.022009714273265226, "entropy": 0.833996079924206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.079849526161949, "cur_kl_coeff": 8.74100791747878e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9722417261451484, "policy_loss": -0.0016995238581633506, "vf_loss": 2.9739412480344374, "vf_explained_var": 0.1506282600884636, "kl": 0.0028204375107497032, "entropy": 0.2279813646649321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.87, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36987, "policy_reward_min": {"prey_policy": -41.06519264085363, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.06519264085363}, "policy_reward_mean": {"prey_policy": -7.2453221488066095, "predator_policy": 7.2453221488066095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141], "policy_prey_policy_reward": [9.431608504237612, -26.41364439016749, -28.320598479759887, -15.38984052320766, 11.233804192413178, -9.3074726383152, -4.172472918465619, -9.1509026522357, -9.44341395388458, 20.653654225718956, -3.119013613192692, 4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726], "policy_predator_policy_reward": [-9.431608504237612, 26.41364439016749, 28.320598479759887, 15.38984052320766, -11.233804192413178, 9.3074726383152, 4.172472918465619, 9.1509026522357, 9.44341395388458, -20.653654225718956, 3.119013613192692, -4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30456225084718475, "mean_inference_ms": 1.0125842462591699, "mean_action_processing_ms": 0.13292218949272913, "mean_env_wait_ms": 0.2264142987626706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027505159378051758, "StateBufferConnector_ms": 0.002135038375854492, "ViewRequirementAgentConnector_ms": 0.04650378227233887}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 737.2752552305352, "num_env_steps_trained_throughput_per_sec": 737.2752552305352, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 5097.204, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5097.172, "sample_time_ms": 756.555, "learn_time_ms": 4330.616, "learn_throughput": 923.656, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 160, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-25", "timestamp": 1723386625, "time_this_iter_s": 5.427939176559448, "time_total_s": 826.7133896350861, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 826.7133896350861, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 35.9875, "ram_util_percent": 78.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1725939591725667, "cur_kl_coeff": 0.07216268945485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2088940712312857, "policy_loss": -0.003176621633610921, "vf_loss": 3.211265437801679, "vf_explained_var": 0.015738263291617236, "kl": 0.011158840854042895, "entropy": 0.9394606216500203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1291168690348665, "cur_kl_coeff": 4.37050395873939e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.163361532861988, "policy_loss": -0.0009351104876259342, "vf_loss": 3.164296645174424, "vf_explained_var": 0.025304044224321844, "kl": 0.0011869988674048277, "entropy": 0.21783827911131085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 367.67, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36767, "policy_reward_min": {"prey_policy": -41.06519264085363, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.06519264085363}, "policy_reward_mean": {"prey_policy": -7.373974830363633, "predator_policy": 7.373974830363633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400], "policy_prey_policy_reward": [4.44557185715205, -8.678174230506698, -7.016569683188642, 12.190838538824611, -6.9479087147133995, 20.063528813798712, 15.435088650461239, -10.512876663037488, 0.08593542857475711, 19.297917848734294, -18.106342247708156, 33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037], "policy_predator_policy_reward": [-4.44557185715205, 8.678174230506698, 7.016569683188642, -12.190838538824611, 6.9479087147133995, -20.063528813798712, -15.435088650461239, 10.512876663037488, -0.08593542857475711, -19.297917848734294, 18.106342247708156, -33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.304524594770385, "mean_inference_ms": 1.01241764389483, "mean_action_processing_ms": 0.1328823299865184, "mean_env_wait_ms": 0.2262840163037188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002771139144897461, "StateBufferConnector_ms": 0.0021376609802246094, "ViewRequirementAgentConnector_ms": 0.049462318420410156}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 744.6343587010693, "num_env_steps_trained_throughput_per_sec": 744.6343587010693, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1288000, "timers": {"training_iteration_time_ms": 5137.55, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5137.519, "sample_time_ms": 760.628, "learn_time_ms": 4366.734, "learn_throughput": 916.016, "synch_weights_time_ms": 9.84}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "done": false, "training_iteration": 161, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-31", "timestamp": 1723386631, "time_this_iter_s": 5.3756608963012695, "time_total_s": 832.0890505313873, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 832.0890505313873, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 35.214285714285715, "ram_util_percent": 78.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3952282400180898, "cur_kl_coeff": 0.07216268945485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.891572088872393, "policy_loss": -0.0009909048180513007, "vf_loss": 2.8920069554199777, "vf_explained_var": 0.12364103719592094, "kl": 0.0077052694002616795, "entropy": 0.7759435643752416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2643297174324593, "cur_kl_coeff": 2.185251979369695e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8513136754433313, "policy_loss": -0.0006828412127409441, "vf_loss": 2.8519965143253407, "vf_explained_var": 0.12257270800570647, "kl": 0.00142593856379619, "entropy": 0.18094129587213198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 368.46, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36846, "policy_reward_min": {"prey_policy": -41.06519264085363, "predator_policy": -33.096013633079686}, "policy_reward_max": {"prey_policy": 33.096013633079686, "predator_policy": 41.06519264085363}, "policy_reward_mean": {"prey_policy": -8.275327901788236, "predator_policy": 8.275327901788236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 269, 109, 400, 400, 400, 192, 355, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [33.096013633079686, -21.310709767776324, -6.632493307742974, -7.484183514224316, -2.6161692961632, -28.256263413929467, -22.763965920233083, -25.557886221649397, -14.778973806626972, -1.6163872766202907, -18.390993074037837, 5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845], "policy_predator_policy_reward": [-33.096013633079686, 21.310709767776324, 6.632493307742974, 7.484183514224316, 2.6161692961632, 28.256263413929467, 22.763965920233083, 25.557886221649397, 14.778973806626972, 1.6163872766202907, 18.390993074037837, -5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3045687105412053, "mean_inference_ms": 1.0120018678454366, "mean_action_processing_ms": 0.1327931290145776, "mean_env_wait_ms": 0.226270038820935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002797722816467285, "StateBufferConnector_ms": 0.002152681350708008, "ViewRequirementAgentConnector_ms": 0.04987335205078125}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 731.8561490414561, "num_env_steps_trained_throughput_per_sec": 731.8561490414561, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 5173.726, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5173.693, "sample_time_ms": 764.803, "learn_time_ms": 4398.654, "learn_throughput": 909.369, "synch_weights_time_ms": 9.91}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 162, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-36", "timestamp": 1723386636, "time_this_iter_s": 5.493319988250732, "time_total_s": 837.5823705196381, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22069d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 837.5823705196381, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 37.037499999999994, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9458277886733413, "cur_kl_coeff": 0.07216268945485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.911543936530749, "policy_loss": -0.003533002975746058, "vf_loss": 2.9146949335932733, "vf_explained_var": 0.10627956135819355, "kl": 0.0052936518975178854, "entropy": 0.785569443864127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.781493236062427, "cur_kl_coeff": 1.0926259896848475e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.90089403167367, "policy_loss": -0.0006012553555289438, "vf_loss": 2.9014952776332694, "vf_explained_var": 0.11323062597463528, "kl": 0.001092633303867442, "entropy": 0.14668402013679346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.19, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36919, "policy_reward_min": {"prey_policy": -41.06519264085363, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 41.06519264085363}, "policy_reward_mean": {"prey_policy": -7.505186719650578, "predator_policy": 7.505186719650578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 159, 400, 400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.450038318164793, -16.114321677210004, -3.037965756303443, 13.582120898489453, -14.542430370738883, 2.6187305776809424, -29.01001842497648, 10.459990402033277, -18.59067028612701, -6.318844628806602, 5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825], "policy_predator_policy_reward": [-5.450038318164793, 16.114321677210004, 3.037965756303443, -13.582120898489453, 14.542430370738883, -2.6187305776809424, 29.01001842497648, -10.459990402033277, 18.59067028612701, 6.318844628806602, -5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30466114145738216, "mean_inference_ms": 1.011945771317806, "mean_action_processing_ms": 0.1328551532501365, "mean_env_wait_ms": 0.22614352013296707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002785801887512207, "StateBufferConnector_ms": 0.0021191835403442383, "ViewRequirementAgentConnector_ms": 0.05031180381774902}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.6974161447134, "num_env_steps_trained_throughput_per_sec": 774.6974161447134, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1304000, "timers": {"training_iteration_time_ms": 5156.586, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5156.552, "sample_time_ms": 772.235, "learn_time_ms": 4374.273, "learn_throughput": 914.438, "synch_weights_time_ms": 9.726}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "done": false, "training_iteration": 163, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-42", "timestamp": 1723386642, "time_this_iter_s": 5.166002988815308, "time_total_s": 842.7483735084534, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 842.7483735084534, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 32.525, "ram_util_percent": 78.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9029361454149085, "cur_kl_coeff": 0.07216268945485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3758400834475952, "policy_loss": -0.007857478384418451, "vf_loss": 2.3828516506279507, "vf_explained_var": 0.026893144162992638, "kl": 0.01172231649907663, "entropy": 0.8379366551836331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8140091660742956, "cur_kl_coeff": 5.4631299484242377e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4144463017582893, "policy_loss": -0.0014522145148172664, "vf_loss": 2.415898515967031, "vf_explained_var": 0.035618182520071665, "kl": 0.0015786197222768517, "entropy": 0.19608272691257297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 371.6, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37160, "policy_reward_min": {"prey_policy": -41.06519264085363, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 41.06519264085363}, "policy_reward_mean": {"prey_policy": -7.541099652112609, "predator_policy": 7.541099652112609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 109, 400, 400, 400, 400, 400, 219, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.444319965679579, -17.19431710236196, -2.0464029779400477, -15.336969569767696, -22.025114100631882, -22.559828492832207, -14.687871282258683, -26.848376145538168, -21.507043374699204, -3.006619962769282, -5.898285286116007, -11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014], "policy_predator_policy_reward": [-5.444319965679579, 17.19431710236196, 2.0464029779400477, 15.336969569767696, 22.025114100631882, 22.559828492832207, 14.687871282258683, 26.848376145538168, 21.507043374699204, 3.006619962769282, 5.898285286116007, 11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3046324438410585, "mean_inference_ms": 1.0117427622501, "mean_action_processing_ms": 0.13282462822806854, "mean_env_wait_ms": 0.2260719427262766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002784252166748047, "StateBufferConnector_ms": 0.002100229263305664, "ViewRequirementAgentConnector_ms": 0.04990339279174805}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 792.3812229840777, "num_env_steps_trained_throughput_per_sec": 792.3812229840777, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 5151.385, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5151.352, "sample_time_ms": 765.298, "learn_time_ms": 4375.982, "learn_throughput": 914.081, "synch_weights_time_ms": 9.76}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 164, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-47", "timestamp": 1723386647, "time_this_iter_s": 5.050727367401123, "time_total_s": 847.7991008758545, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 847.7991008758545, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 31.24285714285714, "ram_util_percent": 78.22857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8771077734728654, "cur_kl_coeff": 0.07216268945485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6535620152950288, "policy_loss": -0.004473931742298495, "vf_loss": 1.6571593450382351, "vf_explained_var": 0.3427137722571691, "kl": 0.012147629027909926, "entropy": 0.870967510715127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.807380811870098, "cur_kl_coeff": 2.7315649742121188e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.631121092910568, "policy_loss": -0.002433538837552381, "vf_loss": 1.6335546351969241, "vf_explained_var": 0.348187860660255, "kl": 0.00468052047533792, "entropy": 0.21210391780671975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 372.67, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37267, "policy_reward_min": {"prey_policy": -41.06519264085363, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 41.06519264085363}, "policy_reward_mean": {"prey_policy": -7.005547681724473, "predator_policy": 7.005547681724473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-11.766328903121146, -6.47515089856482, -27.37863377626324, -6.205964235346528, -23.848709272021452, -35.53198157679975, -15.08328115105688, -8.26276766044855, 2.7670527552743245, -18.135880057864334, 14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902], "policy_predator_policy_reward": [11.766328903121146, 6.47515089856482, 27.37863377626324, 6.205964235346528, 23.848709272021452, 35.53198157679975, 15.08328115105688, 8.26276766044855, -2.7670527552743245, 18.135880057864334, -14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30462987531106495, "mean_inference_ms": 1.0114359097649377, "mean_action_processing_ms": 0.1327652841598246, "mean_env_wait_ms": 0.22596741268195925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027849674224853516, "StateBufferConnector_ms": 0.001943826675415039, "ViewRequirementAgentConnector_ms": 0.048363566398620605}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.6476266320957, "num_env_steps_trained_throughput_per_sec": 802.6476266320957, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 5151.148, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5151.115, "sample_time_ms": 768.615, "learn_time_ms": 4372.372, "learn_throughput": 914.835, "synch_weights_time_ms": 9.814}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 165, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-52", "timestamp": 1723386652, "time_this_iter_s": 4.986270904541016, "time_total_s": 852.7853717803955, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 852.7853717803955, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 31.8, "ram_util_percent": 78.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.919620219866435, "cur_kl_coeff": 0.07216268945485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5798441614955663, "policy_loss": -0.004134642517116541, "vf_loss": 1.5836512819553414, "vf_explained_var": 0.14358615304032962, "kl": 0.004538643860685796, "entropy": 0.8203420100733638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8144125898368655, "cur_kl_coeff": 1.3657824871060594e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.586113366857171, "policy_loss": 0.0003733518438821193, "vf_loss": 1.5857400089191893, "vf_explained_var": 0.1486492292334636, "kl": 0.002510452447431801, "entropy": 0.3178981855666886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.94, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36994, "policy_reward_min": {"prey_policy": -41.06519264085363, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 41.06519264085363}, "policy_reward_mean": {"prey_policy": -5.417083624990829, "predator_policy": 5.417083624990829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [14.612497806979043, -14.232354355915938, -15.087587570152259, 1.5840851141692482, -10.761911680558857, -15.713309961981778, 11.401525275376382, 15.115445166827403, -10.693140648153616, 0.056088067357745075, 0.15502737942694012, -14.628821595956438, -13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209], "policy_predator_policy_reward": [-14.612497806979043, 14.232354355915938, 15.087587570152259, -1.5840851141692482, 10.761911680558857, 15.713309961981778, -11.401525275376382, -15.115445166827403, 10.693140648153616, -0.056088067357745075, -0.15502737942694012, 14.628821595956438, 13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30469583001255646, "mean_inference_ms": 1.0112500140983942, "mean_action_processing_ms": 0.13277787501879154, "mean_env_wait_ms": 0.22591255106234004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028325319290161133, "StateBufferConnector_ms": 0.0019495487213134766, "ViewRequirementAgentConnector_ms": 0.04883241653442383}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 807.8021016739975, "num_env_steps_trained_throughput_per_sec": 807.8021016739975, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 5144.467, "restore_workers_time_ms": 0.019, "training_step_time_ms": 5144.424, "sample_time_ms": 770.397, "learn_time_ms": 4363.914, "learn_throughput": 916.608, "synch_weights_time_ms": 9.798}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 166, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-30-57", "timestamp": 1723386657, "time_this_iter_s": 4.954249143600464, "time_total_s": 857.739620923996, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 857.739620923996, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 31.64285714285714, "ram_util_percent": 78.25714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.324449127477904, "cur_kl_coeff": 0.03608134472742676, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9274895489836732, "policy_loss": -0.00462115569486438, "vf_loss": 1.9317332786818346, "vf_explained_var": 0.0680102194348971, "kl": 0.010460382192778913, "entropy": 0.9260503555958469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3811498107699056, "cur_kl_coeff": 6.828912435530297e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9567600925142565, "policy_loss": -0.0007582945055522335, "vf_loss": 1.957518379824857, "vf_explained_var": 0.07716646374513705, "kl": 0.00916906962885197, "entropy": 0.5079586273990572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 364.35, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36435, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -5.9701753216101885, "predator_policy": 5.9701753216101885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 57, 400, 400, 93, 400, 400, 400, 400, 400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400], "policy_prey_policy_reward": [-13.912680767349457, 0.2225768771418899, -1.3093855396807825, 6.011549047155931, -17.882545522170865, -35.79311475480418, -10.762135529858046, -3.22384178927491, 7.449310082258712, 8.760243906885329, -20.866194300055298, 17.82405474703616, 0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992], "policy_predator_policy_reward": [13.912680767349457, -0.2225768771418899, 1.3093855396807825, -6.011549047155931, 17.882545522170865, 35.79311475480418, 10.762135529858046, 3.22384178927491, -7.449310082258712, -8.760243906885329, 20.866194300055298, -17.82405474703616, -0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3047414743558994, "mean_inference_ms": 1.0113275120885696, "mean_action_processing_ms": 0.13274357121370087, "mean_env_wait_ms": 0.22588916557592942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002936244010925293, "StateBufferConnector_ms": 0.002081751823425293, "ViewRequirementAgentConnector_ms": 0.051108598709106445}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 788.0497183123731, "num_env_steps_trained_throughput_per_sec": 788.0497183123731, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 1336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1336000, "timers": {"training_iteration_time_ms": 5153.471, "restore_workers_time_ms": 0.019, "training_step_time_ms": 5153.428, "sample_time_ms": 777.315, "learn_time_ms": 4365.949, "learn_throughput": 916.181, "synch_weights_time_ms": 9.845}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "done": false, "training_iteration": 167, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-02", "timestamp": 1723386662, "time_this_iter_s": 5.078856945037842, "time_total_s": 862.8184778690338, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 862.8184778690338, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 31.771428571428572, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.224744949614008, "cur_kl_coeff": 0.03608134472742676, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7095980818072956, "policy_loss": -0.0028247559874823008, "vf_loss": 1.71214616894722, "vf_explained_var": 0.2424648605287075, "kl": 0.007668089370120394, "entropy": 0.7771278526633978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1858457567791145, "cur_kl_coeff": 6.828912435530297e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.700676686068376, "policy_loss": -0.0018204392843472305, "vf_loss": 1.702497132619222, "vf_explained_var": 0.24194419601311287, "kl": 0.01005633817334736, "entropy": 0.39414759737749894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.07, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36607, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -5.8140430453744605, "predator_policy": 5.8140430453744605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 165, 400, 400, 400, 263, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400], "policy_prey_policy_reward": [0.69596854987544, 4.881300224483866, 9.519482867885444, -18.562204403921314, 6.8890067803054365, -19.608384229164244, -4.103921723402092, -41.06519264085363, -5.268378291821641, -20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528], "policy_predator_policy_reward": [-0.69596854987544, -4.881300224483866, -9.519482867885444, 18.562204403921314, -6.8890067803054365, 19.608384229164244, 4.103921723402092, 41.06519264085363, 5.268378291821641, 20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30475888323660594, "mean_inference_ms": 1.0114030857337943, "mean_action_processing_ms": 0.13279401722215847, "mean_env_wait_ms": 0.22573617694051604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030596256256103516, "StateBufferConnector_ms": 0.002135634422302246, "ViewRequirementAgentConnector_ms": 0.05520963668823242}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.857084416221, "num_env_steps_trained_throughput_per_sec": 803.857084416221, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 5152.521, "restore_workers_time_ms": 0.02, "training_step_time_ms": 5152.477, "sample_time_ms": 782.636, "learn_time_ms": 4359.677, "learn_throughput": 917.499, "synch_weights_time_ms": 9.843}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 168, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-07", "timestamp": 1723386667, "time_this_iter_s": 4.978899955749512, "time_total_s": 867.7973778247833, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b40d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 867.7973778247833, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 31.12857142857143, "ram_util_percent": 78.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.160504710239669, "cur_kl_coeff": 0.03608134472742676, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0485576340928673, "policy_loss": -0.002884638561711957, "vf_loss": 1.0512611334833006, "vf_explained_var": 0.1941852318122983, "kl": 0.005020200283896278, "entropy": 0.7116008109102646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.156968716252595, "cur_kl_coeff": 6.828912435530297e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0607201935723425, "policy_loss": -0.0012132828216029643, "vf_loss": 1.0619334743668636, "vf_explained_var": 0.1921222641443213, "kl": 0.004663695195866217, "entropy": 0.450884065652887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 367.36, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36736, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -5.800133872315886, "predator_policy": 5.800133872315886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 180, 400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400], "policy_prey_policy_reward": [-20.783568100249635, -7.768335548110361, -16.538549152756726, 10.675024431870192, 9.808604429276466, -1.1336395828190398, -38.35205868982638, -21.252917883703862, 5.518507682069961, -1.6438938115689687, 1.781173541321298, -32.47860511730922, 3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875], "policy_predator_policy_reward": [20.783568100249635, 7.768335548110361, 16.538549152756726, -10.675024431870192, -9.808604429276466, 1.1336395828190398, 38.35205868982638, 21.252917883703862, -5.518507682069961, 1.6438938115689687, -1.781173541321298, 32.47860511730922, -3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30460734850398685, "mean_inference_ms": 1.0112600592321257, "mean_action_processing_ms": 0.13280010683969634, "mean_env_wait_ms": 0.22564583264713017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030951499938964844, "StateBufferConnector_ms": 0.0021495819091796875, "ViewRequirementAgentConnector_ms": 0.05569279193878174}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.1609790425621, "num_env_steps_trained_throughput_per_sec": 795.1609790425621, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 1352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1352000, "timers": {"training_iteration_time_ms": 5149.164, "restore_workers_time_ms": 0.02, "training_step_time_ms": 5149.119, "sample_time_ms": 780.398, "learn_time_ms": 4358.55, "learn_throughput": 917.736, "synch_weights_time_ms": 9.846}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "done": false, "training_iteration": 169, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-12", "timestamp": 1723386672, "time_this_iter_s": 5.0330469608306885, "time_total_s": 872.830424785614, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 872.830424785614, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 32.142857142857146, "ram_util_percent": 77.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.491783580556512, "cur_kl_coeff": 0.03608134472742676, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9273455479492745, "policy_loss": -0.004061968052701559, "vf_loss": 1.9312454200039306, "vf_explained_var": 0.19566880812247595, "kl": 0.004492362070507265, "entropy": 0.6559799433375398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3980220539495347, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9167702653755745, "policy_loss": -0.0015253727387365265, "vf_loss": 1.9182956317439674, "vf_explained_var": 0.1904072813068827, "kl": 0.007934347953554218, "entropy": 0.3254491354338825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 370.1, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37010, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -5.32637609012247, "predator_policy": 5.32637609012247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 396, 400, 370, 400, 400, 400, 400, 400, 400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [3.7062026917571735, -13.491958093629037, 1.9999910601420865, -8.907389809828807, 19.780938079647743, -39.77938875400713, -5.033131592356543, -14.34965189891889, -13.821624130180009, 9.153373314931692, -15.524390586849272, 0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916], "policy_predator_policy_reward": [-3.7062026917571735, 13.491958093629037, -1.9999910601420865, 8.907389809828807, -19.780938079647743, 39.77938875400713, 5.033131592356543, 14.34965189891889, 13.821624130180009, -9.153373314931692, 15.524390586849272, -0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3046174764781865, "mean_inference_ms": 1.0108092110224962, "mean_action_processing_ms": 0.13270582499936018, "mean_env_wait_ms": 0.22560105203809222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031071901321411133, "StateBufferConnector_ms": 0.002148866653442383, "ViewRequirementAgentConnector_ms": 0.05297386646270752}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 808.5957094710656, "num_env_steps_trained_throughput_per_sec": 808.5957094710656, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 5101.311, "restore_workers_time_ms": 0.019, "training_step_time_ms": 5101.266, "sample_time_ms": 762.26, "learn_time_ms": 4328.782, "learn_throughput": 924.048, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 170, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-17", "timestamp": 1723386677, "time_this_iter_s": 4.949286937713623, "time_total_s": 877.7797117233276, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2264670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 877.7797117233276, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 29.4625, "ram_util_percent": 78.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.615372933199008, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7624321430300673, "policy_loss": -0.0026952008656129086, "vf_loss": 1.765013263747096, "vf_explained_var": 0.290106427979966, "kl": 0.006323408717736889, "entropy": 0.799306941156586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5943821011732022, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7656298907473684, "policy_loss": -0.00011913401976926252, "vf_loss": 1.7657490253448487, "vf_explained_var": 0.2922289723530412, "kl": 0.00818116936499843, "entropy": 0.4856446493417025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 367.45, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36745, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -20.98793319427884}, "policy_reward_max": {"prey_policy": 20.98793319427884, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -5.373316666597754, "predator_policy": 5.373316666597754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 69, 129, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400], "policy_prey_policy_reward": [0.9129160791909339, -4.3099393058409845, -19.19935228235099, -7.0771577106794314, -9.349839286273935, -11.603407064242258, 20.98793319427884, -17.871436485760817, 0.521916975826402, 16.78927781182032, -15.012609969479119, 10.885373797376651, -8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626], "policy_predator_policy_reward": [-0.9129160791909339, 4.3099393058409845, 19.19935228235099, 7.0771577106794314, 9.349839286273935, 11.603407064242258, -20.98793319427884, 17.871436485760817, -0.521916975826402, -16.78927781182032, 15.012609969479119, -10.885373797376651, 8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3045368182482443, "mean_inference_ms": 1.0106780504733919, "mean_action_processing_ms": 0.1326831648423392, "mean_env_wait_ms": 0.2254837819553286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00320589542388916, "StateBufferConnector_ms": 0.0021576881408691406, "ViewRequirementAgentConnector_ms": 0.05299258232116699}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.3870349764792, "num_env_steps_trained_throughput_per_sec": 791.3870349764792, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 5069.576, "restore_workers_time_ms": 0.02, "training_step_time_ms": 5069.531, "sample_time_ms": 758.542, "learn_time_ms": 4300.947, "learn_throughput": 930.028, "synch_weights_time_ms": 9.719}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 171, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-22", "timestamp": 1723386682, "time_this_iter_s": 5.057081699371338, "time_total_s": 882.836793422699, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 882.836793422699, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 30.499999999999996, "ram_util_percent": 77.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8244533344792824, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5045930340110014, "policy_loss": -0.003514510226038207, "vf_loss": 1.508001286163926, "vf_explained_var": 0.002215783918897311, "kl": 0.0058898686145351835, "entropy": 0.6843891966467103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.713275290094316, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.509230823504428, "policy_loss": -0.003046018668586233, "vf_loss": 1.5122768454874556, "vf_explained_var": -0.010493375236789386, "kl": 0.0195718961891593, "entropy": 0.5490992350193361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 364.78, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36478, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -19.745548664514757}, "policy_reward_max": {"prey_policy": 19.745548664514757, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -6.014509465340434, "predator_policy": 6.014509465340434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400], "policy_prey_policy_reward": [-8.368592732673825, -11.393397954006343, 6.99657548975113, -14.895890702599267, -9.223538975664102, 4.488335809333261, -31.469025687246884, -4.327103454272628, -14.568084218956592, 13.358073736813232, 1.9393917628512014, -16.956731722950824, -2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567], "policy_predator_policy_reward": [8.368592732673825, 11.393397954006343, -6.99657548975113, 14.895890702599267, 9.223538975664102, -4.488335809333261, 31.469025687246884, 4.327103454272628, 14.568084218956592, -13.358073736813232, -1.9393917628512014, 16.956731722950824, 2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3042872787154966, "mean_inference_ms": 1.0106013715649467, "mean_action_processing_ms": 0.1326751068155799, "mean_env_wait_ms": 0.22545486766159656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003323078155517578, "StateBufferConnector_ms": 0.002251744270324707, "ViewRequirementAgentConnector_ms": 0.05475270748138428}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.9835814294903, "num_env_steps_trained_throughput_per_sec": 711.9835814294903, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 5084.831, "restore_workers_time_ms": 0.019, "training_step_time_ms": 5084.786, "sample_time_ms": 781.789, "learn_time_ms": 4292.808, "learn_throughput": 931.791, "synch_weights_time_ms": 9.868}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 172, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-27", "timestamp": 1723386687, "time_this_iter_s": 5.621884822845459, "time_total_s": 888.4586782455444, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2206c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 888.4586782455444, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 38.4, "ram_util_percent": 78.28750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4964144964391988, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0346080799897512, "policy_loss": -0.006271973834373057, "vf_loss": 2.0407929136107366, "vf_explained_var": 0.37699558238188424, "kl": 0.004830128481578006, "entropy": 0.693413242759804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.753046812241276, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.881418877405425, "policy_loss": -0.00205119105327564, "vf_loss": 1.883470068561534, "vf_explained_var": 0.42899326688299577, "kl": 0.005623235480126303, "entropy": 0.6125147005543112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 356.7, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35670, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -19.745548664514757}, "policy_reward_max": {"prey_policy": 19.745548664514757, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -5.501857100761954, "predator_policy": 5.501857100761954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.3671680600093943, -3.0793119487045235, -15.089779879763462, -13.913221776251568, -7.4517907842314415, 10.990186445178285, -16.102064743079563, -7.739888828920215, -20.552968087154458, 0.15142809546513902, 1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949], "policy_predator_policy_reward": [2.3671680600093943, 3.0793119487045235, 15.089779879763462, 13.913221776251568, 7.4517907842314415, -10.990186445178285, 16.102064743079563, 7.739888828920215, 20.552968087154458, -0.15142809546513902, -1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3043237690741515, "mean_inference_ms": 1.010465828387317, "mean_action_processing_ms": 0.13264322922591368, "mean_env_wait_ms": 0.22540097895383213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033379793167114258, "StateBufferConnector_ms": 0.0022737979888916016, "ViewRequirementAgentConnector_ms": 0.05646371841430664}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 771.4574799373977, "num_env_steps_trained_throughput_per_sec": 771.4574799373977, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 1384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1384000, "timers": {"training_iteration_time_ms": 5087.0, "restore_workers_time_ms": 0.019, "training_step_time_ms": 5086.957, "sample_time_ms": 776.632, "learn_time_ms": 4300.087, "learn_throughput": 930.214, "synch_weights_time_ms": 9.913}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "done": false, "training_iteration": 173, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-33", "timestamp": 1723386693, "time_this_iter_s": 5.188145875930786, "time_total_s": 893.6468241214752, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 893.6468241214752, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 32.542857142857144, "ram_util_percent": 77.97142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5372577480350933, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8231008667498827, "policy_loss": -0.0028296620854234788, "vf_loss": 1.8259120376780629, "vf_explained_var": 0.2687226898347338, "kl": 0.002049191627437009, "entropy": 0.5969765193760395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7131576501453916, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5207152659073473, "policy_loss": -0.004787204275392772, "vf_loss": 1.5255024731780091, "vf_explained_var": 0.48773760478943584, "kl": 0.012103830359394626, "entropy": 0.6536653507500887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 353.18, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35318, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -19.745548664514757}, "policy_reward_max": {"prey_policy": 19.745548664514757, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -5.523675104890815, "predator_policy": 5.523675104890815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 263, 33, 400, 400, 400, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400, 186, 400, 400, 113, 400, 217, 367, 400, 400, 400], "policy_prey_policy_reward": [1.3682844376981507, -10.106650697913004, -18.12606537065473, -5.642726662823009, 10.369722799117952, 12.12865680129556, -7.321096044999255, 8.986911777157392, 6.666704807321725, 10.601019050951209, -6.5970928552329715, 3.1422724162277866, 1.936874531778706, -11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949, -34.28572995795367, -11.35630565380712, -9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193], "policy_predator_policy_reward": [-1.3682844376981507, 10.106650697913004, 18.12606537065473, 5.642726662823009, -10.369722799117952, -12.12865680129556, 7.321096044999255, -8.986911777157392, -6.666704807321725, -10.601019050951209, 6.5970928552329715, -3.1422724162277866, -1.936874531778706, 11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949, 34.28572995795367, 11.35630565380712, 9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3042508528744471, "mean_inference_ms": 1.0104933973543502, "mean_action_processing_ms": 0.13261933305727538, "mean_env_wait_ms": 0.22542993269962708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003327012062072754, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.05776047706604004}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.5710352518739, "num_env_steps_trained_throughput_per_sec": 795.5710352518739, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 5084.976, "restore_workers_time_ms": 0.019, "training_step_time_ms": 5084.932, "sample_time_ms": 779.645, "learn_time_ms": 4295.163, "learn_throughput": 931.28, "synch_weights_time_ms": 9.8}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 174, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-38", "timestamp": 1723386698, "time_this_iter_s": 5.0305352210998535, "time_total_s": 898.6773593425751, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 898.6773593425751, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 30.400000000000002, "ram_util_percent": 78.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.80490405044208, "cur_kl_coeff": 0.004510168090928345, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.950787427276373, "policy_loss": -0.002534873004090817, "vf_loss": 1.953309184933702, "vf_explained_var": 0.11527320016175509, "kl": 0.0029082292654515856, "entropy": 0.634065416144828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7608380975201725, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6956700736035903, "policy_loss": -0.0019364261150864573, "vf_loss": 1.6976065022250018, "vf_explained_var": 0.15954352878034114, "kl": 0.011909992109416035, "entropy": 0.6706557030479113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 353.06, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 35306, "policy_reward_min": {"prey_policy": -47.67378203182042, "predator_policy": -19.745548664514757}, "policy_reward_max": {"prey_policy": 19.745548664514757, "predator_policy": 47.67378203182042}, "policy_reward_mean": {"prey_policy": -6.271646262459781, "predator_policy": 6.271646262459781}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 199, 400, 400, 400, 208, 400, 356, 400, 400, 400, 400, 40, 400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400, 186, 400, 400, 113, 400, 217, 367, 400, 400, 400, 400, 400, 400, 199, 400, 400, 400, 400, 137, 304, 400, 400, 278], "policy_prey_policy_reward": [-11.367233908101472, -1.9261541804670976, 1.7289471527386056, -47.67378203182042, 15.696004967902205, 2.8315821749294194, -12.367070329440061, -32.614456755460914, -6.291517847571992, -11.901576496490877, -12.282429812940883, 9.95646145033005, -4.934374803877329, 19.745548664514757, -9.96706393330722, -4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949, -34.28572995795367, -11.35630565380712, -9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193, 4.620882360256861, 6.7709345054164345, 2.621940500567092, -30.323364764250567, -5.3375781870989485, -3.310875934902718, 1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292], "policy_predator_policy_reward": [11.367233908101472, 1.9261541804670976, -1.7289471527386056, 47.67378203182042, -15.696004967902205, -2.8315821749294194, 12.367070329440061, 32.614456755460914, 6.291517847571992, 11.901576496490877, 12.282429812940883, -9.95646145033005, 4.934374803877329, -19.745548664514757, 9.96706393330722, 4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949, 34.28572995795367, 11.35630565380712, 9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193, -4.620882360256861, -6.7709345054164345, -2.621940500567092, 30.323364764250567, 5.3375781870989485, 3.310875934902718, -1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3041171514558291, "mean_inference_ms": 1.010381618629932, "mean_action_processing_ms": 0.1325795689887037, "mean_env_wait_ms": 0.22549553365854144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033655166625976562, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.056559085845947266}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.130708114122, "num_env_steps_trained_throughput_per_sec": 801.130708114122, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 5085.92, "restore_workers_time_ms": 0.019, "training_step_time_ms": 5085.876, "sample_time_ms": 779.598, "learn_time_ms": 4296.207, "learn_throughput": 931.054, "synch_weights_time_ms": 9.747}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 175, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-43", "timestamp": 1723386703, "time_this_iter_s": 4.99575400352478, "time_total_s": 903.6731133460999, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22fea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 903.6731133460999, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 30.657142857142855, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.108321037267645, "cur_kl_coeff": 0.0022550840454641724, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1461539156734943, "policy_loss": -0.004039500943811921, "vf_loss": 2.1501780898620684, "vf_explained_var": 0.3287701530382037, "kl": 0.0067968020328052605, "entropy": 0.6488695619006951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7506947623565794, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9151525276402632, "policy_loss": -0.0002979079751336637, "vf_loss": 1.915450433952113, "vf_explained_var": 0.32261588058123986, "kl": 0.005732644846687655, "entropy": 0.6659092002237836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 345.66, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 34566, "policy_reward_min": {"prey_policy": -40.451207146099826, "predator_policy": -17.978832500405975}, "policy_reward_max": {"prey_policy": 17.978832500405975, "predator_policy": 40.451207146099826}, "policy_reward_mean": {"prey_policy": -5.948875115393743, "predator_policy": 5.948875115393743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 326, 400, 400, 400, 400, 211, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400, 186, 400, 400, 113, 400, 217, 367, 400, 400, 400, 400, 400, 400, 199, 400, 400, 400, 400, 137, 304, 400, 400, 278, 400, 400, 400, 400, 133, 360, 400, 144, 205, 400, 58, 400, 400, 238, 125], "policy_prey_policy_reward": [-4.422861960272442, -17.863109971515826, -10.279065137440199, -4.227755589030366, -6.001118285910788, 4.308409956798528, -18.418611285239436, -10.820433185085196, -4.741395595020233, -1.8113570328808564, -22.99021641788912, 4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949, -34.28572995795367, -11.35630565380712, -9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193, 4.620882360256861, 6.7709345054164345, 2.621940500567092, -30.323364764250567, -5.3375781870989485, -3.310875934902718, 1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292, 4.383904307977712, 5.36020725409535, 2.2583048943607196, 9.051651161428374, -7.865374443995602, -2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323], "policy_predator_policy_reward": [4.422861960272442, 17.863109971515826, 10.279065137440199, 4.227755589030366, 6.001118285910788, -4.308409956798528, 18.418611285239436, 10.820433185085196, 4.741395595020233, 1.8113570328808564, 22.99021641788912, -4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949, 34.28572995795367, 11.35630565380712, 9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193, -4.620882360256861, -6.7709345054164345, -2.621940500567092, 30.323364764250567, 5.3375781870989485, 3.310875934902718, -1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292, -4.383904307977712, -5.36020725409535, -2.2583048943607196, -9.051651161428374, 7.865374443995602, 2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30394692654416156, "mean_inference_ms": 1.0102112482197136, "mean_action_processing_ms": 0.13260320468439663, "mean_env_wait_ms": 0.22545180934778897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033071041107177734, "StateBufferConnector_ms": 0.0022162199020385742, "ViewRequirementAgentConnector_ms": 0.05522465705871582}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 786.8614542280654, "num_env_steps_trained_throughput_per_sec": 786.8614542280654, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 5099.096, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5099.063, "sample_time_ms": 778.453, "learn_time_ms": 4310.552, "learn_throughput": 927.955, "synch_weights_time_ms": 9.734}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 176, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-48", "timestamp": 1723386708, "time_this_iter_s": 5.086319923400879, "time_total_s": 908.7594332695007, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22fef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 908.7594332695007, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 30.95, "ram_util_percent": 78.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.318474221819391, "cur_kl_coeff": 0.0022550840454641724, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8539866645354778, "policy_loss": -0.005791184015470208, "vf_loss": 0.8597611444070935, "vf_explained_var": 0.3509719017893076, "kl": 0.007406230417439256, "entropy": 0.6418119238689541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.178690057930847, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8393668126314878, "policy_loss": -0.0016781321537564509, "vf_loss": 0.8410449452077349, "vf_explained_var": 0.3735905778283874, "kl": 0.006365508731228893, "entropy": 0.6336457300310333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 344.16, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34416, "policy_reward_min": {"prey_policy": -40.451207146099826, "predator_policy": -17.978832500405975}, "policy_reward_max": {"prey_policy": 17.978832500405975, "predator_policy": 40.451207146099826}, "policy_reward_mean": {"prey_policy": -5.4738987761945905, "predator_policy": 5.4738987761945905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400, 186, 400, 400, 113, 400, 217, 367, 400, 400, 400, 400, 400, 400, 199, 400, 400, 400, 400, 137, 304, 400, 400, 278, 400, 400, 400, 400, 133, 360, 400, 144, 205, 400, 58, 400, 400, 238, 125, 400, 400, 115, 218, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [4.390392468926276, -6.953498525189705, 3.020902588041853, -6.907188576418875, -8.263948638738071, -19.335020843251336, 13.592482834311923, 4.240134158258424, -40.451207146099826, -0.2167818326014661, 1.4081963695321456, -5.3195654201028795, -5.121441692332496, -19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949, -34.28572995795367, -11.35630565380712, -9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193, 4.620882360256861, 6.7709345054164345, 2.621940500567092, -30.323364764250567, -5.3375781870989485, -3.310875934902718, 1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292, 4.383904307977712, 5.36020725409535, 2.2583048943607196, 9.051651161428374, -7.865374443995602, -2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323, -15.761082388331182, -6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016], "policy_predator_policy_reward": [-4.390392468926276, 6.953498525189705, -3.020902588041853, 6.907188576418875, 8.263948638738071, 19.335020843251336, -13.592482834311923, -4.240134158258424, 40.451207146099826, 0.2167818326014661, -1.4081963695321456, 5.3195654201028795, 5.121441692332496, 19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949, 34.28572995795367, 11.35630565380712, 9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193, -4.620882360256861, -6.7709345054164345, -2.621940500567092, 30.323364764250567, 5.3375781870989485, 3.310875934902718, -1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292, -4.383904307977712, -5.36020725409535, -2.2583048943607196, -9.051651161428374, 7.865374443995602, 2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323, 15.761082388331182, 6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3038763380610289, "mean_inference_ms": 1.0100066220585942, "mean_action_processing_ms": 0.13258370827237945, "mean_env_wait_ms": 0.22541846314574815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00324404239654541, "StateBufferConnector_ms": 0.0021898746490478516, "ViewRequirementAgentConnector_ms": 0.05397772789001465}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 788.3466229530012, "num_env_steps_trained_throughput_per_sec": 788.3466229530012, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 5098.904, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5098.871, "sample_time_ms": 775.782, "learn_time_ms": 4313.149, "learn_throughput": 927.397, "synch_weights_time_ms": 9.618}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 177, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-53", "timestamp": 1723386713, "time_this_iter_s": 5.076540946960449, "time_total_s": 913.8359742164612, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 913.8359742164612, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 33.2, "ram_util_percent": 78.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3637872599065304, "cur_kl_coeff": 0.0022550840454641724, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4868421387548247, "policy_loss": -0.004427114072435264, "vf_loss": 1.4912491014848153, "vf_explained_var": 0.23954681207736334, "kl": 0.008936817222867745, "entropy": 0.7698308524986108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.03855667328462, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6608750650038322, "policy_loss": -0.002146906772638128, "vf_loss": 1.6630219701056679, "vf_explained_var": 0.21404998656362295, "kl": 0.01461724783549035, "entropy": 0.6430926529690624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 336.5, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 33650, "policy_reward_min": {"prey_policy": -38.320207135979885, "predator_policy": -17.978832500405975}, "policy_reward_max": {"prey_policy": 17.978832500405975, "predator_policy": 38.320207135979885}, "policy_reward_mean": {"prey_policy": -5.504781804901576, "predator_policy": 5.504781804901576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 347, 400, 154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400, 186, 400, 400, 113, 400, 217, 367, 400, 400, 400, 400, 400, 400, 199, 400, 400, 400, 400, 137, 304, 400, 400, 278, 400, 400, 400, 400, 133, 360, 400, 144, 205, 400, 58, 400, 400, 238, 125, 400, 400, 115, 218, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-19.917247473206302, 4.740932717928265, 9.850987383836916, -7.563026785366157, 4.802359887739023, 0.5400464897046682, -8.5994365611085, -9.166219162363749, -13.922663941626105, -3.553713582230209, -26.932411434095478, 1.1730299323555116, -8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949, -34.28572995795367, -11.35630565380712, -9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193, 4.620882360256861, 6.7709345054164345, 2.621940500567092, -30.323364764250567, -5.3375781870989485, -3.310875934902718, 1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292, 4.383904307977712, 5.36020725409535, 2.2583048943607196, 9.051651161428374, -7.865374443995602, -2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323, -15.761082388331182, -6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016, -2.3788837307778543, -14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245], "policy_predator_policy_reward": [19.917247473206302, -4.740932717928265, -9.850987383836916, 7.563026785366157, -4.802359887739023, -0.5400464897046682, 8.5994365611085, 9.166219162363749, 13.922663941626105, 3.553713582230209, 26.932411434095478, -1.1730299323555116, 8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949, 34.28572995795367, 11.35630565380712, 9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193, -4.620882360256861, -6.7709345054164345, -2.621940500567092, 30.323364764250567, 5.3375781870989485, 3.310875934902718, -1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292, -4.383904307977712, -5.36020725409535, -2.2583048943607196, -9.051651161428374, 7.865374443995602, 2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323, 15.761082388331182, 6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016, 2.3788837307778543, 14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30384370136303557, "mean_inference_ms": 1.010240770625122, "mean_action_processing_ms": 0.13258167286988418, "mean_env_wait_ms": 0.22531491794321376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032356977462768555, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.05491006374359131}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.8746461178167, "num_env_steps_trained_throughput_per_sec": 804.8746461178167, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 5098.275, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5098.243, "sample_time_ms": 774.799, "learn_time_ms": 4313.485, "learn_throughput": 927.324, "synch_weights_time_ms": 9.64}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 178, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-31-58", "timestamp": 1723386718, "time_this_iter_s": 4.972322940826416, "time_total_s": 918.8082971572876, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22fe550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 918.8082971572876, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 31.328571428571422, "ram_util_percent": 78.08571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4372614437714217, "cur_kl_coeff": 0.0022550840454641724, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2978315900390347, "policy_loss": -0.0027429915072085956, "vf_loss": 1.300561234386017, "vf_explained_var": 0.6819629327083627, "kl": 0.005914353098371925, "entropy": 0.7389861278856794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2690348734458285, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3219189238424103, "policy_loss": -0.003293303124034234, "vf_loss": 1.325212226777027, "vf_explained_var": 0.6246479126935204, "kl": 0.008048791200925129, "entropy": 0.5921134366343419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 326.67, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 32667, "policy_reward_min": {"prey_policy": -38.320207135979885, "predator_policy": -17.978832500405975}, "policy_reward_max": {"prey_policy": 17.978832500405975, "predator_policy": 38.320207135979885}, "policy_reward_mean": {"prey_policy": -5.733814542428911, "predator_policy": 5.733814542428911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [154, 400, 75, 400, 400, 400, 133, 400, 400, 400, 400, 123, 400, 400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400, 186, 400, 400, 113, 400, 217, 367, 400, 400, 400, 400, 400, 400, 199, 400, 400, 400, 400, 137, 304, 400, 400, 278, 400, 400, 400, 400, 133, 360, 400, 144, 205, 400, 58, 400, 400, 238, 125, 400, 400, 115, 218, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400], "policy_prey_policy_reward": [-8.916251256020669, -8.822800953807626, -10.286506000217537, -9.3639422422576, -12.005641915103205, 3.442365857796524, -6.4462072463428015, -9.839138122646666, -14.68931607759762, -6.230528916142919, -2.003999107444713, -32.86089127363102, 6.978941647220921, -5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949, -34.28572995795367, -11.35630565380712, -9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193, 4.620882360256861, 6.7709345054164345, 2.621940500567092, -30.323364764250567, -5.3375781870989485, -3.310875934902718, 1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292, 4.383904307977712, 5.36020725409535, 2.2583048943607196, 9.051651161428374, -7.865374443995602, -2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323, -15.761082388331182, -6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016, -2.3788837307778543, -14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245, 9.24375914339224, 1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595], "policy_predator_policy_reward": [8.916251256020669, 8.822800953807626, 10.286506000217537, 9.3639422422576, 12.005641915103205, -3.442365857796524, 6.4462072463428015, 9.839138122646666, 14.68931607759762, 6.230528916142919, 2.003999107444713, 32.86089127363102, -6.978941647220921, 5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949, 34.28572995795367, 11.35630565380712, 9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193, -4.620882360256861, -6.7709345054164345, -2.621940500567092, 30.323364764250567, 5.3375781870989485, 3.310875934902718, -1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292, -4.383904307977712, -5.36020725409535, -2.2583048943607196, -9.051651161428374, 7.865374443995602, 2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323, 15.761082388331182, 6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016, 2.3788837307778543, 14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245, -9.24375914339224, -1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30377494270111954, "mean_inference_ms": 1.0100798535392286, "mean_action_processing_ms": 0.13259440024662425, "mean_env_wait_ms": 0.2253196215044864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031690597534179688, "StateBufferConnector_ms": 0.002249598503112793, "ViewRequirementAgentConnector_ms": 0.05438697338104248}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 787.5350905571548, "num_env_steps_trained_throughput_per_sec": 787.5350905571548, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 1432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1432000, "timers": {"training_iteration_time_ms": 5103.146, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5103.115, "sample_time_ms": 772.841, "learn_time_ms": 4320.288, "learn_throughput": 925.864, "synch_weights_time_ms": 9.668}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "done": false, "training_iteration": 179, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-03", "timestamp": 1723386723, "time_this_iter_s": 5.081762790679932, "time_total_s": 923.8900599479675, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 923.8900599479675, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 31.657142857142855, "ram_util_percent": 78.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5359902661293745, "cur_kl_coeff": 0.0022550840454641724, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.478907715715468, "policy_loss": -0.002785324949460725, "vf_loss": 1.4816795172790687, "vf_explained_var": 0.0770103064055244, "kl": 0.005996986156566209, "entropy": 0.6756342008709908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5168227132409813, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.430543026421219, "policy_loss": -0.007635568271507509, "vf_loss": 1.4381785948450367, "vf_explained_var": 0.12447481614847979, "kl": 0.016194434605507974, "entropy": 0.6395411172571281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 325.1, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 32510, "policy_reward_min": {"prey_policy": -38.320207135979885, "predator_policy": -17.978832500405975}, "policy_reward_max": {"prey_policy": 17.978832500405975, "predator_policy": 38.320207135979885}, "policy_reward_mean": {"prey_policy": -5.544440188123333, "predator_policy": 5.544440188123333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 113, 400, 276, 87, 316, 400, 400, 400, 400, 186, 400, 400, 113, 400, 217, 367, 400, 400, 400, 400, 400, 400, 199, 400, 400, 400, 400, 137, 304, 400, 400, 278, 400, 400, 400, 400, 133, 360, 400, 144, 205, 400, 58, 400, 400, 238, 125, 400, 400, 115, 218, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400], "policy_prey_policy_reward": [-5.14074072403567, -2.5049302687606847, 8.992862275067058, 17.978832500405975, -10.715193591813398, -16.226291385747913, -15.455445252721061, -6.955197946997909, -19.242384434458977, 14.259717720687025, 15.984681838832028, -2.834600563796382, -16.43680308246949, -34.28572995795367, -11.35630565380712, -9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193, 4.620882360256861, 6.7709345054164345, 2.621940500567092, -30.323364764250567, -5.3375781870989485, -3.310875934902718, 1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292, 4.383904307977712, 5.36020725409535, 2.2583048943607196, 9.051651161428374, -7.865374443995602, -2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323, -15.761082388331182, -6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016, -2.3788837307778543, -14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245, 9.24375914339224, 1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462], "policy_predator_policy_reward": [5.14074072403567, 2.5049302687606847, -8.992862275067058, -17.978832500405975, 10.715193591813398, 16.226291385747913, 15.455445252721061, 6.955197946997909, 19.242384434458977, -14.259717720687025, -15.984681838832028, 2.834600563796382, 16.43680308246949, 34.28572995795367, 11.35630565380712, 9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193, -4.620882360256861, -6.7709345054164345, -2.621940500567092, 30.323364764250567, 5.3375781870989485, 3.310875934902718, -1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292, -4.383904307977712, -5.36020725409535, -2.2583048943607196, -9.051651161428374, 7.865374443995602, 2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323, 15.761082388331182, 6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016, 2.3788837307778543, 14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245, -9.24375914339224, -1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3039964659158833, "mean_inference_ms": 1.0100274909781577, "mean_action_processing_ms": 0.13257029246376337, "mean_env_wait_ms": 0.2253815445131766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003165721893310547, "StateBufferConnector_ms": 0.0022208690643310547, "ViewRequirementAgentConnector_ms": 0.061559319496154785}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.3288435424024, "num_env_steps_trained_throughput_per_sec": 677.3288435424024, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 5199.019, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5198.98, "sample_time_ms": 813.675, "learn_time_ms": 4373.421, "learn_throughput": 914.616, "synch_weights_time_ms": 11.534}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 180, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-09", "timestamp": 1723386729, "time_this_iter_s": 5.931842088699341, "time_total_s": 929.8219020366669, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 929.8219020366669, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 51.7, "ram_util_percent": 79.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3303986493187647, "cur_kl_coeff": 0.0022550840454641724, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.68626145546635, "policy_loss": -0.006850710478708303, "vf_loss": 1.6930879236509402, "vf_explained_var": 0.2026123561585943, "kl": 0.01075107624441501, "entropy": 0.8371193289756775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4323031373942894, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6971567265068492, "policy_loss": -0.001219351821540234, "vf_loss": 1.6983760755509139, "vf_explained_var": 0.23136918898671865, "kl": 0.012235764352728188, "entropy": 0.7613476331035296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 315.67, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 31567, "policy_reward_min": {"prey_policy": -40.243238396051765, "predator_policy": -14.6459624899361}, "policy_reward_max": {"prey_policy": 14.6459624899361, "predator_policy": 40.243238396051765}, "policy_reward_mean": {"prey_policy": -6.286608836188249, "predator_policy": 6.286608836188249}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 113, 400, 217, 367, 400, 400, 400, 400, 400, 400, 199, 400, 400, 400, 400, 137, 304, 400, 400, 278, 400, 400, 400, 400, 133, 360, 400, 144, 205, 400, 58, 400, 400, 238, 125, 400, 400, 115, 218, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143], "policy_prey_policy_reward": [-9.898992825546326, -9.35048881223325, 5.74705578681445, -22.502363758113166, -10.763767946559945, -4.436613471572841, 8.289203617046237, 11.221623041568193, 4.620882360256861, 6.7709345054164345, 2.621940500567092, -30.323364764250567, -5.3375781870989485, -3.310875934902718, 1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292, 4.383904307977712, 5.36020725409535, 2.2583048943607196, 9.051651161428374, -7.865374443995602, -2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323, -15.761082388331182, -6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016, -2.3788837307778543, -14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245, 9.24375914339224, 1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945], "policy_predator_policy_reward": [9.898992825546326, 9.35048881223325, -5.74705578681445, 22.502363758113166, 10.763767946559945, 4.436613471572841, -8.289203617046237, -11.221623041568193, -4.620882360256861, -6.7709345054164345, -2.621940500567092, 30.323364764250567, 5.3375781870989485, 3.310875934902718, -1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292, -4.383904307977712, -5.36020725409535, -2.2583048943607196, -9.051651161428374, 7.865374443995602, 2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323, 15.761082388331182, 6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016, 2.3788837307778543, 14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245, -9.24375914339224, -1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30405740600097225, "mean_inference_ms": 1.0102627326286062, "mean_action_processing_ms": 0.13262246959480756, "mean_env_wait_ms": 0.22542293557411647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003174304962158203, "StateBufferConnector_ms": 0.0022504329681396484, "ViewRequirementAgentConnector_ms": 0.062018752098083496}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.7196745444908, "num_env_steps_trained_throughput_per_sec": 742.7196745444908, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 1448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1448000, "timers": {"training_iteration_time_ms": 5232.14, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5232.099, "sample_time_ms": 831.293, "learn_time_ms": 4388.986, "learn_throughput": 911.372, "synch_weights_time_ms": 11.473}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "done": false, "training_iteration": 181, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-14", "timestamp": 1723386734, "time_this_iter_s": 5.388437986373901, "time_total_s": 935.2103400230408, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2264790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 935.2103400230408, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 37.07142857142857, "ram_util_percent": 80.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9979337375611066, "cur_kl_coeff": 0.0022550840454641724, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3590313882877427, "policy_loss": -0.0058862257477206486, "vf_loss": 2.364863774056236, "vf_explained_var": 0.22643348034471272, "kl": 0.02387256254727877, "entropy": 0.7749199364334345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5946100229397415, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.538609241694212, "policy_loss": -0.0038839834058308044, "vf_loss": 2.5424932251373926, "vf_explained_var": 0.23192043155431746, "kl": 0.01301455931130704, "entropy": 0.581143902707845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 307.83, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 30783, "policy_reward_min": {"prey_policy": -40.243238396051765, "predator_policy": -14.6459624899361}, "policy_reward_max": {"prey_policy": 14.6459624899361, "predator_policy": 40.243238396051765}, "policy_reward_mean": {"prey_policy": -6.846503379536707, "predator_policy": 6.846503379536707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 137, 304, 400, 400, 278, 400, 400, 400, 400, 133, 360, 400, 144, 205, 400, 58, 400, 400, 238, 125, 400, 400, 115, 218, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.3524560286189597, 7.195280364953842, -9.454408962287731, -16.5421420168868, -8.244136324375134, 10.386728852459132, -27.126017189441292, 4.383904307977712, 5.36020725409535, 2.2583048943607196, 9.051651161428374, -7.865374443995602, -2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323, -15.761082388331182, -6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016, -2.3788837307778543, -14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245, 9.24375914339224, 1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648], "policy_predator_policy_reward": [-1.3524560286189597, -7.195280364953842, 9.454408962287731, 16.5421420168868, 8.244136324375134, -10.386728852459132, 27.126017189441292, -4.383904307977712, -5.36020725409535, -2.2583048943607196, -9.051651161428374, 7.865374443995602, 2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323, 15.761082388331182, 6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016, 2.3788837307778543, 14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245, -9.24375914339224, -1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3040655490090516, "mean_inference_ms": 1.0104006720129903, "mean_action_processing_ms": 0.1326431395379273, "mean_env_wait_ms": 0.22543995460634828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00313723087310791, "StateBufferConnector_ms": 0.0022389888763427734, "ViewRequirementAgentConnector_ms": 0.06091904640197754}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.039545590151, "num_env_steps_trained_throughput_per_sec": 799.039545590151, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 5170.93, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5170.89, "sample_time_ms": 798.861, "learn_time_ms": 4360.431, "learn_throughput": 917.34, "synch_weights_time_ms": 11.257}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 182, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-19", "timestamp": 1723386739, "time_this_iter_s": 5.008808851242065, "time_total_s": 940.2191488742828, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22fe550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 940.2191488742828, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 30.057142857142853, "ram_util_percent": 80.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0987743011365336, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6203241748114428, "policy_loss": -0.0038302483189909253, "vf_loss": 2.624129033088684, "vf_explained_var": 0.20829743562887112, "kl": 0.007505951688491974, "entropy": 0.6131410662084817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3169676090901095, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6549644098306695, "policy_loss": -0.0005723066691037578, "vf_loss": 2.655536710843444, "vf_explained_var": 0.20140487402677537, "kl": 0.004440811845671533, "entropy": 0.5664670451544225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 309.69, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 30969, "policy_reward_min": {"prey_policy": -45.18170689731278, "predator_policy": -23.328241246515866}, "policy_reward_max": {"prey_policy": 23.328241246515866, "predator_policy": 45.18170689731278}, "policy_reward_mean": {"prey_policy": -6.991076608285841, "predator_policy": 6.991076608285841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [360, 400, 144, 205, 400, 58, 400, 400, 238, 125, 400, 400, 115, 218, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400], "policy_prey_policy_reward": [-2.3323095824753697, 7.849120986453482, -38.320207135979885, -8.0863068599849, -3.9210554677896106, -7.974228533687917, 9.417484490826528, 1.2906831508891088, -9.044694486754246, -31.15718071782323, -15.761082388331182, -6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016, -2.3788837307778543, -14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245, 9.24375914339224, 1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866], "policy_predator_policy_reward": [2.3323095824753697, -7.849120986453482, 38.320207135979885, 8.0863068599849, 3.9210554677896106, 7.974228533687917, -9.417484490826528, -1.2906831508891088, 9.044694486754246, 31.15718071782323, 15.761082388331182, 6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016, 2.3788837307778543, 14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245, -9.24375914339224, -1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3040794007083101, "mean_inference_ms": 1.0106017458053536, "mean_action_processing_ms": 0.13263802064137184, "mean_env_wait_ms": 0.22545263115510075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003026604652404785, "StateBufferConnector_ms": 0.002231121063232422, "ViewRequirementAgentConnector_ms": 0.06044340133666992}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 751.9218308955535, "num_env_steps_trained_throughput_per_sec": 751.9218308955535, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 5184.401, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5184.361, "sample_time_ms": 796.632, "learn_time_ms": 4376.119, "learn_throughput": 914.052, "synch_weights_time_ms": 11.27}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 183, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-25", "timestamp": 1723386745, "time_this_iter_s": 5.322721004486084, "time_total_s": 945.5418698787689, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 945.5418698787689, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 33.5, "ram_util_percent": 80.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.114504351901511, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.160763531178236, "policy_loss": -0.003758065213817948, "vf_loss": 2.1644982690612475, "vf_explained_var": 0.1676209794357419, "kl": 0.006897671784555369, "entropy": 0.562849846854806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.291156087256968, "cur_kl_coeff": 1.7072281088825743e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.203405294753611, "policy_loss": -0.003283918106656832, "vf_loss": 2.2066892066349584, "vf_explained_var": 0.17135817383726437, "kl": 0.009544816561437547, "entropy": 0.4605043049280842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 318.54, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31854, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -23.328241246515866}, "policy_reward_max": {"prey_policy": 23.328241246515866, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -7.037264836413686, "predator_policy": 7.037264836413686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 115, 218, 400, 400, 400, 400, 400, 400, 400, 400, 97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-6.710795617449794, -2.790184858139059, -4.231634348889627, -25.107046890592514, 6.96802906766213, 4.880776776717013, -7.593085916412953, -4.665122776940127, 9.562365073127385, -4.322098704322016, -2.3788837307778543, -14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245, 9.24375914339224, 1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416], "policy_predator_policy_reward": [6.710795617449794, 2.790184858139059, 4.231634348889627, 25.107046890592514, -6.96802906766213, -4.880776776717013, 7.593085916412953, 4.665122776940127, -9.562365073127385, 4.322098704322016, 2.3788837307778543, 14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245, -9.24375914339224, -1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30424443994485467, "mean_inference_ms": 1.0107209930083019, "mean_action_processing_ms": 0.1326708448220847, "mean_env_wait_ms": 0.22537554425702383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003016829490661621, "StateBufferConnector_ms": 0.002225041389465332, "ViewRequirementAgentConnector_ms": 0.05999267101287842}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.3173444769615, "num_env_steps_trained_throughput_per_sec": 742.3173444769615, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 5220.471, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5220.43, "sample_time_ms": 805.381, "learn_time_ms": 4403.109, "learn_throughput": 908.449, "synch_weights_time_ms": 11.59}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 184, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-30", "timestamp": 1723386750, "time_this_iter_s": 5.392189264297485, "time_total_s": 950.9340591430664, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22a9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 950.9340591430664, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 33.6375, "ram_util_percent": 79.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.884705315902829, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6089558709412812, "policy_loss": -0.006857186967681628, "vf_loss": 2.6157920893281696, "vf_explained_var": -0.1472243392219146, "kl": 0.0061972491788345385, "entropy": 0.682387209435304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8554940016319355, "cur_kl_coeff": 1.7072281088825743e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.603388711437583, "policy_loss": 0.0002482349872783137, "vf_loss": 2.6031404859075944, "vf_explained_var": -0.16727006087700527, "kl": 0.004483507891486368, "entropy": 0.5396047614204387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 315.33, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31533, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -23.328241246515866}, "policy_reward_max": {"prey_policy": 23.328241246515866, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -7.433633975194028, "predator_policy": 7.433633975194028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [97, 355, 400, 400, 72, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400], "policy_prey_policy_reward": [-14.85675582997805, -22.47621218355211, -3.4922707093088583, -2.4905383115544524, -26.811409028424425, 4.75236859773543, -12.33396542171222, 12.645928847031865, 14.6459624899361, -5.99285968826578, -7.930433593915023, -2.2857785635772245, 9.24375914339224, 1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159], "policy_predator_policy_reward": [14.85675582997805, 22.47621218355211, 3.4922707093088583, 2.4905383115544524, 26.811409028424425, -4.75236859773543, 12.33396542171222, -12.645928847031865, -14.6459624899361, 5.99285968826578, 7.930433593915023, 2.2857785635772245, -9.24375914339224, -1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30433457919729695, "mean_inference_ms": 1.0109764694922148, "mean_action_processing_ms": 0.1326738885768268, "mean_env_wait_ms": 0.22535758452338142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029997825622558594, "StateBufferConnector_ms": 0.002112269401550293, "ViewRequirementAgentConnector_ms": 0.059159159660339355}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 792.4546928116825, "num_env_steps_trained_throughput_per_sec": 792.4546928116825, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 5225.938, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5225.896, "sample_time_ms": 804.62, "learn_time_ms": 4409.301, "learn_throughput": 907.173, "synch_weights_time_ms": 11.62}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 185, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-35", "timestamp": 1723386755, "time_this_iter_s": 5.050313234329224, "time_total_s": 955.9843723773956, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22ec940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 955.9843723773956, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 79.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2445079831406476, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.128740587582191, "policy_loss": -0.004386665630833401, "vf_loss": 2.13309211358428, "vf_explained_var": -0.026669659155110517, "kl": 0.010387630012142313, "entropy": 0.6995384241143863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1752951646844547, "cur_kl_coeff": 8.536140544412871e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1089139668891828, "policy_loss": -0.004311014246680619, "vf_loss": 2.1132249778757495, "vf_explained_var": -0.033484983754654724, "kl": 0.009127257074604126, "entropy": 0.607746615819633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 305.46, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 30546, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -23.328241246515866}, "policy_reward_max": {"prey_policy": 23.328241246515866, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -8.953790386966936, "predator_policy": 8.953790386966936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 104, 400, 400, 173, 400, 245, 102, 340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400], "policy_prey_policy_reward": [1.8783752793813946, -4.370105416993702, -19.946467425509596, -7.618439264167648, -2.9063800940749296, -27.14416183208822, 6.230807207171214, -4.277116443628961, -3.9438445631995167, -22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246], "policy_predator_policy_reward": [-1.8783752793813946, 4.370105416993702, 19.946467425509596, 7.618439264167648, 2.9063800940749296, 27.14416183208822, -6.230807207171214, 4.277116443628961, 3.9438445631995167, 22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30433685421254636, "mean_inference_ms": 1.0109850650437795, "mean_action_processing_ms": 0.13271710236720946, "mean_env_wait_ms": 0.22544958594563524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002985715866088867, "StateBufferConnector_ms": 0.0021004676818847656, "ViewRequirementAgentConnector_ms": 0.0588756799697876}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 771.244449439824, "num_env_steps_trained_throughput_per_sec": 771.244449439824, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 5236.232, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5236.189, "sample_time_ms": 800.586, "learn_time_ms": 4423.624, "learn_throughput": 904.236, "synch_weights_time_ms": 11.626}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 186, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-40", "timestamp": 1723386760, "time_this_iter_s": 5.188915967941284, "time_total_s": 961.1732883453369, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22ece50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 961.1732883453369, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 31.042857142857137, "ram_util_percent": 80.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6294125279411675, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2460060022771358, "policy_loss": -0.005985209758121831, "vf_loss": 1.2519436787813902, "vf_explained_var": 0.5118191144739588, "kl": 0.014052361607959559, "entropy": 0.6385841744020582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.599368903475503, "cur_kl_coeff": 8.536140544412871e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.24251340739429, "policy_loss": -0.009145204065862344, "vf_loss": 1.2516586093232036, "vf_explained_var": 0.5185812888666987, "kl": 0.026727785752569216, "entropy": 0.5523891840440531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 315.22, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 31522, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -23.328241246515866}, "policy_reward_max": {"prey_policy": 23.328241246515866, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -7.99380573232155, "predator_policy": 7.99380573232155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [340, 400, 400, 190, 151, 400, 98, 400, 134, 400, 155, 400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-22.229246904670283, -16.367815966777595, 13.039452717498467, -11.312810881679681, -20.898548531795214, 11.067220464555252, -20.870093829525636, -7.111073922484607, -20.91371419512857, -12.498308376233652, -10.660124317734418, -8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352], "policy_predator_policy_reward": [22.229246904670283, 16.367815966777595, -13.039452717498467, 11.312810881679681, 20.898548531795214, -11.067220464555252, 20.870093829525636, 7.111073922484607, 20.91371419512857, 12.498308376233652, 10.660124317734418, 8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30439037069675745, "mean_inference_ms": 1.0112880758413758, "mean_action_processing_ms": 0.13267899414440543, "mean_env_wait_ms": 0.22541197262503343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029058456420898438, "StateBufferConnector_ms": 0.0021517276763916016, "ViewRequirementAgentConnector_ms": 0.059958815574645996}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.9320921191569, "num_env_steps_trained_throughput_per_sec": 791.9320921191569, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 1496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1496000, "timers": {"training_iteration_time_ms": 5233.934, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5233.893, "sample_time_ms": 803.383, "learn_time_ms": 4418.494, "learn_throughput": 905.286, "synch_weights_time_ms": 11.662}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "done": false, "training_iteration": 187, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-45", "timestamp": 1723386765, "time_this_iter_s": 5.05374002456665, "time_total_s": 966.2270283699036, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 966.2270283699036, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 30.375, "ram_util_percent": 80.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3717844490582745, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8442462248417238, "policy_loss": -0.005022160608981115, "vf_loss": 0.8492361596785486, "vf_explained_var": 0.5479185078293085, "kl": 0.009526260147236221, "entropy": 0.5359187654840449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3952185640111567, "cur_kl_coeff": 1.2804210816619308e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8463042530231177, "policy_loss": -0.0018808401427425755, "vf_loss": 0.8481850962465008, "vf_explained_var": 0.5527814630419016, "kl": 0.01004349905164606, "entropy": 0.5799920035215715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 328.54, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 32854, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -6.496154971087688, "predator_policy": 6.496154971087688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 106, 161, 115, 151, 400, 400, 174, 400, 400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-8.195446078884181, -6.785861776491664, -0.9297867486780298, 3.96261530094462, 5.975363672385864, -3.454165352566072, -14.872075821722925, -6.197838409586086, -7.485558606562557, -40.243238396051765, -5.095997538810398, -6.797755218125548, -33.90860340328455, -1.6261240995551738, 10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634], "policy_predator_policy_reward": [8.195446078884181, 6.785861776491664, 0.9297867486780298, -3.96261530094462, -5.975363672385864, 3.454165352566072, 14.872075821722925, 6.197838409586086, 7.485558606562557, 40.243238396051765, 5.095997538810398, 6.797755218125548, 33.90860340328455, 1.6261240995551738, -10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3041917401107089, "mean_inference_ms": 1.0113760804411833, "mean_action_processing_ms": 0.1326848633162555, "mean_env_wait_ms": 0.22532510693352975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00296175479888916, "StateBufferConnector_ms": 0.0022001266479492188, "ViewRequirementAgentConnector_ms": 0.05436694622039795}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.6803005613402, "num_env_steps_trained_throughput_per_sec": 789.6803005613402, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 5243.496, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5243.455, "sample_time_ms": 801.75, "learn_time_ms": 4429.739, "learn_throughput": 902.988, "synch_weights_time_ms": 11.612}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 188, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-51", "timestamp": 1723386771, "time_this_iter_s": 5.067917108535767, "time_total_s": 971.2949454784393, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22ecee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 971.2949454784393, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 31.142857142857142, "ram_util_percent": 80.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7685726183777053, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6639471108714738, "policy_loss": -0.00485309506378447, "vf_loss": 1.6687603994583091, "vf_explained_var": 0.0670075914512078, "kl": 0.011767965782123706, "entropy": 0.537151739684244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7651658869658906, "cur_kl_coeff": 1.2804210816619308e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6741487689316272, "policy_loss": -0.004233068355097203, "vf_loss": 1.678381840015451, "vf_explained_var": 0.06261662617325783, "kl": 0.008463096281874674, "entropy": 0.4369558283438285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 329.11, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 32911, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -5.602415736093061, "predator_policy": 5.602415736093061}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 185, 400, 200, 143, 400, 67, 65, 400, 400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400], "policy_prey_policy_reward": [10.303808527583541, -15.417108218246565, -0.28672328979564554, -24.387058688853863, -14.661318490869945, 2.4802924898720065, -7.578302613802893, -3.07997176833965, -16.04854125291289, 11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821], "policy_predator_policy_reward": [-10.303808527583541, 15.417108218246565, 0.28672328979564554, 24.387058688853863, 14.661318490869945, -2.4802924898720065, 7.578302613802893, 3.07997176833965, 16.04854125291289, -11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.303991472436206, "mean_inference_ms": 1.0112678572838916, "mean_action_processing_ms": 0.1325800390875744, "mean_env_wait_ms": 0.22521863669939662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002845287322998047, "StateBufferConnector_ms": 0.0021278858184814453, "ViewRequirementAgentConnector_ms": 0.05023336410522461}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.2302800716433, "num_env_steps_trained_throughput_per_sec": 798.2302800716433, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 5236.691, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5236.649, "sample_time_ms": 807.086, "learn_time_ms": 4417.629, "learn_throughput": 905.463, "synch_weights_time_ms": 11.58}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 189, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-32-56", "timestamp": 1723386776, "time_this_iter_s": 5.013829946517944, "time_total_s": 976.3087754249573, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 976.3087754249573, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 31.2, "ram_util_percent": 80.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.263300947410365, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2367920781175294, "policy_loss": -0.005717382407359158, "vf_loss": 1.2424776095276078, "vf_explained_var": 0.3554669102653861, "kl": 0.009416140087401308, "entropy": 0.38719824645668266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3292488185688853, "cur_kl_coeff": 1.2804210816619308e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2466471496969462, "policy_loss": -0.0016804104729089887, "vf_loss": 1.248327558549742, "vf_explained_var": 0.36480158747484287, "kl": 0.003386414918906384, "entropy": 0.3323947935986022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 342.51, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 34251, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -4.607707774973342, "predator_policy": 4.607707774973342}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 111, 143, 389, 137, 400, 400, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [11.394407267224711, -18.997787553880098, -12.791658262535405, -34.691207739516, -17.509817091560215, 3.9198163375009223, -5.122558364280035, -0.09643155352934585, -4.970316930933727, -9.549783186761648, -14.021651022438727, 3.800115487586858, -11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455], "policy_predator_policy_reward": [-11.394407267224711, 18.997787553880098, 12.791658262535405, 34.691207739516, 17.509817091560215, -3.9198163375009223, 5.122558364280035, 0.09643155352934585, 4.970316930933727, 9.549783186761648, 14.021651022438727, -3.800115487586858, 11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3040212284826579, "mean_inference_ms": 1.0108854298159893, "mean_action_processing_ms": 0.1326099694880626, "mean_env_wait_ms": 0.22521983711339563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002876758575439453, "StateBufferConnector_ms": 0.002133488655090332, "ViewRequirementAgentConnector_ms": 0.05065286159515381}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.5420221451518, "num_env_steps_trained_throughput_per_sec": 791.5420221451518, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 5151.477, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5151.442, "sample_time_ms": 768.431, "learn_time_ms": 4373.03, "learn_throughput": 914.698, "synch_weights_time_ms": 9.66}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 190, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-01", "timestamp": 1723386781, "time_this_iter_s": 5.05627703666687, "time_total_s": 981.3650524616241, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 981.3650524616241, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 31.771428571428572, "ram_util_percent": 80.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.365992947667837, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1421571601803104, "policy_loss": -0.003134964738516525, "vf_loss": 1.1452693437847, "vf_explained_var": 0.19422463333855072, "kl": 0.006733791577238165, "entropy": 0.39226219154273473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.452060098480433, "cur_kl_coeff": 6.402105408309654e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1254378500394524, "policy_loss": -0.003494232557568466, "vf_loss": 1.1289320825288693, "vf_explained_var": 0.19660192287216585, "kl": 0.0063137374998538795, "entropy": 0.4278622599939505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 346.42, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34642, "policy_reward_min": {"prey_policy": -45.26794212691416, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 45.26794212691416}, "policy_reward_mean": {"prey_policy": -4.348030886027139, "predator_policy": 4.348030886027139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 162, 400, 400, 400, 400, 161, 400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400], "policy_prey_policy_reward": [-11.453728207721753, -5.324784773673237, 3.3635530771555366, -12.279494491097918, -5.992054287057414, -7.76165217434658, 15.380066319662049, -45.18170689731278, 12.44222677472225, 23.328241246515866, -33.590445002080735, -12.880729567541863, -45.26794212691416, -0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675], "policy_predator_policy_reward": [11.453728207721753, 5.324784773673237, -3.3635530771555366, 12.279494491097918, 5.992054287057414, 7.76165217434658, -15.380066319662049, 45.18170689731278, -12.44222677472225, -23.328241246515866, 33.590445002080735, 12.880729567541863, 45.26794212691416, 0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3039292859040399, "mean_inference_ms": 1.011018271923207, "mean_action_processing_ms": 0.132662344255525, "mean_env_wait_ms": 0.2250401257201344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029637813568115234, "StateBufferConnector_ms": 0.002160310745239258, "ViewRequirementAgentConnector_ms": 0.05240678787231445}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 794.988711940589, "num_env_steps_trained_throughput_per_sec": 794.988711940589, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 1528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1528000, "timers": {"training_iteration_time_ms": 5116.065, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5116.033, "sample_time_ms": 758.027, "learn_time_ms": 4347.942, "learn_throughput": 919.976, "synch_weights_time_ms": 9.743}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "done": false, "training_iteration": 191, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-06", "timestamp": 1723386786, "time_this_iter_s": 5.034195899963379, "time_total_s": 986.3992483615875, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a225ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 986.3992483615875, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 31.157142857142855, "ram_util_percent": 80.17142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.204278515900175, "cur_kl_coeff": 0.0033826260681962604, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1035345708020032, "policy_loss": -0.002249456806263576, "vf_loss": 1.10576722798869, "vf_explained_var": 0.12225019950419665, "kl": 0.00496608788794019, "entropy": 0.3975774395590027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2335895728319883, "cur_kl_coeff": 6.402105408309654e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1135587910035005, "policy_loss": -0.002111286944030629, "vf_loss": 1.1156700783098736, "vf_explained_var": 0.10983403244366248, "kl": 0.008129809215966333, "entropy": 0.47777805911997956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 344.69, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34469, "policy_reward_min": {"prey_policy": -41.9122732374054, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 41.9122732374054}, "policy_reward_mean": {"prey_policy": -3.7018595382090678, "predator_policy": 3.7018595382090678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 254, 400, 400, 400, 400, 400, 204, 400, 400, 400, 353, 154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-0.7767643454777229, 12.00055472509732, -13.051515317846418, -2.0946674834748436, 6.213656097934788, -0.31570850145850216, -24.46122239168995, 11.566184556010416, -24.29597067946722, -7.254390411088394, -13.351626039469863, 3.559486583401725, -21.212396463180184, -19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838], "policy_predator_policy_reward": [0.7767643454777229, -12.00055472509732, 13.051515317846418, 2.0946674834748436, -6.213656097934788, 0.31570850145850216, 24.46122239168995, -11.566184556010416, 24.29597067946722, 7.254390411088394, 13.351626039469863, -3.559486583401725, 21.212396463180184, 19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30379329339066086, "mean_inference_ms": 1.0106973217386959, "mean_action_processing_ms": 0.13255656392536708, "mean_env_wait_ms": 0.22500232524229286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029369592666625977, "StateBufferConnector_ms": 0.0021375417709350586, "ViewRequirementAgentConnector_ms": 0.0518343448638916}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 808.9519845419208, "num_env_steps_trained_throughput_per_sec": 808.9519845419208, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 5109.931, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5109.899, "sample_time_ms": 759.968, "learn_time_ms": 4339.871, "learn_throughput": 921.686, "synch_weights_time_ms": 9.738}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 192, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-11", "timestamp": 1723386791, "time_this_iter_s": 4.947423934936523, "time_total_s": 991.346672296524, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 991.346672296524, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 30.542857142857144, "ram_util_percent": 80.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2289109585806726, "cur_kl_coeff": 0.0016913130340981302, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.489040691095094, "policy_loss": -0.004546203219069867, "vf_loss": 1.4935797185326616, "vf_explained_var": 0.083015804986159, "kl": 0.00424140155488277, "entropy": 0.5173168829021354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2018208016020555, "cur_kl_coeff": 6.402105408309654e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5399269761051984, "policy_loss": -0.00084139663449605, "vf_loss": 1.5407683719570437, "vf_explained_var": 0.08851657963047425, "kl": 0.0029766123457087698, "entropy": 0.2938757600573202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 345.63, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34563, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -3.506549015907898, "predator_policy": 3.506549015907898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [154, 400, 400, 400, 101, 400, 400, 30, 400, 400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-19.15320736624765, 7.549432765864612, 3.0109851988721736, -1.225454056693657, -16.06470790847829, 12.413252572435159, -0.3005582141932024, -12.296078423275498, 7.090551509627826, -6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972], "policy_predator_policy_reward": [19.15320736624765, -7.549432765864612, -3.0109851988721736, 1.225454056693657, 16.06470790847829, -12.413252572435159, 0.3005582141932024, 12.296078423275498, -7.090551509627826, 6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3036243249209951, "mean_inference_ms": 1.010477787328021, "mean_action_processing_ms": 0.13260166256448566, "mean_env_wait_ms": 0.22483910087428505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029255151748657227, "StateBufferConnector_ms": 0.0021479129791259766, "ViewRequirementAgentConnector_ms": 0.05125296115875244}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 792.8340107565449, "num_env_steps_trained_throughput_per_sec": 792.8340107565449, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 1544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1544000, "timers": {"training_iteration_time_ms": 5082.48, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5082.447, "sample_time_ms": 758.081, "learn_time_ms": 4314.37, "learn_throughput": 927.134, "synch_weights_time_ms": 9.675}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "done": false, "training_iteration": 193, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-16", "timestamp": 1723386796, "time_this_iter_s": 5.048699140548706, "time_total_s": 996.3953714370728, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22fe160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 996.3953714370728, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 31.675, "ram_util_percent": 80.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2680570993882916, "cur_kl_coeff": 0.0008456565170490651, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8253271667131533, "policy_loss": -0.0021101302253858497, "vf_loss": 0.8274349490956714, "vf_explained_var": 0.4844458118081093, "kl": 0.002774276775409427, "entropy": 0.2908608292539914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2921795319765805, "cur_kl_coeff": 3.201052704154827e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8504780774004758, "policy_loss": -1.2413861744183427e-05, "vf_loss": 0.8504904900367062, "vf_explained_var": 0.46879037749022245, "kl": 0.003266388708746354, "entropy": 0.4528458032446603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 354.78, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35478, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -3.2405444315234986, "predator_policy": 3.2405444315234986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 113, 140, 179, 165, 109, 400, 106, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-6.284194033379054, -36.85292807702954, -41.9122732374054, -18.311469117265077, -31.08510095112554, -36.624773674008885, -6.145734800491592, -30.75956065840347, 5.767961348007649, -1.6836871005418246, 2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972, 2.4696950801068454, -2.51087470040666, -1.9923872217084124, -0.8378870534343008, -6.529558883350589, -0.97972240746072, -0.020350227098141715, 11.043007982269417, 6.98275194743395], "policy_predator_policy_reward": [6.284194033379054, 36.85292807702954, 41.9122732374054, 18.311469117265077, 31.08510095112554, 36.624773674008885, 6.145734800491592, 30.75956065840347, -5.767961348007649, 1.6836871005418246, -2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972, -2.4696950801068454, 2.51087470040666, 1.9923872217084124, 0.8378870534343008, 6.529558883350589, 0.97972240746072, 0.020350227098141715, -11.043007982269417, -6.98275194743395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3036207916685129, "mean_inference_ms": 1.0101696251564218, "mean_action_processing_ms": 0.13256263839898166, "mean_env_wait_ms": 0.22482183233341402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029349327087402344, "StateBufferConnector_ms": 0.002168416976928711, "ViewRequirementAgentConnector_ms": 0.05202925205230713}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 816.6707133785072, "num_env_steps_trained_throughput_per_sec": 816.6707133785072, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 5033.419, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5033.389, "sample_time_ms": 747.34, "learn_time_ms": 4276.315, "learn_throughput": 935.385, "synch_weights_time_ms": 9.423}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 194, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-21", "timestamp": 1723386801, "time_this_iter_s": 4.90055775642395, "time_total_s": 1001.2959291934967, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22b4700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1001.2959291934967, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 32.214285714285715, "ram_util_percent": 80.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7709187084808946, "cur_kl_coeff": 0.00042282825852453255, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2394730212166905, "policy_loss": -0.004947832213413979, "vf_loss": 1.2444169607013464, "vf_explained_var": 0.03925494533032179, "kl": 0.009205584383976347, "entropy": 0.31709077130071817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9516483454033733, "cur_kl_coeff": 1.6005263520774134e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2594005959263692, "policy_loss": 0.00011775707486473644, "vf_loss": 1.259282836286972, "vf_explained_var": 0.03744993768632412, "kl": 0.0025046320492019694, "entropy": 0.4062508157764872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.94, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36694, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -1.7470108071230397, "predator_policy": 1.7470108071230397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 82], "policy_prey_policy_reward": [2.771358363073162, 2.531273451726733, -0.03924164821752285, -6.244047101899191, -3.1014336730651344, 4.58966116193854, 10.231234434725716, 19.641516957294094, 3.520810965852352, -5.1740774103515115, -6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972, 2.4696950801068454, -2.51087470040666, -1.9923872217084124, -0.8378870534343008, -6.529558883350589, -0.97972240746072, -0.020350227098141715, 11.043007982269417, 6.98275194743395, -34.393634304998095, -14.991339537537606, -1.1545470821693122, 0.5559400317038552, 11.989226019209687, -0.03428358788402619, 1.1716318095099254, -1.6899026729239566, 1.9184767042717823, -17.90996524077905], "policy_predator_policy_reward": [-2.771358363073162, -2.531273451726733, 0.03924164821752285, 6.244047101899191, 3.1014336730651344, -4.58966116193854, -10.231234434725716, -19.641516957294094, -3.520810965852352, 5.1740774103515115, 6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972, -2.4696950801068454, 2.51087470040666, 1.9923872217084124, 0.8378870534343008, 6.529558883350589, 0.97972240746072, 0.020350227098141715, -11.043007982269417, -6.98275194743395, 34.393634304998095, 14.991339537537606, 1.1545470821693122, -0.5559400317038552, -11.989226019209687, 0.03428358788402619, -1.1716318095099254, 1.6899026729239566, -1.9184767042717823, 17.90996524077905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3035687524125343, "mean_inference_ms": 1.01008282864418, "mean_action_processing_ms": 0.13252204822194855, "mean_env_wait_ms": 0.22466653608768664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029484033584594727, "StateBufferConnector_ms": 0.0021779537200927734, "ViewRequirementAgentConnector_ms": 0.053093552589416504}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 744.6761026896767, "num_env_steps_trained_throughput_per_sec": 744.6761026896767, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 5065.805, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5065.775, "sample_time_ms": 745.889, "learn_time_ms": 4309.992, "learn_throughput": 928.076, "synch_weights_time_ms": 9.581}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 195, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-26", "timestamp": 1723386806, "time_this_iter_s": 5.391919136047363, "time_total_s": 1006.6878483295441, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a23fe8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1006.6878483295441, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 42.25714285714286, "ram_util_percent": 80.74285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0317279460219044, "cur_kl_coeff": 0.00042282825852453255, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9928359073276322, "policy_loss": -0.0028159041226899716, "vf_loss": 0.9956482810589175, "vf_explained_var": 0.13067615771045288, "kl": 0.00834244213358509, "entropy": 0.3577671916844944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0795515812002123, "cur_kl_coeff": 8.002631760387067e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0128959767520427, "policy_loss": -0.011372044755747386, "vf_loss": 1.0242680182059607, "vf_explained_var": 0.12973525288204352, "kl": 0.0764900056133029, "entropy": 0.5699751174698273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 364.59, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36459, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -27.57332473193121}, "policy_reward_max": {"prey_policy": 27.57332473193121, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -2.4213852438166423, "predator_policy": 2.4213852438166423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 165, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-6.478273496550962, -6.925244612806846, -0.860124589072953, -9.801237864024058, -0.5111117514387686, 23.019153782202544, 27.57332473193121, -17.30467537657263, 7.923450226598142, 19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972, 2.4696950801068454, -2.51087470040666, -1.9923872217084124, -0.8378870534343008, -6.529558883350589, -0.97972240746072, -0.020350227098141715, 11.043007982269417, 6.98275194743395, -34.393634304998095, -14.991339537537606, -1.1545470821693122, 0.5559400317038552, 11.989226019209687, -0.03428358788402619, 1.1716318095099254, -1.6899026729239566, 1.9184767042717823, -17.90996524077905, -16.638297315615077, -4.980477554250996, -24.405647709296815, 14.40900048876816, -27.148108634043396, 5.91711281224622, -2.3562987138371803, 5.946285579321479, 4.616850050343537, 5.9291928280809785], "policy_predator_policy_reward": [6.478273496550962, 6.925244612806846, 0.860124589072953, 9.801237864024058, 0.5111117514387686, -23.019153782202544, -27.57332473193121, 17.30467537657263, -7.923450226598142, -19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972, -2.4696950801068454, 2.51087470040666, 1.9923872217084124, 0.8378870534343008, 6.529558883350589, 0.97972240746072, 0.020350227098141715, -11.043007982269417, -6.98275194743395, 34.393634304998095, 14.991339537537606, 1.1545470821693122, -0.5559400317038552, -11.989226019209687, 0.03428358788402619, -1.1716318095099254, 1.6899026729239566, -1.9184767042717823, 17.90996524077905, 16.638297315615077, 4.980477554250996, 24.405647709296815, -14.40900048876816, 27.148108634043396, -5.91711281224622, 2.3562987138371803, -5.946285579321479, -4.616850050343537, -5.9291928280809785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30358729613552754, "mean_inference_ms": 1.009978861744068, "mean_action_processing_ms": 0.13254307273144725, "mean_env_wait_ms": 0.22469858816111313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029679536819458008, "StateBufferConnector_ms": 0.0021566152572631836, "ViewRequirementAgentConnector_ms": 0.05369758605957031}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 714.710723100127, "num_env_steps_trained_throughput_per_sec": 714.710723100127, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 5106.829, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5106.799, "sample_time_ms": 776.678, "learn_time_ms": 4320.17, "learn_throughput": 925.889, "synch_weights_time_ms": 9.628}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 196, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-32", "timestamp": 1723386812, "time_this_iter_s": 5.600471019744873, "time_total_s": 1012.2883193492889, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22fe1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1012.2883193492889, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 36.0875, "ram_util_percent": 80.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.089831595743696, "cur_kl_coeff": 0.00042282825852453255, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1685318641364575, "policy_loss": -0.003738878575677518, "vf_loss": 1.1722660244752963, "vf_explained_var": 0.33050722802678745, "kl": 0.011159575734795752, "entropy": 0.40242069801315666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1632104731475312, "cur_kl_coeff": 1.2003947640580606e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1499962463974953, "policy_loss": -0.005448228055320215, "vf_loss": 1.1554444761636355, "vf_explained_var": 0.3213527555887898, "kl": 0.02767481929089845, "entropy": 0.6386607316633065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 364.29, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36429, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -19.54882873949634}, "policy_reward_max": {"prey_policy": 19.54882873949634, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -2.5741622911581667, "predator_policy": 2.5741622911581667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 65, 400, 400, 400, 168, 400, 400, 400, 96, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 370, 400], "policy_prey_policy_reward": [19.54882873949634, -12.564672960807847, 0.949875245350956, 9.122392271043466, -7.752391120329541, -14.39203027207682, 11.798895707391459, 0.5810141122591865, -18.37835765714675, -28.01385699241098, 9.820984204496586, 11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972, 2.4696950801068454, -2.51087470040666, -1.9923872217084124, -0.8378870534343008, -6.529558883350589, -0.97972240746072, -0.020350227098141715, 11.043007982269417, 6.98275194743395, -34.393634304998095, -14.991339537537606, -1.1545470821693122, 0.5559400317038552, 11.989226019209687, -0.03428358788402619, 1.1716318095099254, -1.6899026729239566, 1.9184767042717823, -17.90996524077905, -16.638297315615077, -4.980477554250996, -24.405647709296815, 14.40900048876816, -27.148108634043396, 5.91711281224622, -2.3562987138371803, 5.946285579321479, 4.616850050343537, 5.9291928280809785, 17.99726894601922, 6.434900715892326, -12.310756716418084, -5.930755179714328, -2.7882693968933943, 8.861553874966429, 1.965787318414531, -19.307844782314007, 6.435671536160537], "policy_predator_policy_reward": [-19.54882873949634, 12.564672960807847, -0.949875245350956, -9.122392271043466, 7.752391120329541, 14.39203027207682, -11.798895707391459, -0.5810141122591865, 18.37835765714675, 28.01385699241098, -9.820984204496586, -11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972, -2.4696950801068454, 2.51087470040666, 1.9923872217084124, 0.8378870534343008, 6.529558883350589, 0.97972240746072, 0.020350227098141715, -11.043007982269417, -6.98275194743395, 34.393634304998095, 14.991339537537606, 1.1545470821693122, -0.5559400317038552, -11.989226019209687, 0.03428358788402619, -1.1716318095099254, 1.6899026729239566, -1.9184767042717823, 17.90996524077905, 16.638297315615077, 4.980477554250996, 24.405647709296815, -14.40900048876816, 27.148108634043396, -5.91711281224622, 2.3562987138371803, -5.946285579321479, -4.616850050343537, -5.9291928280809785, -17.99726894601922, -6.434900715892326, 12.310756716418084, 5.930755179714328, 2.7882693968933943, -8.861553874966429, -1.965787318414531, 19.307844782314007, -6.435671536160537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.303540363415016, "mean_inference_ms": 1.0099971611744807, "mean_action_processing_ms": 0.13254556705328574, "mean_env_wait_ms": 0.22477968389639277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029082298278808594, "StateBufferConnector_ms": 0.0021054744720458984, "ViewRequirementAgentConnector_ms": 0.05311393737792969}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.2436931730078, "num_env_steps_trained_throughput_per_sec": 785.2436931730078, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 1576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1576000, "timers": {"training_iteration_time_ms": 5111.132, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5111.101, "sample_time_ms": 783.38, "learn_time_ms": 4317.743, "learn_throughput": 926.41, "synch_weights_time_ms": 9.654}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "done": false, "training_iteration": 197, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-37", "timestamp": 1723386817, "time_this_iter_s": 5.096627950668335, "time_total_s": 1017.3849472999573, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a23fe820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1017.3849472999573, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 32.78571428571429, "ram_util_percent": 80.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.232367473654449, "cur_kl_coeff": 0.00042282825852453255, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1212336037928858, "policy_loss": -0.004540556782012572, "vf_loss": 1.1257685039968541, "vf_explained_var": 0.279697557600836, "kl": 0.013371082230259651, "entropy": 0.3655883934814483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.350261708224813, "cur_kl_coeff": 1.80059214608709e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1440031964952746, "policy_loss": -0.003306733726155168, "vf_loss": 1.1473099330440164, "vf_explained_var": 0.2824992199117939, "kl": 0.010906374152602035, "entropy": 0.5926555860166748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 370.42, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37042, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -17.99726894601922}, "policy_reward_max": {"prey_policy": 17.99726894601922, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -2.8255338391282914, "predator_policy": 2.8255338391282914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 370, 400, 400, 400, 400, 306, 400, 400, 400, 400, 236, 400, 400], "policy_prey_policy_reward": [11.018413717195138, -11.085106783252174, 5.620171046669654, 6.994120504091821, 16.774369448158346, 8.036109105015399, 1.035706270425166, -7.525022689780368, -0.8615550094737472, 7.360499043951384, 5.48955901857631, 1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972, 2.4696950801068454, -2.51087470040666, -1.9923872217084124, -0.8378870534343008, -6.529558883350589, -0.97972240746072, -0.020350227098141715, 11.043007982269417, 6.98275194743395, -34.393634304998095, -14.991339537537606, -1.1545470821693122, 0.5559400317038552, 11.989226019209687, -0.03428358788402619, 1.1716318095099254, -1.6899026729239566, 1.9184767042717823, -17.90996524077905, -16.638297315615077, -4.980477554250996, -24.405647709296815, 14.40900048876816, -27.148108634043396, 5.91711281224622, -2.3562987138371803, 5.946285579321479, 4.616850050343537, 5.9291928280809785, 17.99726894601922, 6.434900715892326, -12.310756716418084, -5.930755179714328, -2.7882693968933943, 8.861553874966429, 1.965787318414531, -19.307844782314007, 6.435671536160537, 5.720983679063469, -20.951331513722188, 6.705583212707722, -12.817501039205485, -5.5498728865650655, -9.955678596728603, 4.342977243795353, -17.8660427995554, -15.810374678920908, -0.47651497922245056, 12.241298838607177], "policy_predator_policy_reward": [-11.018413717195138, 11.085106783252174, -5.620171046669654, -6.994120504091821, -16.774369448158346, -8.036109105015399, -1.035706270425166, 7.525022689780368, 0.8615550094737472, -7.360499043951384, -5.48955901857631, -1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972, -2.4696950801068454, 2.51087470040666, 1.9923872217084124, 0.8378870534343008, 6.529558883350589, 0.97972240746072, 0.020350227098141715, -11.043007982269417, -6.98275194743395, 34.393634304998095, 14.991339537537606, 1.1545470821693122, -0.5559400317038552, -11.989226019209687, 0.03428358788402619, -1.1716318095099254, 1.6899026729239566, -1.9184767042717823, 17.90996524077905, 16.638297315615077, 4.980477554250996, 24.405647709296815, -14.40900048876816, 27.148108634043396, -5.91711281224622, 2.3562987138371803, -5.946285579321479, -4.616850050343537, -5.9291928280809785, -17.99726894601922, -6.434900715892326, 12.310756716418084, 5.930755179714328, 2.7882693968933943, -8.861553874966429, -1.965787318414531, 19.307844782314007, -6.435671536160537, -5.720983679063469, 20.951331513722188, -6.705583212707722, 12.817501039205485, 5.5498728865650655, 9.955678596728603, -4.342977243795353, 17.8660427995554, 15.810374678920908, 0.47651497922245056, -12.241298838607177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30351600899437275, "mean_inference_ms": 1.0100287679844957, "mean_action_processing_ms": 0.13253167533551313, "mean_env_wait_ms": 0.22477256533151693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029736757278442383, "StateBufferConnector_ms": 0.002130746841430664, "ViewRequirementAgentConnector_ms": 0.05323934555053711}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.9378425604282, "num_env_steps_trained_throughput_per_sec": 777.9378425604282, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 5118.778, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5118.747, "sample_time_ms": 784.264, "learn_time_ms": 4324.439, "learn_throughput": 924.975, "synch_weights_time_ms": 9.721}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 198, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-42", "timestamp": 1723386822, "time_this_iter_s": 5.144453048706055, "time_total_s": 1022.5294003486633, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22fe5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1022.5294003486633, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 30.15, "ram_util_percent": 80.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0322337177271645, "cur_kl_coeff": 0.00042282825852453255, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0378944247340163, "policy_loss": -0.00035085984782199373, "vf_loss": 1.0382436376375457, "vf_explained_var": 0.14792412544290226, "kl": 0.003890584141651813, "entropy": 0.3381664504762739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.061878455244005, "cur_kl_coeff": 1.80059214608709e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0469797542551533, "policy_loss": -0.0028056354543271786, "vf_loss": 1.0497853913810105, "vf_explained_var": 0.14005857643981776, "kl": 0.0037040072585236956, "entropy": 0.5659617376203339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 368.14, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36814, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -17.99726894601922}, "policy_reward_max": {"prey_policy": 17.99726894601922, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -3.943323653299391, "predator_policy": 3.943323653299391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 357, 400, 400, 400, 400, 41, 400, 49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 370, 400, 400, 400, 400, 306, 400, 400, 400, 400, 236, 400, 400, 400, 90, 400, 130, 400, 400, 400, 400, 400, 400, 387], "policy_prey_policy_reward": [1.5365826112439116, -1.0503749915103455, 6.517404584690279, -14.747305135315116, -4.935115948503858, -8.108020467164522, -21.506636138844307, 6.918622292597995, -1.4637561231268155, -21.860758378425594, -0.038570879808645486, -16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972, 2.4696950801068454, -2.51087470040666, -1.9923872217084124, -0.8378870534343008, -6.529558883350589, -0.97972240746072, -0.020350227098141715, 11.043007982269417, 6.98275194743395, -34.393634304998095, -14.991339537537606, -1.1545470821693122, 0.5559400317038552, 11.989226019209687, -0.03428358788402619, 1.1716318095099254, -1.6899026729239566, 1.9184767042717823, -17.90996524077905, -16.638297315615077, -4.980477554250996, -24.405647709296815, 14.40900048876816, -27.148108634043396, 5.91711281224622, -2.3562987138371803, 5.946285579321479, 4.616850050343537, 5.9291928280809785, 17.99726894601922, 6.434900715892326, -12.310756716418084, -5.930755179714328, -2.7882693968933943, 8.861553874966429, 1.965787318414531, -19.307844782314007, 6.435671536160537, 5.720983679063469, -20.951331513722188, 6.705583212707722, -12.817501039205485, -5.5498728865650655, -9.955678596728603, 4.342977243795353, -17.8660427995554, -15.810374678920908, -0.47651497922245056, 12.241298838607177, -3.1698560921554897, -30.73448708896472, -2.9185809703604804, -6.631573560316319, -2.633626515651258, -9.650862916242453, -5.320322066858559, -1.2225645819788724, -1.2286362632584087, 15.103411157743562, -20.51461884748997], "policy_predator_policy_reward": [-1.5365826112439116, 1.0503749915103455, -6.517404584690279, 14.747305135315116, 4.935115948503858, 8.108020467164522, 21.506636138844307, -6.918622292597995, 1.4637561231268155, 21.860758378425594, 0.038570879808645486, 16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972, -2.4696950801068454, 2.51087470040666, 1.9923872217084124, 0.8378870534343008, 6.529558883350589, 0.97972240746072, 0.020350227098141715, -11.043007982269417, -6.98275194743395, 34.393634304998095, 14.991339537537606, 1.1545470821693122, -0.5559400317038552, -11.989226019209687, 0.03428358788402619, -1.1716318095099254, 1.6899026729239566, -1.9184767042717823, 17.90996524077905, 16.638297315615077, 4.980477554250996, 24.405647709296815, -14.40900048876816, 27.148108634043396, -5.91711281224622, 2.3562987138371803, -5.946285579321479, -4.616850050343537, -5.9291928280809785, -17.99726894601922, -6.434900715892326, 12.310756716418084, 5.930755179714328, 2.7882693968933943, -8.861553874966429, -1.965787318414531, 19.307844782314007, -6.435671536160537, -5.720983679063469, 20.951331513722188, -6.705583212707722, 12.817501039205485, 5.5498728865650655, 9.955678596728603, -4.342977243795353, 17.8660427995554, 15.810374678920908, 0.47651497922245056, -12.241298838607177, 3.1698560921554897, 30.73448708896472, 2.9185809703604804, 6.631573560316319, 2.633626515651258, 9.650862916242453, 5.320322066858559, 1.2225645819788724, 1.2286362632584087, -15.103411157743562, 20.51461884748997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30352714725159796, "mean_inference_ms": 1.0098955459496226, "mean_action_processing_ms": 0.13255646819092207, "mean_env_wait_ms": 0.22479211700496682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029795169830322266, "StateBufferConnector_ms": 0.0021272897720336914, "ViewRequirementAgentConnector_ms": 0.054283857345581055}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.0572551820985, "num_env_steps_trained_throughput_per_sec": 803.0572551820985, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 1592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1592000, "timers": {"training_iteration_time_ms": 5115.766, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5115.734, "sample_time_ms": 784.019, "learn_time_ms": 4321.705, "learn_throughput": 925.561, "synch_weights_time_ms": 9.689}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "done": false, "training_iteration": 199, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-47", "timestamp": 1723386827, "time_this_iter_s": 4.983707904815674, "time_total_s": 1027.513108253479, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1027.513108253479, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 31.571428571428573, "ram_util_percent": 80.32857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8791359200763205, "cur_kl_coeff": 0.00021141412926226627, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.33320741225034, "policy_loss": -0.0046941281216277275, "vf_loss": 1.337900894228369, "vf_explained_var": -0.029596031022568543, "kl": 0.003064689419086399, "entropy": 0.3173819949229558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8533015201023468, "cur_kl_coeff": 9.00296073043545e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.330033594102133, "policy_loss": -0.002751608318067156, "vf_loss": 1.3327852011968693, "vf_explained_var": -0.03485081320007642, "kl": 0.009846703868924094, "entropy": 0.46960740530242523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.7, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36970, "policy_reward_min": {"prey_policy": -46.72507479477309, "predator_policy": -17.99726894601922}, "policy_reward_max": {"prey_policy": 17.99726894601922, "predator_policy": 46.72507479477309}, "policy_reward_mean": {"prey_policy": -4.072418646223469, "predator_policy": 4.072418646223469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [49, 400, 400, 400, 107, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 308, 197, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 346, 400, 400, 400, 400, 400, 400, 400, 400, 82, 400, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 370, 400, 400, 400, 400, 306, 400, 400, 400, 400, 236, 400, 400, 400, 90, 400, 130, 400, 400, 400, 400, 400, 400, 387, 400, 154, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-16.525646721218703, -4.710547362803858, 7.7911465594206675, 9.270069571383612, -21.285114805533325, -6.923853322348606, -7.2526891529228905, 3.752427665115892, 4.372569757417603, -12.080625094476297, -17.095293337587666, -4.689012920253056, 11.632220697180227, -7.740303224503009, -0.7666115986723128, -11.795099562683838, 0.18319263505185646, -0.7549303657121627, 3.386448534081012, 11.059754667834818, 0.5109749027329826, -22.342044855062085, -46.72507479477309, -7.790105341742681, -11.290750466660022, -1.1612089488590396, 9.489682619310436, 2.9842960449111438, 8.506437928294972, 2.4696950801068454, -2.51087470040666, -1.9923872217084124, -0.8378870534343008, -6.529558883350589, -0.97972240746072, -0.020350227098141715, 11.043007982269417, 6.98275194743395, -34.393634304998095, -14.991339537537606, -1.1545470821693122, 0.5559400317038552, 11.989226019209687, -0.03428358788402619, 1.1716318095099254, -1.6899026729239566, 1.9184767042717823, -17.90996524077905, -16.638297315615077, -4.980477554250996, -24.405647709296815, 14.40900048876816, -27.148108634043396, 5.91711281224622, -2.3562987138371803, 5.946285579321479, 4.616850050343537, 5.9291928280809785, 17.99726894601922, 6.434900715892326, -12.310756716418084, -5.930755179714328, -2.7882693968933943, 8.861553874966429, 1.965787318414531, -19.307844782314007, 6.435671536160537, 5.720983679063469, -20.951331513722188, 6.705583212707722, -12.817501039205485, -5.5498728865650655, -9.955678596728603, 4.342977243795353, -17.8660427995554, -15.810374678920908, -0.47651497922245056, 12.241298838607177, -3.1698560921554897, -30.73448708896472, -2.9185809703604804, -6.631573560316319, -2.633626515651258, -9.650862916242453, -5.320322066858559, -1.2225645819788724, -1.2286362632584087, 15.103411157743562, -20.51461884748997, -3.5947079147365173, -41.30729921140511, 0.7044394887070808, 9.438303499469079, -6.4973132004226954, -0.12558066761592102, -3.9620257907715626, -14.399424866131252, 1.2665728757809944, -5.510026166378832, -7.660365913070098], "policy_predator_policy_reward": [16.525646721218703, 4.710547362803858, -7.7911465594206675, -9.270069571383612, 21.285114805533325, 6.923853322348606, 7.2526891529228905, -3.752427665115892, -4.372569757417603, 12.080625094476297, 17.095293337587666, 4.689012920253056, -11.632220697180227, 7.740303224503009, 0.7666115986723128, 11.795099562683838, -0.18319263505185646, 0.7549303657121627, -3.386448534081012, -11.059754667834818, -0.5109749027329826, 22.342044855062085, 46.72507479477309, 7.790105341742681, 11.290750466660022, 1.1612089488590396, -9.489682619310436, -2.9842960449111438, -8.506437928294972, -2.4696950801068454, 2.51087470040666, 1.9923872217084124, 0.8378870534343008, 6.529558883350589, 0.97972240746072, 0.020350227098141715, -11.043007982269417, -6.98275194743395, 34.393634304998095, 14.991339537537606, 1.1545470821693122, -0.5559400317038552, -11.989226019209687, 0.03428358788402619, -1.1716318095099254, 1.6899026729239566, -1.9184767042717823, 17.90996524077905, 16.638297315615077, 4.980477554250996, 24.405647709296815, -14.40900048876816, 27.148108634043396, -5.91711281224622, 2.3562987138371803, -5.946285579321479, -4.616850050343537, -5.9291928280809785, -17.99726894601922, -6.434900715892326, 12.310756716418084, 5.930755179714328, 2.7882693968933943, -8.861553874966429, -1.965787318414531, 19.307844782314007, -6.435671536160537, -5.720983679063469, 20.951331513722188, -6.705583212707722, 12.817501039205485, 5.5498728865650655, 9.955678596728603, -4.342977243795353, 17.8660427995554, 15.810374678920908, 0.47651497922245056, -12.241298838607177, 3.1698560921554897, 30.73448708896472, 2.9185809703604804, 6.631573560316319, 2.633626515651258, 9.650862916242453, 5.320322066858559, 1.2225645819788724, 1.2286362632584087, -15.103411157743562, 20.51461884748997, 3.5947079147365173, 41.30729921140511, -0.7044394887070808, -9.438303499469079, 6.4973132004226954, 0.12558066761592102, 3.9620257907715626, 14.399424866131252, -1.2665728757809944, 5.510026166378832, 7.660365913070098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30345457472105425, "mean_inference_ms": 1.009871146876924, "mean_action_processing_ms": 0.13252684569427556, "mean_env_wait_ms": 0.22483455783879552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030215978622436523, "StateBufferConnector_ms": 0.0023834705352783203, "ViewRequirementAgentConnector_ms": 0.05432307720184326}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.129651703007, "num_env_steps_trained_throughput_per_sec": 805.129651703007, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 5107.237, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5107.206, "sample_time_ms": 780.351, "learn_time_ms": 4316.792, "learn_throughput": 926.614, "synch_weights_time_ms": 9.74}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 200, "trial_id": "4a6aa_00000", "date": "2024-08-11_10-33-52", "timestamp": 1723386832, "time_this_iter_s": 4.970847845077515, "time_total_s": 1032.4839560985565, "pid": 31061, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22f1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (1,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1032.4839560985565, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 30.9, "ram_util_percent": 80.32857142857142}}
