{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1377909019510581, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.979996236985323, "policy_loss": 0.0007204723453257607, "vf_loss": 2.9741819237905833, "vf_explained_var": 0.00798242312890512, "kl": 0.025469176512625483, "entropy": 1.6010713067635027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4006411270332084, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7942000960546824, "policy_loss": -0.00071656214561136, "vf_loss": 4.790029193736888, "vf_explained_var": 0.009562243292571375, "kl": 0.02443736204335456, "entropy": 1.603693923874507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 250.0, "episode_reward_min": -149.0, "episode_reward_mean": 9.444444444444445, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -166.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 168.0, "predator_policy": 114.0}, "policy_reward_mean": {"prey_policy": -19.61111111111111, "predator_policy": 24.333333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -21.0, -66.0, -26.0, 67.0, 250.0, 33.0, 109.0, -52.0, -27.0, 24.0, -6.0, -78.0, 0.0, 61.0, 49.0, -149.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 0.0, 0.0, 0.0, -45.0, 0.0, -142.0, 0.0, -5.0, -88.0, 55.0, -63.0, 79.0, 168.0, 2.0, 0.0, 89.0, -25.0, -82.0, -22.0, 0.0, -54.0, -116.0, 2.0, -58.0, 4.0, -146.0, -46.0, 0.0, 0.0, 38.0, -30.0, 12.0, 31.0, -99.0, -166.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 0.0, 0.0, 24.0, 47.0, 29.0, 67.0, 0.0, 75.0, 0.0, 3.0, 0.0, 15.0, 16.0, 41.0, 4.0, 51.0, 1.0, 27.0, 0.0, 82.0, 56.0, 0.0, 48.0, 0.0, 114.0, 0.0, 0.0, 53.0, 0.0, 0.0, 6.0, 102.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6926793360932648, "mean_inference_ms": 1.597805351490576, "mean_action_processing_ms": 0.30150137418374484, "mean_env_wait_ms": 0.22158162904026096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007815493477715386, "StateBufferConnector_ms": 0.0035299195183648, "ViewRequirementAgentConnector_ms": 0.1143793265024821}, "num_episodes": 18, "episode_return_max": 250.0, "episode_return_min": -149.0, "episode_return_mean": 9.444444444444445, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.54962153098454, "num_env_steps_trained_throughput_per_sec": 70.54962153098454, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 56697.689, "restore_workers_time_ms": 0.019, "training_step_time_ms": 56697.638, "sample_time_ms": 1368.125, "learn_time_ms": 55312.885, "learn_throughput": 72.316, "synch_weights_time_ms": 14.83}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-51-16", "timestamp": 1723517476, "time_this_iter_s": 56.77129101753235, "time_total_s": 56.77129101753235, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7ff35e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.77129101753235, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.18148148148148, "ram_util_percent": 83.27901234567902}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7307987197050974, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9483571881339663, "policy_loss": -0.010907701625877982, "vf_loss": 3.9571057749803735, "vf_explained_var": 0.012918414735289478, "kl": 0.007197081283296155, "entropy": 1.5843275566580435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.526492405126965, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.990701596194474, "policy_loss": -0.011497552652729962, "vf_loss": 7.000462324404842, "vf_explained_var": 0.04826845946135344, "kl": 0.005789494158458019, "entropy": 1.5978068345438237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -149.0, "episode_reward_mean": 37.416666666666664, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -226.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.0, "predator_policy": 127.0}, "policy_reward_mean": {"prey_policy": -5.416666666666667, "predator_policy": 24.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -21.0, -66.0, -26.0, 67.0, 250.0, 33.0, 109.0, -52.0, -27.0, 24.0, -6.0, -78.0, 0.0, 61.0, 49.0, -149.0, 147.0, 228.0, -40.0, -71.0, 65.0, -112.0, 30.0, 211.0, 215.0, 110.0, 69.0, 312.0, -75.0, -25.0, 63.0, 44.0, 23.0, -17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 0.0, 0.0, 0.0, -45.0, 0.0, -142.0, 0.0, -5.0, -88.0, 55.0, -63.0, 79.0, 168.0, 2.0, 0.0, 89.0, -25.0, -82.0, -22.0, 0.0, -54.0, -116.0, 2.0, -58.0, 4.0, -146.0, -46.0, 0.0, 0.0, 38.0, -30.0, 12.0, 31.0, -99.0, -166.0, -54.0, 174.0, 91.0, 133.0, -62.0, -70.0, -158.0, -17.0, -8.0, 55.0, -64.0, -226.0, 6.0, 24.0, 178.0, 10.0, 183.0, -19.0, 0.0, 100.0, 31.0, 33.0, 164.0, 148.0, -166.0, 0.0, 45.0, -188.0, 63.0, -64.0, 90.0, -101.0, 16.0, 4.0, -25.0, -10.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 0.0, 0.0, 24.0, 47.0, 29.0, 67.0, 0.0, 75.0, 0.0, 3.0, 0.0, 15.0, 16.0, 41.0, 4.0, 51.0, 1.0, 27.0, 0.0, 82.0, 56.0, 0.0, 48.0, 0.0, 114.0, 0.0, 0.0, 53.0, 0.0, 0.0, 6.0, 102.0, 14.0, 0.0, 27.0, 4.0, 0.0, 31.0, 61.0, 79.0, 25.0, 18.0, 0.0, 127.0, 51.0, 0.0, 0.0, 23.0, 0.0, 17.0, 34.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 79.0, 12.0, 0.0, 118.0, 46.0, 18.0, 55.0, 0.0, 3.0, 0.0, 5.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6745229167433151, "mean_inference_ms": 1.5432061626080196, "mean_action_processing_ms": 0.28811408938191096, "mean_env_wait_ms": 0.2141707249406968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007371107737223308, "StateBufferConnector_ms": 0.0033534235424465602, "ViewRequirementAgentConnector_ms": 0.10877317852444118}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -149.0, "episode_return_mean": 37.416666666666664, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.26586180355066, "num_env_steps_trained_throughput_per_sec": 73.26586180355066, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 55646.708, "restore_workers_time_ms": 0.025, "training_step_time_ms": 55646.633, "sample_time_ms": 1289.653, "learn_time_ms": 54340.518, "learn_throughput": 73.61, "synch_weights_time_ms": 14.887}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-52-14", "timestamp": 1723517534, "time_this_iter_s": 54.60717415809631, "time_total_s": 111.37846517562866, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a806e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.37846517562866, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.10243902439024, "ram_util_percent": 83.33414634146342}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9632539967065135, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3410629351933796, "policy_loss": -0.011073309903294241, "vf_loss": 3.3504062068525444, "vf_explained_var": 0.0161202003716161, "kl": 0.00576680123456684, "entropy": 1.5870155334472655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1736966358921515, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.369816852498937, "policy_loss": -0.015177596416373654, "vf_loss": 8.382273713369218, "vf_explained_var": 0.08861155443721347, "kl": 0.009069155903535886, "entropy": 1.5775053383812072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 353.0, "episode_reward_min": -189.0, "episode_reward_mean": 64.77777777777777, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -250.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 144.0}, "policy_reward_mean": {"prey_policy": 7.87037037037037, "predator_policy": 24.51851851851852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -21.0, -66.0, -26.0, 67.0, 250.0, 33.0, 109.0, -52.0, -27.0, 24.0, -6.0, -78.0, 0.0, 61.0, 49.0, -149.0, 147.0, 228.0, -40.0, -71.0, 65.0, -112.0, 30.0, 211.0, 215.0, 110.0, 69.0, 312.0, -75.0, -25.0, 63.0, 44.0, 23.0, -17.0, 105.0, 162.0, -14.0, 189.0, 158.0, 199.0, 145.0, 201.0, -17.0, 136.0, -40.0, 285.0, 18.0, -189.0, 155.0, 353.0, 116.0, 189.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 0.0, 0.0, 0.0, -45.0, 0.0, -142.0, 0.0, -5.0, -88.0, 55.0, -63.0, 79.0, 168.0, 2.0, 0.0, 89.0, -25.0, -82.0, -22.0, 0.0, -54.0, -116.0, 2.0, -58.0, 4.0, -146.0, -46.0, 0.0, 0.0, 38.0, -30.0, 12.0, 31.0, -99.0, -166.0, -54.0, 174.0, 91.0, 133.0, -62.0, -70.0, -158.0, -17.0, -8.0, 55.0, -64.0, -226.0, 6.0, 24.0, 178.0, 10.0, 183.0, -19.0, 0.0, 100.0, 31.0, 33.0, 164.0, 148.0, -166.0, 0.0, 45.0, -188.0, 63.0, -64.0, 90.0, -101.0, 16.0, 4.0, -25.0, -10.0, 22.0, -9.0, 33.0, 100.0, -28.0, 0.0, 155.0, 20.0, 8.0, 137.0, 125.0, -1.0, 0.0, 122.0, 105.0, 67.0, -51.0, 5.0, 45.0, 38.0, -104.0, -58.0, 110.0, 175.0, -10.0, -4.0, -96.0, -250.0, 75.0, 21.0, 200.0, 132.0, 29.0, 21.0, 85.0, 21.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 0.0, 0.0, 24.0, 47.0, 29.0, 67.0, 0.0, 75.0, 0.0, 3.0, 0.0, 15.0, 16.0, 41.0, 4.0, 51.0, 1.0, 27.0, 0.0, 82.0, 56.0, 0.0, 48.0, 0.0, 114.0, 0.0, 0.0, 53.0, 0.0, 0.0, 6.0, 102.0, 14.0, 0.0, 27.0, 4.0, 0.0, 31.0, 61.0, 79.0, 25.0, 18.0, 0.0, 127.0, 51.0, 0.0, 0.0, 23.0, 0.0, 17.0, 34.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 79.0, 12.0, 0.0, 118.0, 46.0, 18.0, 55.0, 0.0, 3.0, 0.0, 5.0, 13.0, 72.0, 20.0, 2.0, 27.0, 14.0, 0.0, 0.0, 14.0, 0.0, 13.0, 16.0, 59.0, 8.0, 15.0, 4.0, 25.0, 0.0, 29.0, 28.0, 25.0, 0.0, 122.0, 0.0, 0.0, 0.0, 32.0, 144.0, 13.0, 23.0, 36.0, 21.0, 0.0, 27.0, 39.0, 28.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6680727656116924, "mean_inference_ms": 1.528796358491859, "mean_action_processing_ms": 0.2824469836547332, "mean_env_wait_ms": 0.2103654116204203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007195163656164099, "StateBufferConnector_ms": 0.003320861745763708, "ViewRequirementAgentConnector_ms": 0.11331019578156648}, "num_episodes": 18, "episode_return_max": 353.0, "episode_return_min": -189.0, "episode_return_mean": 64.77777777777777, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.35847045977211, "num_env_steps_trained_throughput_per_sec": 73.35847045977211, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 55273.396, "restore_workers_time_ms": 0.022, "training_step_time_ms": 55273.329, "sample_time_ms": 1273.586, "learn_time_ms": 53981.729, "learn_throughput": 74.099, "synch_weights_time_ms": 15.047}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-53-08", "timestamp": 1723517588, "time_this_iter_s": 54.5903160572052, "time_total_s": 165.96878123283386, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7f79d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165.96878123283386, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 82.14805194805194, "ram_util_percent": 81.4012987012987}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6124664379806113, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.376453085172744, "policy_loss": -0.005177554045557463, "vf_loss": 3.38033514514802, "vf_explained_var": 0.012154800740499344, "kl": 0.004318264581140991, "entropy": 1.5765989480195222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4096368847385286, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.67364315608191, "policy_loss": -0.013660268341659239, "vf_loss": 8.684451575001711, "vf_explained_var": 0.1365782535580731, "kl": 0.00950619059400081, "entropy": 1.5594570667655379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 353.0, "episode_reward_min": -189.0, "episode_reward_mean": 90.34722222222223, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -270.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 144.0}, "policy_reward_mean": {"prey_policy": 20.479166666666668, "predator_policy": 24.694444444444443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -21.0, -66.0, -26.0, 67.0, 250.0, 33.0, 109.0, -52.0, -27.0, 24.0, -6.0, -78.0, 0.0, 61.0, 49.0, -149.0, 147.0, 228.0, -40.0, -71.0, 65.0, -112.0, 30.0, 211.0, 215.0, 110.0, 69.0, 312.0, -75.0, -25.0, 63.0, 44.0, 23.0, -17.0, 105.0, 162.0, -14.0, 189.0, 158.0, 199.0, 145.0, 201.0, -17.0, 136.0, -40.0, 285.0, 18.0, -189.0, 155.0, 353.0, 116.0, 189.0, -91.0, 205.0, 348.0, 145.0, 36.0, 271.0, 216.0, 193.0, -4.0, 68.0, 127.0, 237.0, 340.0, 200.0, 190.0, 79.0, 210.0, 237.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 0.0, 0.0, 0.0, -45.0, 0.0, -142.0, 0.0, -5.0, -88.0, 55.0, -63.0, 79.0, 168.0, 2.0, 0.0, 89.0, -25.0, -82.0, -22.0, 0.0, -54.0, -116.0, 2.0, -58.0, 4.0, -146.0, -46.0, 0.0, 0.0, 38.0, -30.0, 12.0, 31.0, -99.0, -166.0, -54.0, 174.0, 91.0, 133.0, -62.0, -70.0, -158.0, -17.0, -8.0, 55.0, -64.0, -226.0, 6.0, 24.0, 178.0, 10.0, 183.0, -19.0, 0.0, 100.0, 31.0, 33.0, 164.0, 148.0, -166.0, 0.0, 45.0, -188.0, 63.0, -64.0, 90.0, -101.0, 16.0, 4.0, -25.0, -10.0, 22.0, -9.0, 33.0, 100.0, -28.0, 0.0, 155.0, 20.0, 8.0, 137.0, 125.0, -1.0, 0.0, 122.0, 105.0, 67.0, -51.0, 5.0, 45.0, 38.0, -104.0, -58.0, 110.0, 175.0, -10.0, -4.0, -96.0, -250.0, 75.0, 21.0, 200.0, 132.0, 29.0, 21.0, 85.0, 21.0, -270.0, 44.0, 45.0, 132.0, 179.0, 161.0, 31.0, 59.0, 100.0, -157.0, 199.0, 72.0, 50.0, 166.0, 190.0, 3.0, 6.0, -167.0, -20.0, 36.0, 35.0, 75.0, 108.0, 76.0, 115.0, 199.0, 35.0, 88.0, -25.0, 123.0, -73.0, 53.0, 57.0, 153.0, 130.0, 91.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 0.0, 0.0, 24.0, 47.0, 29.0, 67.0, 0.0, 75.0, 0.0, 3.0, 0.0, 15.0, 16.0, 41.0, 4.0, 51.0, 1.0, 27.0, 0.0, 82.0, 56.0, 0.0, 48.0, 0.0, 114.0, 0.0, 0.0, 53.0, 0.0, 0.0, 6.0, 102.0, 14.0, 0.0, 27.0, 4.0, 0.0, 31.0, 61.0, 79.0, 25.0, 18.0, 0.0, 127.0, 51.0, 0.0, 0.0, 23.0, 0.0, 17.0, 34.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 79.0, 12.0, 0.0, 118.0, 46.0, 18.0, 55.0, 0.0, 3.0, 0.0, 5.0, 13.0, 72.0, 20.0, 2.0, 27.0, 14.0, 0.0, 0.0, 14.0, 0.0, 13.0, 16.0, 59.0, 8.0, 15.0, 4.0, 25.0, 0.0, 29.0, 28.0, 25.0, 0.0, 122.0, 0.0, 0.0, 0.0, 32.0, 144.0, 13.0, 23.0, 36.0, 21.0, 0.0, 27.0, 39.0, 28.0, 55.0, 0.0, 135.0, 0.0, 28.0, 8.0, 0.0, 3.0, 52.0, 2.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 54.0, 103.0, 4.0, 48.0, 17.0, 0.0, 21.0, 32.0, 26.0, 0.0, 36.0, 41.0, 56.0, 36.0, 55.0, 44.0, 0.0, 0.0, 10.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6594143136840243, "mean_inference_ms": 1.5082642256691423, "mean_action_processing_ms": 0.27666390353809145, "mean_env_wait_ms": 0.20632346697590015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007010499636332194, "StateBufferConnector_ms": 0.003196464644538032, "ViewRequirementAgentConnector_ms": 0.10612491104337904}, "num_episodes": 18, "episode_return_max": 353.0, "episode_return_min": -189.0, "episode_return_mean": 90.34722222222223, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.69200523817435, "num_env_steps_trained_throughput_per_sec": 76.69200523817435, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 54494.217, "restore_workers_time_ms": 0.019, "training_step_time_ms": 54494.149, "sample_time_ms": 1223.462, "learn_time_ms": 53253.039, "learn_throughput": 75.113, "synch_weights_time_ms": 14.736}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-54-01", "timestamp": 1723517641, "time_this_iter_s": 52.2019989490509, "time_total_s": 218.17078018188477, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8079ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 218.17078018188477, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.138666666666662, "ram_util_percent": 77.02000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.602252773443858, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.21841364310532, "policy_loss": -0.012170300185039798, "vf_loss": 4.2290812246383185, "vf_explained_var": 0.04165725026811872, "kl": 0.010018214968392891, "entropy": 1.56991747232972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.070382625936831, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.299008847292138, "policy_loss": -0.008558714029221504, "vf_loss": 9.305633470747207, "vf_explained_var": 0.12733946688591488, "kl": 0.0064469599997188974, "entropy": 1.538856099143861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 353.0, "episode_reward_min": -189.0, "episode_reward_mean": 116.60606060606061, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -420.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 255.0}, "policy_reward_mean": {"prey_policy": 31.353535353535353, "predator_policy": 26.949494949494948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -21.0, -66.0, -26.0, 67.0, 250.0, 33.0, 109.0, -52.0, -27.0, 24.0, -6.0, -78.0, 0.0, 61.0, 49.0, -149.0, 147.0, 228.0, -40.0, -71.0, 65.0, -112.0, 30.0, 211.0, 215.0, 110.0, 69.0, 312.0, -75.0, -25.0, 63.0, 44.0, 23.0, -17.0, 105.0, 162.0, -14.0, 189.0, 158.0, 199.0, 145.0, 201.0, -17.0, 136.0, -40.0, 285.0, 18.0, -189.0, 155.0, 353.0, 116.0, 189.0, -91.0, 205.0, 348.0, 145.0, 36.0, 271.0, 216.0, 193.0, -4.0, 68.0, 127.0, 237.0, 340.0, 200.0, 190.0, 79.0, 210.0, 237.0, 144.0, 333.0, 82.0, 241.0, 296.0, 115.0, -1.0, 207.0, 263.0, 339.0, -100.0, -82.0, 108.0, 251.0, -10.0, 342.0, 260.0, 277.0, 187.0, 302.0, 211.0, 152.0, 184.0, 182.0, 121.0, 295.0, 340.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 0.0, 0.0, 0.0, -45.0, 0.0, -142.0, 0.0, -5.0, -88.0, 55.0, -63.0, 79.0, 168.0, 2.0, 0.0, 89.0, -25.0, -82.0, -22.0, 0.0, -54.0, -116.0, 2.0, -58.0, 4.0, -146.0, -46.0, 0.0, 0.0, 38.0, -30.0, 12.0, 31.0, -99.0, -166.0, -54.0, 174.0, 91.0, 133.0, -62.0, -70.0, -158.0, -17.0, -8.0, 55.0, -64.0, -226.0, 6.0, 24.0, 178.0, 10.0, 183.0, -19.0, 0.0, 100.0, 31.0, 33.0, 164.0, 148.0, -166.0, 0.0, 45.0, -188.0, 63.0, -64.0, 90.0, -101.0, 16.0, 4.0, -25.0, -10.0, 22.0, -9.0, 33.0, 100.0, -28.0, 0.0, 155.0, 20.0, 8.0, 137.0, 125.0, -1.0, 0.0, 122.0, 105.0, 67.0, -51.0, 5.0, 45.0, 38.0, -104.0, -58.0, 110.0, 175.0, -10.0, -4.0, -96.0, -250.0, 75.0, 21.0, 200.0, 132.0, 29.0, 21.0, 85.0, 21.0, -270.0, 44.0, 45.0, 132.0, 179.0, 161.0, 31.0, 59.0, 100.0, -157.0, 199.0, 72.0, 50.0, 166.0, 190.0, 3.0, 6.0, -167.0, -20.0, 36.0, 35.0, 75.0, 108.0, 76.0, 115.0, 199.0, 35.0, 88.0, -25.0, 123.0, -73.0, 53.0, 57.0, 153.0, 130.0, 91.0, -43.0, 159.0, 158.0, 172.0, 196.0, -232.0, 176.0, 0.0, 154.0, 127.0, -124.0, 142.0, -420.0, 164.0, 95.0, 36.0, 53.0, 155.0, 116.0, 199.0, -73.0, -192.0, -246.0, -30.0, -28.0, 106.0, 116.0, 106.0, 13.0, -176.0, 178.0, 164.0, 199.0, -6.0, 145.0, 114.0, 92.0, 41.0, 175.0, 93.0, 42.0, 90.0, 62.0, 33.0, 101.0, 26.0, 61.0, 75.0, -2.0, 93.0, 111.0, 179.0, 152.0, 162.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 0.0, 0.0, 24.0, 47.0, 29.0, 67.0, 0.0, 75.0, 0.0, 3.0, 0.0, 15.0, 16.0, 41.0, 4.0, 51.0, 1.0, 27.0, 0.0, 82.0, 56.0, 0.0, 48.0, 0.0, 114.0, 0.0, 0.0, 53.0, 0.0, 0.0, 6.0, 102.0, 14.0, 0.0, 27.0, 4.0, 0.0, 31.0, 61.0, 79.0, 25.0, 18.0, 0.0, 127.0, 51.0, 0.0, 0.0, 23.0, 0.0, 17.0, 34.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 79.0, 12.0, 0.0, 118.0, 46.0, 18.0, 55.0, 0.0, 3.0, 0.0, 5.0, 13.0, 72.0, 20.0, 2.0, 27.0, 14.0, 0.0, 0.0, 14.0, 0.0, 13.0, 16.0, 59.0, 8.0, 15.0, 4.0, 25.0, 0.0, 29.0, 28.0, 25.0, 0.0, 122.0, 0.0, 0.0, 0.0, 32.0, 144.0, 13.0, 23.0, 36.0, 21.0, 0.0, 27.0, 39.0, 28.0, 55.0, 0.0, 135.0, 0.0, 28.0, 8.0, 0.0, 3.0, 52.0, 2.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 54.0, 103.0, 4.0, 48.0, 17.0, 0.0, 21.0, 32.0, 26.0, 0.0, 36.0, 41.0, 56.0, 36.0, 55.0, 44.0, 0.0, 0.0, 10.0, 6.0, 23.0, 5.0, 0.0, 3.0, 18.0, 100.0, 20.0, 45.0, 0.0, 15.0, 89.0, 8.0, 255.0, 0.0, 0.0, 76.0, 0.0, 55.0, 24.0, 0.0, 114.0, 51.0, 76.0, 118.0, 14.0, 16.0, 0.0, 29.0, 59.0, 94.0, 0.0, 0.0, 0.0, 67.0, 18.0, 0.0, 30.0, 24.0, 29.0, 5.0, 42.0, 37.0, 0.0, 57.0, 0.0, 57.0, 1.0, 45.0, 1.0, 29.0, 0.0, 5.0, 2.0, 24.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6545051064624179, "mean_inference_ms": 1.5016545367551632, "mean_action_processing_ms": 0.2724788642736598, "mean_env_wait_ms": 0.2049710289893082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007073686580465297, "StateBufferConnector_ms": 0.003313175355545198, "ViewRequirementAgentConnector_ms": 0.10348690880669488}, "num_episodes": 27, "episode_return_max": 353.0, "episode_return_min": -189.0, "episode_return_mean": 116.60606060606061, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.39311868807866, "num_env_steps_trained_throughput_per_sec": 75.39311868807866, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 54206.423, "restore_workers_time_ms": 0.018, "training_step_time_ms": 54206.36, "sample_time_ms": 1247.605, "learn_time_ms": 52940.241, "learn_throughput": 75.557, "synch_weights_time_ms": 14.797}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-54-54", "timestamp": 1723517694, "time_this_iter_s": 53.095550298690796, "time_total_s": 271.26633048057556, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8095160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.26633048057556, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.74933333333333, "ram_util_percent": 78.25733333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5486491724296854, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.302762989266209, "policy_loss": -0.014193683179469887, "vf_loss": 6.315300037495043, "vf_explained_var": 0.04839599965110658, "kl": 0.011044276030119633, "entropy": 1.5399951703964718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8619052360928245, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.739820642824526, "policy_loss": -0.010001321467472409, "vf_loss": 8.74802411599134, "vf_explained_var": 0.060171891488726176, "kl": 0.005992886194965052, "entropy": 1.5336808541464426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 353.0, "episode_reward_min": -189.0, "episode_reward_mean": 129.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -420.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 255.0}, "policy_reward_mean": {"prey_policy": 33.06, "predator_policy": 31.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.0, 147.0, 228.0, -40.0, -71.0, 65.0, -112.0, 30.0, 211.0, 215.0, 110.0, 69.0, 312.0, -75.0, -25.0, 63.0, 44.0, 23.0, -17.0, 105.0, 162.0, -14.0, 189.0, 158.0, 199.0, 145.0, 201.0, -17.0, 136.0, -40.0, 285.0, 18.0, -189.0, 155.0, 353.0, 116.0, 189.0, -91.0, 205.0, 348.0, 145.0, 36.0, 271.0, 216.0, 193.0, -4.0, 68.0, 127.0, 237.0, 340.0, 200.0, 190.0, 79.0, 210.0, 237.0, 144.0, 333.0, 82.0, 241.0, 296.0, 115.0, -1.0, 207.0, 263.0, 339.0, -100.0, -82.0, 108.0, 251.0, -10.0, 342.0, 260.0, 277.0, 187.0, 302.0, 211.0, 152.0, 184.0, 182.0, 121.0, 295.0, 340.0, -8.0, 144.0, 125.0, -33.0, -56.0, 242.0, 61.0, 224.0, 306.0, 160.0, 5.0, 20.0, 76.0, -71.0, 211.0, -29.0, 15.0, 285.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.0, -166.0, -54.0, 174.0, 91.0, 133.0, -62.0, -70.0, -158.0, -17.0, -8.0, 55.0, -64.0, -226.0, 6.0, 24.0, 178.0, 10.0, 183.0, -19.0, 0.0, 100.0, 31.0, 33.0, 164.0, 148.0, -166.0, 0.0, 45.0, -188.0, 63.0, -64.0, 90.0, -101.0, 16.0, 4.0, -25.0, -10.0, 22.0, -9.0, 33.0, 100.0, -28.0, 0.0, 155.0, 20.0, 8.0, 137.0, 125.0, -1.0, 0.0, 122.0, 105.0, 67.0, -51.0, 5.0, 45.0, 38.0, -104.0, -58.0, 110.0, 175.0, -10.0, -4.0, -96.0, -250.0, 75.0, 21.0, 200.0, 132.0, 29.0, 21.0, 85.0, 21.0, -270.0, 44.0, 45.0, 132.0, 179.0, 161.0, 31.0, 59.0, 100.0, -157.0, 199.0, 72.0, 50.0, 166.0, 190.0, 3.0, 6.0, -167.0, -20.0, 36.0, 35.0, 75.0, 108.0, 76.0, 115.0, 199.0, 35.0, 88.0, -25.0, 123.0, -73.0, 53.0, 57.0, 153.0, 130.0, 91.0, -43.0, 159.0, 158.0, 172.0, 196.0, -232.0, 176.0, 0.0, 154.0, 127.0, -124.0, 142.0, -420.0, 164.0, 95.0, 36.0, 53.0, 155.0, 116.0, 199.0, -73.0, -192.0, -246.0, -30.0, -28.0, 106.0, 116.0, 106.0, 13.0, -176.0, 178.0, 164.0, 199.0, -6.0, 145.0, 114.0, 92.0, 41.0, 175.0, 93.0, 42.0, 90.0, 62.0, 33.0, 101.0, 26.0, 61.0, 75.0, -2.0, 93.0, 111.0, 179.0, 152.0, 162.0, -86.0, -42.0, 114.0, 9.0, -94.0, 145.0, -211.0, -22.0, -116.0, 0.0, 103.0, 68.0, -76.0, 20.0, 138.0, 49.0, 89.0, 200.0, 102.0, -24.0, -82.0, -44.0, 0.0, -65.0, -204.0, 166.0, -111.0, -118.0, 114.0, 30.0, -174.0, -33.0, -142.0, -1.0, 196.0, 65.0], "policy_predator_policy_reward": [102.0, 14.0, 0.0, 27.0, 4.0, 0.0, 31.0, 61.0, 79.0, 25.0, 18.0, 0.0, 127.0, 51.0, 0.0, 0.0, 23.0, 0.0, 17.0, 34.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 79.0, 12.0, 0.0, 118.0, 46.0, 18.0, 55.0, 0.0, 3.0, 0.0, 5.0, 13.0, 72.0, 20.0, 2.0, 27.0, 14.0, 0.0, 0.0, 14.0, 0.0, 13.0, 16.0, 59.0, 8.0, 15.0, 4.0, 25.0, 0.0, 29.0, 28.0, 25.0, 0.0, 122.0, 0.0, 0.0, 0.0, 32.0, 144.0, 13.0, 23.0, 36.0, 21.0, 0.0, 27.0, 39.0, 28.0, 55.0, 0.0, 135.0, 0.0, 28.0, 8.0, 0.0, 3.0, 52.0, 2.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 54.0, 103.0, 4.0, 48.0, 17.0, 0.0, 21.0, 32.0, 26.0, 0.0, 36.0, 41.0, 56.0, 36.0, 55.0, 44.0, 0.0, 0.0, 10.0, 6.0, 23.0, 5.0, 0.0, 3.0, 18.0, 100.0, 20.0, 45.0, 0.0, 15.0, 89.0, 8.0, 255.0, 0.0, 0.0, 76.0, 0.0, 55.0, 24.0, 0.0, 114.0, 51.0, 76.0, 118.0, 14.0, 16.0, 0.0, 29.0, 59.0, 94.0, 0.0, 0.0, 0.0, 67.0, 18.0, 0.0, 30.0, 24.0, 29.0, 5.0, 42.0, 37.0, 0.0, 57.0, 0.0, 57.0, 1.0, 45.0, 1.0, 29.0, 0.0, 5.0, 2.0, 24.0, 93.0, 27.0, 21.0, 0.0, 0.0, 74.0, 121.0, 79.0, 0.0, 60.0, 5.0, 66.0, 4.0, 113.0, 27.0, 10.0, 15.0, 2.0, 7.0, 75.0, 107.0, 24.0, 61.0, 24.0, 1.0, 113.0, 63.0, 95.0, 11.0, 56.0, 58.0, 120.0, 82.0, 76.0, 10.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6490844631882752, "mean_inference_ms": 1.4894120728829614, "mean_action_processing_ms": 0.26735096747632175, "mean_env_wait_ms": 0.20223882012904656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006406545639038086, "StateBufferConnector_ms": 0.0032777786254882812, "ViewRequirementAgentConnector_ms": 0.10745704174041748}, "num_episodes": 18, "episode_return_max": 353.0, "episode_return_min": -189.0, "episode_return_mean": 129.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.41056584749471, "num_env_steps_trained_throughput_per_sec": 75.41056584749471, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 54012.516, "restore_workers_time_ms": 0.018, "training_step_time_ms": 54012.447, "sample_time_ms": 1277.86, "learn_time_ms": 52714.623, "learn_throughput": 75.88, "synch_weights_time_ms": 16.189}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-55-47", "timestamp": 1723517747, "time_this_iter_s": 53.08500385284424, "time_total_s": 324.3513343334198, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8095430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 324.3513343334198, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.18684210526315, "ram_util_percent": 82.14342105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.21164405563521, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.133432006079053, "policy_loss": -0.01626495106328062, "vf_loss": 8.147461908078068, "vf_explained_var": 0.06201888653967116, "kl": 0.014900169832208843, "entropy": 1.5217773708716902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.297672814729983, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.218427937623686, "policy_loss": -0.013248239196935501, "vf_loss": 9.228741183104338, "vf_explained_var": -0.03465487058200534, "kl": 0.009783289096248197, "entropy": 1.514243010616807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 353.0, "episode_reward_min": -189.0, "episode_reward_mean": 124.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -420.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 255.0}, "policy_reward_mean": {"prey_policy": 21.38, "predator_policy": 40.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0, 105.0, 162.0, -14.0, 189.0, 158.0, 199.0, 145.0, 201.0, -17.0, 136.0, -40.0, 285.0, 18.0, -189.0, 155.0, 353.0, 116.0, 189.0, -91.0, 205.0, 348.0, 145.0, 36.0, 271.0, 216.0, 193.0, -4.0, 68.0, 127.0, 237.0, 340.0, 200.0, 190.0, 79.0, 210.0, 237.0, 144.0, 333.0, 82.0, 241.0, 296.0, 115.0, -1.0, 207.0, 263.0, 339.0, -100.0, -82.0, 108.0, 251.0, -10.0, 342.0, 260.0, 277.0, 187.0, 302.0, 211.0, 152.0, 184.0, 182.0, 121.0, 295.0, 340.0, -8.0, 144.0, 125.0, -33.0, -56.0, 242.0, 61.0, 224.0, 306.0, 160.0, 5.0, 20.0, 76.0, -71.0, 211.0, -29.0, 15.0, 285.0, 187.0, -2.0, 20.0, 3.0, 80.0, 84.0, -173.0, 165.0, -69.0, 14.0, 173.0, -115.0, -31.0, 8.0, 127.0, 276.0, -47.0, -84.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.0, -10.0, 22.0, -9.0, 33.0, 100.0, -28.0, 0.0, 155.0, 20.0, 8.0, 137.0, 125.0, -1.0, 0.0, 122.0, 105.0, 67.0, -51.0, 5.0, 45.0, 38.0, -104.0, -58.0, 110.0, 175.0, -10.0, -4.0, -96.0, -250.0, 75.0, 21.0, 200.0, 132.0, 29.0, 21.0, 85.0, 21.0, -270.0, 44.0, 45.0, 132.0, 179.0, 161.0, 31.0, 59.0, 100.0, -157.0, 199.0, 72.0, 50.0, 166.0, 190.0, 3.0, 6.0, -167.0, -20.0, 36.0, 35.0, 75.0, 108.0, 76.0, 115.0, 199.0, 35.0, 88.0, -25.0, 123.0, -73.0, 53.0, 57.0, 153.0, 130.0, 91.0, -43.0, 159.0, 158.0, 172.0, 196.0, -232.0, 176.0, 0.0, 154.0, 127.0, -124.0, 142.0, -420.0, 164.0, 95.0, 36.0, 53.0, 155.0, 116.0, 199.0, -73.0, -192.0, -246.0, -30.0, -28.0, 106.0, 116.0, 106.0, 13.0, -176.0, 178.0, 164.0, 199.0, -6.0, 145.0, 114.0, 92.0, 41.0, 175.0, 93.0, 42.0, 90.0, 62.0, 33.0, 101.0, 26.0, 61.0, 75.0, -2.0, 93.0, 111.0, 179.0, 152.0, 162.0, -86.0, -42.0, 114.0, 9.0, -94.0, 145.0, -211.0, -22.0, -116.0, 0.0, 103.0, 68.0, -76.0, 20.0, 138.0, 49.0, 89.0, 200.0, 102.0, -24.0, -82.0, -44.0, 0.0, -65.0, -204.0, 166.0, -111.0, -118.0, 114.0, 30.0, -174.0, -33.0, -142.0, -1.0, 196.0, 65.0, -59.0, 126.0, -85.0, -68.0, -99.0, -37.0, -38.0, -90.0, 58.0, -145.0, -87.0, 67.0, -120.0, -245.0, 121.0, -81.0, -151.0, -127.0, -164.0, 24.0, -26.0, 118.0, -82.0, -288.0, 0.0, -166.0, -3.0, -169.0, 188.0, -310.0, 171.0, 77.0, -247.0, 0.0, -246.0, -67.0], "policy_predator_policy_reward": [5.0, 13.0, 72.0, 20.0, 2.0, 27.0, 14.0, 0.0, 0.0, 14.0, 0.0, 13.0, 16.0, 59.0, 8.0, 15.0, 4.0, 25.0, 0.0, 29.0, 28.0, 25.0, 0.0, 122.0, 0.0, 0.0, 0.0, 32.0, 144.0, 13.0, 23.0, 36.0, 21.0, 0.0, 27.0, 39.0, 28.0, 55.0, 0.0, 135.0, 0.0, 28.0, 8.0, 0.0, 3.0, 52.0, 2.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 54.0, 103.0, 4.0, 48.0, 17.0, 0.0, 21.0, 32.0, 26.0, 0.0, 36.0, 41.0, 56.0, 36.0, 55.0, 44.0, 0.0, 0.0, 10.0, 6.0, 23.0, 5.0, 0.0, 3.0, 18.0, 100.0, 20.0, 45.0, 0.0, 15.0, 89.0, 8.0, 255.0, 0.0, 0.0, 76.0, 0.0, 55.0, 24.0, 0.0, 114.0, 51.0, 76.0, 118.0, 14.0, 16.0, 0.0, 29.0, 59.0, 94.0, 0.0, 0.0, 0.0, 67.0, 18.0, 0.0, 30.0, 24.0, 29.0, 5.0, 42.0, 37.0, 0.0, 57.0, 0.0, 57.0, 1.0, 45.0, 1.0, 29.0, 0.0, 5.0, 2.0, 24.0, 93.0, 27.0, 21.0, 0.0, 0.0, 74.0, 121.0, 79.0, 0.0, 60.0, 5.0, 66.0, 4.0, 113.0, 27.0, 10.0, 15.0, 2.0, 7.0, 75.0, 107.0, 24.0, 61.0, 24.0, 1.0, 113.0, 63.0, 95.0, 11.0, 56.0, 58.0, 120.0, 82.0, 76.0, 10.0, 14.0, 62.0, 58.0, 74.0, 77.0, 22.0, 134.0, 131.0, 0.0, 62.0, 105.0, 0.0, 104.0, 124.0, 68.0, 74.0, 51.0, 132.0, 77.0, 111.0, 43.0, 75.0, 6.0, 141.0, 114.0, 104.0, 31.0, 92.0, 88.0, 165.0, 84.0, 27.0, 1.0, 53.0, 147.0, 103.0, 126.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6557417824931576, "mean_inference_ms": 1.5060192072877783, "mean_action_processing_ms": 0.2671250436276791, "mean_env_wait_ms": 0.2032074511965945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006541609764099121, "StateBufferConnector_ms": 0.004118084907531738, "ViewRequirementAgentConnector_ms": 0.12746262550354004}, "num_episodes": 18, "episode_return_max": 353.0, "episode_return_min": -189.0, "episode_return_mean": 124.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.7280912315178, "num_env_steps_trained_throughput_per_sec": 68.7280912315178, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 54610.782, "restore_workers_time_ms": 0.02, "training_step_time_ms": 54610.712, "sample_time_ms": 1349.395, "learn_time_ms": 53238.747, "learn_throughput": 75.133, "synch_weights_time_ms": 18.423}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-56-45", "timestamp": 1723517805, "time_this_iter_s": 58.22534465789795, "time_total_s": 382.57667899131775, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80a8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 382.57667899131775, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.67682926829268, "ram_util_percent": 83.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.332694126752319, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.623866295688368, "policy_loss": -0.011413891439291614, "vf_loss": 8.63394544086759, "vf_explained_var": 0.0171966552103638, "kl": 0.008898167418032055, "entropy": 1.5266777800504492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.612532857139275, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.307788952065524, "policy_loss": -0.013697970828790434, "vf_loss": 8.318139837658595, "vf_explained_var": -0.039923850474534214, "kl": 0.011157020312148425, "entropy": 1.5064026279424234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 348.0, "episode_reward_min": -222.0, "episode_reward_mean": 104.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -420.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 255.0}, "policy_reward_mean": {"prey_policy": -0.675, "predator_policy": 52.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.0, -91.0, 205.0, 348.0, 145.0, 36.0, 271.0, 216.0, 193.0, -4.0, 68.0, 127.0, 237.0, 340.0, 200.0, 190.0, 79.0, 210.0, 237.0, 144.0, 333.0, 82.0, 241.0, 296.0, 115.0, -1.0, 207.0, 263.0, 339.0, -100.0, -82.0, 108.0, 251.0, -10.0, 342.0, 260.0, 277.0, 187.0, 302.0, 211.0, 152.0, 184.0, 182.0, 121.0, 295.0, 340.0, -8.0, 144.0, 125.0, -33.0, -56.0, 242.0, 61.0, 224.0, 306.0, 160.0, 5.0, 20.0, 76.0, -71.0, 211.0, -29.0, 15.0, 285.0, 187.0, -2.0, 20.0, 3.0, 80.0, 84.0, -173.0, 165.0, -69.0, 14.0, 173.0, -115.0, -31.0, 8.0, 127.0, 276.0, -47.0, -84.0, 45.0, -5.0, 303.0, 29.0, -25.0, 44.0, -193.0, -222.0, 38.0, 6.0, 115.0, 18.0, 53.0, -134.0, -174.0, -47.0, -14.0, 37.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.0, 21.0, -270.0, 44.0, 45.0, 132.0, 179.0, 161.0, 31.0, 59.0, 100.0, -157.0, 199.0, 72.0, 50.0, 166.0, 190.0, 3.0, 6.0, -167.0, -20.0, 36.0, 35.0, 75.0, 108.0, 76.0, 115.0, 199.0, 35.0, 88.0, -25.0, 123.0, -73.0, 53.0, 57.0, 153.0, 130.0, 91.0, -43.0, 159.0, 158.0, 172.0, 196.0, -232.0, 176.0, 0.0, 154.0, 127.0, -124.0, 142.0, -420.0, 164.0, 95.0, 36.0, 53.0, 155.0, 116.0, 199.0, -73.0, -192.0, -246.0, -30.0, -28.0, 106.0, 116.0, 106.0, 13.0, -176.0, 178.0, 164.0, 199.0, -6.0, 145.0, 114.0, 92.0, 41.0, 175.0, 93.0, 42.0, 90.0, 62.0, 33.0, 101.0, 26.0, 61.0, 75.0, -2.0, 93.0, 111.0, 179.0, 152.0, 162.0, -86.0, -42.0, 114.0, 9.0, -94.0, 145.0, -211.0, -22.0, -116.0, 0.0, 103.0, 68.0, -76.0, 20.0, 138.0, 49.0, 89.0, 200.0, 102.0, -24.0, -82.0, -44.0, 0.0, -65.0, -204.0, 166.0, -111.0, -118.0, 114.0, 30.0, -174.0, -33.0, -142.0, -1.0, 196.0, 65.0, -59.0, 126.0, -85.0, -68.0, -99.0, -37.0, -38.0, -90.0, 58.0, -145.0, -87.0, 67.0, -120.0, -245.0, 121.0, -81.0, -151.0, -127.0, -164.0, 24.0, -26.0, 118.0, -82.0, -288.0, 0.0, -166.0, -3.0, -169.0, 188.0, -310.0, 171.0, 77.0, -247.0, 0.0, -246.0, -67.0, -146.0, 56.0, -88.0, 0.0, 36.0, 182.0, 0.0, -92.0, -129.0, -69.0, -42.0, 0.0, -203.0, -256.0, -228.0, -298.0, 42.0, -207.0, -183.0, -1.0, -86.0, 140.0, -93.0, -63.0, -94.0, -41.0, -159.0, -256.0, -122.0, -343.0, -301.0, -19.0, -196.0, -9.0, -44.0, 0.0], "policy_predator_policy_reward": [28.0, 55.0, 0.0, 135.0, 0.0, 28.0, 8.0, 0.0, 3.0, 52.0, 2.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 54.0, 103.0, 4.0, 48.0, 17.0, 0.0, 21.0, 32.0, 26.0, 0.0, 36.0, 41.0, 56.0, 36.0, 55.0, 44.0, 0.0, 0.0, 10.0, 6.0, 23.0, 5.0, 0.0, 3.0, 18.0, 100.0, 20.0, 45.0, 0.0, 15.0, 89.0, 8.0, 255.0, 0.0, 0.0, 76.0, 0.0, 55.0, 24.0, 0.0, 114.0, 51.0, 76.0, 118.0, 14.0, 16.0, 0.0, 29.0, 59.0, 94.0, 0.0, 0.0, 0.0, 67.0, 18.0, 0.0, 30.0, 24.0, 29.0, 5.0, 42.0, 37.0, 0.0, 57.0, 0.0, 57.0, 1.0, 45.0, 1.0, 29.0, 0.0, 5.0, 2.0, 24.0, 93.0, 27.0, 21.0, 0.0, 0.0, 74.0, 121.0, 79.0, 0.0, 60.0, 5.0, 66.0, 4.0, 113.0, 27.0, 10.0, 15.0, 2.0, 7.0, 75.0, 107.0, 24.0, 61.0, 24.0, 1.0, 113.0, 63.0, 95.0, 11.0, 56.0, 58.0, 120.0, 82.0, 76.0, 10.0, 14.0, 62.0, 58.0, 74.0, 77.0, 22.0, 134.0, 131.0, 0.0, 62.0, 105.0, 0.0, 104.0, 124.0, 68.0, 74.0, 51.0, 132.0, 77.0, 111.0, 43.0, 75.0, 6.0, 141.0, 114.0, 104.0, 31.0, 92.0, 88.0, 165.0, 84.0, 27.0, 1.0, 53.0, 147.0, 103.0, 126.0, 120.0, 15.0, 13.0, 70.0, 47.0, 38.0, 30.0, 91.0, 122.0, 51.0, 49.0, 37.0, 140.0, 126.0, 140.0, 164.0, 92.0, 111.0, 109.0, 81.0, 44.0, 17.0, 45.0, 129.0, 57.0, 131.0, 145.0, 136.0, 114.0, 177.0, 155.0, 118.0, 108.0, 83.0, 16.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.663881645925245, "mean_inference_ms": 1.5291868901609547, "mean_action_processing_ms": 0.26870560291593903, "mean_env_wait_ms": 0.20556638501445093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006367683410644531, "StateBufferConnector_ms": 0.0040929317474365234, "ViewRequirementAgentConnector_ms": 0.12575817108154297}, "num_episodes": 18, "episode_return_max": 348.0, "episode_return_min": -222.0, "episode_return_mean": 104.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.53671768326649, "num_env_steps_trained_throughput_per_sec": 70.53671768326649, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 54872.943, "restore_workers_time_ms": 0.02, "training_step_time_ms": 54872.873, "sample_time_ms": 1370.671, "learn_time_ms": 53479.618, "learn_throughput": 74.795, "synch_weights_time_ms": 18.537}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-57-42", "timestamp": 1723517862, "time_this_iter_s": 56.76155185699463, "time_total_s": 439.3382308483124, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8031af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 439.3382308483124, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.34074074074074, "ram_util_percent": 83.65802469135802}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.117062403033019, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.148563659254205, "policy_loss": -0.013512657871827108, "vf_loss": 6.159973839098814, "vf_explained_var": 0.1055836729902439, "kl": 0.014016652432144226, "entropy": 1.5139222437742526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.055383304502598, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.528328069051107, "policy_loss": -0.011841604351337073, "vf_loss": 7.5376863219750625, "vf_explained_var": 0.07265680221022752, "kl": 0.008277862216705009, "entropy": 1.4969292243321737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -269.0, "episode_reward_mean": 72.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -420.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 255.0}, "policy_reward_mean": {"prey_policy": -27.025, "predator_policy": 63.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0, 296.0, 115.0, -1.0, 207.0, 263.0, 339.0, -100.0, -82.0, 108.0, 251.0, -10.0, 342.0, 260.0, 277.0, 187.0, 302.0, 211.0, 152.0, 184.0, 182.0, 121.0, 295.0, 340.0, -8.0, 144.0, 125.0, -33.0, -56.0, 242.0, 61.0, 224.0, 306.0, 160.0, 5.0, 20.0, 76.0, -71.0, 211.0, -29.0, 15.0, 285.0, 187.0, -2.0, 20.0, 3.0, 80.0, 84.0, -173.0, 165.0, -69.0, 14.0, 173.0, -115.0, -31.0, 8.0, 127.0, 276.0, -47.0, -84.0, 45.0, -5.0, 303.0, 29.0, -25.0, 44.0, -193.0, -222.0, 38.0, 6.0, 115.0, 18.0, 53.0, -134.0, -174.0, -47.0, -14.0, 37.0, 258.0, 312.0, 108.0, 69.0, 97.0, -18.0, -104.0, 90.0, -269.0, 102.0, -71.0, 133.0, -67.0, -4.0, -74.0, -90.0, 76.0, 110.0, -54.0, 73.0, -3.0, -119.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.0, 0.0, 154.0, 127.0, -124.0, 142.0, -420.0, 164.0, 95.0, 36.0, 53.0, 155.0, 116.0, 199.0, -73.0, -192.0, -246.0, -30.0, -28.0, 106.0, 116.0, 106.0, 13.0, -176.0, 178.0, 164.0, 199.0, -6.0, 145.0, 114.0, 92.0, 41.0, 175.0, 93.0, 42.0, 90.0, 62.0, 33.0, 101.0, 26.0, 61.0, 75.0, -2.0, 93.0, 111.0, 179.0, 152.0, 162.0, -86.0, -42.0, 114.0, 9.0, -94.0, 145.0, -211.0, -22.0, -116.0, 0.0, 103.0, 68.0, -76.0, 20.0, 138.0, 49.0, 89.0, 200.0, 102.0, -24.0, -82.0, -44.0, 0.0, -65.0, -204.0, 166.0, -111.0, -118.0, 114.0, 30.0, -174.0, -33.0, -142.0, -1.0, 196.0, 65.0, -59.0, 126.0, -85.0, -68.0, -99.0, -37.0, -38.0, -90.0, 58.0, -145.0, -87.0, 67.0, -120.0, -245.0, 121.0, -81.0, -151.0, -127.0, -164.0, 24.0, -26.0, 118.0, -82.0, -288.0, 0.0, -166.0, -3.0, -169.0, 188.0, -310.0, 171.0, 77.0, -247.0, 0.0, -246.0, -67.0, -146.0, 56.0, -88.0, 0.0, 36.0, 182.0, 0.0, -92.0, -129.0, -69.0, -42.0, 0.0, -203.0, -256.0, -228.0, -298.0, 42.0, -207.0, -183.0, -1.0, -86.0, 140.0, -93.0, -63.0, -94.0, -41.0, -159.0, -256.0, -122.0, -343.0, -301.0, -19.0, -196.0, -9.0, -44.0, 0.0, 74.0, 131.0, 193.0, 110.0, 0.0, 62.0, -155.0, 53.0, -25.0, 17.0, 0.0, -199.0, -142.0, -181.0, -14.0, -63.0, -228.0, -214.0, -234.0, 99.0, -169.0, -120.0, 100.0, 0.0, 0.0, -218.0, 0.0, -105.0, -62.0, -280.0, -145.0, -105.0, -12.0, -67.0, 29.0, 0.0, -13.0, -284.0, 0.0, 24.0, 75.0, -316.0, -138.0, -133.0], "policy_predator_policy_reward": [20.0, 45.0, 0.0, 15.0, 89.0, 8.0, 255.0, 0.0, 0.0, 76.0, 0.0, 55.0, 24.0, 0.0, 114.0, 51.0, 76.0, 118.0, 14.0, 16.0, 0.0, 29.0, 59.0, 94.0, 0.0, 0.0, 0.0, 67.0, 18.0, 0.0, 30.0, 24.0, 29.0, 5.0, 42.0, 37.0, 0.0, 57.0, 0.0, 57.0, 1.0, 45.0, 1.0, 29.0, 0.0, 5.0, 2.0, 24.0, 93.0, 27.0, 21.0, 0.0, 0.0, 74.0, 121.0, 79.0, 0.0, 60.0, 5.0, 66.0, 4.0, 113.0, 27.0, 10.0, 15.0, 2.0, 7.0, 75.0, 107.0, 24.0, 61.0, 24.0, 1.0, 113.0, 63.0, 95.0, 11.0, 56.0, 58.0, 120.0, 82.0, 76.0, 10.0, 14.0, 62.0, 58.0, 74.0, 77.0, 22.0, 134.0, 131.0, 0.0, 62.0, 105.0, 0.0, 104.0, 124.0, 68.0, 74.0, 51.0, 132.0, 77.0, 111.0, 43.0, 75.0, 6.0, 141.0, 114.0, 104.0, 31.0, 92.0, 88.0, 165.0, 84.0, 27.0, 1.0, 53.0, 147.0, 103.0, 126.0, 120.0, 15.0, 13.0, 70.0, 47.0, 38.0, 30.0, 91.0, 122.0, 51.0, 49.0, 37.0, 140.0, 126.0, 140.0, 164.0, 92.0, 111.0, 109.0, 81.0, 44.0, 17.0, 45.0, 129.0, 57.0, 131.0, 145.0, 136.0, 114.0, 177.0, 155.0, 118.0, 108.0, 83.0, 16.0, 65.0, 53.0, 0.0, 0.0, 9.0, 46.0, 0.0, 75.0, 96.0, 25.0, 80.0, 97.0, 84.0, 117.0, 102.0, 73.0, 94.0, 110.0, 63.0, 129.0, 108.0, 107.0, 111.0, 0.0, 33.0, 19.0, 132.0, 16.0, 85.0, 160.0, 108.0, 27.0, 133.0, 61.0, 94.0, 44.0, 37.0, 66.0, 177.0, 4.0, 45.0, 132.0, 106.0, 152.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6765568684655012, "mean_inference_ms": 1.5626790449179584, "mean_action_processing_ms": 0.2724899803680751, "mean_env_wait_ms": 0.20931035603838283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005568861961364746, "StateBufferConnector_ms": 0.003987908363342285, "ViewRequirementAgentConnector_ms": 0.12809205055236816}, "num_episodes": 22, "episode_return_max": 342.0, "episode_return_min": -269.0, "episode_return_mean": 72.02, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.0557953522896, "num_env_steps_trained_throughput_per_sec": 77.0557953522896, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 54543.777, "restore_workers_time_ms": 0.019, "training_step_time_ms": 54543.709, "sample_time_ms": 1357.495, "learn_time_ms": 53163.833, "learn_throughput": 75.239, "synch_weights_time_ms": 18.317}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-58-34", "timestamp": 1723517914, "time_this_iter_s": 51.94117593765259, "time_total_s": 491.27940678596497, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8079430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 491.27940678596497, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.17297297297297, "ram_util_percent": 79.58108108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5351261985365046, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.517216323166297, "policy_loss": -0.014427396903189008, "vf_loss": 8.52961702725244, "vf_explained_var": 0.053107572579509994, "kl": 0.013511190234059396, "entropy": 1.476401969427785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.031972434848704, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.638611450397148, "policy_loss": -0.011459069586945352, "vf_loss": 7.647671042548286, "vf_explained_var": -0.18854287963695626, "kl": 0.007998233508467617, "entropy": 1.4810397416826278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -403.0, "episode_reward_mean": 36.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -52.325, "predator_policy": 70.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, -8.0, 144.0, 125.0, -33.0, -56.0, 242.0, 61.0, 224.0, 306.0, 160.0, 5.0, 20.0, 76.0, -71.0, 211.0, -29.0, 15.0, 285.0, 187.0, -2.0, 20.0, 3.0, 80.0, 84.0, -173.0, 165.0, -69.0, 14.0, 173.0, -115.0, -31.0, 8.0, 127.0, 276.0, -47.0, -84.0, 45.0, -5.0, 303.0, 29.0, -25.0, 44.0, -193.0, -222.0, 38.0, 6.0, 115.0, 18.0, 53.0, -134.0, -174.0, -47.0, -14.0, 37.0, 258.0, 312.0, 108.0, 69.0, 97.0, -18.0, -104.0, 90.0, -269.0, 102.0, -71.0, 133.0, -67.0, -4.0, -74.0, -90.0, 76.0, 110.0, -54.0, 73.0, -3.0, -119.0, 80.0, -108.0, -85.0, 28.0, -26.0, 105.0, 21.0, -21.0, 378.0, 124.0, -15.0, 139.0, 54.0, -36.0, 35.0, -53.0, -25.0, 232.0, 54.0, 53.0, 134.0, -65.0, -403.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.0, 162.0, -86.0, -42.0, 114.0, 9.0, -94.0, 145.0, -211.0, -22.0, -116.0, 0.0, 103.0, 68.0, -76.0, 20.0, 138.0, 49.0, 89.0, 200.0, 102.0, -24.0, -82.0, -44.0, 0.0, -65.0, -204.0, 166.0, -111.0, -118.0, 114.0, 30.0, -174.0, -33.0, -142.0, -1.0, 196.0, 65.0, -59.0, 126.0, -85.0, -68.0, -99.0, -37.0, -38.0, -90.0, 58.0, -145.0, -87.0, 67.0, -120.0, -245.0, 121.0, -81.0, -151.0, -127.0, -164.0, 24.0, -26.0, 118.0, -82.0, -288.0, 0.0, -166.0, -3.0, -169.0, 188.0, -310.0, 171.0, 77.0, -247.0, 0.0, -246.0, -67.0, -146.0, 56.0, -88.0, 0.0, 36.0, 182.0, 0.0, -92.0, -129.0, -69.0, -42.0, 0.0, -203.0, -256.0, -228.0, -298.0, 42.0, -207.0, -183.0, -1.0, -86.0, 140.0, -93.0, -63.0, -94.0, -41.0, -159.0, -256.0, -122.0, -343.0, -301.0, -19.0, -196.0, -9.0, -44.0, 0.0, 74.0, 131.0, 193.0, 110.0, 0.0, 62.0, -155.0, 53.0, -25.0, 17.0, 0.0, -199.0, -142.0, -181.0, -14.0, -63.0, -228.0, -214.0, -234.0, 99.0, -169.0, -120.0, 100.0, 0.0, 0.0, -218.0, 0.0, -105.0, -62.0, -280.0, -145.0, -105.0, -12.0, -67.0, 29.0, 0.0, -13.0, -284.0, 0.0, 24.0, 75.0, -316.0, -138.0, -133.0, 2.0, 0.0, -313.0, 0.0, -286.0, -12.0, -56.0, 0.0, 0.0, -145.0, 73.0, -152.0, -144.0, 0.0, -116.0, 0.0, 197.0, 180.0, -2.0, -20.0, -56.0, -97.0, 36.0, 27.0, -64.0, -19.0, -135.0, -103.0, -54.0, 4.0, -82.0, -165.0, -195.0, 0.0, 74.0, 115.0, -144.0, 22.0, -75.0, 2.0, 101.0, 0.0, -95.0, -199.0, -283.0, -346.0], "policy_predator_policy_reward": [2.0, 24.0, 93.0, 27.0, 21.0, 0.0, 0.0, 74.0, 121.0, 79.0, 0.0, 60.0, 5.0, 66.0, 4.0, 113.0, 27.0, 10.0, 15.0, 2.0, 7.0, 75.0, 107.0, 24.0, 61.0, 24.0, 1.0, 113.0, 63.0, 95.0, 11.0, 56.0, 58.0, 120.0, 82.0, 76.0, 10.0, 14.0, 62.0, 58.0, 74.0, 77.0, 22.0, 134.0, 131.0, 0.0, 62.0, 105.0, 0.0, 104.0, 124.0, 68.0, 74.0, 51.0, 132.0, 77.0, 111.0, 43.0, 75.0, 6.0, 141.0, 114.0, 104.0, 31.0, 92.0, 88.0, 165.0, 84.0, 27.0, 1.0, 53.0, 147.0, 103.0, 126.0, 120.0, 15.0, 13.0, 70.0, 47.0, 38.0, 30.0, 91.0, 122.0, 51.0, 49.0, 37.0, 140.0, 126.0, 140.0, 164.0, 92.0, 111.0, 109.0, 81.0, 44.0, 17.0, 45.0, 129.0, 57.0, 131.0, 145.0, 136.0, 114.0, 177.0, 155.0, 118.0, 108.0, 83.0, 16.0, 65.0, 53.0, 0.0, 0.0, 9.0, 46.0, 0.0, 75.0, 96.0, 25.0, 80.0, 97.0, 84.0, 117.0, 102.0, 73.0, 94.0, 110.0, 63.0, 129.0, 108.0, 107.0, 111.0, 0.0, 33.0, 19.0, 132.0, 16.0, 85.0, 160.0, 108.0, 27.0, 133.0, 61.0, 94.0, 44.0, 37.0, 66.0, 177.0, 4.0, 45.0, 132.0, 106.0, 152.0, 0.0, 26.0, 52.0, 66.0, 139.0, 82.0, 131.0, 21.0, 63.0, 82.0, 37.0, 121.0, 63.0, 91.0, 74.0, 18.0, 77.0, 0.0, 1.0, 60.0, 86.0, 50.0, 88.0, 61.0, 15.0, 79.0, 58.0, 111.0, 91.0, 48.0, 37.0, 54.0, 140.0, 41.0, 129.0, 43.0, 0.0, 106.0, 70.0, 22.0, 104.0, 15.0, 18.0, 114.0, 115.0, 44.0, 182.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6879297929398751, "mean_inference_ms": 1.5898052115602204, "mean_action_processing_ms": 0.2756956274720837, "mean_env_wait_ms": 0.21206383519030375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00623166561126709, "StateBufferConnector_ms": 0.004735589027404785, "ViewRequirementAgentConnector_ms": 0.1447298526763916}, "num_episodes": 23, "episode_return_max": 378.0, "episode_return_min": -403.0, "episode_return_mean": 36.62, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.14012346693625, "num_env_steps_trained_throughput_per_sec": 80.14012346693625, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 54080.657, "restore_workers_time_ms": 0.019, "training_step_time_ms": 54080.592, "sample_time_ms": 1341.371, "learn_time_ms": 52717.226, "learn_throughput": 75.877, "synch_weights_time_ms": 18.165}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "c1c5b_00000", "date": "2024-08-12_22-59-24", "timestamp": 1723517964, "time_this_iter_s": 49.9356369972229, "time_total_s": 541.2150437831879, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8031700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 541.2150437831879, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.543661971830986, "ram_util_percent": 76.32816901408452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.396092768762477, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.558598743166243, "policy_loss": -0.011774601318710854, "vf_loss": 8.568739910478945, "vf_explained_var": 0.06667170146154978, "kl": 0.010889645840480262, "entropy": 1.4866864261173067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.605991675235607, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.74990712625009, "policy_loss": -0.014418040176917597, "vf_loss": 8.761188263363309, "vf_explained_var": -0.1434473030150883, "kl": 0.010456246894697005, "entropy": 1.4743939532804742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -403.0, "episode_reward_mean": 4.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -77.825, "predator_policy": 80.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0, 187.0, -2.0, 20.0, 3.0, 80.0, 84.0, -173.0, 165.0, -69.0, 14.0, 173.0, -115.0, -31.0, 8.0, 127.0, 276.0, -47.0, -84.0, 45.0, -5.0, 303.0, 29.0, -25.0, 44.0, -193.0, -222.0, 38.0, 6.0, 115.0, 18.0, 53.0, -134.0, -174.0, -47.0, -14.0, 37.0, 258.0, 312.0, 108.0, 69.0, 97.0, -18.0, -104.0, 90.0, -269.0, 102.0, -71.0, 133.0, -67.0, -4.0, -74.0, -90.0, 76.0, 110.0, -54.0, 73.0, -3.0, -119.0, 80.0, -108.0, -85.0, 28.0, -26.0, 105.0, 21.0, -21.0, 378.0, 124.0, -15.0, 139.0, 54.0, -36.0, 35.0, -53.0, -25.0, 232.0, 54.0, 53.0, 134.0, -65.0, -403.0, -100.0, -198.0, -46.0, 83.0, -286.0, -100.0, 63.0, -59.0, -92.0, -22.0, -87.0, -163.0, -55.0, 47.0, 70.0, -82.0, -69.0, -348.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [196.0, 65.0, -59.0, 126.0, -85.0, -68.0, -99.0, -37.0, -38.0, -90.0, 58.0, -145.0, -87.0, 67.0, -120.0, -245.0, 121.0, -81.0, -151.0, -127.0, -164.0, 24.0, -26.0, 118.0, -82.0, -288.0, 0.0, -166.0, -3.0, -169.0, 188.0, -310.0, 171.0, 77.0, -247.0, 0.0, -246.0, -67.0, -146.0, 56.0, -88.0, 0.0, 36.0, 182.0, 0.0, -92.0, -129.0, -69.0, -42.0, 0.0, -203.0, -256.0, -228.0, -298.0, 42.0, -207.0, -183.0, -1.0, -86.0, 140.0, -93.0, -63.0, -94.0, -41.0, -159.0, -256.0, -122.0, -343.0, -301.0, -19.0, -196.0, -9.0, -44.0, 0.0, 74.0, 131.0, 193.0, 110.0, 0.0, 62.0, -155.0, 53.0, -25.0, 17.0, 0.0, -199.0, -142.0, -181.0, -14.0, -63.0, -228.0, -214.0, -234.0, 99.0, -169.0, -120.0, 100.0, 0.0, 0.0, -218.0, 0.0, -105.0, -62.0, -280.0, -145.0, -105.0, -12.0, -67.0, 29.0, 0.0, -13.0, -284.0, 0.0, 24.0, 75.0, -316.0, -138.0, -133.0, 2.0, 0.0, -313.0, 0.0, -286.0, -12.0, -56.0, 0.0, 0.0, -145.0, 73.0, -152.0, -144.0, 0.0, -116.0, 0.0, 197.0, 180.0, -2.0, -20.0, -56.0, -97.0, 36.0, 27.0, -64.0, -19.0, -135.0, -103.0, -54.0, 4.0, -82.0, -165.0, -195.0, 0.0, 74.0, 115.0, -144.0, 22.0, -75.0, 2.0, 101.0, 0.0, -95.0, -199.0, -283.0, -346.0, -128.0, -133.0, -194.0, -340.0, -176.0, -48.0, 33.0, -148.0, -191.0, -259.0, -143.0, -152.0, -31.0, -64.0, -294.0, -26.0, -41.0, -321.0, -68.0, -144.0, -262.0, 0.0, -239.0, -154.0, -17.0, -214.0, -197.0, 45.0, -10.0, -75.0, -75.0, -132.0, -172.0, -34.0, -325.0, -355.0], "policy_predator_policy_reward": [10.0, 14.0, 62.0, 58.0, 74.0, 77.0, 22.0, 134.0, 131.0, 0.0, 62.0, 105.0, 0.0, 104.0, 124.0, 68.0, 74.0, 51.0, 132.0, 77.0, 111.0, 43.0, 75.0, 6.0, 141.0, 114.0, 104.0, 31.0, 92.0, 88.0, 165.0, 84.0, 27.0, 1.0, 53.0, 147.0, 103.0, 126.0, 120.0, 15.0, 13.0, 70.0, 47.0, 38.0, 30.0, 91.0, 122.0, 51.0, 49.0, 37.0, 140.0, 126.0, 140.0, 164.0, 92.0, 111.0, 109.0, 81.0, 44.0, 17.0, 45.0, 129.0, 57.0, 131.0, 145.0, 136.0, 114.0, 177.0, 155.0, 118.0, 108.0, 83.0, 16.0, 65.0, 53.0, 0.0, 0.0, 9.0, 46.0, 0.0, 75.0, 96.0, 25.0, 80.0, 97.0, 84.0, 117.0, 102.0, 73.0, 94.0, 110.0, 63.0, 129.0, 108.0, 107.0, 111.0, 0.0, 33.0, 19.0, 132.0, 16.0, 85.0, 160.0, 108.0, 27.0, 133.0, 61.0, 94.0, 44.0, 37.0, 66.0, 177.0, 4.0, 45.0, 132.0, 106.0, 152.0, 0.0, 26.0, 52.0, 66.0, 139.0, 82.0, 131.0, 21.0, 63.0, 82.0, 37.0, 121.0, 63.0, 91.0, 74.0, 18.0, 77.0, 0.0, 1.0, 60.0, 86.0, 50.0, 88.0, 61.0, 15.0, 79.0, 58.0, 111.0, 91.0, 48.0, 37.0, 54.0, 140.0, 41.0, 129.0, 43.0, 0.0, 106.0, 70.0, 22.0, 104.0, 15.0, 18.0, 114.0, 115.0, 44.0, 182.0, 150.0, 11.0, 188.0, 148.0, 111.0, 67.0, 72.0, 126.0, 164.0, 0.0, 105.0, 90.0, 87.0, 71.0, 110.0, 151.0, 145.0, 125.0, 106.0, 84.0, 147.0, 28.0, 167.0, 63.0, 96.0, 80.0, 98.0, 101.0, 93.0, 62.0, 0.0, 125.0, 82.0, 55.0, 159.0, 173.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6912664095239903, "mean_inference_ms": 1.5973510965041406, "mean_action_processing_ms": 0.27610266713002685, "mean_env_wait_ms": 0.21281897661234922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006035327911376953, "StateBufferConnector_ms": 0.004630565643310547, "ViewRequirementAgentConnector_ms": 0.1362745761871338}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -403.0, "episode_return_mean": 4.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.40749030005465, "num_env_steps_trained_throughput_per_sec": 78.40749030005465, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 53512.443, "restore_workers_time_ms": 0.018, "training_step_time_ms": 53512.377, "sample_time_ms": 1311.166, "learn_time_ms": 52178.335, "learn_throughput": 76.66, "synch_weights_time_ms": 18.504}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-00-15", "timestamp": 1723518015, "time_this_iter_s": 51.029959201812744, "time_total_s": 592.2450029850006, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8031790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 592.2450029850006, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.238356164383557, "ram_util_percent": 79.24383561643835}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.140440654123902, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0097988007560605, "policy_loss": -0.010883187992922054, "vf_loss": 7.019250330344709, "vf_explained_var": 0.011632653928938367, "kl": 0.009544406282291038, "entropy": 1.467619928228792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.4548136868174115, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.77672137356309, "policy_loss": -0.01704300733618241, "vf_loss": 6.790234231444263, "vf_explained_var": -0.187833626181991, "kl": 0.01176716825721185, "entropy": 1.4826762978992765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -403.0, "episode_reward_mean": 3.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -79.145, "predator_policy": 80.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.0, 45.0, -5.0, 303.0, 29.0, -25.0, 44.0, -193.0, -222.0, 38.0, 6.0, 115.0, 18.0, 53.0, -134.0, -174.0, -47.0, -14.0, 37.0, 258.0, 312.0, 108.0, 69.0, 97.0, -18.0, -104.0, 90.0, -269.0, 102.0, -71.0, 133.0, -67.0, -4.0, -74.0, -90.0, 76.0, 110.0, -54.0, 73.0, -3.0, -119.0, 80.0, -108.0, -85.0, 28.0, -26.0, 105.0, 21.0, -21.0, 378.0, 124.0, -15.0, 139.0, 54.0, -36.0, 35.0, -53.0, -25.0, 232.0, 54.0, 53.0, 134.0, -65.0, -403.0, -100.0, -198.0, -46.0, 83.0, -286.0, -100.0, 63.0, -59.0, -92.0, -22.0, -87.0, -163.0, -55.0, 47.0, 70.0, -82.0, -69.0, -348.0, -91.0, 109.0, -3.0, 122.0, 87.0, -226.0, 81.0, 46.0, -28.0, 47.0, 131.0, 3.0, 48.0, -17.0, 38.0, 106.0, 171.0, 225.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-246.0, -67.0, -146.0, 56.0, -88.0, 0.0, 36.0, 182.0, 0.0, -92.0, -129.0, -69.0, -42.0, 0.0, -203.0, -256.0, -228.0, -298.0, 42.0, -207.0, -183.0, -1.0, -86.0, 140.0, -93.0, -63.0, -94.0, -41.0, -159.0, -256.0, -122.0, -343.0, -301.0, -19.0, -196.0, -9.0, -44.0, 0.0, 74.0, 131.0, 193.0, 110.0, 0.0, 62.0, -155.0, 53.0, -25.0, 17.0, 0.0, -199.0, -142.0, -181.0, -14.0, -63.0, -228.0, -214.0, -234.0, 99.0, -169.0, -120.0, 100.0, 0.0, 0.0, -218.0, 0.0, -105.0, -62.0, -280.0, -145.0, -105.0, -12.0, -67.0, 29.0, 0.0, -13.0, -284.0, 0.0, 24.0, 75.0, -316.0, -138.0, -133.0, 2.0, 0.0, -313.0, 0.0, -286.0, -12.0, -56.0, 0.0, 0.0, -145.0, 73.0, -152.0, -144.0, 0.0, -116.0, 0.0, 197.0, 180.0, -2.0, -20.0, -56.0, -97.0, 36.0, 27.0, -64.0, -19.0, -135.0, -103.0, -54.0, 4.0, -82.0, -165.0, -195.0, 0.0, 74.0, 115.0, -144.0, 22.0, -75.0, 2.0, 101.0, 0.0, -95.0, -199.0, -283.0, -346.0, -128.0, -133.0, -194.0, -340.0, -176.0, -48.0, 33.0, -148.0, -191.0, -259.0, -143.0, -152.0, -31.0, -64.0, -294.0, -26.0, -41.0, -321.0, -68.0, -144.0, -262.0, 0.0, -239.0, -154.0, -17.0, -214.0, -197.0, 45.0, -10.0, -75.0, -75.0, -132.0, -172.0, -34.0, -325.0, -355.0, -73.0, -324.0, 0.0, 74.0, 0.0, -42.0, -261.0, 156.0, 65.0, -120.0, -211.0, -336.0, -244.0, 89.0, -125.0, 0.0, 10.0, -258.0, 0.0, 45.0, -84.0, 85.0, 42.0, -268.0, 0.0, -115.0, -45.0, -146.0, -50.0, -20.0, -226.0, 84.0, 16.0, 117.0, 36.0, 189.0], "policy_predator_policy_reward": [103.0, 126.0, 120.0, 15.0, 13.0, 70.0, 47.0, 38.0, 30.0, 91.0, 122.0, 51.0, 49.0, 37.0, 140.0, 126.0, 140.0, 164.0, 92.0, 111.0, 109.0, 81.0, 44.0, 17.0, 45.0, 129.0, 57.0, 131.0, 145.0, 136.0, 114.0, 177.0, 155.0, 118.0, 108.0, 83.0, 16.0, 65.0, 53.0, 0.0, 0.0, 9.0, 46.0, 0.0, 75.0, 96.0, 25.0, 80.0, 97.0, 84.0, 117.0, 102.0, 73.0, 94.0, 110.0, 63.0, 129.0, 108.0, 107.0, 111.0, 0.0, 33.0, 19.0, 132.0, 16.0, 85.0, 160.0, 108.0, 27.0, 133.0, 61.0, 94.0, 44.0, 37.0, 66.0, 177.0, 4.0, 45.0, 132.0, 106.0, 152.0, 0.0, 26.0, 52.0, 66.0, 139.0, 82.0, 131.0, 21.0, 63.0, 82.0, 37.0, 121.0, 63.0, 91.0, 74.0, 18.0, 77.0, 0.0, 1.0, 60.0, 86.0, 50.0, 88.0, 61.0, 15.0, 79.0, 58.0, 111.0, 91.0, 48.0, 37.0, 54.0, 140.0, 41.0, 129.0, 43.0, 0.0, 106.0, 70.0, 22.0, 104.0, 15.0, 18.0, 114.0, 115.0, 44.0, 182.0, 150.0, 11.0, 188.0, 148.0, 111.0, 67.0, 72.0, 126.0, 164.0, 0.0, 105.0, 90.0, 87.0, 71.0, 110.0, 151.0, 145.0, 125.0, 106.0, 84.0, 147.0, 28.0, 167.0, 63.0, 96.0, 80.0, 98.0, 101.0, 93.0, 62.0, 0.0, 125.0, 82.0, 55.0, 159.0, 173.0, 145.0, 161.0, 31.0, 4.0, 18.0, 21.0, 107.0, 120.0, 57.0, 85.0, 160.0, 161.0, 100.0, 136.0, 106.0, 65.0, 88.0, 132.0, 0.0, 2.0, 54.0, 76.0, 156.0, 73.0, 64.0, 99.0, 100.0, 74.0, 54.0, 54.0, 136.0, 112.0, 20.0, 18.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6865779002254909, "mean_inference_ms": 1.5883646776074165, "mean_action_processing_ms": 0.2742677959215737, "mean_env_wait_ms": 0.21116170924699074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00576329231262207, "StateBufferConnector_ms": 0.003766179084777832, "ViewRequirementAgentConnector_ms": 0.11436927318572998}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -403.0, "episode_return_mean": 3.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.3929581088694, "num_env_steps_trained_throughput_per_sec": 82.3929581088694, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 52907.654, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52907.594, "sample_time_ms": 1292.877, "learn_time_ms": 51591.495, "learn_throughput": 77.532, "synch_weights_time_ms": 18.742}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-01-04", "timestamp": 1723518064, "time_this_iter_s": 48.58428692817688, "time_total_s": 640.8292899131775, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8079ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 640.8292899131775, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.740579710144925, "ram_util_percent": 78.1159420289855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.039841987090136, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.298313250365081, "policy_loss": -0.014507882112375997, "vf_loss": 5.311212434718218, "vf_explained_var": -0.010373848045944536, "kl": 0.010724617551118124, "entropy": 1.443059430235908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.351484681437255, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.953330464842458, "policy_loss": -0.01702409188346888, "vf_loss": 6.966827267439908, "vf_explained_var": -0.02249514246113086, "kl": 0.011757612430980585, "entropy": 1.4533801107810287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -403.0, "episode_reward_mean": 23.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -61.345, "predator_policy": 73.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 258.0, 312.0, 108.0, 69.0, 97.0, -18.0, -104.0, 90.0, -269.0, 102.0, -71.0, 133.0, -67.0, -4.0, -74.0, -90.0, 76.0, 110.0, -54.0, 73.0, -3.0, -119.0, 80.0, -108.0, -85.0, 28.0, -26.0, 105.0, 21.0, -21.0, 378.0, 124.0, -15.0, 139.0, 54.0, -36.0, 35.0, -53.0, -25.0, 232.0, 54.0, 53.0, 134.0, -65.0, -403.0, -100.0, -198.0, -46.0, 83.0, -286.0, -100.0, 63.0, -59.0, -92.0, -22.0, -87.0, -163.0, -55.0, 47.0, 70.0, -82.0, -69.0, -348.0, -91.0, 109.0, -3.0, 122.0, 87.0, -226.0, 81.0, 46.0, -28.0, 47.0, 131.0, 3.0, 48.0, -17.0, 38.0, 106.0, 171.0, 225.0, 47.0, 96.0, 133.0, 145.0, 11.0, 131.0, -79.0, 15.0, 289.0, 151.0, 154.0, 220.0, -8.0, -18.0, 142.0, 87.0, 18.0, 258.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.0, 0.0, 74.0, 131.0, 193.0, 110.0, 0.0, 62.0, -155.0, 53.0, -25.0, 17.0, 0.0, -199.0, -142.0, -181.0, -14.0, -63.0, -228.0, -214.0, -234.0, 99.0, -169.0, -120.0, 100.0, 0.0, 0.0, -218.0, 0.0, -105.0, -62.0, -280.0, -145.0, -105.0, -12.0, -67.0, 29.0, 0.0, -13.0, -284.0, 0.0, 24.0, 75.0, -316.0, -138.0, -133.0, 2.0, 0.0, -313.0, 0.0, -286.0, -12.0, -56.0, 0.0, 0.0, -145.0, 73.0, -152.0, -144.0, 0.0, -116.0, 0.0, 197.0, 180.0, -2.0, -20.0, -56.0, -97.0, 36.0, 27.0, -64.0, -19.0, -135.0, -103.0, -54.0, 4.0, -82.0, -165.0, -195.0, 0.0, 74.0, 115.0, -144.0, 22.0, -75.0, 2.0, 101.0, 0.0, -95.0, -199.0, -283.0, -346.0, -128.0, -133.0, -194.0, -340.0, -176.0, -48.0, 33.0, -148.0, -191.0, -259.0, -143.0, -152.0, -31.0, -64.0, -294.0, -26.0, -41.0, -321.0, -68.0, -144.0, -262.0, 0.0, -239.0, -154.0, -17.0, -214.0, -197.0, 45.0, -10.0, -75.0, -75.0, -132.0, -172.0, -34.0, -325.0, -355.0, -73.0, -324.0, 0.0, 74.0, 0.0, -42.0, -261.0, 156.0, 65.0, -120.0, -211.0, -336.0, -244.0, 89.0, -125.0, 0.0, 10.0, -258.0, 0.0, 45.0, -84.0, 85.0, 42.0, -268.0, 0.0, -115.0, -45.0, -146.0, -50.0, -20.0, -226.0, 84.0, 16.0, 117.0, 36.0, 189.0, -221.0, 20.0, 14.0, -32.0, -21.0, 46.0, 8.0, 46.0, -114.0, -29.0, 0.0, 130.0, -204.0, 11.0, 120.0, -337.0, 115.0, 143.0, 133.0, 0.0, -56.0, 116.0, 34.0, 135.0, 0.0, -28.0, -238.0, 5.0, 55.0, -39.0, 2.0, -63.0, -13.0, 21.0, 108.0, 112.0], "policy_predator_policy_reward": [16.0, 65.0, 53.0, 0.0, 0.0, 9.0, 46.0, 0.0, 75.0, 96.0, 25.0, 80.0, 97.0, 84.0, 117.0, 102.0, 73.0, 94.0, 110.0, 63.0, 129.0, 108.0, 107.0, 111.0, 0.0, 33.0, 19.0, 132.0, 16.0, 85.0, 160.0, 108.0, 27.0, 133.0, 61.0, 94.0, 44.0, 37.0, 66.0, 177.0, 4.0, 45.0, 132.0, 106.0, 152.0, 0.0, 26.0, 52.0, 66.0, 139.0, 82.0, 131.0, 21.0, 63.0, 82.0, 37.0, 121.0, 63.0, 91.0, 74.0, 18.0, 77.0, 0.0, 1.0, 60.0, 86.0, 50.0, 88.0, 61.0, 15.0, 79.0, 58.0, 111.0, 91.0, 48.0, 37.0, 54.0, 140.0, 41.0, 129.0, 43.0, 0.0, 106.0, 70.0, 22.0, 104.0, 15.0, 18.0, 114.0, 115.0, 44.0, 182.0, 150.0, 11.0, 188.0, 148.0, 111.0, 67.0, 72.0, 126.0, 164.0, 0.0, 105.0, 90.0, 87.0, 71.0, 110.0, 151.0, 145.0, 125.0, 106.0, 84.0, 147.0, 28.0, 167.0, 63.0, 96.0, 80.0, 98.0, 101.0, 93.0, 62.0, 0.0, 125.0, 82.0, 55.0, 159.0, 173.0, 145.0, 161.0, 31.0, 4.0, 18.0, 21.0, 107.0, 120.0, 57.0, 85.0, 160.0, 161.0, 100.0, 136.0, 106.0, 65.0, 88.0, 132.0, 0.0, 2.0, 54.0, 76.0, 156.0, 73.0, 64.0, 99.0, 100.0, 74.0, 54.0, 54.0, 136.0, 112.0, 20.0, 18.0, 0.0, 0.0, 116.0, 132.0, 50.0, 64.0, 48.0, 60.0, 53.0, 38.0, 91.0, 63.0, 0.0, 1.0, 114.0, 0.0, 54.0, 178.0, 23.0, 8.0, 18.0, 0.0, 77.0, 17.0, 51.0, 0.0, 12.0, 8.0, 129.0, 86.0, 67.0, 59.0, 65.0, 83.0, 0.0, 10.0, 23.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6793125339551884, "mean_inference_ms": 1.5692356885007808, "mean_action_processing_ms": 0.2710843566640474, "mean_env_wait_ms": 0.20840350405546967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005159735679626465, "StateBufferConnector_ms": 0.0037235021591186523, "ViewRequirementAgentConnector_ms": 0.10978829860687256}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -403.0, "episode_return_mean": 23.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.52821528435511, "num_env_steps_trained_throughput_per_sec": 80.52821528435511, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 52422.181, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52422.12, "sample_time_ms": 1275.619, "learn_time_ms": 51123.037, "learn_throughput": 78.243, "synch_weights_time_ms": 18.957}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-01-53", "timestamp": 1723518113, "time_this_iter_s": 49.70851683616638, "time_total_s": 690.5378067493439, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80a8430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 690.5378067493439, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.99571428571429, "ram_util_percent": 78.69714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.94510384337612, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.005871777307419, "policy_loss": -0.016134197418651883, "vf_loss": 6.020018726681906, "vf_explained_var": 0.049727644522984824, "kl": 0.013248218295812462, "entropy": 1.4259529680802079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.249675779430954, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.053717062460683, "policy_loss": -0.012145847677149706, "vf_loss": 8.063519692547107, "vf_explained_var": -0.03393655195438042, "kl": 0.007810746011091355, "entropy": 1.433931902350572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -403.0, "episode_reward_mean": 39.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 225.0}, "policy_reward_mean": {"prey_policy": -47.96, "predator_policy": 67.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.0, 105.0, 21.0, -21.0, 378.0, 124.0, -15.0, 139.0, 54.0, -36.0, 35.0, -53.0, -25.0, 232.0, 54.0, 53.0, 134.0, -65.0, -403.0, -100.0, -198.0, -46.0, 83.0, -286.0, -100.0, 63.0, -59.0, -92.0, -22.0, -87.0, -163.0, -55.0, 47.0, 70.0, -82.0, -69.0, -348.0, -91.0, 109.0, -3.0, 122.0, 87.0, -226.0, 81.0, 46.0, -28.0, 47.0, 131.0, 3.0, 48.0, -17.0, 38.0, 106.0, 171.0, 225.0, 47.0, 96.0, 133.0, 145.0, 11.0, 131.0, -79.0, 15.0, 289.0, 151.0, 154.0, 220.0, -8.0, -18.0, 142.0, 87.0, 18.0, 258.0, 11.0, -64.0, 84.0, 31.0, 19.0, -32.0, 50.0, -1.0, 270.0, 188.0, 244.0, 154.0, 213.0, 43.0, 191.0, 17.0, 252.0, 42.0, 75.0, 17.0, 86.0, -11.0, -380.0, 334.0, 167.0, 24.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -145.0, 73.0, -152.0, -144.0, 0.0, -116.0, 0.0, 197.0, 180.0, -2.0, -20.0, -56.0, -97.0, 36.0, 27.0, -64.0, -19.0, -135.0, -103.0, -54.0, 4.0, -82.0, -165.0, -195.0, 0.0, 74.0, 115.0, -144.0, 22.0, -75.0, 2.0, 101.0, 0.0, -95.0, -199.0, -283.0, -346.0, -128.0, -133.0, -194.0, -340.0, -176.0, -48.0, 33.0, -148.0, -191.0, -259.0, -143.0, -152.0, -31.0, -64.0, -294.0, -26.0, -41.0, -321.0, -68.0, -144.0, -262.0, 0.0, -239.0, -154.0, -17.0, -214.0, -197.0, 45.0, -10.0, -75.0, -75.0, -132.0, -172.0, -34.0, -325.0, -355.0, -73.0, -324.0, 0.0, 74.0, 0.0, -42.0, -261.0, 156.0, 65.0, -120.0, -211.0, -336.0, -244.0, 89.0, -125.0, 0.0, 10.0, -258.0, 0.0, 45.0, -84.0, 85.0, 42.0, -268.0, 0.0, -115.0, -45.0, -146.0, -50.0, -20.0, -226.0, 84.0, 16.0, 117.0, 36.0, 189.0, -221.0, 20.0, 14.0, -32.0, -21.0, 46.0, 8.0, 46.0, -114.0, -29.0, 0.0, 130.0, -204.0, 11.0, 120.0, -337.0, 115.0, 143.0, 133.0, 0.0, -56.0, 116.0, 34.0, 135.0, 0.0, -28.0, -238.0, 5.0, 55.0, -39.0, 2.0, -63.0, -13.0, 21.0, 108.0, 112.0, 137.0, -370.0, -82.0, -181.0, -16.0, 52.0, -14.0, -218.0, -65.0, -44.0, -18.0, -134.0, 9.0, -29.0, -87.0, 0.0, 121.0, 125.0, 140.0, 25.0, 60.0, 127.0, 151.0, -108.0, 151.0, -6.0, -54.0, -53.0, 14.0, 95.0, 0.0, -77.0, 65.0, 138.0, -10.0, -33.0, 23.0, 0.0, -131.0, -16.0, 0.0, 43.0, 0.0, -22.0, -299.0, -302.0, 174.0, 153.0, -21.0, 101.0, -11.0, -37.0, -33.0, -120.0], "policy_predator_policy_reward": [82.0, 37.0, 121.0, 63.0, 91.0, 74.0, 18.0, 77.0, 0.0, 1.0, 60.0, 86.0, 50.0, 88.0, 61.0, 15.0, 79.0, 58.0, 111.0, 91.0, 48.0, 37.0, 54.0, 140.0, 41.0, 129.0, 43.0, 0.0, 106.0, 70.0, 22.0, 104.0, 15.0, 18.0, 114.0, 115.0, 44.0, 182.0, 150.0, 11.0, 188.0, 148.0, 111.0, 67.0, 72.0, 126.0, 164.0, 0.0, 105.0, 90.0, 87.0, 71.0, 110.0, 151.0, 145.0, 125.0, 106.0, 84.0, 147.0, 28.0, 167.0, 63.0, 96.0, 80.0, 98.0, 101.0, 93.0, 62.0, 0.0, 125.0, 82.0, 55.0, 159.0, 173.0, 145.0, 161.0, 31.0, 4.0, 18.0, 21.0, 107.0, 120.0, 57.0, 85.0, 160.0, 161.0, 100.0, 136.0, 106.0, 65.0, 88.0, 132.0, 0.0, 2.0, 54.0, 76.0, 156.0, 73.0, 64.0, 99.0, 100.0, 74.0, 54.0, 54.0, 136.0, 112.0, 20.0, 18.0, 0.0, 0.0, 116.0, 132.0, 50.0, 64.0, 48.0, 60.0, 53.0, 38.0, 91.0, 63.0, 0.0, 1.0, 114.0, 0.0, 54.0, 178.0, 23.0, 8.0, 18.0, 0.0, 77.0, 17.0, 51.0, 0.0, 12.0, 8.0, 129.0, 86.0, 67.0, 59.0, 65.0, 83.0, 0.0, 10.0, 23.0, 15.0, 225.0, 19.0, 133.0, 66.0, 40.0, 8.0, 142.0, 121.0, 63.0, 65.0, 22.0, 98.0, 24.0, 46.0, 36.0, 50.0, 18.0, 6.0, 13.0, 10.0, 13.0, 44.0, 62.0, 49.0, 68.0, 0.0, 78.0, 72.0, 25.0, 57.0, 36.0, 58.0, 14.0, 35.0, 80.0, 5.0, 42.0, 10.0, 83.0, 81.0, 25.0, 18.0, 11.0, 0.0, 43.0, 178.0, 7.0, 0.0, 40.0, 47.0, 35.0, 37.0, 64.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6694194736151259, "mean_inference_ms": 1.5408218859364167, "mean_action_processing_ms": 0.2658938298587566, "mean_env_wait_ms": 0.20455146418338294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005157113075256348, "StateBufferConnector_ms": 0.0037038326263427734, "ViewRequirementAgentConnector_ms": 0.10952341556549072}, "num_episodes": 27, "episode_return_max": 378.0, "episode_return_min": -403.0, "episode_return_mean": 39.27, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.23468305566347, "num_env_steps_trained_throughput_per_sec": 78.23468305566347, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 52319.336, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52319.26, "sample_time_ms": 1272.506, "learn_time_ms": 51022.43, "learn_throughput": 78.397, "synch_weights_time_ms": 19.497}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-02-44", "timestamp": 1723518164, "time_this_iter_s": 51.17021608352661, "time_total_s": 741.7080228328705, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80b14c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 741.7080228328705, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.643835616438356, "ram_util_percent": 79.0041095890411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.807865098986046, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.231019590266798, "policy_loss": -0.01572473606725455, "vf_loss": 7.244254867361967, "vf_explained_var": 0.02158625400255597, "kl": 0.016596381517269443, "entropy": 1.4386697388830638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.975136840154254, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.934918668787315, "policy_loss": -0.008909548499261734, "vf_loss": 6.9417962202950125, "vf_explained_var": -0.04747282872124324, "kl": 0.00677320517959013, "entropy": 1.4244685820801548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -409.0, "episode_reward_mean": 10.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 373.0}, "policy_reward_mean": {"prey_policy": -65.095, "predator_policy": 70.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-403.0, -100.0, -198.0, -46.0, 83.0, -286.0, -100.0, 63.0, -59.0, -92.0, -22.0, -87.0, -163.0, -55.0, 47.0, 70.0, -82.0, -69.0, -348.0, -91.0, 109.0, -3.0, 122.0, 87.0, -226.0, 81.0, 46.0, -28.0, 47.0, 131.0, 3.0, 48.0, -17.0, 38.0, 106.0, 171.0, 225.0, 47.0, 96.0, 133.0, 145.0, 11.0, 131.0, -79.0, 15.0, 289.0, 151.0, 154.0, 220.0, -8.0, -18.0, 142.0, 87.0, 18.0, 258.0, 11.0, -64.0, 84.0, 31.0, 19.0, -32.0, 50.0, -1.0, 270.0, 188.0, 244.0, 154.0, 213.0, 43.0, 191.0, 17.0, 252.0, 42.0, 75.0, 17.0, 86.0, -11.0, -380.0, 334.0, 167.0, 24.0, 21.0, -213.0, 37.0, -191.0, -409.0, 83.0, 144.0, -91.0, -161.0, 0.0, 64.0, -85.0, -45.0, 5.0, -112.0, -343.0, -284.0, 59.0, -210.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-283.0, -346.0, -128.0, -133.0, -194.0, -340.0, -176.0, -48.0, 33.0, -148.0, -191.0, -259.0, -143.0, -152.0, -31.0, -64.0, -294.0, -26.0, -41.0, -321.0, -68.0, -144.0, -262.0, 0.0, -239.0, -154.0, -17.0, -214.0, -197.0, 45.0, -10.0, -75.0, -75.0, -132.0, -172.0, -34.0, -325.0, -355.0, -73.0, -324.0, 0.0, 74.0, 0.0, -42.0, -261.0, 156.0, 65.0, -120.0, -211.0, -336.0, -244.0, 89.0, -125.0, 0.0, 10.0, -258.0, 0.0, 45.0, -84.0, 85.0, 42.0, -268.0, 0.0, -115.0, -45.0, -146.0, -50.0, -20.0, -226.0, 84.0, 16.0, 117.0, 36.0, 189.0, -221.0, 20.0, 14.0, -32.0, -21.0, 46.0, 8.0, 46.0, -114.0, -29.0, 0.0, 130.0, -204.0, 11.0, 120.0, -337.0, 115.0, 143.0, 133.0, 0.0, -56.0, 116.0, 34.0, 135.0, 0.0, -28.0, -238.0, 5.0, 55.0, -39.0, 2.0, -63.0, -13.0, 21.0, 108.0, 112.0, 137.0, -370.0, -82.0, -181.0, -16.0, 52.0, -14.0, -218.0, -65.0, -44.0, -18.0, -134.0, 9.0, -29.0, -87.0, 0.0, 121.0, 125.0, 140.0, 25.0, 60.0, 127.0, 151.0, -108.0, 151.0, -6.0, -54.0, -53.0, 14.0, 95.0, 0.0, -77.0, 65.0, 138.0, -10.0, -33.0, 23.0, 0.0, -131.0, -16.0, 0.0, 43.0, 0.0, -22.0, -299.0, -302.0, 174.0, 153.0, -21.0, 101.0, -11.0, -37.0, -33.0, -120.0, -199.0, -228.0, -24.0, -52.0, -167.0, -167.0, -335.0, -304.0, 0.0, 50.0, 0.0, 119.0, 0.0, -241.0, -58.0, -337.0, 0.0, 0.0, 16.0, 0.0, -93.0, -127.0, -205.0, 0.0, 0.0, -161.0, -311.0, 0.0, -258.0, -351.0, -272.0, -246.0, -15.0, 0.0, -546.0, -146.0], "policy_predator_policy_reward": [44.0, 182.0, 150.0, 11.0, 188.0, 148.0, 111.0, 67.0, 72.0, 126.0, 164.0, 0.0, 105.0, 90.0, 87.0, 71.0, 110.0, 151.0, 145.0, 125.0, 106.0, 84.0, 147.0, 28.0, 167.0, 63.0, 96.0, 80.0, 98.0, 101.0, 93.0, 62.0, 0.0, 125.0, 82.0, 55.0, 159.0, 173.0, 145.0, 161.0, 31.0, 4.0, 18.0, 21.0, 107.0, 120.0, 57.0, 85.0, 160.0, 161.0, 100.0, 136.0, 106.0, 65.0, 88.0, 132.0, 0.0, 2.0, 54.0, 76.0, 156.0, 73.0, 64.0, 99.0, 100.0, 74.0, 54.0, 54.0, 136.0, 112.0, 20.0, 18.0, 0.0, 0.0, 116.0, 132.0, 50.0, 64.0, 48.0, 60.0, 53.0, 38.0, 91.0, 63.0, 0.0, 1.0, 114.0, 0.0, 54.0, 178.0, 23.0, 8.0, 18.0, 0.0, 77.0, 17.0, 51.0, 0.0, 12.0, 8.0, 129.0, 86.0, 67.0, 59.0, 65.0, 83.0, 0.0, 10.0, 23.0, 15.0, 225.0, 19.0, 133.0, 66.0, 40.0, 8.0, 142.0, 121.0, 63.0, 65.0, 22.0, 98.0, 24.0, 46.0, 36.0, 50.0, 18.0, 6.0, 13.0, 10.0, 13.0, 44.0, 62.0, 49.0, 68.0, 0.0, 78.0, 72.0, 25.0, 57.0, 36.0, 58.0, 14.0, 35.0, 80.0, 5.0, 42.0, 10.0, 83.0, 81.0, 25.0, 18.0, 11.0, 0.0, 43.0, 178.0, 7.0, 0.0, 40.0, 47.0, 35.0, 37.0, 64.0, 110.0, 116.0, 98.0, 89.0, 24.0, 22.0, 121.0, 43.0, 187.0, 17.0, 16.0, 0.0, 25.0, 144.0, 6.0, 62.0, 172.0, 0.0, 0.0, 18.0, 30.0, 48.0, 87.0, 75.0, 85.0, 56.0, 110.0, 124.0, 75.0, 141.0, 125.0, 126.0, 108.0, 33.0, 41.0, 373.0, 109.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6616304002446393, "mean_inference_ms": 1.5203515455698613, "mean_action_processing_ms": 0.2635112294887427, "mean_env_wait_ms": 0.2020414214535289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379025936126709, "StateBufferConnector_ms": 0.0029562711715698242, "ViewRequirementAgentConnector_ms": 0.09431278705596924}, "num_episodes": 18, "episode_return_max": 334.0, "episode_return_min": -409.0, "episode_return_mean": 10.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.17466018697989, "num_env_steps_trained_throughput_per_sec": 73.17466018697989, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 52480.185, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52480.098, "sample_time_ms": 1252.788, "learn_time_ms": 51202.282, "learn_throughput": 78.122, "synch_weights_time_ms": 20.0}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-03-39", "timestamp": 1723518219, "time_this_iter_s": 54.68942713737488, "time_total_s": 796.3974499702454, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8095550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 796.3974499702454, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.079487179487174, "ram_util_percent": 82.95897435897436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9837906041473308, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8156043330197615, "policy_loss": -0.013462466316509538, "vf_loss": 7.827158690255786, "vf_explained_var": 0.04192095408363948, "kl": 0.012720908539683579, "entropy": 1.4329921540759858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.92965458546366, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.611303851465699, "policy_loss": -0.012269672905907981, "vf_loss": 6.620728450351291, "vf_explained_var": -0.05719002346513133, "kl": 0.009483617578640947, "entropy": 1.3963378376430935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -409.0, "episode_reward_mean": 17.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 373.0}, "policy_reward_mean": {"prey_policy": -61.93, "predator_policy": 70.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-348.0, -91.0, 109.0, -3.0, 122.0, 87.0, -226.0, 81.0, 46.0, -28.0, 47.0, 131.0, 3.0, 48.0, -17.0, 38.0, 106.0, 171.0, 225.0, 47.0, 96.0, 133.0, 145.0, 11.0, 131.0, -79.0, 15.0, 289.0, 151.0, 154.0, 220.0, -8.0, -18.0, 142.0, 87.0, 18.0, 258.0, 11.0, -64.0, 84.0, 31.0, 19.0, -32.0, 50.0, -1.0, 270.0, 188.0, 244.0, 154.0, 213.0, 43.0, 191.0, 17.0, 252.0, 42.0, 75.0, 17.0, 86.0, -11.0, -380.0, 334.0, 167.0, 24.0, 21.0, -213.0, 37.0, -191.0, -409.0, 83.0, 144.0, -91.0, -161.0, 0.0, 64.0, -85.0, -45.0, 5.0, -112.0, -343.0, -284.0, 59.0, -210.0, -134.0, -91.0, 17.0, 70.0, -36.0, -150.0, -115.0, -100.0, 42.0, -69.0, 16.0, -107.0, 29.0, -54.0, -326.0, 103.0, 77.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-325.0, -355.0, -73.0, -324.0, 0.0, 74.0, 0.0, -42.0, -261.0, 156.0, 65.0, -120.0, -211.0, -336.0, -244.0, 89.0, -125.0, 0.0, 10.0, -258.0, 0.0, 45.0, -84.0, 85.0, 42.0, -268.0, 0.0, -115.0, -45.0, -146.0, -50.0, -20.0, -226.0, 84.0, 16.0, 117.0, 36.0, 189.0, -221.0, 20.0, 14.0, -32.0, -21.0, 46.0, 8.0, 46.0, -114.0, -29.0, 0.0, 130.0, -204.0, 11.0, 120.0, -337.0, 115.0, 143.0, 133.0, 0.0, -56.0, 116.0, 34.0, 135.0, 0.0, -28.0, -238.0, 5.0, 55.0, -39.0, 2.0, -63.0, -13.0, 21.0, 108.0, 112.0, 137.0, -370.0, -82.0, -181.0, -16.0, 52.0, -14.0, -218.0, -65.0, -44.0, -18.0, -134.0, 9.0, -29.0, -87.0, 0.0, 121.0, 125.0, 140.0, 25.0, 60.0, 127.0, 151.0, -108.0, 151.0, -6.0, -54.0, -53.0, 14.0, 95.0, 0.0, -77.0, 65.0, 138.0, -10.0, -33.0, 23.0, 0.0, -131.0, -16.0, 0.0, 43.0, 0.0, -22.0, -299.0, -302.0, 174.0, 153.0, -21.0, 101.0, -11.0, -37.0, -33.0, -120.0, -199.0, -228.0, -24.0, -52.0, -167.0, -167.0, -335.0, -304.0, 0.0, 50.0, 0.0, 119.0, 0.0, -241.0, -58.0, -337.0, 0.0, 0.0, 16.0, 0.0, -93.0, -127.0, -205.0, 0.0, 0.0, -161.0, -311.0, 0.0, -258.0, -351.0, -272.0, -246.0, -15.0, 0.0, -546.0, -146.0, -78.0, -303.0, -390.0, 0.0, -325.0, 80.0, -21.0, 0.0, -280.0, -24.0, -86.0, -344.0, -276.0, -122.0, -156.0, -168.0, 101.0, -332.0, 0.0, -382.0, 16.0, 0.0, -299.0, 0.0, 101.0, -336.0, 0.0, -226.0, -341.0, -248.0, -8.0, 61.0, 77.0, -10.0, -10.0, -71.0], "policy_predator_policy_reward": [159.0, 173.0, 145.0, 161.0, 31.0, 4.0, 18.0, 21.0, 107.0, 120.0, 57.0, 85.0, 160.0, 161.0, 100.0, 136.0, 106.0, 65.0, 88.0, 132.0, 0.0, 2.0, 54.0, 76.0, 156.0, 73.0, 64.0, 99.0, 100.0, 74.0, 54.0, 54.0, 136.0, 112.0, 20.0, 18.0, 0.0, 0.0, 116.0, 132.0, 50.0, 64.0, 48.0, 60.0, 53.0, 38.0, 91.0, 63.0, 0.0, 1.0, 114.0, 0.0, 54.0, 178.0, 23.0, 8.0, 18.0, 0.0, 77.0, 17.0, 51.0, 0.0, 12.0, 8.0, 129.0, 86.0, 67.0, 59.0, 65.0, 83.0, 0.0, 10.0, 23.0, 15.0, 225.0, 19.0, 133.0, 66.0, 40.0, 8.0, 142.0, 121.0, 63.0, 65.0, 22.0, 98.0, 24.0, 46.0, 36.0, 50.0, 18.0, 6.0, 13.0, 10.0, 13.0, 44.0, 62.0, 49.0, 68.0, 0.0, 78.0, 72.0, 25.0, 57.0, 36.0, 58.0, 14.0, 35.0, 80.0, 5.0, 42.0, 10.0, 83.0, 81.0, 25.0, 18.0, 11.0, 0.0, 43.0, 178.0, 7.0, 0.0, 40.0, 47.0, 35.0, 37.0, 64.0, 110.0, 116.0, 98.0, 89.0, 24.0, 22.0, 121.0, 43.0, 187.0, 17.0, 16.0, 0.0, 25.0, 144.0, 6.0, 62.0, 172.0, 0.0, 0.0, 18.0, 30.0, 48.0, 87.0, 75.0, 85.0, 56.0, 110.0, 124.0, 75.0, 141.0, 125.0, 126.0, 108.0, 33.0, 41.0, 373.0, 109.0, 130.0, 117.0, 139.0, 160.0, 178.0, 84.0, 29.0, 62.0, 127.0, 141.0, 106.0, 174.0, 178.0, 105.0, 115.0, 109.0, 116.0, 157.0, 184.0, 129.0, 0.0, 0.0, 81.0, 111.0, 149.0, 115.0, 32.0, 140.0, 114.0, 149.0, 20.0, 30.0, 10.0, 0.0, 47.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6596354217083373, "mean_inference_ms": 1.5142018068398795, "mean_action_processing_ms": 0.26238562101732066, "mean_env_wait_ms": 0.20176351039195556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003976106643676758, "StateBufferConnector_ms": 0.0030258893966674805, "ViewRequirementAgentConnector_ms": 0.09667468070983887}, "num_episodes": 18, "episode_return_max": 334.0, "episode_return_min": -409.0, "episode_return_mean": 17.59, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.88302428649675, "num_env_steps_trained_throughput_per_sec": 74.88302428649675, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 52517.553, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52517.469, "sample_time_ms": 1287.775, "learn_time_ms": 51205.653, "learn_throughput": 78.116, "synch_weights_time_ms": 19.053}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-04-33", "timestamp": 1723518273, "time_this_iter_s": 53.44980311393738, "time_total_s": 849.8472530841827, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80315e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 849.8472530841827, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.330263157894734, "ram_util_percent": 81.80263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.211404727691065, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9947126948644245, "policy_loss": -0.010801090547327129, "vf_loss": 6.003980825565479, "vf_explained_var": 0.055672479275042416, "kl": 0.010219727703050052, "entropy": 1.4055265919241324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.196136930411455, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.987858862599368, "policy_loss": -0.014724283722579164, "vf_loss": 5.999985898234857, "vf_explained_var": -0.012118918113607578, "kl": 0.008657477228427347, "entropy": 1.409187669665725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -409.0, "episode_reward_mean": 6.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 373.0}, "policy_reward_mean": {"prey_policy": -67.34, "predator_policy": 70.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [225.0, 47.0, 96.0, 133.0, 145.0, 11.0, 131.0, -79.0, 15.0, 289.0, 151.0, 154.0, 220.0, -8.0, -18.0, 142.0, 87.0, 18.0, 258.0, 11.0, -64.0, 84.0, 31.0, 19.0, -32.0, 50.0, -1.0, 270.0, 188.0, 244.0, 154.0, 213.0, 43.0, 191.0, 17.0, 252.0, 42.0, 75.0, 17.0, 86.0, -11.0, -380.0, 334.0, 167.0, 24.0, 21.0, -213.0, 37.0, -191.0, -409.0, 83.0, 144.0, -91.0, -161.0, 0.0, 64.0, -85.0, -45.0, 5.0, -112.0, -343.0, -284.0, 59.0, -210.0, -134.0, -91.0, 17.0, 70.0, -36.0, -150.0, -115.0, -100.0, 42.0, -69.0, 16.0, -107.0, 29.0, -54.0, -326.0, 103.0, 77.0, 1.0, -271.0, -359.0, 22.0, -160.0, -47.0, -113.0, -7.0, 56.0, 34.0, 89.0, 123.0, -83.0, 173.0, 100.0, -99.0, 22.0, -293.0, 18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [36.0, 189.0, -221.0, 20.0, 14.0, -32.0, -21.0, 46.0, 8.0, 46.0, -114.0, -29.0, 0.0, 130.0, -204.0, 11.0, 120.0, -337.0, 115.0, 143.0, 133.0, 0.0, -56.0, 116.0, 34.0, 135.0, 0.0, -28.0, -238.0, 5.0, 55.0, -39.0, 2.0, -63.0, -13.0, 21.0, 108.0, 112.0, 137.0, -370.0, -82.0, -181.0, -16.0, 52.0, -14.0, -218.0, -65.0, -44.0, -18.0, -134.0, 9.0, -29.0, -87.0, 0.0, 121.0, 125.0, 140.0, 25.0, 60.0, 127.0, 151.0, -108.0, 151.0, -6.0, -54.0, -53.0, 14.0, 95.0, 0.0, -77.0, 65.0, 138.0, -10.0, -33.0, 23.0, 0.0, -131.0, -16.0, 0.0, 43.0, 0.0, -22.0, -299.0, -302.0, 174.0, 153.0, -21.0, 101.0, -11.0, -37.0, -33.0, -120.0, -199.0, -228.0, -24.0, -52.0, -167.0, -167.0, -335.0, -304.0, 0.0, 50.0, 0.0, 119.0, 0.0, -241.0, -58.0, -337.0, 0.0, 0.0, 16.0, 0.0, -93.0, -127.0, -205.0, 0.0, 0.0, -161.0, -311.0, 0.0, -258.0, -351.0, -272.0, -246.0, -15.0, 0.0, -546.0, -146.0, -78.0, -303.0, -390.0, 0.0, -325.0, 80.0, -21.0, 0.0, -280.0, -24.0, -86.0, -344.0, -276.0, -122.0, -156.0, -168.0, 101.0, -332.0, 0.0, -382.0, 16.0, 0.0, -299.0, 0.0, 101.0, -336.0, 0.0, -226.0, -341.0, -248.0, -8.0, 61.0, 77.0, -10.0, -10.0, -71.0, -298.0, -195.0, -301.0, -397.0, -81.0, 0.0, -182.0, -275.0, -43.0, -183.0, -232.0, -196.0, -14.0, 0.0, 49.0, -340.0, 0.0, 24.0, 70.0, -148.0, 123.0, 0.0, -155.0, -187.0, 77.0, 34.0, -303.0, 76.0, -242.0, -85.0, 0.0, 22.0, -237.0, -325.0, 17.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 116.0, 132.0, 50.0, 64.0, 48.0, 60.0, 53.0, 38.0, 91.0, 63.0, 0.0, 1.0, 114.0, 0.0, 54.0, 178.0, 23.0, 8.0, 18.0, 0.0, 77.0, 17.0, 51.0, 0.0, 12.0, 8.0, 129.0, 86.0, 67.0, 59.0, 65.0, 83.0, 0.0, 10.0, 23.0, 15.0, 225.0, 19.0, 133.0, 66.0, 40.0, 8.0, 142.0, 121.0, 63.0, 65.0, 22.0, 98.0, 24.0, 46.0, 36.0, 50.0, 18.0, 6.0, 13.0, 10.0, 13.0, 44.0, 62.0, 49.0, 68.0, 0.0, 78.0, 72.0, 25.0, 57.0, 36.0, 58.0, 14.0, 35.0, 80.0, 5.0, 42.0, 10.0, 83.0, 81.0, 25.0, 18.0, 11.0, 0.0, 43.0, 178.0, 7.0, 0.0, 40.0, 47.0, 35.0, 37.0, 64.0, 110.0, 116.0, 98.0, 89.0, 24.0, 22.0, 121.0, 43.0, 187.0, 17.0, 16.0, 0.0, 25.0, 144.0, 6.0, 62.0, 172.0, 0.0, 0.0, 18.0, 30.0, 48.0, 87.0, 75.0, 85.0, 56.0, 110.0, 124.0, 75.0, 141.0, 125.0, 126.0, 108.0, 33.0, 41.0, 373.0, 109.0, 130.0, 117.0, 139.0, 160.0, 178.0, 84.0, 29.0, 62.0, 127.0, 141.0, 106.0, 174.0, 178.0, 105.0, 115.0, 109.0, 116.0, 157.0, 184.0, 129.0, 0.0, 0.0, 81.0, 111.0, 149.0, 115.0, 32.0, 140.0, 114.0, 149.0, 20.0, 30.0, 10.0, 0.0, 47.0, 35.0, 120.0, 102.0, 149.0, 190.0, 35.0, 68.0, 144.0, 153.0, 115.0, 64.0, 176.0, 139.0, 7.0, 0.0, 155.0, 192.0, 4.0, 6.0, 116.0, 51.0, 0.0, 0.0, 122.0, 137.0, 40.0, 22.0, 165.0, 162.0, 131.0, 97.0, 0.0, 0.0, 136.0, 133.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.658271838689129, "mean_inference_ms": 1.5099187754903953, "mean_action_processing_ms": 0.26151467293073394, "mean_env_wait_ms": 0.20171280371401998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004195094108581543, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.0963674783706665}, "num_episodes": 18, "episode_return_max": 334.0, "episode_return_min": -409.0, "episode_return_mean": 6.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.42301411954196, "num_env_steps_trained_throughput_per_sec": 79.42301411954196, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 51733.839, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51733.758, "sample_time_ms": 1214.985, "learn_time_ms": 50497.112, "learn_throughput": 79.212, "synch_weights_time_ms": 17.086}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-05-23", "timestamp": 1723518323, "time_this_iter_s": 50.42542791366577, "time_total_s": 900.2726809978485, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80314c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 900.2726809978485, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.377464788732397, "ram_util_percent": 81.80281690140846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.652138824753029, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5662640677558053, "policy_loss": -0.006723345692821399, "vf_loss": 3.5721720023129984, "vf_explained_var": 0.0306542695830108, "kl": 0.005436082845318217, "entropy": 1.423939390094192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.759199637332291, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5879707968424235, "policy_loss": -0.012075741232801524, "vf_loss": 5.597048938968194, "vf_explained_var": 0.13771508209919803, "kl": 0.009992000798950018, "entropy": 1.3948679066839673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -409.0, "episode_reward_mean": -8.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 174.0, "predator_policy": 378.0}, "policy_reward_mean": {"prey_policy": -75.125, "predator_policy": 70.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.0, 19.0, -32.0, 50.0, -1.0, 270.0, 188.0, 244.0, 154.0, 213.0, 43.0, 191.0, 17.0, 252.0, 42.0, 75.0, 17.0, 86.0, -11.0, -380.0, 334.0, 167.0, 24.0, 21.0, -213.0, 37.0, -191.0, -409.0, 83.0, 144.0, -91.0, -161.0, 0.0, 64.0, -85.0, -45.0, 5.0, -112.0, -343.0, -284.0, 59.0, -210.0, -134.0, -91.0, 17.0, 70.0, -36.0, -150.0, -115.0, -100.0, 42.0, -69.0, 16.0, -107.0, 29.0, -54.0, -326.0, 103.0, 77.0, 1.0, -271.0, -359.0, 22.0, -160.0, -47.0, -113.0, -7.0, 56.0, 34.0, 89.0, 123.0, -83.0, 173.0, 100.0, -99.0, 22.0, -293.0, 18.0, -65.0, 0.0, -128.0, 184.0, 59.0, -29.0, -5.0, 14.0, 170.0, 157.0, 17.0, 140.0, -29.0, -103.0, 114.0, -37.0, 0.0, 28.0, -102.0, 117.0, 0.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, -218.0, -65.0, -44.0, -18.0, -134.0, 9.0, -29.0, -87.0, 0.0, 121.0, 125.0, 140.0, 25.0, 60.0, 127.0, 151.0, -108.0, 151.0, -6.0, -54.0, -53.0, 14.0, 95.0, 0.0, -77.0, 65.0, 138.0, -10.0, -33.0, 23.0, 0.0, -131.0, -16.0, 0.0, 43.0, 0.0, -22.0, -299.0, -302.0, 174.0, 153.0, -21.0, 101.0, -11.0, -37.0, -33.0, -120.0, -199.0, -228.0, -24.0, -52.0, -167.0, -167.0, -335.0, -304.0, 0.0, 50.0, 0.0, 119.0, 0.0, -241.0, -58.0, -337.0, 0.0, 0.0, 16.0, 0.0, -93.0, -127.0, -205.0, 0.0, 0.0, -161.0, -311.0, 0.0, -258.0, -351.0, -272.0, -246.0, -15.0, 0.0, -546.0, -146.0, -78.0, -303.0, -390.0, 0.0, -325.0, 80.0, -21.0, 0.0, -280.0, -24.0, -86.0, -344.0, -276.0, -122.0, -156.0, -168.0, 101.0, -332.0, 0.0, -382.0, 16.0, 0.0, -299.0, 0.0, 101.0, -336.0, 0.0, -226.0, -341.0, -248.0, -8.0, 61.0, 77.0, -10.0, -10.0, -71.0, -298.0, -195.0, -301.0, -397.0, -81.0, 0.0, -182.0, -275.0, -43.0, -183.0, -232.0, -196.0, -14.0, 0.0, 49.0, -340.0, 0.0, 24.0, 70.0, -148.0, 123.0, 0.0, -155.0, -187.0, 77.0, 34.0, -303.0, 76.0, -242.0, -85.0, 0.0, 22.0, -237.0, -325.0, 17.0, 0.0, -396.0, 0.0, 0.0, 0.0, -31.0, -546.0, 116.0, -84.0, 0.0, -4.0, -58.0, 0.0, 0.0, -10.0, -116.0, 18.0, -35.0, 169.0, 1.0, 110.0, 0.0, -93.0, 136.0, 0.0, -286.0, 0.0, -37.0, -414.0, -2.0, 85.0, -127.0, -18.0, 0.0, 0.0, 28.0, 0.0, -98.0, -205.0, 0.0, 103.0, 0.0, 0.0, -19.0, 0.0], "policy_predator_policy_reward": [142.0, 121.0, 63.0, 65.0, 22.0, 98.0, 24.0, 46.0, 36.0, 50.0, 18.0, 6.0, 13.0, 10.0, 13.0, 44.0, 62.0, 49.0, 68.0, 0.0, 78.0, 72.0, 25.0, 57.0, 36.0, 58.0, 14.0, 35.0, 80.0, 5.0, 42.0, 10.0, 83.0, 81.0, 25.0, 18.0, 11.0, 0.0, 43.0, 178.0, 7.0, 0.0, 40.0, 47.0, 35.0, 37.0, 64.0, 110.0, 116.0, 98.0, 89.0, 24.0, 22.0, 121.0, 43.0, 187.0, 17.0, 16.0, 0.0, 25.0, 144.0, 6.0, 62.0, 172.0, 0.0, 0.0, 18.0, 30.0, 48.0, 87.0, 75.0, 85.0, 56.0, 110.0, 124.0, 75.0, 141.0, 125.0, 126.0, 108.0, 33.0, 41.0, 373.0, 109.0, 130.0, 117.0, 139.0, 160.0, 178.0, 84.0, 29.0, 62.0, 127.0, 141.0, 106.0, 174.0, 178.0, 105.0, 115.0, 109.0, 116.0, 157.0, 184.0, 129.0, 0.0, 0.0, 81.0, 111.0, 149.0, 115.0, 32.0, 140.0, 114.0, 149.0, 20.0, 30.0, 10.0, 0.0, 47.0, 35.0, 120.0, 102.0, 149.0, 190.0, 35.0, 68.0, 144.0, 153.0, 115.0, 64.0, 176.0, 139.0, 7.0, 0.0, 155.0, 192.0, 4.0, 6.0, 116.0, 51.0, 0.0, 0.0, 122.0, 137.0, 40.0, 22.0, 165.0, 162.0, 131.0, 97.0, 0.0, 0.0, 136.0, 133.0, 1.0, 0.0, 182.0, 149.0, 0.0, 0.0, 378.0, 71.0, 73.0, 79.0, 63.0, 0.0, 0.0, 29.0, 0.0, 5.0, 58.0, 54.0, 15.0, 21.0, 18.0, 28.0, 75.0, 35.0, 0.0, 4.0, 139.0, 118.0, 151.0, 197.0, 21.0, 10.0, 101.0, 7.0, 0.0, 0.0, 0.0, 0.0, 72.0, 129.0, 8.0, 6.0, 0.0, 0.0, 16.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6575360081523074, "mean_inference_ms": 1.5052814746664924, "mean_action_processing_ms": 0.2605673753367214, "mean_env_wait_ms": 0.2017764583766273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038069486618041992, "StateBufferConnector_ms": 0.003009200096130371, "ViewRequirementAgentConnector_ms": 0.09623122215270996}, "num_episodes": 22, "episode_return_max": 334.0, "episode_return_min": -409.0, "episode_return_mean": -8.61, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.12310235312414, "num_env_steps_trained_throughput_per_sec": 76.12310235312414, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 51317.679, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51317.595, "sample_time_ms": 1167.255, "learn_time_ms": 50128.142, "learn_throughput": 79.795, "synch_weights_time_ms": 17.39}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-06-16", "timestamp": 1723518376, "time_this_iter_s": 52.57429766654968, "time_total_s": 952.8469786643982, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80951f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 952.8469786643982, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.053333333333335, "ram_util_percent": 80.58933333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.105303962394674, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.767956248162285, "policy_loss": -0.008565996016410215, "vf_loss": 3.7749269095678177, "vf_explained_var": 0.026608871341382383, "kl": 0.010635497520087526, "entropy": 1.4017024416772146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.182056657126341, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.23253444616126, "policy_loss": -0.011328407890463948, "vf_loss": 8.240963859406728, "vf_explained_var": 0.20544144668907086, "kl": 0.009663304340869044, "entropy": 1.3781947932546101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -409.0, "episode_reward_mean": -9.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 177.0, "predator_policy": 387.0}, "policy_reward_mean": {"prey_policy": -76.92, "predator_policy": 72.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -213.0, 37.0, -191.0, -409.0, 83.0, 144.0, -91.0, -161.0, 0.0, 64.0, -85.0, -45.0, 5.0, -112.0, -343.0, -284.0, 59.0, -210.0, -134.0, -91.0, 17.0, 70.0, -36.0, -150.0, -115.0, -100.0, 42.0, -69.0, 16.0, -107.0, 29.0, -54.0, -326.0, 103.0, 77.0, 1.0, -271.0, -359.0, 22.0, -160.0, -47.0, -113.0, -7.0, 56.0, 34.0, 89.0, 123.0, -83.0, 173.0, 100.0, -99.0, 22.0, -293.0, 18.0, -65.0, 0.0, -128.0, 184.0, 59.0, -29.0, -5.0, 14.0, 170.0, 157.0, 17.0, 140.0, -29.0, -103.0, 114.0, -37.0, 0.0, 28.0, -102.0, 117.0, 0.0, -3.0, 266.0, -173.0, 112.0, -89.0, 84.0, 294.0, 43.0, -135.0, -86.0, 247.0, 160.0, 77.0, 128.0, 122.0, 119.0, 202.0, 240.0, 108.0, 179.0, 46.0, 115.0, -319.0, 139.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.0, -120.0, -199.0, -228.0, -24.0, -52.0, -167.0, -167.0, -335.0, -304.0, 0.0, 50.0, 0.0, 119.0, 0.0, -241.0, -58.0, -337.0, 0.0, 0.0, 16.0, 0.0, -93.0, -127.0, -205.0, 0.0, 0.0, -161.0, -311.0, 0.0, -258.0, -351.0, -272.0, -246.0, -15.0, 0.0, -546.0, -146.0, -78.0, -303.0, -390.0, 0.0, -325.0, 80.0, -21.0, 0.0, -280.0, -24.0, -86.0, -344.0, -276.0, -122.0, -156.0, -168.0, 101.0, -332.0, 0.0, -382.0, 16.0, 0.0, -299.0, 0.0, 101.0, -336.0, 0.0, -226.0, -341.0, -248.0, -8.0, 61.0, 77.0, -10.0, -10.0, -71.0, -298.0, -195.0, -301.0, -397.0, -81.0, 0.0, -182.0, -275.0, -43.0, -183.0, -232.0, -196.0, -14.0, 0.0, 49.0, -340.0, 0.0, 24.0, 70.0, -148.0, 123.0, 0.0, -155.0, -187.0, 77.0, 34.0, -303.0, 76.0, -242.0, -85.0, 0.0, 22.0, -237.0, -325.0, 17.0, 0.0, -396.0, 0.0, 0.0, 0.0, -31.0, -546.0, 116.0, -84.0, 0.0, -4.0, -58.0, 0.0, 0.0, -10.0, -116.0, 18.0, -35.0, 169.0, 1.0, 110.0, 0.0, -93.0, 136.0, 0.0, -286.0, 0.0, -37.0, -414.0, -2.0, 85.0, -127.0, -18.0, 0.0, 0.0, 28.0, 0.0, -98.0, -205.0, 0.0, 103.0, 0.0, 0.0, -19.0, 0.0, 126.0, 127.0, -158.0, -298.0, -8.0, 90.0, -276.0, -186.0, -2.0, 85.0, 167.0, 122.0, -15.0, -42.0, -534.0, -65.0, -180.0, -34.0, 51.0, 135.0, 148.0, -13.0, -52.0, 46.0, 156.0, -99.0, 2.0, 94.0, 96.0, -77.0, 12.0, 173.0, 58.0, 138.0, 66.0, 0.0, 0.0, 177.0, -18.0, 0.0, 68.0, 0.0, -218.0, -358.0, -65.0, 128.0], "policy_predator_policy_reward": [64.0, 110.0, 116.0, 98.0, 89.0, 24.0, 22.0, 121.0, 43.0, 187.0, 17.0, 16.0, 0.0, 25.0, 144.0, 6.0, 62.0, 172.0, 0.0, 0.0, 18.0, 30.0, 48.0, 87.0, 75.0, 85.0, 56.0, 110.0, 124.0, 75.0, 141.0, 125.0, 126.0, 108.0, 33.0, 41.0, 373.0, 109.0, 130.0, 117.0, 139.0, 160.0, 178.0, 84.0, 29.0, 62.0, 127.0, 141.0, 106.0, 174.0, 178.0, 105.0, 115.0, 109.0, 116.0, 157.0, 184.0, 129.0, 0.0, 0.0, 81.0, 111.0, 149.0, 115.0, 32.0, 140.0, 114.0, 149.0, 20.0, 30.0, 10.0, 0.0, 47.0, 35.0, 120.0, 102.0, 149.0, 190.0, 35.0, 68.0, 144.0, 153.0, 115.0, 64.0, 176.0, 139.0, 7.0, 0.0, 155.0, 192.0, 4.0, 6.0, 116.0, 51.0, 0.0, 0.0, 122.0, 137.0, 40.0, 22.0, 165.0, 162.0, 131.0, 97.0, 0.0, 0.0, 136.0, 133.0, 1.0, 0.0, 182.0, 149.0, 0.0, 0.0, 378.0, 71.0, 73.0, 79.0, 63.0, 0.0, 0.0, 29.0, 0.0, 5.0, 58.0, 54.0, 15.0, 21.0, 18.0, 28.0, 75.0, 35.0, 0.0, 4.0, 139.0, 118.0, 151.0, 197.0, 21.0, 10.0, 101.0, 7.0, 0.0, 0.0, 0.0, 0.0, 72.0, 129.0, 8.0, 6.0, 0.0, 0.0, 16.0, 0.0, 13.0, 0.0, 52.0, 231.0, 0.0, 30.0, 123.0, 250.0, 0.0, 1.0, 5.0, 0.0, 35.0, 65.0, 77.0, 387.0, 128.0, 0.0, 36.0, 25.0, 18.0, 7.0, 0.0, 83.0, 29.0, 42.0, 26.0, 0.0, 29.0, 71.0, 0.0, 17.0, 39.0, 5.0, 19.0, 23.0, 2.0, 0.0, 63.0, 1.0, 39.0, 8.0, 0.0, 257.0, 75.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6576567655006741, "mean_inference_ms": 1.5030447841476648, "mean_action_processing_ms": 0.26006051700251764, "mean_env_wait_ms": 0.20198945857549724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005880951881408691, "StateBufferConnector_ms": 0.003375411033630371, "ViewRequirementAgentConnector_ms": 0.1120445728302002}, "num_episodes": 23, "episode_return_max": 294.0, "episode_return_min": -409.0, "episode_return_mean": -9.75, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.70513694070299, "num_env_steps_trained_throughput_per_sec": 69.70513694070299, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 51865.094, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51865.006, "sample_time_ms": 1150.274, "learn_time_ms": 50692.85, "learn_throughput": 78.907, "synch_weights_time_ms": 17.222}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-07-13", "timestamp": 1723518433, "time_this_iter_s": 57.42798686027527, "time_total_s": 1010.2749655246735, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1010.2749655246735, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.301219512195125, "ram_util_percent": 82.1841463414634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.202224725074869, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.265245057413818, "policy_loss": -0.008860206715614787, "vf_loss": 3.272245628240878, "vf_explained_var": 0.05347048592945886, "kl": 0.012397636108201994, "entropy": 1.4095447697336712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.608210191020259, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.714351246344349, "policy_loss": -0.014443898388669978, "vf_loss": 6.725506840307246, "vf_explained_var": 0.39521180621530644, "kl": 0.010960964762680159, "entropy": 1.4094454284698243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -359.0, "episode_reward_mean": 23.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.0, "predator_policy": 387.0}, "policy_reward_mean": {"prey_policy": -53.725, "predator_policy": 65.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.0, -134.0, -91.0, 17.0, 70.0, -36.0, -150.0, -115.0, -100.0, 42.0, -69.0, 16.0, -107.0, 29.0, -54.0, -326.0, 103.0, 77.0, 1.0, -271.0, -359.0, 22.0, -160.0, -47.0, -113.0, -7.0, 56.0, 34.0, 89.0, 123.0, -83.0, 173.0, 100.0, -99.0, 22.0, -293.0, 18.0, -65.0, 0.0, -128.0, 184.0, 59.0, -29.0, -5.0, 14.0, 170.0, 157.0, 17.0, 140.0, -29.0, -103.0, 114.0, -37.0, 0.0, 28.0, -102.0, 117.0, 0.0, -3.0, 266.0, -173.0, 112.0, -89.0, 84.0, 294.0, 43.0, -135.0, -86.0, 247.0, 160.0, 77.0, 128.0, 122.0, 119.0, 202.0, 240.0, 108.0, 179.0, 46.0, 115.0, -319.0, 139.0, 181.0, 71.0, 23.0, 0.0, 182.0, 125.0, 288.0, 55.0, 156.0, 95.0, 118.0, 50.0, 106.0, 232.0, -103.0, -19.0, 172.0, 119.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-546.0, -146.0, -78.0, -303.0, -390.0, 0.0, -325.0, 80.0, -21.0, 0.0, -280.0, -24.0, -86.0, -344.0, -276.0, -122.0, -156.0, -168.0, 101.0, -332.0, 0.0, -382.0, 16.0, 0.0, -299.0, 0.0, 101.0, -336.0, 0.0, -226.0, -341.0, -248.0, -8.0, 61.0, 77.0, -10.0, -10.0, -71.0, -298.0, -195.0, -301.0, -397.0, -81.0, 0.0, -182.0, -275.0, -43.0, -183.0, -232.0, -196.0, -14.0, 0.0, 49.0, -340.0, 0.0, 24.0, 70.0, -148.0, 123.0, 0.0, -155.0, -187.0, 77.0, 34.0, -303.0, 76.0, -242.0, -85.0, 0.0, 22.0, -237.0, -325.0, 17.0, 0.0, -396.0, 0.0, 0.0, 0.0, -31.0, -546.0, 116.0, -84.0, 0.0, -4.0, -58.0, 0.0, 0.0, -10.0, -116.0, 18.0, -35.0, 169.0, 1.0, 110.0, 0.0, -93.0, 136.0, 0.0, -286.0, 0.0, -37.0, -414.0, -2.0, 85.0, -127.0, -18.0, 0.0, 0.0, 28.0, 0.0, -98.0, -205.0, 0.0, 103.0, 0.0, 0.0, -19.0, 0.0, 126.0, 127.0, -158.0, -298.0, -8.0, 90.0, -276.0, -186.0, -2.0, 85.0, 167.0, 122.0, -15.0, -42.0, -534.0, -65.0, -180.0, -34.0, 51.0, 135.0, 148.0, -13.0, -52.0, 46.0, 156.0, -99.0, 2.0, 94.0, 96.0, -77.0, 12.0, 173.0, 58.0, 138.0, 66.0, 0.0, 0.0, 177.0, -18.0, 0.0, 68.0, 0.0, -218.0, -358.0, -65.0, 128.0, 0.0, 181.0, 0.0, 37.0, -10.0, -73.0, 0.0, 0.0, 82.0, 18.0, 51.0, 7.0, 167.0, 99.0, 0.0, -12.0, 52.0, 56.0, 0.0, 53.0, -27.0, 56.0, -20.0, 0.0, 157.0, -114.0, 94.0, 94.0, -78.0, -408.0, -55.0, -117.0, 0.0, 170.0, -76.0, 136.0], "policy_predator_policy_reward": [373.0, 109.0, 130.0, 117.0, 139.0, 160.0, 178.0, 84.0, 29.0, 62.0, 127.0, 141.0, 106.0, 174.0, 178.0, 105.0, 115.0, 109.0, 116.0, 157.0, 184.0, 129.0, 0.0, 0.0, 81.0, 111.0, 149.0, 115.0, 32.0, 140.0, 114.0, 149.0, 20.0, 30.0, 10.0, 0.0, 47.0, 35.0, 120.0, 102.0, 149.0, 190.0, 35.0, 68.0, 144.0, 153.0, 115.0, 64.0, 176.0, 139.0, 7.0, 0.0, 155.0, 192.0, 4.0, 6.0, 116.0, 51.0, 0.0, 0.0, 122.0, 137.0, 40.0, 22.0, 165.0, 162.0, 131.0, 97.0, 0.0, 0.0, 136.0, 133.0, 1.0, 0.0, 182.0, 149.0, 0.0, 0.0, 378.0, 71.0, 73.0, 79.0, 63.0, 0.0, 0.0, 29.0, 0.0, 5.0, 58.0, 54.0, 15.0, 21.0, 18.0, 28.0, 75.0, 35.0, 0.0, 4.0, 139.0, 118.0, 151.0, 197.0, 21.0, 10.0, 101.0, 7.0, 0.0, 0.0, 0.0, 0.0, 72.0, 129.0, 8.0, 6.0, 0.0, 0.0, 16.0, 0.0, 13.0, 0.0, 52.0, 231.0, 0.0, 30.0, 123.0, 250.0, 0.0, 1.0, 5.0, 0.0, 35.0, 65.0, 77.0, 387.0, 128.0, 0.0, 36.0, 25.0, 18.0, 7.0, 0.0, 83.0, 29.0, 42.0, 26.0, 0.0, 29.0, 71.0, 0.0, 17.0, 39.0, 5.0, 19.0, 23.0, 2.0, 0.0, 63.0, 1.0, 39.0, 8.0, 0.0, 257.0, 75.0, 1.0, 0.0, 0.0, 11.0, 23.0, 46.0, 60.0, 0.0, 0.0, 33.0, 49.0, 64.0, 3.0, 22.0, 0.0, 7.0, 60.0, 11.0, 37.0, 42.0, 0.0, 21.0, 68.0, 51.0, 19.0, 57.0, 6.0, 10.0, 34.0, 299.0, 84.0, 90.0, 63.0, 2.0, 0.0, 21.0, 38.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.658315972166529, "mean_inference_ms": 1.5031586386751838, "mean_action_processing_ms": 0.25979623227072407, "mean_env_wait_ms": 0.202274334129524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006326079368591309, "StateBufferConnector_ms": 0.0033822059631347656, "ViewRequirementAgentConnector_ms": 0.11670982837677002}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -359.0, "episode_return_mean": 23.97, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.55199443057859, "num_env_steps_trained_throughput_per_sec": 65.55199443057859, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 52975.863, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52975.767, "sample_time_ms": 1162.567, "learn_time_ms": 51789.862, "learn_throughput": 77.235, "synch_weights_time_ms": 18.178}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-08-14", "timestamp": 1723518494, "time_this_iter_s": 61.07049798965454, "time_total_s": 1071.345463514328, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1071.345463514328, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 51.31395348837209, "ram_util_percent": 82.68488372093023}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.983824456368804, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.352144213832875, "policy_loss": -0.02215933525434661, "vf_loss": 5.371467507074749, "vf_explained_var": 0.08144604872774194, "kl": 0.018906904652716824, "entropy": 1.4121554459844317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.050336611050146, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.544208624249413, "policy_loss": -0.015690701689063596, "vf_loss": 7.556448445244441, "vf_explained_var": 0.07221147802771714, "kl": 0.011502920347242263, "entropy": 1.362908579874291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -359.0, "episode_reward_mean": 54.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 387.0}, "policy_reward_mean": {"prey_policy": -25.78, "predator_policy": 53.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, -271.0, -359.0, 22.0, -160.0, -47.0, -113.0, -7.0, 56.0, 34.0, 89.0, 123.0, -83.0, 173.0, 100.0, -99.0, 22.0, -293.0, 18.0, -65.0, 0.0, -128.0, 184.0, 59.0, -29.0, -5.0, 14.0, 170.0, 157.0, 17.0, 140.0, -29.0, -103.0, 114.0, -37.0, 0.0, 28.0, -102.0, 117.0, 0.0, -3.0, 266.0, -173.0, 112.0, -89.0, 84.0, 294.0, 43.0, -135.0, -86.0, 247.0, 160.0, 77.0, 128.0, 122.0, 119.0, 202.0, 240.0, 108.0, 179.0, 46.0, 115.0, -319.0, 139.0, 181.0, 71.0, 23.0, 0.0, 182.0, 125.0, 288.0, 55.0, 156.0, 95.0, 118.0, 50.0, 106.0, 232.0, -103.0, -19.0, 172.0, 119.0, 157.0, 377.0, 104.0, -156.0, 26.0, 205.0, 50.0, -2.0, 169.0, 187.0, 180.0, 0.0, 29.0, 124.0, 349.0, 97.0, 82.0, 64.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -71.0, -298.0, -195.0, -301.0, -397.0, -81.0, 0.0, -182.0, -275.0, -43.0, -183.0, -232.0, -196.0, -14.0, 0.0, 49.0, -340.0, 0.0, 24.0, 70.0, -148.0, 123.0, 0.0, -155.0, -187.0, 77.0, 34.0, -303.0, 76.0, -242.0, -85.0, 0.0, 22.0, -237.0, -325.0, 17.0, 0.0, -396.0, 0.0, 0.0, 0.0, -31.0, -546.0, 116.0, -84.0, 0.0, -4.0, -58.0, 0.0, 0.0, -10.0, -116.0, 18.0, -35.0, 169.0, 1.0, 110.0, 0.0, -93.0, 136.0, 0.0, -286.0, 0.0, -37.0, -414.0, -2.0, 85.0, -127.0, -18.0, 0.0, 0.0, 28.0, 0.0, -98.0, -205.0, 0.0, 103.0, 0.0, 0.0, -19.0, 0.0, 126.0, 127.0, -158.0, -298.0, -8.0, 90.0, -276.0, -186.0, -2.0, 85.0, 167.0, 122.0, -15.0, -42.0, -534.0, -65.0, -180.0, -34.0, 51.0, 135.0, 148.0, -13.0, -52.0, 46.0, 156.0, -99.0, 2.0, 94.0, 96.0, -77.0, 12.0, 173.0, 58.0, 138.0, 66.0, 0.0, 0.0, 177.0, -18.0, 0.0, 68.0, 0.0, -218.0, -358.0, -65.0, 128.0, 0.0, 181.0, 0.0, 37.0, -10.0, -73.0, 0.0, 0.0, 82.0, 18.0, 51.0, 7.0, 167.0, 99.0, 0.0, -12.0, 52.0, 56.0, 0.0, 53.0, -27.0, 56.0, -20.0, 0.0, 157.0, -114.0, 94.0, 94.0, -78.0, -408.0, -55.0, -117.0, 0.0, 170.0, -76.0, 136.0, 134.0, 0.0, 181.0, 196.0, 11.0, -13.0, -120.0, -308.0, -57.0, 0.0, 96.0, 41.0, -11.0, -90.0, -45.0, -58.0, 162.0, 0.0, -1.0, 119.0, 75.0, 50.0, 13.0, -190.0, 3.0, -54.0, 46.0, -14.0, 176.0, 172.0, 0.0, 55.0, -41.0, 41.0, 0.0, 9.0], "policy_predator_policy_reward": [47.0, 35.0, 120.0, 102.0, 149.0, 190.0, 35.0, 68.0, 144.0, 153.0, 115.0, 64.0, 176.0, 139.0, 7.0, 0.0, 155.0, 192.0, 4.0, 6.0, 116.0, 51.0, 0.0, 0.0, 122.0, 137.0, 40.0, 22.0, 165.0, 162.0, 131.0, 97.0, 0.0, 0.0, 136.0, 133.0, 1.0, 0.0, 182.0, 149.0, 0.0, 0.0, 378.0, 71.0, 73.0, 79.0, 63.0, 0.0, 0.0, 29.0, 0.0, 5.0, 58.0, 54.0, 15.0, 21.0, 18.0, 28.0, 75.0, 35.0, 0.0, 4.0, 139.0, 118.0, 151.0, 197.0, 21.0, 10.0, 101.0, 7.0, 0.0, 0.0, 0.0, 0.0, 72.0, 129.0, 8.0, 6.0, 0.0, 0.0, 16.0, 0.0, 13.0, 0.0, 52.0, 231.0, 0.0, 30.0, 123.0, 250.0, 0.0, 1.0, 5.0, 0.0, 35.0, 65.0, 77.0, 387.0, 128.0, 0.0, 36.0, 25.0, 18.0, 7.0, 0.0, 83.0, 29.0, 42.0, 26.0, 0.0, 29.0, 71.0, 0.0, 17.0, 39.0, 5.0, 19.0, 23.0, 2.0, 0.0, 63.0, 1.0, 39.0, 8.0, 0.0, 257.0, 75.0, 1.0, 0.0, 0.0, 11.0, 23.0, 46.0, 60.0, 0.0, 0.0, 33.0, 49.0, 64.0, 3.0, 22.0, 0.0, 7.0, 60.0, 11.0, 37.0, 42.0, 0.0, 21.0, 68.0, 51.0, 19.0, 57.0, 6.0, 10.0, 34.0, 299.0, 84.0, 90.0, 63.0, 2.0, 0.0, 21.0, 38.0, 15.0, 8.0, 0.0, 0.0, 32.0, 74.0, 155.0, 117.0, 55.0, 28.0, 27.0, 41.0, 86.0, 65.0, 2.0, 99.0, 0.0, 7.0, 69.0, 0.0, 0.0, 55.0, 84.0, 93.0, 17.0, 63.0, 52.0, 40.0, 1.0, 0.0, 42.0, 0.0, 15.0, 67.0, 20.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6565442919251684, "mean_inference_ms": 1.4973087614517318, "mean_action_processing_ms": 0.25874804721823336, "mean_env_wait_ms": 0.20136860190688524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006318569183349609, "StateBufferConnector_ms": 0.003412961959838867, "ViewRequirementAgentConnector_ms": 0.12164700031280518}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": -359.0, "episode_return_mean": 54.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.89868265950854, "num_env_steps_trained_throughput_per_sec": 72.89868265950854, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 53361.377, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53361.281, "sample_time_ms": 1192.16, "learn_time_ms": 52146.529, "learn_throughput": 76.707, "synch_weights_time_ms": 17.66}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-09-09", "timestamp": 1723518549, "time_this_iter_s": 54.921770095825195, "time_total_s": 1126.2672336101532, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80955e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1126.2672336101532, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 40.9493670886076, "ram_util_percent": 80.61772151898734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.424958392299672, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.32225393542537, "policy_loss": -0.016648416378210105, "vf_loss": 6.336566688648607, "vf_explained_var": 0.08636467078375439, "kl": 0.015571099783649097, "entropy": 1.3998381089281153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.0064303651688595, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.181783327476058, "policy_loss": -0.015608489077301725, "vf_loss": 8.19392529189902, "vf_explained_var": 0.1434898618037108, "kl": 0.011555076157287255, "entropy": 1.3444206371509209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -319.0, "episode_reward_mean": 82.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 387.0}, "policy_reward_mean": {"prey_policy": -4.515, "predator_policy": 45.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, -65.0, 0.0, -128.0, 184.0, 59.0, -29.0, -5.0, 14.0, 170.0, 157.0, 17.0, 140.0, -29.0, -103.0, 114.0, -37.0, 0.0, 28.0, -102.0, 117.0, 0.0, -3.0, 266.0, -173.0, 112.0, -89.0, 84.0, 294.0, 43.0, -135.0, -86.0, 247.0, 160.0, 77.0, 128.0, 122.0, 119.0, 202.0, 240.0, 108.0, 179.0, 46.0, 115.0, -319.0, 139.0, 181.0, 71.0, 23.0, 0.0, 182.0, 125.0, 288.0, 55.0, 156.0, 95.0, 118.0, 50.0, 106.0, 232.0, -103.0, -19.0, 172.0, 119.0, 157.0, 377.0, 104.0, -156.0, 26.0, 205.0, 50.0, -2.0, 169.0, 187.0, 180.0, 0.0, 29.0, 124.0, 349.0, 97.0, 82.0, 64.0, -10.0, 174.0, 87.0, 230.0, 60.0, 84.0, 26.0, 17.0, 102.0, -30.0, 151.0, 247.0, 147.0, 151.0, 48.0, 317.0, 166.0, -50.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.0, 0.0, -396.0, 0.0, 0.0, 0.0, -31.0, -546.0, 116.0, -84.0, 0.0, -4.0, -58.0, 0.0, 0.0, -10.0, -116.0, 18.0, -35.0, 169.0, 1.0, 110.0, 0.0, -93.0, 136.0, 0.0, -286.0, 0.0, -37.0, -414.0, -2.0, 85.0, -127.0, -18.0, 0.0, 0.0, 28.0, 0.0, -98.0, -205.0, 0.0, 103.0, 0.0, 0.0, -19.0, 0.0, 126.0, 127.0, -158.0, -298.0, -8.0, 90.0, -276.0, -186.0, -2.0, 85.0, 167.0, 122.0, -15.0, -42.0, -534.0, -65.0, -180.0, -34.0, 51.0, 135.0, 148.0, -13.0, -52.0, 46.0, 156.0, -99.0, 2.0, 94.0, 96.0, -77.0, 12.0, 173.0, 58.0, 138.0, 66.0, 0.0, 0.0, 177.0, -18.0, 0.0, 68.0, 0.0, -218.0, -358.0, -65.0, 128.0, 0.0, 181.0, 0.0, 37.0, -10.0, -73.0, 0.0, 0.0, 82.0, 18.0, 51.0, 7.0, 167.0, 99.0, 0.0, -12.0, 52.0, 56.0, 0.0, 53.0, -27.0, 56.0, -20.0, 0.0, 157.0, -114.0, 94.0, 94.0, -78.0, -408.0, -55.0, -117.0, 0.0, 170.0, -76.0, 136.0, 134.0, 0.0, 181.0, 196.0, 11.0, -13.0, -120.0, -308.0, -57.0, 0.0, 96.0, 41.0, -11.0, -90.0, -45.0, -58.0, 162.0, 0.0, -1.0, 119.0, 75.0, 50.0, 13.0, -190.0, 3.0, -54.0, 46.0, -14.0, 176.0, 172.0, 0.0, 55.0, -41.0, 41.0, 0.0, 9.0, 0.0, -20.0, 80.0, 52.0, 28.0, 0.0, 82.0, 115.0, -27.0, -28.0, -25.0, -12.0, -196.0, 72.0, -36.0, -110.0, 25.0, -86.0, -68.0, -103.0, 24.0, 15.0, 121.0, 76.0, 128.0, 0.0, 42.0, 27.0, 35.0, -102.0, 147.0, 151.0, 49.0, 32.0, -92.0, -168.0], "policy_predator_policy_reward": [1.0, 0.0, 182.0, 149.0, 0.0, 0.0, 378.0, 71.0, 73.0, 79.0, 63.0, 0.0, 0.0, 29.0, 0.0, 5.0, 58.0, 54.0, 15.0, 21.0, 18.0, 28.0, 75.0, 35.0, 0.0, 4.0, 139.0, 118.0, 151.0, 197.0, 21.0, 10.0, 101.0, 7.0, 0.0, 0.0, 0.0, 0.0, 72.0, 129.0, 8.0, 6.0, 0.0, 0.0, 16.0, 0.0, 13.0, 0.0, 52.0, 231.0, 0.0, 30.0, 123.0, 250.0, 0.0, 1.0, 5.0, 0.0, 35.0, 65.0, 77.0, 387.0, 128.0, 0.0, 36.0, 25.0, 18.0, 7.0, 0.0, 83.0, 29.0, 42.0, 26.0, 0.0, 29.0, 71.0, 0.0, 17.0, 39.0, 5.0, 19.0, 23.0, 2.0, 0.0, 63.0, 1.0, 39.0, 8.0, 0.0, 257.0, 75.0, 1.0, 0.0, 0.0, 11.0, 23.0, 46.0, 60.0, 0.0, 0.0, 33.0, 49.0, 64.0, 3.0, 22.0, 0.0, 7.0, 60.0, 11.0, 37.0, 42.0, 0.0, 21.0, 68.0, 51.0, 19.0, 57.0, 6.0, 10.0, 34.0, 299.0, 84.0, 90.0, 63.0, 2.0, 0.0, 21.0, 38.0, 15.0, 8.0, 0.0, 0.0, 32.0, 74.0, 155.0, 117.0, 55.0, 28.0, 27.0, 41.0, 86.0, 65.0, 2.0, 99.0, 0.0, 7.0, 69.0, 0.0, 0.0, 55.0, 84.0, 93.0, 17.0, 63.0, 52.0, 40.0, 1.0, 0.0, 42.0, 0.0, 15.0, 67.0, 20.0, 35.0, 10.0, 0.0, 2.0, 40.0, 35.0, 24.0, 33.0, 0.0, 51.0, 64.0, 84.0, 37.0, 38.0, 112.0, 58.0, 105.0, 74.0, 89.0, 106.0, 35.0, 85.0, 27.0, 50.0, 0.0, 3.0, 16.0, 34.0, 48.0, 62.0, 53.0, 0.0, 19.0, 40.0, 45.0, 106.0, 104.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6557486843925285, "mean_inference_ms": 1.4933672403997087, "mean_action_processing_ms": 0.25805272647711, "mean_env_wait_ms": 0.20076487568208592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062181949615478516, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.12438070774078369}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": -319.0, "episode_return_mean": 82.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.44627694797535, "num_env_steps_trained_throughput_per_sec": 75.44627694797535, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 53808.379, "restore_workers_time_ms": 0.015, "training_step_time_ms": 53808.282, "sample_time_ms": 1209.641, "learn_time_ms": 52574.747, "learn_throughput": 76.082, "synch_weights_time_ms": 17.744}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-10-02", "timestamp": 1723518602, "time_this_iter_s": 53.04102611541748, "time_total_s": 1179.3082597255707, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8031ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1179.3082597255707, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.096, "ram_util_percent": 81.63866666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.5415990952461485, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.060711272305282, "policy_loss": -0.01970288135461194, "vf_loss": 6.077265198016293, "vf_explained_var": 0.12532832436460667, "kl": 0.02099301669136901, "entropy": 1.3648369480062414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.908691656431824, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.04062720152436, "policy_loss": -0.010722823895356327, "vf_loss": 8.049228743144445, "vf_explained_var": -0.11566597696334596, "kl": 0.007071006814353187, "entropy": 1.3542421731999312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -366.0, "episode_reward_mean": 80.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -534.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 387.0}, "policy_reward_mean": {"prey_policy": -4.91, "predator_policy": 45.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 294.0, 43.0, -135.0, -86.0, 247.0, 160.0, 77.0, 128.0, 122.0, 119.0, 202.0, 240.0, 108.0, 179.0, 46.0, 115.0, -319.0, 139.0, 181.0, 71.0, 23.0, 0.0, 182.0, 125.0, 288.0, 55.0, 156.0, 95.0, 118.0, 50.0, 106.0, 232.0, -103.0, -19.0, 172.0, 119.0, 157.0, 377.0, 104.0, -156.0, 26.0, 205.0, 50.0, -2.0, 169.0, 187.0, 180.0, 0.0, 29.0, 124.0, 349.0, 97.0, 82.0, 64.0, -10.0, 174.0, 87.0, 230.0, 60.0, 84.0, 26.0, 17.0, 102.0, -30.0, 151.0, 247.0, 147.0, 151.0, 48.0, 317.0, 166.0, -50.0, -2.0, -126.0, -9.0, 222.0, 61.0, -157.0, 78.0, 18.0, 55.0, 50.0, -191.0, -35.0, 63.0, 260.0, 77.0, 49.0, -76.0, -366.0, 58.0, 121.0, 106.0, 24.0, 1.0, 130.0, -9.0, 40.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 85.0, 167.0, 122.0, -15.0, -42.0, -534.0, -65.0, -180.0, -34.0, 51.0, 135.0, 148.0, -13.0, -52.0, 46.0, 156.0, -99.0, 2.0, 94.0, 96.0, -77.0, 12.0, 173.0, 58.0, 138.0, 66.0, 0.0, 0.0, 177.0, -18.0, 0.0, 68.0, 0.0, -218.0, -358.0, -65.0, 128.0, 0.0, 181.0, 0.0, 37.0, -10.0, -73.0, 0.0, 0.0, 82.0, 18.0, 51.0, 7.0, 167.0, 99.0, 0.0, -12.0, 52.0, 56.0, 0.0, 53.0, -27.0, 56.0, -20.0, 0.0, 157.0, -114.0, 94.0, 94.0, -78.0, -408.0, -55.0, -117.0, 0.0, 170.0, -76.0, 136.0, 134.0, 0.0, 181.0, 196.0, 11.0, -13.0, -120.0, -308.0, -57.0, 0.0, 96.0, 41.0, -11.0, -90.0, -45.0, -58.0, 162.0, 0.0, -1.0, 119.0, 75.0, 50.0, 13.0, -190.0, 3.0, -54.0, 46.0, -14.0, 176.0, 172.0, 0.0, 55.0, -41.0, 41.0, 0.0, 9.0, 0.0, -20.0, 80.0, 52.0, 28.0, 0.0, 82.0, 115.0, -27.0, -28.0, -25.0, -12.0, -196.0, 72.0, -36.0, -110.0, 25.0, -86.0, -68.0, -103.0, 24.0, 15.0, 121.0, 76.0, 128.0, 0.0, 42.0, 27.0, 35.0, -102.0, 147.0, 151.0, 49.0, 32.0, -92.0, -168.0, -27.0, -120.0, -164.0, -106.0, -56.0, -66.0, 65.0, 103.0, -28.0, -6.0, -147.0, -192.0, 0.0, 11.0, -43.0, -57.0, -65.0, 27.0, 14.0, -73.0, -141.0, -236.0, -112.0, -58.0, -11.0, 0.0, 74.0, 186.0, 42.0, 0.0, 31.0, -142.0, -178.0, -55.0, -282.0, -337.0, -40.0, 27.0, 109.0, 0.0, -34.0, 41.0, -93.0, 0.0, -73.0, -4.0, 36.0, 27.0, -111.0, -27.0, -58.0, 11.0, -120.0, 0.0], "policy_predator_policy_reward": [0.0, 1.0, 5.0, 0.0, 35.0, 65.0, 77.0, 387.0, 128.0, 0.0, 36.0, 25.0, 18.0, 7.0, 0.0, 83.0, 29.0, 42.0, 26.0, 0.0, 29.0, 71.0, 0.0, 17.0, 39.0, 5.0, 19.0, 23.0, 2.0, 0.0, 63.0, 1.0, 39.0, 8.0, 0.0, 257.0, 75.0, 1.0, 0.0, 0.0, 11.0, 23.0, 46.0, 60.0, 0.0, 0.0, 33.0, 49.0, 64.0, 3.0, 22.0, 0.0, 7.0, 60.0, 11.0, 37.0, 42.0, 0.0, 21.0, 68.0, 51.0, 19.0, 57.0, 6.0, 10.0, 34.0, 299.0, 84.0, 90.0, 63.0, 2.0, 0.0, 21.0, 38.0, 15.0, 8.0, 0.0, 0.0, 32.0, 74.0, 155.0, 117.0, 55.0, 28.0, 27.0, 41.0, 86.0, 65.0, 2.0, 99.0, 0.0, 7.0, 69.0, 0.0, 0.0, 55.0, 84.0, 93.0, 17.0, 63.0, 52.0, 40.0, 1.0, 0.0, 42.0, 0.0, 15.0, 67.0, 20.0, 35.0, 10.0, 0.0, 2.0, 40.0, 35.0, 24.0, 33.0, 0.0, 51.0, 64.0, 84.0, 37.0, 38.0, 112.0, 58.0, 105.0, 74.0, 89.0, 106.0, 35.0, 85.0, 27.0, 50.0, 0.0, 3.0, 16.0, 34.0, 48.0, 62.0, 53.0, 0.0, 19.0, 40.0, 45.0, 106.0, 104.0, 106.0, 39.0, 56.0, 88.0, 13.0, 100.0, 54.0, 0.0, 0.0, 95.0, 114.0, 68.0, 31.0, 36.0, 72.0, 46.0, 93.0, 0.0, 15.0, 94.0, 85.0, 101.0, 37.0, 98.0, 29.0, 45.0, 0.0, 0.0, 35.0, 0.0, 74.0, 86.0, 69.0, 88.0, 79.0, 174.0, 43.0, 28.0, 0.0, 12.0, 70.0, 29.0, 29.0, 88.0, 2.0, 76.0, 5.0, 62.0, 53.0, 76.0, 58.0, 29.0, 29.0, 96.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6579244610334615, "mean_inference_ms": 1.4940997413628727, "mean_action_processing_ms": 0.2578296727122639, "mean_env_wait_ms": 0.20104782500997245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007928133010864258, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 0.14060735702514648}, "num_episodes": 27, "episode_return_max": 377.0, "episode_return_min": -366.0, "episode_return_mean": 80.2, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.63779053865409, "num_env_steps_trained_throughput_per_sec": 72.63779053865409, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 54347.951, "restore_workers_time_ms": 0.015, "training_step_time_ms": 54347.855, "sample_time_ms": 1240.211, "learn_time_ms": 53084.393, "learn_throughput": 75.352, "synch_weights_time_ms": 17.503}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-10-58", "timestamp": 1723518658, "time_this_iter_s": 55.116649866104126, "time_total_s": 1234.4249095916748, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8095d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1234.4249095916748, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 42.49999999999999, "ram_util_percent": 82.66538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.768409244724052, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.212240405814358, "policy_loss": -0.01308899917048476, "vf_loss": 8.222949520999162, "vf_explained_var": 0.0792287272120279, "kl": 0.010577275884007096, "entropy": 1.347210450336416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4835010354796414, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.197378260244137, "policy_loss": -0.009090788569054984, "vf_loss": 7.2044015157790415, "vf_explained_var": -0.4133683130854652, "kl": 0.0068917764322625474, "entropy": 1.3879403060075468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -366.0, "episode_reward_mean": 42.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -408.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 299.0}, "policy_reward_mean": {"prey_policy": -31.95, "predator_policy": 53.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.0, 181.0, 71.0, 23.0, 0.0, 182.0, 125.0, 288.0, 55.0, 156.0, 95.0, 118.0, 50.0, 106.0, 232.0, -103.0, -19.0, 172.0, 119.0, 157.0, 377.0, 104.0, -156.0, 26.0, 205.0, 50.0, -2.0, 169.0, 187.0, 180.0, 0.0, 29.0, 124.0, 349.0, 97.0, 82.0, 64.0, -10.0, 174.0, 87.0, 230.0, 60.0, 84.0, 26.0, 17.0, 102.0, -30.0, 151.0, 247.0, 147.0, 151.0, 48.0, 317.0, 166.0, -50.0, -2.0, -126.0, -9.0, 222.0, 61.0, -157.0, 78.0, 18.0, 55.0, 50.0, -191.0, -35.0, 63.0, 260.0, 77.0, 49.0, -76.0, -366.0, 58.0, 121.0, 106.0, 24.0, 1.0, 130.0, -9.0, 40.0, 5.0, -87.0, -224.0, -122.0, -168.0, -333.0, -76.0, -173.0, 7.0, -77.0, -50.0, -61.0, -58.0, -219.0, -149.0, -95.0, -51.0, -106.0, -85.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-65.0, 128.0, 0.0, 181.0, 0.0, 37.0, -10.0, -73.0, 0.0, 0.0, 82.0, 18.0, 51.0, 7.0, 167.0, 99.0, 0.0, -12.0, 52.0, 56.0, 0.0, 53.0, -27.0, 56.0, -20.0, 0.0, 157.0, -114.0, 94.0, 94.0, -78.0, -408.0, -55.0, -117.0, 0.0, 170.0, -76.0, 136.0, 134.0, 0.0, 181.0, 196.0, 11.0, -13.0, -120.0, -308.0, -57.0, 0.0, 96.0, 41.0, -11.0, -90.0, -45.0, -58.0, 162.0, 0.0, -1.0, 119.0, 75.0, 50.0, 13.0, -190.0, 3.0, -54.0, 46.0, -14.0, 176.0, 172.0, 0.0, 55.0, -41.0, 41.0, 0.0, 9.0, 0.0, -20.0, 80.0, 52.0, 28.0, 0.0, 82.0, 115.0, -27.0, -28.0, -25.0, -12.0, -196.0, 72.0, -36.0, -110.0, 25.0, -86.0, -68.0, -103.0, 24.0, 15.0, 121.0, 76.0, 128.0, 0.0, 42.0, 27.0, 35.0, -102.0, 147.0, 151.0, 49.0, 32.0, -92.0, -168.0, -27.0, -120.0, -164.0, -106.0, -56.0, -66.0, 65.0, 103.0, -28.0, -6.0, -147.0, -192.0, 0.0, 11.0, -43.0, -57.0, -65.0, 27.0, 14.0, -73.0, -141.0, -236.0, -112.0, -58.0, -11.0, 0.0, 74.0, 186.0, 42.0, 0.0, 31.0, -142.0, -178.0, -55.0, -282.0, -337.0, -40.0, 27.0, 109.0, 0.0, -34.0, 41.0, -93.0, 0.0, -73.0, -4.0, 36.0, 27.0, -111.0, -27.0, -58.0, 11.0, -120.0, 0.0, 0.0, -232.0, -308.0, -161.0, -248.0, -30.0, -125.0, -238.0, -298.0, -307.0, -227.0, 0.0, -169.0, -194.0, -54.0, -74.0, -75.0, -101.0, 0.0, -161.0, -18.0, -86.0, 0.0, -377.0, -226.0, -229.0, -266.0, -129.0, -250.0, 0.0, -262.0, 0.0, -208.0, -65.0, -93.0, -110.0], "policy_predator_policy_reward": [75.0, 1.0, 0.0, 0.0, 11.0, 23.0, 46.0, 60.0, 0.0, 0.0, 33.0, 49.0, 64.0, 3.0, 22.0, 0.0, 7.0, 60.0, 11.0, 37.0, 42.0, 0.0, 21.0, 68.0, 51.0, 19.0, 57.0, 6.0, 10.0, 34.0, 299.0, 84.0, 90.0, 63.0, 2.0, 0.0, 21.0, 38.0, 15.0, 8.0, 0.0, 0.0, 32.0, 74.0, 155.0, 117.0, 55.0, 28.0, 27.0, 41.0, 86.0, 65.0, 2.0, 99.0, 0.0, 7.0, 69.0, 0.0, 0.0, 55.0, 84.0, 93.0, 17.0, 63.0, 52.0, 40.0, 1.0, 0.0, 42.0, 0.0, 15.0, 67.0, 20.0, 35.0, 10.0, 0.0, 2.0, 40.0, 35.0, 24.0, 33.0, 0.0, 51.0, 64.0, 84.0, 37.0, 38.0, 112.0, 58.0, 105.0, 74.0, 89.0, 106.0, 35.0, 85.0, 27.0, 50.0, 0.0, 3.0, 16.0, 34.0, 48.0, 62.0, 53.0, 0.0, 19.0, 40.0, 45.0, 106.0, 104.0, 106.0, 39.0, 56.0, 88.0, 13.0, 100.0, 54.0, 0.0, 0.0, 95.0, 114.0, 68.0, 31.0, 36.0, 72.0, 46.0, 93.0, 0.0, 15.0, 94.0, 85.0, 101.0, 37.0, 98.0, 29.0, 45.0, 0.0, 0.0, 35.0, 0.0, 74.0, 86.0, 69.0, 88.0, 79.0, 174.0, 43.0, 28.0, 0.0, 12.0, 70.0, 29.0, 29.0, 88.0, 2.0, 76.0, 5.0, 62.0, 53.0, 76.0, 58.0, 29.0, 29.0, 96.0, 99.0, 46.0, 87.0, 158.0, 128.0, 28.0, 86.0, 109.0, 82.0, 190.0, 24.0, 127.0, 128.0, 62.0, 96.0, 39.0, 9.0, 90.0, 111.0, 0.0, 43.0, 0.0, 176.0, 143.0, 108.0, 128.0, 109.0, 137.0, 125.0, 30.0, 94.0, 117.0, 133.0, 34.0, 63.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.658111626422325, "mean_inference_ms": 1.496087029858806, "mean_action_processing_ms": 0.2582786008745987, "mean_env_wait_ms": 0.2010624225152982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063163042068481445, "StateBufferConnector_ms": 0.01091468334197998, "ViewRequirementAgentConnector_ms": 0.12520849704742432}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": -366.0, "episode_return_mean": 42.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.94531187623771, "num_env_steps_trained_throughput_per_sec": 73.94531187623771, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 54644.532, "restore_workers_time_ms": 0.015, "training_step_time_ms": 54644.453, "sample_time_ms": 1253.549, "learn_time_ms": 53368.066, "learn_throughput": 74.951, "synch_weights_time_ms": 17.119}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-11-52", "timestamp": 1723518712, "time_this_iter_s": 54.15141773223877, "time_total_s": 1288.5763273239136, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1288.5763273239136, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 40.3025974025974, "ram_util_percent": 82.25324675324673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.557537732805525, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.614578217047232, "policy_loss": -0.011622411779635562, "vf_loss": 8.62415654091608, "vf_explained_var": 0.06784442404590586, "kl": 0.00908497865682244, "entropy": 1.3321255222199455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.437582897729975, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.76219721622568, "policy_loss": -0.016715888304527474, "vf_loss": 7.775327584857032, "vf_explained_var": -0.4226045848831298, "kl": 0.01195167677404188, "entropy": 1.3676584211606828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -366.0, "episode_reward_mean": -0.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -377.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": -64.53, "predator_policy": 64.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.0, 157.0, 377.0, 104.0, -156.0, 26.0, 205.0, 50.0, -2.0, 169.0, 187.0, 180.0, 0.0, 29.0, 124.0, 349.0, 97.0, 82.0, 64.0, -10.0, 174.0, 87.0, 230.0, 60.0, 84.0, 26.0, 17.0, 102.0, -30.0, 151.0, 247.0, 147.0, 151.0, 48.0, 317.0, 166.0, -50.0, -2.0, -126.0, -9.0, 222.0, 61.0, -157.0, 78.0, 18.0, 55.0, 50.0, -191.0, -35.0, 63.0, 260.0, 77.0, 49.0, -76.0, -366.0, 58.0, 121.0, 106.0, 24.0, 1.0, 130.0, -9.0, 40.0, 5.0, -87.0, -224.0, -122.0, -168.0, -333.0, -76.0, -173.0, 7.0, -77.0, -50.0, -61.0, -58.0, -219.0, -149.0, -95.0, -51.0, -106.0, -85.0, -195.0, -18.0, 1.0, -98.0, -66.0, -103.0, -70.0, -190.0, -218.0, -63.0, -38.0, -328.0, -98.0, -254.0, -87.0, -333.0, -163.0, -123.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-76.0, 136.0, 134.0, 0.0, 181.0, 196.0, 11.0, -13.0, -120.0, -308.0, -57.0, 0.0, 96.0, 41.0, -11.0, -90.0, -45.0, -58.0, 162.0, 0.0, -1.0, 119.0, 75.0, 50.0, 13.0, -190.0, 3.0, -54.0, 46.0, -14.0, 176.0, 172.0, 0.0, 55.0, -41.0, 41.0, 0.0, 9.0, 0.0, -20.0, 80.0, 52.0, 28.0, 0.0, 82.0, 115.0, -27.0, -28.0, -25.0, -12.0, -196.0, 72.0, -36.0, -110.0, 25.0, -86.0, -68.0, -103.0, 24.0, 15.0, 121.0, 76.0, 128.0, 0.0, 42.0, 27.0, 35.0, -102.0, 147.0, 151.0, 49.0, 32.0, -92.0, -168.0, -27.0, -120.0, -164.0, -106.0, -56.0, -66.0, 65.0, 103.0, -28.0, -6.0, -147.0, -192.0, 0.0, 11.0, -43.0, -57.0, -65.0, 27.0, 14.0, -73.0, -141.0, -236.0, -112.0, -58.0, -11.0, 0.0, 74.0, 186.0, 42.0, 0.0, 31.0, -142.0, -178.0, -55.0, -282.0, -337.0, -40.0, 27.0, 109.0, 0.0, -34.0, 41.0, -93.0, 0.0, -73.0, -4.0, 36.0, 27.0, -111.0, -27.0, -58.0, 11.0, -120.0, 0.0, 0.0, -232.0, -308.0, -161.0, -248.0, -30.0, -125.0, -238.0, -298.0, -307.0, -227.0, 0.0, -169.0, -194.0, -54.0, -74.0, -75.0, -101.0, 0.0, -161.0, -18.0, -86.0, 0.0, -377.0, -226.0, -229.0, -266.0, -129.0, -250.0, 0.0, -262.0, 0.0, -208.0, -65.0, -93.0, -110.0, -299.0, -145.0, -44.0, 0.0, -151.0, -4.0, -109.0, -216.0, 0.0, -294.0, -116.0, -221.0, 0.0, -197.0, -193.0, -285.0, -235.0, -250.0, -283.0, 0.0, 0.0, -173.0, -318.0, -224.0, -138.0, -52.0, -320.0, -181.0, -151.0, -55.0, -340.0, -262.0, -199.0, -188.0, -213.0, -137.0], "policy_predator_policy_reward": [21.0, 38.0, 15.0, 8.0, 0.0, 0.0, 32.0, 74.0, 155.0, 117.0, 55.0, 28.0, 27.0, 41.0, 86.0, 65.0, 2.0, 99.0, 0.0, 7.0, 69.0, 0.0, 0.0, 55.0, 84.0, 93.0, 17.0, 63.0, 52.0, 40.0, 1.0, 0.0, 42.0, 0.0, 15.0, 67.0, 20.0, 35.0, 10.0, 0.0, 2.0, 40.0, 35.0, 24.0, 33.0, 0.0, 51.0, 64.0, 84.0, 37.0, 38.0, 112.0, 58.0, 105.0, 74.0, 89.0, 106.0, 35.0, 85.0, 27.0, 50.0, 0.0, 3.0, 16.0, 34.0, 48.0, 62.0, 53.0, 0.0, 19.0, 40.0, 45.0, 106.0, 104.0, 106.0, 39.0, 56.0, 88.0, 13.0, 100.0, 54.0, 0.0, 0.0, 95.0, 114.0, 68.0, 31.0, 36.0, 72.0, 46.0, 93.0, 0.0, 15.0, 94.0, 85.0, 101.0, 37.0, 98.0, 29.0, 45.0, 0.0, 0.0, 35.0, 0.0, 74.0, 86.0, 69.0, 88.0, 79.0, 174.0, 43.0, 28.0, 0.0, 12.0, 70.0, 29.0, 29.0, 88.0, 2.0, 76.0, 5.0, 62.0, 53.0, 76.0, 58.0, 29.0, 29.0, 96.0, 99.0, 46.0, 87.0, 158.0, 128.0, 28.0, 86.0, 109.0, 82.0, 190.0, 24.0, 127.0, 128.0, 62.0, 96.0, 39.0, 9.0, 90.0, 111.0, 0.0, 43.0, 0.0, 176.0, 143.0, 108.0, 128.0, 109.0, 137.0, 125.0, 30.0, 94.0, 117.0, 133.0, 34.0, 63.0, 55.0, 149.0, 100.0, 12.0, 14.0, 60.0, 96.0, 94.0, 133.0, 121.0, 107.0, 121.0, 113.0, 64.0, 63.0, 154.0, 134.0, 114.0, 153.0, 112.0, 108.0, 57.0, 78.0, 140.0, 74.0, 83.0, 9.0, 166.0, 81.0, 0.0, 119.0, 168.0, 101.0, 118.0, 106.0, 104.0, 123.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6584297896417037, "mean_inference_ms": 1.4966319795434508, "mean_action_processing_ms": 0.25856512583669194, "mean_env_wait_ms": 0.2012323643948022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064029693603515625, "StateBufferConnector_ms": 0.01172339916229248, "ViewRequirementAgentConnector_ms": 0.12388157844543457}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": -366.0, "episode_return_mean": -0.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.13395260331919, "num_env_steps_trained_throughput_per_sec": 72.13395260331919, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 54723.397, "restore_workers_time_ms": 0.028, "training_step_time_ms": 54723.314, "sample_time_ms": 1261.073, "learn_time_ms": 53440.79, "learn_throughput": 74.849, "synch_weights_time_ms": 16.474}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-12-47", "timestamp": 1723518767, "time_this_iter_s": 55.48903822898865, "time_total_s": 1344.0653655529022, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80aeee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1344.0653655529022, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 45.312658227848104, "ram_util_percent": 83.29620253164558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.784123907013544, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.057219437190464, "policy_loss": -0.00976812136987786, "vf_loss": 7.065369880262506, "vf_explained_var": -0.0015379391965411957, "kl": 0.007189681559271227, "entropy": 1.2957802894254211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.075942823811183, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.183071356980258, "policy_loss": -0.0102472724461997, "vf_loss": 6.190793798335646, "vf_explained_var": -0.15567620147472966, "kl": 0.008416100921754054, "entropy": 1.3885763185995597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 317.0, "episode_reward_min": -366.0, "episode_reward_mean": -35.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -377.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": -87.29, "predator_policy": 69.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.0, -10.0, 174.0, 87.0, 230.0, 60.0, 84.0, 26.0, 17.0, 102.0, -30.0, 151.0, 247.0, 147.0, 151.0, 48.0, 317.0, 166.0, -50.0, -2.0, -126.0, -9.0, 222.0, 61.0, -157.0, 78.0, 18.0, 55.0, 50.0, -191.0, -35.0, 63.0, 260.0, 77.0, 49.0, -76.0, -366.0, 58.0, 121.0, 106.0, 24.0, 1.0, 130.0, -9.0, 40.0, 5.0, -87.0, -224.0, -122.0, -168.0, -333.0, -76.0, -173.0, 7.0, -77.0, -50.0, -61.0, -58.0, -219.0, -149.0, -95.0, -51.0, -106.0, -85.0, -195.0, -18.0, 1.0, -98.0, -66.0, -103.0, -70.0, -190.0, -218.0, -63.0, -38.0, -328.0, -98.0, -254.0, -87.0, -333.0, -163.0, -123.0, -165.0, -89.0, -226.0, -28.0, -83.0, 38.0, -94.0, -78.0, -82.0, -3.0, -108.0, -26.0, -121.0, -59.0, -132.0, -60.0, -40.0, -43.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 9.0, 0.0, -20.0, 80.0, 52.0, 28.0, 0.0, 82.0, 115.0, -27.0, -28.0, -25.0, -12.0, -196.0, 72.0, -36.0, -110.0, 25.0, -86.0, -68.0, -103.0, 24.0, 15.0, 121.0, 76.0, 128.0, 0.0, 42.0, 27.0, 35.0, -102.0, 147.0, 151.0, 49.0, 32.0, -92.0, -168.0, -27.0, -120.0, -164.0, -106.0, -56.0, -66.0, 65.0, 103.0, -28.0, -6.0, -147.0, -192.0, 0.0, 11.0, -43.0, -57.0, -65.0, 27.0, 14.0, -73.0, -141.0, -236.0, -112.0, -58.0, -11.0, 0.0, 74.0, 186.0, 42.0, 0.0, 31.0, -142.0, -178.0, -55.0, -282.0, -337.0, -40.0, 27.0, 109.0, 0.0, -34.0, 41.0, -93.0, 0.0, -73.0, -4.0, 36.0, 27.0, -111.0, -27.0, -58.0, 11.0, -120.0, 0.0, 0.0, -232.0, -308.0, -161.0, -248.0, -30.0, -125.0, -238.0, -298.0, -307.0, -227.0, 0.0, -169.0, -194.0, -54.0, -74.0, -75.0, -101.0, 0.0, -161.0, -18.0, -86.0, 0.0, -377.0, -226.0, -229.0, -266.0, -129.0, -250.0, 0.0, -262.0, 0.0, -208.0, -65.0, -93.0, -110.0, -299.0, -145.0, -44.0, 0.0, -151.0, -4.0, -109.0, -216.0, 0.0, -294.0, -116.0, -221.0, 0.0, -197.0, -193.0, -285.0, -235.0, -250.0, -283.0, 0.0, 0.0, -173.0, -318.0, -224.0, -138.0, -52.0, -320.0, -181.0, -151.0, -55.0, -340.0, -262.0, -199.0, -188.0, -213.0, -137.0, -159.0, -218.0, -125.0, -70.0, -300.0, -195.0, -6.0, -141.0, -82.0, -187.0, 0.0, 38.0, -214.0, -66.0, -123.0, -171.0, -79.0, -143.0, -6.0, 0.0, -163.0, -102.0, -40.0, -110.0, -108.0, -218.0, 0.0, -194.0, -165.0, -180.0, -127.0, -67.0, -110.0, -2.0, -66.0, -24.0], "policy_predator_policy_reward": [20.0, 35.0, 10.0, 0.0, 2.0, 40.0, 35.0, 24.0, 33.0, 0.0, 51.0, 64.0, 84.0, 37.0, 38.0, 112.0, 58.0, 105.0, 74.0, 89.0, 106.0, 35.0, 85.0, 27.0, 50.0, 0.0, 3.0, 16.0, 34.0, 48.0, 62.0, 53.0, 0.0, 19.0, 40.0, 45.0, 106.0, 104.0, 106.0, 39.0, 56.0, 88.0, 13.0, 100.0, 54.0, 0.0, 0.0, 95.0, 114.0, 68.0, 31.0, 36.0, 72.0, 46.0, 93.0, 0.0, 15.0, 94.0, 85.0, 101.0, 37.0, 98.0, 29.0, 45.0, 0.0, 0.0, 35.0, 0.0, 74.0, 86.0, 69.0, 88.0, 79.0, 174.0, 43.0, 28.0, 0.0, 12.0, 70.0, 29.0, 29.0, 88.0, 2.0, 76.0, 5.0, 62.0, 53.0, 76.0, 58.0, 29.0, 29.0, 96.0, 99.0, 46.0, 87.0, 158.0, 128.0, 28.0, 86.0, 109.0, 82.0, 190.0, 24.0, 127.0, 128.0, 62.0, 96.0, 39.0, 9.0, 90.0, 111.0, 0.0, 43.0, 0.0, 176.0, 143.0, 108.0, 128.0, 109.0, 137.0, 125.0, 30.0, 94.0, 117.0, 133.0, 34.0, 63.0, 55.0, 149.0, 100.0, 12.0, 14.0, 60.0, 96.0, 94.0, 133.0, 121.0, 107.0, 121.0, 113.0, 64.0, 63.0, 154.0, 134.0, 114.0, 153.0, 112.0, 108.0, 57.0, 78.0, 140.0, 74.0, 83.0, 9.0, 166.0, 81.0, 0.0, 119.0, 168.0, 101.0, 118.0, 106.0, 104.0, 123.0, 108.0, 104.0, 68.0, 38.0, 125.0, 144.0, 65.0, 54.0, 79.0, 107.0, 0.0, 0.0, 105.0, 81.0, 110.0, 106.0, 63.0, 77.0, 3.0, 0.0, 65.0, 92.0, 54.0, 70.0, 86.0, 119.0, 63.0, 72.0, 81.0, 132.0, 86.0, 48.0, 45.0, 27.0, 6.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586150702874026, "mean_inference_ms": 1.4956001188562162, "mean_action_processing_ms": 0.2587223977521529, "mean_env_wait_ms": 0.2012355465154844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00706171989440918, "StateBufferConnector_ms": 0.011716008186340332, "ViewRequirementAgentConnector_ms": 0.11778271198272705}, "num_episodes": 18, "episode_return_max": 317.0, "episode_return_min": -366.0, "episode_return_mean": -35.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.03826247962343, "num_env_steps_trained_throughput_per_sec": 77.03826247962343, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 54573.958, "restore_workers_time_ms": 0.028, "training_step_time_ms": 54573.877, "sample_time_ms": 1205.729, "learn_time_ms": 53346.579, "learn_throughput": 74.981, "synch_weights_time_ms": 16.753}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-13-39", "timestamp": 1723518819, "time_this_iter_s": 51.95716190338135, "time_total_s": 1396.0225274562836, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1396.0225274562836, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 35.83918918918919, "ram_util_percent": 83.04729729729729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.45522930420265, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.695715711987208, "policy_loss": -0.007007878396546754, "vf_loss": 4.701289627539418, "vf_explained_var": -0.011303908200491042, "kl": 0.006373158976366055, "entropy": 1.2471297877806204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.870426125879641, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6792790414164305, "policy_loss": -0.0117340495134827, "vf_loss": 4.687709135227102, "vf_explained_var": -0.08937655384578402, "kl": 0.011013193735880845, "entropy": 1.3831818918702463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 260.0, "episode_reward_min": -435.0, "episode_reward_mean": -73.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -710.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 685.0}, "policy_reward_mean": {"prey_policy": -112.61, "predator_policy": 75.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.0, 61.0, -157.0, 78.0, 18.0, 55.0, 50.0, -191.0, -35.0, 63.0, 260.0, 77.0, 49.0, -76.0, -366.0, 58.0, 121.0, 106.0, 24.0, 1.0, 130.0, -9.0, 40.0, 5.0, -87.0, -224.0, -122.0, -168.0, -333.0, -76.0, -173.0, 7.0, -77.0, -50.0, -61.0, -58.0, -219.0, -149.0, -95.0, -51.0, -106.0, -85.0, -195.0, -18.0, 1.0, -98.0, -66.0, -103.0, -70.0, -190.0, -218.0, -63.0, -38.0, -328.0, -98.0, -254.0, -87.0, -333.0, -163.0, -123.0, -165.0, -89.0, -226.0, -28.0, -83.0, 38.0, -94.0, -78.0, -82.0, -3.0, -108.0, -26.0, -121.0, -59.0, -132.0, -60.0, -40.0, -43.0, -435.0, -234.0, -17.0, -88.0, -39.0, -26.0, -25.0, -41.0, -31.0, -77.0, -12.0, 13.0, -13.0, 13.0, -38.0, -137.0, -136.0, -34.0, -122.0, -71.0, -393.0, -68.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [65.0, 103.0, -28.0, -6.0, -147.0, -192.0, 0.0, 11.0, -43.0, -57.0, -65.0, 27.0, 14.0, -73.0, -141.0, -236.0, -112.0, -58.0, -11.0, 0.0, 74.0, 186.0, 42.0, 0.0, 31.0, -142.0, -178.0, -55.0, -282.0, -337.0, -40.0, 27.0, 109.0, 0.0, -34.0, 41.0, -93.0, 0.0, -73.0, -4.0, 36.0, 27.0, -111.0, -27.0, -58.0, 11.0, -120.0, 0.0, 0.0, -232.0, -308.0, -161.0, -248.0, -30.0, -125.0, -238.0, -298.0, -307.0, -227.0, 0.0, -169.0, -194.0, -54.0, -74.0, -75.0, -101.0, 0.0, -161.0, -18.0, -86.0, 0.0, -377.0, -226.0, -229.0, -266.0, -129.0, -250.0, 0.0, -262.0, 0.0, -208.0, -65.0, -93.0, -110.0, -299.0, -145.0, -44.0, 0.0, -151.0, -4.0, -109.0, -216.0, 0.0, -294.0, -116.0, -221.0, 0.0, -197.0, -193.0, -285.0, -235.0, -250.0, -283.0, 0.0, 0.0, -173.0, -318.0, -224.0, -138.0, -52.0, -320.0, -181.0, -151.0, -55.0, -340.0, -262.0, -199.0, -188.0, -213.0, -137.0, -159.0, -218.0, -125.0, -70.0, -300.0, -195.0, -6.0, -141.0, -82.0, -187.0, 0.0, 38.0, -214.0, -66.0, -123.0, -171.0, -79.0, -143.0, -6.0, 0.0, -163.0, -102.0, -40.0, -110.0, -108.0, -218.0, 0.0, -194.0, -165.0, -180.0, -127.0, -67.0, -110.0, -2.0, -66.0, -24.0, -710.0, -410.0, -202.0, -294.0, -15.0, -18.0, -118.0, -134.0, 0.0, -103.0, -15.0, -69.0, 0.0, -117.0, -116.0, -54.0, -20.0, -94.0, -61.0, -132.0, 0.0, -35.0, -71.0, -2.0, -50.0, -32.0, -51.0, 0.0, -50.0, -95.0, -96.0, -402.0, -197.0, -120.0, -76.0, -110.0, -102.0, -190.0, -161.0, 0.0, -328.0, -334.0, 0.0, -182.0], "policy_predator_policy_reward": [54.0, 0.0, 0.0, 95.0, 114.0, 68.0, 31.0, 36.0, 72.0, 46.0, 93.0, 0.0, 15.0, 94.0, 85.0, 101.0, 37.0, 98.0, 29.0, 45.0, 0.0, 0.0, 35.0, 0.0, 74.0, 86.0, 69.0, 88.0, 79.0, 174.0, 43.0, 28.0, 0.0, 12.0, 70.0, 29.0, 29.0, 88.0, 2.0, 76.0, 5.0, 62.0, 53.0, 76.0, 58.0, 29.0, 29.0, 96.0, 99.0, 46.0, 87.0, 158.0, 128.0, 28.0, 86.0, 109.0, 82.0, 190.0, 24.0, 127.0, 128.0, 62.0, 96.0, 39.0, 9.0, 90.0, 111.0, 0.0, 43.0, 0.0, 176.0, 143.0, 108.0, 128.0, 109.0, 137.0, 125.0, 30.0, 94.0, 117.0, 133.0, 34.0, 63.0, 55.0, 149.0, 100.0, 12.0, 14.0, 60.0, 96.0, 94.0, 133.0, 121.0, 107.0, 121.0, 113.0, 64.0, 63.0, 154.0, 134.0, 114.0, 153.0, 112.0, 108.0, 57.0, 78.0, 140.0, 74.0, 83.0, 9.0, 166.0, 81.0, 0.0, 119.0, 168.0, 101.0, 118.0, 106.0, 104.0, 123.0, 108.0, 104.0, 68.0, 38.0, 125.0, 144.0, 65.0, 54.0, 79.0, 107.0, 0.0, 0.0, 105.0, 81.0, 110.0, 106.0, 63.0, 77.0, 3.0, 0.0, 65.0, 92.0, 54.0, 70.0, 86.0, 119.0, 63.0, 72.0, 81.0, 132.0, 86.0, 48.0, 45.0, 27.0, 6.0, 41.0, 0.0, 685.0, 0.0, 262.0, 7.0, 9.0, 95.0, 69.0, 39.0, 25.0, 0.0, 58.0, 27.0, 65.0, 65.0, 64.0, 45.0, 38.0, 67.0, 49.0, 2.0, 21.0, 47.0, 39.0, 38.0, 31.0, 28.0, 36.0, 49.0, 58.0, 317.0, 44.0, 81.0, 100.0, 65.0, 87.0, 91.0, 79.0, 0.0, 90.0, 0.0, 269.0, 63.0, 51.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586390555133346, "mean_inference_ms": 1.4920559227837966, "mean_action_processing_ms": 0.25865824362505824, "mean_env_wait_ms": 0.2011108709087127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009530425071716309, "StateBufferConnector_ms": 0.011714339256286621, "ViewRequirementAgentConnector_ms": 0.12005054950714111}, "num_episodes": 22, "episode_return_max": 260.0, "episode_return_min": -435.0, "episode_return_mean": -73.97, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.86614128783422, "num_env_steps_trained_throughput_per_sec": 76.86614128783422, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 54741.487, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54741.363, "sample_time_ms": 1221.618, "learn_time_ms": 53497.187, "learn_throughput": 74.77, "synch_weights_time_ms": 17.107}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-14-31", "timestamp": 1723518871, "time_this_iter_s": 52.07054376602173, "time_total_s": 1448.0930712223053, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8079310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1448.0930712223053, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 38.008108108108104, "ram_util_percent": 82.88783783783784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.80662213494538, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.141615133058457, "policy_loss": -0.010516283220719921, "vf_loss": 3.1503212713059927, "vf_explained_var": 0.15101416580891483, "kl": 0.0080450981972449, "entropy": 1.2283003463946953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.360637210191242, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3234775481400667, "policy_loss": -0.013508820018322064, "vf_loss": 3.3348711086959435, "vf_explained_var": -0.618978262956811, "kl": 0.007050844000858725, "entropy": 1.3463324972561428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 94.0, "episode_reward_min": -435.0, "episode_reward_mean": -84.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -710.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.0, "predator_policy": 685.0}, "policy_reward_mean": {"prey_policy": -113.08, "predator_policy": 70.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, -87.0, -224.0, -122.0, -168.0, -333.0, -76.0, -173.0, 7.0, -77.0, -50.0, -61.0, -58.0, -219.0, -149.0, -95.0, -51.0, -106.0, -85.0, -195.0, -18.0, 1.0, -98.0, -66.0, -103.0, -70.0, -190.0, -218.0, -63.0, -38.0, -328.0, -98.0, -254.0, -87.0, -333.0, -163.0, -123.0, -165.0, -89.0, -226.0, -28.0, -83.0, 38.0, -94.0, -78.0, -82.0, -3.0, -108.0, -26.0, -121.0, -59.0, -132.0, -60.0, -40.0, -43.0, -435.0, -234.0, -17.0, -88.0, -39.0, -26.0, -25.0, -41.0, -31.0, -77.0, -12.0, 13.0, -13.0, 13.0, -38.0, -137.0, -136.0, -34.0, -122.0, -71.0, -393.0, -68.0, -78.0, -45.0, -8.0, -41.0, -11.0, 0.0, -15.0, -6.0, 0.0, 94.0, -5.0, -43.0, 40.0, -33.0, -210.0, -26.0, -15.0, -21.0, -7.0, -10.0, -31.0, -30.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-120.0, 0.0, 0.0, -232.0, -308.0, -161.0, -248.0, -30.0, -125.0, -238.0, -298.0, -307.0, -227.0, 0.0, -169.0, -194.0, -54.0, -74.0, -75.0, -101.0, 0.0, -161.0, -18.0, -86.0, 0.0, -377.0, -226.0, -229.0, -266.0, -129.0, -250.0, 0.0, -262.0, 0.0, -208.0, -65.0, -93.0, -110.0, -299.0, -145.0, -44.0, 0.0, -151.0, -4.0, -109.0, -216.0, 0.0, -294.0, -116.0, -221.0, 0.0, -197.0, -193.0, -285.0, -235.0, -250.0, -283.0, 0.0, 0.0, -173.0, -318.0, -224.0, -138.0, -52.0, -320.0, -181.0, -151.0, -55.0, -340.0, -262.0, -199.0, -188.0, -213.0, -137.0, -159.0, -218.0, -125.0, -70.0, -300.0, -195.0, -6.0, -141.0, -82.0, -187.0, 0.0, 38.0, -214.0, -66.0, -123.0, -171.0, -79.0, -143.0, -6.0, 0.0, -163.0, -102.0, -40.0, -110.0, -108.0, -218.0, 0.0, -194.0, -165.0, -180.0, -127.0, -67.0, -110.0, -2.0, -66.0, -24.0, -710.0, -410.0, -202.0, -294.0, -15.0, -18.0, -118.0, -134.0, 0.0, -103.0, -15.0, -69.0, 0.0, -117.0, -116.0, -54.0, -20.0, -94.0, -61.0, -132.0, 0.0, -35.0, -71.0, -2.0, -50.0, -32.0, -51.0, 0.0, -50.0, -95.0, -96.0, -402.0, -197.0, -120.0, -76.0, -110.0, -102.0, -190.0, -161.0, 0.0, -328.0, -334.0, 0.0, -182.0, -128.0, -25.0, -13.0, -83.0, 0.0, -22.0, -56.0, -16.0, 0.0, -55.0, 0.0, 0.0, -47.0, 8.0, 0.0, -38.0, 0.0, 0.0, 45.0, 0.0, -16.0, -18.0, -126.0, -53.0, 16.0, -13.0, 4.0, -82.0, -149.0, -362.0, 0.0, -61.0, 0.0, -53.0, 0.0, -120.0, -21.0, -16.0, -16.0, -35.0, -30.0, -199.0, -36.0, -65.0, -12.0, 0.0], "policy_predator_policy_reward": [29.0, 96.0, 99.0, 46.0, 87.0, 158.0, 128.0, 28.0, 86.0, 109.0, 82.0, 190.0, 24.0, 127.0, 128.0, 62.0, 96.0, 39.0, 9.0, 90.0, 111.0, 0.0, 43.0, 0.0, 176.0, 143.0, 108.0, 128.0, 109.0, 137.0, 125.0, 30.0, 94.0, 117.0, 133.0, 34.0, 63.0, 55.0, 149.0, 100.0, 12.0, 14.0, 60.0, 96.0, 94.0, 133.0, 121.0, 107.0, 121.0, 113.0, 64.0, 63.0, 154.0, 134.0, 114.0, 153.0, 112.0, 108.0, 57.0, 78.0, 140.0, 74.0, 83.0, 9.0, 166.0, 81.0, 0.0, 119.0, 168.0, 101.0, 118.0, 106.0, 104.0, 123.0, 108.0, 104.0, 68.0, 38.0, 125.0, 144.0, 65.0, 54.0, 79.0, 107.0, 0.0, 0.0, 105.0, 81.0, 110.0, 106.0, 63.0, 77.0, 3.0, 0.0, 65.0, 92.0, 54.0, 70.0, 86.0, 119.0, 63.0, 72.0, 81.0, 132.0, 86.0, 48.0, 45.0, 27.0, 6.0, 41.0, 0.0, 685.0, 0.0, 262.0, 7.0, 9.0, 95.0, 69.0, 39.0, 25.0, 0.0, 58.0, 27.0, 65.0, 65.0, 64.0, 45.0, 38.0, 67.0, 49.0, 2.0, 21.0, 47.0, 39.0, 38.0, 31.0, 28.0, 36.0, 49.0, 58.0, 317.0, 44.0, 81.0, 100.0, 65.0, 87.0, 91.0, 79.0, 0.0, 90.0, 0.0, 269.0, 63.0, 51.0, 4.0, 71.0, 46.0, 5.0, 0.0, 14.0, 5.0, 26.0, 29.0, 15.0, 0.0, 0.0, 23.0, 1.0, 19.0, 13.0, 0.0, 0.0, 31.0, 18.0, 29.0, 0.0, 71.0, 65.0, 0.0, 37.0, 44.0, 1.0, 13.0, 288.0, 33.0, 2.0, 38.0, 0.0, 41.0, 58.0, 30.0, 0.0, 16.0, 25.0, 12.0, 186.0, 36.0, 35.0, 0.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586197001159337, "mean_inference_ms": 1.5281817239078117, "mean_action_processing_ms": 0.2585267266696545, "mean_env_wait_ms": 0.2006356415974493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0095367431640625, "StateBufferConnector_ms": 0.009660005569458008, "ViewRequirementAgentConnector_ms": 0.11755096912384033}, "num_episodes": 23, "episode_return_max": 94.0, "episode_return_min": -435.0, "episode_return_mean": -84.75, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.4789056364903, "num_env_steps_trained_throughput_per_sec": 74.4789056364903, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 54857.488, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54857.37, "sample_time_ms": 1448.573, "learn_time_ms": 53386.734, "learn_throughput": 74.925, "synch_weights_time_ms": 16.174}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-15-25", "timestamp": 1723518925, "time_this_iter_s": 53.72792196273804, "time_total_s": 1501.8209931850433, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8031d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1501.8209931850433, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 40.76447368421053, "ram_util_percent": 83.25526315789476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.852469467296802, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6805833427048233, "policy_loss": -0.009873221688238638, "vf_loss": 1.6890193998182892, "vf_explained_var": 0.08472775145182534, "kl": 0.006387396597685667, "entropy": 1.2602948180582159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8235929430477205, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.055263573057437, "policy_loss": -0.014082595776697552, "vf_loss": 2.068178503822397, "vf_explained_var": -0.31160448357541726, "kl": 0.0038922268365892284, "entropy": 1.3438577462756445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 94.0, "episode_reward_min": -435.0, "episode_reward_mean": -64.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -710.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.0, "predator_policy": 685.0}, "policy_reward_mean": {"prey_policy": -89.595, "predator_policy": 57.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.0, -195.0, -18.0, 1.0, -98.0, -66.0, -103.0, -70.0, -190.0, -218.0, -63.0, -38.0, -328.0, -98.0, -254.0, -87.0, -333.0, -163.0, -123.0, -165.0, -89.0, -226.0, -28.0, -83.0, 38.0, -94.0, -78.0, -82.0, -3.0, -108.0, -26.0, -121.0, -59.0, -132.0, -60.0, -40.0, -43.0, -435.0, -234.0, -17.0, -88.0, -39.0, -26.0, -25.0, -41.0, -31.0, -77.0, -12.0, 13.0, -13.0, 13.0, -38.0, -137.0, -136.0, -34.0, -122.0, -71.0, -393.0, -68.0, -78.0, -45.0, -8.0, -41.0, -11.0, 0.0, -15.0, -6.0, 0.0, 94.0, -5.0, -43.0, 40.0, -33.0, -210.0, -26.0, -15.0, -21.0, -7.0, -10.0, -31.0, -30.0, 2.0, 7.0, -17.0, 73.0, -8.0, -11.0, 16.0, -41.0, 0.0, -8.0, 2.0, 7.0, -27.0, -12.0, -5.0, -20.0, 40.0, 19.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-93.0, -110.0, -299.0, -145.0, -44.0, 0.0, -151.0, -4.0, -109.0, -216.0, 0.0, -294.0, -116.0, -221.0, 0.0, -197.0, -193.0, -285.0, -235.0, -250.0, -283.0, 0.0, 0.0, -173.0, -318.0, -224.0, -138.0, -52.0, -320.0, -181.0, -151.0, -55.0, -340.0, -262.0, -199.0, -188.0, -213.0, -137.0, -159.0, -218.0, -125.0, -70.0, -300.0, -195.0, -6.0, -141.0, -82.0, -187.0, 0.0, 38.0, -214.0, -66.0, -123.0, -171.0, -79.0, -143.0, -6.0, 0.0, -163.0, -102.0, -40.0, -110.0, -108.0, -218.0, 0.0, -194.0, -165.0, -180.0, -127.0, -67.0, -110.0, -2.0, -66.0, -24.0, -710.0, -410.0, -202.0, -294.0, -15.0, -18.0, -118.0, -134.0, 0.0, -103.0, -15.0, -69.0, 0.0, -117.0, -116.0, -54.0, -20.0, -94.0, -61.0, -132.0, 0.0, -35.0, -71.0, -2.0, -50.0, -32.0, -51.0, 0.0, -50.0, -95.0, -96.0, -402.0, -197.0, -120.0, -76.0, -110.0, -102.0, -190.0, -161.0, 0.0, -328.0, -334.0, 0.0, -182.0, -128.0, -25.0, -13.0, -83.0, 0.0, -22.0, -56.0, -16.0, 0.0, -55.0, 0.0, 0.0, -47.0, 8.0, 0.0, -38.0, 0.0, 0.0, 45.0, 0.0, -16.0, -18.0, -126.0, -53.0, 16.0, -13.0, 4.0, -82.0, -149.0, -362.0, 0.0, -61.0, 0.0, -53.0, 0.0, -120.0, -21.0, -16.0, -16.0, -35.0, -30.0, -199.0, -36.0, -65.0, -12.0, 0.0, -28.0, 9.0, 0.0, -34.0, 20.0, 6.0, -32.0, 0.0, -26.0, -58.0, 0.0, 2.0, -34.0, -51.0, 0.0, 0.0, 0.0, -16.0, -2.0, -15.0, -2.0, -10.0, -61.0, -4.0, -21.0, -43.0, -17.0, 0.0, -20.0, -28.0, 0.0, 6.0, 7.0, -31.0, -29.0, -29.0], "policy_predator_policy_reward": [63.0, 55.0, 149.0, 100.0, 12.0, 14.0, 60.0, 96.0, 94.0, 133.0, 121.0, 107.0, 121.0, 113.0, 64.0, 63.0, 154.0, 134.0, 114.0, 153.0, 112.0, 108.0, 57.0, 78.0, 140.0, 74.0, 83.0, 9.0, 166.0, 81.0, 0.0, 119.0, 168.0, 101.0, 118.0, 106.0, 104.0, 123.0, 108.0, 104.0, 68.0, 38.0, 125.0, 144.0, 65.0, 54.0, 79.0, 107.0, 0.0, 0.0, 105.0, 81.0, 110.0, 106.0, 63.0, 77.0, 3.0, 0.0, 65.0, 92.0, 54.0, 70.0, 86.0, 119.0, 63.0, 72.0, 81.0, 132.0, 86.0, 48.0, 45.0, 27.0, 6.0, 41.0, 0.0, 685.0, 0.0, 262.0, 7.0, 9.0, 95.0, 69.0, 39.0, 25.0, 0.0, 58.0, 27.0, 65.0, 65.0, 64.0, 45.0, 38.0, 67.0, 49.0, 2.0, 21.0, 47.0, 39.0, 38.0, 31.0, 28.0, 36.0, 49.0, 58.0, 317.0, 44.0, 81.0, 100.0, 65.0, 87.0, 91.0, 79.0, 0.0, 90.0, 0.0, 269.0, 63.0, 51.0, 4.0, 71.0, 46.0, 5.0, 0.0, 14.0, 5.0, 26.0, 29.0, 15.0, 0.0, 0.0, 23.0, 1.0, 19.0, 13.0, 0.0, 0.0, 31.0, 18.0, 29.0, 0.0, 71.0, 65.0, 0.0, 37.0, 44.0, 1.0, 13.0, 288.0, 33.0, 2.0, 38.0, 0.0, 41.0, 58.0, 30.0, 0.0, 16.0, 25.0, 12.0, 186.0, 36.0, 35.0, 0.0, 14.0, 26.0, 0.0, 3.0, 14.0, 21.0, 26.0, 17.0, 7.0, 25.0, 48.0, 1.0, 13.0, 16.0, 28.0, 0.0, 0.0, 8.0, 0.0, 0.0, 19.0, 12.0, 7.0, 12.0, 26.0, 34.0, 18.0, 12.0, 0.0, 7.0, 21.0, 18.0, 16.0, 20.0, 23.0, 27.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586303976173419, "mean_inference_ms": 1.5543844570551952, "mean_action_processing_ms": 0.2583833331215719, "mean_env_wait_ms": 0.20037883516706095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00897073745727539, "StateBufferConnector_ms": 0.004871487617492676, "ViewRequirementAgentConnector_ms": 0.11113154888153076}, "num_episodes": 18, "episode_return_max": 94.0, "episode_return_min": -435.0, "episode_return_mean": -64.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.96488990143823, "num_env_steps_trained_throughput_per_sec": 76.96488990143823, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 54316.205, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54316.091, "sample_time_ms": 1461.628, "learn_time_ms": 52832.516, "learn_throughput": 75.711, "synch_weights_time_ms": 15.736}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-16-17", "timestamp": 1723518977, "time_this_iter_s": 52.005845069885254, "time_total_s": 1553.8268382549286, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8030430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1553.8268382549286, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 38.03648648648649, "ram_util_percent": 82.93243243243244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.300807702478278, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5911185297385724, "policy_loss": -0.006029912240054241, "vf_loss": 2.5959269013985122, "vf_explained_var": 0.028258226504401556, "kl": 0.0054290696598410185, "entropy": 1.2454021503054906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6559473451167817, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0008470314520377, "policy_loss": -0.010791516486831285, "vf_loss": 3.010220248421664, "vf_explained_var": -0.01609649352295689, "kl": 0.00945530914013751, "entropy": 1.3629081009557007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 175.0, "episode_reward_min": -435.0, "episode_reward_mean": -38.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -710.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.0, "predator_policy": 685.0}, "policy_reward_mean": {"prey_policy": -65.1, "predator_policy": 45.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-123.0, -165.0, -89.0, -226.0, -28.0, -83.0, 38.0, -94.0, -78.0, -82.0, -3.0, -108.0, -26.0, -121.0, -59.0, -132.0, -60.0, -40.0, -43.0, -435.0, -234.0, -17.0, -88.0, -39.0, -26.0, -25.0, -41.0, -31.0, -77.0, -12.0, 13.0, -13.0, 13.0, -38.0, -137.0, -136.0, -34.0, -122.0, -71.0, -393.0, -68.0, -78.0, -45.0, -8.0, -41.0, -11.0, 0.0, -15.0, -6.0, 0.0, 94.0, -5.0, -43.0, 40.0, -33.0, -210.0, -26.0, -15.0, -21.0, -7.0, -10.0, -31.0, -30.0, 2.0, 7.0, -17.0, 73.0, -8.0, -11.0, 16.0, -41.0, 0.0, -8.0, 2.0, 7.0, -27.0, -12.0, -5.0, -20.0, 40.0, 19.0, -5.0, -9.0, -327.0, 85.0, -42.0, 75.0, -5.0, -8.0, -6.0, 157.0, -125.0, 0.0, -13.0, 156.0, 0.0, -52.0, -8.0, 72.0, 175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-213.0, -137.0, -159.0, -218.0, -125.0, -70.0, -300.0, -195.0, -6.0, -141.0, -82.0, -187.0, 0.0, 38.0, -214.0, -66.0, -123.0, -171.0, -79.0, -143.0, -6.0, 0.0, -163.0, -102.0, -40.0, -110.0, -108.0, -218.0, 0.0, -194.0, -165.0, -180.0, -127.0, -67.0, -110.0, -2.0, -66.0, -24.0, -710.0, -410.0, -202.0, -294.0, -15.0, -18.0, -118.0, -134.0, 0.0, -103.0, -15.0, -69.0, 0.0, -117.0, -116.0, -54.0, -20.0, -94.0, -61.0, -132.0, 0.0, -35.0, -71.0, -2.0, -50.0, -32.0, -51.0, 0.0, -50.0, -95.0, -96.0, -402.0, -197.0, -120.0, -76.0, -110.0, -102.0, -190.0, -161.0, 0.0, -328.0, -334.0, 0.0, -182.0, -128.0, -25.0, -13.0, -83.0, 0.0, -22.0, -56.0, -16.0, 0.0, -55.0, 0.0, 0.0, -47.0, 8.0, 0.0, -38.0, 0.0, 0.0, 45.0, 0.0, -16.0, -18.0, -126.0, -53.0, 16.0, -13.0, 4.0, -82.0, -149.0, -362.0, 0.0, -61.0, 0.0, -53.0, 0.0, -120.0, -21.0, -16.0, -16.0, -35.0, -30.0, -199.0, -36.0, -65.0, -12.0, 0.0, -28.0, 9.0, 0.0, -34.0, 20.0, 6.0, -32.0, 0.0, -26.0, -58.0, 0.0, 2.0, -34.0, -51.0, 0.0, 0.0, 0.0, -16.0, -2.0, -15.0, -2.0, -10.0, -61.0, -4.0, -21.0, -43.0, -17.0, 0.0, -20.0, -28.0, 0.0, 6.0, 7.0, -31.0, -29.0, -29.0, 0.0, -18.0, -260.0, -228.0, 33.0, -5.0, -50.0, -42.0, -94.0, 17.0, -6.0, -2.0, -9.0, -18.0, -14.0, 0.0, 0.0, 149.0, -500.0, 0.0, 0.0, 0.0, -127.0, -27.0, 0.0, 147.0, 0.0, 0.0, -9.0, -89.0, -4.0, -16.0, 72.0, 0.0, -16.0, 169.0], "policy_predator_policy_reward": [104.0, 123.0, 108.0, 104.0, 68.0, 38.0, 125.0, 144.0, 65.0, 54.0, 79.0, 107.0, 0.0, 0.0, 105.0, 81.0, 110.0, 106.0, 63.0, 77.0, 3.0, 0.0, 65.0, 92.0, 54.0, 70.0, 86.0, 119.0, 63.0, 72.0, 81.0, 132.0, 86.0, 48.0, 45.0, 27.0, 6.0, 41.0, 0.0, 685.0, 0.0, 262.0, 7.0, 9.0, 95.0, 69.0, 39.0, 25.0, 0.0, 58.0, 27.0, 65.0, 65.0, 64.0, 45.0, 38.0, 67.0, 49.0, 2.0, 21.0, 47.0, 39.0, 38.0, 31.0, 28.0, 36.0, 49.0, 58.0, 317.0, 44.0, 81.0, 100.0, 65.0, 87.0, 91.0, 79.0, 0.0, 90.0, 0.0, 269.0, 63.0, 51.0, 4.0, 71.0, 46.0, 5.0, 0.0, 14.0, 5.0, 26.0, 29.0, 15.0, 0.0, 0.0, 23.0, 1.0, 19.0, 13.0, 0.0, 0.0, 31.0, 18.0, 29.0, 0.0, 71.0, 65.0, 0.0, 37.0, 44.0, 1.0, 13.0, 288.0, 33.0, 2.0, 38.0, 0.0, 41.0, 58.0, 30.0, 0.0, 16.0, 25.0, 12.0, 186.0, 36.0, 35.0, 0.0, 14.0, 26.0, 0.0, 3.0, 14.0, 21.0, 26.0, 17.0, 7.0, 25.0, 48.0, 1.0, 13.0, 16.0, 28.0, 0.0, 0.0, 8.0, 0.0, 0.0, 19.0, 12.0, 7.0, 12.0, 26.0, 34.0, 18.0, 12.0, 0.0, 7.0, 21.0, 18.0, 16.0, 20.0, 23.0, 27.0, 26.0, 6.0, 3.0, 129.0, 32.0, 57.0, 0.0, 29.0, 21.0, 66.0, 86.0, 3.0, 0.0, 15.0, 4.0, 7.0, 1.0, 0.0, 8.0, 375.0, 0.0, 0.0, 0.0, 83.0, 58.0, 8.0, 1.0, 0.0, 0.0, 0.0, 46.0, 2.0, 10.0, 0.0, 0.0, 13.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6587083426340663, "mean_inference_ms": 1.5800886290848055, "mean_action_processing_ms": 0.2582085127905972, "mean_env_wait_ms": 0.20015616769084288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008403301239013672, "StateBufferConnector_ms": 0.006678223609924316, "ViewRequirementAgentConnector_ms": 0.11108362674713135}, "num_episodes": 18, "episode_return_max": 175.0, "episode_return_min": -435.0, "episode_return_mean": -38.97, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.49458984080667, "num_env_steps_trained_throughput_per_sec": 76.49458984080667, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 53443.307, "restore_workers_time_ms": 0.029, "training_step_time_ms": 53443.136, "sample_time_ms": 1452.229, "learn_time_ms": 51966.527, "learn_throughput": 76.973, "synch_weights_time_ms": 18.317}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-17-10", "timestamp": 1723519030, "time_this_iter_s": 52.359561920166016, "time_total_s": 1606.1864001750946, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80aedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1606.1864001750946, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 36.95945945945946, "ram_util_percent": 82.73918918918918}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.773670345481741, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1422666294391823, "policy_loss": -0.0038367572401911414, "vf_loss": 1.1447823335096319, "vf_explained_var": 0.07885857640750825, "kl": 0.005871337634844215, "entropy": 1.247054856101041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.752888466031463, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1972505497553994, "policy_loss": -0.011991726608685756, "vf_loss": 2.2078497133557757, "vf_explained_var": 0.22061287757580872, "kl": 0.009283707145376385, "entropy": 1.4065751757571305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 175.0, "episode_reward_min": -435.0, "episode_reward_mean": -23.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -710.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.0, "predator_policy": 685.0}, "policy_reward_mean": {"prey_policy": -47.86, "predator_policy": 36.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.0, -435.0, -234.0, -17.0, -88.0, -39.0, -26.0, -25.0, -41.0, -31.0, -77.0, -12.0, 13.0, -13.0, 13.0, -38.0, -137.0, -136.0, -34.0, -122.0, -71.0, -393.0, -68.0, -78.0, -45.0, -8.0, -41.0, -11.0, 0.0, -15.0, -6.0, 0.0, 94.0, -5.0, -43.0, 40.0, -33.0, -210.0, -26.0, -15.0, -21.0, -7.0, -10.0, -31.0, -30.0, 2.0, 7.0, -17.0, 73.0, -8.0, -11.0, 16.0, -41.0, 0.0, -8.0, 2.0, 7.0, -27.0, -12.0, -5.0, -20.0, 40.0, 19.0, -5.0, -9.0, -327.0, 85.0, -42.0, 75.0, -5.0, -8.0, -6.0, 157.0, -125.0, 0.0, -13.0, 156.0, 0.0, -52.0, -8.0, 72.0, 175.0, 24.0, 13.0, -99.0, 148.0, -17.0, -2.0, 0.0, -3.0, -16.0, 121.0, -94.0, -1.0, -74.0, 0.0, -16.0, 146.0, -36.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-66.0, -24.0, -710.0, -410.0, -202.0, -294.0, -15.0, -18.0, -118.0, -134.0, 0.0, -103.0, -15.0, -69.0, 0.0, -117.0, -116.0, -54.0, -20.0, -94.0, -61.0, -132.0, 0.0, -35.0, -71.0, -2.0, -50.0, -32.0, -51.0, 0.0, -50.0, -95.0, -96.0, -402.0, -197.0, -120.0, -76.0, -110.0, -102.0, -190.0, -161.0, 0.0, -328.0, -334.0, 0.0, -182.0, -128.0, -25.0, -13.0, -83.0, 0.0, -22.0, -56.0, -16.0, 0.0, -55.0, 0.0, 0.0, -47.0, 8.0, 0.0, -38.0, 0.0, 0.0, 45.0, 0.0, -16.0, -18.0, -126.0, -53.0, 16.0, -13.0, 4.0, -82.0, -149.0, -362.0, 0.0, -61.0, 0.0, -53.0, 0.0, -120.0, -21.0, -16.0, -16.0, -35.0, -30.0, -199.0, -36.0, -65.0, -12.0, 0.0, -28.0, 9.0, 0.0, -34.0, 20.0, 6.0, -32.0, 0.0, -26.0, -58.0, 0.0, 2.0, -34.0, -51.0, 0.0, 0.0, 0.0, -16.0, -2.0, -15.0, -2.0, -10.0, -61.0, -4.0, -21.0, -43.0, -17.0, 0.0, -20.0, -28.0, 0.0, 6.0, 7.0, -31.0, -29.0, -29.0, 0.0, -18.0, -260.0, -228.0, 33.0, -5.0, -50.0, -42.0, -94.0, 17.0, -6.0, -2.0, -9.0, -18.0, -14.0, 0.0, 0.0, 149.0, -500.0, 0.0, 0.0, 0.0, -127.0, -27.0, 0.0, 147.0, 0.0, 0.0, -9.0, -89.0, -4.0, -16.0, 72.0, 0.0, -16.0, 169.0, -45.0, 15.0, -1.0, 0.0, -198.0, 0.0, 0.0, 148.0, -34.0, 0.0, -4.0, 0.0, 0.0, 0.0, -12.0, 0.0, -68.0, 0.0, 105.0, -18.0, -442.0, -16.0, -2.0, 0.0, -35.0, -96.0, 0.0, 0.0, 0.0, -49.0, 128.0, 5.0, -116.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [6.0, 41.0, 0.0, 685.0, 0.0, 262.0, 7.0, 9.0, 95.0, 69.0, 39.0, 25.0, 0.0, 58.0, 27.0, 65.0, 65.0, 64.0, 45.0, 38.0, 67.0, 49.0, 2.0, 21.0, 47.0, 39.0, 38.0, 31.0, 28.0, 36.0, 49.0, 58.0, 317.0, 44.0, 81.0, 100.0, 65.0, 87.0, 91.0, 79.0, 0.0, 90.0, 0.0, 269.0, 63.0, 51.0, 4.0, 71.0, 46.0, 5.0, 0.0, 14.0, 5.0, 26.0, 29.0, 15.0, 0.0, 0.0, 23.0, 1.0, 19.0, 13.0, 0.0, 0.0, 31.0, 18.0, 29.0, 0.0, 71.0, 65.0, 0.0, 37.0, 44.0, 1.0, 13.0, 288.0, 33.0, 2.0, 38.0, 0.0, 41.0, 58.0, 30.0, 0.0, 16.0, 25.0, 12.0, 186.0, 36.0, 35.0, 0.0, 14.0, 26.0, 0.0, 3.0, 14.0, 21.0, 26.0, 17.0, 7.0, 25.0, 48.0, 1.0, 13.0, 16.0, 28.0, 0.0, 0.0, 8.0, 0.0, 0.0, 19.0, 12.0, 7.0, 12.0, 26.0, 34.0, 18.0, 12.0, 0.0, 7.0, 21.0, 18.0, 16.0, 20.0, 23.0, 27.0, 26.0, 6.0, 3.0, 129.0, 32.0, 57.0, 0.0, 29.0, 21.0, 66.0, 86.0, 3.0, 0.0, 15.0, 4.0, 7.0, 1.0, 0.0, 8.0, 375.0, 0.0, 0.0, 0.0, 83.0, 58.0, 8.0, 1.0, 0.0, 0.0, 0.0, 46.0, 2.0, 10.0, 0.0, 0.0, 13.0, 9.0, 29.0, 25.0, 12.0, 2.0, 99.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 2.0, 0.0, 0.0, 5.0, 4.0, 17.0, 35.0, 9.0, 25.0, 364.0, 0.0, 1.0, 0.0, 57.0, 0.0, 0.0, 0.0, 31.0, 2.0, 8.0, 5.0, 21.0, 59.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6587188196645083, "mean_inference_ms": 1.6058589321713868, "mean_action_processing_ms": 0.2580708605599351, "mean_env_wait_ms": 0.19987202441208962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007628917694091797, "StateBufferConnector_ms": 0.006618499755859375, "ViewRequirementAgentConnector_ms": 0.11266911029815674}, "num_episodes": 18, "episode_return_max": 175.0, "episode_return_min": -435.0, "episode_return_mean": -23.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.88099192423626, "num_env_steps_trained_throughput_per_sec": 76.88099192423626, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 53159.085, "restore_workers_time_ms": 0.029, "training_step_time_ms": 53158.915, "sample_time_ms": 1447.298, "learn_time_ms": 51687.583, "learn_throughput": 77.388, "synch_weights_time_ms": 18.11}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-18-02", "timestamp": 1723519082, "time_this_iter_s": 52.06088089942932, "time_total_s": 1658.247281074524, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7ffcb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1658.247281074524, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 36.93513513513514, "ram_util_percent": 82.96756756756757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.013173296274962, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3254065450537142, "policy_loss": -0.007866998701159245, "vf_loss": 3.3318384342092684, "vf_explained_var": 0.09379239880218708, "kl": 0.006378233516007599, "entropy": 1.1326250757805254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.35275532341508, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.028497976222366, "policy_loss": -0.010677873239009863, "vf_loss": 5.037694130751191, "vf_explained_var": 0.10391810482771939, "kl": 0.009878189873662636, "entropy": 1.3617743732437255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 209.0, "episode_reward_min": -339.0, "episode_reward_mean": 5.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -500.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 375.0}, "policy_reward_mean": {"prey_policy": -21.815, "predator_policy": 24.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, 0.0, -15.0, -6.0, 0.0, 94.0, -5.0, -43.0, 40.0, -33.0, -210.0, -26.0, -15.0, -21.0, -7.0, -10.0, -31.0, -30.0, 2.0, 7.0, -17.0, 73.0, -8.0, -11.0, 16.0, -41.0, 0.0, -8.0, 2.0, 7.0, -27.0, -12.0, -5.0, -20.0, 40.0, 19.0, -5.0, -9.0, -327.0, 85.0, -42.0, 75.0, -5.0, -8.0, -6.0, 157.0, -125.0, 0.0, -13.0, 156.0, 0.0, -52.0, -8.0, 72.0, 175.0, 24.0, 13.0, -99.0, 148.0, -17.0, -2.0, 0.0, -3.0, -16.0, 121.0, -94.0, -1.0, -74.0, 0.0, -16.0, 146.0, -36.0, 0.0, 0.0, -73.0, -28.0, 65.0, 187.0, 0.0, -11.0, -12.0, -91.0, 30.0, -339.0, -169.0, 54.0, -27.0, 175.0, 185.0, 166.0, 20.0, -21.0, 133.0, -111.0, 128.0, 0.0, 0.0, 133.0, 209.0, 78.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -55.0, 0.0, 0.0, -47.0, 8.0, 0.0, -38.0, 0.0, 0.0, 45.0, 0.0, -16.0, -18.0, -126.0, -53.0, 16.0, -13.0, 4.0, -82.0, -149.0, -362.0, 0.0, -61.0, 0.0, -53.0, 0.0, -120.0, -21.0, -16.0, -16.0, -35.0, -30.0, -199.0, -36.0, -65.0, -12.0, 0.0, -28.0, 9.0, 0.0, -34.0, 20.0, 6.0, -32.0, 0.0, -26.0, -58.0, 0.0, 2.0, -34.0, -51.0, 0.0, 0.0, 0.0, -16.0, -2.0, -15.0, -2.0, -10.0, -61.0, -4.0, -21.0, -43.0, -17.0, 0.0, -20.0, -28.0, 0.0, 6.0, 7.0, -31.0, -29.0, -29.0, 0.0, -18.0, -260.0, -228.0, 33.0, -5.0, -50.0, -42.0, -94.0, 17.0, -6.0, -2.0, -9.0, -18.0, -14.0, 0.0, 0.0, 149.0, -500.0, 0.0, 0.0, 0.0, -127.0, -27.0, 0.0, 147.0, 0.0, 0.0, -9.0, -89.0, -4.0, -16.0, 72.0, 0.0, -16.0, 169.0, -45.0, 15.0, -1.0, 0.0, -198.0, 0.0, 0.0, 148.0, -34.0, 0.0, -4.0, 0.0, 0.0, 0.0, -12.0, 0.0, -68.0, 0.0, 105.0, -18.0, -442.0, -16.0, -2.0, 0.0, -35.0, -96.0, 0.0, 0.0, 0.0, -49.0, 128.0, 5.0, -116.0, 0.0, 0.0, 0.0, 0.0, 0.0, -156.0, 0.0, -80.0, -47.0, -2.0, -1.0, 180.0, 6.0, 0.0, 0.0, 0.0, -22.0, -102.0, -50.0, -218.0, -6.0, 0.0, 26.0, -234.0, -224.0, -14.0, -324.0, -30.0, 58.0, 3.0, -60.0, 0.0, 171.0, 0.0, 184.0, 0.0, 166.0, -15.0, 1.0, -16.0, -14.0, 170.0, -85.0, -81.0, -152.0, 141.0, -26.0, 0.0, 0.0, 0.0, 0.0, 104.0, -12.0, -7.0, 181.0, 92.0, -95.0], "policy_predator_policy_reward": [29.0, 15.0, 0.0, 0.0, 23.0, 1.0, 19.0, 13.0, 0.0, 0.0, 31.0, 18.0, 29.0, 0.0, 71.0, 65.0, 0.0, 37.0, 44.0, 1.0, 13.0, 288.0, 33.0, 2.0, 38.0, 0.0, 41.0, 58.0, 30.0, 0.0, 16.0, 25.0, 12.0, 186.0, 36.0, 35.0, 0.0, 14.0, 26.0, 0.0, 3.0, 14.0, 21.0, 26.0, 17.0, 7.0, 25.0, 48.0, 1.0, 13.0, 16.0, 28.0, 0.0, 0.0, 8.0, 0.0, 0.0, 19.0, 12.0, 7.0, 12.0, 26.0, 34.0, 18.0, 12.0, 0.0, 7.0, 21.0, 18.0, 16.0, 20.0, 23.0, 27.0, 26.0, 6.0, 3.0, 129.0, 32.0, 57.0, 0.0, 29.0, 21.0, 66.0, 86.0, 3.0, 0.0, 15.0, 4.0, 7.0, 1.0, 0.0, 8.0, 375.0, 0.0, 0.0, 0.0, 83.0, 58.0, 8.0, 1.0, 0.0, 0.0, 0.0, 46.0, 2.0, 10.0, 0.0, 0.0, 13.0, 9.0, 29.0, 25.0, 12.0, 2.0, 99.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 2.0, 0.0, 0.0, 5.0, 4.0, 17.0, 35.0, 9.0, 25.0, 364.0, 0.0, 1.0, 0.0, 57.0, 0.0, 0.0, 0.0, 31.0, 2.0, 8.0, 5.0, 21.0, 59.0, 0.0, 0.0, 0.0, 0.0, 81.0, 2.0, 60.0, 39.0, 42.0, 26.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 63.0, 77.0, 60.0, 73.0, 0.0, 4.0, 0.0, 119.0, 7.0, 162.0, 13.0, 13.0, 30.0, 0.0, 4.0, 0.0, 0.0, 1.0, 0.0, 0.0, 19.0, 15.0, 9.0, 0.0, 48.0, 0.0, 120.0, 2.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 27.0, 0.0, 35.0, 39.0, 42.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6597227451334152, "mean_inference_ms": 1.6372709729751418, "mean_action_processing_ms": 0.2579931479593263, "mean_env_wait_ms": 0.19969249974126047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052869319915771484, "StateBufferConnector_ms": 0.006784796714782715, "ViewRequirementAgentConnector_ms": 0.11289858818054199}, "num_episodes": 27, "episode_return_max": 209.0, "episode_return_min": -339.0, "episode_return_mean": 5.83, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.44367396589631, "num_env_steps_trained_throughput_per_sec": 77.44367396589631, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 53022.344, "restore_workers_time_ms": 0.028, "training_step_time_ms": 53022.155, "sample_time_ms": 1448.584, "learn_time_ms": 51550.127, "learn_throughput": 77.594, "synch_weights_time_ms": 17.922}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-18-53", "timestamp": 1723519133, "time_this_iter_s": 51.702430963516235, "time_total_s": 1709.9497120380402, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1709.9497120380402, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 36.28493150684932, "ram_util_percent": 82.59452054794521}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.453956657364255, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4662916942879005, "policy_loss": -0.004739381749153374, "vf_loss": 1.4700746351133578, "vf_explained_var": 0.09254208185054638, "kl": 0.004250866648493607, "entropy": 1.2174012790281306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.441503735320278, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.785628912688563, "policy_loss": -0.012876125733816513, "vf_loss": 3.795954461829372, "vf_explained_var": 0.25376554210349994, "kl": 0.017003867594157493, "entropy": 1.4007236331858963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 299.0, "episode_reward_min": -339.0, "episode_reward_mean": 22.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -500.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 375.0}, "policy_reward_mean": {"prey_policy": -11.25, "predator_policy": 22.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 7.0, -17.0, 73.0, -8.0, -11.0, 16.0, -41.0, 0.0, -8.0, 2.0, 7.0, -27.0, -12.0, -5.0, -20.0, 40.0, 19.0, -5.0, -9.0, -327.0, 85.0, -42.0, 75.0, -5.0, -8.0, -6.0, 157.0, -125.0, 0.0, -13.0, 156.0, 0.0, -52.0, -8.0, 72.0, 175.0, 24.0, 13.0, -99.0, 148.0, -17.0, -2.0, 0.0, -3.0, -16.0, 121.0, -94.0, -1.0, -74.0, 0.0, -16.0, 146.0, -36.0, 0.0, 0.0, -73.0, -28.0, 65.0, 187.0, 0.0, -11.0, -12.0, -91.0, 30.0, -339.0, -169.0, 54.0, -27.0, 175.0, 185.0, 166.0, 20.0, -21.0, 133.0, -111.0, 128.0, 0.0, 0.0, 133.0, 209.0, 78.0, 122.0, 119.0, 95.0, -10.0, 13.0, 299.0, 9.0, 140.0, -4.0, 0.0, 83.0, 166.0, -4.0, 0.0, -41.0, 169.0, 224.0, -70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, 0.0, -28.0, 9.0, 0.0, -34.0, 20.0, 6.0, -32.0, 0.0, -26.0, -58.0, 0.0, 2.0, -34.0, -51.0, 0.0, 0.0, 0.0, -16.0, -2.0, -15.0, -2.0, -10.0, -61.0, -4.0, -21.0, -43.0, -17.0, 0.0, -20.0, -28.0, 0.0, 6.0, 7.0, -31.0, -29.0, -29.0, 0.0, -18.0, -260.0, -228.0, 33.0, -5.0, -50.0, -42.0, -94.0, 17.0, -6.0, -2.0, -9.0, -18.0, -14.0, 0.0, 0.0, 149.0, -500.0, 0.0, 0.0, 0.0, -127.0, -27.0, 0.0, 147.0, 0.0, 0.0, -9.0, -89.0, -4.0, -16.0, 72.0, 0.0, -16.0, 169.0, -45.0, 15.0, -1.0, 0.0, -198.0, 0.0, 0.0, 148.0, -34.0, 0.0, -4.0, 0.0, 0.0, 0.0, -12.0, 0.0, -68.0, 0.0, 105.0, -18.0, -442.0, -16.0, -2.0, 0.0, -35.0, -96.0, 0.0, 0.0, 0.0, -49.0, 128.0, 5.0, -116.0, 0.0, 0.0, 0.0, 0.0, 0.0, -156.0, 0.0, -80.0, -47.0, -2.0, -1.0, 180.0, 6.0, 0.0, 0.0, 0.0, -22.0, -102.0, -50.0, -218.0, -6.0, 0.0, 26.0, -234.0, -224.0, -14.0, -324.0, -30.0, 58.0, 3.0, -60.0, 0.0, 171.0, 0.0, 184.0, 0.0, 166.0, -15.0, 1.0, -16.0, -14.0, 170.0, -85.0, -81.0, -152.0, 141.0, -26.0, 0.0, 0.0, 0.0, 0.0, 104.0, -12.0, -7.0, 181.0, 92.0, -95.0, 132.0, -106.0, -8.0, 82.0, 130.0, -90.0, -20.0, 0.0, 183.0, -357.0, 153.0, 116.0, -8.0, 0.0, 140.0, 0.0, 0.0, -18.0, 0.0, 0.0, 73.0, -36.0, 39.0, 127.0, 3.0, -14.0, 0.0, 0.0, 0.0, -86.0, 168.0, 0.0, -49.0, 186.0, -40.0, -125.0], "policy_predator_policy_reward": [0.0, 14.0, 26.0, 0.0, 3.0, 14.0, 21.0, 26.0, 17.0, 7.0, 25.0, 48.0, 1.0, 13.0, 16.0, 28.0, 0.0, 0.0, 8.0, 0.0, 0.0, 19.0, 12.0, 7.0, 12.0, 26.0, 34.0, 18.0, 12.0, 0.0, 7.0, 21.0, 18.0, 16.0, 20.0, 23.0, 27.0, 26.0, 6.0, 3.0, 129.0, 32.0, 57.0, 0.0, 29.0, 21.0, 66.0, 86.0, 3.0, 0.0, 15.0, 4.0, 7.0, 1.0, 0.0, 8.0, 375.0, 0.0, 0.0, 0.0, 83.0, 58.0, 8.0, 1.0, 0.0, 0.0, 0.0, 46.0, 2.0, 10.0, 0.0, 0.0, 13.0, 9.0, 29.0, 25.0, 12.0, 2.0, 99.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 2.0, 0.0, 0.0, 5.0, 4.0, 17.0, 35.0, 9.0, 25.0, 364.0, 0.0, 1.0, 0.0, 57.0, 0.0, 0.0, 0.0, 31.0, 2.0, 8.0, 5.0, 21.0, 59.0, 0.0, 0.0, 0.0, 0.0, 81.0, 2.0, 60.0, 39.0, 42.0, 26.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 63.0, 77.0, 60.0, 73.0, 0.0, 4.0, 0.0, 119.0, 7.0, 162.0, 13.0, 13.0, 30.0, 0.0, 4.0, 0.0, 0.0, 1.0, 0.0, 0.0, 19.0, 15.0, 9.0, 0.0, 48.0, 0.0, 120.0, 2.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 27.0, 0.0, 35.0, 39.0, 42.0, 43.0, 53.0, 38.0, 7.0, 10.0, 45.0, 9.0, 1.0, 171.0, 16.0, 25.0, 5.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 39.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 45.0, 1.0, 0.0, 45.0, 42.0, 33.0, 62.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6585709072514271, "mean_inference_ms": 1.6330326899929375, "mean_action_processing_ms": 0.2580266940232804, "mean_env_wait_ms": 0.19936175795369138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003802061080932617, "StateBufferConnector_ms": 0.005875945091247559, "ViewRequirementAgentConnector_ms": 0.10988616943359375}, "num_episodes": 18, "episode_return_max": 299.0, "episode_return_min": -339.0, "episode_return_mean": 22.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.64272340510527, "num_env_steps_trained_throughput_per_sec": 77.64272340510527, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 52667.371, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52667.182, "sample_time_ms": 1431.476, "learn_time_ms": 51212.312, "learn_throughput": 78.106, "synch_weights_time_ms": 17.872}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-19-45", "timestamp": 1723519185, "time_this_iter_s": 51.57065224647522, "time_total_s": 1761.5203642845154, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8031af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1761.5203642845154, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 35.85479452054795, "ram_util_percent": 83.18767123287672}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.230790574966915, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3053180787298415, "policy_loss": -0.009311468048740631, "vf_loss": 2.3134077734417384, "vf_explained_var": 0.1150060445858688, "kl": 0.0108601572150111, "entropy": 1.230611108156739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.2565424371964085, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.554958741374747, "policy_loss": -0.014856465007104571, "vf_loss": 5.56660055811443, "vf_explained_var": 0.26941726422183726, "kl": 0.021431000157443342, "entropy": 1.4203099108877637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 341.0, "episode_reward_min": -496.0, "episode_reward_mean": 35.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -500.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 375.0}, "policy_reward_mean": {"prey_policy": -5.11, "predator_policy": 22.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -9.0, -327.0, 85.0, -42.0, 75.0, -5.0, -8.0, -6.0, 157.0, -125.0, 0.0, -13.0, 156.0, 0.0, -52.0, -8.0, 72.0, 175.0, 24.0, 13.0, -99.0, 148.0, -17.0, -2.0, 0.0, -3.0, -16.0, 121.0, -94.0, -1.0, -74.0, 0.0, -16.0, 146.0, -36.0, 0.0, 0.0, -73.0, -28.0, 65.0, 187.0, 0.0, -11.0, -12.0, -91.0, 30.0, -339.0, -169.0, 54.0, -27.0, 175.0, 185.0, 166.0, 20.0, -21.0, 133.0, -111.0, 128.0, 0.0, 0.0, 133.0, 209.0, 78.0, 122.0, 119.0, 95.0, -10.0, 13.0, 299.0, 9.0, 140.0, -4.0, 0.0, 83.0, 166.0, -4.0, 0.0, -41.0, 169.0, 224.0, -70.0, 3.0, -496.0, 29.0, 59.0, 86.0, 341.0, 266.0, 123.0, 11.0, 279.0, 173.0, 133.0, 0.0, 190.0, 0.0, 137.0, -2.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.0, -29.0, 0.0, -18.0, -260.0, -228.0, 33.0, -5.0, -50.0, -42.0, -94.0, 17.0, -6.0, -2.0, -9.0, -18.0, -14.0, 0.0, 0.0, 149.0, -500.0, 0.0, 0.0, 0.0, -127.0, -27.0, 0.0, 147.0, 0.0, 0.0, -9.0, -89.0, -4.0, -16.0, 72.0, 0.0, -16.0, 169.0, -45.0, 15.0, -1.0, 0.0, -198.0, 0.0, 0.0, 148.0, -34.0, 0.0, -4.0, 0.0, 0.0, 0.0, -12.0, 0.0, -68.0, 0.0, 105.0, -18.0, -442.0, -16.0, -2.0, 0.0, -35.0, -96.0, 0.0, 0.0, 0.0, -49.0, 128.0, 5.0, -116.0, 0.0, 0.0, 0.0, 0.0, 0.0, -156.0, 0.0, -80.0, -47.0, -2.0, -1.0, 180.0, 6.0, 0.0, 0.0, 0.0, -22.0, -102.0, -50.0, -218.0, -6.0, 0.0, 26.0, -234.0, -224.0, -14.0, -324.0, -30.0, 58.0, 3.0, -60.0, 0.0, 171.0, 0.0, 184.0, 0.0, 166.0, -15.0, 1.0, -16.0, -14.0, 170.0, -85.0, -81.0, -152.0, 141.0, -26.0, 0.0, 0.0, 0.0, 0.0, 104.0, -12.0, -7.0, 181.0, 92.0, -95.0, 132.0, -106.0, -8.0, 82.0, 130.0, -90.0, -20.0, 0.0, 183.0, -357.0, 153.0, 116.0, -8.0, 0.0, 140.0, 0.0, 0.0, -18.0, 0.0, 0.0, 73.0, -36.0, 39.0, 127.0, 3.0, -14.0, 0.0, 0.0, 0.0, -86.0, 168.0, 0.0, -49.0, 186.0, -40.0, -125.0, -8.0, 0.0, -376.0, -310.0, 6.0, 13.0, -184.0, 149.0, 155.0, -138.0, 169.0, 156.0, 177.0, 5.0, 118.0, 0.0, 11.0, 0.0, 66.0, 161.0, 173.0, 0.0, 111.0, -12.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 153.0, -38.0, 0.0, -4.0, 0.0, -10.0], "policy_predator_policy_reward": [27.0, 26.0, 6.0, 3.0, 129.0, 32.0, 57.0, 0.0, 29.0, 21.0, 66.0, 86.0, 3.0, 0.0, 15.0, 4.0, 7.0, 1.0, 0.0, 8.0, 375.0, 0.0, 0.0, 0.0, 83.0, 58.0, 8.0, 1.0, 0.0, 0.0, 0.0, 46.0, 2.0, 10.0, 0.0, 0.0, 13.0, 9.0, 29.0, 25.0, 12.0, 2.0, 99.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 2.0, 0.0, 0.0, 5.0, 4.0, 17.0, 35.0, 9.0, 25.0, 364.0, 0.0, 1.0, 0.0, 57.0, 0.0, 0.0, 0.0, 31.0, 2.0, 8.0, 5.0, 21.0, 59.0, 0.0, 0.0, 0.0, 0.0, 81.0, 2.0, 60.0, 39.0, 42.0, 26.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 63.0, 77.0, 60.0, 73.0, 0.0, 4.0, 0.0, 119.0, 7.0, 162.0, 13.0, 13.0, 30.0, 0.0, 4.0, 0.0, 0.0, 1.0, 0.0, 0.0, 19.0, 15.0, 9.0, 0.0, 48.0, 0.0, 120.0, 2.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 27.0, 0.0, 35.0, 39.0, 42.0, 43.0, 53.0, 38.0, 7.0, 10.0, 45.0, 9.0, 1.0, 171.0, 16.0, 25.0, 5.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 39.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 45.0, 1.0, 0.0, 45.0, 42.0, 33.0, 62.0, 6.0, 5.0, 188.0, 2.0, 2.0, 8.0, 2.0, 92.0, 0.0, 69.0, 2.0, 14.0, 39.0, 45.0, 0.0, 5.0, 0.0, 0.0, 16.0, 36.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.658461077585987, "mean_inference_ms": 1.628747903720194, "mean_action_processing_ms": 0.2580145287880384, "mean_env_wait_ms": 0.199170007371252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003832221031188965, "StateBufferConnector_ms": 0.005954742431640625, "ViewRequirementAgentConnector_ms": 0.11245059967041016}, "num_episodes": 18, "episode_return_max": 341.0, "episode_return_min": -496.0, "episode_return_mean": 35.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.53159744248443, "num_env_steps_trained_throughput_per_sec": 76.53159744248443, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 52484.567, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52484.358, "sample_time_ms": 1436.727, "learn_time_ms": 51024.015, "learn_throughput": 78.394, "synch_weights_time_ms": 18.194}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-20-37", "timestamp": 1723519237, "time_this_iter_s": 52.291895151138306, "time_total_s": 1813.8122594356537, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1813.8122594356537, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 38.18266666666666, "ram_util_percent": 82.92133333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6352623390142247, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.624662632538528, "policy_loss": -0.011431751519481026, "vf_loss": 2.6347173070781444, "vf_explained_var": 0.11593423539368564, "kl": 0.012240688610030113, "entropy": 1.1756636230087785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7597616948778665, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.553228454236631, "policy_loss": -0.013418244075020232, "vf_loss": 5.564562607063818, "vf_explained_var": 0.31964591050904895, "kl": 0.00926262429311542, "entropy": 1.3987555094496913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 341.0, "episode_reward_min": -496.0, "episode_reward_mean": 52.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -442.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 364.0}, "policy_reward_mean": {"prey_policy": 3.19, "predator_policy": 22.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.0, 24.0, 13.0, -99.0, 148.0, -17.0, -2.0, 0.0, -3.0, -16.0, 121.0, -94.0, -1.0, -74.0, 0.0, -16.0, 146.0, -36.0, 0.0, 0.0, -73.0, -28.0, 65.0, 187.0, 0.0, -11.0, -12.0, -91.0, 30.0, -339.0, -169.0, 54.0, -27.0, 175.0, 185.0, 166.0, 20.0, -21.0, 133.0, -111.0, 128.0, 0.0, 0.0, 133.0, 209.0, 78.0, 122.0, 119.0, 95.0, -10.0, 13.0, 299.0, 9.0, 140.0, -4.0, 0.0, 83.0, 166.0, -4.0, 0.0, -41.0, 169.0, 224.0, -70.0, 3.0, -496.0, 29.0, 59.0, 86.0, 341.0, 266.0, 123.0, 11.0, 279.0, 173.0, 133.0, 0.0, 190.0, 0.0, 137.0, -2.0, -5.0, 149.0, 154.0, -213.0, 171.0, 170.0, -156.0, 68.0, 73.0, 123.0, 315.0, 74.0, 149.0, -83.0, -47.0, 258.0, 36.0, 209.0, 197.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, 169.0, -45.0, 15.0, -1.0, 0.0, -198.0, 0.0, 0.0, 148.0, -34.0, 0.0, -4.0, 0.0, 0.0, 0.0, -12.0, 0.0, -68.0, 0.0, 105.0, -18.0, -442.0, -16.0, -2.0, 0.0, -35.0, -96.0, 0.0, 0.0, 0.0, -49.0, 128.0, 5.0, -116.0, 0.0, 0.0, 0.0, 0.0, 0.0, -156.0, 0.0, -80.0, -47.0, -2.0, -1.0, 180.0, 6.0, 0.0, 0.0, 0.0, -22.0, -102.0, -50.0, -218.0, -6.0, 0.0, 26.0, -234.0, -224.0, -14.0, -324.0, -30.0, 58.0, 3.0, -60.0, 0.0, 171.0, 0.0, 184.0, 0.0, 166.0, -15.0, 1.0, -16.0, -14.0, 170.0, -85.0, -81.0, -152.0, 141.0, -26.0, 0.0, 0.0, 0.0, 0.0, 104.0, -12.0, -7.0, 181.0, 92.0, -95.0, 132.0, -106.0, -8.0, 82.0, 130.0, -90.0, -20.0, 0.0, 183.0, -357.0, 153.0, 116.0, -8.0, 0.0, 140.0, 0.0, 0.0, -18.0, 0.0, 0.0, 73.0, -36.0, 39.0, 127.0, 3.0, -14.0, 0.0, 0.0, 0.0, -86.0, 168.0, 0.0, -49.0, 186.0, -40.0, -125.0, -8.0, 0.0, -376.0, -310.0, 6.0, 13.0, -184.0, 149.0, 155.0, -138.0, 169.0, 156.0, 177.0, 5.0, 118.0, 0.0, 11.0, 0.0, 66.0, 161.0, 173.0, 0.0, 111.0, -12.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 153.0, -38.0, 0.0, -4.0, 0.0, -10.0, 0.0, 131.0, -86.0, 129.0, -292.0, -102.0, 161.0, 0.0, 164.0, 0.0, -96.0, -180.0, -130.0, 104.0, -204.0, 171.0, 85.0, 0.0, 152.0, 146.0, 1.0, -12.0, 150.0, -2.0, -180.0, -30.0, 0.0, -94.0, 92.0, 125.0, 0.0, -45.0, 24.0, 123.0, 197.0, 0.0], "policy_predator_policy_reward": [13.0, 9.0, 29.0, 25.0, 12.0, 2.0, 99.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 2.0, 0.0, 0.0, 5.0, 4.0, 17.0, 35.0, 9.0, 25.0, 364.0, 0.0, 1.0, 0.0, 57.0, 0.0, 0.0, 0.0, 31.0, 2.0, 8.0, 5.0, 21.0, 59.0, 0.0, 0.0, 0.0, 0.0, 81.0, 2.0, 60.0, 39.0, 42.0, 26.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 63.0, 77.0, 60.0, 73.0, 0.0, 4.0, 0.0, 119.0, 7.0, 162.0, 13.0, 13.0, 30.0, 0.0, 4.0, 0.0, 0.0, 1.0, 0.0, 0.0, 19.0, 15.0, 9.0, 0.0, 48.0, 0.0, 120.0, 2.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 27.0, 0.0, 35.0, 39.0, 42.0, 43.0, 53.0, 38.0, 7.0, 10.0, 45.0, 9.0, 1.0, 171.0, 16.0, 25.0, 5.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 39.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 45.0, 1.0, 0.0, 45.0, 42.0, 33.0, 62.0, 6.0, 5.0, 188.0, 2.0, 2.0, 8.0, 2.0, 92.0, 0.0, 69.0, 2.0, 14.0, 39.0, 45.0, 0.0, 5.0, 0.0, 0.0, 16.0, 36.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 5.0, 1.0, 17.0, 16.0, 95.0, 167.0, 14.0, 10.0, 0.0, 6.0, 0.0, 48.0, 72.0, 43.0, 51.0, 106.0, 0.0, 21.0, 17.0, 0.0, 17.0, 28.0, 57.0, 1.0, 0.0, 120.0, 7.0, 5.0, 42.0, 36.0, 5.0, 0.0, 81.0, 29.0, 33.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6592092416049613, "mean_inference_ms": 1.625501543181835, "mean_action_processing_ms": 0.2580884130882288, "mean_env_wait_ms": 0.19910994983267258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004289507865905762, "StateBufferConnector_ms": 0.0056934356689453125, "ViewRequirementAgentConnector_ms": 0.11681246757507324}, "num_episodes": 18, "episode_return_max": 341.0, "episode_return_min": -496.0, "episode_return_mean": 52.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.25914372551237, "num_env_steps_trained_throughput_per_sec": 77.25914372551237, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 52116.711, "restore_workers_time_ms": 0.02, "training_step_time_ms": 52116.503, "sample_time_ms": 1461.131, "learn_time_ms": 50631.666, "learn_throughput": 79.002, "synch_weights_time_ms": 18.29}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-21-29", "timestamp": 1723519289, "time_this_iter_s": 51.790027141571045, "time_total_s": 1865.6022865772247, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7ffc700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1865.6022865772247, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 36.12054794520547, "ram_util_percent": 82.88356164383562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.838909327479267, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7965345195361546, "policy_loss": -0.010526376729461526, "vf_loss": 1.806037458824733, "vf_explained_var": 0.08547716213281824, "kl": 0.009097244523820111, "entropy": 1.1441780470666432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.0022562980967225, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.752109227861677, "policy_loss": -0.01360724732247748, "vf_loss": 5.7631368415065545, "vf_explained_var": 0.575654069014958, "kl": 0.01146493436493666, "entropy": 1.3586273846172152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -496.0, "episode_reward_mean": 77.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 17.105, "predator_policy": 21.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 187.0, 0.0, -11.0, -12.0, -91.0, 30.0, -339.0, -169.0, 54.0, -27.0, 175.0, 185.0, 166.0, 20.0, -21.0, 133.0, -111.0, 128.0, 0.0, 0.0, 133.0, 209.0, 78.0, 122.0, 119.0, 95.0, -10.0, 13.0, 299.0, 9.0, 140.0, -4.0, 0.0, 83.0, 166.0, -4.0, 0.0, -41.0, 169.0, 224.0, -70.0, 3.0, -496.0, 29.0, 59.0, 86.0, 341.0, 266.0, 123.0, 11.0, 279.0, 173.0, 133.0, 0.0, 190.0, 0.0, 137.0, -2.0, -5.0, 149.0, 154.0, -213.0, 171.0, 170.0, -156.0, 68.0, 73.0, 123.0, 315.0, 74.0, 149.0, -83.0, -47.0, 258.0, 36.0, 209.0, 197.0, -49.0, 164.0, 169.0, 108.0, 0.0, 106.0, 43.0, 257.0, -19.0, 36.0, 161.0, 181.0, 359.0, 348.0, 140.0, 195.0, 0.0, 158.0, -120.0, 81.0, 33.0, 288.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -1.0, 180.0, 6.0, 0.0, 0.0, 0.0, -22.0, -102.0, -50.0, -218.0, -6.0, 0.0, 26.0, -234.0, -224.0, -14.0, -324.0, -30.0, 58.0, 3.0, -60.0, 0.0, 171.0, 0.0, 184.0, 0.0, 166.0, -15.0, 1.0, -16.0, -14.0, 170.0, -85.0, -81.0, -152.0, 141.0, -26.0, 0.0, 0.0, 0.0, 0.0, 104.0, -12.0, -7.0, 181.0, 92.0, -95.0, 132.0, -106.0, -8.0, 82.0, 130.0, -90.0, -20.0, 0.0, 183.0, -357.0, 153.0, 116.0, -8.0, 0.0, 140.0, 0.0, 0.0, -18.0, 0.0, 0.0, 73.0, -36.0, 39.0, 127.0, 3.0, -14.0, 0.0, 0.0, 0.0, -86.0, 168.0, 0.0, -49.0, 186.0, -40.0, -125.0, -8.0, 0.0, -376.0, -310.0, 6.0, 13.0, -184.0, 149.0, 155.0, -138.0, 169.0, 156.0, 177.0, 5.0, 118.0, 0.0, 11.0, 0.0, 66.0, 161.0, 173.0, 0.0, 111.0, -12.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 153.0, -38.0, 0.0, -4.0, 0.0, -10.0, 0.0, 131.0, -86.0, 129.0, -292.0, -102.0, 161.0, 0.0, 164.0, 0.0, -96.0, -180.0, -130.0, 104.0, -204.0, 171.0, 85.0, 0.0, 152.0, 146.0, 1.0, -12.0, 150.0, -2.0, -180.0, -30.0, 0.0, -94.0, 92.0, 125.0, 0.0, -45.0, 24.0, 123.0, 197.0, 0.0, 0.0, -98.0, 149.0, 0.0, -54.0, 196.0, 47.0, 0.0, 0.0, 0.0, 162.0, -154.0, 41.0, -2.0, 93.0, 114.0, 0.0, -38.0, 24.0, 0.0, -54.0, 184.0, -2.0, 176.0, 190.0, 165.0, 163.0, 176.0, 54.0, -41.0, 195.0, 0.0, 0.0, 0.0, 2.0, 156.0, -63.0, -147.0, -110.0, 107.0, -10.0, 30.0, 196.0, 71.0], "policy_predator_policy_reward": [42.0, 26.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 63.0, 77.0, 60.0, 73.0, 0.0, 4.0, 0.0, 119.0, 7.0, 162.0, 13.0, 13.0, 30.0, 0.0, 4.0, 0.0, 0.0, 1.0, 0.0, 0.0, 19.0, 15.0, 9.0, 0.0, 48.0, 0.0, 120.0, 2.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 27.0, 0.0, 35.0, 39.0, 42.0, 43.0, 53.0, 38.0, 7.0, 10.0, 45.0, 9.0, 1.0, 171.0, 16.0, 25.0, 5.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 39.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 45.0, 1.0, 0.0, 45.0, 42.0, 33.0, 62.0, 6.0, 5.0, 188.0, 2.0, 2.0, 8.0, 2.0, 92.0, 0.0, 69.0, 2.0, 14.0, 39.0, 45.0, 0.0, 5.0, 0.0, 0.0, 16.0, 36.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 5.0, 1.0, 17.0, 16.0, 95.0, 167.0, 14.0, 10.0, 0.0, 6.0, 0.0, 48.0, 72.0, 43.0, 51.0, 106.0, 0.0, 21.0, 17.0, 0.0, 17.0, 28.0, 57.0, 1.0, 0.0, 120.0, 7.0, 5.0, 42.0, 36.0, 5.0, 0.0, 81.0, 29.0, 33.0, 0.0, 0.0, 0.0, 49.0, 0.0, 15.0, 27.0, 0.0, 20.0, 41.0, 0.0, 0.0, 89.0, 9.0, 4.0, 0.0, 12.0, 38.0, 13.0, 6.0, 12.0, 0.0, 24.0, 7.0, 7.0, 0.0, 4.0, 0.0, 1.0, 8.0, 95.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 68.0, 29.0, 55.0, 0.0, 13.0, 0.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6599295481361205, "mean_inference_ms": 1.6197596241752006, "mean_action_processing_ms": 0.2580047093118864, "mean_env_wait_ms": 0.19905810295310533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234910011291504, "StateBufferConnector_ms": 0.0032906532287597656, "ViewRequirementAgentConnector_ms": 0.11367917060852051}, "num_episodes": 22, "episode_return_max": 359.0, "episode_return_min": -496.0, "episode_return_mean": 77.05, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.44794930769456, "num_env_steps_trained_throughput_per_sec": 77.44794930769456, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 52089.245, "restore_workers_time_ms": 0.02, "training_step_time_ms": 52089.037, "sample_time_ms": 1459.273, "learn_time_ms": 50606.589, "learn_throughput": 79.041, "synch_weights_time_ms": 17.824}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-22-21", "timestamp": 1723519341, "time_this_iter_s": 51.67464208602905, "time_total_s": 1917.2769286632538, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80b5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1917.2769286632538, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.851351351351354, "ram_util_percent": 83.04594594594595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.634700615633102, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3018102301807, "policy_loss": -0.006657597109448736, "vf_loss": 1.3077343755140507, "vf_explained_var": 0.07128975457615322, "kl": 0.006519528539756436, "entropy": 1.0598441628867357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.96750961977338, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.953091745275669, "policy_loss": -0.012777138305655508, "vf_loss": 5.963556898964776, "vf_explained_var": 0.596278117258082, "kl": 0.010275405167264216, "entropy": 1.3568123022084513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -496.0, "episode_reward_mean": 108.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 34.575, "predator_policy": 19.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.0, 122.0, 119.0, 95.0, -10.0, 13.0, 299.0, 9.0, 140.0, -4.0, 0.0, 83.0, 166.0, -4.0, 0.0, -41.0, 169.0, 224.0, -70.0, 3.0, -496.0, 29.0, 59.0, 86.0, 341.0, 266.0, 123.0, 11.0, 279.0, 173.0, 133.0, 0.0, 190.0, 0.0, 137.0, -2.0, -5.0, 149.0, 154.0, -213.0, 171.0, 170.0, -156.0, 68.0, 73.0, 123.0, 315.0, 74.0, 149.0, -83.0, -47.0, 258.0, 36.0, 209.0, 197.0, -49.0, 164.0, 169.0, 108.0, 0.0, 106.0, 43.0, 257.0, -19.0, 36.0, 161.0, 181.0, 359.0, 348.0, 140.0, 195.0, 0.0, 158.0, -120.0, 81.0, 33.0, 288.0, 160.0, 176.0, 188.0, 199.0, -31.0, 184.0, -65.0, 193.0, 194.0, -107.0, 179.0, -17.0, 352.0, 283.0, 134.0, 0.0, 329.0, 145.0, 372.0, 357.0, 271.0, 326.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [92.0, -95.0, 132.0, -106.0, -8.0, 82.0, 130.0, -90.0, -20.0, 0.0, 183.0, -357.0, 153.0, 116.0, -8.0, 0.0, 140.0, 0.0, 0.0, -18.0, 0.0, 0.0, 73.0, -36.0, 39.0, 127.0, 3.0, -14.0, 0.0, 0.0, 0.0, -86.0, 168.0, 0.0, -49.0, 186.0, -40.0, -125.0, -8.0, 0.0, -376.0, -310.0, 6.0, 13.0, -184.0, 149.0, 155.0, -138.0, 169.0, 156.0, 177.0, 5.0, 118.0, 0.0, 11.0, 0.0, 66.0, 161.0, 173.0, 0.0, 111.0, -12.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 153.0, -38.0, 0.0, -4.0, 0.0, -10.0, 0.0, 131.0, -86.0, 129.0, -292.0, -102.0, 161.0, 0.0, 164.0, 0.0, -96.0, -180.0, -130.0, 104.0, -204.0, 171.0, 85.0, 0.0, 152.0, 146.0, 1.0, -12.0, 150.0, -2.0, -180.0, -30.0, 0.0, -94.0, 92.0, 125.0, 0.0, -45.0, 24.0, 123.0, 197.0, 0.0, 0.0, -98.0, 149.0, 0.0, -54.0, 196.0, 47.0, 0.0, 0.0, 0.0, 162.0, -154.0, 41.0, -2.0, 93.0, 114.0, 0.0, -38.0, 24.0, 0.0, -54.0, 184.0, -2.0, 176.0, 190.0, 165.0, 163.0, 176.0, 54.0, -41.0, 195.0, 0.0, 0.0, 0.0, 2.0, 156.0, -63.0, -147.0, -110.0, 107.0, -10.0, 30.0, 196.0, 71.0, 143.0, 0.0, 0.0, 168.0, 14.0, 162.0, 0.0, 199.0, 0.0, -62.0, -6.0, 183.0, -137.0, 0.0, 192.0, 0.0, 0.0, 192.0, -118.0, -114.0, 173.0, 0.0, -42.0, 4.0, 172.0, 180.0, 127.0, 126.0, -78.0, 171.0, 0.0, 0.0, 166.0, 144.0, -152.0, 195.0, 198.0, 161.0, 161.0, 181.0, 105.0, 160.0, 154.0, 160.0, 80.0, -172.0], "policy_predator_policy_reward": [39.0, 42.0, 43.0, 53.0, 38.0, 7.0, 10.0, 45.0, 9.0, 1.0, 171.0, 16.0, 25.0, 5.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 39.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 45.0, 1.0, 0.0, 45.0, 42.0, 33.0, 62.0, 6.0, 5.0, 188.0, 2.0, 2.0, 8.0, 2.0, 92.0, 0.0, 69.0, 2.0, 14.0, 39.0, 45.0, 0.0, 5.0, 0.0, 0.0, 16.0, 36.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 5.0, 1.0, 17.0, 16.0, 95.0, 167.0, 14.0, 10.0, 0.0, 6.0, 0.0, 48.0, 72.0, 43.0, 51.0, 106.0, 0.0, 21.0, 17.0, 0.0, 17.0, 28.0, 57.0, 1.0, 0.0, 120.0, 7.0, 5.0, 42.0, 36.0, 5.0, 0.0, 81.0, 29.0, 33.0, 0.0, 0.0, 0.0, 49.0, 0.0, 15.0, 27.0, 0.0, 20.0, 41.0, 0.0, 0.0, 89.0, 9.0, 4.0, 0.0, 12.0, 38.0, 13.0, 6.0, 12.0, 0.0, 24.0, 7.0, 7.0, 0.0, 4.0, 0.0, 1.0, 8.0, 95.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 68.0, 29.0, 55.0, 0.0, 13.0, 0.0, 21.0, 0.0, 17.0, 8.0, 0.0, 11.0, 1.0, 0.0, 0.0, 28.0, 3.0, 0.0, 7.0, 68.0, 4.0, 1.0, 0.0, 0.0, 2.0, 109.0, 16.0, 6.0, 0.0, 21.0, 0.0, 0.0, 0.0, 30.0, 0.0, 2.0, 39.0, 0.0, 0.0, 0.0, 19.0, 78.0, 24.0, 0.0, 13.0, 0.0, 15.0, 0.0, 6.0, 12.0, 0.0, 58.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6608869019937089, "mean_inference_ms": 1.6163727223759443, "mean_action_processing_ms": 0.2581050347988926, "mean_env_wait_ms": 0.19894847003847005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003973722457885742, "StateBufferConnector_ms": 0.0031572580337524414, "ViewRequirementAgentConnector_ms": 0.11130762100219727}, "num_episodes": 23, "episode_return_max": 372.0, "episode_return_min": -496.0, "episode_return_mean": 108.19, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.23113275819829, "num_env_steps_trained_throughput_per_sec": 77.23113275819829, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 52064.652, "restore_workers_time_ms": 0.02, "training_step_time_ms": 52064.485, "sample_time_ms": 1457.45, "learn_time_ms": 50584.952, "learn_throughput": 79.075, "synch_weights_time_ms": 17.468}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-23-13", "timestamp": 1723519393, "time_this_iter_s": 51.83663511276245, "time_total_s": 1969.1135637760162, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80ae0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1969.1135637760162, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 36.4068493150685, "ram_util_percent": 83.26849315068492}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.617909748592074, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1124766394417123, "policy_loss": -0.007914706134414744, "vf_loss": 1.1193030969333397, "vf_explained_var": 0.0861855237256913, "kl": 0.009673314420956845, "entropy": 1.123050285457934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.529062696676405, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8626248654865085, "policy_loss": -0.010021483818951146, "vf_loss": 6.8709929047438205, "vf_explained_var": 0.6884574105499913, "kl": 0.007348685070402945, "entropy": 1.3229685147603354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -496.0, "episode_reward_mean": 133.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 49.285, "predator_policy": 17.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, 3.0, -496.0, 29.0, 59.0, 86.0, 341.0, 266.0, 123.0, 11.0, 279.0, 173.0, 133.0, 0.0, 190.0, 0.0, 137.0, -2.0, -5.0, 149.0, 154.0, -213.0, 171.0, 170.0, -156.0, 68.0, 73.0, 123.0, 315.0, 74.0, 149.0, -83.0, -47.0, 258.0, 36.0, 209.0, 197.0, -49.0, 164.0, 169.0, 108.0, 0.0, 106.0, 43.0, 257.0, -19.0, 36.0, 161.0, 181.0, 359.0, 348.0, 140.0, 195.0, 0.0, 158.0, -120.0, 81.0, 33.0, 288.0, 160.0, 176.0, 188.0, 199.0, -31.0, 184.0, -65.0, 193.0, 194.0, -107.0, 179.0, -17.0, 352.0, 283.0, 134.0, 0.0, 329.0, 145.0, 372.0, 357.0, 271.0, 326.0, -4.0, 129.0, 138.0, 177.0, 289.0, 193.0, 212.0, 198.0, 188.0, 364.0, 315.0, 229.0, 0.0, 147.0, 393.0, 164.0, 384.0, 314.0, 180.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.0, -125.0, -8.0, 0.0, -376.0, -310.0, 6.0, 13.0, -184.0, 149.0, 155.0, -138.0, 169.0, 156.0, 177.0, 5.0, 118.0, 0.0, 11.0, 0.0, 66.0, 161.0, 173.0, 0.0, 111.0, -12.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 153.0, -38.0, 0.0, -4.0, 0.0, -10.0, 0.0, 131.0, -86.0, 129.0, -292.0, -102.0, 161.0, 0.0, 164.0, 0.0, -96.0, -180.0, -130.0, 104.0, -204.0, 171.0, 85.0, 0.0, 152.0, 146.0, 1.0, -12.0, 150.0, -2.0, -180.0, -30.0, 0.0, -94.0, 92.0, 125.0, 0.0, -45.0, 24.0, 123.0, 197.0, 0.0, 0.0, -98.0, 149.0, 0.0, -54.0, 196.0, 47.0, 0.0, 0.0, 0.0, 162.0, -154.0, 41.0, -2.0, 93.0, 114.0, 0.0, -38.0, 24.0, 0.0, -54.0, 184.0, -2.0, 176.0, 190.0, 165.0, 163.0, 176.0, 54.0, -41.0, 195.0, 0.0, 0.0, 0.0, 2.0, 156.0, -63.0, -147.0, -110.0, 107.0, -10.0, 30.0, 196.0, 71.0, 143.0, 0.0, 0.0, 168.0, 14.0, 162.0, 0.0, 199.0, 0.0, -62.0, -6.0, 183.0, -137.0, 0.0, 192.0, 0.0, 0.0, 192.0, -118.0, -114.0, 173.0, 0.0, -42.0, 4.0, 172.0, 180.0, 127.0, 126.0, -78.0, 171.0, 0.0, 0.0, 166.0, 144.0, -152.0, 195.0, 198.0, 161.0, 161.0, 181.0, 105.0, 160.0, 154.0, 160.0, 80.0, -172.0, -47.0, 147.0, 0.0, 138.0, 0.0, 177.0, 114.0, 146.0, -6.0, 195.0, 32.0, 135.0, 0.0, 198.0, 184.0, 0.0, 170.0, 194.0, 89.0, 192.0, 126.0, 2.0, 0.0, 0.0, -82.0, 186.0, 198.0, 195.0, -60.0, 194.0, 199.0, 185.0, 185.0, 125.0, 168.0, 0.0], "policy_predator_policy_reward": [33.0, 62.0, 6.0, 5.0, 188.0, 2.0, 2.0, 8.0, 2.0, 92.0, 0.0, 69.0, 2.0, 14.0, 39.0, 45.0, 0.0, 5.0, 0.0, 0.0, 16.0, 36.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 5.0, 1.0, 17.0, 16.0, 95.0, 167.0, 14.0, 10.0, 0.0, 6.0, 0.0, 48.0, 72.0, 43.0, 51.0, 106.0, 0.0, 21.0, 17.0, 0.0, 17.0, 28.0, 57.0, 1.0, 0.0, 120.0, 7.0, 5.0, 42.0, 36.0, 5.0, 0.0, 81.0, 29.0, 33.0, 0.0, 0.0, 0.0, 49.0, 0.0, 15.0, 27.0, 0.0, 20.0, 41.0, 0.0, 0.0, 89.0, 9.0, 4.0, 0.0, 12.0, 38.0, 13.0, 6.0, 12.0, 0.0, 24.0, 7.0, 7.0, 0.0, 4.0, 0.0, 1.0, 8.0, 95.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 68.0, 29.0, 55.0, 0.0, 13.0, 0.0, 21.0, 0.0, 17.0, 8.0, 0.0, 11.0, 1.0, 0.0, 0.0, 28.0, 3.0, 0.0, 7.0, 68.0, 4.0, 1.0, 0.0, 0.0, 2.0, 109.0, 16.0, 6.0, 0.0, 21.0, 0.0, 0.0, 0.0, 30.0, 0.0, 2.0, 39.0, 0.0, 0.0, 0.0, 19.0, 78.0, 24.0, 0.0, 13.0, 0.0, 15.0, 0.0, 6.0, 12.0, 0.0, 58.0, 30.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 17.0, 12.0, 0.0, 4.0, 45.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 34.0, 62.0, 39.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6612132898558842, "mean_inference_ms": 1.6128068289843558, "mean_action_processing_ms": 0.2579803580236606, "mean_env_wait_ms": 0.19880204089311854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004103541374206543, "StateBufferConnector_ms": 0.0031703710556030273, "ViewRequirementAgentConnector_ms": 0.11069226264953613}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -496.0, "episode_return_mean": 133.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.97397725329867, "num_env_steps_trained_throughput_per_sec": 77.97397725329867, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 51823.92, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51823.749, "sample_time_ms": 1246.628, "learn_time_ms": 50555.306, "learn_throughput": 79.121, "synch_weights_time_ms": 17.764}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-24-04", "timestamp": 1723519444, "time_this_iter_s": 51.34725499153137, "time_total_s": 2020.4608187675476, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8095280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2020.4608187675476, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 35.61917808219179, "ram_util_percent": 82.58356164383562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.303176548430528, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.339030172269811, "policy_loss": -0.012422812939251935, "vf_loss": 1.350134594383694, "vf_explained_var": 0.1663700325148446, "kl": 0.011718998594818114, "entropy": 1.2222243917051447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.927641361667996, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.699561103941902, "policy_loss": -0.009032351730967916, "vf_loss": 7.7068600248407435, "vf_explained_var": 0.5679999963947074, "kl": 0.0077041550056022165, "entropy": 1.3137359137888307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -213.0, "episode_reward_mean": 165.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -292.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": 65.745, "predator_policy": 17.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 149.0, 154.0, -213.0, 171.0, 170.0, -156.0, 68.0, 73.0, 123.0, 315.0, 74.0, 149.0, -83.0, -47.0, 258.0, 36.0, 209.0, 197.0, -49.0, 164.0, 169.0, 108.0, 0.0, 106.0, 43.0, 257.0, -19.0, 36.0, 161.0, 181.0, 359.0, 348.0, 140.0, 195.0, 0.0, 158.0, -120.0, 81.0, 33.0, 288.0, 160.0, 176.0, 188.0, 199.0, -31.0, 184.0, -65.0, 193.0, 194.0, -107.0, 179.0, -17.0, 352.0, 283.0, 134.0, 0.0, 329.0, 145.0, 372.0, 357.0, 271.0, 326.0, -4.0, 129.0, 138.0, 177.0, 289.0, 193.0, 212.0, 198.0, 188.0, 364.0, 315.0, 229.0, 0.0, 147.0, 393.0, 164.0, 384.0, 314.0, 180.0, 260.0, 176.0, 151.0, 105.0, -106.0, 295.0, 223.0, 65.0, 278.0, 283.0, 392.0, 359.0, 186.0, 302.0, 386.0, 362.0, 383.0, 365.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -10.0, 0.0, 131.0, -86.0, 129.0, -292.0, -102.0, 161.0, 0.0, 164.0, 0.0, -96.0, -180.0, -130.0, 104.0, -204.0, 171.0, 85.0, 0.0, 152.0, 146.0, 1.0, -12.0, 150.0, -2.0, -180.0, -30.0, 0.0, -94.0, 92.0, 125.0, 0.0, -45.0, 24.0, 123.0, 197.0, 0.0, 0.0, -98.0, 149.0, 0.0, -54.0, 196.0, 47.0, 0.0, 0.0, 0.0, 162.0, -154.0, 41.0, -2.0, 93.0, 114.0, 0.0, -38.0, 24.0, 0.0, -54.0, 184.0, -2.0, 176.0, 190.0, 165.0, 163.0, 176.0, 54.0, -41.0, 195.0, 0.0, 0.0, 0.0, 2.0, 156.0, -63.0, -147.0, -110.0, 107.0, -10.0, 30.0, 196.0, 71.0, 143.0, 0.0, 0.0, 168.0, 14.0, 162.0, 0.0, 199.0, 0.0, -62.0, -6.0, 183.0, -137.0, 0.0, 192.0, 0.0, 0.0, 192.0, -118.0, -114.0, 173.0, 0.0, -42.0, 4.0, 172.0, 180.0, 127.0, 126.0, -78.0, 171.0, 0.0, 0.0, 166.0, 144.0, -152.0, 195.0, 198.0, 161.0, 161.0, 181.0, 105.0, 160.0, 154.0, 160.0, 80.0, -172.0, -47.0, 147.0, 0.0, 138.0, 0.0, 177.0, 114.0, 146.0, -6.0, 195.0, 32.0, 135.0, 0.0, 198.0, 184.0, 0.0, 170.0, 194.0, 89.0, 192.0, 126.0, 2.0, 0.0, 0.0, -82.0, 186.0, 198.0, 195.0, -60.0, 194.0, 199.0, 185.0, 185.0, 125.0, 168.0, 0.0, 193.0, 67.0, 70.0, 4.0, 129.0, 0.0, 0.0, 53.0, -100.0, -112.0, 147.0, 120.0, 67.0, 137.0, -1.0, 61.0, 198.0, 18.0, 133.0, 122.0, 198.0, 194.0, 199.0, 142.0, -119.0, 194.0, 150.0, 124.0, 194.0, 192.0, 191.0, 171.0, 189.0, 191.0, 192.0, 162.0], "policy_predator_policy_reward": [0.0, 5.0, 1.0, 17.0, 16.0, 95.0, 167.0, 14.0, 10.0, 0.0, 6.0, 0.0, 48.0, 72.0, 43.0, 51.0, 106.0, 0.0, 21.0, 17.0, 0.0, 17.0, 28.0, 57.0, 1.0, 0.0, 120.0, 7.0, 5.0, 42.0, 36.0, 5.0, 0.0, 81.0, 29.0, 33.0, 0.0, 0.0, 0.0, 49.0, 0.0, 15.0, 27.0, 0.0, 20.0, 41.0, 0.0, 0.0, 89.0, 9.0, 4.0, 0.0, 12.0, 38.0, 13.0, 6.0, 12.0, 0.0, 24.0, 7.0, 7.0, 0.0, 4.0, 0.0, 1.0, 8.0, 95.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 68.0, 29.0, 55.0, 0.0, 13.0, 0.0, 21.0, 0.0, 17.0, 8.0, 0.0, 11.0, 1.0, 0.0, 0.0, 28.0, 3.0, 0.0, 7.0, 68.0, 4.0, 1.0, 0.0, 0.0, 2.0, 109.0, 16.0, 6.0, 0.0, 21.0, 0.0, 0.0, 0.0, 30.0, 0.0, 2.0, 39.0, 0.0, 0.0, 0.0, 19.0, 78.0, 24.0, 0.0, 13.0, 0.0, 15.0, 0.0, 6.0, 12.0, 0.0, 58.0, 30.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 17.0, 12.0, 0.0, 4.0, 45.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 34.0, 62.0, 39.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 8.0, 0.0, 0.0, 35.0, 67.0, 0.0, 22.0, 15.0, 37.0, 0.0, 106.0, 28.0, 0.0, 0.0, 19.0, 5.0, 0.0, 24.0, 38.0, 0.0, 28.0, 0.0, 0.0, 3.0, 15.0, 13.0, 98.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6613527304583584, "mean_inference_ms": 1.6088932979047093, "mean_action_processing_ms": 0.2577871530956803, "mean_env_wait_ms": 0.19858981888334332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040209293365478516, "StateBufferConnector_ms": 0.0030449628829956055, "ViewRequirementAgentConnector_ms": 0.10384845733642578}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -213.0, "episode_return_mean": 165.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.13861452467715, "num_env_steps_trained_throughput_per_sec": 78.13861452467715, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 51745.853, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51745.681, "sample_time_ms": 1241.878, "learn_time_ms": 50481.65, "learn_throughput": 79.237, "synch_weights_time_ms": 18.199}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-24-55", "timestamp": 1723519495, "time_this_iter_s": 51.239246129989624, "time_total_s": 2071.7000648975372, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a806e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2071.7000648975372, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 35.3068493150685, "ram_util_percent": 82.6972602739726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.695250153352344, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5910157667265998, "policy_loss": -0.01694488862046489, "vf_loss": 1.6065573270043367, "vf_explained_var": 0.16695843632259066, "kl": 0.012474017479182569, "entropy": 1.2028361333110344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.020347475500964, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.108216904080103, "policy_loss": -0.012171614818797303, "vf_loss": 6.11791401868144, "vf_explained_var": 0.48978669974539013, "kl": 0.010997836147496389, "entropy": 1.3279259989501306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -120.0, "episode_reward_mean": 185.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -172.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 109.0}, "policy_reward_mean": {"prey_policy": 77.995, "predator_policy": 14.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.0, 0.0, 106.0, 43.0, 257.0, -19.0, 36.0, 161.0, 181.0, 359.0, 348.0, 140.0, 195.0, 0.0, 158.0, -120.0, 81.0, 33.0, 288.0, 160.0, 176.0, 188.0, 199.0, -31.0, 184.0, -65.0, 193.0, 194.0, -107.0, 179.0, -17.0, 352.0, 283.0, 134.0, 0.0, 329.0, 145.0, 372.0, 357.0, 271.0, 326.0, -4.0, 129.0, 138.0, 177.0, 289.0, 193.0, 212.0, 198.0, 188.0, 364.0, 315.0, 229.0, 0.0, 147.0, 393.0, 164.0, 384.0, 314.0, 180.0, 260.0, 176.0, 151.0, 105.0, -106.0, 295.0, 223.0, 65.0, 278.0, 283.0, 392.0, 359.0, 186.0, 302.0, 386.0, 362.0, 383.0, 365.0, 338.0, 175.0, 4.0, 232.0, 194.0, 390.0, 346.0, 82.0, 99.0, 183.0, 85.0, 0.0, 333.0, 167.0, -9.0, 116.0, 302.0, 106.0, 68.0, 185.0, 225.0, 309.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [47.0, 0.0, 0.0, 0.0, 162.0, -154.0, 41.0, -2.0, 93.0, 114.0, 0.0, -38.0, 24.0, 0.0, -54.0, 184.0, -2.0, 176.0, 190.0, 165.0, 163.0, 176.0, 54.0, -41.0, 195.0, 0.0, 0.0, 0.0, 2.0, 156.0, -63.0, -147.0, -110.0, 107.0, -10.0, 30.0, 196.0, 71.0, 143.0, 0.0, 0.0, 168.0, 14.0, 162.0, 0.0, 199.0, 0.0, -62.0, -6.0, 183.0, -137.0, 0.0, 192.0, 0.0, 0.0, 192.0, -118.0, -114.0, 173.0, 0.0, -42.0, 4.0, 172.0, 180.0, 127.0, 126.0, -78.0, 171.0, 0.0, 0.0, 166.0, 144.0, -152.0, 195.0, 198.0, 161.0, 161.0, 181.0, 105.0, 160.0, 154.0, 160.0, 80.0, -172.0, -47.0, 147.0, 0.0, 138.0, 0.0, 177.0, 114.0, 146.0, -6.0, 195.0, 32.0, 135.0, 0.0, 198.0, 184.0, 0.0, 170.0, 194.0, 89.0, 192.0, 126.0, 2.0, 0.0, 0.0, -82.0, 186.0, 198.0, 195.0, -60.0, 194.0, 199.0, 185.0, 185.0, 125.0, 168.0, 0.0, 193.0, 67.0, 70.0, 4.0, 129.0, 0.0, 0.0, 53.0, -100.0, -112.0, 147.0, 120.0, 67.0, 137.0, -1.0, 61.0, 198.0, 18.0, 133.0, 122.0, 198.0, 194.0, 199.0, 142.0, -119.0, 194.0, 150.0, 124.0, 194.0, 192.0, 191.0, 171.0, 189.0, 191.0, 192.0, 162.0, 169.0, 131.0, 0.0, 173.0, -70.0, -15.0, 113.0, 89.0, 23.0, 110.0, 192.0, 196.0, 180.0, 144.0, 0.0, 14.0, -31.0, 52.0, 0.0, 177.0, 85.0, 0.0, 0.0, 0.0, 125.0, 194.0, 160.0, 0.0, -90.0, -24.0, -2.0, 71.0, 149.0, 132.0, 11.0, -10.0, 48.0, -2.0, 199.0, -28.0, 126.0, 63.0, 89.0, 192.0], "policy_predator_policy_reward": [20.0, 41.0, 0.0, 0.0, 89.0, 9.0, 4.0, 0.0, 12.0, 38.0, 13.0, 6.0, 12.0, 0.0, 24.0, 7.0, 7.0, 0.0, 4.0, 0.0, 1.0, 8.0, 95.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 68.0, 29.0, 55.0, 0.0, 13.0, 0.0, 21.0, 0.0, 17.0, 8.0, 0.0, 11.0, 1.0, 0.0, 0.0, 28.0, 3.0, 0.0, 7.0, 68.0, 4.0, 1.0, 0.0, 0.0, 2.0, 109.0, 16.0, 6.0, 0.0, 21.0, 0.0, 0.0, 0.0, 30.0, 0.0, 2.0, 39.0, 0.0, 0.0, 0.0, 19.0, 78.0, 24.0, 0.0, 13.0, 0.0, 15.0, 0.0, 6.0, 12.0, 0.0, 58.0, 30.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 17.0, 12.0, 0.0, 4.0, 45.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 34.0, 62.0, 39.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 8.0, 0.0, 0.0, 35.0, 67.0, 0.0, 22.0, 15.0, 37.0, 0.0, 106.0, 28.0, 0.0, 0.0, 19.0, 5.0, 0.0, 24.0, 38.0, 0.0, 28.0, 0.0, 0.0, 3.0, 15.0, 13.0, 98.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 2.0, 25.0, 13.0, 2.0, 0.0, 0.0, 89.0, 0.0, 30.0, 0.0, 61.0, 0.0, 2.0, 22.0, 0.0, 49.0, 19.0, 19.0, 59.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 7.0, 9.0, 96.0, 24.0, 23.0, 21.0, 0.0, 32.0, 73.0, 5.0, 17.0, 14.0, 0.0, 23.0, 13.0, 0.0, 28.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6602179982862059, "mean_inference_ms": 1.6017691698546026, "mean_action_processing_ms": 0.2572978176293325, "mean_env_wait_ms": 0.19811615604698596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035916566848754883, "StateBufferConnector_ms": 0.003089308738708496, "ViewRequirementAgentConnector_ms": 0.09488868713378906}, "num_episodes": 22, "episode_return_max": 393.0, "episode_return_min": -120.0, "episode_return_mean": 185.82, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.1953927021385, "num_env_steps_trained_throughput_per_sec": 78.1953927021385, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 51632.116, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51632.009, "sample_time_ms": 1232.302, "learn_time_ms": 50381.246, "learn_throughput": 79.395, "synch_weights_time_ms": 14.191}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-25-47", "timestamp": 1723519547, "time_this_iter_s": 51.19148373603821, "time_total_s": 2122.8915486335754, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80aeca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2122.8915486335754, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.5625, "ram_util_percent": 82.99166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.841787963380258, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1880756587578505, "policy_loss": -0.015414684488088208, "vf_loss": 4.201944646507344, "vf_explained_var": 0.15805176502813106, "kl": 0.013739595138833108, "entropy": 1.289462078689898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.929342169168764, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.32151187437552, "policy_loss": -0.010596019797219289, "vf_loss": 6.33029667662565, "vf_explained_var": -0.02372022747362732, "kl": 0.008049921226559977, "entropy": 1.3465741703749965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -442.0, "episode_reward_mean": 169.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 187.0}, "policy_reward_mean": {"prey_policy": 65.415, "predator_policy": 19.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.0, 184.0, -65.0, 193.0, 194.0, -107.0, 179.0, -17.0, 352.0, 283.0, 134.0, 0.0, 329.0, 145.0, 372.0, 357.0, 271.0, 326.0, -4.0, 129.0, 138.0, 177.0, 289.0, 193.0, 212.0, 198.0, 188.0, 364.0, 315.0, 229.0, 0.0, 147.0, 393.0, 164.0, 384.0, 314.0, 180.0, 260.0, 176.0, 151.0, 105.0, -106.0, 295.0, 223.0, 65.0, 278.0, 283.0, 392.0, 359.0, 186.0, 302.0, 386.0, 362.0, 383.0, 365.0, 338.0, 175.0, 4.0, 232.0, 194.0, 390.0, 346.0, 82.0, 99.0, 183.0, 85.0, 0.0, 333.0, 167.0, -9.0, 116.0, 302.0, 106.0, 68.0, 185.0, 225.0, 309.0, 0.0, -50.0, -442.0, 84.0, -107.0, 75.0, 36.0, 329.0, 163.0, 279.0, -188.0, 167.0, 156.0, 1.0, 378.0, 222.0, 146.0, 330.0, -89.0, -108.0, 330.0, 82.0, -362.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -62.0, -6.0, 183.0, -137.0, 0.0, 192.0, 0.0, 0.0, 192.0, -118.0, -114.0, 173.0, 0.0, -42.0, 4.0, 172.0, 180.0, 127.0, 126.0, -78.0, 171.0, 0.0, 0.0, 166.0, 144.0, -152.0, 195.0, 198.0, 161.0, 161.0, 181.0, 105.0, 160.0, 154.0, 160.0, 80.0, -172.0, -47.0, 147.0, 0.0, 138.0, 0.0, 177.0, 114.0, 146.0, -6.0, 195.0, 32.0, 135.0, 0.0, 198.0, 184.0, 0.0, 170.0, 194.0, 89.0, 192.0, 126.0, 2.0, 0.0, 0.0, -82.0, 186.0, 198.0, 195.0, -60.0, 194.0, 199.0, 185.0, 185.0, 125.0, 168.0, 0.0, 193.0, 67.0, 70.0, 4.0, 129.0, 0.0, 0.0, 53.0, -100.0, -112.0, 147.0, 120.0, 67.0, 137.0, -1.0, 61.0, 198.0, 18.0, 133.0, 122.0, 198.0, 194.0, 199.0, 142.0, -119.0, 194.0, 150.0, 124.0, 194.0, 192.0, 191.0, 171.0, 189.0, 191.0, 192.0, 162.0, 169.0, 131.0, 0.0, 173.0, -70.0, -15.0, 113.0, 89.0, 23.0, 110.0, 192.0, 196.0, 180.0, 144.0, 0.0, 14.0, -31.0, 52.0, 0.0, 177.0, 85.0, 0.0, 0.0, 0.0, 125.0, 194.0, 160.0, 0.0, -90.0, -24.0, -2.0, 71.0, 149.0, 132.0, 11.0, -10.0, 48.0, -2.0, 199.0, -28.0, 126.0, 63.0, 89.0, 192.0, 0.0, 0.0, -28.0, -44.0, -310.0, -319.0, 83.0, -70.0, -147.0, -105.0, 0.0, 25.0, -48.0, 0.0, 158.0, 154.0, 145.0, 0.0, 143.0, 116.0, -167.0, -162.0, 151.0, 0.0, 25.0, 61.0, -97.0, 0.0, 179.0, 193.0, 39.0, 150.0, 133.0, 0.0, 169.0, 148.0, -94.0, -48.0, -149.0, -163.0, 136.0, 175.0, 28.0, 0.0, -311.0, -254.0], "policy_predator_policy_reward": [28.0, 3.0, 0.0, 7.0, 68.0, 4.0, 1.0, 0.0, 0.0, 2.0, 109.0, 16.0, 6.0, 0.0, 21.0, 0.0, 0.0, 0.0, 30.0, 0.0, 2.0, 39.0, 0.0, 0.0, 0.0, 19.0, 78.0, 24.0, 0.0, 13.0, 0.0, 15.0, 0.0, 6.0, 12.0, 0.0, 58.0, 30.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 17.0, 12.0, 0.0, 4.0, 45.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 34.0, 62.0, 39.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 8.0, 0.0, 0.0, 35.0, 67.0, 0.0, 22.0, 15.0, 37.0, 0.0, 106.0, 28.0, 0.0, 0.0, 19.0, 5.0, 0.0, 24.0, 38.0, 0.0, 28.0, 0.0, 0.0, 3.0, 15.0, 13.0, 98.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 2.0, 25.0, 13.0, 2.0, 0.0, 0.0, 89.0, 0.0, 30.0, 0.0, 61.0, 0.0, 2.0, 22.0, 0.0, 49.0, 19.0, 19.0, 59.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 7.0, 9.0, 96.0, 24.0, 23.0, 21.0, 0.0, 32.0, 73.0, 5.0, 17.0, 14.0, 0.0, 23.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 22.0, 187.0, 0.0, 35.0, 36.0, 45.0, 100.0, 50.0, 0.0, 74.0, 10.0, 0.0, 17.0, 18.0, 0.0, 3.0, 17.0, 23.0, 118.0, 16.0, 0.0, 22.0, 48.0, 0.0, 98.0, 6.0, 0.0, 23.0, 10.0, 0.0, 13.0, 13.0, 0.0, 53.0, 0.0, 121.0, 83.0, 0.0, 19.0, 0.0, 54.0, 172.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6604771666182141, "mean_inference_ms": 1.598519915365251, "mean_action_processing_ms": 0.25701168814166664, "mean_env_wait_ms": 0.19796194847055182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003765583038330078, "StateBufferConnector_ms": 0.0032262802124023438, "ViewRequirementAgentConnector_ms": 0.10715091228485107}, "num_episodes": 23, "episode_return_max": 393.0, "episode_return_min": -442.0, "episode_return_mean": 169.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.84306957556183, "num_env_steps_trained_throughput_per_sec": 77.84306957556183, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 51567.813, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51567.698, "sample_time_ms": 1237.813, "learn_time_ms": 50310.799, "learn_throughput": 79.506, "synch_weights_time_ms": 14.493}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-26-38", "timestamp": 1723519598, "time_this_iter_s": 51.40526795387268, "time_total_s": 2174.296816587448, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80b5af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2174.296816587448, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 35.88219178082191, "ram_util_percent": 82.91917808219179}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.607509050356648, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8681279429682975, "policy_loss": -0.017242779839345346, "vf_loss": 6.8827417144068965, "vf_explained_var": 0.16399360538790467, "kl": 0.02336905050238668, "entropy": 1.265541539368806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.079873548897486, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.81165422787742, "policy_loss": -0.00962930851512485, "vf_loss": 8.819171823774065, "vf_explained_var": -0.31932723049133543, "kl": 0.009385460148701681, "entropy": 1.2877770251697964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -442.0, "episode_reward_mean": 101.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -383.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 17.95, "predator_policy": 32.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 129.0, 138.0, 177.0, 289.0, 193.0, 212.0, 198.0, 188.0, 364.0, 315.0, 229.0, 0.0, 147.0, 393.0, 164.0, 384.0, 314.0, 180.0, 260.0, 176.0, 151.0, 105.0, -106.0, 295.0, 223.0, 65.0, 278.0, 283.0, 392.0, 359.0, 186.0, 302.0, 386.0, 362.0, 383.0, 365.0, 338.0, 175.0, 4.0, 232.0, 194.0, 390.0, 346.0, 82.0, 99.0, 183.0, 85.0, 0.0, 333.0, 167.0, -9.0, 116.0, 302.0, 106.0, 68.0, 185.0, 225.0, 309.0, 0.0, -50.0, -442.0, 84.0, -107.0, 75.0, 36.0, 329.0, 163.0, 279.0, -188.0, 167.0, 156.0, 1.0, 378.0, 222.0, 146.0, 330.0, -89.0, -108.0, 330.0, 82.0, -362.0, 24.0, -78.0, -76.0, 111.0, -346.0, -109.0, -69.0, -169.0, -340.0, -429.0, -244.0, 42.0, -424.0, -369.0, -386.0, 46.0, -438.0, -404.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [80.0, -172.0, -47.0, 147.0, 0.0, 138.0, 0.0, 177.0, 114.0, 146.0, -6.0, 195.0, 32.0, 135.0, 0.0, 198.0, 184.0, 0.0, 170.0, 194.0, 89.0, 192.0, 126.0, 2.0, 0.0, 0.0, -82.0, 186.0, 198.0, 195.0, -60.0, 194.0, 199.0, 185.0, 185.0, 125.0, 168.0, 0.0, 193.0, 67.0, 70.0, 4.0, 129.0, 0.0, 0.0, 53.0, -100.0, -112.0, 147.0, 120.0, 67.0, 137.0, -1.0, 61.0, 198.0, 18.0, 133.0, 122.0, 198.0, 194.0, 199.0, 142.0, -119.0, 194.0, 150.0, 124.0, 194.0, 192.0, 191.0, 171.0, 189.0, 191.0, 192.0, 162.0, 169.0, 131.0, 0.0, 173.0, -70.0, -15.0, 113.0, 89.0, 23.0, 110.0, 192.0, 196.0, 180.0, 144.0, 0.0, 14.0, -31.0, 52.0, 0.0, 177.0, 85.0, 0.0, 0.0, 0.0, 125.0, 194.0, 160.0, 0.0, -90.0, -24.0, -2.0, 71.0, 149.0, 132.0, 11.0, -10.0, 48.0, -2.0, 199.0, -28.0, 126.0, 63.0, 89.0, 192.0, 0.0, 0.0, -28.0, -44.0, -310.0, -319.0, 83.0, -70.0, -147.0, -105.0, 0.0, 25.0, -48.0, 0.0, 158.0, 154.0, 145.0, 0.0, 143.0, 116.0, -167.0, -162.0, 151.0, 0.0, 25.0, 61.0, -97.0, 0.0, 179.0, 193.0, 39.0, 150.0, 133.0, 0.0, 169.0, 148.0, -94.0, -48.0, -149.0, -163.0, 136.0, 175.0, 28.0, 0.0, -311.0, -254.0, -148.0, 0.0, -111.0, -90.0, -247.0, 0.0, 24.0, 13.0, -258.0, -289.0, -305.0, 0.0, -89.0, -79.0, -93.0, -207.0, -383.0, -192.0, -304.0, -305.0, -241.0, -220.0, -101.0, 42.0, -317.0, -305.0, -382.0, -363.0, -357.0, -321.0, -35.0, 0.0, -341.0, -317.0, -293.0, -283.0], "policy_predator_policy_reward": [58.0, 30.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 17.0, 12.0, 0.0, 4.0, 45.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 34.0, 62.0, 39.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 8.0, 0.0, 0.0, 35.0, 67.0, 0.0, 22.0, 15.0, 37.0, 0.0, 106.0, 28.0, 0.0, 0.0, 19.0, 5.0, 0.0, 24.0, 38.0, 0.0, 28.0, 0.0, 0.0, 3.0, 15.0, 13.0, 98.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 2.0, 25.0, 13.0, 2.0, 0.0, 0.0, 89.0, 0.0, 30.0, 0.0, 61.0, 0.0, 2.0, 22.0, 0.0, 49.0, 19.0, 19.0, 59.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 7.0, 9.0, 96.0, 24.0, 23.0, 21.0, 0.0, 32.0, 73.0, 5.0, 17.0, 14.0, 0.0, 23.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 22.0, 187.0, 0.0, 35.0, 36.0, 45.0, 100.0, 50.0, 0.0, 74.0, 10.0, 0.0, 17.0, 18.0, 0.0, 3.0, 17.0, 23.0, 118.0, 16.0, 0.0, 22.0, 48.0, 0.0, 98.0, 6.0, 0.0, 23.0, 10.0, 0.0, 13.0, 13.0, 0.0, 53.0, 0.0, 121.0, 83.0, 0.0, 19.0, 0.0, 54.0, 172.0, 31.0, 65.0, 107.0, 118.0, 5.0, 124.0, 47.0, 74.0, 0.0, 76.0, 125.0, 161.0, 35.0, 99.0, 0.0, 25.0, 106.0, 184.0, 51.0, 0.0, 180.0, 76.0, 141.0, 101.0, 0.0, 182.0, 16.0, 187.0, 189.0, 127.0, 165.0, 4.0, 77.0, 132.0, 88.0, 168.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6597473658700937, "mean_inference_ms": 1.5965281822834254, "mean_action_processing_ms": 0.2569753634135743, "mean_env_wait_ms": 0.1978549057635112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003777623176574707, "StateBufferConnector_ms": 0.0031958818435668945, "ViewRequirementAgentConnector_ms": 0.1110532283782959}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -442.0, "episode_return_mean": 101.79, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.64324568578691, "num_env_steps_trained_throughput_per_sec": 73.64324568578691, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 51834.36, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51834.264, "sample_time_ms": 1260.438, "learn_time_ms": 50555.715, "learn_throughput": 79.121, "synch_weights_time_ms": 14.296}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-27-32", "timestamp": 1723519652, "time_this_iter_s": 54.35237908363342, "time_total_s": 2228.6491956710815, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80a81f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2228.6491956710815, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 43.13376623376624, "ram_util_percent": 82.32077922077923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.882106123651777, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.602629250571841, "policy_loss": -0.009131566357488434, "vf_loss": 6.610076025554112, "vf_explained_var": 0.2248558828439662, "kl": 0.009984011581139225, "entropy": 1.2565012925516361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.317589791741951, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.843253979607234, "policy_loss": -0.00831751986492977, "vf_loss": 7.849773688795706, "vf_explained_var": -0.32267135936747154, "kl": 0.007990277133395398, "entropy": 1.299468761335605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -467.0, "episode_reward_mean": 29.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -385.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -32.65, "predator_policy": 47.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 260.0, 176.0, 151.0, 105.0, -106.0, 295.0, 223.0, 65.0, 278.0, 283.0, 392.0, 359.0, 186.0, 302.0, 386.0, 362.0, 383.0, 365.0, 338.0, 175.0, 4.0, 232.0, 194.0, 390.0, 346.0, 82.0, 99.0, 183.0, 85.0, 0.0, 333.0, 167.0, -9.0, 116.0, 302.0, 106.0, 68.0, 185.0, 225.0, 309.0, 0.0, -50.0, -442.0, 84.0, -107.0, 75.0, 36.0, 329.0, 163.0, 279.0, -188.0, 167.0, 156.0, 1.0, 378.0, 222.0, 146.0, 330.0, -89.0, -108.0, 330.0, 82.0, -362.0, 24.0, -78.0, -76.0, 111.0, -346.0, -109.0, -69.0, -169.0, -340.0, -429.0, -244.0, 42.0, -424.0, -369.0, -386.0, 46.0, -438.0, -404.0, -462.0, -277.0, -453.0, -376.0, -246.0, 177.0, -69.0, -362.0, 386.0, 0.0, -240.0, -134.0, -467.0, -88.0, -48.0, -391.0, -63.0, -314.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [168.0, 0.0, 193.0, 67.0, 70.0, 4.0, 129.0, 0.0, 0.0, 53.0, -100.0, -112.0, 147.0, 120.0, 67.0, 137.0, -1.0, 61.0, 198.0, 18.0, 133.0, 122.0, 198.0, 194.0, 199.0, 142.0, -119.0, 194.0, 150.0, 124.0, 194.0, 192.0, 191.0, 171.0, 189.0, 191.0, 192.0, 162.0, 169.0, 131.0, 0.0, 173.0, -70.0, -15.0, 113.0, 89.0, 23.0, 110.0, 192.0, 196.0, 180.0, 144.0, 0.0, 14.0, -31.0, 52.0, 0.0, 177.0, 85.0, 0.0, 0.0, 0.0, 125.0, 194.0, 160.0, 0.0, -90.0, -24.0, -2.0, 71.0, 149.0, 132.0, 11.0, -10.0, 48.0, -2.0, 199.0, -28.0, 126.0, 63.0, 89.0, 192.0, 0.0, 0.0, -28.0, -44.0, -310.0, -319.0, 83.0, -70.0, -147.0, -105.0, 0.0, 25.0, -48.0, 0.0, 158.0, 154.0, 145.0, 0.0, 143.0, 116.0, -167.0, -162.0, 151.0, 0.0, 25.0, 61.0, -97.0, 0.0, 179.0, 193.0, 39.0, 150.0, 133.0, 0.0, 169.0, 148.0, -94.0, -48.0, -149.0, -163.0, 136.0, 175.0, 28.0, 0.0, -311.0, -254.0, -148.0, 0.0, -111.0, -90.0, -247.0, 0.0, 24.0, 13.0, -258.0, -289.0, -305.0, 0.0, -89.0, -79.0, -93.0, -207.0, -383.0, -192.0, -304.0, -305.0, -241.0, -220.0, -101.0, 42.0, -317.0, -305.0, -382.0, -363.0, -357.0, -321.0, -35.0, 0.0, -341.0, -317.0, -293.0, -283.0, -385.0, -291.0, -254.0, -291.0, -307.0, -334.0, -322.0, -339.0, -289.0, -225.0, 177.0, 0.0, -96.0, -107.0, -363.0, -319.0, 194.0, 189.0, 0.0, 0.0, -215.0, -213.0, -289.0, 0.0, -334.0, -343.0, -220.0, 0.0, 0.0, -288.0, -323.0, -383.0, 0.0, -194.0, -277.0, -260.0], "policy_predator_policy_reward": [4.0, 8.0, 0.0, 0.0, 35.0, 67.0, 0.0, 22.0, 15.0, 37.0, 0.0, 106.0, 28.0, 0.0, 0.0, 19.0, 5.0, 0.0, 24.0, 38.0, 0.0, 28.0, 0.0, 0.0, 3.0, 15.0, 13.0, 98.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 2.0, 25.0, 13.0, 2.0, 0.0, 0.0, 89.0, 0.0, 30.0, 0.0, 61.0, 0.0, 2.0, 22.0, 0.0, 49.0, 19.0, 19.0, 59.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 7.0, 9.0, 96.0, 24.0, 23.0, 21.0, 0.0, 32.0, 73.0, 5.0, 17.0, 14.0, 0.0, 23.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 22.0, 187.0, 0.0, 35.0, 36.0, 45.0, 100.0, 50.0, 0.0, 74.0, 10.0, 0.0, 17.0, 18.0, 0.0, 3.0, 17.0, 23.0, 118.0, 16.0, 0.0, 22.0, 48.0, 0.0, 98.0, 6.0, 0.0, 23.0, 10.0, 0.0, 13.0, 13.0, 0.0, 53.0, 0.0, 121.0, 83.0, 0.0, 19.0, 0.0, 54.0, 172.0, 31.0, 65.0, 107.0, 118.0, 5.0, 124.0, 47.0, 74.0, 0.0, 76.0, 125.0, 161.0, 35.0, 99.0, 0.0, 25.0, 106.0, 184.0, 51.0, 0.0, 180.0, 76.0, 141.0, 101.0, 0.0, 182.0, 16.0, 187.0, 189.0, 127.0, 165.0, 4.0, 77.0, 132.0, 88.0, 168.0, 4.0, 192.0, 22.0, 125.0, 143.0, 188.0, 0.0, 122.0, 163.0, 146.0, 122.0, 0.0, 0.0, 29.0, 105.0, 171.0, 149.0, 3.0, 0.0, 0.0, 0.0, 48.0, 140.0, 0.0, 155.0, 31.0, 179.0, 132.0, 0.0, 152.0, 88.0, 199.0, 116.0, 128.0, 3.0, 58.0, 165.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6611144440331234, "mean_inference_ms": 1.5973328789314285, "mean_action_processing_ms": 0.25740763947474204, "mean_env_wait_ms": 0.19823732189771667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00388181209564209, "StateBufferConnector_ms": 0.003355860710144043, "ViewRequirementAgentConnector_ms": 0.1225055456161499}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -467.0, "episode_return_mean": 29.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.52920437172686, "num_env_steps_trained_throughput_per_sec": 76.52920437172686, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 51909.32, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51909.225, "sample_time_ms": 1314.793, "learn_time_ms": 50576.251, "learn_throughput": 79.089, "synch_weights_time_ms": 14.255}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-28-25", "timestamp": 1723519705, "time_this_iter_s": 52.32593512535095, "time_total_s": 2280.9751307964325, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaffcc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2280.9751307964325, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 36.58513513513513, "ram_util_percent": 83.09189189189188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.00194767461252, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.379225103691141, "policy_loss": -0.012569121463795897, "vf_loss": 8.390070721964356, "vf_explained_var": 0.09669779510725113, "kl": 0.010213305316482494, "entropy": 1.2283005110801213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.202277801749568, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.834974403734561, "policy_loss": -0.011223515387742765, "vf_loss": 8.843993889591681, "vf_explained_var": -0.32508361938769226, "kl": 0.00979571476162294, "entropy": 1.284693492026556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -512.0, "episode_reward_mean": -63.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -99.625, "predator_policy": 67.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.0, 338.0, 175.0, 4.0, 232.0, 194.0, 390.0, 346.0, 82.0, 99.0, 183.0, 85.0, 0.0, 333.0, 167.0, -9.0, 116.0, 302.0, 106.0, 68.0, 185.0, 225.0, 309.0, 0.0, -50.0, -442.0, 84.0, -107.0, 75.0, 36.0, 329.0, 163.0, 279.0, -188.0, 167.0, 156.0, 1.0, 378.0, 222.0, 146.0, 330.0, -89.0, -108.0, 330.0, 82.0, -362.0, 24.0, -78.0, -76.0, 111.0, -346.0, -109.0, -69.0, -169.0, -340.0, -429.0, -244.0, 42.0, -424.0, -369.0, -386.0, 46.0, -438.0, -404.0, -462.0, -277.0, -453.0, -376.0, -246.0, 177.0, -69.0, -362.0, 386.0, 0.0, -240.0, -134.0, -467.0, -88.0, -48.0, -391.0, -63.0, -314.0, -360.0, -384.0, -368.0, -349.0, -512.0, -443.0, 8.0, -302.0, -99.0, -308.0, -72.0, -287.0, -228.0, -363.0, -371.0, -70.0, -71.0, -416.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [192.0, 162.0, 169.0, 131.0, 0.0, 173.0, -70.0, -15.0, 113.0, 89.0, 23.0, 110.0, 192.0, 196.0, 180.0, 144.0, 0.0, 14.0, -31.0, 52.0, 0.0, 177.0, 85.0, 0.0, 0.0, 0.0, 125.0, 194.0, 160.0, 0.0, -90.0, -24.0, -2.0, 71.0, 149.0, 132.0, 11.0, -10.0, 48.0, -2.0, 199.0, -28.0, 126.0, 63.0, 89.0, 192.0, 0.0, 0.0, -28.0, -44.0, -310.0, -319.0, 83.0, -70.0, -147.0, -105.0, 0.0, 25.0, -48.0, 0.0, 158.0, 154.0, 145.0, 0.0, 143.0, 116.0, -167.0, -162.0, 151.0, 0.0, 25.0, 61.0, -97.0, 0.0, 179.0, 193.0, 39.0, 150.0, 133.0, 0.0, 169.0, 148.0, -94.0, -48.0, -149.0, -163.0, 136.0, 175.0, 28.0, 0.0, -311.0, -254.0, -148.0, 0.0, -111.0, -90.0, -247.0, 0.0, 24.0, 13.0, -258.0, -289.0, -305.0, 0.0, -89.0, -79.0, -93.0, -207.0, -383.0, -192.0, -304.0, -305.0, -241.0, -220.0, -101.0, 42.0, -317.0, -305.0, -382.0, -363.0, -357.0, -321.0, -35.0, 0.0, -341.0, -317.0, -293.0, -283.0, -385.0, -291.0, -254.0, -291.0, -307.0, -334.0, -322.0, -339.0, -289.0, -225.0, 177.0, 0.0, -96.0, -107.0, -363.0, -319.0, 194.0, 189.0, 0.0, 0.0, -215.0, -213.0, -289.0, 0.0, -334.0, -343.0, -220.0, 0.0, 0.0, -288.0, -323.0, -383.0, 0.0, -194.0, -277.0, -260.0, -342.0, -400.0, -354.0, -345.0, -279.0, -253.0, -350.0, -357.0, -342.0, -360.0, -276.0, -336.0, -44.0, -30.0, -245.0, -248.0, -343.0, 0.0, -348.0, -306.0, -128.0, -150.0, -320.0, -282.0, -177.0, -183.0, -362.0, -394.0, -332.0, -328.0, -361.0, 0.0, -270.0, -66.0, -400.0, -400.0], "policy_predator_policy_reward": [9.0, 2.0, 25.0, 13.0, 2.0, 0.0, 0.0, 89.0, 0.0, 30.0, 0.0, 61.0, 0.0, 2.0, 22.0, 0.0, 49.0, 19.0, 19.0, 59.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 7.0, 9.0, 96.0, 24.0, 23.0, 21.0, 0.0, 32.0, 73.0, 5.0, 17.0, 14.0, 0.0, 23.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 22.0, 187.0, 0.0, 35.0, 36.0, 45.0, 100.0, 50.0, 0.0, 74.0, 10.0, 0.0, 17.0, 18.0, 0.0, 3.0, 17.0, 23.0, 118.0, 16.0, 0.0, 22.0, 48.0, 0.0, 98.0, 6.0, 0.0, 23.0, 10.0, 0.0, 13.0, 13.0, 0.0, 53.0, 0.0, 121.0, 83.0, 0.0, 19.0, 0.0, 54.0, 172.0, 31.0, 65.0, 107.0, 118.0, 5.0, 124.0, 47.0, 74.0, 0.0, 76.0, 125.0, 161.0, 35.0, 99.0, 0.0, 25.0, 106.0, 184.0, 51.0, 0.0, 180.0, 76.0, 141.0, 101.0, 0.0, 182.0, 16.0, 187.0, 189.0, 127.0, 165.0, 4.0, 77.0, 132.0, 88.0, 168.0, 4.0, 192.0, 22.0, 125.0, 143.0, 188.0, 0.0, 122.0, 163.0, 146.0, 122.0, 0.0, 0.0, 29.0, 105.0, 171.0, 149.0, 3.0, 0.0, 0.0, 0.0, 48.0, 140.0, 0.0, 155.0, 31.0, 179.0, 132.0, 0.0, 152.0, 88.0, 199.0, 116.0, 128.0, 3.0, 58.0, 165.0, 191.0, 191.0, 173.0, 142.0, 0.0, 164.0, 179.0, 179.0, 0.0, 190.0, 169.0, 0.0, 0.0, 82.0, 43.0, 148.0, 151.0, 93.0, 171.0, 175.0, 105.0, 101.0, 159.0, 156.0, 132.0, 0.0, 198.0, 195.0, 114.0, 175.0, 168.0, 123.0, 140.0, 125.0, 196.0, 188.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6624175653408884, "mean_inference_ms": 1.598069460053976, "mean_action_processing_ms": 0.2578140651840537, "mean_env_wait_ms": 0.1985998512313946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943085670471191, "StateBufferConnector_ms": 0.0034646987915039062, "ViewRequirementAgentConnector_ms": 0.12817919254302979}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -512.0, "episode_return_mean": -63.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.32123212868801, "num_env_steps_trained_throughput_per_sec": 77.32123212868801, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 51855.944, "restore_workers_time_ms": 0.021, "training_step_time_ms": 51855.868, "sample_time_ms": 1305.368, "learn_time_ms": 50531.995, "learn_throughput": 79.158, "synch_weights_time_ms": 14.724}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-29-17", "timestamp": 1723519757, "time_this_iter_s": 51.76755881309509, "time_total_s": 2332.7426896095276, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7ffcc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2332.7426896095276, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 35.98356164383562, "ram_util_percent": 82.66164383561645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.65964430204775, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.854695610268406, "policy_loss": -0.013990873831112392, "vf_loss": 7.8654131180394895, "vf_explained_var": 0.19494332680626522, "kl": 0.019397718418321542, "entropy": 1.2432684038681958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.212890495761992, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.753924361738578, "policy_loss": -0.009796312920966003, "vf_loss": 7.7618030404287675, "vf_explained_var": -0.5216622040385291, "kl": 0.008522851869189548, "entropy": 1.297795073380546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -527.0, "episode_reward_mean": -165.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -175.565, "predator_policy": 92.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.0, 0.0, -50.0, -442.0, 84.0, -107.0, 75.0, 36.0, 329.0, 163.0, 279.0, -188.0, 167.0, 156.0, 1.0, 378.0, 222.0, 146.0, 330.0, -89.0, -108.0, 330.0, 82.0, -362.0, 24.0, -78.0, -76.0, 111.0, -346.0, -109.0, -69.0, -169.0, -340.0, -429.0, -244.0, 42.0, -424.0, -369.0, -386.0, 46.0, -438.0, -404.0, -462.0, -277.0, -453.0, -376.0, -246.0, 177.0, -69.0, -362.0, 386.0, 0.0, -240.0, -134.0, -467.0, -88.0, -48.0, -391.0, -63.0, -314.0, -360.0, -384.0, -368.0, -349.0, -512.0, -443.0, 8.0, -302.0, -99.0, -308.0, -72.0, -287.0, -228.0, -363.0, -371.0, -70.0, -71.0, -416.0, -348.0, -300.0, -42.0, -475.0, -363.0, -527.0, -14.0, -3.0, -378.0, -271.0, -464.0, -140.0, 0.0, -401.0, -347.0, -368.0, -336.0, -449.0, -405.0, -49.0, -198.0, -307.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [89.0, 192.0, 0.0, 0.0, -28.0, -44.0, -310.0, -319.0, 83.0, -70.0, -147.0, -105.0, 0.0, 25.0, -48.0, 0.0, 158.0, 154.0, 145.0, 0.0, 143.0, 116.0, -167.0, -162.0, 151.0, 0.0, 25.0, 61.0, -97.0, 0.0, 179.0, 193.0, 39.0, 150.0, 133.0, 0.0, 169.0, 148.0, -94.0, -48.0, -149.0, -163.0, 136.0, 175.0, 28.0, 0.0, -311.0, -254.0, -148.0, 0.0, -111.0, -90.0, -247.0, 0.0, 24.0, 13.0, -258.0, -289.0, -305.0, 0.0, -89.0, -79.0, -93.0, -207.0, -383.0, -192.0, -304.0, -305.0, -241.0, -220.0, -101.0, 42.0, -317.0, -305.0, -382.0, -363.0, -357.0, -321.0, -35.0, 0.0, -341.0, -317.0, -293.0, -283.0, -385.0, -291.0, -254.0, -291.0, -307.0, -334.0, -322.0, -339.0, -289.0, -225.0, 177.0, 0.0, -96.0, -107.0, -363.0, -319.0, 194.0, 189.0, 0.0, 0.0, -215.0, -213.0, -289.0, 0.0, -334.0, -343.0, -220.0, 0.0, 0.0, -288.0, -323.0, -383.0, 0.0, -194.0, -277.0, -260.0, -342.0, -400.0, -354.0, -345.0, -279.0, -253.0, -350.0, -357.0, -342.0, -360.0, -276.0, -336.0, -44.0, -30.0, -245.0, -248.0, -343.0, 0.0, -348.0, -306.0, -128.0, -150.0, -320.0, -282.0, -177.0, -183.0, -362.0, -394.0, -332.0, -328.0, -361.0, 0.0, -270.0, -66.0, -400.0, -400.0, -362.0, -332.0, -273.0, -358.0, 0.0, -358.0, -343.0, -319.0, -348.0, -400.0, -374.0, -352.0, -346.0, -6.0, 0.0, -6.0, -388.0, -365.0, -283.0, -288.0, -294.0, -355.0, -309.0, 0.0, 0.0, 0.0, -379.0, -384.0, -269.0, -374.0, -330.0, -368.0, -334.0, -383.0, -322.0, -301.0, -382.0, -389.0, 0.0, -315.0, -161.0, -171.0, -375.0, -284.0], "policy_predator_policy_reward": [0.0, 28.0, 0.0, 0.0, 0.0, 22.0, 187.0, 0.0, 35.0, 36.0, 45.0, 100.0, 50.0, 0.0, 74.0, 10.0, 0.0, 17.0, 18.0, 0.0, 3.0, 17.0, 23.0, 118.0, 16.0, 0.0, 22.0, 48.0, 0.0, 98.0, 6.0, 0.0, 23.0, 10.0, 0.0, 13.0, 13.0, 0.0, 53.0, 0.0, 121.0, 83.0, 0.0, 19.0, 0.0, 54.0, 172.0, 31.0, 65.0, 107.0, 118.0, 5.0, 124.0, 47.0, 74.0, 0.0, 76.0, 125.0, 161.0, 35.0, 99.0, 0.0, 25.0, 106.0, 184.0, 51.0, 0.0, 180.0, 76.0, 141.0, 101.0, 0.0, 182.0, 16.0, 187.0, 189.0, 127.0, 165.0, 4.0, 77.0, 132.0, 88.0, 168.0, 4.0, 192.0, 22.0, 125.0, 143.0, 188.0, 0.0, 122.0, 163.0, 146.0, 122.0, 0.0, 0.0, 29.0, 105.0, 171.0, 149.0, 3.0, 0.0, 0.0, 0.0, 48.0, 140.0, 0.0, 155.0, 31.0, 179.0, 132.0, 0.0, 152.0, 88.0, 199.0, 116.0, 128.0, 3.0, 58.0, 165.0, 191.0, 191.0, 173.0, 142.0, 0.0, 164.0, 179.0, 179.0, 0.0, 190.0, 169.0, 0.0, 0.0, 82.0, 43.0, 148.0, 151.0, 93.0, 171.0, 175.0, 105.0, 101.0, 159.0, 156.0, 132.0, 0.0, 198.0, 195.0, 114.0, 175.0, 168.0, 123.0, 140.0, 125.0, 196.0, 188.0, 159.0, 187.0, 133.0, 198.0, 156.0, 160.0, 0.0, 187.0, 199.0, 186.0, 0.0, 199.0, 170.0, 168.0, 3.0, 0.0, 189.0, 186.0, 127.0, 173.0, 185.0, 0.0, 0.0, 169.0, 0.0, 0.0, 162.0, 200.0, 105.0, 191.0, 182.0, 148.0, 185.0, 196.0, 174.0, 0.0, 191.0, 175.0, 109.0, 157.0, 134.0, 0.0, 191.0, 161.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.663842581804045, "mean_inference_ms": 1.5991599451613538, "mean_action_processing_ms": 0.2582788610348773, "mean_env_wait_ms": 0.1989869171849355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040007829666137695, "StateBufferConnector_ms": 0.003427863121032715, "ViewRequirementAgentConnector_ms": 0.13069331645965576}, "num_episodes": 22, "episode_return_max": 386.0, "episode_return_min": -527.0, "episode_return_mean": -165.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.4962137764544, "num_env_steps_trained_throughput_per_sec": 77.4962137764544, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 51840.104, "restore_workers_time_ms": 0.015, "training_step_time_ms": 51840.042, "sample_time_ms": 1273.741, "learn_time_ms": 50547.538, "learn_throughput": 79.133, "synch_weights_time_ms": 14.597}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-30-08", "timestamp": 1723519808, "time_this_iter_s": 51.652925968170166, "time_total_s": 2384.3956155776978, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7ffc160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2384.3956155776978, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 36.00821917808219, "ram_util_percent": 82.64520547945206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.78454951962466, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.01181227441818, "policy_loss": -0.012463364140352323, "vf_loss": 8.022435581621039, "vf_explained_var": 0.2001725014555391, "kl": 0.010904038481371118, "entropy": 1.238167057592402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.322206861159158, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4766204445450395, "policy_loss": -0.009879342461665157, "vf_loss": 7.484901851573318, "vf_explained_var": -0.5484872148781227, "kl": 0.007101990180418193, "entropy": 1.3156386410748517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -527.0, "episode_reward_mean": -233.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -235.065, "predator_policy": 118.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-362.0, 24.0, -78.0, -76.0, 111.0, -346.0, -109.0, -69.0, -169.0, -340.0, -429.0, -244.0, 42.0, -424.0, -369.0, -386.0, 46.0, -438.0, -404.0, -462.0, -277.0, -453.0, -376.0, -246.0, 177.0, -69.0, -362.0, 386.0, 0.0, -240.0, -134.0, -467.0, -88.0, -48.0, -391.0, -63.0, -314.0, -360.0, -384.0, -368.0, -349.0, -512.0, -443.0, 8.0, -302.0, -99.0, -308.0, -72.0, -287.0, -228.0, -363.0, -371.0, -70.0, -71.0, -416.0, -348.0, -300.0, -42.0, -475.0, -363.0, -527.0, -14.0, -3.0, -378.0, -271.0, -464.0, -140.0, 0.0, -401.0, -347.0, -368.0, -336.0, -449.0, -405.0, -49.0, -198.0, -307.0, -289.0, -371.0, -23.0, -365.0, -327.0, -157.0, -360.0, -315.0, -11.0, -164.0, 0.0, -343.0, -38.0, -38.0, -28.0, -261.0, -128.0, -11.0, -307.0, -114.0, -298.0, -329.0, -457.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-311.0, -254.0, -148.0, 0.0, -111.0, -90.0, -247.0, 0.0, 24.0, 13.0, -258.0, -289.0, -305.0, 0.0, -89.0, -79.0, -93.0, -207.0, -383.0, -192.0, -304.0, -305.0, -241.0, -220.0, -101.0, 42.0, -317.0, -305.0, -382.0, -363.0, -357.0, -321.0, -35.0, 0.0, -341.0, -317.0, -293.0, -283.0, -385.0, -291.0, -254.0, -291.0, -307.0, -334.0, -322.0, -339.0, -289.0, -225.0, 177.0, 0.0, -96.0, -107.0, -363.0, -319.0, 194.0, 189.0, 0.0, 0.0, -215.0, -213.0, -289.0, 0.0, -334.0, -343.0, -220.0, 0.0, 0.0, -288.0, -323.0, -383.0, 0.0, -194.0, -277.0, -260.0, -342.0, -400.0, -354.0, -345.0, -279.0, -253.0, -350.0, -357.0, -342.0, -360.0, -276.0, -336.0, -44.0, -30.0, -245.0, -248.0, -343.0, 0.0, -348.0, -306.0, -128.0, -150.0, -320.0, -282.0, -177.0, -183.0, -362.0, -394.0, -332.0, -328.0, -361.0, 0.0, -270.0, -66.0, -400.0, -400.0, -362.0, -332.0, -273.0, -358.0, 0.0, -358.0, -343.0, -319.0, -348.0, -400.0, -374.0, -352.0, -346.0, -6.0, 0.0, -6.0, -388.0, -365.0, -283.0, -288.0, -294.0, -355.0, -309.0, 0.0, 0.0, 0.0, -379.0, -384.0, -269.0, -374.0, -330.0, -368.0, -334.0, -383.0, -322.0, -301.0, -382.0, -389.0, 0.0, -315.0, -161.0, -171.0, -375.0, -284.0, -311.0, -302.0, -380.0, -355.0, -246.0, 0.0, -337.0, -391.0, -303.0, -369.0, -353.0, 0.0, -364.0, -353.0, -292.0, -389.0, -220.0, -12.0, 0.0, -346.0, 0.0, 0.0, -356.0, -343.0, 0.0, -400.0, -365.0, 0.0, -306.0, 0.0, -308.0, -258.0, 0.0, -292.0, 0.0, -386.0, -344.0, -281.0, -271.0, 0.0, -289.0, -311.0, -375.0, -314.0, -304.0, -333.0], "policy_predator_policy_reward": [172.0, 31.0, 65.0, 107.0, 118.0, 5.0, 124.0, 47.0, 74.0, 0.0, 76.0, 125.0, 161.0, 35.0, 99.0, 0.0, 25.0, 106.0, 184.0, 51.0, 0.0, 180.0, 76.0, 141.0, 101.0, 0.0, 182.0, 16.0, 187.0, 189.0, 127.0, 165.0, 4.0, 77.0, 132.0, 88.0, 168.0, 4.0, 192.0, 22.0, 125.0, 143.0, 188.0, 0.0, 122.0, 163.0, 146.0, 122.0, 0.0, 0.0, 29.0, 105.0, 171.0, 149.0, 3.0, 0.0, 0.0, 0.0, 48.0, 140.0, 0.0, 155.0, 31.0, 179.0, 132.0, 0.0, 152.0, 88.0, 199.0, 116.0, 128.0, 3.0, 58.0, 165.0, 191.0, 191.0, 173.0, 142.0, 0.0, 164.0, 179.0, 179.0, 0.0, 190.0, 169.0, 0.0, 0.0, 82.0, 43.0, 148.0, 151.0, 93.0, 171.0, 175.0, 105.0, 101.0, 159.0, 156.0, 132.0, 0.0, 198.0, 195.0, 114.0, 175.0, 168.0, 123.0, 140.0, 125.0, 196.0, 188.0, 159.0, 187.0, 133.0, 198.0, 156.0, 160.0, 0.0, 187.0, 199.0, 186.0, 0.0, 199.0, 170.0, 168.0, 3.0, 0.0, 189.0, 186.0, 127.0, 173.0, 185.0, 0.0, 0.0, 169.0, 0.0, 0.0, 162.0, 200.0, 105.0, 191.0, 182.0, 148.0, 185.0, 196.0, 174.0, 0.0, 191.0, 175.0, 109.0, 157.0, 134.0, 0.0, 191.0, 161.0, 165.0, 159.0, 173.0, 191.0, 135.0, 88.0, 166.0, 197.0, 164.0, 181.0, 164.0, 32.0, 171.0, 186.0, 193.0, 173.0, 114.0, 107.0, 0.0, 182.0, 0.0, 0.0, 190.0, 166.0, 199.0, 163.0, 152.0, 175.0, 129.0, 149.0, 159.0, 146.0, 0.0, 164.0, 186.0, 189.0, 155.0, 163.0, 157.0, 0.0, 128.0, 174.0, 190.0, 170.0, 180.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6649612077798349, "mean_inference_ms": 1.5989131873951974, "mean_action_processing_ms": 0.2586501764839965, "mean_env_wait_ms": 0.19927380151869084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004355072975158691, "StateBufferConnector_ms": 0.0033212900161743164, "ViewRequirementAgentConnector_ms": 0.12397217750549316}, "num_episodes": 23, "episode_return_max": 386.0, "episode_return_min": -527.0, "episode_return_mean": -233.61, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.22105586169582, "num_env_steps_trained_throughput_per_sec": 76.22105586169582, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 51923.238, "restore_workers_time_ms": 0.015, "training_step_time_ms": 51923.16, "sample_time_ms": 1269.042, "learn_time_ms": 50634.341, "learn_throughput": 78.998, "synch_weights_time_ms": 14.916}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-31-01", "timestamp": 1723519861, "time_this_iter_s": 52.53338670730591, "time_total_s": 2436.9290022850037, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaffc0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2436.9290022850037, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 39.0054054054054, "ram_util_percent": 83.22972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.681960607205749, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.7396878923688615, "policy_loss": -0.010248126284214397, "vf_loss": 7.748670623163697, "vf_explained_var": 0.2673214986526146, "kl": 0.0074987317392034335, "entropy": 1.1901885888563892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.562841162605891, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.864491580276893, "policy_loss": -0.010263640610698276, "vf_loss": 7.872558690378906, "vf_explained_var": -0.6391358154160636, "kl": 0.009762347686625877, "entropy": 1.3285296074297062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -542.0, "episode_reward_mean": -241.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -247.28, "predator_policy": 126.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-404.0, -462.0, -277.0, -453.0, -376.0, -246.0, 177.0, -69.0, -362.0, 386.0, 0.0, -240.0, -134.0, -467.0, -88.0, -48.0, -391.0, -63.0, -314.0, -360.0, -384.0, -368.0, -349.0, -512.0, -443.0, 8.0, -302.0, -99.0, -308.0, -72.0, -287.0, -228.0, -363.0, -371.0, -70.0, -71.0, -416.0, -348.0, -300.0, -42.0, -475.0, -363.0, -527.0, -14.0, -3.0, -378.0, -271.0, -464.0, -140.0, 0.0, -401.0, -347.0, -368.0, -336.0, -449.0, -405.0, -49.0, -198.0, -307.0, -289.0, -371.0, -23.0, -365.0, -327.0, -157.0, -360.0, -315.0, -11.0, -164.0, 0.0, -343.0, -38.0, -38.0, -28.0, -261.0, -128.0, -11.0, -307.0, -114.0, -298.0, -329.0, -457.0, -331.0, 7.0, -414.0, -168.0, -382.0, -24.0, -322.0, -542.0, 7.0, -326.0, -2.0, -460.0, -508.0, -406.0, -331.0, -25.0, -113.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-293.0, -283.0, -385.0, -291.0, -254.0, -291.0, -307.0, -334.0, -322.0, -339.0, -289.0, -225.0, 177.0, 0.0, -96.0, -107.0, -363.0, -319.0, 194.0, 189.0, 0.0, 0.0, -215.0, -213.0, -289.0, 0.0, -334.0, -343.0, -220.0, 0.0, 0.0, -288.0, -323.0, -383.0, 0.0, -194.0, -277.0, -260.0, -342.0, -400.0, -354.0, -345.0, -279.0, -253.0, -350.0, -357.0, -342.0, -360.0, -276.0, -336.0, -44.0, -30.0, -245.0, -248.0, -343.0, 0.0, -348.0, -306.0, -128.0, -150.0, -320.0, -282.0, -177.0, -183.0, -362.0, -394.0, -332.0, -328.0, -361.0, 0.0, -270.0, -66.0, -400.0, -400.0, -362.0, -332.0, -273.0, -358.0, 0.0, -358.0, -343.0, -319.0, -348.0, -400.0, -374.0, -352.0, -346.0, -6.0, 0.0, -6.0, -388.0, -365.0, -283.0, -288.0, -294.0, -355.0, -309.0, 0.0, 0.0, 0.0, -379.0, -384.0, -269.0, -374.0, -330.0, -368.0, -334.0, -383.0, -322.0, -301.0, -382.0, -389.0, 0.0, -315.0, -161.0, -171.0, -375.0, -284.0, -311.0, -302.0, -380.0, -355.0, -246.0, 0.0, -337.0, -391.0, -303.0, -369.0, -353.0, 0.0, -364.0, -353.0, -292.0, -389.0, -220.0, -12.0, 0.0, -346.0, 0.0, 0.0, -356.0, -343.0, 0.0, -400.0, -365.0, 0.0, -306.0, 0.0, -308.0, -258.0, 0.0, -292.0, 0.0, -386.0, -344.0, -281.0, -271.0, 0.0, -289.0, -311.0, -375.0, -314.0, -304.0, -333.0, -364.0, -310.0, -329.0, 0.0, -392.0, -344.0, -360.0, -168.0, -345.0, -396.0, 0.0, -374.0, -344.0, -321.0, -400.0, -344.0, 0.0, 7.0, -314.0, -235.0, 0.0, -368.0, -347.0, -296.0, -338.0, -360.0, -362.0, -232.0, -295.0, -376.0, 0.0, -348.0, 0.0, -268.0, -394.0, -12.0], "policy_predator_policy_reward": [168.0, 4.0, 192.0, 22.0, 125.0, 143.0, 188.0, 0.0, 122.0, 163.0, 146.0, 122.0, 0.0, 0.0, 29.0, 105.0, 171.0, 149.0, 3.0, 0.0, 0.0, 0.0, 48.0, 140.0, 0.0, 155.0, 31.0, 179.0, 132.0, 0.0, 152.0, 88.0, 199.0, 116.0, 128.0, 3.0, 58.0, 165.0, 191.0, 191.0, 173.0, 142.0, 0.0, 164.0, 179.0, 179.0, 0.0, 190.0, 169.0, 0.0, 0.0, 82.0, 43.0, 148.0, 151.0, 93.0, 171.0, 175.0, 105.0, 101.0, 159.0, 156.0, 132.0, 0.0, 198.0, 195.0, 114.0, 175.0, 168.0, 123.0, 140.0, 125.0, 196.0, 188.0, 159.0, 187.0, 133.0, 198.0, 156.0, 160.0, 0.0, 187.0, 199.0, 186.0, 0.0, 199.0, 170.0, 168.0, 3.0, 0.0, 189.0, 186.0, 127.0, 173.0, 185.0, 0.0, 0.0, 169.0, 0.0, 0.0, 162.0, 200.0, 105.0, 191.0, 182.0, 148.0, 185.0, 196.0, 174.0, 0.0, 191.0, 175.0, 109.0, 157.0, 134.0, 0.0, 191.0, 161.0, 165.0, 159.0, 173.0, 191.0, 135.0, 88.0, 166.0, 197.0, 164.0, 181.0, 164.0, 32.0, 171.0, 186.0, 193.0, 173.0, 114.0, 107.0, 0.0, 182.0, 0.0, 0.0, 190.0, 166.0, 199.0, 163.0, 152.0, 175.0, 129.0, 149.0, 159.0, 146.0, 0.0, 164.0, 186.0, 189.0, 155.0, 163.0, 157.0, 0.0, 128.0, 174.0, 190.0, 170.0, 180.0, 0.0, 172.0, 171.0, 170.0, 166.0, 198.0, 124.0, 178.0, 182.0, 200.0, 159.0, 184.0, 166.0, 176.0, 167.0, 2.0, 200.0, 0.0, 0.0, 51.0, 172.0, 187.0, 179.0, 0.0, 183.0, 0.0, 190.0, 0.0, 188.0, 192.0, 148.0, 167.0, 156.0, 155.0, 0.0, 197.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6655291934617851, "mean_inference_ms": 1.5987393222838773, "mean_action_processing_ms": 0.25894629581660406, "mean_env_wait_ms": 0.19954516536570607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005451321601867676, "StateBufferConnector_ms": 0.003942370414733887, "ViewRequirementAgentConnector_ms": 0.12375211715698242}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -542.0, "episode_return_mean": -241.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.69634173902897, "num_env_steps_trained_throughput_per_sec": 76.69634173902897, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 51959.352, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51959.274, "sample_time_ms": 1292.948, "learn_time_ms": 50646.363, "learn_throughput": 78.979, "synch_weights_time_ms": 15.005}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-31-53", "timestamp": 1723519913, "time_this_iter_s": 52.2152841091156, "time_total_s": 2489.1442863941193, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2489.1442863941193, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 37.08243243243244, "ram_util_percent": 83.26216216216217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.222500527409649, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.729410333482046, "policy_loss": -0.00943303475188456, "vf_loss": 7.73709819077184, "vf_explained_var": 0.2598310352633239, "kl": 0.010341760099742458, "entropy": 1.1301168273996425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.208150208690179, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.867447848799367, "policy_loss": -0.010901491938740331, "vf_loss": 7.876301214682362, "vf_explained_var": -0.605183833869046, "kl": 0.009102786191779485, "entropy": 1.3221130682047082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 32.0, "episode_reward_min": -542.0, "episode_reward_mean": -248.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -259.365, "predator_policy": 135.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.0, -360.0, -384.0, -368.0, -349.0, -512.0, -443.0, 8.0, -302.0, -99.0, -308.0, -72.0, -287.0, -228.0, -363.0, -371.0, -70.0, -71.0, -416.0, -348.0, -300.0, -42.0, -475.0, -363.0, -527.0, -14.0, -3.0, -378.0, -271.0, -464.0, -140.0, 0.0, -401.0, -347.0, -368.0, -336.0, -449.0, -405.0, -49.0, -198.0, -307.0, -289.0, -371.0, -23.0, -365.0, -327.0, -157.0, -360.0, -315.0, -11.0, -164.0, 0.0, -343.0, -38.0, -38.0, -28.0, -261.0, -128.0, -11.0, -307.0, -114.0, -298.0, -329.0, -457.0, -331.0, 7.0, -414.0, -168.0, -382.0, -24.0, -322.0, -542.0, 7.0, -326.0, -2.0, -460.0, -508.0, -406.0, -331.0, -25.0, -113.0, -49.0, -299.0, -261.0, -15.0, -523.0, -468.0, -147.0, -317.0, -1.0, -372.0, -375.0, -141.0, -498.0, -283.0, -14.0, -284.0, -289.0, -1.0, 32.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-277.0, -260.0, -342.0, -400.0, -354.0, -345.0, -279.0, -253.0, -350.0, -357.0, -342.0, -360.0, -276.0, -336.0, -44.0, -30.0, -245.0, -248.0, -343.0, 0.0, -348.0, -306.0, -128.0, -150.0, -320.0, -282.0, -177.0, -183.0, -362.0, -394.0, -332.0, -328.0, -361.0, 0.0, -270.0, -66.0, -400.0, -400.0, -362.0, -332.0, -273.0, -358.0, 0.0, -358.0, -343.0, -319.0, -348.0, -400.0, -374.0, -352.0, -346.0, -6.0, 0.0, -6.0, -388.0, -365.0, -283.0, -288.0, -294.0, -355.0, -309.0, 0.0, 0.0, 0.0, -379.0, -384.0, -269.0, -374.0, -330.0, -368.0, -334.0, -383.0, -322.0, -301.0, -382.0, -389.0, 0.0, -315.0, -161.0, -171.0, -375.0, -284.0, -311.0, -302.0, -380.0, -355.0, -246.0, 0.0, -337.0, -391.0, -303.0, -369.0, -353.0, 0.0, -364.0, -353.0, -292.0, -389.0, -220.0, -12.0, 0.0, -346.0, 0.0, 0.0, -356.0, -343.0, 0.0, -400.0, -365.0, 0.0, -306.0, 0.0, -308.0, -258.0, 0.0, -292.0, 0.0, -386.0, -344.0, -281.0, -271.0, 0.0, -289.0, -311.0, -375.0, -314.0, -304.0, -333.0, -364.0, -310.0, -329.0, 0.0, -392.0, -344.0, -360.0, -168.0, -345.0, -396.0, 0.0, -374.0, -344.0, -321.0, -400.0, -344.0, 0.0, 7.0, -314.0, -235.0, 0.0, -368.0, -347.0, -296.0, -338.0, -360.0, -362.0, -232.0, -295.0, -376.0, 0.0, -348.0, 0.0, -268.0, -394.0, -12.0, -329.0, -307.0, -394.0, -239.0, -4.0, -347.0, -374.0, -356.0, -337.0, -313.0, -315.0, -2.0, -306.0, -392.0, 15.0, -314.0, -368.0, -365.0, -272.0, -260.0, -307.0, 0.0, -310.0, -384.0, -316.0, -300.0, -318.0, 0.0, -281.0, -396.0, -396.0, -268.0, 0.0, -2.0, 0.0, -300.0], "policy_predator_policy_reward": [58.0, 165.0, 191.0, 191.0, 173.0, 142.0, 0.0, 164.0, 179.0, 179.0, 0.0, 190.0, 169.0, 0.0, 0.0, 82.0, 43.0, 148.0, 151.0, 93.0, 171.0, 175.0, 105.0, 101.0, 159.0, 156.0, 132.0, 0.0, 198.0, 195.0, 114.0, 175.0, 168.0, 123.0, 140.0, 125.0, 196.0, 188.0, 159.0, 187.0, 133.0, 198.0, 156.0, 160.0, 0.0, 187.0, 199.0, 186.0, 0.0, 199.0, 170.0, 168.0, 3.0, 0.0, 189.0, 186.0, 127.0, 173.0, 185.0, 0.0, 0.0, 169.0, 0.0, 0.0, 162.0, 200.0, 105.0, 191.0, 182.0, 148.0, 185.0, 196.0, 174.0, 0.0, 191.0, 175.0, 109.0, 157.0, 134.0, 0.0, 191.0, 161.0, 165.0, 159.0, 173.0, 191.0, 135.0, 88.0, 166.0, 197.0, 164.0, 181.0, 164.0, 32.0, 171.0, 186.0, 193.0, 173.0, 114.0, 107.0, 0.0, 182.0, 0.0, 0.0, 190.0, 166.0, 199.0, 163.0, 152.0, 175.0, 129.0, 149.0, 159.0, 146.0, 0.0, 164.0, 186.0, 189.0, 155.0, 163.0, 157.0, 0.0, 128.0, 174.0, 190.0, 170.0, 180.0, 0.0, 172.0, 171.0, 170.0, 166.0, 198.0, 124.0, 178.0, 182.0, 200.0, 159.0, 184.0, 166.0, 176.0, 167.0, 2.0, 200.0, 0.0, 0.0, 51.0, 172.0, 187.0, 179.0, 0.0, 183.0, 0.0, 190.0, 0.0, 188.0, 192.0, 148.0, 167.0, 156.0, 155.0, 0.0, 197.0, 160.0, 164.0, 173.0, 177.0, 195.0, 174.0, 162.0, 7.0, 200.0, 0.0, 182.0, 0.0, 170.0, 190.0, 191.0, 139.0, 159.0, 173.0, 188.0, 157.0, 0.0, 166.0, 0.0, 0.0, 196.0, 161.0, 172.0, 152.0, 152.0, 200.0, 193.0, 176.0, 199.0, 1.0, 0.0, 166.0, 166.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6648720086673896, "mean_inference_ms": 1.5957212275191863, "mean_action_processing_ms": 0.2587309085777128, "mean_env_wait_ms": 0.1994780962354973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005845189094543457, "StateBufferConnector_ms": 0.0038299560546875, "ViewRequirementAgentConnector_ms": 0.11561846733093262}, "num_episodes": 18, "episode_return_max": 32.0, "episode_return_min": -542.0, "episode_return_mean": -248.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.02403173483309, "num_env_steps_trained_throughput_per_sec": 77.02403173483309, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 52022.62, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52022.526, "sample_time_ms": 1290.093, "learn_time_ms": 50711.004, "learn_throughput": 78.878, "synch_weights_time_ms": 16.175}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-32-45", "timestamp": 1723519965, "time_this_iter_s": 51.98093914985657, "time_total_s": 2541.125225543976, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80aedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2541.125225543976, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 36.11917808219179, "ram_util_percent": 83.1890410958904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.170014444860831, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.902638244628906, "policy_loss": -0.012223366459230424, "vf_loss": 7.91222329644299, "vf_explained_var": 0.2399473921962516, "kl": 0.015634467140408056, "entropy": 1.1225497639368451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.068988902575125, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.942274343399775, "policy_loss": -0.01131148570298498, "vf_loss": 7.951646295678678, "vf_explained_var": -0.393531382462335, "kl": 0.008620130703947945, "entropy": 1.281418748507424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 168.0, "episode_reward_min": -542.0, "episode_reward_mean": -235.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 86.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -254.355, "predator_policy": 136.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-475.0, -363.0, -527.0, -14.0, -3.0, -378.0, -271.0, -464.0, -140.0, 0.0, -401.0, -347.0, -368.0, -336.0, -449.0, -405.0, -49.0, -198.0, -307.0, -289.0, -371.0, -23.0, -365.0, -327.0, -157.0, -360.0, -315.0, -11.0, -164.0, 0.0, -343.0, -38.0, -38.0, -28.0, -261.0, -128.0, -11.0, -307.0, -114.0, -298.0, -329.0, -457.0, -331.0, 7.0, -414.0, -168.0, -382.0, -24.0, -322.0, -542.0, 7.0, -326.0, -2.0, -460.0, -508.0, -406.0, -331.0, -25.0, -113.0, -49.0, -299.0, -261.0, -15.0, -523.0, -468.0, -147.0, -317.0, -1.0, -372.0, -375.0, -141.0, -498.0, -283.0, -14.0, -284.0, -289.0, -1.0, 32.0, -375.0, -441.0, -353.0, -440.0, -156.0, -439.0, -253.0, -382.0, -261.0, -324.0, 0.0, -303.0, -354.0, -11.0, 168.0, 4.0, -11.0, 19.0, 34.0, -385.0, -125.0, -326.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-343.0, -319.0, -348.0, -400.0, -374.0, -352.0, -346.0, -6.0, 0.0, -6.0, -388.0, -365.0, -283.0, -288.0, -294.0, -355.0, -309.0, 0.0, 0.0, 0.0, -379.0, -384.0, -269.0, -374.0, -330.0, -368.0, -334.0, -383.0, -322.0, -301.0, -382.0, -389.0, 0.0, -315.0, -161.0, -171.0, -375.0, -284.0, -311.0, -302.0, -380.0, -355.0, -246.0, 0.0, -337.0, -391.0, -303.0, -369.0, -353.0, 0.0, -364.0, -353.0, -292.0, -389.0, -220.0, -12.0, 0.0, -346.0, 0.0, 0.0, -356.0, -343.0, 0.0, -400.0, -365.0, 0.0, -306.0, 0.0, -308.0, -258.0, 0.0, -292.0, 0.0, -386.0, -344.0, -281.0, -271.0, 0.0, -289.0, -311.0, -375.0, -314.0, -304.0, -333.0, -364.0, -310.0, -329.0, 0.0, -392.0, -344.0, -360.0, -168.0, -345.0, -396.0, 0.0, -374.0, -344.0, -321.0, -400.0, -344.0, 0.0, 7.0, -314.0, -235.0, 0.0, -368.0, -347.0, -296.0, -338.0, -360.0, -362.0, -232.0, -295.0, -376.0, 0.0, -348.0, 0.0, -268.0, -394.0, -12.0, -329.0, -307.0, -394.0, -239.0, -4.0, -347.0, -374.0, -356.0, -337.0, -313.0, -315.0, -2.0, -306.0, -392.0, 15.0, -314.0, -368.0, -365.0, -272.0, -260.0, -307.0, 0.0, -310.0, -384.0, -316.0, -300.0, -318.0, 0.0, -281.0, -396.0, -396.0, -268.0, 0.0, -2.0, 0.0, -300.0, -400.0, -354.0, -392.0, -248.0, -330.0, -391.0, -367.0, -339.0, -366.0, -134.0, -374.0, -258.0, -337.0, -269.0, -343.0, -391.0, -296.0, -320.0, -323.0, -348.0, 0.0, 0.0, -360.0, -290.0, -363.0, -352.0, 0.0, -362.0, 86.0, 66.0, 0.0, -340.0, -390.0, 0.0, 0.0, -292.0, 0.0, -40.0, -385.0, -369.0, -276.0, 0.0, -330.0, -352.0], "policy_predator_policy_reward": [0.0, 187.0, 199.0, 186.0, 0.0, 199.0, 170.0, 168.0, 3.0, 0.0, 189.0, 186.0, 127.0, 173.0, 185.0, 0.0, 0.0, 169.0, 0.0, 0.0, 162.0, 200.0, 105.0, 191.0, 182.0, 148.0, 185.0, 196.0, 174.0, 0.0, 191.0, 175.0, 109.0, 157.0, 134.0, 0.0, 191.0, 161.0, 165.0, 159.0, 173.0, 191.0, 135.0, 88.0, 166.0, 197.0, 164.0, 181.0, 164.0, 32.0, 171.0, 186.0, 193.0, 173.0, 114.0, 107.0, 0.0, 182.0, 0.0, 0.0, 190.0, 166.0, 199.0, 163.0, 152.0, 175.0, 129.0, 149.0, 159.0, 146.0, 0.0, 164.0, 186.0, 189.0, 155.0, 163.0, 157.0, 0.0, 128.0, 174.0, 190.0, 170.0, 180.0, 0.0, 172.0, 171.0, 170.0, 166.0, 198.0, 124.0, 178.0, 182.0, 200.0, 159.0, 184.0, 166.0, 176.0, 167.0, 2.0, 200.0, 0.0, 0.0, 51.0, 172.0, 187.0, 179.0, 0.0, 183.0, 0.0, 190.0, 0.0, 188.0, 192.0, 148.0, 167.0, 156.0, 155.0, 0.0, 197.0, 160.0, 164.0, 173.0, 177.0, 195.0, 174.0, 162.0, 7.0, 200.0, 0.0, 182.0, 0.0, 170.0, 190.0, 191.0, 139.0, 159.0, 173.0, 188.0, 157.0, 0.0, 166.0, 0.0, 0.0, 196.0, 161.0, 172.0, 152.0, 152.0, 200.0, 193.0, 176.0, 199.0, 1.0, 0.0, 166.0, 166.0, 200.0, 179.0, 199.0, 0.0, 199.0, 169.0, 190.0, 76.0, 191.0, 153.0, 193.0, 0.0, 179.0, 174.0, 194.0, 158.0, 168.0, 187.0, 193.0, 154.0, 0.0, 0.0, 167.0, 180.0, 185.0, 176.0, 178.0, 173.0, 16.0, 0.0, 176.0, 168.0, 188.0, 191.0, 157.0, 154.0, 37.0, 37.0, 174.0, 195.0, 0.0, 151.0, 190.0, 166.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6642622135354636, "mean_inference_ms": 1.5921795653145703, "mean_action_processing_ms": 0.2585351201566657, "mean_env_wait_ms": 0.1994891459035447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00698399543762207, "StateBufferConnector_ms": 0.0037561655044555664, "ViewRequirementAgentConnector_ms": 0.11038017272949219}, "num_episodes": 22, "episode_return_max": 168.0, "episode_return_min": -542.0, "episode_return_mean": -235.88, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.02006539588803, "num_env_steps_trained_throughput_per_sec": 74.02006539588803, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 52307.452, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52307.358, "sample_time_ms": 1300.031, "learn_time_ms": 50986.352, "learn_throughput": 78.452, "synch_weights_time_ms": 16.093}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-33-39", "timestamp": 1723520019, "time_this_iter_s": 54.080265045166016, "time_total_s": 2595.205490589142, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80b5b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2595.205490589142, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 42.275324675324676, "ram_util_percent": 81.65714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.348192077086717, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.151548122224353, "policy_loss": -0.008563640071128411, "vf_loss": 7.158805282532223, "vf_explained_var": 0.3215972879260936, "kl": 0.00774216864101421, "entropy": 1.1413707502935297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8101222698966035, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.368014625014451, "policy_loss": -0.011534135003214475, "vf_loss": 6.377167001603142, "vf_explained_var": -0.475074012885018, "kl": 0.010585613815259728, "entropy": 1.3489176747660157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 194.0, "episode_reward_min": -542.0, "episode_reward_mean": -205.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -237.51, "predator_policy": 134.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-327.0, -157.0, -360.0, -315.0, -11.0, -164.0, 0.0, -343.0, -38.0, -38.0, -28.0, -261.0, -128.0, -11.0, -307.0, -114.0, -298.0, -329.0, -457.0, -331.0, 7.0, -414.0, -168.0, -382.0, -24.0, -322.0, -542.0, 7.0, -326.0, -2.0, -460.0, -508.0, -406.0, -331.0, -25.0, -113.0, -49.0, -299.0, -261.0, -15.0, -523.0, -468.0, -147.0, -317.0, -1.0, -372.0, -375.0, -141.0, -498.0, -283.0, -14.0, -284.0, -289.0, -1.0, 32.0, -375.0, -441.0, -353.0, -440.0, -156.0, -439.0, -253.0, -382.0, -261.0, -324.0, 0.0, -303.0, -354.0, -11.0, 168.0, 4.0, -11.0, 19.0, 34.0, -385.0, -125.0, -326.0, -11.0, -263.0, -11.0, -132.0, -392.0, 0.0, 0.0, -257.0, -176.0, -28.0, -364.0, -362.0, -344.0, -374.0, -103.0, -400.0, 46.0, -55.0, 194.0, -2.0, -377.0, -53.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-303.0, -369.0, -353.0, 0.0, -364.0, -353.0, -292.0, -389.0, -220.0, -12.0, 0.0, -346.0, 0.0, 0.0, -356.0, -343.0, 0.0, -400.0, -365.0, 0.0, -306.0, 0.0, -308.0, -258.0, 0.0, -292.0, 0.0, -386.0, -344.0, -281.0, -271.0, 0.0, -289.0, -311.0, -375.0, -314.0, -304.0, -333.0, -364.0, -310.0, -329.0, 0.0, -392.0, -344.0, -360.0, -168.0, -345.0, -396.0, 0.0, -374.0, -344.0, -321.0, -400.0, -344.0, 0.0, 7.0, -314.0, -235.0, 0.0, -368.0, -347.0, -296.0, -338.0, -360.0, -362.0, -232.0, -295.0, -376.0, 0.0, -348.0, 0.0, -268.0, -394.0, -12.0, -329.0, -307.0, -394.0, -239.0, -4.0, -347.0, -374.0, -356.0, -337.0, -313.0, -315.0, -2.0, -306.0, -392.0, 15.0, -314.0, -368.0, -365.0, -272.0, -260.0, -307.0, 0.0, -310.0, -384.0, -316.0, -300.0, -318.0, 0.0, -281.0, -396.0, -396.0, -268.0, 0.0, -2.0, 0.0, -300.0, -400.0, -354.0, -392.0, -248.0, -330.0, -391.0, -367.0, -339.0, -366.0, -134.0, -374.0, -258.0, -337.0, -269.0, -343.0, -391.0, -296.0, -320.0, -323.0, -348.0, 0.0, 0.0, -360.0, -290.0, -363.0, -352.0, 0.0, -362.0, 86.0, 66.0, 0.0, -340.0, -390.0, 0.0, 0.0, -292.0, 0.0, -40.0, -385.0, -369.0, -276.0, 0.0, -330.0, -352.0, 0.0, -394.0, -244.0, -369.0, 0.0, -390.0, 0.0, -298.0, -384.0, -396.0, 0.0, 0.0, 0.0, 0.0, -294.0, -290.0, 0.0, -360.0, 0.0, -368.0, -352.0, -352.0, -373.0, -364.0, -353.0, -364.0, -326.0, -319.0, -124.0, -290.0, -285.0, -280.0, 0.0, -244.0, -139.0, -40.0, 194.0, 0.0, -292.0, -10.0, -292.0, -270.0, -123.0, -74.0, 0.0, -391.0], "policy_predator_policy_reward": [164.0, 181.0, 164.0, 32.0, 171.0, 186.0, 193.0, 173.0, 114.0, 107.0, 0.0, 182.0, 0.0, 0.0, 190.0, 166.0, 199.0, 163.0, 152.0, 175.0, 129.0, 149.0, 159.0, 146.0, 0.0, 164.0, 186.0, 189.0, 155.0, 163.0, 157.0, 0.0, 128.0, 174.0, 190.0, 170.0, 180.0, 0.0, 172.0, 171.0, 170.0, 166.0, 198.0, 124.0, 178.0, 182.0, 200.0, 159.0, 184.0, 166.0, 176.0, 167.0, 2.0, 200.0, 0.0, 0.0, 51.0, 172.0, 187.0, 179.0, 0.0, 183.0, 0.0, 190.0, 0.0, 188.0, 192.0, 148.0, 167.0, 156.0, 155.0, 0.0, 197.0, 160.0, 164.0, 173.0, 177.0, 195.0, 174.0, 162.0, 7.0, 200.0, 0.0, 182.0, 0.0, 170.0, 190.0, 191.0, 139.0, 159.0, 173.0, 188.0, 157.0, 0.0, 166.0, 0.0, 0.0, 196.0, 161.0, 172.0, 152.0, 152.0, 200.0, 193.0, 176.0, 199.0, 1.0, 0.0, 166.0, 166.0, 200.0, 179.0, 199.0, 0.0, 199.0, 169.0, 190.0, 76.0, 191.0, 153.0, 193.0, 0.0, 179.0, 174.0, 194.0, 158.0, 168.0, 187.0, 193.0, 154.0, 0.0, 0.0, 167.0, 180.0, 185.0, 176.0, 178.0, 173.0, 16.0, 0.0, 176.0, 168.0, 188.0, 191.0, 157.0, 154.0, 37.0, 37.0, 174.0, 195.0, 0.0, 151.0, 190.0, 166.0, 186.0, 197.0, 186.0, 164.0, 189.0, 190.0, 0.0, 166.0, 199.0, 189.0, 0.0, 0.0, 0.0, 0.0, 145.0, 182.0, 171.0, 13.0, 186.0, 154.0, 157.0, 183.0, 185.0, 190.0, 188.0, 185.0, 175.0, 96.0, 160.0, 151.0, 0.0, 165.0, 146.0, 144.0, 35.0, 89.0, 0.0, 0.0, 149.0, 151.0, 169.0, 16.0, 0.0, 144.0, 188.0, 197.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6650418827340112, "mean_inference_ms": 1.5916025547604733, "mean_action_processing_ms": 0.2584893497523273, "mean_env_wait_ms": 0.19976086865256007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010051250457763672, "StateBufferConnector_ms": 0.0037473440170288086, "ViewRequirementAgentConnector_ms": 0.12018632888793945}, "num_episodes": 23, "episode_return_max": 194.0, "episode_return_min": -542.0, "episode_return_mean": -205.15, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.65750901228854, "num_env_steps_trained_throughput_per_sec": 77.65750901228854, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 52342.883, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52342.784, "sample_time_ms": 1314.867, "learn_time_ms": 51007.272, "learn_throughput": 78.42, "synch_weights_time_ms": 16.368}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-34-31", "timestamp": 1723520071, "time_this_iter_s": 51.562918186187744, "time_total_s": 2646.7684087753296, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8016550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2646.7684087753296, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 34.91095890410959, "ram_util_percent": 79.83013698630137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.669761727852796, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.800094525523917, "policy_loss": -0.01031743451354227, "vf_loss": 7.808971886407761, "vf_explained_var": 0.23018117360967807, "kl": 0.008533737607162539, "entropy": 1.1485310427095525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.937248928963192, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.114698431731532, "policy_loss": -0.013137627214626977, "vf_loss": 7.125173508679425, "vf_explained_var": -0.4126900459092761, "kl": 0.011833605547478115, "entropy": 1.3052886071659269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 194.0, "episode_reward_min": -542.0, "episode_reward_mean": -185.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -225.16, "predator_policy": 132.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-457.0, -331.0, 7.0, -414.0, -168.0, -382.0, -24.0, -322.0, -542.0, 7.0, -326.0, -2.0, -460.0, -508.0, -406.0, -331.0, -25.0, -113.0, -49.0, -299.0, -261.0, -15.0, -523.0, -468.0, -147.0, -317.0, -1.0, -372.0, -375.0, -141.0, -498.0, -283.0, -14.0, -284.0, -289.0, -1.0, 32.0, -375.0, -441.0, -353.0, -440.0, -156.0, -439.0, -253.0, -382.0, -261.0, -324.0, 0.0, -303.0, -354.0, -11.0, 168.0, 4.0, -11.0, 19.0, 34.0, -385.0, -125.0, -326.0, -11.0, -263.0, -11.0, -132.0, -392.0, 0.0, 0.0, -257.0, -176.0, -28.0, -364.0, -362.0, -344.0, -374.0, -103.0, -400.0, 46.0, -55.0, 194.0, -2.0, -377.0, -53.0, -6.0, -339.0, 0.0, 0.0, 36.0, 166.0, -187.0, 7.0, 52.0, -12.0, -165.0, 91.0, 2.0, -341.0, -49.0, 65.0, -385.0, -89.0, -151.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-304.0, -333.0, -364.0, -310.0, -329.0, 0.0, -392.0, -344.0, -360.0, -168.0, -345.0, -396.0, 0.0, -374.0, -344.0, -321.0, -400.0, -344.0, 0.0, 7.0, -314.0, -235.0, 0.0, -368.0, -347.0, -296.0, -338.0, -360.0, -362.0, -232.0, -295.0, -376.0, 0.0, -348.0, 0.0, -268.0, -394.0, -12.0, -329.0, -307.0, -394.0, -239.0, -4.0, -347.0, -374.0, -356.0, -337.0, -313.0, -315.0, -2.0, -306.0, -392.0, 15.0, -314.0, -368.0, -365.0, -272.0, -260.0, -307.0, 0.0, -310.0, -384.0, -316.0, -300.0, -318.0, 0.0, -281.0, -396.0, -396.0, -268.0, 0.0, -2.0, 0.0, -300.0, -400.0, -354.0, -392.0, -248.0, -330.0, -391.0, -367.0, -339.0, -366.0, -134.0, -374.0, -258.0, -337.0, -269.0, -343.0, -391.0, -296.0, -320.0, -323.0, -348.0, 0.0, 0.0, -360.0, -290.0, -363.0, -352.0, 0.0, -362.0, 86.0, 66.0, 0.0, -340.0, -390.0, 0.0, 0.0, -292.0, 0.0, -40.0, -385.0, -369.0, -276.0, 0.0, -330.0, -352.0, 0.0, -394.0, -244.0, -369.0, 0.0, -390.0, 0.0, -298.0, -384.0, -396.0, 0.0, 0.0, 0.0, 0.0, -294.0, -290.0, 0.0, -360.0, 0.0, -368.0, -352.0, -352.0, -373.0, -364.0, -353.0, -364.0, -326.0, -319.0, -124.0, -290.0, -285.0, -280.0, 0.0, -244.0, -139.0, -40.0, 194.0, 0.0, -292.0, -10.0, -292.0, -270.0, -123.0, -74.0, 0.0, -391.0, -337.0, -368.0, 0.0, 0.0, 0.0, 0.0, -185.0, 0.0, 166.0, -188.0, -32.0, -327.0, -202.0, 0.0, 0.0, -185.0, 0.0, -370.0, -382.0, -166.0, -310.0, 93.0, 0.0, -333.0, -304.0, -388.0, 0.0, -172.0, -2.0, -58.0, -390.0, -372.0, -334.0, -82.0, -380.0, -122.0], "policy_predator_policy_reward": [180.0, 0.0, 172.0, 171.0, 170.0, 166.0, 198.0, 124.0, 178.0, 182.0, 200.0, 159.0, 184.0, 166.0, 176.0, 167.0, 2.0, 200.0, 0.0, 0.0, 51.0, 172.0, 187.0, 179.0, 0.0, 183.0, 0.0, 190.0, 0.0, 188.0, 192.0, 148.0, 167.0, 156.0, 155.0, 0.0, 197.0, 160.0, 164.0, 173.0, 177.0, 195.0, 174.0, 162.0, 7.0, 200.0, 0.0, 182.0, 0.0, 170.0, 190.0, 191.0, 139.0, 159.0, 173.0, 188.0, 157.0, 0.0, 166.0, 0.0, 0.0, 196.0, 161.0, 172.0, 152.0, 152.0, 200.0, 193.0, 176.0, 199.0, 1.0, 0.0, 166.0, 166.0, 200.0, 179.0, 199.0, 0.0, 199.0, 169.0, 190.0, 76.0, 191.0, 153.0, 193.0, 0.0, 179.0, 174.0, 194.0, 158.0, 168.0, 187.0, 193.0, 154.0, 0.0, 0.0, 167.0, 180.0, 185.0, 176.0, 178.0, 173.0, 16.0, 0.0, 176.0, 168.0, 188.0, 191.0, 157.0, 154.0, 37.0, 37.0, 174.0, 195.0, 0.0, 151.0, 190.0, 166.0, 186.0, 197.0, 186.0, 164.0, 189.0, 190.0, 0.0, 166.0, 199.0, 189.0, 0.0, 0.0, 0.0, 0.0, 145.0, 182.0, 171.0, 13.0, 186.0, 154.0, 157.0, 183.0, 185.0, 190.0, 188.0, 185.0, 175.0, 96.0, 160.0, 151.0, 0.0, 165.0, 146.0, 144.0, 35.0, 89.0, 0.0, 0.0, 149.0, 151.0, 169.0, 16.0, 0.0, 144.0, 188.0, 197.0, 191.0, 175.0, 0.0, 0.0, 0.0, 0.0, 93.0, 128.0, 94.0, 94.0, 172.0, 0.0, 110.0, 99.0, 118.0, 119.0, 168.0, 190.0, 200.0, 183.0, 153.0, 155.0, 159.0, 176.0, 199.0, 152.0, 0.0, 123.0, 57.0, 68.0, 179.0, 198.0, 157.0, 170.0, 160.0, 191.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.663986512775555, "mean_inference_ms": 1.5897519583513888, "mean_action_processing_ms": 0.25846742954319424, "mean_env_wait_ms": 0.1997353290149758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009660840034484863, "StateBufferConnector_ms": 0.0037484169006347656, "ViewRequirementAgentConnector_ms": 0.11632192134857178}, "num_episodes": 18, "episode_return_max": 194.0, "episode_return_min": -542.0, "episode_return_mean": -185.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.94259798829226, "num_env_steps_trained_throughput_per_sec": 76.94259798829226, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 52403.02, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52402.919, "sample_time_ms": 1298.326, "learn_time_ms": 51083.619, "learn_throughput": 78.303, "synch_weights_time_ms": 17.02}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-35-23", "timestamp": 1723520123, "time_this_iter_s": 52.054829120635986, "time_total_s": 2698.8232378959656, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaffcca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2698.8232378959656, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.24324324324324, "ram_util_percent": 80.02837837837838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134263108773206, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.270578380110402, "policy_loss": -0.00809983150397856, "vf_loss": 8.277701681631584, "vf_explained_var": 0.2833942922650191, "kl": 0.005786909524111867, "entropy": 1.0934468165907278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.387281981914763, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.761454478016606, "policy_loss": -0.01458353864980083, "vf_loss": 7.773662749295513, "vf_explained_var": -0.3150111523254839, "kl": 0.010556666767608774, "entropy": 1.2844479562744262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 229.0, "episode_reward_min": -523.0, "episode_reward_mean": -155.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -208.595, "predator_policy": 130.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, -299.0, -261.0, -15.0, -523.0, -468.0, -147.0, -317.0, -1.0, -372.0, -375.0, -141.0, -498.0, -283.0, -14.0, -284.0, -289.0, -1.0, 32.0, -375.0, -441.0, -353.0, -440.0, -156.0, -439.0, -253.0, -382.0, -261.0, -324.0, 0.0, -303.0, -354.0, -11.0, 168.0, 4.0, -11.0, 19.0, 34.0, -385.0, -125.0, -326.0, -11.0, -263.0, -11.0, -132.0, -392.0, 0.0, 0.0, -257.0, -176.0, -28.0, -364.0, -362.0, -344.0, -374.0, -103.0, -400.0, 46.0, -55.0, 194.0, -2.0, -377.0, -53.0, -6.0, -339.0, 0.0, 0.0, 36.0, 166.0, -187.0, 7.0, 52.0, -12.0, -165.0, 91.0, 2.0, -341.0, -49.0, 65.0, -385.0, -89.0, -151.0, -230.0, -288.0, -446.0, -101.0, -159.0, 229.0, -145.0, -357.0, -72.0, -13.0, -36.0, -172.0, 88.0, 111.0, 140.0, -308.0, 1.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-394.0, -12.0, -329.0, -307.0, -394.0, -239.0, -4.0, -347.0, -374.0, -356.0, -337.0, -313.0, -315.0, -2.0, -306.0, -392.0, 15.0, -314.0, -368.0, -365.0, -272.0, -260.0, -307.0, 0.0, -310.0, -384.0, -316.0, -300.0, -318.0, 0.0, -281.0, -396.0, -396.0, -268.0, 0.0, -2.0, 0.0, -300.0, -400.0, -354.0, -392.0, -248.0, -330.0, -391.0, -367.0, -339.0, -366.0, -134.0, -374.0, -258.0, -337.0, -269.0, -343.0, -391.0, -296.0, -320.0, -323.0, -348.0, 0.0, 0.0, -360.0, -290.0, -363.0, -352.0, 0.0, -362.0, 86.0, 66.0, 0.0, -340.0, -390.0, 0.0, 0.0, -292.0, 0.0, -40.0, -385.0, -369.0, -276.0, 0.0, -330.0, -352.0, 0.0, -394.0, -244.0, -369.0, 0.0, -390.0, 0.0, -298.0, -384.0, -396.0, 0.0, 0.0, 0.0, 0.0, -294.0, -290.0, 0.0, -360.0, 0.0, -368.0, -352.0, -352.0, -373.0, -364.0, -353.0, -364.0, -326.0, -319.0, -124.0, -290.0, -285.0, -280.0, 0.0, -244.0, -139.0, -40.0, 194.0, 0.0, -292.0, -10.0, -292.0, -270.0, -123.0, -74.0, 0.0, -391.0, -337.0, -368.0, 0.0, 0.0, 0.0, 0.0, -185.0, 0.0, 166.0, -188.0, -32.0, -327.0, -202.0, 0.0, 0.0, -185.0, 0.0, -370.0, -382.0, -166.0, -310.0, 93.0, 0.0, -333.0, -304.0, -388.0, 0.0, -172.0, -2.0, -58.0, -390.0, -372.0, -334.0, -82.0, -380.0, -122.0, -158.0, -164.0, -242.0, -361.0, -362.0, -344.0, -6.0, -336.0, -183.0, -349.0, 93.0, 86.0, -221.0, -199.0, -295.0, -382.0, -348.0, -70.0, 0.0, -376.0, -322.0, 0.0, -400.0, 0.0, 0.0, 27.0, 126.0, -390.0, -44.0, 148.0, -313.0, -379.0, -12.0, -292.0, -179.0, 0.0], "policy_predator_policy_reward": [197.0, 160.0, 164.0, 173.0, 177.0, 195.0, 174.0, 162.0, 7.0, 200.0, 0.0, 182.0, 0.0, 170.0, 190.0, 191.0, 139.0, 159.0, 173.0, 188.0, 157.0, 0.0, 166.0, 0.0, 0.0, 196.0, 161.0, 172.0, 152.0, 152.0, 200.0, 193.0, 176.0, 199.0, 1.0, 0.0, 166.0, 166.0, 200.0, 179.0, 199.0, 0.0, 199.0, 169.0, 190.0, 76.0, 191.0, 153.0, 193.0, 0.0, 179.0, 174.0, 194.0, 158.0, 168.0, 187.0, 193.0, 154.0, 0.0, 0.0, 167.0, 180.0, 185.0, 176.0, 178.0, 173.0, 16.0, 0.0, 176.0, 168.0, 188.0, 191.0, 157.0, 154.0, 37.0, 37.0, 174.0, 195.0, 0.0, 151.0, 190.0, 166.0, 186.0, 197.0, 186.0, 164.0, 189.0, 190.0, 0.0, 166.0, 199.0, 189.0, 0.0, 0.0, 0.0, 0.0, 145.0, 182.0, 171.0, 13.0, 186.0, 154.0, 157.0, 183.0, 185.0, 190.0, 188.0, 185.0, 175.0, 96.0, 160.0, 151.0, 0.0, 165.0, 146.0, 144.0, 35.0, 89.0, 0.0, 0.0, 149.0, 151.0, 169.0, 16.0, 0.0, 144.0, 188.0, 197.0, 191.0, 175.0, 0.0, 0.0, 0.0, 0.0, 93.0, 128.0, 94.0, 94.0, 172.0, 0.0, 110.0, 99.0, 118.0, 119.0, 168.0, 190.0, 200.0, 183.0, 153.0, 155.0, 159.0, 176.0, 199.0, 152.0, 0.0, 123.0, 57.0, 68.0, 179.0, 198.0, 157.0, 170.0, 160.0, 191.0, 0.0, 92.0, 128.0, 187.0, 192.0, 68.0, 178.0, 63.0, 186.0, 187.0, 31.0, 19.0, 158.0, 117.0, 195.0, 125.0, 186.0, 160.0, 175.0, 188.0, 171.0, 115.0, 200.0, 28.0, 31.0, 30.0, 183.0, 192.0, 36.0, 0.0, 190.0, 194.0, 159.0, 146.0, 114.0, 88.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.663522127404404, "mean_inference_ms": 1.5870375414038733, "mean_action_processing_ms": 0.25832518354123835, "mean_env_wait_ms": 0.19965121785503293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008538484573364258, "StateBufferConnector_ms": 0.0031126737594604492, "ViewRequirementAgentConnector_ms": 0.10948467254638672}, "num_episodes": 18, "episode_return_max": 229.0, "episode_return_min": -523.0, "episode_return_mean": -155.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.06730638534742, "num_env_steps_trained_throughput_per_sec": 78.06730638534742, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 52095.213, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52095.111, "sample_time_ms": 1279.575, "learn_time_ms": 50794.463, "learn_throughput": 78.749, "synch_weights_time_ms": 16.83}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-36-14", "timestamp": 1723520174, "time_this_iter_s": 51.286070823669434, "time_total_s": 2750.109308719635, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80163a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2750.109308719635, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 34.705479452054796, "ram_util_percent": 80.12465753424658}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.381011435468361, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.580425184744375, "policy_loss": -0.009623760489559678, "vf_loss": 7.58895999918539, "vf_explained_var": 0.42000440327578753, "kl": 0.006452977037197679, "entropy": 1.1050470505441938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.9976447976140115, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.453404754305643, "policy_loss": -0.01221084053155094, "vf_loss": 8.463564485469192, "vf_explained_var": -0.20126288602591821, "kl": 0.009116028601757687, "entropy": 1.237434061052938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 331.0, "episode_reward_min": -446.0, "episode_reward_mean": -102.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -177.895, "predator_policy": 126.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, -375.0, -441.0, -353.0, -440.0, -156.0, -439.0, -253.0, -382.0, -261.0, -324.0, 0.0, -303.0, -354.0, -11.0, 168.0, 4.0, -11.0, 19.0, 34.0, -385.0, -125.0, -326.0, -11.0, -263.0, -11.0, -132.0, -392.0, 0.0, 0.0, -257.0, -176.0, -28.0, -364.0, -362.0, -344.0, -374.0, -103.0, -400.0, 46.0, -55.0, 194.0, -2.0, -377.0, -53.0, -6.0, -339.0, 0.0, 0.0, 36.0, 166.0, -187.0, 7.0, 52.0, -12.0, -165.0, 91.0, 2.0, -341.0, -49.0, 65.0, -385.0, -89.0, -151.0, -230.0, -288.0, -446.0, -101.0, -159.0, 229.0, -145.0, -357.0, -72.0, -13.0, -36.0, -172.0, 88.0, 111.0, 140.0, -308.0, 1.0, 23.0, 120.0, 78.0, 331.0, 231.0, 0.0, 195.0, -166.0, -179.0, -146.0, -95.0, 143.0, 4.0, -16.0, 44.0, 289.0, 181.0, -112.0, 17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -300.0, -400.0, -354.0, -392.0, -248.0, -330.0, -391.0, -367.0, -339.0, -366.0, -134.0, -374.0, -258.0, -337.0, -269.0, -343.0, -391.0, -296.0, -320.0, -323.0, -348.0, 0.0, 0.0, -360.0, -290.0, -363.0, -352.0, 0.0, -362.0, 86.0, 66.0, 0.0, -340.0, -390.0, 0.0, 0.0, -292.0, 0.0, -40.0, -385.0, -369.0, -276.0, 0.0, -330.0, -352.0, 0.0, -394.0, -244.0, -369.0, 0.0, -390.0, 0.0, -298.0, -384.0, -396.0, 0.0, 0.0, 0.0, 0.0, -294.0, -290.0, 0.0, -360.0, 0.0, -368.0, -352.0, -352.0, -373.0, -364.0, -353.0, -364.0, -326.0, -319.0, -124.0, -290.0, -285.0, -280.0, 0.0, -244.0, -139.0, -40.0, 194.0, 0.0, -292.0, -10.0, -292.0, -270.0, -123.0, -74.0, 0.0, -391.0, -337.0, -368.0, 0.0, 0.0, 0.0, 0.0, -185.0, 0.0, 166.0, -188.0, -32.0, -327.0, -202.0, 0.0, 0.0, -185.0, 0.0, -370.0, -382.0, -166.0, -310.0, 93.0, 0.0, -333.0, -304.0, -388.0, 0.0, -172.0, -2.0, -58.0, -390.0, -372.0, -334.0, -82.0, -380.0, -122.0, -158.0, -164.0, -242.0, -361.0, -362.0, -344.0, -6.0, -336.0, -183.0, -349.0, 93.0, 86.0, -221.0, -199.0, -295.0, -382.0, -348.0, -70.0, 0.0, -376.0, -322.0, 0.0, -400.0, 0.0, 0.0, 27.0, 126.0, -390.0, -44.0, 148.0, -313.0, -379.0, -12.0, -292.0, -179.0, 0.0, 167.0, -356.0, 95.0, -370.0, 155.0, 167.0, 152.0, -36.0, 0.0, 0.0, 41.0, 44.0, -275.0, -247.0, -235.0, -289.0, -358.0, -148.0, 53.0, -392.0, 136.0, 7.0, -307.0, 0.0, 0.0, -364.0, 0.0, 44.0, 196.0, -83.0, 189.0, -389.0, -156.0, -272.0, 0.0, -292.0], "policy_predator_policy_reward": [166.0, 166.0, 200.0, 179.0, 199.0, 0.0, 199.0, 169.0, 190.0, 76.0, 191.0, 153.0, 193.0, 0.0, 179.0, 174.0, 194.0, 158.0, 168.0, 187.0, 193.0, 154.0, 0.0, 0.0, 167.0, 180.0, 185.0, 176.0, 178.0, 173.0, 16.0, 0.0, 176.0, 168.0, 188.0, 191.0, 157.0, 154.0, 37.0, 37.0, 174.0, 195.0, 0.0, 151.0, 190.0, 166.0, 186.0, 197.0, 186.0, 164.0, 189.0, 190.0, 0.0, 166.0, 199.0, 189.0, 0.0, 0.0, 0.0, 0.0, 145.0, 182.0, 171.0, 13.0, 186.0, 154.0, 157.0, 183.0, 185.0, 190.0, 188.0, 185.0, 175.0, 96.0, 160.0, 151.0, 0.0, 165.0, 146.0, 144.0, 35.0, 89.0, 0.0, 0.0, 149.0, 151.0, 169.0, 16.0, 0.0, 144.0, 188.0, 197.0, 191.0, 175.0, 0.0, 0.0, 0.0, 0.0, 93.0, 128.0, 94.0, 94.0, 172.0, 0.0, 110.0, 99.0, 118.0, 119.0, 168.0, 190.0, 200.0, 183.0, 153.0, 155.0, 159.0, 176.0, 199.0, 152.0, 0.0, 123.0, 57.0, 68.0, 179.0, 198.0, 157.0, 170.0, 160.0, 191.0, 0.0, 92.0, 128.0, 187.0, 192.0, 68.0, 178.0, 63.0, 186.0, 187.0, 31.0, 19.0, 158.0, 117.0, 195.0, 125.0, 186.0, 160.0, 175.0, 188.0, 171.0, 115.0, 200.0, 28.0, 31.0, 30.0, 183.0, 192.0, 36.0, 0.0, 190.0, 194.0, 159.0, 146.0, 114.0, 88.0, 170.0, 139.0, 200.0, 153.0, 0.0, 9.0, 69.0, 46.0, 0.0, 0.0, 68.0, 42.0, 194.0, 162.0, 185.0, 160.0, 188.0, 172.0, 196.0, 48.0, 0.0, 0.0, 150.0, 161.0, 172.0, 176.0, 0.0, 0.0, 88.0, 88.0, 189.0, 192.0, 142.0, 174.0, 146.0, 163.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6629831409206297, "mean_inference_ms": 1.5843718669540288, "mean_action_processing_ms": 0.25823617174239116, "mean_env_wait_ms": 0.1995355247308698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007933259010314941, "StateBufferConnector_ms": 0.004088640213012695, "ViewRequirementAgentConnector_ms": 0.10715723037719727}, "num_episodes": 18, "episode_return_max": 331.0, "episode_return_min": -446.0, "episode_return_mean": -102.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.71653571465431, "num_env_steps_trained_throughput_per_sec": 77.71653571465431, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 52015.36, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52015.257, "sample_time_ms": 1225.394, "learn_time_ms": 50768.3, "learn_throughput": 78.789, "synch_weights_time_ms": 17.257}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-37-06", "timestamp": 1723520226, "time_this_iter_s": 51.51520895957947, "time_total_s": 2801.6245176792145, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8010940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2801.6245176792145, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 34.722972972972975, "ram_util_percent": 80.65945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.874341931166473, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.116952256929307, "policy_loss": -0.011034771940232347, "vf_loss": 4.126671103068761, "vf_explained_var": 0.4035008405882215, "kl": 0.007798028437924555, "entropy": 1.112033877170906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.69893376417261, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.647572345329971, "policy_loss": -0.0136428538118563, "vf_loss": 7.6590807637209615, "vf_explained_var": -0.08999115610248828, "kl": 0.009486293977022105, "entropy": 1.2115425871793555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 331.0, "episode_reward_min": -446.0, "episode_reward_mean": -24.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -118.695, "predator_policy": 106.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-326.0, -11.0, -263.0, -11.0, -132.0, -392.0, 0.0, 0.0, -257.0, -176.0, -28.0, -364.0, -362.0, -344.0, -374.0, -103.0, -400.0, 46.0, -55.0, 194.0, -2.0, -377.0, -53.0, -6.0, -339.0, 0.0, 0.0, 36.0, 166.0, -187.0, 7.0, 52.0, -12.0, -165.0, 91.0, 2.0, -341.0, -49.0, 65.0, -385.0, -89.0, -151.0, -230.0, -288.0, -446.0, -101.0, -159.0, 229.0, -145.0, -357.0, -72.0, -13.0, -36.0, -172.0, 88.0, 111.0, 140.0, -308.0, 1.0, 23.0, 120.0, 78.0, 331.0, 231.0, 0.0, 195.0, -166.0, -179.0, -146.0, -95.0, 143.0, 4.0, -16.0, 44.0, 289.0, 181.0, -112.0, 17.0, 155.0, 80.0, 93.0, 241.0, 0.0, 280.0, 292.0, 305.0, 274.0, 211.0, 199.0, -19.0, -89.0, -61.0, 262.0, 192.0, 289.0, 170.0, 327.0, 157.0, -3.0, 126.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-330.0, -352.0, 0.0, -394.0, -244.0, -369.0, 0.0, -390.0, 0.0, -298.0, -384.0, -396.0, 0.0, 0.0, 0.0, 0.0, -294.0, -290.0, 0.0, -360.0, 0.0, -368.0, -352.0, -352.0, -373.0, -364.0, -353.0, -364.0, -326.0, -319.0, -124.0, -290.0, -285.0, -280.0, 0.0, -244.0, -139.0, -40.0, 194.0, 0.0, -292.0, -10.0, -292.0, -270.0, -123.0, -74.0, 0.0, -391.0, -337.0, -368.0, 0.0, 0.0, 0.0, 0.0, -185.0, 0.0, 166.0, -188.0, -32.0, -327.0, -202.0, 0.0, 0.0, -185.0, 0.0, -370.0, -382.0, -166.0, -310.0, 93.0, 0.0, -333.0, -304.0, -388.0, 0.0, -172.0, -2.0, -58.0, -390.0, -372.0, -334.0, -82.0, -380.0, -122.0, -158.0, -164.0, -242.0, -361.0, -362.0, -344.0, -6.0, -336.0, -183.0, -349.0, 93.0, 86.0, -221.0, -199.0, -295.0, -382.0, -348.0, -70.0, 0.0, -376.0, -322.0, 0.0, -400.0, 0.0, 0.0, 27.0, 126.0, -390.0, -44.0, 148.0, -313.0, -379.0, -12.0, -292.0, -179.0, 0.0, 167.0, -356.0, 95.0, -370.0, 155.0, 167.0, 152.0, -36.0, 0.0, 0.0, 41.0, 44.0, -275.0, -247.0, -235.0, -289.0, -358.0, -148.0, 53.0, -392.0, 136.0, 7.0, -307.0, 0.0, 0.0, -364.0, 0.0, 44.0, 196.0, -83.0, 189.0, -389.0, -156.0, -272.0, 0.0, -292.0, 0.0, 125.0, 0.0, -84.0, 0.0, 12.0, 120.0, 23.0, 0.0, 0.0, -63.0, 200.0, 184.0, 21.0, 125.0, 173.0, 91.0, 142.0, 177.0, -102.0, 153.0, -58.0, -60.0, -74.0, -222.0, -157.0, 36.0, -194.0, 83.0, 118.0, -218.0, 143.0, 49.0, 142.0, 136.0, 16.0, 194.0, 66.0, 157.0, 0.0, -213.0, 8.0, 44.0, 0.0], "policy_predator_policy_reward": [190.0, 166.0, 186.0, 197.0, 186.0, 164.0, 189.0, 190.0, 0.0, 166.0, 199.0, 189.0, 0.0, 0.0, 0.0, 0.0, 145.0, 182.0, 171.0, 13.0, 186.0, 154.0, 157.0, 183.0, 185.0, 190.0, 188.0, 185.0, 175.0, 96.0, 160.0, 151.0, 0.0, 165.0, 146.0, 144.0, 35.0, 89.0, 0.0, 0.0, 149.0, 151.0, 169.0, 16.0, 0.0, 144.0, 188.0, 197.0, 191.0, 175.0, 0.0, 0.0, 0.0, 0.0, 93.0, 128.0, 94.0, 94.0, 172.0, 0.0, 110.0, 99.0, 118.0, 119.0, 168.0, 190.0, 200.0, 183.0, 153.0, 155.0, 159.0, 176.0, 199.0, 152.0, 0.0, 123.0, 57.0, 68.0, 179.0, 198.0, 157.0, 170.0, 160.0, 191.0, 0.0, 92.0, 128.0, 187.0, 192.0, 68.0, 178.0, 63.0, 186.0, 187.0, 31.0, 19.0, 158.0, 117.0, 195.0, 125.0, 186.0, 160.0, 175.0, 188.0, 171.0, 115.0, 200.0, 28.0, 31.0, 30.0, 183.0, 192.0, 36.0, 0.0, 190.0, 194.0, 159.0, 146.0, 114.0, 88.0, 170.0, 139.0, 200.0, 153.0, 0.0, 9.0, 69.0, 46.0, 0.0, 0.0, 68.0, 42.0, 194.0, 162.0, 185.0, 160.0, 188.0, 172.0, 196.0, 48.0, 0.0, 0.0, 150.0, 161.0, 172.0, 176.0, 0.0, 0.0, 88.0, 88.0, 189.0, 192.0, 142.0, 174.0, 146.0, 163.0, 24.0, 6.0, 86.0, 78.0, 30.0, 51.0, 59.0, 39.0, 0.0, 0.0, 82.0, 61.0, 42.0, 45.0, 5.0, 2.0, 9.0, 32.0, 42.0, 94.0, 22.0, 82.0, 26.0, 89.0, 138.0, 152.0, 97.0, 0.0, 11.0, 50.0, 133.0, 134.0, 45.0, 53.0, 18.0, 0.0, 33.0, 34.0, 0.0, 0.0, 73.0, 129.0, 46.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6623602620123421, "mean_inference_ms": 1.5806201827592412, "mean_action_processing_ms": 0.2580768768236853, "mean_env_wait_ms": 0.19938472091803802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006735682487487793, "StateBufferConnector_ms": 0.004093647003173828, "ViewRequirementAgentConnector_ms": 0.10792922973632812}, "num_episodes": 22, "episode_return_max": 331.0, "episode_return_min": -446.0, "episode_return_mean": -24.3, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.03135210350148, "num_env_steps_trained_throughput_per_sec": 76.03135210350148, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 52103.124, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52103.022, "sample_time_ms": 1230.762, "learn_time_ms": 50851.005, "learn_throughput": 78.661, "synch_weights_time_ms": 16.29}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-37-58", "timestamp": 1723520278, "time_this_iter_s": 52.64637088775635, "time_total_s": 2854.270888566971, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaffc160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2854.270888566971, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 38.37432432432432, "ram_util_percent": 82.01216216216217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.371721068765751, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.122620327258236, "policy_loss": -0.007028233997336535, "vf_loss": 3.1287045396824995, "vf_explained_var": 0.3806894575792646, "kl": 0.005594190414372088, "entropy": 1.0870513991704063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.647505052505977, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.905816369586521, "policy_loss": -0.012803774234646606, "vf_loss": 6.9167247986667375, "vf_explained_var": 0.24442312436759786, "kl": 0.008423779520845076, "entropy": 1.246035163364713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -446.0, "episode_reward_mean": 56.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -56.61, "predator_policy": 85.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -339.0, 0.0, 0.0, 36.0, 166.0, -187.0, 7.0, 52.0, -12.0, -165.0, 91.0, 2.0, -341.0, -49.0, 65.0, -385.0, -89.0, -151.0, -230.0, -288.0, -446.0, -101.0, -159.0, 229.0, -145.0, -357.0, -72.0, -13.0, -36.0, -172.0, 88.0, 111.0, 140.0, -308.0, 1.0, 23.0, 120.0, 78.0, 331.0, 231.0, 0.0, 195.0, -166.0, -179.0, -146.0, -95.0, 143.0, 4.0, -16.0, 44.0, 289.0, 181.0, -112.0, 17.0, 155.0, 80.0, 93.0, 241.0, 0.0, 280.0, 292.0, 305.0, 274.0, 211.0, 199.0, -19.0, -89.0, -61.0, 262.0, 192.0, 289.0, 170.0, 327.0, 157.0, -3.0, 126.0, 291.0, 48.0, 209.0, 149.0, 183.0, 284.0, 350.0, 338.0, 229.0, 312.0, 88.0, 78.0, 101.0, 173.0, 59.0, 322.0, 144.0, 269.0, -2.0, 0.0, 365.0, 162.0, 179.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -391.0, -337.0, -368.0, 0.0, 0.0, 0.0, 0.0, -185.0, 0.0, 166.0, -188.0, -32.0, -327.0, -202.0, 0.0, 0.0, -185.0, 0.0, -370.0, -382.0, -166.0, -310.0, 93.0, 0.0, -333.0, -304.0, -388.0, 0.0, -172.0, -2.0, -58.0, -390.0, -372.0, -334.0, -82.0, -380.0, -122.0, -158.0, -164.0, -242.0, -361.0, -362.0, -344.0, -6.0, -336.0, -183.0, -349.0, 93.0, 86.0, -221.0, -199.0, -295.0, -382.0, -348.0, -70.0, 0.0, -376.0, -322.0, 0.0, -400.0, 0.0, 0.0, 27.0, 126.0, -390.0, -44.0, 148.0, -313.0, -379.0, -12.0, -292.0, -179.0, 0.0, 167.0, -356.0, 95.0, -370.0, 155.0, 167.0, 152.0, -36.0, 0.0, 0.0, 41.0, 44.0, -275.0, -247.0, -235.0, -289.0, -358.0, -148.0, 53.0, -392.0, 136.0, 7.0, -307.0, 0.0, 0.0, -364.0, 0.0, 44.0, 196.0, -83.0, 189.0, -389.0, -156.0, -272.0, 0.0, -292.0, 0.0, 125.0, 0.0, -84.0, 0.0, 12.0, 120.0, 23.0, 0.0, 0.0, -63.0, 200.0, 184.0, 21.0, 125.0, 173.0, 91.0, 142.0, 177.0, -102.0, 153.0, -58.0, -60.0, -74.0, -222.0, -157.0, 36.0, -194.0, 83.0, 118.0, -218.0, 143.0, 49.0, 142.0, 136.0, 16.0, 194.0, 66.0, 157.0, 0.0, -213.0, 8.0, 44.0, 0.0, 111.0, 152.0, 31.0, -74.0, 18.0, 80.0, 0.0, 111.0, 140.0, -30.0, 179.0, 20.0, 180.0, 152.0, 196.0, 43.0, 50.0, 128.0, 145.0, 156.0, 1.0, 0.0, 23.0, -4.0, -70.0, 0.0, 0.0, 164.0, 70.0, -370.0, 124.0, 160.0, 101.0, 0.0, 135.0, 105.0, 0.0, -4.0, 0.0, 0.0, 188.0, 171.0, 50.0, 73.0, 171.0, 0.0], "policy_predator_policy_reward": [188.0, 197.0, 191.0, 175.0, 0.0, 0.0, 0.0, 0.0, 93.0, 128.0, 94.0, 94.0, 172.0, 0.0, 110.0, 99.0, 118.0, 119.0, 168.0, 190.0, 200.0, 183.0, 153.0, 155.0, 159.0, 176.0, 199.0, 152.0, 0.0, 123.0, 57.0, 68.0, 179.0, 198.0, 157.0, 170.0, 160.0, 191.0, 0.0, 92.0, 128.0, 187.0, 192.0, 68.0, 178.0, 63.0, 186.0, 187.0, 31.0, 19.0, 158.0, 117.0, 195.0, 125.0, 186.0, 160.0, 175.0, 188.0, 171.0, 115.0, 200.0, 28.0, 31.0, 30.0, 183.0, 192.0, 36.0, 0.0, 190.0, 194.0, 159.0, 146.0, 114.0, 88.0, 170.0, 139.0, 200.0, 153.0, 0.0, 9.0, 69.0, 46.0, 0.0, 0.0, 68.0, 42.0, 194.0, 162.0, 185.0, 160.0, 188.0, 172.0, 196.0, 48.0, 0.0, 0.0, 150.0, 161.0, 172.0, 176.0, 0.0, 0.0, 88.0, 88.0, 189.0, 192.0, 142.0, 174.0, 146.0, 163.0, 24.0, 6.0, 86.0, 78.0, 30.0, 51.0, 59.0, 39.0, 0.0, 0.0, 82.0, 61.0, 42.0, 45.0, 5.0, 2.0, 9.0, 32.0, 42.0, 94.0, 22.0, 82.0, 26.0, 89.0, 138.0, 152.0, 97.0, 0.0, 11.0, 50.0, 133.0, 134.0, 45.0, 53.0, 18.0, 0.0, 33.0, 34.0, 0.0, 0.0, 73.0, 129.0, 46.0, 36.0, 28.0, 0.0, 73.0, 18.0, 57.0, 54.0, 13.0, 25.0, 73.0, 0.0, 55.0, 30.0, 12.0, 6.0, 51.0, 48.0, 51.0, 0.0, 11.0, 0.0, 35.0, 52.0, 0.0, 59.0, 89.0, 82.0, 9.0, 0.0, 176.0, 183.0, 28.0, 10.0, 23.0, 20.0, 0.0, 29.0, 0.0, 2.0, 0.0, 0.0, 0.0, 6.0, 11.0, 28.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6616851152680429, "mean_inference_ms": 1.5768820586721626, "mean_action_processing_ms": 0.2579479406774411, "mean_env_wait_ms": 0.19921771038921846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035507678985595703, "StateBufferConnector_ms": 0.004179477691650391, "ViewRequirementAgentConnector_ms": 0.09772002696990967}, "num_episodes": 23, "episode_return_max": 365.0, "episode_return_min": -446.0, "episode_return_mean": 56.91, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.6562058663928, "num_env_steps_trained_throughput_per_sec": 76.6562058663928, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 52159.685, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52159.582, "sample_time_ms": 1236.269, "learn_time_ms": 50901.589, "learn_throughput": 78.583, "synch_weights_time_ms": 16.658}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-38-51", "timestamp": 1723520331, "time_this_iter_s": 52.23383712768555, "time_total_s": 2906.5047256946564, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8039430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2906.5047256946564, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.50945945945946, "ram_util_percent": 83.12972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.825688261582107, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.245354512381175, "policy_loss": -0.006324725007520072, "vf_loss": 3.250842660507828, "vf_explained_var": 0.23808063041596186, "kl": 0.004957531272669821, "entropy": 1.0958753269185464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.291615942861668, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.09804311429382, "policy_loss": -0.014267501310893783, "vf_loss": 8.110173146939152, "vf_explained_var": 0.26730775356923464, "kl": 0.009499769789317243, "entropy": 1.1882979760725032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -446.0, "episode_reward_mean": 105.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -15.03, "predator_policy": 67.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.0, -230.0, -288.0, -446.0, -101.0, -159.0, 229.0, -145.0, -357.0, -72.0, -13.0, -36.0, -172.0, 88.0, 111.0, 140.0, -308.0, 1.0, 23.0, 120.0, 78.0, 331.0, 231.0, 0.0, 195.0, -166.0, -179.0, -146.0, -95.0, 143.0, 4.0, -16.0, 44.0, 289.0, 181.0, -112.0, 17.0, 155.0, 80.0, 93.0, 241.0, 0.0, 280.0, 292.0, 305.0, 274.0, 211.0, 199.0, -19.0, -89.0, -61.0, 262.0, 192.0, 289.0, 170.0, 327.0, 157.0, -3.0, 126.0, 291.0, 48.0, 209.0, 149.0, 183.0, 284.0, 350.0, 338.0, 229.0, 312.0, 88.0, 78.0, 101.0, 173.0, 59.0, 322.0, 144.0, 269.0, -2.0, 0.0, 365.0, 162.0, 179.0, 156.0, 259.0, 169.0, 386.0, 330.0, 233.0, 170.0, 329.0, 185.0, 280.0, 380.0, 320.0, -27.0, 0.0, 156.0, 231.0, 26.0, 136.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-380.0, -122.0, -158.0, -164.0, -242.0, -361.0, -362.0, -344.0, -6.0, -336.0, -183.0, -349.0, 93.0, 86.0, -221.0, -199.0, -295.0, -382.0, -348.0, -70.0, 0.0, -376.0, -322.0, 0.0, -400.0, 0.0, 0.0, 27.0, 126.0, -390.0, -44.0, 148.0, -313.0, -379.0, -12.0, -292.0, -179.0, 0.0, 167.0, -356.0, 95.0, -370.0, 155.0, 167.0, 152.0, -36.0, 0.0, 0.0, 41.0, 44.0, -275.0, -247.0, -235.0, -289.0, -358.0, -148.0, 53.0, -392.0, 136.0, 7.0, -307.0, 0.0, 0.0, -364.0, 0.0, 44.0, 196.0, -83.0, 189.0, -389.0, -156.0, -272.0, 0.0, -292.0, 0.0, 125.0, 0.0, -84.0, 0.0, 12.0, 120.0, 23.0, 0.0, 0.0, -63.0, 200.0, 184.0, 21.0, 125.0, 173.0, 91.0, 142.0, 177.0, -102.0, 153.0, -58.0, -60.0, -74.0, -222.0, -157.0, 36.0, -194.0, 83.0, 118.0, -218.0, 143.0, 49.0, 142.0, 136.0, 16.0, 194.0, 66.0, 157.0, 0.0, -213.0, 8.0, 44.0, 0.0, 111.0, 152.0, 31.0, -74.0, 18.0, 80.0, 0.0, 111.0, 140.0, -30.0, 179.0, 20.0, 180.0, 152.0, 196.0, 43.0, 50.0, 128.0, 145.0, 156.0, 1.0, 0.0, 23.0, -4.0, -70.0, 0.0, 0.0, 164.0, 70.0, -370.0, 124.0, 160.0, 101.0, 0.0, 135.0, 105.0, 0.0, -4.0, 0.0, 0.0, 188.0, 171.0, 50.0, 73.0, 171.0, 0.0, -79.0, 178.0, 104.0, 107.0, 0.0, 143.0, 190.0, 196.0, 187.0, 89.0, 131.0, 29.0, 153.0, -82.0, 129.0, 155.0, 48.0, 101.0, 150.0, 69.0, 182.0, 198.0, 148.0, 132.0, -378.0, 144.0, 0.0, 0.0, -84.0, 125.0, 17.0, 107.0, 1.0, 0.0, 133.0, -26.0], "policy_predator_policy_reward": [160.0, 191.0, 0.0, 92.0, 128.0, 187.0, 192.0, 68.0, 178.0, 63.0, 186.0, 187.0, 31.0, 19.0, 158.0, 117.0, 195.0, 125.0, 186.0, 160.0, 175.0, 188.0, 171.0, 115.0, 200.0, 28.0, 31.0, 30.0, 183.0, 192.0, 36.0, 0.0, 190.0, 194.0, 159.0, 146.0, 114.0, 88.0, 170.0, 139.0, 200.0, 153.0, 0.0, 9.0, 69.0, 46.0, 0.0, 0.0, 68.0, 42.0, 194.0, 162.0, 185.0, 160.0, 188.0, 172.0, 196.0, 48.0, 0.0, 0.0, 150.0, 161.0, 172.0, 176.0, 0.0, 0.0, 88.0, 88.0, 189.0, 192.0, 142.0, 174.0, 146.0, 163.0, 24.0, 6.0, 86.0, 78.0, 30.0, 51.0, 59.0, 39.0, 0.0, 0.0, 82.0, 61.0, 42.0, 45.0, 5.0, 2.0, 9.0, 32.0, 42.0, 94.0, 22.0, 82.0, 26.0, 89.0, 138.0, 152.0, 97.0, 0.0, 11.0, 50.0, 133.0, 134.0, 45.0, 53.0, 18.0, 0.0, 33.0, 34.0, 0.0, 0.0, 73.0, 129.0, 46.0, 36.0, 28.0, 0.0, 73.0, 18.0, 57.0, 54.0, 13.0, 25.0, 73.0, 0.0, 55.0, 30.0, 12.0, 6.0, 51.0, 48.0, 51.0, 0.0, 11.0, 0.0, 35.0, 52.0, 0.0, 59.0, 89.0, 82.0, 9.0, 0.0, 176.0, 183.0, 28.0, 10.0, 23.0, 20.0, 0.0, 29.0, 0.0, 2.0, 0.0, 0.0, 0.0, 6.0, 11.0, 28.0, 8.0, 0.0, 53.0, 4.0, 43.0, 5.0, 9.0, 17.0, 0.0, 0.0, 20.0, 34.0, 33.0, 40.0, 99.0, 0.0, 21.0, 24.0, 18.0, 18.0, 23.0, 38.0, 0.0, 0.0, 25.0, 15.0, 18.0, 189.0, 0.0, 0.0, 21.0, 94.0, 60.0, 47.0, 0.0, 25.0, 9.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6611247778146324, "mean_inference_ms": 1.5742526529850018, "mean_action_processing_ms": 0.2578585486167093, "mean_env_wait_ms": 0.1990965969974363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036295652389526367, "StateBufferConnector_ms": 0.00426030158996582, "ViewRequirementAgentConnector_ms": 0.09933722019195557}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -446.0, "episode_return_mean": 105.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.82880634758506, "num_env_steps_trained_throughput_per_sec": 76.82880634758506, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 52118.172, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52118.086, "sample_time_ms": 1242.197, "learn_time_ms": 50854.618, "learn_throughput": 78.656, "synch_weights_time_ms": 16.299}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-39-43", "timestamp": 1723520383, "time_this_iter_s": 52.11820387840271, "time_total_s": 2958.622929573059, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8039ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2958.622929573059, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 37.61081081081081, "ram_util_percent": 82.49729729729731}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.664288359975059, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5347607060399635, "policy_loss": -0.007314156000280664, "vf_loss": 1.541398729107998, "vf_explained_var": 0.1440900638305321, "kl": 0.00801350067999703, "entropy": 1.0897618511681835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.638791748392519, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.582811645982126, "policy_loss": -0.008974109909856918, "vf_loss": 8.590270356526451, "vf_explained_var": 0.2825047112646557, "kl": 0.00673515546293385, "entropy": 1.137699644527738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -179.0, "episode_reward_mean": 175.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -392.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 39.47, "predator_policy": 48.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 120.0, 78.0, 331.0, 231.0, 0.0, 195.0, -166.0, -179.0, -146.0, -95.0, 143.0, 4.0, -16.0, 44.0, 289.0, 181.0, -112.0, 17.0, 155.0, 80.0, 93.0, 241.0, 0.0, 280.0, 292.0, 305.0, 274.0, 211.0, 199.0, -19.0, -89.0, -61.0, 262.0, 192.0, 289.0, 170.0, 327.0, 157.0, -3.0, 126.0, 291.0, 48.0, 209.0, 149.0, 183.0, 284.0, 350.0, 338.0, 229.0, 312.0, 88.0, 78.0, 101.0, 173.0, 59.0, 322.0, 144.0, 269.0, -2.0, 0.0, 365.0, 162.0, 179.0, 156.0, 259.0, 169.0, 386.0, 330.0, 233.0, 170.0, 329.0, 185.0, 280.0, 380.0, 320.0, -27.0, 0.0, 156.0, 231.0, 26.0, 136.0, 228.0, 308.0, 318.0, 307.0, 322.0, 367.0, 301.0, 165.0, 258.0, 193.0, 197.0, 388.0, 215.0, 345.0, 251.0, 274.0, 227.0, 387.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-179.0, 0.0, 167.0, -356.0, 95.0, -370.0, 155.0, 167.0, 152.0, -36.0, 0.0, 0.0, 41.0, 44.0, -275.0, -247.0, -235.0, -289.0, -358.0, -148.0, 53.0, -392.0, 136.0, 7.0, -307.0, 0.0, 0.0, -364.0, 0.0, 44.0, 196.0, -83.0, 189.0, -389.0, -156.0, -272.0, 0.0, -292.0, 0.0, 125.0, 0.0, -84.0, 0.0, 12.0, 120.0, 23.0, 0.0, 0.0, -63.0, 200.0, 184.0, 21.0, 125.0, 173.0, 91.0, 142.0, 177.0, -102.0, 153.0, -58.0, -60.0, -74.0, -222.0, -157.0, 36.0, -194.0, 83.0, 118.0, -218.0, 143.0, 49.0, 142.0, 136.0, 16.0, 194.0, 66.0, 157.0, 0.0, -213.0, 8.0, 44.0, 0.0, 111.0, 152.0, 31.0, -74.0, 18.0, 80.0, 0.0, 111.0, 140.0, -30.0, 179.0, 20.0, 180.0, 152.0, 196.0, 43.0, 50.0, 128.0, 145.0, 156.0, 1.0, 0.0, 23.0, -4.0, -70.0, 0.0, 0.0, 164.0, 70.0, -370.0, 124.0, 160.0, 101.0, 0.0, 135.0, 105.0, 0.0, -4.0, 0.0, 0.0, 188.0, 171.0, 50.0, 73.0, 171.0, 0.0, -79.0, 178.0, 104.0, 107.0, 0.0, 143.0, 190.0, 196.0, 187.0, 89.0, 131.0, 29.0, 153.0, -82.0, 129.0, 155.0, 48.0, 101.0, 150.0, 69.0, 182.0, 198.0, 148.0, 132.0, -378.0, 144.0, 0.0, 0.0, -84.0, 125.0, 17.0, 107.0, 1.0, 0.0, 133.0, -26.0, 111.0, -29.0, 137.0, 156.0, 139.0, 144.0, 108.0, 155.0, 99.0, 190.0, 196.0, 157.0, 128.0, 137.0, 145.0, 0.0, 92.0, 157.0, -5.0, 178.0, 197.0, 0.0, 193.0, 191.0, 135.0, 48.0, 131.0, 189.0, 118.0, 17.0, 112.0, 151.0, 92.0, -23.0, 187.0, 197.0], "policy_predator_policy_reward": [114.0, 88.0, 170.0, 139.0, 200.0, 153.0, 0.0, 9.0, 69.0, 46.0, 0.0, 0.0, 68.0, 42.0, 194.0, 162.0, 185.0, 160.0, 188.0, 172.0, 196.0, 48.0, 0.0, 0.0, 150.0, 161.0, 172.0, 176.0, 0.0, 0.0, 88.0, 88.0, 189.0, 192.0, 142.0, 174.0, 146.0, 163.0, 24.0, 6.0, 86.0, 78.0, 30.0, 51.0, 59.0, 39.0, 0.0, 0.0, 82.0, 61.0, 42.0, 45.0, 5.0, 2.0, 9.0, 32.0, 42.0, 94.0, 22.0, 82.0, 26.0, 89.0, 138.0, 152.0, 97.0, 0.0, 11.0, 50.0, 133.0, 134.0, 45.0, 53.0, 18.0, 0.0, 33.0, 34.0, 0.0, 0.0, 73.0, 129.0, 46.0, 36.0, 28.0, 0.0, 73.0, 18.0, 57.0, 54.0, 13.0, 25.0, 73.0, 0.0, 55.0, 30.0, 12.0, 6.0, 51.0, 48.0, 51.0, 0.0, 11.0, 0.0, 35.0, 52.0, 0.0, 59.0, 89.0, 82.0, 9.0, 0.0, 176.0, 183.0, 28.0, 10.0, 23.0, 20.0, 0.0, 29.0, 0.0, 2.0, 0.0, 0.0, 0.0, 6.0, 11.0, 28.0, 8.0, 0.0, 53.0, 4.0, 43.0, 5.0, 9.0, 17.0, 0.0, 0.0, 20.0, 34.0, 33.0, 40.0, 99.0, 0.0, 21.0, 24.0, 18.0, 18.0, 23.0, 38.0, 0.0, 0.0, 25.0, 15.0, 18.0, 189.0, 0.0, 0.0, 21.0, 94.0, 60.0, 47.0, 0.0, 25.0, 9.0, 20.0, 72.0, 74.0, 1.0, 14.0, 28.0, 7.0, 21.0, 23.0, 0.0, 33.0, 2.0, 12.0, 9.0, 27.0, 2.0, 18.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 2.0, 2.0, 13.0, 19.0, 18.0, 7.0, 58.0, 58.0, 3.0, 8.0, 82.0, 76.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6605415290479985, "mean_inference_ms": 1.5716657883866612, "mean_action_processing_ms": 0.257787138081499, "mean_env_wait_ms": 0.19898899994585592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036259889602661133, "StateBufferConnector_ms": 0.004255175590515137, "ViewRequirementAgentConnector_ms": 0.10096609592437744}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -179.0, "episode_return_mean": 175.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.56230662914503, "num_env_steps_trained_throughput_per_sec": 74.56230662914503, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 52267.44, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52267.349, "sample_time_ms": 1223.515, "learn_time_ms": 51022.167, "learn_throughput": 78.397, "synch_weights_time_ms": 16.494}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-40-37", "timestamp": 1723520437, "time_this_iter_s": 53.689491987228394, "time_total_s": 3012.3124215602875, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80305e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3012.3124215602875, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 41.46103896103896, "ram_util_percent": 82.62207792207793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.380308944838388, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.179478491172589, "policy_loss": -0.01041396904352402, "vf_loss": 3.1890346672169114, "vf_explained_var": 0.41388323089433093, "kl": 0.010166382554822781, "entropy": 1.0817690400534836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.996804874094705, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.851257812913763, "policy_loss": -0.014044319440132727, "vf_loss": 8.863601160554028, "vf_explained_var": -0.0805729488847117, "kl": 0.007559884350418081, "entropy": 1.0871753274763702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -89.0, "episode_reward_mean": 216.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 78.01, "predator_policy": 30.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0, 0.0, 280.0, 292.0, 305.0, 274.0, 211.0, 199.0, -19.0, -89.0, -61.0, 262.0, 192.0, 289.0, 170.0, 327.0, 157.0, -3.0, 126.0, 291.0, 48.0, 209.0, 149.0, 183.0, 284.0, 350.0, 338.0, 229.0, 312.0, 88.0, 78.0, 101.0, 173.0, 59.0, 322.0, 144.0, 269.0, -2.0, 0.0, 365.0, 162.0, 179.0, 156.0, 259.0, 169.0, 386.0, 330.0, 233.0, 170.0, 329.0, 185.0, 280.0, 380.0, 320.0, -27.0, 0.0, 156.0, 231.0, 26.0, 136.0, 228.0, 308.0, 318.0, 307.0, 322.0, 367.0, 301.0, 165.0, 258.0, 193.0, 197.0, 388.0, 215.0, 345.0, 251.0, 274.0, 227.0, 387.0, 341.0, 251.0, 330.0, 122.0, 58.0, 264.0, 103.0, 319.0, 318.0, 250.0, 223.0, 291.0, 123.0, 288.0, 313.0, 294.0, 321.0, 308.0, 201.0, 114.0, 352.0, 246.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [120.0, 23.0, 0.0, 0.0, -63.0, 200.0, 184.0, 21.0, 125.0, 173.0, 91.0, 142.0, 177.0, -102.0, 153.0, -58.0, -60.0, -74.0, -222.0, -157.0, 36.0, -194.0, 83.0, 118.0, -218.0, 143.0, 49.0, 142.0, 136.0, 16.0, 194.0, 66.0, 157.0, 0.0, -213.0, 8.0, 44.0, 0.0, 111.0, 152.0, 31.0, -74.0, 18.0, 80.0, 0.0, 111.0, 140.0, -30.0, 179.0, 20.0, 180.0, 152.0, 196.0, 43.0, 50.0, 128.0, 145.0, 156.0, 1.0, 0.0, 23.0, -4.0, -70.0, 0.0, 0.0, 164.0, 70.0, -370.0, 124.0, 160.0, 101.0, 0.0, 135.0, 105.0, 0.0, -4.0, 0.0, 0.0, 188.0, 171.0, 50.0, 73.0, 171.0, 0.0, -79.0, 178.0, 104.0, 107.0, 0.0, 143.0, 190.0, 196.0, 187.0, 89.0, 131.0, 29.0, 153.0, -82.0, 129.0, 155.0, 48.0, 101.0, 150.0, 69.0, 182.0, 198.0, 148.0, 132.0, -378.0, 144.0, 0.0, 0.0, -84.0, 125.0, 17.0, 107.0, 1.0, 0.0, 133.0, -26.0, 111.0, -29.0, 137.0, 156.0, 139.0, 144.0, 108.0, 155.0, 99.0, 190.0, 196.0, 157.0, 128.0, 137.0, 145.0, 0.0, 92.0, 157.0, -5.0, 178.0, 197.0, 0.0, 193.0, 191.0, 135.0, 48.0, 131.0, 189.0, 118.0, 17.0, 112.0, 151.0, 92.0, -23.0, 187.0, 197.0, 154.0, 166.0, 123.0, 95.0, 89.0, 194.0, 0.0, 122.0, 86.0, -186.0, 193.0, -44.0, 8.0, 90.0, 153.0, 130.0, 130.0, 173.0, 66.0, 182.0, 5.0, 191.0, 91.0, 147.0, 128.0, -78.0, 199.0, 80.0, 65.0, 166.0, 86.0, 168.0, 110.0, 172.0, 181.0, 127.0, 103.0, 85.0, 78.0, 0.0, 146.0, 186.0, 106.0, -7.0], "policy_predator_policy_reward": [59.0, 39.0, 0.0, 0.0, 82.0, 61.0, 42.0, 45.0, 5.0, 2.0, 9.0, 32.0, 42.0, 94.0, 22.0, 82.0, 26.0, 89.0, 138.0, 152.0, 97.0, 0.0, 11.0, 50.0, 133.0, 134.0, 45.0, 53.0, 18.0, 0.0, 33.0, 34.0, 0.0, 0.0, 73.0, 129.0, 46.0, 36.0, 28.0, 0.0, 73.0, 18.0, 57.0, 54.0, 13.0, 25.0, 73.0, 0.0, 55.0, 30.0, 12.0, 6.0, 51.0, 48.0, 51.0, 0.0, 11.0, 0.0, 35.0, 52.0, 0.0, 59.0, 89.0, 82.0, 9.0, 0.0, 176.0, 183.0, 28.0, 10.0, 23.0, 20.0, 0.0, 29.0, 0.0, 2.0, 0.0, 0.0, 0.0, 6.0, 11.0, 28.0, 8.0, 0.0, 53.0, 4.0, 43.0, 5.0, 9.0, 17.0, 0.0, 0.0, 20.0, 34.0, 33.0, 40.0, 99.0, 0.0, 21.0, 24.0, 18.0, 18.0, 23.0, 38.0, 0.0, 0.0, 25.0, 15.0, 18.0, 189.0, 0.0, 0.0, 21.0, 94.0, 60.0, 47.0, 0.0, 25.0, 9.0, 20.0, 72.0, 74.0, 1.0, 14.0, 28.0, 7.0, 21.0, 23.0, 0.0, 33.0, 2.0, 12.0, 9.0, 27.0, 2.0, 18.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 2.0, 2.0, 13.0, 19.0, 18.0, 7.0, 58.0, 58.0, 3.0, 8.0, 82.0, 76.0, 3.0, 0.0, 10.0, 11.0, 22.0, 11.0, 10.0, 37.0, 0.0, 0.0, 121.0, 37.0, 56.0, 59.0, 5.0, 0.0, 11.0, 25.0, 11.0, 4.0, 2.0, 0.0, 15.0, 12.0, 40.0, 13.0, 46.0, 27.0, 9.0, 0.0, 44.0, 38.0, 19.0, 21.0, 19.0, 20.0, 0.0, 0.0, 1.0, 12.0, 0.0, 36.0, 4.0, 16.0, 71.0, 76.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6598717769371053, "mean_inference_ms": 1.5678065435429596, "mean_action_processing_ms": 0.2576295851653551, "mean_env_wait_ms": 0.19890957786675703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036559104919433594, "StateBufferConnector_ms": 0.0032488107681274414, "ViewRequirementAgentConnector_ms": 0.10263121128082275}, "num_episodes": 22, "episode_return_max": 388.0, "episode_return_min": -89.0, "episode_return_mean": 216.84, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.25106435721041, "num_env_steps_trained_throughput_per_sec": 76.25106435721041, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 52320.084, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52320.014, "sample_time_ms": 1224.84, "learn_time_ms": 51075.57, "learn_throughput": 78.315, "synch_weights_time_ms": 14.952}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-41-29", "timestamp": 1723520489, "time_this_iter_s": 52.50478506088257, "time_total_s": 3064.81720662117, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8016ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3064.81720662117, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.63243243243244, "ram_util_percent": 82.46891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.449660178845521, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1768720257219183, "policy_loss": -0.009866705265083405, "vf_loss": 2.185851848693121, "vf_explained_var": 0.36020924136752175, "kl": 0.010511235853513108, "entropy": 1.0905094245438853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.49947468849717, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.19464334053968, "policy_loss": -0.012136779049234022, "vf_loss": 9.205144837293675, "vf_explained_var": -0.3946519644487472, "kl": 0.007267921085609073, "entropy": 1.0912977272240574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -27.0, "episode_reward_mean": 240.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 95.295, "predator_policy": 24.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.0, 291.0, 48.0, 209.0, 149.0, 183.0, 284.0, 350.0, 338.0, 229.0, 312.0, 88.0, 78.0, 101.0, 173.0, 59.0, 322.0, 144.0, 269.0, -2.0, 0.0, 365.0, 162.0, 179.0, 156.0, 259.0, 169.0, 386.0, 330.0, 233.0, 170.0, 329.0, 185.0, 280.0, 380.0, 320.0, -27.0, 0.0, 156.0, 231.0, 26.0, 136.0, 228.0, 308.0, 318.0, 307.0, 322.0, 367.0, 301.0, 165.0, 258.0, 193.0, 197.0, 388.0, 215.0, 345.0, 251.0, 274.0, 227.0, 387.0, 341.0, 251.0, 330.0, 122.0, 58.0, 264.0, 103.0, 319.0, 318.0, 250.0, 223.0, 291.0, 123.0, 288.0, 313.0, 294.0, 321.0, 308.0, 201.0, 114.0, 352.0, 246.0, 332.0, 328.0, 349.0, 256.0, 346.0, 340.0, 243.0, 350.0, 309.0, 346.0, 177.0, 319.0, 242.0, 132.0, 317.0, 333.0, 334.0, 323.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [44.0, 0.0, 111.0, 152.0, 31.0, -74.0, 18.0, 80.0, 0.0, 111.0, 140.0, -30.0, 179.0, 20.0, 180.0, 152.0, 196.0, 43.0, 50.0, 128.0, 145.0, 156.0, 1.0, 0.0, 23.0, -4.0, -70.0, 0.0, 0.0, 164.0, 70.0, -370.0, 124.0, 160.0, 101.0, 0.0, 135.0, 105.0, 0.0, -4.0, 0.0, 0.0, 188.0, 171.0, 50.0, 73.0, 171.0, 0.0, -79.0, 178.0, 104.0, 107.0, 0.0, 143.0, 190.0, 196.0, 187.0, 89.0, 131.0, 29.0, 153.0, -82.0, 129.0, 155.0, 48.0, 101.0, 150.0, 69.0, 182.0, 198.0, 148.0, 132.0, -378.0, 144.0, 0.0, 0.0, -84.0, 125.0, 17.0, 107.0, 1.0, 0.0, 133.0, -26.0, 111.0, -29.0, 137.0, 156.0, 139.0, 144.0, 108.0, 155.0, 99.0, 190.0, 196.0, 157.0, 128.0, 137.0, 145.0, 0.0, 92.0, 157.0, -5.0, 178.0, 197.0, 0.0, 193.0, 191.0, 135.0, 48.0, 131.0, 189.0, 118.0, 17.0, 112.0, 151.0, 92.0, -23.0, 187.0, 197.0, 154.0, 166.0, 123.0, 95.0, 89.0, 194.0, 0.0, 122.0, 86.0, -186.0, 193.0, -44.0, 8.0, 90.0, 153.0, 130.0, 130.0, 173.0, 66.0, 182.0, 5.0, 191.0, 91.0, 147.0, 128.0, -78.0, 199.0, 80.0, 65.0, 166.0, 86.0, 168.0, 110.0, 172.0, 181.0, 127.0, 103.0, 85.0, 78.0, 0.0, 146.0, 186.0, 106.0, -7.0, 136.0, 171.0, 118.0, 191.0, 137.0, 189.0, 101.0, 105.0, 145.0, 183.0, 180.0, 160.0, 18.0, 125.0, 169.0, 180.0, 151.0, 123.0, 156.0, 190.0, 0.0, 155.0, 182.0, 47.0, -31.0, 197.0, -63.0, 29.0, 185.0, 99.0, 107.0, 196.0, 156.0, 156.0, 173.0, 137.0], "policy_predator_policy_reward": [46.0, 36.0, 28.0, 0.0, 73.0, 18.0, 57.0, 54.0, 13.0, 25.0, 73.0, 0.0, 55.0, 30.0, 12.0, 6.0, 51.0, 48.0, 51.0, 0.0, 11.0, 0.0, 35.0, 52.0, 0.0, 59.0, 89.0, 82.0, 9.0, 0.0, 176.0, 183.0, 28.0, 10.0, 23.0, 20.0, 0.0, 29.0, 0.0, 2.0, 0.0, 0.0, 0.0, 6.0, 11.0, 28.0, 8.0, 0.0, 53.0, 4.0, 43.0, 5.0, 9.0, 17.0, 0.0, 0.0, 20.0, 34.0, 33.0, 40.0, 99.0, 0.0, 21.0, 24.0, 18.0, 18.0, 23.0, 38.0, 0.0, 0.0, 25.0, 15.0, 18.0, 189.0, 0.0, 0.0, 21.0, 94.0, 60.0, 47.0, 0.0, 25.0, 9.0, 20.0, 72.0, 74.0, 1.0, 14.0, 28.0, 7.0, 21.0, 23.0, 0.0, 33.0, 2.0, 12.0, 9.0, 27.0, 2.0, 18.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 2.0, 2.0, 13.0, 19.0, 18.0, 7.0, 58.0, 58.0, 3.0, 8.0, 82.0, 76.0, 3.0, 0.0, 10.0, 11.0, 22.0, 11.0, 10.0, 37.0, 0.0, 0.0, 121.0, 37.0, 56.0, 59.0, 5.0, 0.0, 11.0, 25.0, 11.0, 4.0, 2.0, 0.0, 15.0, 12.0, 40.0, 13.0, 46.0, 27.0, 9.0, 0.0, 44.0, 38.0, 19.0, 21.0, 19.0, 20.0, 0.0, 0.0, 1.0, 12.0, 0.0, 36.0, 4.0, 16.0, 71.0, 76.0, 25.0, 0.0, 0.0, 19.0, 21.0, 2.0, 31.0, 19.0, 18.0, 0.0, 0.0, 0.0, 44.0, 56.0, 0.0, 1.0, 24.0, 11.0, 0.0, 0.0, 14.0, 8.0, 47.0, 43.0, 76.0, 0.0, 81.0, 85.0, 33.0, 0.0, 12.0, 18.0, 0.0, 22.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6593699645388186, "mean_inference_ms": 1.5667554365863703, "mean_action_processing_ms": 0.2576103181513662, "mean_env_wait_ms": 0.1988690592815216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003634929656982422, "StateBufferConnector_ms": 0.003184676170349121, "ViewRequirementAgentConnector_ms": 0.10097205638885498}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -27.0, "episode_return_mean": 240.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.13543211779361, "num_env_steps_trained_throughput_per_sec": 74.13543211779361, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 52311.675, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52311.604, "sample_time_ms": 1213.037, "learn_time_ms": 51077.773, "learn_throughput": 78.312, "synch_weights_time_ms": 15.518}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-42-23", "timestamp": 1723520543, "time_this_iter_s": 54.00881385803223, "time_total_s": 3118.8260204792023, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7ffeee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3118.8260204792023, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 42.64805194805194, "ram_util_percent": 82.21948051948053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052709736079766, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.491493395049736, "policy_loss": -0.009276472383410369, "vf_loss": 1.5001726155400907, "vf_explained_var": 0.1716981087412153, "kl": 0.007078561187101885, "entropy": 1.1368168239240293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.69929187398739, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.050453471128272, "policy_loss": -0.011504939580631871, "vf_loss": 9.06014365493936, "vf_explained_var": -0.46597566819064834, "kl": 0.008065533472049203, "entropy": 1.0981422997656323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -27.0, "episode_reward_mean": 270.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 114.88, "predator_policy": 20.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, 156.0, 259.0, 169.0, 386.0, 330.0, 233.0, 170.0, 329.0, 185.0, 280.0, 380.0, 320.0, -27.0, 0.0, 156.0, 231.0, 26.0, 136.0, 228.0, 308.0, 318.0, 307.0, 322.0, 367.0, 301.0, 165.0, 258.0, 193.0, 197.0, 388.0, 215.0, 345.0, 251.0, 274.0, 227.0, 387.0, 341.0, 251.0, 330.0, 122.0, 58.0, 264.0, 103.0, 319.0, 318.0, 250.0, 223.0, 291.0, 123.0, 288.0, 313.0, 294.0, 321.0, 308.0, 201.0, 114.0, 352.0, 246.0, 332.0, 328.0, 349.0, 256.0, 346.0, 340.0, 243.0, 350.0, 309.0, 346.0, 177.0, 319.0, 242.0, 132.0, 317.0, 333.0, 334.0, 323.0, 279.0, 286.0, 256.0, 313.0, 321.0, 379.0, 362.0, 262.0, 294.0, 337.0, 346.0, 335.0, 375.0, 373.0, 298.0, 338.0, 345.0, 307.0, 277.0, 292.0, 233.0, 390.0, 262.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [171.0, 0.0, -79.0, 178.0, 104.0, 107.0, 0.0, 143.0, 190.0, 196.0, 187.0, 89.0, 131.0, 29.0, 153.0, -82.0, 129.0, 155.0, 48.0, 101.0, 150.0, 69.0, 182.0, 198.0, 148.0, 132.0, -378.0, 144.0, 0.0, 0.0, -84.0, 125.0, 17.0, 107.0, 1.0, 0.0, 133.0, -26.0, 111.0, -29.0, 137.0, 156.0, 139.0, 144.0, 108.0, 155.0, 99.0, 190.0, 196.0, 157.0, 128.0, 137.0, 145.0, 0.0, 92.0, 157.0, -5.0, 178.0, 197.0, 0.0, 193.0, 191.0, 135.0, 48.0, 131.0, 189.0, 118.0, 17.0, 112.0, 151.0, 92.0, -23.0, 187.0, 197.0, 154.0, 166.0, 123.0, 95.0, 89.0, 194.0, 0.0, 122.0, 86.0, -186.0, 193.0, -44.0, 8.0, 90.0, 153.0, 130.0, 130.0, 173.0, 66.0, 182.0, 5.0, 191.0, 91.0, 147.0, 128.0, -78.0, 199.0, 80.0, 65.0, 166.0, 86.0, 168.0, 110.0, 172.0, 181.0, 127.0, 103.0, 85.0, 78.0, 0.0, 146.0, 186.0, 106.0, -7.0, 136.0, 171.0, 118.0, 191.0, 137.0, 189.0, 101.0, 105.0, 145.0, 183.0, 180.0, 160.0, 18.0, 125.0, 169.0, 180.0, 151.0, 123.0, 156.0, 190.0, 0.0, 155.0, 182.0, 47.0, -31.0, 197.0, -63.0, 29.0, 185.0, 99.0, 107.0, 196.0, 156.0, 156.0, 173.0, 137.0, 130.0, 107.0, 147.0, 121.0, 143.0, 94.0, 116.0, 149.0, 169.0, 127.0, 199.0, 180.0, 197.0, 150.0, 136.0, 88.0, 49.0, 143.0, 155.0, 166.0, 122.0, 191.0, 149.0, 176.0, 179.0, 195.0, 185.0, 176.0, 120.0, 176.0, 135.0, 200.0, 197.0, 122.0, 189.0, 77.0, 115.0, 158.0, 126.0, 133.0, 81.0, 95.0, 198.0, 190.0, 161.0, 54.0], "policy_predator_policy_reward": [8.0, 0.0, 53.0, 4.0, 43.0, 5.0, 9.0, 17.0, 0.0, 0.0, 20.0, 34.0, 33.0, 40.0, 99.0, 0.0, 21.0, 24.0, 18.0, 18.0, 23.0, 38.0, 0.0, 0.0, 25.0, 15.0, 18.0, 189.0, 0.0, 0.0, 21.0, 94.0, 60.0, 47.0, 0.0, 25.0, 9.0, 20.0, 72.0, 74.0, 1.0, 14.0, 28.0, 7.0, 21.0, 23.0, 0.0, 33.0, 2.0, 12.0, 9.0, 27.0, 2.0, 18.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 2.0, 2.0, 13.0, 19.0, 18.0, 7.0, 58.0, 58.0, 3.0, 8.0, 82.0, 76.0, 3.0, 0.0, 10.0, 11.0, 22.0, 11.0, 10.0, 37.0, 0.0, 0.0, 121.0, 37.0, 56.0, 59.0, 5.0, 0.0, 11.0, 25.0, 11.0, 4.0, 2.0, 0.0, 15.0, 12.0, 40.0, 13.0, 46.0, 27.0, 9.0, 0.0, 44.0, 38.0, 19.0, 21.0, 19.0, 20.0, 0.0, 0.0, 1.0, 12.0, 0.0, 36.0, 4.0, 16.0, 71.0, 76.0, 25.0, 0.0, 0.0, 19.0, 21.0, 2.0, 31.0, 19.0, 18.0, 0.0, 0.0, 0.0, 44.0, 56.0, 0.0, 1.0, 24.0, 11.0, 0.0, 0.0, 14.0, 8.0, 47.0, 43.0, 76.0, 0.0, 81.0, 85.0, 33.0, 0.0, 12.0, 18.0, 0.0, 22.0, 13.0, 0.0, 30.0, 12.0, 2.0, 16.0, 18.0, 1.0, 15.0, 33.0, 1.0, 24.0, 0.0, 0.0, 1.0, 14.0, 33.0, 5.0, 54.0, 48.0, 1.0, 15.0, 16.0, 17.0, 8.0, 2.0, 1.0, 0.0, 9.0, 3.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 19.0, 22.0, 0.0, 4.0, 10.0, 23.0, 33.0, 24.0, 1.0, 1.0, 47.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6610767987810532, "mean_inference_ms": 1.5682223727354987, "mean_action_processing_ms": 0.257935201946265, "mean_env_wait_ms": 0.19927471849174297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01316678524017334, "StateBufferConnector_ms": 0.01043093204498291, "ViewRequirementAgentConnector_ms": 0.1970534324645996}, "num_episodes": 23, "episode_return_max": 390.0, "episode_return_min": -27.0, "episode_return_mean": 270.15, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.40629414821271, "num_env_steps_trained_throughput_per_sec": 71.40629414821271, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 52762.612, "restore_workers_time_ms": 0.025, "training_step_time_ms": 52762.507, "sample_time_ms": 1299.521, "learn_time_ms": 51442.271, "learn_throughput": 77.757, "synch_weights_time_ms": 15.343}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-43-19", "timestamp": 1723520599, "time_this_iter_s": 56.061832904815674, "time_total_s": 3174.887853384018, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaffcc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3174.887853384018, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 46.165, "ram_util_percent": 83.345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.497870850184608, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.192342942700815, "policy_loss": -0.008325943246326118, "vf_loss": 1.2000638538882846, "vf_explained_var": 0.24290397510957465, "kl": 0.007170787919970875, "entropy": 1.1198357475497736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.207989908778478, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.604767221622366, "policy_loss": -0.01055606170976288, "vf_loss": 8.613638803189394, "vf_explained_var": 0.14198303802934273, "kl": 0.007486467473520642, "entropy": 1.092127928910432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 58.0, "episode_reward_mean": 285.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -186.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 121.0}, "policy_reward_mean": {"prey_policy": 125.495, "predator_policy": 17.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.0, 228.0, 308.0, 318.0, 307.0, 322.0, 367.0, 301.0, 165.0, 258.0, 193.0, 197.0, 388.0, 215.0, 345.0, 251.0, 274.0, 227.0, 387.0, 341.0, 251.0, 330.0, 122.0, 58.0, 264.0, 103.0, 319.0, 318.0, 250.0, 223.0, 291.0, 123.0, 288.0, 313.0, 294.0, 321.0, 308.0, 201.0, 114.0, 352.0, 246.0, 332.0, 328.0, 349.0, 256.0, 346.0, 340.0, 243.0, 350.0, 309.0, 346.0, 177.0, 319.0, 242.0, 132.0, 317.0, 333.0, 334.0, 323.0, 279.0, 286.0, 256.0, 313.0, 321.0, 379.0, 362.0, 262.0, 294.0, 337.0, 346.0, 335.0, 375.0, 373.0, 298.0, 338.0, 345.0, 307.0, 277.0, 292.0, 233.0, 390.0, 262.0, 179.0, 341.0, 310.0, 325.0, 274.0, 198.0, 332.0, 314.0, 341.0, 327.0, 336.0, 333.0, 300.0, 280.0, 342.0, 362.0, 75.0, 351.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.0, -26.0, 111.0, -29.0, 137.0, 156.0, 139.0, 144.0, 108.0, 155.0, 99.0, 190.0, 196.0, 157.0, 128.0, 137.0, 145.0, 0.0, 92.0, 157.0, -5.0, 178.0, 197.0, 0.0, 193.0, 191.0, 135.0, 48.0, 131.0, 189.0, 118.0, 17.0, 112.0, 151.0, 92.0, -23.0, 187.0, 197.0, 154.0, 166.0, 123.0, 95.0, 89.0, 194.0, 0.0, 122.0, 86.0, -186.0, 193.0, -44.0, 8.0, 90.0, 153.0, 130.0, 130.0, 173.0, 66.0, 182.0, 5.0, 191.0, 91.0, 147.0, 128.0, -78.0, 199.0, 80.0, 65.0, 166.0, 86.0, 168.0, 110.0, 172.0, 181.0, 127.0, 103.0, 85.0, 78.0, 0.0, 146.0, 186.0, 106.0, -7.0, 136.0, 171.0, 118.0, 191.0, 137.0, 189.0, 101.0, 105.0, 145.0, 183.0, 180.0, 160.0, 18.0, 125.0, 169.0, 180.0, 151.0, 123.0, 156.0, 190.0, 0.0, 155.0, 182.0, 47.0, -31.0, 197.0, -63.0, 29.0, 185.0, 99.0, 107.0, 196.0, 156.0, 156.0, 173.0, 137.0, 130.0, 107.0, 147.0, 121.0, 143.0, 94.0, 116.0, 149.0, 169.0, 127.0, 199.0, 180.0, 197.0, 150.0, 136.0, 88.0, 49.0, 143.0, 155.0, 166.0, 122.0, 191.0, 149.0, 176.0, 179.0, 195.0, 185.0, 176.0, 120.0, 176.0, 135.0, 200.0, 197.0, 122.0, 189.0, 77.0, 115.0, 158.0, 126.0, 133.0, 81.0, 95.0, 198.0, 190.0, 161.0, 54.0, -4.0, 181.0, 186.0, 149.0, 180.0, 109.0, 148.0, 156.0, 100.0, 155.0, 198.0, 0.0, 170.0, 154.0, 147.0, 166.0, 133.0, 180.0, 125.0, 170.0, 193.0, 107.0, 127.0, 188.0, 138.0, 129.0, 94.0, 147.0, 149.0, 166.0, 192.0, 157.0, 17.0, -54.0, 170.0, 161.0], "policy_predator_policy_reward": [9.0, 20.0, 72.0, 74.0, 1.0, 14.0, 28.0, 7.0, 21.0, 23.0, 0.0, 33.0, 2.0, 12.0, 9.0, 27.0, 2.0, 18.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 2.0, 2.0, 13.0, 19.0, 18.0, 7.0, 58.0, 58.0, 3.0, 8.0, 82.0, 76.0, 3.0, 0.0, 10.0, 11.0, 22.0, 11.0, 10.0, 37.0, 0.0, 0.0, 121.0, 37.0, 56.0, 59.0, 5.0, 0.0, 11.0, 25.0, 11.0, 4.0, 2.0, 0.0, 15.0, 12.0, 40.0, 13.0, 46.0, 27.0, 9.0, 0.0, 44.0, 38.0, 19.0, 21.0, 19.0, 20.0, 0.0, 0.0, 1.0, 12.0, 0.0, 36.0, 4.0, 16.0, 71.0, 76.0, 25.0, 0.0, 0.0, 19.0, 21.0, 2.0, 31.0, 19.0, 18.0, 0.0, 0.0, 0.0, 44.0, 56.0, 0.0, 1.0, 24.0, 11.0, 0.0, 0.0, 14.0, 8.0, 47.0, 43.0, 76.0, 0.0, 81.0, 85.0, 33.0, 0.0, 12.0, 18.0, 0.0, 22.0, 13.0, 0.0, 30.0, 12.0, 2.0, 16.0, 18.0, 1.0, 15.0, 33.0, 1.0, 24.0, 0.0, 0.0, 1.0, 14.0, 33.0, 5.0, 54.0, 48.0, 1.0, 15.0, 16.0, 17.0, 8.0, 2.0, 1.0, 0.0, 9.0, 3.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 19.0, 22.0, 0.0, 4.0, 10.0, 23.0, 33.0, 24.0, 1.0, 1.0, 47.0, 0.0, 0.0, 2.0, 6.0, 0.0, 11.0, 10.0, 21.0, 0.0, 4.0, 15.0, 0.0, 0.0, 3.0, 5.0, 1.0, 0.0, 21.0, 7.0, 27.0, 5.0, 28.0, 8.0, 13.0, 5.0, 24.0, 9.0, 4.0, 35.0, 11.0, 16.0, 0.0, 13.0, 69.0, 43.0, 3.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6624097450890222, "mean_inference_ms": 1.5692686516534655, "mean_action_processing_ms": 0.2581883986942624, "mean_env_wait_ms": 0.1996344529616163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013073325157165527, "StateBufferConnector_ms": 0.010822653770446777, "ViewRequirementAgentConnector_ms": 0.2003849744796753}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": 58.0, "episode_return_mean": 285.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.49541044755127, "num_env_steps_trained_throughput_per_sec": 72.49541044755127, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 53081.522, "restore_workers_time_ms": 0.024, "training_step_time_ms": 53081.427, "sample_time_ms": 1297.928, "learn_time_ms": 51762.907, "learn_throughput": 77.275, "synch_weights_time_ms": 14.663}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-44-15", "timestamp": 1723520655, "time_this_iter_s": 55.214699029922485, "time_total_s": 3230.1025524139404, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8039550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3230.1025524139404, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 42.67435897435896, "ram_util_percent": 82.075641025641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.881837809779656, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6306483912089513, "policy_loss": -0.009738659905885697, "vf_loss": 2.6395100420114224, "vf_explained_var": 0.1310548729051358, "kl": 0.010394162922105179, "entropy": 1.1475284060473165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.324507109324138, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.145077822448085, "policy_loss": -0.011455148055893247, "vf_loss": 9.154964396057936, "vf_explained_var": -0.5224280767339878, "kl": 0.006971423668528847, "entropy": 1.0844466417554826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 58.0, "episode_reward_mean": 292.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -186.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 121.0}, "policy_reward_mean": {"prey_policy": 129.79, "predator_policy": 16.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [387.0, 341.0, 251.0, 330.0, 122.0, 58.0, 264.0, 103.0, 319.0, 318.0, 250.0, 223.0, 291.0, 123.0, 288.0, 313.0, 294.0, 321.0, 308.0, 201.0, 114.0, 352.0, 246.0, 332.0, 328.0, 349.0, 256.0, 346.0, 340.0, 243.0, 350.0, 309.0, 346.0, 177.0, 319.0, 242.0, 132.0, 317.0, 333.0, 334.0, 323.0, 279.0, 286.0, 256.0, 313.0, 321.0, 379.0, 362.0, 262.0, 294.0, 337.0, 346.0, 335.0, 375.0, 373.0, 298.0, 338.0, 345.0, 307.0, 277.0, 292.0, 233.0, 390.0, 262.0, 179.0, 341.0, 310.0, 325.0, 274.0, 198.0, 332.0, 314.0, 341.0, 327.0, 336.0, 333.0, 300.0, 280.0, 342.0, 362.0, 75.0, 351.0, 335.0, 351.0, 284.0, 329.0, 268.0, 197.0, 284.0, 261.0, 230.0, 330.0, 236.0, 357.0, 340.0, 313.0, 304.0, 315.0, 333.0, 376.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [187.0, 197.0, 154.0, 166.0, 123.0, 95.0, 89.0, 194.0, 0.0, 122.0, 86.0, -186.0, 193.0, -44.0, 8.0, 90.0, 153.0, 130.0, 130.0, 173.0, 66.0, 182.0, 5.0, 191.0, 91.0, 147.0, 128.0, -78.0, 199.0, 80.0, 65.0, 166.0, 86.0, 168.0, 110.0, 172.0, 181.0, 127.0, 103.0, 85.0, 78.0, 0.0, 146.0, 186.0, 106.0, -7.0, 136.0, 171.0, 118.0, 191.0, 137.0, 189.0, 101.0, 105.0, 145.0, 183.0, 180.0, 160.0, 18.0, 125.0, 169.0, 180.0, 151.0, 123.0, 156.0, 190.0, 0.0, 155.0, 182.0, 47.0, -31.0, 197.0, -63.0, 29.0, 185.0, 99.0, 107.0, 196.0, 156.0, 156.0, 173.0, 137.0, 130.0, 107.0, 147.0, 121.0, 143.0, 94.0, 116.0, 149.0, 169.0, 127.0, 199.0, 180.0, 197.0, 150.0, 136.0, 88.0, 49.0, 143.0, 155.0, 166.0, 122.0, 191.0, 149.0, 176.0, 179.0, 195.0, 185.0, 176.0, 120.0, 176.0, 135.0, 200.0, 197.0, 122.0, 189.0, 77.0, 115.0, 158.0, 126.0, 133.0, 81.0, 95.0, 198.0, 190.0, 161.0, 54.0, -4.0, 181.0, 186.0, 149.0, 180.0, 109.0, 148.0, 156.0, 100.0, 155.0, 198.0, 0.0, 170.0, 154.0, 147.0, 166.0, 133.0, 180.0, 125.0, 170.0, 193.0, 107.0, 127.0, 188.0, 138.0, 129.0, 94.0, 147.0, 149.0, 166.0, 192.0, 157.0, 17.0, -54.0, 170.0, 161.0, 197.0, 119.0, 181.0, 170.0, 150.0, 117.0, 165.0, 138.0, 187.0, 81.0, -16.0, 145.0, 105.0, 148.0, 128.0, 66.0, -22.0, 188.0, 122.0, 163.0, 144.0, 81.0, 128.0, 185.0, 150.0, 176.0, 159.0, 109.0, 107.0, 157.0, 111.0, 173.0, 152.0, 177.0, 199.0, 172.0], "policy_predator_policy_reward": [3.0, 0.0, 10.0, 11.0, 22.0, 11.0, 10.0, 37.0, 0.0, 0.0, 121.0, 37.0, 56.0, 59.0, 5.0, 0.0, 11.0, 25.0, 11.0, 4.0, 2.0, 0.0, 15.0, 12.0, 40.0, 13.0, 46.0, 27.0, 9.0, 0.0, 44.0, 38.0, 19.0, 21.0, 19.0, 20.0, 0.0, 0.0, 1.0, 12.0, 0.0, 36.0, 4.0, 16.0, 71.0, 76.0, 25.0, 0.0, 0.0, 19.0, 21.0, 2.0, 31.0, 19.0, 18.0, 0.0, 0.0, 0.0, 44.0, 56.0, 0.0, 1.0, 24.0, 11.0, 0.0, 0.0, 14.0, 8.0, 47.0, 43.0, 76.0, 0.0, 81.0, 85.0, 33.0, 0.0, 12.0, 18.0, 0.0, 22.0, 13.0, 0.0, 30.0, 12.0, 2.0, 16.0, 18.0, 1.0, 15.0, 33.0, 1.0, 24.0, 0.0, 0.0, 1.0, 14.0, 33.0, 5.0, 54.0, 48.0, 1.0, 15.0, 16.0, 17.0, 8.0, 2.0, 1.0, 0.0, 9.0, 3.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 19.0, 22.0, 0.0, 4.0, 10.0, 23.0, 33.0, 24.0, 1.0, 1.0, 47.0, 0.0, 0.0, 2.0, 6.0, 0.0, 11.0, 10.0, 21.0, 0.0, 4.0, 15.0, 0.0, 0.0, 3.0, 5.0, 1.0, 0.0, 21.0, 7.0, 27.0, 5.0, 28.0, 8.0, 13.0, 5.0, 24.0, 9.0, 4.0, 35.0, 11.0, 16.0, 0.0, 13.0, 69.0, 43.0, 3.0, 17.0, 19.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 26.0, 0.0, 0.0, 56.0, 12.0, 0.0, 31.0, 38.0, 29.0, 30.0, 34.0, 12.0, 33.0, 11.0, 0.0, 24.0, 20.0, 4.0, 10.0, 17.0, 28.0, 16.0, 24.0, 7.0, 24.0, 4.0, 0.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6640047471566133, "mean_inference_ms": 1.5706342306455792, "mean_action_processing_ms": 0.258507193969478, "mean_env_wait_ms": 0.20000439823851152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013344526290893555, "StateBufferConnector_ms": 0.01080787181854248, "ViewRequirementAgentConnector_ms": 0.19936835765838623}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": 58.0, "episode_return_mean": 292.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.56525895933919, "num_env_steps_trained_throughput_per_sec": 74.56525895933919, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 53322.167, "restore_workers_time_ms": 0.024, "training_step_time_ms": 53322.068, "sample_time_ms": 1303.129, "learn_time_ms": 51998.491, "learn_throughput": 76.925, "synch_weights_time_ms": 14.736}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-45-08", "timestamp": 1723520708, "time_this_iter_s": 53.69770097732544, "time_total_s": 3283.800253391266, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8039790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3283.800253391266, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 40.85064935064935, "ram_util_percent": 80.62597402597403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.435507461885926, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2610194954291853, "policy_loss": -0.011321388176524096, "vf_loss": 3.2713054008584805, "vf_explained_var": 0.09734819430522818, "kl": 0.012272365785771091, "entropy": 1.1509020011891764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.025497930895083, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.844802227474394, "policy_loss": -0.013229032087253121, "vf_loss": 8.855701709928967, "vf_explained_var": 0.11793737976008623, "kl": 0.010353598374080786, "entropy": 1.1253215339448717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 75.0, "episode_reward_mean": 293.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 91.0}, "policy_reward_mean": {"prey_policy": 129.475, "predator_policy": 17.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.0, 332.0, 328.0, 349.0, 256.0, 346.0, 340.0, 243.0, 350.0, 309.0, 346.0, 177.0, 319.0, 242.0, 132.0, 317.0, 333.0, 334.0, 323.0, 279.0, 286.0, 256.0, 313.0, 321.0, 379.0, 362.0, 262.0, 294.0, 337.0, 346.0, 335.0, 375.0, 373.0, 298.0, 338.0, 345.0, 307.0, 277.0, 292.0, 233.0, 390.0, 262.0, 179.0, 341.0, 310.0, 325.0, 274.0, 198.0, 332.0, 314.0, 341.0, 327.0, 336.0, 333.0, 300.0, 280.0, 342.0, 362.0, 75.0, 351.0, 335.0, 351.0, 284.0, 329.0, 268.0, 197.0, 284.0, 261.0, 230.0, 330.0, 236.0, 357.0, 340.0, 313.0, 304.0, 315.0, 333.0, 376.0, 305.0, 212.0, 212.0, 343.0, 295.0, 256.0, 307.0, 222.0, 305.0, 231.0, 328.0, 313.0, 275.0, 293.0, 277.0, 231.0, 249.0, 107.0, 325.0, 140.0, 340.0, 122.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [106.0, -7.0, 136.0, 171.0, 118.0, 191.0, 137.0, 189.0, 101.0, 105.0, 145.0, 183.0, 180.0, 160.0, 18.0, 125.0, 169.0, 180.0, 151.0, 123.0, 156.0, 190.0, 0.0, 155.0, 182.0, 47.0, -31.0, 197.0, -63.0, 29.0, 185.0, 99.0, 107.0, 196.0, 156.0, 156.0, 173.0, 137.0, 130.0, 107.0, 147.0, 121.0, 143.0, 94.0, 116.0, 149.0, 169.0, 127.0, 199.0, 180.0, 197.0, 150.0, 136.0, 88.0, 49.0, 143.0, 155.0, 166.0, 122.0, 191.0, 149.0, 176.0, 179.0, 195.0, 185.0, 176.0, 120.0, 176.0, 135.0, 200.0, 197.0, 122.0, 189.0, 77.0, 115.0, 158.0, 126.0, 133.0, 81.0, 95.0, 198.0, 190.0, 161.0, 54.0, -4.0, 181.0, 186.0, 149.0, 180.0, 109.0, 148.0, 156.0, 100.0, 155.0, 198.0, 0.0, 170.0, 154.0, 147.0, 166.0, 133.0, 180.0, 125.0, 170.0, 193.0, 107.0, 127.0, 188.0, 138.0, 129.0, 94.0, 147.0, 149.0, 166.0, 192.0, 157.0, 17.0, -54.0, 170.0, 161.0, 197.0, 119.0, 181.0, 170.0, 150.0, 117.0, 165.0, 138.0, 187.0, 81.0, -16.0, 145.0, 105.0, 148.0, 128.0, 66.0, -22.0, 188.0, 122.0, 163.0, 144.0, 81.0, 128.0, 185.0, 150.0, 176.0, 159.0, 109.0, 107.0, 157.0, 111.0, 173.0, 152.0, 177.0, 199.0, 172.0, 147.0, 139.0, 125.0, -10.0, 44.0, 93.0, 142.0, 176.0, 158.0, 106.0, 160.0, 20.0, 95.0, 180.0, 197.0, 24.0, 134.0, 134.0, 89.0, 106.0, 146.0, 161.0, 134.0, 171.0, 94.0, 112.0, 88.0, 119.0, 143.0, 115.0, 47.0, 93.0, 148.0, 38.0, 198.0, -182.0, 144.0, 173.0, 140.0, 0.0, 167.0, 154.0, 107.0, -88.0], "policy_predator_policy_reward": [71.0, 76.0, 25.0, 0.0, 0.0, 19.0, 21.0, 2.0, 31.0, 19.0, 18.0, 0.0, 0.0, 0.0, 44.0, 56.0, 0.0, 1.0, 24.0, 11.0, 0.0, 0.0, 14.0, 8.0, 47.0, 43.0, 76.0, 0.0, 81.0, 85.0, 33.0, 0.0, 12.0, 18.0, 0.0, 22.0, 13.0, 0.0, 30.0, 12.0, 2.0, 16.0, 18.0, 1.0, 15.0, 33.0, 1.0, 24.0, 0.0, 0.0, 1.0, 14.0, 33.0, 5.0, 54.0, 48.0, 1.0, 15.0, 16.0, 17.0, 8.0, 2.0, 1.0, 0.0, 9.0, 3.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 19.0, 22.0, 0.0, 4.0, 10.0, 23.0, 33.0, 24.0, 1.0, 1.0, 47.0, 0.0, 0.0, 2.0, 6.0, 0.0, 11.0, 10.0, 21.0, 0.0, 4.0, 15.0, 0.0, 0.0, 3.0, 5.0, 1.0, 0.0, 21.0, 7.0, 27.0, 5.0, 28.0, 8.0, 13.0, 5.0, 24.0, 9.0, 4.0, 35.0, 11.0, 16.0, 0.0, 13.0, 69.0, 43.0, 3.0, 17.0, 19.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 26.0, 0.0, 0.0, 56.0, 12.0, 0.0, 31.0, 38.0, 29.0, 30.0, 34.0, 12.0, 33.0, 11.0, 0.0, 24.0, 20.0, 4.0, 10.0, 17.0, 28.0, 16.0, 24.0, 7.0, 24.0, 4.0, 0.0, 5.0, 0.0, 0.0, 19.0, 20.0, 77.0, 23.0, 52.0, 18.0, 7.0, 25.0, 6.0, 60.0, 16.0, 32.0, 0.0, 0.0, 1.0, 2.0, 35.0, 36.0, 0.0, 20.0, 1.0, 0.0, 8.0, 44.0, 25.0, 48.0, 38.0, 0.0, 19.0, 50.0, 41.0, 51.0, 12.0, 91.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 14.0, 30.0, 73.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6662828264408279, "mean_inference_ms": 1.573051002709249, "mean_action_processing_ms": 0.25893592011742855, "mean_env_wait_ms": 0.20051382633396084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014582514762878418, "StateBufferConnector_ms": 0.011516213417053223, "ViewRequirementAgentConnector_ms": 0.23648285865783691}, "num_episodes": 22, "episode_return_max": 390.0, "episode_return_min": 75.0, "episode_return_mean": 293.33, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.47826394300708, "num_env_steps_trained_throughput_per_sec": 71.47826394300708, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 53771.363, "restore_workers_time_ms": 0.024, "training_step_time_ms": 53771.263, "sample_time_ms": 1318.327, "learn_time_ms": 52431.425, "learn_throughput": 76.29, "synch_weights_time_ms": 15.424}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-46-04", "timestamp": 1723520764, "time_this_iter_s": 56.01857829093933, "time_total_s": 3339.818831682205, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a80aedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3339.818831682205, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 45.436708860759495, "ram_util_percent": 82.77848101265823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.198890770427765, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7128950106403815, "policy_loss": -0.015356064652383485, "vf_loss": 3.7271644474968078, "vf_explained_var": 0.12296680066951368, "kl": 0.012878457001445817, "entropy": 1.1537091680304714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.88779521543513, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.944696333042529, "policy_loss": -0.0091503836850207, "vf_loss": 8.952492230279105, "vf_explained_var": 0.041603568527433604, "kl": 0.006019946537219223, "entropy": 1.066295083553072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -163.0, "episode_reward_mean": 280.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 127.0}, "policy_reward_mean": {"prey_policy": 122.015, "predator_policy": 18.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.0, 379.0, 362.0, 262.0, 294.0, 337.0, 346.0, 335.0, 375.0, 373.0, 298.0, 338.0, 345.0, 307.0, 277.0, 292.0, 233.0, 390.0, 262.0, 179.0, 341.0, 310.0, 325.0, 274.0, 198.0, 332.0, 314.0, 341.0, 327.0, 336.0, 333.0, 300.0, 280.0, 342.0, 362.0, 75.0, 351.0, 335.0, 351.0, 284.0, 329.0, 268.0, 197.0, 284.0, 261.0, 230.0, 330.0, 236.0, 357.0, 340.0, 313.0, 304.0, 315.0, 333.0, 376.0, 305.0, 212.0, 212.0, 343.0, 295.0, 256.0, 307.0, 222.0, 305.0, 231.0, 328.0, 313.0, 275.0, 293.0, 277.0, 231.0, 249.0, 107.0, 325.0, 140.0, 340.0, 122.0, 379.0, 325.0, 328.0, 156.0, -94.0, 296.0, 301.0, 162.0, 311.0, 274.0, 242.0, 299.0, 8.0, 376.0, 328.0, -163.0, 256.0, 263.0, 258.0, 270.0, 381.0, 327.0, 195.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [169.0, 127.0, 199.0, 180.0, 197.0, 150.0, 136.0, 88.0, 49.0, 143.0, 155.0, 166.0, 122.0, 191.0, 149.0, 176.0, 179.0, 195.0, 185.0, 176.0, 120.0, 176.0, 135.0, 200.0, 197.0, 122.0, 189.0, 77.0, 115.0, 158.0, 126.0, 133.0, 81.0, 95.0, 198.0, 190.0, 161.0, 54.0, -4.0, 181.0, 186.0, 149.0, 180.0, 109.0, 148.0, 156.0, 100.0, 155.0, 198.0, 0.0, 170.0, 154.0, 147.0, 166.0, 133.0, 180.0, 125.0, 170.0, 193.0, 107.0, 127.0, 188.0, 138.0, 129.0, 94.0, 147.0, 149.0, 166.0, 192.0, 157.0, 17.0, -54.0, 170.0, 161.0, 197.0, 119.0, 181.0, 170.0, 150.0, 117.0, 165.0, 138.0, 187.0, 81.0, -16.0, 145.0, 105.0, 148.0, 128.0, 66.0, -22.0, 188.0, 122.0, 163.0, 144.0, 81.0, 128.0, 185.0, 150.0, 176.0, 159.0, 109.0, 107.0, 157.0, 111.0, 173.0, 152.0, 177.0, 199.0, 172.0, 147.0, 139.0, 125.0, -10.0, 44.0, 93.0, 142.0, 176.0, 158.0, 106.0, 160.0, 20.0, 95.0, 180.0, 197.0, 24.0, 134.0, 134.0, 89.0, 106.0, 146.0, 161.0, 134.0, 171.0, 94.0, 112.0, 88.0, 119.0, 143.0, 115.0, 47.0, 93.0, 148.0, 38.0, 198.0, -182.0, 144.0, 173.0, 140.0, 0.0, 167.0, 154.0, 107.0, -88.0, 197.0, 178.0, 137.0, 177.0, 155.0, 155.0, -72.0, 137.0, -140.0, -101.0, 149.0, 113.0, 146.0, 148.0, 4.0, 58.0, 177.0, 125.0, 121.0, 106.0, 134.0, 30.0, 119.0, 149.0, -88.0, -60.0, 186.0, 190.0, 176.0, 145.0, -171.0, -139.0, 105.0, 129.0, 8.0, 190.0, 79.0, 109.0, 43.0, 166.0, 180.0, 199.0, 146.0, 147.0, 19.0, 106.0], "policy_predator_policy_reward": [1.0, 24.0, 0.0, 0.0, 1.0, 14.0, 33.0, 5.0, 54.0, 48.0, 1.0, 15.0, 16.0, 17.0, 8.0, 2.0, 1.0, 0.0, 9.0, 3.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 19.0, 22.0, 0.0, 4.0, 10.0, 23.0, 33.0, 24.0, 1.0, 1.0, 47.0, 0.0, 0.0, 2.0, 6.0, 0.0, 11.0, 10.0, 21.0, 0.0, 4.0, 15.0, 0.0, 0.0, 3.0, 5.0, 1.0, 0.0, 21.0, 7.0, 27.0, 5.0, 28.0, 8.0, 13.0, 5.0, 24.0, 9.0, 4.0, 35.0, 11.0, 16.0, 0.0, 13.0, 69.0, 43.0, 3.0, 17.0, 19.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 26.0, 0.0, 0.0, 56.0, 12.0, 0.0, 31.0, 38.0, 29.0, 30.0, 34.0, 12.0, 33.0, 11.0, 0.0, 24.0, 20.0, 4.0, 10.0, 17.0, 28.0, 16.0, 24.0, 7.0, 24.0, 4.0, 0.0, 5.0, 0.0, 0.0, 19.0, 20.0, 77.0, 23.0, 52.0, 18.0, 7.0, 25.0, 6.0, 60.0, 16.0, 32.0, 0.0, 0.0, 1.0, 2.0, 35.0, 36.0, 0.0, 20.0, 1.0, 0.0, 8.0, 44.0, 25.0, 48.0, 38.0, 0.0, 19.0, 50.0, 41.0, 51.0, 12.0, 91.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 14.0, 30.0, 73.0, 2.0, 2.0, 6.0, 5.0, 4.0, 14.0, 26.0, 65.0, 37.0, 110.0, 19.0, 15.0, 6.0, 1.0, 38.0, 62.0, 4.0, 5.0, 24.0, 23.0, 22.0, 56.0, 7.0, 24.0, 70.0, 86.0, 0.0, 0.0, 1.0, 6.0, 20.0, 127.0, 22.0, 0.0, 46.0, 19.0, 34.0, 36.0, 20.0, 41.0, 2.0, 0.0, 1.0, 33.0, 48.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6700326753966364, "mean_inference_ms": 1.5778025552604171, "mean_action_processing_ms": 0.25972001124293503, "mean_env_wait_ms": 0.20136991912929175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014678716659545898, "StateBufferConnector_ms": 0.011564493179321289, "ViewRequirementAgentConnector_ms": 0.24527406692504883}, "num_episodes": 23, "episode_return_max": 390.0, "episode_return_min": -163.0, "episode_return_mean": 280.55, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.5559970630098, "num_env_steps_trained_throughput_per_sec": 72.5559970630098, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 54023.359, "restore_workers_time_ms": 0.024, "training_step_time_ms": 54023.234, "sample_time_ms": 1370.428, "learn_time_ms": 52630.956, "learn_throughput": 76.001, "synch_weights_time_ms": 16.221}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-47-00", "timestamp": 1723520820, "time_this_iter_s": 55.20026135444641, "time_total_s": 3395.0190930366516, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8006040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3395.0190930366516, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 47.81012658227848, "ram_util_percent": 83.31772151898734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.636911672259133, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.751355548888918, "policy_loss": -0.01233007111389525, "vf_loss": 5.7622795443055495, "vf_explained_var": 0.12482833714081497, "kl": 0.01666449084183273, "entropy": 1.155988232420866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.794851998614256, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.966734013481746, "policy_loss": -0.01054158987324665, "vf_loss": 8.975451848872755, "vf_explained_var": -0.058143652336938044, "kl": 0.008105520705263073, "entropy": 1.125598870698737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -357.0, "episode_reward_mean": 240.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 160.0}, "policy_reward_mean": {"prey_policy": 95.64, "predator_policy": 24.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [262.0, 179.0, 341.0, 310.0, 325.0, 274.0, 198.0, 332.0, 314.0, 341.0, 327.0, 336.0, 333.0, 300.0, 280.0, 342.0, 362.0, 75.0, 351.0, 335.0, 351.0, 284.0, 329.0, 268.0, 197.0, 284.0, 261.0, 230.0, 330.0, 236.0, 357.0, 340.0, 313.0, 304.0, 315.0, 333.0, 376.0, 305.0, 212.0, 212.0, 343.0, 295.0, 256.0, 307.0, 222.0, 305.0, 231.0, 328.0, 313.0, 275.0, 293.0, 277.0, 231.0, 249.0, 107.0, 325.0, 140.0, 340.0, 122.0, 379.0, 325.0, 328.0, 156.0, -94.0, 296.0, 301.0, 162.0, 311.0, 274.0, 242.0, 299.0, 8.0, 376.0, 328.0, -163.0, 256.0, 263.0, 258.0, 270.0, 381.0, 327.0, 195.0, -21.0, 213.0, 297.0, -29.0, 94.0, 93.0, 162.0, 60.0, 248.0, 295.0, 195.0, 170.0, 163.0, -220.0, 225.0, -357.0, 231.0, 88.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [161.0, 54.0, -4.0, 181.0, 186.0, 149.0, 180.0, 109.0, 148.0, 156.0, 100.0, 155.0, 198.0, 0.0, 170.0, 154.0, 147.0, 166.0, 133.0, 180.0, 125.0, 170.0, 193.0, 107.0, 127.0, 188.0, 138.0, 129.0, 94.0, 147.0, 149.0, 166.0, 192.0, 157.0, 17.0, -54.0, 170.0, 161.0, 197.0, 119.0, 181.0, 170.0, 150.0, 117.0, 165.0, 138.0, 187.0, 81.0, -16.0, 145.0, 105.0, 148.0, 128.0, 66.0, -22.0, 188.0, 122.0, 163.0, 144.0, 81.0, 128.0, 185.0, 150.0, 176.0, 159.0, 109.0, 107.0, 157.0, 111.0, 173.0, 152.0, 177.0, 199.0, 172.0, 147.0, 139.0, 125.0, -10.0, 44.0, 93.0, 142.0, 176.0, 158.0, 106.0, 160.0, 20.0, 95.0, 180.0, 197.0, 24.0, 134.0, 134.0, 89.0, 106.0, 146.0, 161.0, 134.0, 171.0, 94.0, 112.0, 88.0, 119.0, 143.0, 115.0, 47.0, 93.0, 148.0, 38.0, 198.0, -182.0, 144.0, 173.0, 140.0, 0.0, 167.0, 154.0, 107.0, -88.0, 197.0, 178.0, 137.0, 177.0, 155.0, 155.0, -72.0, 137.0, -140.0, -101.0, 149.0, 113.0, 146.0, 148.0, 4.0, 58.0, 177.0, 125.0, 121.0, 106.0, 134.0, 30.0, 119.0, 149.0, -88.0, -60.0, 186.0, 190.0, 176.0, 145.0, -171.0, -139.0, 105.0, 129.0, 8.0, 190.0, 79.0, 109.0, 43.0, 166.0, 180.0, 199.0, 146.0, 147.0, 19.0, 106.0, -48.0, -72.0, 86.0, 40.0, 159.0, 107.0, -45.0, -139.0, 196.0, -289.0, 0.0, 22.0, 132.0, 6.0, 96.0, -209.0, 158.0, 55.0, 166.0, 128.0, 103.0, 31.0, 46.0, 32.0, -73.0, 145.0, -269.0, -129.0, 63.0, 116.0, -273.0, -274.0, 26.0, 131.0, -80.0, 25.0], "policy_predator_policy_reward": [47.0, 0.0, 0.0, 2.0, 6.0, 0.0, 11.0, 10.0, 21.0, 0.0, 4.0, 15.0, 0.0, 0.0, 3.0, 5.0, 1.0, 0.0, 21.0, 7.0, 27.0, 5.0, 28.0, 8.0, 13.0, 5.0, 24.0, 9.0, 4.0, 35.0, 11.0, 16.0, 0.0, 13.0, 69.0, 43.0, 3.0, 17.0, 19.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 26.0, 0.0, 0.0, 56.0, 12.0, 0.0, 31.0, 38.0, 29.0, 30.0, 34.0, 12.0, 33.0, 11.0, 0.0, 24.0, 20.0, 4.0, 10.0, 17.0, 28.0, 16.0, 24.0, 7.0, 24.0, 4.0, 0.0, 5.0, 0.0, 0.0, 19.0, 20.0, 77.0, 23.0, 52.0, 18.0, 7.0, 25.0, 6.0, 60.0, 16.0, 32.0, 0.0, 0.0, 1.0, 2.0, 35.0, 36.0, 0.0, 20.0, 1.0, 0.0, 8.0, 44.0, 25.0, 48.0, 38.0, 0.0, 19.0, 50.0, 41.0, 51.0, 12.0, 91.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 14.0, 30.0, 73.0, 2.0, 2.0, 6.0, 5.0, 4.0, 14.0, 26.0, 65.0, 37.0, 110.0, 19.0, 15.0, 6.0, 1.0, 38.0, 62.0, 4.0, 5.0, 24.0, 23.0, 22.0, 56.0, 7.0, 24.0, 70.0, 86.0, 0.0, 0.0, 1.0, 6.0, 20.0, 127.0, 22.0, 0.0, 46.0, 19.0, 34.0, 36.0, 20.0, 41.0, 2.0, 0.0, 1.0, 33.0, 48.0, 22.0, 27.0, 72.0, 38.0, 49.0, 0.0, 31.0, 46.0, 109.0, 142.0, 45.0, 16.0, 55.0, 24.0, 0.0, 152.0, 21.0, 35.0, 0.0, 0.0, 1.0, 45.0, 16.0, 69.0, 23.0, 91.0, 0.0, 25.0, 153.0, 45.0, 1.0, 30.0, 160.0, 56.0, 18.0, 89.0, 54.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6709762752513031, "mean_inference_ms": 1.5803150293871155, "mean_action_processing_ms": 0.2604300926675915, "mean_env_wait_ms": 0.20180142232451467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005832195281982422, "StateBufferConnector_ms": 0.005605340003967285, "ViewRequirementAgentConnector_ms": 0.15955066680908203}, "num_episodes": 18, "episode_return_max": 381.0, "episode_return_min": -357.0, "episode_return_mean": 240.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.21439436480058, "num_env_steps_trained_throughput_per_sec": 60.21439436480058, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 55448.188, "restore_workers_time_ms": 0.025, "training_step_time_ms": 55448.049, "sample_time_ms": 1438.545, "learn_time_ms": 53985.646, "learn_throughput": 74.094, "synch_weights_time_ms": 17.613}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-48-06", "timestamp": 1723520886, "time_this_iter_s": 66.76373100280762, "time_total_s": 3461.7828240394592, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a809f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3461.7828240394592, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 67.77872340425532, "ram_util_percent": 83.40851063829788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.901792553808324, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.506313346681141, "policy_loss": -0.015609000276567208, "vf_loss": 7.520573220681892, "vf_explained_var": 0.09346660022382383, "kl": 0.01598970117316829, "entropy": 1.1280398112756234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.440859138776386, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.30465885041252, "policy_loss": -0.011597237210208304, "vf_loss": 9.313935765261373, "vf_explained_var": 0.09478302657919586, "kl": 0.010312521214692187, "entropy": 1.1221350681214106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -367.0, "episode_reward_mean": 191.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -304.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 59.4, "predator_policy": 36.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0, 335.0, 351.0, 284.0, 329.0, 268.0, 197.0, 284.0, 261.0, 230.0, 330.0, 236.0, 357.0, 340.0, 313.0, 304.0, 315.0, 333.0, 376.0, 305.0, 212.0, 212.0, 343.0, 295.0, 256.0, 307.0, 222.0, 305.0, 231.0, 328.0, 313.0, 275.0, 293.0, 277.0, 231.0, 249.0, 107.0, 325.0, 140.0, 340.0, 122.0, 379.0, 325.0, 328.0, 156.0, -94.0, 296.0, 301.0, 162.0, 311.0, 274.0, 242.0, 299.0, 8.0, 376.0, 328.0, -163.0, 256.0, 263.0, 258.0, 270.0, 381.0, 327.0, 195.0, -21.0, 213.0, 297.0, -29.0, 94.0, 93.0, 162.0, 60.0, 248.0, 295.0, 195.0, 170.0, 163.0, -220.0, 225.0, -357.0, 231.0, 88.0, -47.0, -296.0, -45.0, -3.0, 0.0, 145.0, -367.0, 161.0, 289.0, -199.0, 212.0, 209.0, -61.0, 93.0, 28.0, 160.0, 43.0, -32.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 161.0, 197.0, 119.0, 181.0, 170.0, 150.0, 117.0, 165.0, 138.0, 187.0, 81.0, -16.0, 145.0, 105.0, 148.0, 128.0, 66.0, -22.0, 188.0, 122.0, 163.0, 144.0, 81.0, 128.0, 185.0, 150.0, 176.0, 159.0, 109.0, 107.0, 157.0, 111.0, 173.0, 152.0, 177.0, 199.0, 172.0, 147.0, 139.0, 125.0, -10.0, 44.0, 93.0, 142.0, 176.0, 158.0, 106.0, 160.0, 20.0, 95.0, 180.0, 197.0, 24.0, 134.0, 134.0, 89.0, 106.0, 146.0, 161.0, 134.0, 171.0, 94.0, 112.0, 88.0, 119.0, 143.0, 115.0, 47.0, 93.0, 148.0, 38.0, 198.0, -182.0, 144.0, 173.0, 140.0, 0.0, 167.0, 154.0, 107.0, -88.0, 197.0, 178.0, 137.0, 177.0, 155.0, 155.0, -72.0, 137.0, -140.0, -101.0, 149.0, 113.0, 146.0, 148.0, 4.0, 58.0, 177.0, 125.0, 121.0, 106.0, 134.0, 30.0, 119.0, 149.0, -88.0, -60.0, 186.0, 190.0, 176.0, 145.0, -171.0, -139.0, 105.0, 129.0, 8.0, 190.0, 79.0, 109.0, 43.0, 166.0, 180.0, 199.0, 146.0, 147.0, 19.0, 106.0, -48.0, -72.0, 86.0, 40.0, 159.0, 107.0, -45.0, -139.0, 196.0, -289.0, 0.0, 22.0, 132.0, 6.0, 96.0, -209.0, 158.0, 55.0, 166.0, 128.0, 103.0, 31.0, 46.0, 32.0, -73.0, 145.0, -269.0, -129.0, 63.0, 116.0, -273.0, -274.0, 26.0, 131.0, -80.0, 25.0, -304.0, 33.0, -280.0, -276.0, -104.0, -72.0, 82.0, -225.0, 21.0, -196.0, -173.0, 173.0, -302.0, -232.0, 150.0, -134.0, 173.0, 92.0, -188.0, -175.0, 2.0, 122.0, 143.0, -28.0, -166.0, -45.0, -192.0, 101.0, -202.0, 62.0, -105.0, 132.0, -158.0, 58.0, -37.0, -230.0], "policy_predator_policy_reward": [3.0, 17.0, 19.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 26.0, 0.0, 0.0, 56.0, 12.0, 0.0, 31.0, 38.0, 29.0, 30.0, 34.0, 12.0, 33.0, 11.0, 0.0, 24.0, 20.0, 4.0, 10.0, 17.0, 28.0, 16.0, 24.0, 7.0, 24.0, 4.0, 0.0, 5.0, 0.0, 0.0, 19.0, 20.0, 77.0, 23.0, 52.0, 18.0, 7.0, 25.0, 6.0, 60.0, 16.0, 32.0, 0.0, 0.0, 1.0, 2.0, 35.0, 36.0, 0.0, 20.0, 1.0, 0.0, 8.0, 44.0, 25.0, 48.0, 38.0, 0.0, 19.0, 50.0, 41.0, 51.0, 12.0, 91.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 14.0, 30.0, 73.0, 2.0, 2.0, 6.0, 5.0, 4.0, 14.0, 26.0, 65.0, 37.0, 110.0, 19.0, 15.0, 6.0, 1.0, 38.0, 62.0, 4.0, 5.0, 24.0, 23.0, 22.0, 56.0, 7.0, 24.0, 70.0, 86.0, 0.0, 0.0, 1.0, 6.0, 20.0, 127.0, 22.0, 0.0, 46.0, 19.0, 34.0, 36.0, 20.0, 41.0, 2.0, 0.0, 1.0, 33.0, 48.0, 22.0, 27.0, 72.0, 38.0, 49.0, 0.0, 31.0, 46.0, 109.0, 142.0, 45.0, 16.0, 55.0, 24.0, 0.0, 152.0, 21.0, 35.0, 0.0, 0.0, 1.0, 45.0, 16.0, 69.0, 23.0, 91.0, 0.0, 25.0, 153.0, 45.0, 1.0, 30.0, 160.0, 56.0, 18.0, 89.0, 54.0, 52.0, 172.0, 198.0, 62.0, 97.0, 34.0, 127.0, 13.0, 62.0, 113.0, 65.0, 80.0, 3.0, 164.0, 60.0, 85.0, 5.0, 19.0, 71.0, 93.0, 80.0, 8.0, 17.0, 77.0, 44.0, 106.0, 122.0, 62.0, 33.0, 135.0, 83.0, 50.0, 85.0, 58.0, 104.0, 131.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.673522106354705, "mean_inference_ms": 1.5859919199161612, "mean_action_processing_ms": 0.26145132545817873, "mean_env_wait_ms": 0.20264448857663914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005769252777099609, "StateBufferConnector_ms": 0.008518099784851074, "ViewRequirementAgentConnector_ms": 0.1759120225906372}, "num_episodes": 18, "episode_return_max": 381.0, "episode_return_min": -367.0, "episode_return_mean": 191.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.817882260075514, "num_env_steps_trained_throughput_per_sec": 63.817882260075514, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 56509.652, "restore_workers_time_ms": 0.034, "training_step_time_ms": 56509.492, "sample_time_ms": 1507.296, "learn_time_ms": 54975.544, "learn_throughput": 72.76, "synch_weights_time_ms": 20.528}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-49-10", "timestamp": 1723520950, "time_this_iter_s": 62.75445199012756, "time_total_s": 3524.537276029587, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa58f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3524.537276029587, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 68.68, "ram_util_percent": 83.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.952779184573542, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4948899685390415, "policy_loss": -0.011432280960965843, "vf_loss": 6.505313297554299, "vf_explained_var": 0.1502278013519509, "kl": 0.011957936502655482, "entropy": 1.1032045679748375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.629679341480214, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.93027079597352, "policy_loss": -0.015787993052176066, "vf_loss": 8.943462399326304, "vf_explained_var": 0.11656764260044804, "kl": 0.011539491283135979, "entropy": 1.1113110758640148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -390.0, "episode_reward_mean": 137.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -361.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 18.29, "predator_policy": 50.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 295.0, 256.0, 307.0, 222.0, 305.0, 231.0, 328.0, 313.0, 275.0, 293.0, 277.0, 231.0, 249.0, 107.0, 325.0, 140.0, 340.0, 122.0, 379.0, 325.0, 328.0, 156.0, -94.0, 296.0, 301.0, 162.0, 311.0, 274.0, 242.0, 299.0, 8.0, 376.0, 328.0, -163.0, 256.0, 263.0, 258.0, 270.0, 381.0, 327.0, 195.0, -21.0, 213.0, 297.0, -29.0, 94.0, 93.0, 162.0, 60.0, 248.0, 295.0, 195.0, 170.0, 163.0, -220.0, 225.0, -357.0, 231.0, 88.0, -47.0, -296.0, -45.0, -3.0, 0.0, 145.0, -367.0, 161.0, 289.0, -199.0, 212.0, 209.0, -61.0, 93.0, 28.0, 160.0, 43.0, -32.0, 64.0, -41.0, 71.0, -291.0, 144.0, 310.0, 219.0, 329.0, -58.0, -264.0, 242.0, 183.0, 63.0, -179.0, 46.0, 94.0, 339.0, 40.0, -390.0, 93.0, 23.0, 102.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [142.0, 176.0, 158.0, 106.0, 160.0, 20.0, 95.0, 180.0, 197.0, 24.0, 134.0, 134.0, 89.0, 106.0, 146.0, 161.0, 134.0, 171.0, 94.0, 112.0, 88.0, 119.0, 143.0, 115.0, 47.0, 93.0, 148.0, 38.0, 198.0, -182.0, 144.0, 173.0, 140.0, 0.0, 167.0, 154.0, 107.0, -88.0, 197.0, 178.0, 137.0, 177.0, 155.0, 155.0, -72.0, 137.0, -140.0, -101.0, 149.0, 113.0, 146.0, 148.0, 4.0, 58.0, 177.0, 125.0, 121.0, 106.0, 134.0, 30.0, 119.0, 149.0, -88.0, -60.0, 186.0, 190.0, 176.0, 145.0, -171.0, -139.0, 105.0, 129.0, 8.0, 190.0, 79.0, 109.0, 43.0, 166.0, 180.0, 199.0, 146.0, 147.0, 19.0, 106.0, -48.0, -72.0, 86.0, 40.0, 159.0, 107.0, -45.0, -139.0, 196.0, -289.0, 0.0, 22.0, 132.0, 6.0, 96.0, -209.0, 158.0, 55.0, 166.0, 128.0, 103.0, 31.0, 46.0, 32.0, -73.0, 145.0, -269.0, -129.0, 63.0, 116.0, -273.0, -274.0, 26.0, 131.0, -80.0, 25.0, -304.0, 33.0, -280.0, -276.0, -104.0, -72.0, 82.0, -225.0, 21.0, -196.0, -173.0, 173.0, -302.0, -232.0, 150.0, -134.0, 173.0, 92.0, -188.0, -175.0, 2.0, 122.0, 143.0, -28.0, -166.0, -45.0, -192.0, 101.0, -202.0, 62.0, -105.0, 132.0, -158.0, 58.0, -37.0, -230.0, 159.0, -361.0, -191.0, -66.0, 152.0, -235.0, -234.0, -233.0, -49.0, 67.0, 153.0, 149.0, 110.0, 38.0, 143.0, 155.0, -287.0, -22.0, -274.0, -163.0, 83.0, 115.0, 68.0, 34.0, -58.0, -70.0, -117.0, -242.0, 167.0, -338.0, 101.0, -211.0, 113.0, 173.0, 163.0, -357.0, -349.0, -340.0, 128.0, -234.0, -191.0, 7.0, -295.0, 198.0], "policy_predator_policy_reward": [18.0, 7.0, 25.0, 6.0, 60.0, 16.0, 32.0, 0.0, 0.0, 1.0, 2.0, 35.0, 36.0, 0.0, 20.0, 1.0, 0.0, 8.0, 44.0, 25.0, 48.0, 38.0, 0.0, 19.0, 50.0, 41.0, 51.0, 12.0, 91.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 14.0, 30.0, 73.0, 2.0, 2.0, 6.0, 5.0, 4.0, 14.0, 26.0, 65.0, 37.0, 110.0, 19.0, 15.0, 6.0, 1.0, 38.0, 62.0, 4.0, 5.0, 24.0, 23.0, 22.0, 56.0, 7.0, 24.0, 70.0, 86.0, 0.0, 0.0, 1.0, 6.0, 20.0, 127.0, 22.0, 0.0, 46.0, 19.0, 34.0, 36.0, 20.0, 41.0, 2.0, 0.0, 1.0, 33.0, 48.0, 22.0, 27.0, 72.0, 38.0, 49.0, 0.0, 31.0, 46.0, 109.0, 142.0, 45.0, 16.0, 55.0, 24.0, 0.0, 152.0, 21.0, 35.0, 0.0, 0.0, 1.0, 45.0, 16.0, 69.0, 23.0, 91.0, 0.0, 25.0, 153.0, 45.0, 1.0, 30.0, 160.0, 56.0, 18.0, 89.0, 54.0, 52.0, 172.0, 198.0, 62.0, 97.0, 34.0, 127.0, 13.0, 62.0, 113.0, 65.0, 80.0, 3.0, 164.0, 60.0, 85.0, 5.0, 19.0, 71.0, 93.0, 80.0, 8.0, 17.0, 77.0, 44.0, 106.0, 122.0, 62.0, 33.0, 135.0, 83.0, 50.0, 85.0, 58.0, 104.0, 131.0, 183.0, 83.0, 126.0, 90.0, 142.0, 12.0, 142.0, 34.0, 91.0, 35.0, 4.0, 4.0, 42.0, 29.0, 19.0, 12.0, 102.0, 149.0, 15.0, 158.0, 15.0, 29.0, 42.0, 39.0, 110.0, 81.0, 142.0, 38.0, 178.0, 39.0, 130.0, 74.0, 23.0, 30.0, 180.0, 54.0, 116.0, 183.0, 62.0, 137.0, 87.0, 120.0, 121.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6778434705150644, "mean_inference_ms": 1.59641909313761, "mean_action_processing_ms": 0.2633268902394567, "mean_env_wait_ms": 0.20410565553495494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066182613372802734, "StateBufferConnector_ms": 0.010350823402404785, "ViewRequirementAgentConnector_ms": 0.18268287181854248}, "num_episodes": 22, "episode_return_max": 381.0, "episode_return_min": -390.0, "episode_return_mean": 137.73, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.88153292732687, "num_env_steps_trained_throughput_per_sec": 63.88153292732687, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 57406.602, "restore_workers_time_ms": 0.034, "training_step_time_ms": 57406.446, "sample_time_ms": 1608.663, "learn_time_ms": 55771.354, "learn_throughput": 71.721, "synch_weights_time_ms": 20.497}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-50-12", "timestamp": 1723521012, "time_this_iter_s": 62.64911913871765, "time_total_s": 3587.1863951683044, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa58f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3587.1863951683044, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 65.97191011235955, "ram_util_percent": 83.31348314606741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.483400371276513, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.8938245809898175, "policy_loss": -0.008339915628835716, "vf_loss": 4.901384073716623, "vf_explained_var": 0.19599691831245625, "kl": 0.00924952089068949, "entropy": 1.073071221163664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.112302842468182, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.343711420846363, "policy_loss": -0.011973806836139706, "vf_loss": 8.353862336577562, "vf_explained_var": 0.18449614044850465, "kl": 0.008101765061084745, "entropy": 1.0711571621516394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -390.0, "episode_reward_mean": 118.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -361.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 2.49, "predator_policy": 56.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.0, 379.0, 325.0, 328.0, 156.0, -94.0, 296.0, 301.0, 162.0, 311.0, 274.0, 242.0, 299.0, 8.0, 376.0, 328.0, -163.0, 256.0, 263.0, 258.0, 270.0, 381.0, 327.0, 195.0, -21.0, 213.0, 297.0, -29.0, 94.0, 93.0, 162.0, 60.0, 248.0, 295.0, 195.0, 170.0, 163.0, -220.0, 225.0, -357.0, 231.0, 88.0, -47.0, -296.0, -45.0, -3.0, 0.0, 145.0, -367.0, 161.0, 289.0, -199.0, 212.0, 209.0, -61.0, 93.0, 28.0, 160.0, 43.0, -32.0, 64.0, -41.0, 71.0, -291.0, 144.0, 310.0, 219.0, 329.0, -58.0, -264.0, 242.0, 183.0, 63.0, -179.0, 46.0, 94.0, 339.0, 40.0, -390.0, 93.0, 23.0, 102.0, 269.0, 4.0, 160.0, 289.0, -63.0, 400.0, 130.0, -73.0, 149.0, 53.0, 58.0, 392.0, -37.0, 219.0, 346.0, 273.0, 160.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [107.0, -88.0, 197.0, 178.0, 137.0, 177.0, 155.0, 155.0, -72.0, 137.0, -140.0, -101.0, 149.0, 113.0, 146.0, 148.0, 4.0, 58.0, 177.0, 125.0, 121.0, 106.0, 134.0, 30.0, 119.0, 149.0, -88.0, -60.0, 186.0, 190.0, 176.0, 145.0, -171.0, -139.0, 105.0, 129.0, 8.0, 190.0, 79.0, 109.0, 43.0, 166.0, 180.0, 199.0, 146.0, 147.0, 19.0, 106.0, -48.0, -72.0, 86.0, 40.0, 159.0, 107.0, -45.0, -139.0, 196.0, -289.0, 0.0, 22.0, 132.0, 6.0, 96.0, -209.0, 158.0, 55.0, 166.0, 128.0, 103.0, 31.0, 46.0, 32.0, -73.0, 145.0, -269.0, -129.0, 63.0, 116.0, -273.0, -274.0, 26.0, 131.0, -80.0, 25.0, -304.0, 33.0, -280.0, -276.0, -104.0, -72.0, 82.0, -225.0, 21.0, -196.0, -173.0, 173.0, -302.0, -232.0, 150.0, -134.0, 173.0, 92.0, -188.0, -175.0, 2.0, 122.0, 143.0, -28.0, -166.0, -45.0, -192.0, 101.0, -202.0, 62.0, -105.0, 132.0, -158.0, 58.0, -37.0, -230.0, 159.0, -361.0, -191.0, -66.0, 152.0, -235.0, -234.0, -233.0, -49.0, 67.0, 153.0, 149.0, 110.0, 38.0, 143.0, 155.0, -287.0, -22.0, -274.0, -163.0, 83.0, 115.0, 68.0, 34.0, -58.0, -70.0, -117.0, -242.0, 167.0, -338.0, 101.0, -211.0, 113.0, 173.0, 163.0, -357.0, -349.0, -340.0, 128.0, -234.0, -191.0, 7.0, -295.0, 198.0, 96.0, 128.0, 39.0, -173.0, -190.0, 186.0, 113.0, 135.0, -328.0, 53.0, 200.0, 200.0, 9.0, 46.0, -23.0, -300.0, 100.0, -53.0, -349.0, 169.0, -32.0, -50.0, 191.0, 197.0, 33.0, -316.0, -13.0, 131.0, 158.0, 164.0, 152.0, 32.0, 140.0, 0.0, 2.0, 117.0], "policy_predator_policy_reward": [30.0, 73.0, 2.0, 2.0, 6.0, 5.0, 4.0, 14.0, 26.0, 65.0, 37.0, 110.0, 19.0, 15.0, 6.0, 1.0, 38.0, 62.0, 4.0, 5.0, 24.0, 23.0, 22.0, 56.0, 7.0, 24.0, 70.0, 86.0, 0.0, 0.0, 1.0, 6.0, 20.0, 127.0, 22.0, 0.0, 46.0, 19.0, 34.0, 36.0, 20.0, 41.0, 2.0, 0.0, 1.0, 33.0, 48.0, 22.0, 27.0, 72.0, 38.0, 49.0, 0.0, 31.0, 46.0, 109.0, 142.0, 45.0, 16.0, 55.0, 24.0, 0.0, 152.0, 21.0, 35.0, 0.0, 0.0, 1.0, 45.0, 16.0, 69.0, 23.0, 91.0, 0.0, 25.0, 153.0, 45.0, 1.0, 30.0, 160.0, 56.0, 18.0, 89.0, 54.0, 52.0, 172.0, 198.0, 62.0, 97.0, 34.0, 127.0, 13.0, 62.0, 113.0, 65.0, 80.0, 3.0, 164.0, 60.0, 85.0, 5.0, 19.0, 71.0, 93.0, 80.0, 8.0, 17.0, 77.0, 44.0, 106.0, 122.0, 62.0, 33.0, 135.0, 83.0, 50.0, 85.0, 58.0, 104.0, 131.0, 183.0, 83.0, 126.0, 90.0, 142.0, 12.0, 142.0, 34.0, 91.0, 35.0, 4.0, 4.0, 42.0, 29.0, 19.0, 12.0, 102.0, 149.0, 15.0, 158.0, 15.0, 29.0, 42.0, 39.0, 110.0, 81.0, 142.0, 38.0, 178.0, 39.0, 130.0, 74.0, 23.0, 30.0, 180.0, 54.0, 116.0, 183.0, 62.0, 137.0, 87.0, 120.0, 121.0, 78.0, 39.0, 6.0, 70.0, 68.0, 108.0, 56.0, 20.0, 21.0, 149.0, 63.0, 0.0, 0.0, 62.0, 13.0, 167.0, 83.0, 30.0, 72.0, 106.0, 127.0, 87.0, 53.0, 3.0, 1.0, 161.0, 85.0, 38.0, 63.0, 24.0, 0.0, 23.0, 66.0, 2.0, 18.0, 5.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6823067118221315, "mean_inference_ms": 1.6095478384272475, "mean_action_processing_ms": 0.2652867367366012, "mean_env_wait_ms": 0.20562879287781854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005896806716918945, "StateBufferConnector_ms": 0.014755845069885254, "ViewRequirementAgentConnector_ms": 0.1664060354232788}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -390.0, "episode_return_mean": 118.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.799211995378194, "num_env_steps_trained_throughput_per_sec": 63.799211995378194, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 58430.444, "restore_workers_time_ms": 0.035, "training_step_time_ms": 58430.286, "sample_time_ms": 1701.575, "learn_time_ms": 56699.887, "learn_throughput": 70.547, "synch_weights_time_ms": 22.679}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-51-15", "timestamp": 1723521075, "time_this_iter_s": 62.72862505912781, "time_total_s": 3649.9150202274323, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8031940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3649.9150202274323, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 66.31685393258427, "ram_util_percent": 83.40224719101124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.719792558654905, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.123102697115096, "policy_loss": -0.009371085892180128, "vf_loss": 5.131742171383409, "vf_explained_var": 0.19949704304574029, "kl": 0.008671036170017994, "entropy": 1.0626205065263012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.514264814185086, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.103926946246435, "policy_loss": -0.014657235742921118, "vf_loss": 8.116130614154553, "vf_explained_var": 0.026271886548037252, "kl": 0.010904709760508804, "entropy": 1.1278173757608605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -390.0, "episode_reward_mean": 96.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -15.73, "predator_policy": 63.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.0, -21.0, 213.0, 297.0, -29.0, 94.0, 93.0, 162.0, 60.0, 248.0, 295.0, 195.0, 170.0, 163.0, -220.0, 225.0, -357.0, 231.0, 88.0, -47.0, -296.0, -45.0, -3.0, 0.0, 145.0, -367.0, 161.0, 289.0, -199.0, 212.0, 209.0, -61.0, 93.0, 28.0, 160.0, 43.0, -32.0, 64.0, -41.0, 71.0, -291.0, 144.0, 310.0, 219.0, 329.0, -58.0, -264.0, 242.0, 183.0, 63.0, -179.0, 46.0, 94.0, 339.0, 40.0, -390.0, 93.0, 23.0, 102.0, 269.0, 4.0, 160.0, 289.0, -63.0, 400.0, 130.0, -73.0, 149.0, 53.0, 58.0, 392.0, -37.0, 219.0, 346.0, 273.0, 160.0, 188.0, 9.0, 141.0, 153.0, 182.0, 340.0, 192.0, 149.0, 88.0, 81.0, 292.0, 266.0, 224.0, -59.0, 104.0, -111.0, 218.0, 28.0, 184.0, 139.0, 125.0, 162.0, 113.0, 146.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, 106.0, -48.0, -72.0, 86.0, 40.0, 159.0, 107.0, -45.0, -139.0, 196.0, -289.0, 0.0, 22.0, 132.0, 6.0, 96.0, -209.0, 158.0, 55.0, 166.0, 128.0, 103.0, 31.0, 46.0, 32.0, -73.0, 145.0, -269.0, -129.0, 63.0, 116.0, -273.0, -274.0, 26.0, 131.0, -80.0, 25.0, -304.0, 33.0, -280.0, -276.0, -104.0, -72.0, 82.0, -225.0, 21.0, -196.0, -173.0, 173.0, -302.0, -232.0, 150.0, -134.0, 173.0, 92.0, -188.0, -175.0, 2.0, 122.0, 143.0, -28.0, -166.0, -45.0, -192.0, 101.0, -202.0, 62.0, -105.0, 132.0, -158.0, 58.0, -37.0, -230.0, 159.0, -361.0, -191.0, -66.0, 152.0, -235.0, -234.0, -233.0, -49.0, 67.0, 153.0, 149.0, 110.0, 38.0, 143.0, 155.0, -287.0, -22.0, -274.0, -163.0, 83.0, 115.0, 68.0, 34.0, -58.0, -70.0, -117.0, -242.0, 167.0, -338.0, 101.0, -211.0, 113.0, 173.0, 163.0, -357.0, -349.0, -340.0, 128.0, -234.0, -191.0, 7.0, -295.0, 198.0, 96.0, 128.0, 39.0, -173.0, -190.0, 186.0, 113.0, 135.0, -328.0, 53.0, 200.0, 200.0, 9.0, 46.0, -23.0, -300.0, 100.0, -53.0, -349.0, 169.0, -32.0, -50.0, 191.0, 197.0, 33.0, -316.0, -13.0, 131.0, 158.0, 164.0, 152.0, 32.0, 140.0, 0.0, 2.0, 117.0, -60.0, -1.0, 83.0, -129.0, -85.0, 127.0, 131.0, 28.0, 164.0, 167.0, -144.0, 147.0, -245.0, 197.0, -103.0, 90.0, -217.0, 92.0, 149.0, 101.0, 66.0, 200.0, -61.0, 200.0, -334.0, -7.0, 31.0, -32.0, -400.0, 35.0, -102.0, 188.0, 50.0, -179.0, -44.0, 86.0, -22.0, 20.0, 2.0, 50.0, 131.0, 0.0, 0.0, 88.0, 56.0, 3.0], "policy_predator_policy_reward": [48.0, 22.0, 27.0, 72.0, 38.0, 49.0, 0.0, 31.0, 46.0, 109.0, 142.0, 45.0, 16.0, 55.0, 24.0, 0.0, 152.0, 21.0, 35.0, 0.0, 0.0, 1.0, 45.0, 16.0, 69.0, 23.0, 91.0, 0.0, 25.0, 153.0, 45.0, 1.0, 30.0, 160.0, 56.0, 18.0, 89.0, 54.0, 52.0, 172.0, 198.0, 62.0, 97.0, 34.0, 127.0, 13.0, 62.0, 113.0, 65.0, 80.0, 3.0, 164.0, 60.0, 85.0, 5.0, 19.0, 71.0, 93.0, 80.0, 8.0, 17.0, 77.0, 44.0, 106.0, 122.0, 62.0, 33.0, 135.0, 83.0, 50.0, 85.0, 58.0, 104.0, 131.0, 183.0, 83.0, 126.0, 90.0, 142.0, 12.0, 142.0, 34.0, 91.0, 35.0, 4.0, 4.0, 42.0, 29.0, 19.0, 12.0, 102.0, 149.0, 15.0, 158.0, 15.0, 29.0, 42.0, 39.0, 110.0, 81.0, 142.0, 38.0, 178.0, 39.0, 130.0, 74.0, 23.0, 30.0, 180.0, 54.0, 116.0, 183.0, 62.0, 137.0, 87.0, 120.0, 121.0, 78.0, 39.0, 6.0, 70.0, 68.0, 108.0, 56.0, 20.0, 21.0, 149.0, 63.0, 0.0, 0.0, 62.0, 13.0, 167.0, 83.0, 30.0, 72.0, 106.0, 127.0, 87.0, 53.0, 3.0, 1.0, 161.0, 85.0, 38.0, 63.0, 24.0, 0.0, 23.0, 66.0, 2.0, 18.0, 5.0, 64.0, 0.0, 70.0, 117.0, 70.0, 89.0, 22.0, 22.0, 1.0, 8.0, 1.0, 83.0, 106.0, 49.0, 148.0, 0.0, 101.0, 67.0, 139.0, 40.0, 2.0, 0.0, 0.0, 84.0, 1.0, 122.0, 160.0, 74.0, 31.0, 58.0, 196.0, 96.0, 36.0, 78.0, 79.0, 60.0, 82.0, 86.0, 55.0, 25.0, 48.0, 23.0, 8.0, 3.0, 22.0, 53.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6876317953249226, "mean_inference_ms": 1.6240294507589252, "mean_action_processing_ms": 0.26756514227343, "mean_env_wait_ms": 0.207459488712883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016297340393066406, "StateBufferConnector_ms": 0.01587355136871338, "ViewRequirementAgentConnector_ms": 0.18271899223327637}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -390.0, "episode_return_mean": 96.14, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.54599304784482, "num_env_steps_trained_throughput_per_sec": 55.54599304784482, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 60236.152, "restore_workers_time_ms": 0.035, "training_step_time_ms": 60235.994, "sample_time_ms": 1743.298, "learn_time_ms": 58462.735, "learn_throughput": 68.42, "synch_weights_time_ms": 24.2}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "c1c5b_00000", "date": "2024-08-12_23-52-27", "timestamp": 1723521147, "time_this_iter_s": 72.0964150428772, "time_total_s": 3722.0114352703094, "pid": 90521, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8006ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3722.0114352703094, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 82.19313725490198, "ram_util_percent": 83.64313725490199}}
